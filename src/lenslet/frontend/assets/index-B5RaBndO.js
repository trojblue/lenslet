var Ox=Object.defineProperty;var ih=e=>{throw TypeError(e)};var Ax=(e,t,n)=>t in e?Ox(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var lt=(e,t,n)=>Ax(e,typeof t!="symbol"?t+"":t,n),ku=(e,t,n)=>t.has(e)||ih("Cannot "+n);var k=(e,t,n)=>(ku(e,t,"read from private field"),n?n.call(e):t.get(e)),fe=(e,t,n)=>t.has(e)?ih("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),te=(e,t,n,r)=>(ku(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),we=(e,t,n)=>(ku(e,t,"access private method"),n);var ll=(e,t,n,r)=>({set _(s){te(e,t,s,n)},get _(){return k(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function Dx(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var tg={exports:{}},Fa={},ng={exports:{}},Ee={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Do=Symbol.for("react.element"),zx=Symbol.for("react.portal"),$x=Symbol.for("react.fragment"),Bx=Symbol.for("react.strict_mode"),Ux=Symbol.for("react.profiler"),Vx=Symbol.for("react.provider"),Wx=Symbol.for("react.context"),Hx=Symbol.for("react.forward_ref"),Qx=Symbol.for("react.suspense"),Kx=Symbol.for("react.memo"),Yx=Symbol.for("react.lazy"),oh=Symbol.iterator;function Xx(e){return e===null||typeof e!="object"?null:(e=oh&&e[oh]||e["@@iterator"],typeof e=="function"?e:null)}var rg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sg=Object.assign,ig={};function yi(e,t,n){this.props=e,this.context=t,this.refs=ig,this.updater=n||rg}yi.prototype.isReactComponent={};yi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};yi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function og(){}og.prototype=yi.prototype;function Dd(e,t,n){this.props=e,this.context=t,this.refs=ig,this.updater=n||rg}var zd=Dd.prototype=new og;zd.constructor=Dd;sg(zd,yi.prototype);zd.isPureReactComponent=!0;var lh=Array.isArray,lg=Object.prototype.hasOwnProperty,$d={current:null},ag={key:!0,ref:!0,__self:!0,__source:!0};function ug(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)lg.call(t,r)&&!ag.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Do,type:e,key:i,ref:o,props:s,_owner:$d.current}}function qx(e,t){return{$$typeof:Do,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Bd(e){return typeof e=="object"&&e!==null&&e.$$typeof===Do}function Gx(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var ah=/\/+/g;function Eu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Gx(""+e.key):t.toString(36)}function _l(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Do:case zx:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+Eu(o,0):r,lh(s)?(n="",e!=null&&(n=e.replace(ah,"$&/")+"/"),_l(s,t,n,"",function(d){return d})):s!=null&&(Bd(s)&&(s=qx(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(ah,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",lh(e))for(var l=0;l<e.length;l++){i=e[l];var c=r+Eu(i,l);o+=_l(i,t,n,c,s)}else if(c=Xx(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=r+Eu(i,l++),o+=_l(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function al(e,t,n){if(e==null)return e;var r=[],s=0;return _l(e,r,"","",function(i){return t.call(n,i,s++)}),r}function Jx(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ft={current:null},Fl={transition:null},Zx={ReactCurrentDispatcher:Ft,ReactCurrentBatchConfig:Fl,ReactCurrentOwner:$d};function cg(){throw Error("act(...) is not supported in production builds of React.")}Ee.Children={map:al,forEach:function(e,t,n){al(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return al(e,function(){t++}),t},toArray:function(e){return al(e,function(t){return t})||[]},only:function(e){if(!Bd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ee.Component=yi;Ee.Fragment=$x;Ee.Profiler=Ux;Ee.PureComponent=Dd;Ee.StrictMode=Bx;Ee.Suspense=Qx;Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zx;Ee.act=cg;Ee.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=sg({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=$d.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)lg.call(t,c)&&!ag.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Do,type:e.type,key:s,ref:i,props:r,_owner:o}};Ee.createContext=function(e){return e={$$typeof:Wx,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Vx,_context:e},e.Consumer=e};Ee.createElement=ug;Ee.createFactory=function(e){var t=ug.bind(null,e);return t.type=e,t};Ee.createRef=function(){return{current:null}};Ee.forwardRef=function(e){return{$$typeof:Hx,render:e}};Ee.isValidElement=Bd;Ee.lazy=function(e){return{$$typeof:Yx,_payload:{_status:-1,_result:e},_init:Jx}};Ee.memo=function(e,t){return{$$typeof:Kx,type:e,compare:t===void 0?null:t}};Ee.startTransition=function(e){var t=Fl.transition;Fl.transition={};try{e()}finally{Fl.transition=t}};Ee.unstable_act=cg;Ee.useCallback=function(e,t){return Ft.current.useCallback(e,t)};Ee.useContext=function(e){return Ft.current.useContext(e)};Ee.useDebugValue=function(){};Ee.useDeferredValue=function(e){return Ft.current.useDeferredValue(e)};Ee.useEffect=function(e,t){return Ft.current.useEffect(e,t)};Ee.useId=function(){return Ft.current.useId()};Ee.useImperativeHandle=function(e,t,n){return Ft.current.useImperativeHandle(e,t,n)};Ee.useInsertionEffect=function(e,t){return Ft.current.useInsertionEffect(e,t)};Ee.useLayoutEffect=function(e,t){return Ft.current.useLayoutEffect(e,t)};Ee.useMemo=function(e,t){return Ft.current.useMemo(e,t)};Ee.useReducer=function(e,t,n){return Ft.current.useReducer(e,t,n)};Ee.useRef=function(e){return Ft.current.useRef(e)};Ee.useState=function(e){return Ft.current.useState(e)};Ee.useSyncExternalStore=function(e,t,n){return Ft.current.useSyncExternalStore(e,t,n)};Ee.useTransition=function(){return Ft.current.useTransition()};Ee.version="18.3.1";ng.exports=Ee;var u=ng.exports;const fo=Dx(u);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e0=u,t0=Symbol.for("react.element"),n0=Symbol.for("react.fragment"),r0=Object.prototype.hasOwnProperty,s0=e0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i0={key:!0,ref:!0,__self:!0,__source:!0};function dg(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)r0.call(t,r)&&!i0.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:t0,type:e,key:i,ref:o,props:s,_owner:s0.current}}Fa.Fragment=n0;Fa.jsx=dg;Fa.jsxs=dg;tg.exports=Fa;var a=tg.exports,fg={exports:{}},Zt={},hg={exports:{}},pg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,_){var F=M.length;M.push(_);e:for(;0<F;){var W=F-1>>>1,U=M[W];if(0<s(U,_))M[W]=_,M[F]=U,F=W;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var _=M[0],F=M.pop();if(F!==_){M[0]=F;e:for(var W=0,U=M.length,I=U>>>1;W<I;){var X=2*(W+1)-1,J=M[X],ne=X+1,ee=M[ne];if(0>s(J,F))ne<U&&0>s(ee,J)?(M[W]=ee,M[ne]=F,W=ne):(M[W]=J,M[X]=F,W=X);else if(ne<U&&0>s(ee,F))M[W]=ee,M[ne]=F,W=ne;else break e}}return _}function s(M,_){var F=M.sortIndex-_.sortIndex;return F!==0?F:M.id-_.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],f=1,p=null,h=3,S=!1,x=!1,w=!1,C=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(M){for(var _=n(d);_!==null;){if(_.callback===null)r(d);else if(_.startTime<=M)r(d),_.sortIndex=_.expirationTime,t(c,_);else break;_=n(d)}}function g(M){if(w=!1,v(M),!x)if(n(c)!==null)x=!0,T(b);else{var _=n(d);_!==null&&R(g,_.startTime-M)}}function b(M,_){x=!1,w&&(w=!1,y(E),E=-1),S=!0;var F=h;try{for(v(_),p=n(c);p!==null&&(!(p.expirationTime>_)||M&&!A());){var W=p.callback;if(typeof W=="function"){p.callback=null,h=p.priorityLevel;var U=W(p.expirationTime<=_);_=e.unstable_now(),typeof U=="function"?p.callback=U:p===n(c)&&r(c),v(_)}else r(c);p=n(c)}if(p!==null)var I=!0;else{var X=n(d);X!==null&&R(g,X.startTime-_),I=!1}return I}finally{p=null,h=F,S=!1}}var N=!1,j=null,E=-1,O=5,L=-1;function A(){return!(e.unstable_now()-L<O)}function z(){if(j!==null){var M=e.unstable_now();L=M;var _=!0;try{_=j(!0,M)}finally{_?H():(N=!1,j=null)}}else N=!1}var H;if(typeof m=="function")H=function(){m(z)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,B=Z.port2;Z.port1.onmessage=z,H=function(){B.postMessage(null)}}else H=function(){C(z,0)};function T(M){j=M,N||(N=!0,H())}function R(M,_){E=C(function(){M(e.unstable_now())},_)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){x||S||(x=!0,T(b))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(M){switch(h){case 1:case 2:case 3:var _=3;break;default:_=h}var F=h;h=_;try{return M()}finally{h=F}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,_){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var F=h;h=M;try{return _()}finally{h=F}},e.unstable_scheduleCallback=function(M,_,F){var W=e.unstable_now();switch(typeof F=="object"&&F!==null?(F=F.delay,F=typeof F=="number"&&0<F?W+F:W):F=W,M){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=F+U,M={id:f++,callback:_,priorityLevel:M,startTime:F,expirationTime:U,sortIndex:-1},F>W?(M.sortIndex=F,t(d,M),n(c)===null&&M===n(d)&&(w?(y(E),E=-1):w=!0,R(g,F-W))):(M.sortIndex=U,t(c,M),x||S||(x=!0,T(b))),M},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(M){var _=h;return function(){var F=h;h=_;try{return M.apply(this,arguments)}finally{h=F}}}})(pg);hg.exports=pg;var o0=hg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l0=u,Jt=o0;function Q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mg=new Set,ho={};function ys(e,t){ci(e,t),ci(e+"Capture",t)}function ci(e,t){for(ho[e]=t,e=0;e<t.length;e++)mg.add(t[e])}var Gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hc=Object.prototype.hasOwnProperty,a0=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uh={},ch={};function u0(e){return hc.call(ch,e)?!0:hc.call(uh,e)?!1:a0.test(e)?ch[e]=!0:(uh[e]=!0,!1)}function c0(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function d0(e,t,n,r){if(t===null||typeof t>"u"||c0(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ot(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){wt[e]=new Ot(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];wt[t]=new Ot(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){wt[e]=new Ot(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){wt[e]=new Ot(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){wt[e]=new Ot(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){wt[e]=new Ot(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){wt[e]=new Ot(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){wt[e]=new Ot(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){wt[e]=new Ot(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ud=/[\-:]([a-z])/g;function Vd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ud,Vd);wt[t]=new Ot(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ud,Vd);wt[t]=new Ot(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ud,Vd);wt[t]=new Ot(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){wt[e]=new Ot(e,1,!1,e.toLowerCase(),null,!1,!1)});wt.xlinkHref=new Ot("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){wt[e]=new Ot(e,1,!1,e.toLowerCase(),null,!0,!0)});function Wd(e,t,n,r){var s=wt.hasOwnProperty(t)?wt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(d0(t,n,s,r)&&(n=null),r||s===null?u0(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var tr=l0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ul=Symbol.for("react.element"),Ts=Symbol.for("react.portal"),Ls=Symbol.for("react.fragment"),Hd=Symbol.for("react.strict_mode"),pc=Symbol.for("react.profiler"),gg=Symbol.for("react.provider"),vg=Symbol.for("react.context"),Qd=Symbol.for("react.forward_ref"),mc=Symbol.for("react.suspense"),gc=Symbol.for("react.suspense_list"),Kd=Symbol.for("react.memo"),ur=Symbol.for("react.lazy"),yg=Symbol.for("react.offscreen"),dh=Symbol.iterator;function Ii(e){return e===null||typeof e!="object"?null:(e=dh&&e[dh]||e["@@iterator"],typeof e=="function"?e:null)}var Ge=Object.assign,Nu;function Ki(e){if(Nu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Nu=t&&t[1]||""}return`
`+Nu+e}var ju=!1;function Mu(e,t){if(!e||ju)return"";ju=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{ju=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ki(e):""}function f0(e){switch(e.tag){case 5:return Ki(e.type);case 16:return Ki("Lazy");case 13:return Ki("Suspense");case 19:return Ki("SuspenseList");case 0:case 2:case 15:return e=Mu(e.type,!1),e;case 11:return e=Mu(e.type.render,!1),e;case 1:return e=Mu(e.type,!0),e;default:return""}}function vc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ls:return"Fragment";case Ts:return"Portal";case pc:return"Profiler";case Hd:return"StrictMode";case mc:return"Suspense";case gc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vg:return(e.displayName||"Context")+".Consumer";case gg:return(e._context.displayName||"Context")+".Provider";case Qd:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Kd:return t=e.displayName||null,t!==null?t:vc(e.type)||"Memo";case ur:t=e._payload,e=e._init;try{return vc(e(t))}catch{}}return null}function h0(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vc(t);case 8:return t===Hd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function _r(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function xg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function p0(e){var t=xg(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function cl(e){e._valueTracker||(e._valueTracker=p0(e))}function wg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=xg(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ta(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function yc(e,t){var n=t.checked;return Ge({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function fh(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=_r(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Sg(e,t){t=t.checked,t!=null&&Wd(e,"checked",t,!1)}function xc(e,t){Sg(e,t);var n=_r(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?wc(e,t.type,n):t.hasOwnProperty("defaultValue")&&wc(e,t.type,_r(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function hh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function wc(e,t,n){(t!=="number"||ta(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Yi=Array.isArray;function Vs(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+_r(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Sc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Q(91));return Ge({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ph(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Q(92));if(Yi(n)){if(1<n.length)throw Error(Q(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:_r(n)}}function bg(e,t){var n=_r(t.value),r=_r(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function mh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Cg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function bc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Cg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var dl,kg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(dl=dl||document.createElement("div"),dl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=dl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function po(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Zi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},m0=["Webkit","ms","Moz","O"];Object.keys(Zi).forEach(function(e){m0.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zi[t]=Zi[e]})});function Eg(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Zi.hasOwnProperty(e)&&Zi[e]?(""+t).trim():t+"px"}function Ng(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Eg(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var g0=Ge({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Cc(e,t){if(t){if(g0[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Q(62))}}function kc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ec=null;function Yd(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Nc=null,Ws=null,Hs=null;function gh(e){if(e=Bo(e)){if(typeof Nc!="function")throw Error(Q(280));var t=e.stateNode;t&&(t=$a(t),Nc(e.stateNode,e.type,t))}}function jg(e){Ws?Hs?Hs.push(e):Hs=[e]:Ws=e}function Mg(){if(Ws){var e=Ws,t=Hs;if(Hs=Ws=null,gh(e),t)for(e=0;e<t.length;e++)gh(t[e])}}function Rg(e,t){return e(t)}function Pg(){}var Ru=!1;function Tg(e,t,n){if(Ru)return e(t,n);Ru=!0;try{return Rg(e,t,n)}finally{Ru=!1,(Ws!==null||Hs!==null)&&(Pg(),Mg())}}function mo(e,t){var n=e.stateNode;if(n===null)return null;var r=$a(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Q(231,t,typeof n));return n}var jc=!1;if(Gn)try{var _i={};Object.defineProperty(_i,"passive",{get:function(){jc=!0}}),window.addEventListener("test",_i,_i),window.removeEventListener("test",_i,_i)}catch{jc=!1}function v0(e,t,n,r,s,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(f){this.onError(f)}}var eo=!1,na=null,ra=!1,Mc=null,y0={onError:function(e){eo=!0,na=e}};function x0(e,t,n,r,s,i,o,l,c){eo=!1,na=null,v0.apply(y0,arguments)}function w0(e,t,n,r,s,i,o,l,c){if(x0.apply(this,arguments),eo){if(eo){var d=na;eo=!1,na=null}else throw Error(Q(198));ra||(ra=!0,Mc=d)}}function xs(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Lg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function vh(e){if(xs(e)!==e)throw Error(Q(188))}function S0(e){var t=e.alternate;if(!t){if(t=xs(e),t===null)throw Error(Q(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return vh(s),e;if(i===r)return vh(s),t;i=i.sibling}throw Error(Q(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(Q(189))}}if(n.alternate!==r)throw Error(Q(190))}if(n.tag!==3)throw Error(Q(188));return n.stateNode.current===n?e:t}function Ig(e){return e=S0(e),e!==null?_g(e):null}function _g(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=_g(e);if(t!==null)return t;e=e.sibling}return null}var Fg=Jt.unstable_scheduleCallback,yh=Jt.unstable_cancelCallback,b0=Jt.unstable_shouldYield,C0=Jt.unstable_requestPaint,tt=Jt.unstable_now,k0=Jt.unstable_getCurrentPriorityLevel,Xd=Jt.unstable_ImmediatePriority,Og=Jt.unstable_UserBlockingPriority,sa=Jt.unstable_NormalPriority,E0=Jt.unstable_LowPriority,Ag=Jt.unstable_IdlePriority,Oa=null,Ln=null;function N0(e){if(Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(Oa,e,void 0,(e.current.flags&128)===128)}catch{}}var bn=Math.clz32?Math.clz32:R0,j0=Math.log,M0=Math.LN2;function R0(e){return e>>>=0,e===0?32:31-(j0(e)/M0|0)|0}var fl=64,hl=4194304;function Xi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ia(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Xi(l):(i&=o,i!==0&&(r=Xi(i)))}else o=n&~s,o!==0?r=Xi(o):i!==0&&(r=Xi(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-bn(t),s=1<<n,r|=e[n],t&=~s;return r}function P0(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function T0(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-bn(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=P0(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Rc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Dg(){var e=fl;return fl<<=1,!(fl&4194240)&&(fl=64),e}function Pu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function zo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-bn(t),e[t]=n}function L0(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-bn(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function qd(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-bn(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var ze=0;function zg(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var $g,Gd,Bg,Ug,Vg,Pc=!1,pl=[],kr=null,Er=null,Nr=null,go=new Map,vo=new Map,dr=[],I0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function xh(e,t){switch(e){case"focusin":case"focusout":kr=null;break;case"dragenter":case"dragleave":Er=null;break;case"mouseover":case"mouseout":Nr=null;break;case"pointerover":case"pointerout":go.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":vo.delete(t.pointerId)}}function Fi(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Bo(t),t!==null&&Gd(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function _0(e,t,n,r,s){switch(t){case"focusin":return kr=Fi(kr,e,t,n,r,s),!0;case"dragenter":return Er=Fi(Er,e,t,n,r,s),!0;case"mouseover":return Nr=Fi(Nr,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return go.set(i,Fi(go.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,vo.set(i,Fi(vo.get(i)||null,e,t,n,r,s)),!0}return!1}function Wg(e){var t=Kr(e.target);if(t!==null){var n=xs(t);if(n!==null){if(t=n.tag,t===13){if(t=Lg(n),t!==null){e.blockedOn=t,Vg(e.priority,function(){Bg(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ol(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Tc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Ec=r,n.target.dispatchEvent(r),Ec=null}else return t=Bo(n),t!==null&&Gd(t),e.blockedOn=n,!1;t.shift()}return!0}function wh(e,t,n){Ol(e)&&n.delete(t)}function F0(){Pc=!1,kr!==null&&Ol(kr)&&(kr=null),Er!==null&&Ol(Er)&&(Er=null),Nr!==null&&Ol(Nr)&&(Nr=null),go.forEach(wh),vo.forEach(wh)}function Oi(e,t){e.blockedOn===t&&(e.blockedOn=null,Pc||(Pc=!0,Jt.unstable_scheduleCallback(Jt.unstable_NormalPriority,F0)))}function yo(e){function t(s){return Oi(s,e)}if(0<pl.length){Oi(pl[0],e);for(var n=1;n<pl.length;n++){var r=pl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(kr!==null&&Oi(kr,e),Er!==null&&Oi(Er,e),Nr!==null&&Oi(Nr,e),go.forEach(t),vo.forEach(t),n=0;n<dr.length;n++)r=dr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<dr.length&&(n=dr[0],n.blockedOn===null);)Wg(n),n.blockedOn===null&&dr.shift()}var Qs=tr.ReactCurrentBatchConfig,oa=!0;function O0(e,t,n,r){var s=ze,i=Qs.transition;Qs.transition=null;try{ze=1,Jd(e,t,n,r)}finally{ze=s,Qs.transition=i}}function A0(e,t,n,r){var s=ze,i=Qs.transition;Qs.transition=null;try{ze=4,Jd(e,t,n,r)}finally{ze=s,Qs.transition=i}}function Jd(e,t,n,r){if(oa){var s=Tc(e,t,n,r);if(s===null)$u(e,t,r,la,n),xh(e,r);else if(_0(s,e,t,n,r))r.stopPropagation();else if(xh(e,r),t&4&&-1<I0.indexOf(e)){for(;s!==null;){var i=Bo(s);if(i!==null&&$g(i),i=Tc(e,t,n,r),i===null&&$u(e,t,r,la,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else $u(e,t,r,null,n)}}var la=null;function Tc(e,t,n,r){if(la=null,e=Yd(r),e=Kr(e),e!==null)if(t=xs(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Lg(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return la=e,null}function Hg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(k0()){case Xd:return 1;case Og:return 4;case sa:case E0:return 16;case Ag:return 536870912;default:return 16}default:return 16}}var br=null,Zd=null,Al=null;function Qg(){if(Al)return Al;var e,t=Zd,n=t.length,r,s="value"in br?br.value:br.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return Al=s.slice(e,1<r?1-r:void 0)}function Dl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ml(){return!0}function Sh(){return!1}function en(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ml:Sh,this.isPropagationStopped=Sh,this}return Ge(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ml)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ml)},persist:function(){},isPersistent:ml}),t}var xi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ef=en(xi),$o=Ge({},xi,{view:0,detail:0}),D0=en($o),Tu,Lu,Ai,Aa=Ge({},$o,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ai&&(Ai&&e.type==="mousemove"?(Tu=e.screenX-Ai.screenX,Lu=e.screenY-Ai.screenY):Lu=Tu=0,Ai=e),Tu)},movementY:function(e){return"movementY"in e?e.movementY:Lu}}),bh=en(Aa),z0=Ge({},Aa,{dataTransfer:0}),$0=en(z0),B0=Ge({},$o,{relatedTarget:0}),Iu=en(B0),U0=Ge({},xi,{animationName:0,elapsedTime:0,pseudoElement:0}),V0=en(U0),W0=Ge({},xi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),H0=en(W0),Q0=Ge({},xi,{data:0}),Ch=en(Q0),K0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Y0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},X0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function q0(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=X0[e])?!!t[e]:!1}function tf(){return q0}var G0=Ge({},$o,{key:function(e){if(e.key){var t=K0[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Dl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Y0[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tf,charCode:function(e){return e.type==="keypress"?Dl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Dl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),J0=en(G0),Z0=Ge({},Aa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kh=en(Z0),ew=Ge({},$o,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tf}),tw=en(ew),nw=Ge({},xi,{propertyName:0,elapsedTime:0,pseudoElement:0}),rw=en(nw),sw=Ge({},Aa,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),iw=en(sw),ow=[9,13,27,32],nf=Gn&&"CompositionEvent"in window,to=null;Gn&&"documentMode"in document&&(to=document.documentMode);var lw=Gn&&"TextEvent"in window&&!to,Kg=Gn&&(!nf||to&&8<to&&11>=to),Eh=" ",Nh=!1;function Yg(e,t){switch(e){case"keyup":return ow.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Is=!1;function aw(e,t){switch(e){case"compositionend":return Xg(t);case"keypress":return t.which!==32?null:(Nh=!0,Eh);case"textInput":return e=t.data,e===Eh&&Nh?null:e;default:return null}}function uw(e,t){if(Is)return e==="compositionend"||!nf&&Yg(e,t)?(e=Qg(),Al=Zd=br=null,Is=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Kg&&t.locale!=="ko"?null:t.data;default:return null}}var cw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!cw[e.type]:t==="textarea"}function qg(e,t,n,r){jg(r),t=aa(t,"onChange"),0<t.length&&(n=new ef("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var no=null,xo=null;function dw(e){lv(e,0)}function Da(e){var t=Os(e);if(wg(t))return e}function fw(e,t){if(e==="change")return t}var Gg=!1;if(Gn){var _u;if(Gn){var Fu="oninput"in document;if(!Fu){var Mh=document.createElement("div");Mh.setAttribute("oninput","return;"),Fu=typeof Mh.oninput=="function"}_u=Fu}else _u=!1;Gg=_u&&(!document.documentMode||9<document.documentMode)}function Rh(){no&&(no.detachEvent("onpropertychange",Jg),xo=no=null)}function Jg(e){if(e.propertyName==="value"&&Da(xo)){var t=[];qg(t,xo,e,Yd(e)),Tg(dw,t)}}function hw(e,t,n){e==="focusin"?(Rh(),no=t,xo=n,no.attachEvent("onpropertychange",Jg)):e==="focusout"&&Rh()}function pw(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Da(xo)}function mw(e,t){if(e==="click")return Da(t)}function gw(e,t){if(e==="input"||e==="change")return Da(t)}function vw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var kn=typeof Object.is=="function"?Object.is:vw;function wo(e,t){if(kn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!hc.call(t,s)||!kn(e[s],t[s]))return!1}return!0}function Ph(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Th(e,t){var n=Ph(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ph(n)}}function Zg(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Zg(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function ev(){for(var e=window,t=ta();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ta(e.document)}return t}function rf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function yw(e){var t=ev(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Zg(n.ownerDocument.documentElement,n)){if(r!==null&&rf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=Th(n,i);var o=Th(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var xw=Gn&&"documentMode"in document&&11>=document.documentMode,_s=null,Lc=null,ro=null,Ic=!1;function Lh(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ic||_s==null||_s!==ta(r)||(r=_s,"selectionStart"in r&&rf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ro&&wo(ro,r)||(ro=r,r=aa(Lc,"onSelect"),0<r.length&&(t=new ef("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=_s)))}function gl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Fs={animationend:gl("Animation","AnimationEnd"),animationiteration:gl("Animation","AnimationIteration"),animationstart:gl("Animation","AnimationStart"),transitionend:gl("Transition","TransitionEnd")},Ou={},tv={};Gn&&(tv=document.createElement("div").style,"AnimationEvent"in window||(delete Fs.animationend.animation,delete Fs.animationiteration.animation,delete Fs.animationstart.animation),"TransitionEvent"in window||delete Fs.transitionend.transition);function za(e){if(Ou[e])return Ou[e];if(!Fs[e])return e;var t=Fs[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in tv)return Ou[e]=t[n];return e}var nv=za("animationend"),rv=za("animationiteration"),sv=za("animationstart"),iv=za("transitionend"),ov=new Map,Ih="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(e,t){ov.set(e,t),ys(t,[e])}for(var Au=0;Au<Ih.length;Au++){var Du=Ih[Au],ww=Du.toLowerCase(),Sw=Du[0].toUpperCase()+Du.slice(1);Or(ww,"on"+Sw)}Or(nv,"onAnimationEnd");Or(rv,"onAnimationIteration");Or(sv,"onAnimationStart");Or("dblclick","onDoubleClick");Or("focusin","onFocus");Or("focusout","onBlur");Or(iv,"onTransitionEnd");ci("onMouseEnter",["mouseout","mouseover"]);ci("onMouseLeave",["mouseout","mouseover"]);ci("onPointerEnter",["pointerout","pointerover"]);ci("onPointerLeave",["pointerout","pointerover"]);ys("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ys("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ys("onBeforeInput",["compositionend","keypress","textInput","paste"]);ys("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ys("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ys("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bw=new Set("cancel close invalid load scroll toggle".split(" ").concat(qi));function _h(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,w0(r,t,void 0,e),e.currentTarget=null}function lv(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;_h(s,l,d),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;_h(s,l,d),i=c}}}if(ra)throw e=Mc,ra=!1,Mc=null,e}function Ve(e,t){var n=t[Dc];n===void 0&&(n=t[Dc]=new Set);var r=e+"__bubble";n.has(r)||(av(t,e,2,!1),n.add(r))}function zu(e,t,n){var r=0;t&&(r|=4),av(n,e,r,t)}var vl="_reactListening"+Math.random().toString(36).slice(2);function So(e){if(!e[vl]){e[vl]=!0,mg.forEach(function(n){n!=="selectionchange"&&(bw.has(n)||zu(n,!1,e),zu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[vl]||(t[vl]=!0,zu("selectionchange",!1,t))}}function av(e,t,n,r){switch(Hg(t)){case 1:var s=O0;break;case 4:s=A0;break;default:s=Jd}n=s.bind(null,t,n,e),s=void 0,!jc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function $u(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Kr(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Tg(function(){var d=i,f=Yd(n),p=[];e:{var h=ov.get(e);if(h!==void 0){var S=ef,x=e;switch(e){case"keypress":if(Dl(n)===0)break e;case"keydown":case"keyup":S=J0;break;case"focusin":x="focus",S=Iu;break;case"focusout":x="blur",S=Iu;break;case"beforeblur":case"afterblur":S=Iu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=bh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=$0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=tw;break;case nv:case rv:case sv:S=V0;break;case iv:S=rw;break;case"scroll":S=D0;break;case"wheel":S=iw;break;case"copy":case"cut":case"paste":S=H0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=kh}var w=(t&4)!==0,C=!w&&e==="scroll",y=w?h!==null?h+"Capture":null:h;w=[];for(var m=d,v;m!==null;){v=m;var g=v.stateNode;if(v.tag===5&&g!==null&&(v=g,y!==null&&(g=mo(m,y),g!=null&&w.push(bo(m,g,v)))),C)break;m=m.return}0<w.length&&(h=new S(h,x,null,n,f),p.push({event:h,listeners:w}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",S=e==="mouseout"||e==="pointerout",h&&n!==Ec&&(x=n.relatedTarget||n.fromElement)&&(Kr(x)||x[Jn]))break e;if((S||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,S?(x=n.relatedTarget||n.toElement,S=d,x=x?Kr(x):null,x!==null&&(C=xs(x),x!==C||x.tag!==5&&x.tag!==6)&&(x=null)):(S=null,x=d),S!==x)){if(w=bh,g="onMouseLeave",y="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(w=kh,g="onPointerLeave",y="onPointerEnter",m="pointer"),C=S==null?h:Os(S),v=x==null?h:Os(x),h=new w(g,m+"leave",S,n,f),h.target=C,h.relatedTarget=v,g=null,Kr(f)===d&&(w=new w(y,m+"enter",x,n,f),w.target=v,w.relatedTarget=C,g=w),C=g,S&&x)t:{for(w=S,y=x,m=0,v=w;v;v=Ns(v))m++;for(v=0,g=y;g;g=Ns(g))v++;for(;0<m-v;)w=Ns(w),m--;for(;0<v-m;)y=Ns(y),v--;for(;m--;){if(w===y||y!==null&&w===y.alternate)break t;w=Ns(w),y=Ns(y)}w=null}else w=null;S!==null&&Fh(p,h,S,w,!1),x!==null&&C!==null&&Fh(p,C,x,w,!0)}}e:{if(h=d?Os(d):window,S=h.nodeName&&h.nodeName.toLowerCase(),S==="select"||S==="input"&&h.type==="file")var b=fw;else if(jh(h))if(Gg)b=gw;else{b=pw;var N=hw}else(S=h.nodeName)&&S.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(b=mw);if(b&&(b=b(e,d))){qg(p,b,n,f);break e}N&&N(e,h,d),e==="focusout"&&(N=h._wrapperState)&&N.controlled&&h.type==="number"&&wc(h,"number",h.value)}switch(N=d?Os(d):window,e){case"focusin":(jh(N)||N.contentEditable==="true")&&(_s=N,Lc=d,ro=null);break;case"focusout":ro=Lc=_s=null;break;case"mousedown":Ic=!0;break;case"contextmenu":case"mouseup":case"dragend":Ic=!1,Lh(p,n,f);break;case"selectionchange":if(xw)break;case"keydown":case"keyup":Lh(p,n,f)}var j;if(nf)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Is?Yg(e,n)&&(E="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(Kg&&n.locale!=="ko"&&(Is||E!=="onCompositionStart"?E==="onCompositionEnd"&&Is&&(j=Qg()):(br=f,Zd="value"in br?br.value:br.textContent,Is=!0)),N=aa(d,E),0<N.length&&(E=new Ch(E,e,null,n,f),p.push({event:E,listeners:N}),j?E.data=j:(j=Xg(n),j!==null&&(E.data=j)))),(j=lw?aw(e,n):uw(e,n))&&(d=aa(d,"onBeforeInput"),0<d.length&&(f=new Ch("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=j))}lv(p,t)})}function bo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function aa(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=mo(e,n),i!=null&&r.unshift(bo(e,i,s)),i=mo(e,t),i!=null&&r.push(bo(e,i,s))),e=e.return}return r}function Ns(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Fh(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,s?(c=mo(n,i),c!=null&&o.unshift(bo(n,c,l))):s||(c=mo(n,i),c!=null&&o.push(bo(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var Cw=/\r\n?/g,kw=/\u0000|\uFFFD/g;function Oh(e){return(typeof e=="string"?e:""+e).replace(Cw,`
`).replace(kw,"")}function yl(e,t,n){if(t=Oh(t),Oh(e)!==t&&n)throw Error(Q(425))}function ua(){}var _c=null,Fc=null;function Oc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Ac=typeof setTimeout=="function"?setTimeout:void 0,Ew=typeof clearTimeout=="function"?clearTimeout:void 0,Ah=typeof Promise=="function"?Promise:void 0,Nw=typeof queueMicrotask=="function"?queueMicrotask:typeof Ah<"u"?function(e){return Ah.resolve(null).then(e).catch(jw)}:Ac;function jw(e){setTimeout(function(){throw e})}function Bu(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),yo(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);yo(t)}function jr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Dh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var wi=Math.random().toString(36).slice(2),Tn="__reactFiber$"+wi,Co="__reactProps$"+wi,Jn="__reactContainer$"+wi,Dc="__reactEvents$"+wi,Mw="__reactListeners$"+wi,Rw="__reactHandles$"+wi;function Kr(e){var t=e[Tn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Jn]||n[Tn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Dh(e);e!==null;){if(n=e[Tn])return n;e=Dh(e)}return t}e=n,n=e.parentNode}return null}function Bo(e){return e=e[Tn]||e[Jn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Os(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Q(33))}function $a(e){return e[Co]||null}var zc=[],As=-1;function Ar(e){return{current:e}}function We(e){0>As||(e.current=zc[As],zc[As]=null,As--)}function Be(e,t){As++,zc[As]=e.current,e.current=t}var Fr={},Mt=Ar(Fr),Wt=Ar(!1),ds=Fr;function di(e,t){var n=e.type.contextTypes;if(!n)return Fr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ht(e){return e=e.childContextTypes,e!=null}function ca(){We(Wt),We(Mt)}function zh(e,t,n){if(Mt.current!==Fr)throw Error(Q(168));Be(Mt,t),Be(Wt,n)}function uv(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(Q(108,h0(e)||"Unknown",s));return Ge({},n,r)}function da(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Fr,ds=Mt.current,Be(Mt,e),Be(Wt,Wt.current),!0}function $h(e,t,n){var r=e.stateNode;if(!r)throw Error(Q(169));n?(e=uv(e,t,ds),r.__reactInternalMemoizedMergedChildContext=e,We(Wt),We(Mt),Be(Mt,e)):We(Wt),Be(Wt,n)}var Bn=null,Ba=!1,Uu=!1;function cv(e){Bn===null?Bn=[e]:Bn.push(e)}function Pw(e){Ba=!0,cv(e)}function Dr(){if(!Uu&&Bn!==null){Uu=!0;var e=0,t=ze;try{var n=Bn;for(ze=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Bn=null,Ba=!1}catch(s){throw Bn!==null&&(Bn=Bn.slice(e+1)),Fg(Xd,Dr),s}finally{ze=t,Uu=!1}}return null}var Ds=[],zs=0,fa=null,ha=0,sn=[],on=0,fs=null,Qn=1,Kn="";function Hr(e,t){Ds[zs++]=ha,Ds[zs++]=fa,fa=e,ha=t}function dv(e,t,n){sn[on++]=Qn,sn[on++]=Kn,sn[on++]=fs,fs=e;var r=Qn;e=Kn;var s=32-bn(r)-1;r&=~(1<<s),n+=1;var i=32-bn(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Qn=1<<32-bn(t)+s|n<<s|r,Kn=i+e}else Qn=1<<i|n<<s|r,Kn=e}function sf(e){e.return!==null&&(Hr(e,1),dv(e,1,0))}function of(e){for(;e===fa;)fa=Ds[--zs],Ds[zs]=null,ha=Ds[--zs],Ds[zs]=null;for(;e===fs;)fs=sn[--on],sn[on]=null,Kn=sn[--on],sn[on]=null,Qn=sn[--on],sn[on]=null}var qt=null,Xt=null,He=!1,Sn=null;function fv(e,t){var n=an(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Bh(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,qt=e,Xt=jr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,qt=e,Xt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=fs!==null?{id:Qn,overflow:Kn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=an(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,qt=e,Xt=null,!0):!1;default:return!1}}function $c(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Bc(e){if(He){var t=Xt;if(t){var n=t;if(!Bh(e,t)){if($c(e))throw Error(Q(418));t=jr(n.nextSibling);var r=qt;t&&Bh(e,t)?fv(r,n):(e.flags=e.flags&-4097|2,He=!1,qt=e)}}else{if($c(e))throw Error(Q(418));e.flags=e.flags&-4097|2,He=!1,qt=e}}}function Uh(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;qt=e}function xl(e){if(e!==qt)return!1;if(!He)return Uh(e),He=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Oc(e.type,e.memoizedProps)),t&&(t=Xt)){if($c(e))throw hv(),Error(Q(418));for(;t;)fv(e,t),t=jr(t.nextSibling)}if(Uh(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Xt=jr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Xt=null}}else Xt=qt?jr(e.stateNode.nextSibling):null;return!0}function hv(){for(var e=Xt;e;)e=jr(e.nextSibling)}function fi(){Xt=qt=null,He=!1}function lf(e){Sn===null?Sn=[e]:Sn.push(e)}var Tw=tr.ReactCurrentBatchConfig;function Di(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Q(309));var r=n.stateNode}if(!r)throw Error(Q(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Q(284));if(!n._owner)throw Error(Q(290,e))}return e}function wl(e,t){throw e=Object.prototype.toString.call(t),Error(Q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Vh(e){var t=e._init;return t(e._payload)}function pv(e){function t(y,m){if(e){var v=y.deletions;v===null?(y.deletions=[m],y.flags|=16):v.push(m)}}function n(y,m){if(!e)return null;for(;m!==null;)t(y,m),m=m.sibling;return null}function r(y,m){for(y=new Map;m!==null;)m.key!==null?y.set(m.key,m):y.set(m.index,m),m=m.sibling;return y}function s(y,m){return y=Tr(y,m),y.index=0,y.sibling=null,y}function i(y,m,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<m?(y.flags|=2,m):v):(y.flags|=2,m)):(y.flags|=1048576,m)}function o(y){return e&&y.alternate===null&&(y.flags|=2),y}function l(y,m,v,g){return m===null||m.tag!==6?(m=Xu(v,y.mode,g),m.return=y,m):(m=s(m,v),m.return=y,m)}function c(y,m,v,g){var b=v.type;return b===Ls?f(y,m,v.props.children,g,v.key):m!==null&&(m.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ur&&Vh(b)===m.type)?(g=s(m,v.props),g.ref=Di(y,m,v),g.return=y,g):(g=Hl(v.type,v.key,v.props,null,y.mode,g),g.ref=Di(y,m,v),g.return=y,g)}function d(y,m,v,g){return m===null||m.tag!==4||m.stateNode.containerInfo!==v.containerInfo||m.stateNode.implementation!==v.implementation?(m=qu(v,y.mode,g),m.return=y,m):(m=s(m,v.children||[]),m.return=y,m)}function f(y,m,v,g,b){return m===null||m.tag!==7?(m=cs(v,y.mode,g,b),m.return=y,m):(m=s(m,v),m.return=y,m)}function p(y,m,v){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Xu(""+m,y.mode,v),m.return=y,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case ul:return v=Hl(m.type,m.key,m.props,null,y.mode,v),v.ref=Di(y,null,m),v.return=y,v;case Ts:return m=qu(m,y.mode,v),m.return=y,m;case ur:var g=m._init;return p(y,g(m._payload),v)}if(Yi(m)||Ii(m))return m=cs(m,y.mode,v,null),m.return=y,m;wl(y,m)}return null}function h(y,m,v,g){var b=m!==null?m.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return b!==null?null:l(y,m,""+v,g);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ul:return v.key===b?c(y,m,v,g):null;case Ts:return v.key===b?d(y,m,v,g):null;case ur:return b=v._init,h(y,m,b(v._payload),g)}if(Yi(v)||Ii(v))return b!==null?null:f(y,m,v,g,null);wl(y,v)}return null}function S(y,m,v,g,b){if(typeof g=="string"&&g!==""||typeof g=="number")return y=y.get(v)||null,l(m,y,""+g,b);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case ul:return y=y.get(g.key===null?v:g.key)||null,c(m,y,g,b);case Ts:return y=y.get(g.key===null?v:g.key)||null,d(m,y,g,b);case ur:var N=g._init;return S(y,m,v,N(g._payload),b)}if(Yi(g)||Ii(g))return y=y.get(v)||null,f(m,y,g,b,null);wl(m,g)}return null}function x(y,m,v,g){for(var b=null,N=null,j=m,E=m=0,O=null;j!==null&&E<v.length;E++){j.index>E?(O=j,j=null):O=j.sibling;var L=h(y,j,v[E],g);if(L===null){j===null&&(j=O);break}e&&j&&L.alternate===null&&t(y,j),m=i(L,m,E),N===null?b=L:N.sibling=L,N=L,j=O}if(E===v.length)return n(y,j),He&&Hr(y,E),b;if(j===null){for(;E<v.length;E++)j=p(y,v[E],g),j!==null&&(m=i(j,m,E),N===null?b=j:N.sibling=j,N=j);return He&&Hr(y,E),b}for(j=r(y,j);E<v.length;E++)O=S(j,y,E,v[E],g),O!==null&&(e&&O.alternate!==null&&j.delete(O.key===null?E:O.key),m=i(O,m,E),N===null?b=O:N.sibling=O,N=O);return e&&j.forEach(function(A){return t(y,A)}),He&&Hr(y,E),b}function w(y,m,v,g){var b=Ii(v);if(typeof b!="function")throw Error(Q(150));if(v=b.call(v),v==null)throw Error(Q(151));for(var N=b=null,j=m,E=m=0,O=null,L=v.next();j!==null&&!L.done;E++,L=v.next()){j.index>E?(O=j,j=null):O=j.sibling;var A=h(y,j,L.value,g);if(A===null){j===null&&(j=O);break}e&&j&&A.alternate===null&&t(y,j),m=i(A,m,E),N===null?b=A:N.sibling=A,N=A,j=O}if(L.done)return n(y,j),He&&Hr(y,E),b;if(j===null){for(;!L.done;E++,L=v.next())L=p(y,L.value,g),L!==null&&(m=i(L,m,E),N===null?b=L:N.sibling=L,N=L);return He&&Hr(y,E),b}for(j=r(y,j);!L.done;E++,L=v.next())L=S(j,y,E,L.value,g),L!==null&&(e&&L.alternate!==null&&j.delete(L.key===null?E:L.key),m=i(L,m,E),N===null?b=L:N.sibling=L,N=L);return e&&j.forEach(function(z){return t(y,z)}),He&&Hr(y,E),b}function C(y,m,v,g){if(typeof v=="object"&&v!==null&&v.type===Ls&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case ul:e:{for(var b=v.key,N=m;N!==null;){if(N.key===b){if(b=v.type,b===Ls){if(N.tag===7){n(y,N.sibling),m=s(N,v.props.children),m.return=y,y=m;break e}}else if(N.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===ur&&Vh(b)===N.type){n(y,N.sibling),m=s(N,v.props),m.ref=Di(y,N,v),m.return=y,y=m;break e}n(y,N);break}else t(y,N);N=N.sibling}v.type===Ls?(m=cs(v.props.children,y.mode,g,v.key),m.return=y,y=m):(g=Hl(v.type,v.key,v.props,null,y.mode,g),g.ref=Di(y,m,v),g.return=y,y=g)}return o(y);case Ts:e:{for(N=v.key;m!==null;){if(m.key===N)if(m.tag===4&&m.stateNode.containerInfo===v.containerInfo&&m.stateNode.implementation===v.implementation){n(y,m.sibling),m=s(m,v.children||[]),m.return=y,y=m;break e}else{n(y,m);break}else t(y,m);m=m.sibling}m=qu(v,y.mode,g),m.return=y,y=m}return o(y);case ur:return N=v._init,C(y,m,N(v._payload),g)}if(Yi(v))return x(y,m,v,g);if(Ii(v))return w(y,m,v,g);wl(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,m!==null&&m.tag===6?(n(y,m.sibling),m=s(m,v),m.return=y,y=m):(n(y,m),m=Xu(v,y.mode,g),m.return=y,y=m),o(y)):n(y,m)}return C}var hi=pv(!0),mv=pv(!1),pa=Ar(null),ma=null,$s=null,af=null;function uf(){af=$s=ma=null}function cf(e){var t=pa.current;We(pa),e._currentValue=t}function Uc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ks(e,t){ma=e,af=$s=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Vt=!0),e.firstContext=null)}function cn(e){var t=e._currentValue;if(af!==e)if(e={context:e,memoizedValue:t,next:null},$s===null){if(ma===null)throw Error(Q(308));$s=e,ma.dependencies={lanes:0,firstContext:e}}else $s=$s.next=e;return t}var Yr=null;function df(e){Yr===null?Yr=[e]:Yr.push(e)}function gv(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,df(t)):(n.next=s.next,s.next=n),t.interleaved=n,Zn(e,r)}function Zn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var cr=!1;function ff(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Yn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Mr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ie&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Zn(e,n)}return s=r.interleaved,s===null?(t.next=t,df(r)):(t.next=s.next,s.next=t),r.interleaved=t,Zn(e,n)}function zl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,qd(e,n)}}function Wh(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ga(e,t,n,r){var s=e.updateQueue;cr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=c))}if(i!==null){var p=s.baseState;o=0,f=d=c=null,l=i;do{var h=l.lane,S=l.eventTime;if((r&h)===h){f!==null&&(f=f.next={eventTime:S,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,w=l;switch(h=t,S=n,w.tag){case 1:if(x=w.payload,typeof x=="function"){p=x.call(S,p,h);break e}p=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=w.payload,h=typeof x=="function"?x.call(S,p,h):x,h==null)break e;p=Ge({},p,h);break e;case 2:cr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else S={eventTime:S,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=S,c=p):f=f.next=S,o|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(f===null&&(c=p),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);ps|=o,e.lanes=o,e.memoizedState=p}}function Hh(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Q(191,s));s.call(r)}}}var Uo={},In=Ar(Uo),ko=Ar(Uo),Eo=Ar(Uo);function Xr(e){if(e===Uo)throw Error(Q(174));return e}function hf(e,t){switch(Be(Eo,t),Be(ko,e),Be(In,Uo),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:bc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=bc(t,e)}We(In),Be(In,t)}function pi(){We(In),We(ko),We(Eo)}function yv(e){Xr(Eo.current);var t=Xr(In.current),n=bc(t,e.type);t!==n&&(Be(ko,e),Be(In,n))}function pf(e){ko.current===e&&(We(In),We(ko))}var Xe=Ar(0);function va(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vu=[];function mf(){for(var e=0;e<Vu.length;e++)Vu[e]._workInProgressVersionPrimary=null;Vu.length=0}var $l=tr.ReactCurrentDispatcher,Wu=tr.ReactCurrentBatchConfig,hs=0,qe=null,at=null,pt=null,ya=!1,so=!1,No=0,Lw=0;function kt(){throw Error(Q(321))}function gf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!kn(e[n],t[n]))return!1;return!0}function vf(e,t,n,r,s,i){if(hs=i,qe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,$l.current=e===null||e.memoizedState===null?Ow:Aw,e=n(r,s),so){i=0;do{if(so=!1,No=0,25<=i)throw Error(Q(301));i+=1,pt=at=null,t.updateQueue=null,$l.current=Dw,e=n(r,s)}while(so)}if($l.current=xa,t=at!==null&&at.next!==null,hs=0,pt=at=qe=null,ya=!1,t)throw Error(Q(300));return e}function yf(){var e=No!==0;return No=0,e}function jn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?qe.memoizedState=pt=e:pt=pt.next=e,pt}function dn(){if(at===null){var e=qe.alternate;e=e!==null?e.memoizedState:null}else e=at.next;var t=pt===null?qe.memoizedState:pt.next;if(t!==null)pt=t,at=e;else{if(e===null)throw Error(Q(310));at=e,e={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},pt===null?qe.memoizedState=pt=e:pt=pt.next=e}return pt}function jo(e,t){return typeof t=="function"?t(e):t}function Hu(e){var t=dn(),n=t.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=e;var r=at,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,d=i;do{var f=d.lane;if((hs&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,qe.lanes|=f,ps|=f}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=l,kn(r,t.memoizedState)||(Vt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,qe.lanes|=i,ps|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Qu(e){var t=dn(),n=t.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);kn(i,t.memoizedState)||(Vt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function xv(){}function wv(e,t){var n=qe,r=dn(),s=t(),i=!kn(r.memoizedState,s);if(i&&(r.memoizedState=s,Vt=!0),r=r.queue,xf(Cv.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||pt!==null&&pt.memoizedState.tag&1){if(n.flags|=2048,Mo(9,bv.bind(null,n,r,s,t),void 0,null),mt===null)throw Error(Q(349));hs&30||Sv(n,t,s)}return s}function Sv(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=qe.updateQueue,t===null?(t={lastEffect:null,stores:null},qe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function bv(e,t,n,r){t.value=n,t.getSnapshot=r,kv(t)&&Ev(e)}function Cv(e,t,n){return n(function(){kv(t)&&Ev(e)})}function kv(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!kn(e,n)}catch{return!0}}function Ev(e){var t=Zn(e,1);t!==null&&Cn(t,e,1,-1)}function Qh(e){var t=jn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jo,lastRenderedState:e},t.queue=e,e=e.dispatch=Fw.bind(null,qe,e),[t.memoizedState,e]}function Mo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=qe.updateQueue,t===null?(t={lastEffect:null,stores:null},qe.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Nv(){return dn().memoizedState}function Bl(e,t,n,r){var s=jn();qe.flags|=e,s.memoizedState=Mo(1|t,n,void 0,r===void 0?null:r)}function Ua(e,t,n,r){var s=dn();r=r===void 0?null:r;var i=void 0;if(at!==null){var o=at.memoizedState;if(i=o.destroy,r!==null&&gf(r,o.deps)){s.memoizedState=Mo(t,n,i,r);return}}qe.flags|=e,s.memoizedState=Mo(1|t,n,i,r)}function Kh(e,t){return Bl(8390656,8,e,t)}function xf(e,t){return Ua(2048,8,e,t)}function jv(e,t){return Ua(4,2,e,t)}function Mv(e,t){return Ua(4,4,e,t)}function Rv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Pv(e,t,n){return n=n!=null?n.concat([e]):null,Ua(4,4,Rv.bind(null,t,e),n)}function wf(){}function Tv(e,t){var n=dn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&gf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Lv(e,t){var n=dn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&gf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Iv(e,t,n){return hs&21?(kn(n,t)||(n=Dg(),qe.lanes|=n,ps|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Vt=!0),e.memoizedState=n)}function Iw(e,t){var n=ze;ze=n!==0&&4>n?n:4,e(!0);var r=Wu.transition;Wu.transition={};try{e(!1),t()}finally{ze=n,Wu.transition=r}}function _v(){return dn().memoizedState}function _w(e,t,n){var r=Pr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Fv(e))Ov(t,n);else if(n=gv(e,t,n,r),n!==null){var s=_t();Cn(n,e,r,s),Av(n,t,r)}}function Fw(e,t,n){var r=Pr(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Fv(e))Ov(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,kn(l,o)){var c=t.interleaved;c===null?(s.next=s,df(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=gv(e,t,s,r),n!==null&&(s=_t(),Cn(n,e,r,s),Av(n,t,r))}}function Fv(e){var t=e.alternate;return e===qe||t!==null&&t===qe}function Ov(e,t){so=ya=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Av(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,qd(e,n)}}var xa={readContext:cn,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},Ow={readContext:cn,useCallback:function(e,t){return jn().memoizedState=[e,t===void 0?null:t],e},useContext:cn,useEffect:Kh,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Bl(4194308,4,Rv.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Bl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Bl(4,2,e,t)},useMemo:function(e,t){var n=jn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=jn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=_w.bind(null,qe,e),[r.memoizedState,e]},useRef:function(e){var t=jn();return e={current:e},t.memoizedState=e},useState:Qh,useDebugValue:wf,useDeferredValue:function(e){return jn().memoizedState=e},useTransition:function(){var e=Qh(!1),t=e[0];return e=Iw.bind(null,e[1]),jn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=qe,s=jn();if(He){if(n===void 0)throw Error(Q(407));n=n()}else{if(n=t(),mt===null)throw Error(Q(349));hs&30||Sv(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Kh(Cv.bind(null,r,i,e),[e]),r.flags|=2048,Mo(9,bv.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=jn(),t=mt.identifierPrefix;if(He){var n=Kn,r=Qn;n=(r&~(1<<32-bn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=No++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Lw++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Aw={readContext:cn,useCallback:Tv,useContext:cn,useEffect:xf,useImperativeHandle:Pv,useInsertionEffect:jv,useLayoutEffect:Mv,useMemo:Lv,useReducer:Hu,useRef:Nv,useState:function(){return Hu(jo)},useDebugValue:wf,useDeferredValue:function(e){var t=dn();return Iv(t,at.memoizedState,e)},useTransition:function(){var e=Hu(jo)[0],t=dn().memoizedState;return[e,t]},useMutableSource:xv,useSyncExternalStore:wv,useId:_v,unstable_isNewReconciler:!1},Dw={readContext:cn,useCallback:Tv,useContext:cn,useEffect:xf,useImperativeHandle:Pv,useInsertionEffect:jv,useLayoutEffect:Mv,useMemo:Lv,useReducer:Qu,useRef:Nv,useState:function(){return Qu(jo)},useDebugValue:wf,useDeferredValue:function(e){var t=dn();return at===null?t.memoizedState=e:Iv(t,at.memoizedState,e)},useTransition:function(){var e=Qu(jo)[0],t=dn().memoizedState;return[e,t]},useMutableSource:xv,useSyncExternalStore:wv,useId:_v,unstable_isNewReconciler:!1};function gn(e,t){if(e&&e.defaultProps){t=Ge({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Vc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Ge({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Va={isMounted:function(e){return(e=e._reactInternals)?xs(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=_t(),s=Pr(e),i=Yn(r,s);i.payload=t,n!=null&&(i.callback=n),t=Mr(e,i,s),t!==null&&(Cn(t,e,s,r),zl(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=_t(),s=Pr(e),i=Yn(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Mr(e,i,s),t!==null&&(Cn(t,e,s,r),zl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=_t(),r=Pr(e),s=Yn(n,r);s.tag=2,t!=null&&(s.callback=t),t=Mr(e,s,r),t!==null&&(Cn(t,e,r,n),zl(t,e,r))}};function Yh(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!wo(n,r)||!wo(s,i):!0}function Dv(e,t,n){var r=!1,s=Fr,i=t.contextType;return typeof i=="object"&&i!==null?i=cn(i):(s=Ht(t)?ds:Mt.current,r=t.contextTypes,i=(r=r!=null)?di(e,s):Fr),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Va,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Xh(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Va.enqueueReplaceState(t,t.state,null)}function Wc(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},ff(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=cn(i):(i=Ht(t)?ds:Mt.current,s.context=di(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Vc(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Va.enqueueReplaceState(s,s.state,null),ga(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function mi(e,t){try{var n="",r=t;do n+=f0(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Ku(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Hc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var zw=typeof WeakMap=="function"?WeakMap:Map;function zv(e,t,n){n=Yn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Sa||(Sa=!0,td=r),Hc(e,t)},n}function $v(e,t,n){n=Yn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Hc(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Hc(e,t),typeof r!="function"&&(Rr===null?Rr=new Set([this]):Rr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function qh(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new zw;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Zw.bind(null,e,t,n),t.then(e,e))}function Gh(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Jh(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Yn(-1,1),t.tag=2,Mr(n,t,1))),n.lanes|=1),e)}var $w=tr.ReactCurrentOwner,Vt=!1;function Lt(e,t,n,r){t.child=e===null?mv(t,null,n,r):hi(t,e.child,n,r)}function Zh(e,t,n,r,s){n=n.render;var i=t.ref;return Ks(t,s),r=vf(e,t,n,r,i,s),n=yf(),e!==null&&!Vt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,er(e,t,s)):(He&&n&&sf(t),t.flags|=1,Lt(e,t,r,s),t.child)}function ep(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!Mf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,Bv(e,t,i,r,s)):(e=Hl(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:wo,n(o,r)&&e.ref===t.ref)return er(e,t,s)}return t.flags|=1,e=Tr(i,r),e.ref=t.ref,e.return=t,t.child=e}function Bv(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(wo(i,r)&&e.ref===t.ref)if(Vt=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Vt=!0);else return t.lanes=e.lanes,er(e,t,s)}return Qc(e,t,n,r,s)}function Uv(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Be(Us,Yt),Yt|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Be(Us,Yt),Yt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Be(Us,Yt),Yt|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Be(Us,Yt),Yt|=r;return Lt(e,t,s,n),t.child}function Vv(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Qc(e,t,n,r,s){var i=Ht(n)?ds:Mt.current;return i=di(t,i),Ks(t,s),n=vf(e,t,n,r,i,s),r=yf(),e!==null&&!Vt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,er(e,t,s)):(He&&r&&sf(t),t.flags|=1,Lt(e,t,n,s),t.child)}function tp(e,t,n,r,s){if(Ht(n)){var i=!0;da(t)}else i=!1;if(Ks(t,s),t.stateNode===null)Ul(e,t),Dv(t,n,r),Wc(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=cn(d):(d=Ht(n)?ds:Mt.current,d=di(t,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&Xh(t,o,r,d),cr=!1;var h=t.memoizedState;o.state=h,ga(t,r,o,s),c=t.memoizedState,l!==r||h!==c||Wt.current||cr?(typeof f=="function"&&(Vc(t,n,f,r),c=t.memoizedState),(l=cr||Yh(t,n,l,r,h,c,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,vv(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:gn(t.type,l),o.props=d,p=t.pendingProps,h=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=cn(c):(c=Ht(n)?ds:Mt.current,c=di(t,c));var S=n.getDerivedStateFromProps;(f=typeof S=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||h!==c)&&Xh(t,o,r,c),cr=!1,h=t.memoizedState,o.state=h,ga(t,r,o,s);var x=t.memoizedState;l!==p||h!==x||Wt.current||cr?(typeof S=="function"&&(Vc(t,n,S,r),x=t.memoizedState),(d=cr||Yh(t,n,d,r,h,x,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=x),o.props=r,o.state=x,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Kc(e,t,n,r,i,s)}function Kc(e,t,n,r,s,i){Vv(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&$h(t,n,!1),er(e,t,i);r=t.stateNode,$w.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=hi(t,e.child,null,i),t.child=hi(t,null,l,i)):Lt(e,t,l,i),t.memoizedState=r.state,s&&$h(t,n,!0),t.child}function Wv(e){var t=e.stateNode;t.pendingContext?zh(e,t.pendingContext,t.pendingContext!==t.context):t.context&&zh(e,t.context,!1),hf(e,t.containerInfo)}function np(e,t,n,r,s){return fi(),lf(s),t.flags|=256,Lt(e,t,n,r),t.child}var Yc={dehydrated:null,treeContext:null,retryLane:0};function Xc(e){return{baseLanes:e,cachePool:null,transitions:null}}function Hv(e,t,n){var r=t.pendingProps,s=Xe.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Be(Xe,s&1),e===null)return Bc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Qa(o,r,0,null),e=cs(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Xc(n),t.memoizedState=Yc,e):Sf(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return Bw(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Tr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Tr(l,i):(i=cs(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?Xc(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=Yc,r}return i=e.child,e=i.sibling,r=Tr(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Sf(e,t){return t=Qa({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Sl(e,t,n,r){return r!==null&&lf(r),hi(t,e.child,null,n),e=Sf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Bw(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=Ku(Error(Q(422))),Sl(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Qa({mode:"visible",children:r.children},s,0,null),i=cs(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&hi(t,e.child,null,o),t.child.memoizedState=Xc(o),t.memoizedState=Yc,i);if(!(t.mode&1))return Sl(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(Q(419)),r=Ku(i,r,void 0),Sl(e,t,o,r)}if(l=(o&e.childLanes)!==0,Vt||l){if(r=mt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Zn(e,s),Cn(r,e,s,-1))}return jf(),r=Ku(Error(Q(421))),Sl(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=e1.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Xt=jr(s.nextSibling),qt=t,He=!0,Sn=null,e!==null&&(sn[on++]=Qn,sn[on++]=Kn,sn[on++]=fs,Qn=e.id,Kn=e.overflow,fs=t),t=Sf(t,r.children),t.flags|=4096,t)}function rp(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Uc(e.return,t,n)}function Yu(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Qv(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(Lt(e,t,r.children,n),r=Xe.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&rp(e,n,t);else if(e.tag===19)rp(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Be(Xe,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&va(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Yu(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&va(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Yu(t,!0,n,null,i);break;case"together":Yu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ul(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function er(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ps|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Q(153));if(t.child!==null){for(e=t.child,n=Tr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Tr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Uw(e,t,n){switch(t.tag){case 3:Wv(t),fi();break;case 5:yv(t);break;case 1:Ht(t.type)&&da(t);break;case 4:hf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Be(pa,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Be(Xe,Xe.current&1),t.flags|=128,null):n&t.child.childLanes?Hv(e,t,n):(Be(Xe,Xe.current&1),e=er(e,t,n),e!==null?e.sibling:null);Be(Xe,Xe.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Qv(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Be(Xe,Xe.current),r)break;return null;case 22:case 23:return t.lanes=0,Uv(e,t,n)}return er(e,t,n)}var Kv,qc,Yv,Xv;Kv=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};qc=function(){};Yv=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Xr(In.current);var i=null;switch(n){case"input":s=yc(e,s),r=yc(e,r),i=[];break;case"select":s=Ge({},s,{value:void 0}),r=Ge({},r,{value:void 0}),i=[];break;case"textarea":s=Sc(e,s),r=Sc(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ua)}Cc(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(ho.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(ho.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ve("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Xv=function(e,t,n,r){n!==r&&(t.flags|=4)};function zi(e,t){if(!He)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Et(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Vw(e,t,n){var r=t.pendingProps;switch(of(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(t),null;case 1:return Ht(t.type)&&ca(),Et(t),null;case 3:return r=t.stateNode,pi(),We(Wt),We(Mt),mf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(xl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Sn!==null&&(sd(Sn),Sn=null))),qc(e,t),Et(t),null;case 5:pf(t);var s=Xr(Eo.current);if(n=t.type,e!==null&&t.stateNode!=null)Yv(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Q(166));return Et(t),null}if(e=Xr(In.current),xl(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Tn]=t,r[Co]=i,e=(t.mode&1)!==0,n){case"dialog":Ve("cancel",r),Ve("close",r);break;case"iframe":case"object":case"embed":Ve("load",r);break;case"video":case"audio":for(s=0;s<qi.length;s++)Ve(qi[s],r);break;case"source":Ve("error",r);break;case"img":case"image":case"link":Ve("error",r),Ve("load",r);break;case"details":Ve("toggle",r);break;case"input":fh(r,i),Ve("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ve("invalid",r);break;case"textarea":ph(r,i),Ve("invalid",r)}Cc(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&yl(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&yl(r.textContent,l,e),s=["children",""+l]):ho.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ve("scroll",r)}switch(n){case"input":cl(r),hh(r,i,!0);break;case"textarea":cl(r),mh(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ua)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Cg(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Tn]=t,e[Co]=r,Kv(e,t,!1,!1),t.stateNode=e;e:{switch(o=kc(n,r),n){case"dialog":Ve("cancel",e),Ve("close",e),s=r;break;case"iframe":case"object":case"embed":Ve("load",e),s=r;break;case"video":case"audio":for(s=0;s<qi.length;s++)Ve(qi[s],e);s=r;break;case"source":Ve("error",e),s=r;break;case"img":case"image":case"link":Ve("error",e),Ve("load",e),s=r;break;case"details":Ve("toggle",e),s=r;break;case"input":fh(e,r),s=yc(e,r),Ve("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Ge({},r,{value:void 0}),Ve("invalid",e);break;case"textarea":ph(e,r),s=Sc(e,r),Ve("invalid",e);break;default:s=r}Cc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?Ng(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&kg(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&po(e,c):typeof c=="number"&&po(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(ho.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ve("scroll",e):c!=null&&Wd(e,i,c,o))}switch(n){case"input":cl(e),hh(e,r,!1);break;case"textarea":cl(e),mh(e);break;case"option":r.value!=null&&e.setAttribute("value",""+_r(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Vs(e,!!r.multiple,i,!1):r.defaultValue!=null&&Vs(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=ua)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Et(t),null;case 6:if(e&&t.stateNode!=null)Xv(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Q(166));if(n=Xr(Eo.current),Xr(In.current),xl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Tn]=t,(i=r.nodeValue!==n)&&(e=qt,e!==null))switch(e.tag){case 3:yl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&yl(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Tn]=t,t.stateNode=r}return Et(t),null;case 13:if(We(Xe),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(He&&Xt!==null&&t.mode&1&&!(t.flags&128))hv(),fi(),t.flags|=98560,i=!1;else if(i=xl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(Q(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Q(317));i[Tn]=t}else fi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Et(t),i=!1}else Sn!==null&&(sd(Sn),Sn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Xe.current&1?ct===0&&(ct=3):jf())),t.updateQueue!==null&&(t.flags|=4),Et(t),null);case 4:return pi(),qc(e,t),e===null&&So(t.stateNode.containerInfo),Et(t),null;case 10:return cf(t.type._context),Et(t),null;case 17:return Ht(t.type)&&ca(),Et(t),null;case 19:if(We(Xe),i=t.memoizedState,i===null)return Et(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)zi(i,!1);else{if(ct!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=va(e),o!==null){for(t.flags|=128,zi(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Be(Xe,Xe.current&1|2),t.child}e=e.sibling}i.tail!==null&&tt()>gi&&(t.flags|=128,r=!0,zi(i,!1),t.lanes=4194304)}else{if(!r)if(e=va(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),zi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!He)return Et(t),null}else 2*tt()-i.renderingStartTime>gi&&n!==1073741824&&(t.flags|=128,r=!0,zi(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=tt(),t.sibling=null,n=Xe.current,Be(Xe,r?n&1|2:n&1),t):(Et(t),null);case 22:case 23:return Nf(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Yt&1073741824&&(Et(t),t.subtreeFlags&6&&(t.flags|=8192)):Et(t),null;case 24:return null;case 25:return null}throw Error(Q(156,t.tag))}function Ww(e,t){switch(of(t),t.tag){case 1:return Ht(t.type)&&ca(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return pi(),We(Wt),We(Mt),mf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return pf(t),null;case 13:if(We(Xe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Q(340));fi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return We(Xe),null;case 4:return pi(),null;case 10:return cf(t.type._context),null;case 22:case 23:return Nf(),null;case 24:return null;default:return null}}var bl=!1,Nt=!1,Hw=typeof WeakSet=="function"?WeakSet:Set,ie=null;function Bs(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ze(e,t,r)}else n.current=null}function Gc(e,t,n){try{n()}catch(r){Ze(e,t,r)}}var sp=!1;function Qw(e,t){if(_c=oa,e=ev(),rf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,f=0,p=e,h=null;t:for(;;){for(var S;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(S=p.firstChild)!==null;)h=p,p=S;for(;;){if(p===e)break t;if(h===n&&++d===s&&(l=o),h===i&&++f===r&&(c=o),(S=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=S}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Fc={focusedElem:e,selectionRange:n},oa=!1,ie=t;ie!==null;)if(t=ie,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ie=e;else for(;ie!==null;){t=ie;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var w=x.memoizedProps,C=x.memoizedState,y=t.stateNode,m=y.getSnapshotBeforeUpdate(t.elementType===t.type?w:gn(t.type,w),C);y.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(g){Ze(t,t.return,g)}if(e=t.sibling,e!==null){e.return=t.return,ie=e;break}ie=t.return}return x=sp,sp=!1,x}function io(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Gc(t,n,i)}s=s.next}while(s!==r)}}function Wa(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Jc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function qv(e){var t=e.alternate;t!==null&&(e.alternate=null,qv(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Tn],delete t[Co],delete t[Dc],delete t[Mw],delete t[Rw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Gv(e){return e.tag===5||e.tag===3||e.tag===4}function ip(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Gv(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Zc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ua));else if(r!==4&&(e=e.child,e!==null))for(Zc(e,t,n),e=e.sibling;e!==null;)Zc(e,t,n),e=e.sibling}function ed(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(ed(e,t,n),e=e.sibling;e!==null;)ed(e,t,n),e=e.sibling}var yt=null,wn=!1;function or(e,t,n){for(n=n.child;n!==null;)Jv(e,t,n),n=n.sibling}function Jv(e,t,n){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(Oa,n)}catch{}switch(n.tag){case 5:Nt||Bs(n,t);case 6:var r=yt,s=wn;yt=null,or(e,t,n),yt=r,wn=s,yt!==null&&(wn?(e=yt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):yt.removeChild(n.stateNode));break;case 18:yt!==null&&(wn?(e=yt,n=n.stateNode,e.nodeType===8?Bu(e.parentNode,n):e.nodeType===1&&Bu(e,n),yo(e)):Bu(yt,n.stateNode));break;case 4:r=yt,s=wn,yt=n.stateNode.containerInfo,wn=!0,or(e,t,n),yt=r,wn=s;break;case 0:case 11:case 14:case 15:if(!Nt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Gc(n,t,o),s=s.next}while(s!==r)}or(e,t,n);break;case 1:if(!Nt&&(Bs(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ze(n,t,l)}or(e,t,n);break;case 21:or(e,t,n);break;case 22:n.mode&1?(Nt=(r=Nt)||n.memoizedState!==null,or(e,t,n),Nt=r):or(e,t,n);break;default:or(e,t,n)}}function op(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Hw),t.forEach(function(r){var s=t1.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function pn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:yt=l.stateNode,wn=!1;break e;case 3:yt=l.stateNode.containerInfo,wn=!0;break e;case 4:yt=l.stateNode.containerInfo,wn=!0;break e}l=l.return}if(yt===null)throw Error(Q(160));Jv(i,o,s),yt=null,wn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Ze(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Zv(t,e),t=t.sibling}function Zv(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pn(t,e),Nn(e),r&4){try{io(3,e,e.return),Wa(3,e)}catch(w){Ze(e,e.return,w)}try{io(5,e,e.return)}catch(w){Ze(e,e.return,w)}}break;case 1:pn(t,e),Nn(e),r&512&&n!==null&&Bs(n,n.return);break;case 5:if(pn(t,e),Nn(e),r&512&&n!==null&&Bs(n,n.return),e.flags&32){var s=e.stateNode;try{po(s,"")}catch(w){Ze(e,e.return,w)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Sg(s,i),kc(l,o);var d=kc(l,i);for(o=0;o<c.length;o+=2){var f=c[o],p=c[o+1];f==="style"?Ng(s,p):f==="dangerouslySetInnerHTML"?kg(s,p):f==="children"?po(s,p):Wd(s,f,p,d)}switch(l){case"input":xc(s,i);break;case"textarea":bg(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var S=i.value;S!=null?Vs(s,!!i.multiple,S,!1):h!==!!i.multiple&&(i.defaultValue!=null?Vs(s,!!i.multiple,i.defaultValue,!0):Vs(s,!!i.multiple,i.multiple?[]:"",!1))}s[Co]=i}catch(w){Ze(e,e.return,w)}}break;case 6:if(pn(t,e),Nn(e),r&4){if(e.stateNode===null)throw Error(Q(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(w){Ze(e,e.return,w)}}break;case 3:if(pn(t,e),Nn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{yo(t.containerInfo)}catch(w){Ze(e,e.return,w)}break;case 4:pn(t,e),Nn(e);break;case 13:pn(t,e),Nn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(kf=tt())),r&4&&op(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(Nt=(d=Nt)||f,pn(t,e),Nt=d):pn(t,e),Nn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!f&&e.mode&1)for(ie=e,f=e.child;f!==null;){for(p=ie=f;ie!==null;){switch(h=ie,S=h.child,h.tag){case 0:case 11:case 14:case 15:io(4,h,h.return);break;case 1:Bs(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(w){Ze(r,n,w)}}break;case 5:Bs(h,h.return);break;case 22:if(h.memoizedState!==null){ap(p);continue}}S!==null?(S.return=h,ie=S):ap(p)}f=f.sibling}e:for(f=null,p=e;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Eg("display",o))}catch(w){Ze(e,e.return,w)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(w){Ze(e,e.return,w)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:pn(t,e),Nn(e),r&4&&op(e);break;case 21:break;default:pn(t,e),Nn(e)}}function Nn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Gv(n)){var r=n;break e}n=n.return}throw Error(Q(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(po(s,""),r.flags&=-33);var i=ip(e);ed(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=ip(e);Zc(e,l,o);break;default:throw Error(Q(161))}}catch(c){Ze(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Kw(e,t,n){ie=e,ey(e)}function ey(e,t,n){for(var r=(e.mode&1)!==0;ie!==null;){var s=ie,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||bl;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Nt;l=bl;var d=Nt;if(bl=o,(Nt=c)&&!d)for(ie=s;ie!==null;)o=ie,c=o.child,o.tag===22&&o.memoizedState!==null?up(s):c!==null?(c.return=o,ie=c):up(s);for(;i!==null;)ie=i,ey(i),i=i.sibling;ie=s,bl=l,Nt=d}lp(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ie=i):lp(e)}}function lp(e){for(;ie!==null;){var t=ie;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Nt||Wa(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Nt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:gn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Hh(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Hh(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&yo(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}Nt||t.flags&512&&Jc(t)}catch(h){Ze(t,t.return,h)}}if(t===e){ie=null;break}if(n=t.sibling,n!==null){n.return=t.return,ie=n;break}ie=t.return}}function ap(e){for(;ie!==null;){var t=ie;if(t===e){ie=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ie=n;break}ie=t.return}}function up(e){for(;ie!==null;){var t=ie;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Wa(4,t)}catch(c){Ze(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){Ze(t,s,c)}}var i=t.return;try{Jc(t)}catch(c){Ze(t,i,c)}break;case 5:var o=t.return;try{Jc(t)}catch(c){Ze(t,o,c)}}}catch(c){Ze(t,t.return,c)}if(t===e){ie=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ie=l;break}ie=t.return}}var Yw=Math.ceil,wa=tr.ReactCurrentDispatcher,bf=tr.ReactCurrentOwner,un=tr.ReactCurrentBatchConfig,Ie=0,mt=null,st=null,xt=0,Yt=0,Us=Ar(0),ct=0,Ro=null,ps=0,Ha=0,Cf=0,oo=null,Ut=null,kf=0,gi=1/0,$n=null,Sa=!1,td=null,Rr=null,Cl=!1,Cr=null,ba=0,lo=0,nd=null,Vl=-1,Wl=0;function _t(){return Ie&6?tt():Vl!==-1?Vl:Vl=tt()}function Pr(e){return e.mode&1?Ie&2&&xt!==0?xt&-xt:Tw.transition!==null?(Wl===0&&(Wl=Dg()),Wl):(e=ze,e!==0||(e=window.event,e=e===void 0?16:Hg(e.type)),e):1}function Cn(e,t,n,r){if(50<lo)throw lo=0,nd=null,Error(Q(185));zo(e,n,r),(!(Ie&2)||e!==mt)&&(e===mt&&(!(Ie&2)&&(Ha|=n),ct===4&&fr(e,xt)),Qt(e,r),n===1&&Ie===0&&!(t.mode&1)&&(gi=tt()+500,Ba&&Dr()))}function Qt(e,t){var n=e.callbackNode;T0(e,t);var r=ia(e,e===mt?xt:0);if(r===0)n!==null&&yh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&yh(n),t===1)e.tag===0?Pw(cp.bind(null,e)):cv(cp.bind(null,e)),Nw(function(){!(Ie&6)&&Dr()}),n=null;else{switch(zg(r)){case 1:n=Xd;break;case 4:n=Og;break;case 16:n=sa;break;case 536870912:n=Ag;break;default:n=sa}n=ay(n,ty.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ty(e,t){if(Vl=-1,Wl=0,Ie&6)throw Error(Q(327));var n=e.callbackNode;if(Ys()&&e.callbackNode!==n)return null;var r=ia(e,e===mt?xt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Ca(e,r);else{t=r;var s=Ie;Ie|=2;var i=ry();(mt!==e||xt!==t)&&($n=null,gi=tt()+500,us(e,t));do try{Gw();break}catch(l){ny(e,l)}while(!0);uf(),wa.current=i,Ie=s,st!==null?t=0:(mt=null,xt=0,t=ct)}if(t!==0){if(t===2&&(s=Rc(e),s!==0&&(r=s,t=rd(e,s))),t===1)throw n=Ro,us(e,0),fr(e,r),Qt(e,tt()),n;if(t===6)fr(e,r);else{if(s=e.current.alternate,!(r&30)&&!Xw(s)&&(t=Ca(e,r),t===2&&(i=Rc(e),i!==0&&(r=i,t=rd(e,i))),t===1))throw n=Ro,us(e,0),fr(e,r),Qt(e,tt()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(Q(345));case 2:Qr(e,Ut,$n);break;case 3:if(fr(e,r),(r&130023424)===r&&(t=kf+500-tt(),10<t)){if(ia(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){_t(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Ac(Qr.bind(null,e,Ut,$n),t);break}Qr(e,Ut,$n);break;case 4:if(fr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-bn(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=tt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Yw(r/1960))-r,10<r){e.timeoutHandle=Ac(Qr.bind(null,e,Ut,$n),r);break}Qr(e,Ut,$n);break;case 5:Qr(e,Ut,$n);break;default:throw Error(Q(329))}}}return Qt(e,tt()),e.callbackNode===n?ty.bind(null,e):null}function rd(e,t){var n=oo;return e.current.memoizedState.isDehydrated&&(us(e,t).flags|=256),e=Ca(e,t),e!==2&&(t=Ut,Ut=n,t!==null&&sd(t)),e}function sd(e){Ut===null?Ut=e:Ut.push.apply(Ut,e)}function Xw(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!kn(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function fr(e,t){for(t&=~Cf,t&=~Ha,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-bn(t),r=1<<n;e[n]=-1,t&=~r}}function cp(e){if(Ie&6)throw Error(Q(327));Ys();var t=ia(e,0);if(!(t&1))return Qt(e,tt()),null;var n=Ca(e,t);if(e.tag!==0&&n===2){var r=Rc(e);r!==0&&(t=r,n=rd(e,r))}if(n===1)throw n=Ro,us(e,0),fr(e,t),Qt(e,tt()),n;if(n===6)throw Error(Q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Qr(e,Ut,$n),Qt(e,tt()),null}function Ef(e,t){var n=Ie;Ie|=1;try{return e(t)}finally{Ie=n,Ie===0&&(gi=tt()+500,Ba&&Dr())}}function ms(e){Cr!==null&&Cr.tag===0&&!(Ie&6)&&Ys();var t=Ie;Ie|=1;var n=un.transition,r=ze;try{if(un.transition=null,ze=1,e)return e()}finally{ze=r,un.transition=n,Ie=t,!(Ie&6)&&Dr()}}function Nf(){Yt=Us.current,We(Us)}function us(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Ew(n)),st!==null)for(n=st.return;n!==null;){var r=n;switch(of(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ca();break;case 3:pi(),We(Wt),We(Mt),mf();break;case 5:pf(r);break;case 4:pi();break;case 13:We(Xe);break;case 19:We(Xe);break;case 10:cf(r.type._context);break;case 22:case 23:Nf()}n=n.return}if(mt=e,st=e=Tr(e.current,null),xt=Yt=t,ct=0,Ro=null,Cf=Ha=ps=0,Ut=oo=null,Yr!==null){for(t=0;t<Yr.length;t++)if(n=Yr[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Yr=null}return e}function ny(e,t){do{var n=st;try{if(uf(),$l.current=xa,ya){for(var r=qe.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}ya=!1}if(hs=0,pt=at=qe=null,so=!1,No=0,bf.current=null,n===null||n.return===null){ct=1,Ro=t,st=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=xt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var S=Gh(o);if(S!==null){S.flags&=-257,Jh(S,o,l,i,t),S.mode&1&&qh(i,d,t),t=S,c=d;var x=t.updateQueue;if(x===null){var w=new Set;w.add(c),t.updateQueue=w}else x.add(c);break e}else{if(!(t&1)){qh(i,d,t),jf();break e}c=Error(Q(426))}}else if(He&&l.mode&1){var C=Gh(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Jh(C,o,l,i,t),lf(mi(c,l));break e}}i=c=mi(c,l),ct!==4&&(ct=2),oo===null?oo=[i]:oo.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var y=zv(i,c,t);Wh(i,y);break e;case 1:l=c;var m=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Rr===null||!Rr.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var g=$v(i,l,t);Wh(i,g);break e}}i=i.return}while(i!==null)}iy(n)}catch(b){t=b,st===n&&n!==null&&(st=n=n.return);continue}break}while(!0)}function ry(){var e=wa.current;return wa.current=xa,e===null?xa:e}function jf(){(ct===0||ct===3||ct===2)&&(ct=4),mt===null||!(ps&268435455)&&!(Ha&268435455)||fr(mt,xt)}function Ca(e,t){var n=Ie;Ie|=2;var r=ry();(mt!==e||xt!==t)&&($n=null,us(e,t));do try{qw();break}catch(s){ny(e,s)}while(!0);if(uf(),Ie=n,wa.current=r,st!==null)throw Error(Q(261));return mt=null,xt=0,ct}function qw(){for(;st!==null;)sy(st)}function Gw(){for(;st!==null&&!b0();)sy(st)}function sy(e){var t=ly(e.alternate,e,Yt);e.memoizedProps=e.pendingProps,t===null?iy(e):st=t,bf.current=null}function iy(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=Ww(n,t),n!==null){n.flags&=32767,st=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ct=6,st=null;return}}else if(n=Vw(n,t,Yt),n!==null){st=n;return}if(t=t.sibling,t!==null){st=t;return}st=t=e}while(t!==null);ct===0&&(ct=5)}function Qr(e,t,n){var r=ze,s=un.transition;try{un.transition=null,ze=1,Jw(e,t,n,r)}finally{un.transition=s,ze=r}return null}function Jw(e,t,n,r){do Ys();while(Cr!==null);if(Ie&6)throw Error(Q(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Q(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(L0(e,i),e===mt&&(st=mt=null,xt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Cl||(Cl=!0,ay(sa,function(){return Ys(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=un.transition,un.transition=null;var o=ze;ze=1;var l=Ie;Ie|=4,bf.current=null,Qw(e,n),Zv(n,e),yw(Fc),oa=!!_c,Fc=_c=null,e.current=n,Kw(n),C0(),Ie=l,ze=o,un.transition=i}else e.current=n;if(Cl&&(Cl=!1,Cr=e,ba=s),i=e.pendingLanes,i===0&&(Rr=null),N0(n.stateNode),Qt(e,tt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Sa)throw Sa=!1,e=td,td=null,e;return ba&1&&e.tag!==0&&Ys(),i=e.pendingLanes,i&1?e===nd?lo++:(lo=0,nd=e):lo=0,Dr(),null}function Ys(){if(Cr!==null){var e=zg(ba),t=un.transition,n=ze;try{if(un.transition=null,ze=16>e?16:e,Cr===null)var r=!1;else{if(e=Cr,Cr=null,ba=0,Ie&6)throw Error(Q(331));var s=Ie;for(Ie|=4,ie=e.current;ie!==null;){var i=ie,o=i.child;if(ie.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(ie=d;ie!==null;){var f=ie;switch(f.tag){case 0:case 11:case 15:io(8,f,i)}var p=f.child;if(p!==null)p.return=f,ie=p;else for(;ie!==null;){f=ie;var h=f.sibling,S=f.return;if(qv(f),f===d){ie=null;break}if(h!==null){h.return=S,ie=h;break}ie=S}}}var x=i.alternate;if(x!==null){var w=x.child;if(w!==null){x.child=null;do{var C=w.sibling;w.sibling=null,w=C}while(w!==null)}}ie=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ie=o;else e:for(;ie!==null;){if(i=ie,i.flags&2048)switch(i.tag){case 0:case 11:case 15:io(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,ie=y;break e}ie=i.return}}var m=e.current;for(ie=m;ie!==null;){o=ie;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,ie=v;else e:for(o=m;ie!==null;){if(l=ie,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Wa(9,l)}}catch(b){Ze(l,l.return,b)}if(l===o){ie=null;break e}var g=l.sibling;if(g!==null){g.return=l.return,ie=g;break e}ie=l.return}}if(Ie=s,Dr(),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(Oa,e)}catch{}r=!0}return r}finally{ze=n,un.transition=t}}return!1}function dp(e,t,n){t=mi(n,t),t=zv(e,t,1),e=Mr(e,t,1),t=_t(),e!==null&&(zo(e,1,t),Qt(e,t))}function Ze(e,t,n){if(e.tag===3)dp(e,e,n);else for(;t!==null;){if(t.tag===3){dp(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Rr===null||!Rr.has(r))){e=mi(n,e),e=$v(t,e,1),t=Mr(t,e,1),e=_t(),t!==null&&(zo(t,1,e),Qt(t,e));break}}t=t.return}}function Zw(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=_t(),e.pingedLanes|=e.suspendedLanes&n,mt===e&&(xt&n)===n&&(ct===4||ct===3&&(xt&130023424)===xt&&500>tt()-kf?us(e,0):Cf|=n),Qt(e,t)}function oy(e,t){t===0&&(e.mode&1?(t=hl,hl<<=1,!(hl&130023424)&&(hl=4194304)):t=1);var n=_t();e=Zn(e,t),e!==null&&(zo(e,t,n),Qt(e,n))}function e1(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),oy(e,n)}function t1(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Q(314))}r!==null&&r.delete(t),oy(e,n)}var ly;ly=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wt.current)Vt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Vt=!1,Uw(e,t,n);Vt=!!(e.flags&131072)}else Vt=!1,He&&t.flags&1048576&&dv(t,ha,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ul(e,t),e=t.pendingProps;var s=di(t,Mt.current);Ks(t,n),s=vf(null,t,r,e,s,n);var i=yf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ht(r)?(i=!0,da(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ff(t),s.updater=Va,t.stateNode=s,s._reactInternals=t,Wc(t,r,e,n),t=Kc(null,t,r,!0,i,n)):(t.tag=0,He&&i&&sf(t),Lt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ul(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=r1(r),e=gn(r,e),s){case 0:t=Qc(null,t,r,e,n);break e;case 1:t=tp(null,t,r,e,n);break e;case 11:t=Zh(null,t,r,e,n);break e;case 14:t=ep(null,t,r,gn(r.type,e),n);break e}throw Error(Q(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:gn(r,s),Qc(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:gn(r,s),tp(e,t,r,s,n);case 3:e:{if(Wv(t),e===null)throw Error(Q(387));r=t.pendingProps,i=t.memoizedState,s=i.element,vv(e,t),ga(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=mi(Error(Q(423)),t),t=np(e,t,r,n,s);break e}else if(r!==s){s=mi(Error(Q(424)),t),t=np(e,t,r,n,s);break e}else for(Xt=jr(t.stateNode.containerInfo.firstChild),qt=t,He=!0,Sn=null,n=mv(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(fi(),r===s){t=er(e,t,n);break e}Lt(e,t,r,n)}t=t.child}return t;case 5:return yv(t),e===null&&Bc(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,Oc(r,s)?o=null:i!==null&&Oc(r,i)&&(t.flags|=32),Vv(e,t),Lt(e,t,o,n),t.child;case 6:return e===null&&Bc(t),null;case 13:return Hv(e,t,n);case 4:return hf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=hi(t,null,r,n):Lt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:gn(r,s),Zh(e,t,r,s,n);case 7:return Lt(e,t,t.pendingProps,n),t.child;case 8:return Lt(e,t,t.pendingProps.children,n),t.child;case 12:return Lt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Be(pa,r._currentValue),r._currentValue=o,i!==null)if(kn(i.value,o)){if(i.children===s.children&&!Wt.current){t=er(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Yn(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Uc(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Q(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Uc(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Lt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Ks(t,n),s=cn(s),r=r(s),t.flags|=1,Lt(e,t,r,n),t.child;case 14:return r=t.type,s=gn(r,t.pendingProps),s=gn(r.type,s),ep(e,t,r,s,n);case 15:return Bv(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:gn(r,s),Ul(e,t),t.tag=1,Ht(r)?(e=!0,da(t)):e=!1,Ks(t,n),Dv(t,r,s),Wc(t,r,s,n),Kc(null,t,r,!0,e,n);case 19:return Qv(e,t,n);case 22:return Uv(e,t,n)}throw Error(Q(156,t.tag))};function ay(e,t){return Fg(e,t)}function n1(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function an(e,t,n,r){return new n1(e,t,n,r)}function Mf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function r1(e){if(typeof e=="function")return Mf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Qd)return 11;if(e===Kd)return 14}return 2}function Tr(e,t){var n=e.alternate;return n===null?(n=an(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Hl(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")Mf(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ls:return cs(n.children,s,i,t);case Hd:o=8,s|=8;break;case pc:return e=an(12,n,t,s|2),e.elementType=pc,e.lanes=i,e;case mc:return e=an(13,n,t,s),e.elementType=mc,e.lanes=i,e;case gc:return e=an(19,n,t,s),e.elementType=gc,e.lanes=i,e;case yg:return Qa(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case gg:o=10;break e;case vg:o=9;break e;case Qd:o=11;break e;case Kd:o=14;break e;case ur:o=16,r=null;break e}throw Error(Q(130,e==null?e:typeof e,""))}return t=an(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function cs(e,t,n,r){return e=an(7,e,r,t),e.lanes=n,e}function Qa(e,t,n,r){return e=an(22,e,r,t),e.elementType=yg,e.lanes=n,e.stateNode={isHidden:!1},e}function Xu(e,t,n){return e=an(6,e,null,t),e.lanes=n,e}function qu(e,t,n){return t=an(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function s1(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Pu(0),this.expirationTimes=Pu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Rf(e,t,n,r,s,i,o,l,c){return e=new s1(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=an(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ff(i),e}function i1(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ts,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function uy(e){if(!e)return Fr;e=e._reactInternals;e:{if(xs(e)!==e||e.tag!==1)throw Error(Q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ht(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Q(171))}if(e.tag===1){var n=e.type;if(Ht(n))return uv(e,n,t)}return t}function cy(e,t,n,r,s,i,o,l,c){return e=Rf(n,r,!0,e,s,i,o,l,c),e.context=uy(null),n=e.current,r=_t(),s=Pr(n),i=Yn(r,s),i.callback=t??null,Mr(n,i,s),e.current.lanes=s,zo(e,s,r),Qt(e,r),e}function Ka(e,t,n,r){var s=t.current,i=_t(),o=Pr(s);return n=uy(n),t.context===null?t.context=n:t.pendingContext=n,t=Yn(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Mr(s,t,o),e!==null&&(Cn(e,s,o,i),zl(e,s,o)),o}function ka(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function fp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Pf(e,t){fp(e,t),(e=e.alternate)&&fp(e,t)}function o1(){return null}var dy=typeof reportError=="function"?reportError:function(e){console.error(e)};function Tf(e){this._internalRoot=e}Ya.prototype.render=Tf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Q(409));Ka(e,t,null,null)};Ya.prototype.unmount=Tf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ms(function(){Ka(null,e,null,null)}),t[Jn]=null}};function Ya(e){this._internalRoot=e}Ya.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ug();e={blockedOn:null,target:e,priority:t};for(var n=0;n<dr.length&&t!==0&&t<dr[n].priority;n++);dr.splice(n,0,e),n===0&&Wg(e)}};function Lf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Xa(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function hp(){}function l1(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=ka(o);i.call(d)}}var o=cy(t,r,e,0,null,!1,!1,"",hp);return e._reactRootContainer=o,e[Jn]=o.current,So(e.nodeType===8?e.parentNode:e),ms(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=ka(c);l.call(d)}}var c=Rf(e,0,!1,null,null,!1,!1,"",hp);return e._reactRootContainer=c,e[Jn]=c.current,So(e.nodeType===8?e.parentNode:e),ms(function(){Ka(t,c,n,r)}),c}function qa(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=ka(o);l.call(c)}}Ka(t,o,e,s)}else o=l1(n,t,e,s,r);return ka(o)}$g=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Xi(t.pendingLanes);n!==0&&(qd(t,n|1),Qt(t,tt()),!(Ie&6)&&(gi=tt()+500,Dr()))}break;case 13:ms(function(){var r=Zn(e,1);if(r!==null){var s=_t();Cn(r,e,1,s)}}),Pf(e,1)}};Gd=function(e){if(e.tag===13){var t=Zn(e,134217728);if(t!==null){var n=_t();Cn(t,e,134217728,n)}Pf(e,134217728)}};Bg=function(e){if(e.tag===13){var t=Pr(e),n=Zn(e,t);if(n!==null){var r=_t();Cn(n,e,t,r)}Pf(e,t)}};Ug=function(){return ze};Vg=function(e,t){var n=ze;try{return ze=e,t()}finally{ze=n}};Nc=function(e,t,n){switch(t){case"input":if(xc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=$a(r);if(!s)throw Error(Q(90));wg(r),xc(r,s)}}}break;case"textarea":bg(e,n);break;case"select":t=n.value,t!=null&&Vs(e,!!n.multiple,t,!1)}};Rg=Ef;Pg=ms;var a1={usingClientEntryPoint:!1,Events:[Bo,Os,$a,jg,Mg,Ef]},$i={findFiberByHostInstance:Kr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},u1={bundleType:$i.bundleType,version:$i.version,rendererPackageName:$i.rendererPackageName,rendererConfig:$i.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:tr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Ig(e),e===null?null:e.stateNode},findFiberByHostInstance:$i.findFiberByHostInstance||o1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kl.isDisabled&&kl.supportsFiber)try{Oa=kl.inject(u1),Ln=kl}catch{}}Zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=a1;Zt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lf(t))throw Error(Q(200));return i1(e,t,null,n)};Zt.createRoot=function(e,t){if(!Lf(e))throw Error(Q(299));var n=!1,r="",s=dy;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Rf(e,1,!1,null,null,n,!1,r,s),e[Jn]=t.current,So(e.nodeType===8?e.parentNode:e),new Tf(t)};Zt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Q(188)):(e=Object.keys(e).join(","),Error(Q(268,e)));return e=Ig(t),e=e===null?null:e.stateNode,e};Zt.flushSync=function(e){return ms(e)};Zt.hydrate=function(e,t,n){if(!Xa(t))throw Error(Q(200));return qa(null,e,t,!0,n)};Zt.hydrateRoot=function(e,t,n){if(!Lf(e))throw Error(Q(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=dy;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=cy(t,null,e,1,n??null,s,!1,i,o),e[Jn]=t.current,So(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Ya(t)};Zt.render=function(e,t,n){if(!Xa(t))throw Error(Q(200));return qa(null,e,t,!1,n)};Zt.unmountComponentAtNode=function(e){if(!Xa(e))throw Error(Q(40));return e._reactRootContainer?(ms(function(){qa(null,null,e,!1,function(){e._reactRootContainer=null,e[Jn]=null})}),!0):!1};Zt.unstable_batchedUpdates=Ef;Zt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xa(n))throw Error(Q(200));if(e==null||e._reactInternals===void 0)throw Error(Q(38));return qa(e,t,n,!1,r)};Zt.version="18.3.1-next-f1338f8080-20240426";function fy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fy)}catch(e){console.error(e)}}fy(),fg.exports=Zt;var Ga=fg.exports,hy,pp=Ga;hy=pp.createRoot,pp.hydrateRoot;var Si=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},c1={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},hr,Ad,Wm,d1=(Wm=class{constructor(){fe(this,hr,c1);fe(this,Ad,!1)}setTimeoutProvider(e){te(this,hr,e)}setTimeout(e,t){return k(this,hr).setTimeout(e,t)}clearTimeout(e){k(this,hr).clearTimeout(e)}setInterval(e,t){return k(this,hr).setInterval(e,t)}clearInterval(e){k(this,hr).clearInterval(e)}},hr=new WeakMap,Ad=new WeakMap,Wm),qr=new d1;function f1(e){setTimeout(e,0)}var gs=typeof window>"u"||"Deno"in globalThis;function It(){}function h1(e,t){return typeof e=="function"?e(t):e}function id(e){return typeof e=="number"&&e>=0&&e!==1/0}function py(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Lr(e,t){return typeof e=="function"?e(t):e}function rn(e,t){return typeof e=="function"?e(t):e}function mp(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(r){if(t.queryHash!==If(o,t.options))return!1}else if(!Po(t.queryKey,o))return!1}if(n!=="all"){const c=t.isActive();if(n==="active"&&!c||n==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function gp(e,t){const{exact:n,status:r,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(vs(t.options.mutationKey)!==vs(i))return!1}else if(!Po(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function If(e,t){return((t==null?void 0:t.queryKeyHashFn)||vs)(e)}function vs(e){return JSON.stringify(e,(t,n)=>od(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function Po(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Po(e[n],t[n])):!1}var p1=Object.prototype.hasOwnProperty;function my(e,t){if(e===t)return e;const n=vp(e)&&vp(t);if(!n&&!(od(e)&&od(t)))return t;const s=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),o=i.length,l=n?new Array(o):{};let c=0;for(let d=0;d<o;d++){const f=n?d:i[d],p=e[f],h=t[f];if(p===h){l[f]=p,(n?d<s:p1.call(e,f))&&c++;continue}if(p===null||h===null||typeof p!="object"||typeof h!="object"){l[f]=h;continue}const S=my(p,h);l[f]=S,S===p&&c++}return s===o&&c===s?e:l}function Ea(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function vp(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function od(e){if(!yp(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!yp(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function yp(e){return Object.prototype.toString.call(e)==="[object Object]"}function m1(e){return new Promise(t=>{qr.setTimeout(t,e)})}function ld(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?my(e,t):t}function g1(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function v1(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var _f=Symbol();function gy(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===_f?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function vy(e,t){return typeof e=="function"?e(...t):!!e}function y1(e,t,n){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=t()),r||(r=!0,s.aborted?n():s.addEventListener("abort",n,{once:!0})),s)}),e}var es,pr,Js,Hm,x1=(Hm=class extends Si{constructor(){super();fe(this,es);fe(this,pr);fe(this,Js);te(this,Js,t=>{if(!gs&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){k(this,pr)||this.setEventListener(k(this,Js))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,pr))==null||t.call(this),te(this,pr,void 0))}setEventListener(t){var n;te(this,Js,t),(n=k(this,pr))==null||n.call(this),te(this,pr,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){k(this,es)!==t&&(te(this,es,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof k(this,es)=="boolean"?k(this,es):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},es=new WeakMap,pr=new WeakMap,Js=new WeakMap,Hm),Ff=new x1;function ad(){let e,t;const n=new Promise((s,i)=>{e=s,t=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}var w1=f1;function S1(){let e=[],t=0,n=l=>{l()},r=l=>{l()},s=w1;const i=l=>{t?e.push(l):s(()=>{n(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{r(()=>{l.forEach(c=>{n(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var ut=S1(),Zs,mr,ei,Qm,b1=(Qm=class extends Si{constructor(){super();fe(this,Zs,!0);fe(this,mr);fe(this,ei);te(this,ei,t=>{if(!gs&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){k(this,mr)||this.setEventListener(k(this,ei))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,mr))==null||t.call(this),te(this,mr,void 0))}setEventListener(t){var n;te(this,ei,t),(n=k(this,mr))==null||n.call(this),te(this,mr,t(this.setOnline.bind(this)))}setOnline(t){k(this,Zs)!==t&&(te(this,Zs,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return k(this,Zs)}},Zs=new WeakMap,mr=new WeakMap,ei=new WeakMap,Qm),Na=new b1;function C1(e){return Math.min(1e3*2**e,3e4)}function yy(e){return(e??"online")==="online"?Na.isOnline():!0}var ud=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function xy(e){let t=!1,n=0,r;const s=ad(),i=()=>s.status!=="pending",o=w=>{var C;if(!i()){const y=new ud(w);h(y),(C=e.onCancel)==null||C.call(e,y)}},l=()=>{t=!0},c=()=>{t=!1},d=()=>Ff.isFocused()&&(e.networkMode==="always"||Na.isOnline())&&e.canRun(),f=()=>yy(e.networkMode)&&e.canRun(),p=w=>{i()||(r==null||r(),s.resolve(w))},h=w=>{i()||(r==null||r(),s.reject(w))},S=()=>new Promise(w=>{var C;r=y=>{(i()||d())&&w(y)},(C=e.onPause)==null||C.call(e)}).then(()=>{var w;r=void 0,i()||(w=e.onContinue)==null||w.call(e)}),x=()=>{if(i())return;let w;const C=n===0?e.initialPromise:void 0;try{w=C??e.fn()}catch(y){w=Promise.reject(y)}Promise.resolve(w).then(p).catch(y=>{var N;if(i())return;const m=e.retry??(gs?0:3),v=e.retryDelay??C1,g=typeof v=="function"?v(n,y):v,b=m===!0||typeof m=="number"&&n<m||typeof m=="function"&&m(n,y);if(t||!b){h(y);return}n++,(N=e.onFail)==null||N.call(e,n,y),m1(g).then(()=>d()?void 0:S()).then(()=>{t?h(y):x()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:l,continueRetry:c,canStart:f,start:()=>(f()?x():S().then(x),s)}}var ts,Km,wy=(Km=class{constructor(){fe(this,ts)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),id(this.gcTime)&&te(this,ts,qr.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(gs?1/0:5*60*1e3))}clearGcTimeout(){k(this,ts)&&(qr.clearTimeout(k(this,ts)),te(this,ts,void 0))}},ts=new WeakMap,Km),ns,ti,nn,rs,ht,Io,ss,yn,zn,Ym,k1=(Ym=class extends wy{constructor(t){super();fe(this,yn);fe(this,ns);fe(this,ti);fe(this,nn);fe(this,rs);fe(this,ht);fe(this,Io);fe(this,ss);te(this,ss,!1),te(this,Io,t.defaultOptions),this.setOptions(t.options),this.observers=[],te(this,rs,t.client),te(this,nn,k(this,rs).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,te(this,ns,wp(this.options)),this.state=t.state??k(this,ns),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=k(this,ht))==null?void 0:t.promise}setOptions(t){if(this.options={...k(this,Io),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=wp(this.options);n.data!==void 0&&(this.setState(xp(n.data,n.dataUpdatedAt)),te(this,ns,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&k(this,nn).remove(this)}setData(t,n){const r=ld(this.state.data,t,this.options);return we(this,yn,zn).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){we(this,yn,zn).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=k(this,ht))==null?void 0:r.promise;return(s=k(this,ht))==null||s.cancel(t),n?n.then(It).catch(It):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(k(this,ns))}isActive(){return this.observers.some(t=>rn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===_f||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Lr(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!py(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,ht))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,ht))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),k(this,nn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(k(this,ht)&&(k(this,ss)?k(this,ht).cancel({revert:!0}):k(this,ht).cancelRetry()),this.scheduleGc()),k(this,nn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||we(this,yn,zn).call(this,{type:"invalidate"})}async fetch(t,n){var c,d,f,p,h,S,x,w,C,y,m,v;if(this.state.fetchStatus!=="idle"&&((c=k(this,ht))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(k(this,ht))return k(this,ht).continueRetry(),k(this,ht).promise}if(t&&this.setOptions(t),!this.options.queryFn){const g=this.observers.find(b=>b.options.queryFn);g&&this.setOptions(g.options)}const r=new AbortController,s=g=>{Object.defineProperty(g,"signal",{enumerable:!0,get:()=>(te(this,ss,!0),r.signal)})},i=()=>{const g=gy(this.options,n),N=(()=>{const j={client:k(this,rs),queryKey:this.queryKey,meta:this.meta};return s(j),j})();return te(this,ss,!1),this.options.persister?this.options.persister(g,N,this):g(N)},l=(()=>{const g={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:k(this,rs),state:this.state,fetchFn:i};return s(g),g})();(d=this.options.behavior)==null||d.onFetch(l,this),te(this,ti,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&we(this,yn,zn).call(this,{type:"fetch",meta:(p=l.fetchOptions)==null?void 0:p.meta}),te(this,ht,xy({initialPromise:n==null?void 0:n.initialPromise,fn:l.fetchFn,onCancel:g=>{g instanceof ud&&g.revert&&this.setState({...k(this,ti),fetchStatus:"idle"}),r.abort()},onFail:(g,b)=>{we(this,yn,zn).call(this,{type:"failed",failureCount:g,error:b})},onPause:()=>{we(this,yn,zn).call(this,{type:"pause"})},onContinue:()=>{we(this,yn,zn).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const g=await k(this,ht).start();if(g===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(g),(S=(h=k(this,nn).config).onSuccess)==null||S.call(h,g,this),(w=(x=k(this,nn).config).onSettled)==null||w.call(x,g,this.state.error,this),g}catch(g){if(g instanceof ud){if(g.silent)return k(this,ht).promise;if(g.revert){if(this.state.data===void 0)throw g;return this.state.data}}throw we(this,yn,zn).call(this,{type:"error",error:g}),(y=(C=k(this,nn).config).onError)==null||y.call(C,g,this),(v=(m=k(this,nn).config).onSettled)==null||v.call(m,this.state.data,g,this),g}finally{this.scheduleGc()}}},ns=new WeakMap,ti=new WeakMap,nn=new WeakMap,rs=new WeakMap,ht=new WeakMap,Io=new WeakMap,ss=new WeakMap,yn=new WeakSet,zn=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...Sy(r.data,this.options),fetchMeta:t.meta??null};case"success":const s={...r,...xp(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return te(this,ti,t.manual?s:void 0),s;case"error":const i=t.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),ut.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),k(this,nn).notify({query:this,type:"updated",action:t})})},Ym);function Sy(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:yy(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function xp(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function wp(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var $t,Re,_o,Pt,is,ni,Un,gr,Fo,ri,si,os,ls,vr,ii,Ae,Gi,cd,dd,fd,hd,pd,md,gd,by,Xm,E1=(Xm=class extends Si{constructor(t,n){super();fe(this,Ae);fe(this,$t);fe(this,Re);fe(this,_o);fe(this,Pt);fe(this,is);fe(this,ni);fe(this,Un);fe(this,gr);fe(this,Fo);fe(this,ri);fe(this,si);fe(this,os);fe(this,ls);fe(this,vr);fe(this,ii,new Set);this.options=n,te(this,$t,t),te(this,gr,null),te(this,Un,ad()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(k(this,Re).addObserver(this),Sp(k(this,Re),this.options)?we(this,Ae,Gi).call(this):this.updateResult(),we(this,Ae,hd).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return vd(k(this,Re),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return vd(k(this,Re),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,we(this,Ae,pd).call(this),we(this,Ae,md).call(this),k(this,Re).removeObserver(this)}setOptions(t){const n=this.options,r=k(this,Re);if(this.options=k(this,$t).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof rn(this.options.enabled,k(this,Re))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");we(this,Ae,gd).call(this),k(this,Re).setOptions(this.options),n._defaulted&&!Ea(this.options,n)&&k(this,$t).getQueryCache().notify({type:"observerOptionsUpdated",query:k(this,Re),observer:this});const s=this.hasListeners();s&&bp(k(this,Re),r,this.options,n)&&we(this,Ae,Gi).call(this),this.updateResult(),s&&(k(this,Re)!==r||rn(this.options.enabled,k(this,Re))!==rn(n.enabled,k(this,Re))||Lr(this.options.staleTime,k(this,Re))!==Lr(n.staleTime,k(this,Re)))&&we(this,Ae,cd).call(this);const i=we(this,Ae,dd).call(this);s&&(k(this,Re)!==r||rn(this.options.enabled,k(this,Re))!==rn(n.enabled,k(this,Re))||i!==k(this,vr))&&we(this,Ae,fd).call(this,i)}getOptimisticResult(t){const n=k(this,$t).getQueryCache().build(k(this,$t),t),r=this.createResult(n,t);return j1(this,r)&&(te(this,Pt,r),te(this,ni,this.options),te(this,is,k(this,Re).state)),r}getCurrentResult(){return k(this,Pt)}trackResult(t,n){return new Proxy(t,{get:(r,s)=>(this.trackProp(s),n==null||n(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&k(this,Un).status==="pending"&&k(this,Un).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(t){k(this,ii).add(t)}getCurrentQuery(){return k(this,Re)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=k(this,$t).defaultQueryOptions(t),r=k(this,$t).getQueryCache().build(k(this,$t),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return we(this,Ae,Gi).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),k(this,Pt)))}createResult(t,n){var O;const r=k(this,Re),s=this.options,i=k(this,Pt),o=k(this,is),l=k(this,ni),d=t!==r?t.state:k(this,_o),{state:f}=t;let p={...f},h=!1,S;if(n._optimisticResults){const L=this.hasListeners(),A=!L&&Sp(t,n),z=L&&bp(t,r,n,s);(A||z)&&(p={...p,...Sy(f.data,t.options)}),n._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:x,errorUpdatedAt:w,status:C}=p;S=p.data;let y=!1;if(n.placeholderData!==void 0&&S===void 0&&C==="pending"){let L;i!=null&&i.isPlaceholderData&&n.placeholderData===(l==null?void 0:l.placeholderData)?(L=i.data,y=!0):L=typeof n.placeholderData=="function"?n.placeholderData((O=k(this,si))==null?void 0:O.state.data,k(this,si)):n.placeholderData,L!==void 0&&(C="success",S=ld(i==null?void 0:i.data,L,n),h=!0)}if(n.select&&S!==void 0&&!y)if(i&&S===(o==null?void 0:o.data)&&n.select===k(this,Fo))S=k(this,ri);else try{te(this,Fo,n.select),S=n.select(S),S=ld(i==null?void 0:i.data,S,n),te(this,ri,S),te(this,gr,null)}catch(L){te(this,gr,L)}k(this,gr)&&(x=k(this,gr),S=k(this,ri),w=Date.now(),C="error");const m=p.fetchStatus==="fetching",v=C==="pending",g=C==="error",b=v&&m,N=S!==void 0,E={status:C,fetchStatus:p.fetchStatus,isPending:v,isSuccess:C==="success",isError:g,isInitialLoading:b,isLoading:b,data:S,dataUpdatedAt:p.dataUpdatedAt,error:x,errorUpdatedAt:w,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:m,isRefetching:m&&!v,isLoadingError:g&&!N,isPaused:p.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:g&&N,isStale:Of(t,n),refetch:this.refetch,promise:k(this,Un),isEnabled:rn(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const L=H=>{E.status==="error"?H.reject(E.error):E.data!==void 0&&H.resolve(E.data)},A=()=>{const H=te(this,Un,E.promise=ad());L(H)},z=k(this,Un);switch(z.status){case"pending":t.queryHash===r.queryHash&&L(z);break;case"fulfilled":(E.status==="error"||E.data!==z.value)&&A();break;case"rejected":(E.status!=="error"||E.error!==z.reason)&&A();break}}return E}updateResult(){const t=k(this,Pt),n=this.createResult(k(this,Re),this.options);if(te(this,is,k(this,Re).state),te(this,ni,this.options),k(this,is).data!==void 0&&te(this,si,k(this,Re)),Ea(n,t))return;te(this,Pt,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!k(this,ii).size)return!0;const o=new Set(i??k(this,ii));return this.options.throwOnError&&o.add("error"),Object.keys(k(this,Pt)).some(l=>{const c=l;return k(this,Pt)[c]!==t[c]&&o.has(c)})};we(this,Ae,by).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&we(this,Ae,hd).call(this)}},$t=new WeakMap,Re=new WeakMap,_o=new WeakMap,Pt=new WeakMap,is=new WeakMap,ni=new WeakMap,Un=new WeakMap,gr=new WeakMap,Fo=new WeakMap,ri=new WeakMap,si=new WeakMap,os=new WeakMap,ls=new WeakMap,vr=new WeakMap,ii=new WeakMap,Ae=new WeakSet,Gi=function(t){we(this,Ae,gd).call(this);let n=k(this,Re).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(It)),n},cd=function(){we(this,Ae,pd).call(this);const t=Lr(this.options.staleTime,k(this,Re));if(gs||k(this,Pt).isStale||!id(t))return;const r=py(k(this,Pt).dataUpdatedAt,t)+1;te(this,os,qr.setTimeout(()=>{k(this,Pt).isStale||this.updateResult()},r))},dd=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(k(this,Re)):this.options.refetchInterval)??!1},fd=function(t){we(this,Ae,md).call(this),te(this,vr,t),!(gs||rn(this.options.enabled,k(this,Re))===!1||!id(k(this,vr))||k(this,vr)===0)&&te(this,ls,qr.setInterval(()=>{(this.options.refetchIntervalInBackground||Ff.isFocused())&&we(this,Ae,Gi).call(this)},k(this,vr)))},hd=function(){we(this,Ae,cd).call(this),we(this,Ae,fd).call(this,we(this,Ae,dd).call(this))},pd=function(){k(this,os)&&(qr.clearTimeout(k(this,os)),te(this,os,void 0))},md=function(){k(this,ls)&&(qr.clearInterval(k(this,ls)),te(this,ls,void 0))},gd=function(){const t=k(this,$t).getQueryCache().build(k(this,$t),this.options);if(t===k(this,Re))return;const n=k(this,Re);te(this,Re,t),te(this,_o,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},by=function(t){ut.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(k(this,Pt))}),k(this,$t).getQueryCache().notify({query:k(this,Re),type:"observerResultsUpdated"})})},Xm);function N1(e,t){return rn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Sp(e,t){return N1(e,t)||e.state.data!==void 0&&vd(e,t,t.refetchOnMount)}function vd(e,t,n){if(rn(t.enabled,e)!==!1&&Lr(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&Of(e,t)}return!1}function bp(e,t,n,r){return(e!==t||rn(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&Of(e,n)}function Of(e,t){return rn(t.enabled,e)!==!1&&e.isStaleByTime(Lr(t.staleTime,e))}function j1(e,t){return!Ea(e.getCurrentResult(),t)}function Cp(e){return{onFetch:(t,n)=>{var f,p,h,S,x;const r=t.options,s=(h=(p=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:p.fetchMore)==null?void 0:h.direction,i=((S=t.state.data)==null?void 0:S.pages)||[],o=((x=t.state.data)==null?void 0:x.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let w=!1;const C=v=>{y1(v,()=>t.signal,()=>w=!0)},y=gy(t.options,t.fetchOptions),m=async(v,g,b)=>{if(w)return Promise.reject();if(g==null&&v.pages.length)return Promise.resolve(v);const j=(()=>{const A={client:t.client,queryKey:t.queryKey,pageParam:g,direction:b?"backward":"forward",meta:t.options.meta};return C(A),A})(),E=await y(j),{maxPages:O}=t.options,L=b?v1:g1;return{pages:L(v.pages,E,O),pageParams:L(v.pageParams,g,O)}};if(s&&i.length){const v=s==="backward",g=v?M1:kp,b={pages:i,pageParams:o},N=g(r,b);l=await m(b,N,v)}else{const v=e??i.length;do{const g=c===0?o[0]??r.initialPageParam:kp(r,l);if(c>0&&g==null)break;l=await m(l,g),c++}while(c<v)}return l};t.options.persister?t.fetchFn=()=>{var w,C;return(C=(w=t.options).persister)==null?void 0:C.call(w,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=d}}}function kp(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function M1(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var Oo,Mn,Tt,as,Rn,ar,qm,R1=(qm=class extends wy{constructor(t){super();fe(this,Rn);fe(this,Oo);fe(this,Mn);fe(this,Tt);fe(this,as);te(this,Oo,t.client),this.mutationId=t.mutationId,te(this,Tt,t.mutationCache),te(this,Mn,[]),this.state=t.state||Cy(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){k(this,Mn).includes(t)||(k(this,Mn).push(t),this.clearGcTimeout(),k(this,Tt).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){te(this,Mn,k(this,Mn).filter(n=>n!==t)),this.scheduleGc(),k(this,Tt).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){k(this,Mn).length||(this.state.status==="pending"?this.scheduleGc():k(this,Tt).remove(this))}continue(){var t;return((t=k(this,as))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,c,d,f,p,h,S,x,w,C,y,m,v,g,b,N,j,E,O;const n=()=>{we(this,Rn,ar).call(this,{type:"continue"})},r={client:k(this,Oo),meta:this.options.meta,mutationKey:this.options.mutationKey};te(this,as,xy({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(L,A)=>{we(this,Rn,ar).call(this,{type:"failed",failureCount:L,error:A})},onPause:()=>{we(this,Rn,ar).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>k(this,Tt).canRun(this)}));const s=this.state.status==="pending",i=!k(this,as).canStart();try{if(s)n();else{we(this,Rn,ar).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(o=k(this,Tt).config).onMutate)==null?void 0:l.call(o,t,this,r));const A=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t,r));A!==this.state.context&&we(this,Rn,ar).call(this,{type:"pending",context:A,variables:t,isPaused:i})}const L=await k(this,as).start();return await((p=(f=k(this,Tt).config).onSuccess)==null?void 0:p.call(f,L,t,this.state.context,this,r)),await((S=(h=this.options).onSuccess)==null?void 0:S.call(h,L,t,this.state.context,r)),await((w=(x=k(this,Tt).config).onSettled)==null?void 0:w.call(x,L,null,this.state.variables,this.state.context,this,r)),await((y=(C=this.options).onSettled)==null?void 0:y.call(C,L,null,t,this.state.context,r)),we(this,Rn,ar).call(this,{type:"success",data:L}),L}catch(L){try{await((v=(m=k(this,Tt).config).onError)==null?void 0:v.call(m,L,t,this.state.context,this,r))}catch(A){Promise.reject(A)}try{await((b=(g=this.options).onError)==null?void 0:b.call(g,L,t,this.state.context,r))}catch(A){Promise.reject(A)}try{await((j=(N=k(this,Tt).config).onSettled)==null?void 0:j.call(N,void 0,L,this.state.variables,this.state.context,this,r))}catch(A){Promise.reject(A)}try{await((O=(E=this.options).onSettled)==null?void 0:O.call(E,void 0,L,t,this.state.context,r))}catch(A){Promise.reject(A)}throw we(this,Rn,ar).call(this,{type:"error",error:L}),L}finally{k(this,Tt).runNext(this)}}},Oo=new WeakMap,Mn=new WeakMap,Tt=new WeakMap,as=new WeakMap,Rn=new WeakSet,ar=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),ut.batch(()=>{k(this,Mn).forEach(r=>{r.onMutationUpdate(t)}),k(this,Tt).notify({mutation:this,type:"updated",action:t})})},qm);function Cy(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Vn,xn,Ao,Gm,P1=(Gm=class extends Si{constructor(t={}){super();fe(this,Vn);fe(this,xn);fe(this,Ao);this.config=t,te(this,Vn,new Set),te(this,xn,new Map),te(this,Ao,0)}build(t,n,r){const s=new R1({client:t,mutationCache:this,mutationId:++ll(this,Ao)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){k(this,Vn).add(t);const n=El(t);if(typeof n=="string"){const r=k(this,xn).get(n);r?r.push(t):k(this,xn).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(k(this,Vn).delete(t)){const n=El(t);if(typeof n=="string"){const r=k(this,xn).get(n);if(r)if(r.length>1){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}else r[0]===t&&k(this,xn).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=El(t);if(typeof n=="string"){const r=k(this,xn).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var r;const n=El(t);if(typeof n=="string"){const s=(r=k(this,xn).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){ut.batch(()=>{k(this,Vn).forEach(t=>{this.notify({type:"removed",mutation:t})}),k(this,Vn).clear(),k(this,xn).clear()})}getAll(){return Array.from(k(this,Vn))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>gp(n,r))}findAll(t={}){return this.getAll().filter(n=>gp(t,n))}notify(t){ut.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return ut.batch(()=>Promise.all(t.map(n=>n.continue().catch(It))))}},Vn=new WeakMap,xn=new WeakMap,Ao=new WeakMap,Gm);function El(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Wn,yr,Bt,Hn,qn,Ql,yd,Jm,T1=(Jm=class extends Si{constructor(n,r){super();fe(this,qn);fe(this,Wn);fe(this,yr);fe(this,Bt);fe(this,Hn);te(this,Wn,n),this.setOptions(r),this.bindMethods(),we(this,qn,Ql).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var s;const r=this.options;this.options=k(this,Wn).defaultMutationOptions(n),Ea(this.options,r)||k(this,Wn).getMutationCache().notify({type:"observerOptionsUpdated",mutation:k(this,Bt),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&vs(r.mutationKey)!==vs(this.options.mutationKey)?this.reset():((s=k(this,Bt))==null?void 0:s.state.status)==="pending"&&k(this,Bt).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=k(this,Bt))==null||n.removeObserver(this)}onMutationUpdate(n){we(this,qn,Ql).call(this),we(this,qn,yd).call(this,n)}getCurrentResult(){return k(this,yr)}reset(){var n;(n=k(this,Bt))==null||n.removeObserver(this),te(this,Bt,void 0),we(this,qn,Ql).call(this),we(this,qn,yd).call(this)}mutate(n,r){var s;return te(this,Hn,r),(s=k(this,Bt))==null||s.removeObserver(this),te(this,Bt,k(this,Wn).getMutationCache().build(k(this,Wn),this.options)),k(this,Bt).addObserver(this),k(this,Bt).execute(n)}},Wn=new WeakMap,yr=new WeakMap,Bt=new WeakMap,Hn=new WeakMap,qn=new WeakSet,Ql=function(){var r;const n=((r=k(this,Bt))==null?void 0:r.state)??Cy();te(this,yr,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},yd=function(n){ut.batch(()=>{var r,s,i,o,l,c,d,f;if(k(this,Hn)&&this.hasListeners()){const p=k(this,yr).variables,h=k(this,yr).context,S={client:k(this,Wn),meta:this.options.meta,mutationKey:this.options.mutationKey};if((n==null?void 0:n.type)==="success"){try{(s=(r=k(this,Hn)).onSuccess)==null||s.call(r,n.data,p,h,S)}catch(x){Promise.reject(x)}try{(o=(i=k(this,Hn)).onSettled)==null||o.call(i,n.data,null,p,h,S)}catch(x){Promise.reject(x)}}else if((n==null?void 0:n.type)==="error"){try{(c=(l=k(this,Hn)).onError)==null||c.call(l,n.error,p,h,S)}catch(x){Promise.reject(x)}try{(f=(d=k(this,Hn)).onSettled)==null||f.call(d,void 0,n.error,p,h,S)}catch(x){Promise.reject(x)}}}this.listeners.forEach(p=>{p(k(this,yr))})})},Jm),Pn,Zm,L1=(Zm=class extends Si{constructor(t={}){super();fe(this,Pn);this.config=t,te(this,Pn,new Map)}build(t,n,r){const s=n.queryKey,i=n.queryHash??If(s,n);let o=this.get(i);return o||(o=new k1({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){k(this,Pn).has(t.queryHash)||(k(this,Pn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=k(this,Pn).get(t.queryHash);n&&(t.destroy(),n===t&&k(this,Pn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ut.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return k(this,Pn).get(t)}getAll(){return[...k(this,Pn).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>mp(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>mp(t,r)):n}notify(t){ut.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){ut.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ut.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Pn=new WeakMap,Zm),Je,xr,wr,oi,li,Sr,ai,ui,eg,I1=(eg=class{constructor(e={}){fe(this,Je);fe(this,xr);fe(this,wr);fe(this,oi);fe(this,li);fe(this,Sr);fe(this,ai);fe(this,ui);te(this,Je,e.queryCache||new L1),te(this,xr,e.mutationCache||new P1),te(this,wr,e.defaultOptions||{}),te(this,oi,new Map),te(this,li,new Map),te(this,Sr,0)}mount(){ll(this,Sr)._++,k(this,Sr)===1&&(te(this,ai,Ff.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,Je).onFocus())})),te(this,ui,Na.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,Je).onOnline())})))}unmount(){var e,t;ll(this,Sr)._--,k(this,Sr)===0&&((e=k(this,ai))==null||e.call(this),te(this,ai,void 0),(t=k(this,ui))==null||t.call(this),te(this,ui,void 0))}isFetching(e){return k(this,Je).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return k(this,xr).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,Je).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=k(this,Je).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Lr(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return k(this,Je).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=k(this,Je).get(r.queryHash),i=s==null?void 0:s.state.data,o=h1(t,i);if(o!==void 0)return k(this,Je).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return ut.batch(()=>k(this,Je).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,Je).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=k(this,Je);ut.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=k(this,Je);return ut.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=ut.batch(()=>k(this,Je).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(It).catch(It)}invalidateQueries(e,t={}){return ut.batch(()=>(k(this,Je).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=ut.batch(()=>k(this,Je).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(It)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(It)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=k(this,Je).build(this,t);return n.isStaleByTime(Lr(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(It).catch(It)}fetchInfiniteQuery(e){return e.behavior=Cp(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(It).catch(It)}ensureInfiniteQueryData(e){return e.behavior=Cp(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Na.isOnline()?k(this,xr).resumePausedMutations():Promise.resolve()}getQueryCache(){return k(this,Je)}getMutationCache(){return k(this,xr)}getDefaultOptions(){return k(this,wr)}setDefaultOptions(e){te(this,wr,e)}setQueryDefaults(e,t){k(this,oi).set(vs(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...k(this,oi).values()],n={};return t.forEach(r=>{Po(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){k(this,li).set(vs(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...k(this,li).values()],n={};return t.forEach(r=>{Po(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...k(this,wr).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=If(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===_f&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...k(this,wr).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){k(this,Je).clear(),k(this,xr).clear()}},Je=new WeakMap,xr=new WeakMap,wr=new WeakMap,oi=new WeakMap,li=new WeakMap,Sr=new WeakMap,ai=new WeakMap,ui=new WeakMap,eg),ky=u.createContext(void 0),nr=e=>{const t=u.useContext(ky);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},_1=({client:e,children:t})=>(u.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(ky.Provider,{value:e,children:t})),Ey=u.createContext(!1),F1=()=>u.useContext(Ey);Ey.Provider;function O1(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var A1=u.createContext(O1()),D1=()=>u.useContext(A1),z1=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},$1=e=>{u.useEffect(()=>{e.clearReset()},[e])},B1=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||vy(n,[e.error,r])),U1=e=>{if(e.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},V1=(e,t)=>e.isLoading&&e.isFetching&&!t,W1=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Ep=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function H1(e,t,n){var p,h,S,x,w;const r=F1(),s=D1(),i=nr(),o=i.defaultQueryOptions(e);(h=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||h.call(p,o),o._optimisticResults=r?"isRestoring":"optimistic",U1(o),z1(o,s),$1(s);const l=!i.getQueryCache().get(o.queryHash),[c]=u.useState(()=>new t(i,o)),d=c.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(u.useSyncExternalStore(u.useCallback(C=>{const y=f?c.subscribe(ut.batchCalls(C)):It;return c.updateResult(),y},[c,f]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),u.useEffect(()=>{c.setOptions(o)},[o,c]),W1(o,d))throw Ep(o,c,s);if(B1({result:d,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((x=(S=i.getDefaultOptions().queries)==null?void 0:S._experimental_afterQuery)==null||x.call(S,o,d),o.experimental_prefetchInRender&&!gs&&V1(d,r)){const C=l?Ep(o,c,s):(w=i.getQueryCache().get(o.queryHash))==null?void 0:w.promise;C==null||C.catch(It).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?d:c.trackResult(d)}function Ja(e,t){return H1(e,E1)}function Q1(e,t){const n=nr(),[r]=u.useState(()=>new T1(n,e));u.useEffect(()=>{r.setOptions(e)},[r,e]);const s=u.useSyncExternalStore(u.useCallback(o=>r.subscribe(ut.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=u.useCallback((o,l)=>{r.mutate(o,l).catch(It)},[r]);if(s.error&&vy(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}const Ny=8,K1=6;function Np(e,t,n){return n<t?t:Math.min(n,Math.max(t,e))}function jy({x:e,y:t,menuWidth:n,menuHeight:r,viewport:s,margin:i=Ny}){const o=i,l=i,c=s.width-Math.max(0,n)-i,d=s.height-Math.max(0,r)-i;return{x:Np(e,o,c),y:Np(t,l,d)}}function Y1({anchorRect:e,menuSize:t,viewport:n,align:r="left",margin:s=Ny,sideOffset:i=K1}){const o=r==="right"?e.right-t.width:e.left,l=e.bottom+i,c=e.top-t.height-i,d=l+t.height+s<=n.height,f=c>=s;return jy({x:o,y:!d&&f?c:l,menuWidth:t.width,menuHeight:t.height,viewport:n,margin:s})}function My(){return typeof window>"u"?{width:1024,height:768}:{width:window.innerWidth,height:window.innerHeight}}function jp(e){return e.length>0&&"options"in e[0]}function Mp(){return{x:0,y:0,ready:!1}}function Af({value:e,onChange:t,options:n,placeholder:r="Select...",trigger:s,triggerClassName:i="",panelClassName:o="",align:l="left",width:c="auto",showChevron:d=!0,title:f,disabled:p=!1,"aria-label":h}){var H,Z;const[S,x]=u.useState(!1),w=u.useRef(null),C=u.useRef(null),y=u.useRef(null),[m,v]=u.useState(Mp),b=u.useCallback(()=>{const B=T=>{const R=T.find(M=>M.value===e);return R?R.label:null};if(jp(n))for(const T of n){const R=B(T.options);if(R)return R}else{const T=B(n);if(T)return T}return r},[e,n,r])(),N=((H=w.current)==null?void 0:H.getBoundingClientRect().width)??((Z=C.current)==null?void 0:Z.offsetWidth)??0,j=c==="trigger"?N:c==="auto"?void 0:c,E=u.useCallback(()=>{if(!S)return;const B=w.current,T=y.current;if(!B||!T)return;const R=B.getBoundingClientRect(),M=T.getBoundingClientRect(),_=j??M.width??180,F=M.height||T.scrollHeight||1,W=Y1({anchorRect:R,menuSize:{width:_,height:F},viewport:My(),align:l});v(U=>U.x===W.x&&U.y===W.y&&U.ready?U:{x:W.x,y:W.y,ready:!0})},[l,j,S]);u.useLayoutEffect(()=>{if(!S){v(Mp());return}E()},[S,E,n,e]),u.useEffect(()=>{if(!S)return;const B=M=>{var F,W;const _=M.target;(F=w.current)!=null&&F.contains(_)||(W=y.current)!=null&&W.contains(_)||x(!1)},T=M=>{var _;M.key==="Escape"&&(x(!1),(_=C.current)==null||_.focus())},R=()=>E();return window.addEventListener("click",B),window.addEventListener("keydown",T),window.addEventListener("resize",R),window.addEventListener("scroll",R,!0),()=>{window.removeEventListener("click",B),window.removeEventListener("keydown",T),window.removeEventListener("resize",R),window.removeEventListener("scroll",R,!0)}},[S,E]);const O=B=>{var T;t(B),x(!1),(T=C.current)==null||T.focus()},L=B=>B.map(T=>a.jsxs("button",{className:"dropdown-item","data-active":T.value===e,disabled:T.disabled,onClick:()=>!T.disabled&&O(T.value),role:"menuitem",children:[T.icon&&a.jsx("span",{className:"shrink-0",children:T.icon}),a.jsx("span",{className:"flex-1 truncate",children:T.label}),T.value===e&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0 text-accent",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})]},T.value)),A=u.useMemo(()=>({position:"fixed",left:m.x,top:m.y,visibility:m.ready?"visible":"hidden",...j?{width:j,minWidth:j}:{}}),[j,m]),z=S?a.jsx("div",{ref:y,className:`dropdown-panel ${o}`,style:A,role:"listbox","aria-label":h,children:jp(n)?n.map((B,T)=>a.jsxs("div",{children:[B.label&&a.jsx("div",{className:"dropdown-label",children:B.label}),L(B.options),T<n.length-1&&a.jsx("div",{className:"dropdown-divider"})]},B.label||T)):L(n)}):null;return a.jsxs("div",{ref:w,className:"relative",children:[s?a.jsx("div",{onClick:()=>!p&&x(B=>!B),children:s}):a.jsxs("button",{ref:C,type:"button",className:`dropdown-trigger ${i}`,onClick:()=>x(B=>!B),disabled:p,title:f,"aria-label":h,"aria-haspopup":"listbox","aria-expanded":S,children:[a.jsx("span",{className:"truncate",children:b}),d&&a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`shrink-0 opacity-60 transition-transform ${S?"rotate-180":""}`,children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),z&&typeof document<"u"?Ga.createPortal(z,document.body):z]})}const X1={offline:"sync-dot-offline",unstable:"sync-dot-unstable",recent:"sync-dot-recent",editing:"sync-dot-editing",live:"sync-dot-live"};function q1({state:e,presence:t,syncLabel:n,connectionLabel:r,lastEditedLabel:s,hasEdits:i,localTypingActive:o,recentTouches:l,isNarrow:c}){const[d,f]=u.useState(!1),[p,h]=u.useState(null),S=u.useRef(null),x=u.useRef(null),w=u.useRef(null),C=t?`${t.viewing} viewing  ${t.editing} editing`:"- viewing  - editing",y=t?String(t.viewing):"-",m=u.useCallback(()=>{w.current&&(window.clearTimeout(w.current),w.current=null)},[]),v=u.useCallback((b,N)=>{var j;N&&((j=navigator.clipboard)==null||j.writeText(N).then(()=>{h(b),m(),w.current=window.setTimeout(()=>{h(E=>E===b?null:E)},1e3)}).catch(()=>{}))},[m]),g=u.useCallback(()=>{f(!1),window.requestAnimationFrame(()=>{var b;return(b=x.current)==null?void 0:b.focus()})},[]);return u.useEffect(()=>{if(!d)return;const b=j=>{!S.current||S.current.contains(j.target)||g()},N=j=>{j.key==="Escape"&&g()};return window.addEventListener("mousedown",b),window.addEventListener("keydown",N),()=>{window.removeEventListener("mousedown",b),window.removeEventListener("keydown",N)}},[d,g]),u.useEffect(()=>()=>{m()},[m]),a.jsxs("div",{ref:S,className:"sync-indicator",children:[a.jsxs("button",{ref:x,type:"button",className:"sync-indicator-button",onClick:()=>d?g():f(!0),"aria-haspopup":"dialog","aria-expanded":d,"aria-label":"Sync status",title:C,children:[a.jsx("span",{className:`sync-indicator-dot ${X1[e]}`,"aria-hidden":"true"}),!c&&a.jsx("span",{className:"sync-indicator-count tabular-nums",children:y}),!c&&o&&a.jsx("span",{className:"sync-indicator-local",children:"typing"})]}),d&&a.jsxs("div",{role:"dialog","aria-label":"Sync status",className:"sync-indicator-card select-text",children:[a.jsx("div",{className:"sync-indicator-line sync-indicator-primary",children:n}),a.jsx("div",{className:"sync-indicator-line",children:r}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:C}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:i?`Last edited: ${s}`:"No edits yet."}),o&&a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:"Local typing in progress (saved on blur)."}),a.jsxs("div",{className:"sync-indicator-section",children:[a.jsx("div",{className:"sync-indicator-section-title",children:"Recently touched files"}),l.length>0?a.jsx("div",{className:"sync-indicator-list",children:l.map(b=>a.jsxs("div",{className:"sync-indicator-item",children:[a.jsx("button",{type:"button",className:"sync-indicator-item-name",title:`Copy filename: ${b.label}`,onClick:()=>v(b.path,b.label),children:b.label}),a.jsx("span",{className:"sync-indicator-item-time tabular-nums",children:p===b.path?"Copied":b.timeLabel})]},b.path))}):a.jsx("div",{className:"sync-indicator-empty",children:"No recent touches."})]})]})]})}const Ir={phoneMax:480,mobileMax:767,narrowMax:900,tabletMax:1024,mediumMax:1180},Kl={phone:`(max-width: ${Ir.phoneMax}px)`,narrow:`(max-width: ${Ir.narrowMax}px)`,toolbarCompact:`(max-width: ${Ir.mediumMax}px)`},Rp=200,Pp=240,G1=320,J1=360,Z1=420;function Tp(e,t,n){return Math.min(Math.max(e,t),n)}function eS(e){return e<=Ir.tabletMax?G1:e<=Ir.mediumMax?J1:Z1}function tS(e){return e<=Ir.tabletMax?360:e<=Ir.mediumMax?420:520}function nS({viewportWidth:e,leftOpen:t,rightOpen:n,leftWidth:r,rightWidth:s}){const i=eS(e);let o=t?Tp(r,Rp,i):0,l=n?Tp(s,Pp,i):0;const c=Math.max(0,e-tS(e));if(o+l>c){let d=o+l-c;if(l>0){const f=Math.max(0,l-Pp),p=Math.min(f,d);l-=p,d-=p}if(d>0&&o>0){const f=Math.max(0,o-Rp),p=Math.min(f,d);o-=p,d-=p}d>0&&l>0&&(l=Math.max(0,c-o)),o+l>c&&(o=Math.max(0,c-l))}return{leftWidth:Number(o.toFixed(2)),rightWidth:Number(l.toFixed(2))}}function Yl(e,t=!1){const[n,r]=u.useState(t);return u.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;const s=window.matchMedia(e),i=s,o=()=>r(s.matches);if(o(),typeof s.addEventListener=="function")return s.addEventListener("change",o),()=>s.removeEventListener("change",o);if(typeof i.addListener=="function"&&typeof i.removeListener=="function")return i.addListener(o),()=>{var l;return(l=i.removeListener)==null?void 0:l.call(i,o)}},[e]),n}function Ry({isRandom:e,dir:t}){return e?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),a.jsx("path",{d:"M21 3v5h-5"})]}):t==="desc"?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 5v14"}),a.jsx("path",{d:"M19 12l-7 7-7-7"})]}):a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 19V5"}),a.jsx("path",{d:"M5 12l7-7 7 7"})]})}function rS({viewerActive:e,filtersOpen:t,filtersRef:n,totalFilterCount:r,filterCount:s,starFilterList:i,starCounts:o,onToggleFilters:l,onOpenFilters:c,onToggleStar:d,onClearFilters:f,onClearStars:p}){return a.jsxs("div",{ref:n,className:`toolbar-filter relative ${e?"opacity-40 pointer-events-none":""}`,children:[a.jsxs("button",{className:`btn ${r>0?"btn-active":""}`,onClick:l,"aria-haspopup":"dialog","aria-expanded":t,title:"Filters","aria-disabled":e,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),a.jsx("span",{className:"toolbar-filters-label",children:"Filters"}),r>0&&a.jsx("span",{className:"toolbar-filters-count px-1.5 py-0.5 text-[11px] rounded-full bg-accent-strong text-text",children:r})]}),t&&a.jsxs("div",{role:"dialog","aria-label":"Filters",className:"dropdown-panel w-[240px]",style:{top:"38px",left:0},children:[a.jsx("div",{className:"dropdown-label",children:"Rating"}),a.jsxs("div",{className:"px-1",children:[[5,4,3,2,1].map(h=>{const S=i.includes(h),x=(o==null?void 0:o[String(h)])??0;return a.jsxs("button",{onClick:()=>d==null?void 0:d(h),className:`dropdown-item justify-between ${S?"bg-accent-muted":""}`,children:[a.jsxs("span",{className:S?"text-star-active":"text-text",children:["".repeat(h),"".repeat(5-h)]}),a.jsx("span",{className:"text-xs text-muted",children:x})]},h)}),a.jsxs("button",{onClick:()=>d==null?void 0:d(0),className:`dropdown-item justify-between ${i.includes(0)?"bg-accent-muted":""}`,children:[a.jsx("span",{className:"text-text",children:"Unrated"}),a.jsx("span",{className:"text-xs text-muted",children:(o==null?void 0:o["0"])??0})]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("div",{className:"dropdown-label",children:"Metrics"}),a.jsxs("button",{className:"dropdown-item",onClick:()=>{l(),c==null||c()},children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]}),a.jsx("span",{children:"Open Metrics Panel"}),(s||0)>0&&a.jsxs("span",{className:"ml-auto text-xs text-muted",children:[s," active"]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("button",{className:"dropdown-item text-muted hover:text-text",onClick:()=>{f?f():p==null||p()},disabled:r===0,children:"Clear all filters"})]})]})}function sS({viewMode:e,currentSort:t,sortOnlyOptions:n,sortDisabled:r,sortControlsDisabled:s,sortDir:i,isRandom:o,showSelectModeToggle:l,multiSelectMode:c,selectModeLabel:d,uploadBusy:f,uploadDisabled:p,onViewMode:h,onSortChange:S,onToggleSortDir:x,onToggleMultiSelectMode:w,onUploadClick:C}){return a.jsx("div",{className:"mobile-drawer",children:a.jsxs("div",{className:"mobile-drawer-row",children:[a.jsxs("div",{className:"mobile-pill-group",children:[a.jsx("button",{className:`mobile-pill ${e==="grid"?"is-active":""}`,onClick:()=>h==null?void 0:h("grid"),"aria-pressed":e==="grid",children:"Grid"}),a.jsx("button",{className:`mobile-pill ${e==="adaptive"?"is-active":""}`,onClick:()=>h==null?void 0:h("adaptive"),"aria-pressed":e==="adaptive",children:"Masonry"})]}),a.jsx(Af,{value:t,onChange:y=>S==null?void 0:S(y),options:n,"aria-label":"Sort",triggerClassName:"mobile-pill mobile-pill-dropdown",panelClassName:"mobile-drawer-panel",disabled:r}),a.jsx("button",{className:`mobile-pill mobile-pill-icon ${s?"opacity-50 cursor-not-allowed":""}`,onClick:x,title:r?"Sorting disabled":o?"Shuffle":`Sort ${i==="desc"?"descending":"ascending"}`,"aria-label":o?"Shuffle":"Toggle sort direction","aria-disabled":s,disabled:s,children:a.jsx(Ry,{isRandom:o,dir:i})}),l&&a.jsx("button",{className:`mobile-pill ${c?"is-active":""}`,onClick:()=>w==null?void 0:w(),"aria-pressed":c,title:c?"Exit select mode":"Enter select mode",children:d}),C&&a.jsx("button",{className:`mobile-pill ${p||f?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!p&&!f&&C(),disabled:p||f,children:f?"Uploading":"Upload"})]})})}function iS({rootRef:e,onSearch:t,viewerActive:n,onBack:r,zoomPercent:s,onZoomPercentChange:i,currentLabel:o,itemCount:l,totalCount:c,sortSpec:d,metricKeys:f,onSortChange:p,sortDisabled:h=!1,filterCount:S,onOpenFilters:x,starFilters:w,onToggleStar:C,onClearStars:y,onClearFilters:m,starCounts:v,viewMode:g,onViewMode:b,gridItemSize:N,onGridItemSize:j,leftOpen:E,rightOpen:O,onToggleLeft:L,onToggleRight:A,onPrevImage:z,onNextImage:H,canPrevImage:Z,canNextImage:B,searchDisabled:T=!1,searchPlaceholder:R,onUploadClick:M,uploadBusy:_=!1,uploadDisabled:F=!1,multiSelectMode:W=!1,selectedCount:U=0,onToggleMultiSelectMode:I,syncIndicator:X}){const[J,ne]=u.useState(!1),[ee,Y]=u.useState(!1),V=u.useRef(null),pe=u.useRef(null),ae=Yl(Kl.narrow),$e=Yl(Kl.phone),Pe=Yl(Kl.toolbarCompact);u.useEffect(()=>{if(!J)return;const K=me=>{V.current&&!V.current.contains(me.target)&&ne(!1)};return window.addEventListener("click",K),()=>window.removeEventListener("click",K)},[J]),u.useEffect(()=>{if(T){Y(!1);return}if(!ae||n){Y(!1);return}if(!ee)return;const K=window.requestAnimationFrame(()=>{var me;return(me=pe.current)==null?void 0:me.focus()});return()=>window.cancelAnimationFrame(K)},[ae,ee,n,T]);const Fe=d??{kind:"builtin",key:"added",dir:"desc"},dt=Fe.dir,Ue=Fe.kind==="builtin"&&Fe.key==="random",St=n||h,ue=f!=null&&f.length?f.map(K=>({value:`metric:${K}`,label:K,disabled:h})):[],oe=[{value:"builtin:added",label:"Date added",disabled:h},{value:"builtin:name",label:"Filename",disabled:h},{value:"builtin:random",label:"Random",disabled:h},...ue],Se=[{label:"Layout",options:[{value:"layout:grid",label:"Grid"},{value:"layout:masonry",label:"Masonry"}]},{label:"Sort by",options:oe}],Oe=Fe.kind==="metric"?`metric:${Fe.key}`:`builtin:${Fe.key}`,Ce=[{label:"Sort by",options:oe}],ve=ae&&!n,tn=!(!!n&&Pe),nt=!!n&&!$e,zr=ve&&!!I,$r=W?U>0?`Done (${U})`:"Done":"Select",rr=K=>{if(K.startsWith("layout:")){const me=K==="layout:masonry"?"adaptive":"grid";b==null||b(me)}else{if(h)return;p==null||p(Lp(K,Fe))}},Fn=()=>{!p||h||p(Ue?Fe:{...Fe,dir:dt==="desc"?"asc":"desc"})},Rt=w??[],bt=Rt.length,Dt=lS(S,bt),D=oS(l,c),q=o||"Root";return a.jsxs("div",{ref:e,className:`toolbar-shell ${n?"toolbar-shell-viewer":""} ${$e?"toolbar-shell-phone":""} ${Pe?"toolbar-shell-compact":""} fixed top-0 left-0 right-0 h-12 grid grid-cols-[minmax(0,1fr)_minmax(0,1fr)_auto] items-center px-3 gap-3 bg-panel border-b border-border z-[var(--z-toolbar)] col-span-full row-start-1 select-none`,children:[a.jsxs("div",{className:"toolbar-left flex items-center gap-4 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope flex items-center gap-3 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope-text flex flex-col min-w-0 leading-tight",children:[a.jsx("span",{className:"toolbar-scope-label text-[10px] uppercase tracking-widest text-muted",children:"Scope"}),a.jsx("span",{className:"text-sm font-medium text-text truncate",title:q,children:q})]}),D&&a.jsx("span",{className:"toolbar-count text-xs text-muted whitespace-nowrap tabular-nums",children:D})]}),n&&a.jsxs("button",{className:"toolbar-back-btn btn btn-sm",onClick:r,title:"Back to grid",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]}),tn&&a.jsxs("div",{className:"toolbar-sort flex items-center gap-2",children:[a.jsxs("div",{className:`toolbar-sort-controls flex items-center gap-2 ${n?"opacity-40 pointer-events-none":""}`,children:[a.jsx(Af,{value:Oe,onChange:rr,options:Se,title:"Sort and layout options","aria-label":"Sort and layout",triggerClassName:"min-w-[110px]"}),a.jsx("button",{className:"toolbar-sort-dir btn btn-icon",onClick:Fn,title:h?"Sorting disabled":Ue?"Shuffle":`Sort ${dt==="desc"?"descending":"ascending"}`,"aria-label":Ue?"Shuffle":"Toggle sort direction","aria-disabled":St,disabled:St,children:a.jsx(Ry,{isRandom:Ue,dir:dt})})]}),a.jsx(rS,{viewerActive:!!n,filtersOpen:J,filtersRef:V,totalFilterCount:Dt,filterCount:S,starFilterList:Rt,starCounts:v,onToggleFilters:()=>ne(K=>!K),onOpenFilters:x,onToggleStar:C,onClearFilters:m,onClearStars:y})]})]}),a.jsx("div",{className:"toolbar-center flex items-center gap-3 justify-center min-w-0",children:n?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"range",min:5,max:800,step:1,value:Math.round(Math.max(5,Math.min(800,s??100))),onChange:K=>i==null?void 0:i(Number(K.target.value)),className:"zoom-slider","aria-label":"Zoom level"}),a.jsxs("span",{className:"text-xs text-muted min-w-[42px] text-right",children:[Math.round(s??100),"%"]})]}):j&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-muted",children:"Size"}),a.jsx("input",{type:"range",min:80,max:500,step:10,value:N??220,onChange:K=>j(Number(K.target.value)),className:"w-28 h-1.5 bg-border rounded-full appearance-none cursor-pointer hover:bg-hover transition-colors [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-text [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-text [&::-moz-range-thumb]:border-0","aria-label":"Thumbnail size"})]})}),a.jsxs("div",{className:"toolbar-right flex items-center gap-2 justify-end",children:[nt&&a.jsxs("div",{className:"toolbar-nav flex items-center gap-1 mr-1",children:[a.jsx("button",{className:`btn btn-icon ${Z?"":"opacity-40 cursor-not-allowed"}`,title:"Previous image (A / )",onClick:()=>Z&&(z==null?void 0:z()),"aria-label":"Previous image","aria-disabled":!Z,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("button",{className:`btn btn-icon ${B?"":"opacity-40 cursor-not-allowed"}`,title:"Next image (D / )",onClick:()=>B&&(H==null?void 0:H()),"aria-label":"Next image","aria-disabled":!B,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 6l6 6-6 6"})})})]}),a.jsxs("div",{className:"toolbar-panels flex items-center gap-1",children:[a.jsx("button",{className:`btn btn-icon ${E?"":"opacity-50"}`,title:E?"Hide left panel (Ctrl+B)":"Show left panel (Ctrl+B)",onClick:L,"aria-pressed":E,"aria-label":"Toggle left panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"11",y:"5",width:"10",height:"14",rx:"1.5"})]})}),a.jsx("button",{className:`btn btn-icon ${O?"":"opacity-50"}`,title:O?"Hide right panel (Ctrl+Alt+B)":"Show right panel (Ctrl+Alt+B)",onClick:A,"aria-pressed":O,"aria-label":"Toggle right panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"15",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"3",y:"5",width:"10",height:"14",rx:"1.5"})]})})]}),!n&&M&&a.jsxs("button",{className:`btn ${F?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!F&&M(),"aria-label":"Upload images",title:_?"Uploading":"Upload images","aria-disabled":F||_,disabled:F||_,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M12 16V5"}),a.jsx("path",{d:"M7 10l5-5 5 5"}),a.jsx("path",{d:"M4 19h16"})]}),a.jsx("span",{children:_?"Uploading":"Upload"})]}),X&&a.jsx(q1,{...X,isNarrow:ae||Pe}),!n&&ae&&a.jsx("button",{className:`btn btn-icon ${ee?"btn-active":""} ${T?"opacity-50 cursor-not-allowed":""}`,"aria-label":ee?"Close search":"Open search",title:T?"Search disabled":ee?"Close search":"Search",onClick:()=>!T&&Y(K=>!K),disabled:T,children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"11",cy:"11",r:"7"}),a.jsx("path",{d:"M21 21l-4.35-4.35"})]})}),!n&&!ae?a.jsx("div",{className:"toolbar-search toolbar-search-desktop w-[240px]",children:a.jsx("input",{ref:pe,"aria-label":"Search filename, tags, notes",placeholder:T?R??"Search disabled":"Search...",onChange:K=>t(K.target.value),className:"toolbar-search-input input w-full focus:w-full transition-all duration-200 select-text",disabled:T})}):null]}),!n&&ae&&ee&&!T&&a.jsx("div",{className:"toolbar-search-row",children:a.jsx("input",{ref:pe,"aria-label":"Search filename, tags, notes",placeholder:R??"Search...",onChange:K=>t(K.target.value),className:"toolbar-search-input-mobile input input-lg w-full select-text"})}),ve&&a.jsx(sS,{viewMode:g,currentSort:Oe,sortOnlyOptions:Ce,sortDisabled:h,sortControlsDisabled:St,sortDir:dt,isRandom:Ue,showSelectModeToggle:zr,multiSelectMode:W,selectModeLabel:$r,uploadBusy:_,uploadDisabled:F,onViewMode:b,onSortChange:K=>p==null?void 0:p(Lp(K,Fe)),onToggleSortDir:Fn,onToggleMultiSelectMode:I,onUploadClick:M})]})}function oS(e,t){if(typeof e!="number")return null;const n=e.toLocaleString();if(typeof t!="number")return`${n} items`;const r=t.toLocaleString();return t===e?`${n} items`:`${n} / ${r} items`}function lS(e,t){return typeof e=="number"?e:t>0?1:0}function Lp(e,t){if(e.startsWith("metric:")){const n=e.slice(7);return n?{kind:"metric",key:n,dir:t.dir}:t}if(e.startsWith("builtin:")){const n=e.slice(8);if(n==="name"||n==="added"||n==="random")return{kind:"builtin",key:n,dir:t.dir}}return t}class Gt extends Error{constructor(n,r,s,i){super(r);lt(this,"status");lt(this,"url");lt(this,"body");this.name="FetchError",this.status=n,this.url=s,this.body=i}}function aS(e){const t=e.trim();return t.startsWith("{")||t.startsWith("[")}function Py(e,t,n){if(t&&typeof t=="object"){const r=t,s=typeof r.error=="string"?r.error:null,i=typeof r.message=="string"?r.message:null;if(s&&i)return`${s}: ${i}`;if(s)return s;if(i)return i}return typeof t=="string"&&t?t:`HTTP ${e} for ${n}`}function vt(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{let c=null;const d=await l.text().catch(()=>"");if(d)if((l.headers.get("content-type")||"").includes("application/json")||aS(d))try{c=JSON.parse(d)}catch{c=d}else c=d;if(!l.ok)throw new Gt(l.status,Py(l.status,c,e),e,c);return c}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}function Bi(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{if(!l.ok){const c=await l.text().catch(()=>""),d=c||null;throw new Gt(l.status,Py(l.status,d,e),e,d)}return l.blob()}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}class Ty{constructor(t){lt(this,"store",new Map);lt(this,"inflight",new Map);lt(this,"totalBytes",0);this.maxBytes=t}getMaxBytes(){return this.maxBytes}getTotalBytes(){return this.totalBytes}getSize(){return this.store.size}has(t){return this.store.has(t)}isInflight(t){return this.inflight.has(t)}get(t){const n=this.store.get(t);if(n)return this.store.delete(t),this.store.set(t,n),n.blob}evictIfNeeded(t){for(;this.totalBytes+t>this.maxBytes&&this.store.size>0;){const n=this.store.keys().next().value;if(n==null)break;const r=this.store.get(n);r&&(this.totalBytes-=r.size),this.store.delete(n)}}set(t,n){const r=n.size||0;if(!(r>this.maxBytes)){if(this.store.has(t)){const s=this.store.get(t);this.totalBytes-=s.size,this.store.delete(t)}this.evictIfNeeded(r),this.store.set(t,{blob:n,size:r}),this.totalBytes+=r}}async getOrFetch(t,n){const r=this.get(t);if(r)return r;const s=this.inflight.get(t);if(s)return s.promise;const i=n(),o=typeof i=="object"&&"promise"in i,l=o?i.promise:i,c=o?i.abort:void 0,d=l.then(f=>(this.set(t,f),f)).finally(()=>{this.inflight.delete(t)});return this.inflight.set(t,{promise:d,abort:c}),d}prefetch(t,n){if(this.store.has(t)||this.inflight.has(t))return;const r=n(),s=typeof r=="object"&&"promise"in r,i=s?r.promise:r,o=s?r.abort:void 0,l=i.then(c=>(this.set(t,c),c)).catch(()=>new Blob).finally(()=>{this.inflight.delete(t)});this.inflight.set(t,{promise:l,abort:o})}cancelPrefetch(t){const n=this.inflight.get(t);if(n!=null&&n.abort)try{n.abort()}catch{}this.inflight.delete(t)}clear(){for(const[t,n]of this.inflight)if(n.abort)try{n.abort()}catch{}this.inflight.clear(),this.store.clear(),this.totalBytes=0}evictPrefix(t){const n=(()=>{const s=t?`/${t.replace(/^\/+/,"")}`:"/";return s==="/"?"/":s.replace(/\/+$/,"")})(),r=s=>{const i=s.startsWith("/")?s.replace(/\/+$/,""):`/${s.replace(/\/+$/,"")}`;return n==="/"?!0:i===n||i.startsWith(`${n}/`)};for(const[s,i]of Array.from(this.store.entries()))r(s)&&(this.totalBytes-=i.size,this.store.delete(s));for(const[s,i]of Array.from(this.inflight.entries()))if(r(s)){if(i.abort)try{i.abort()}catch{}this.inflight.delete(s)}this.totalBytes<0&&(this.totalBytes=0)}}const Ps=new Ty(60*1024*1024),xd=new Ty(20*1024*1024),Gu={};function uS(){const e=Gu==null?void 0:Gu.VITE_API_BASE,t=typeof window<"u",n=t?window.location.origin:"http://localhost",r=t?window.location.hostname:"localhost",s=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\]|.+\.localhost)$/i.test(r);if(!e)return"";let i;try{i=new URL(e,n)}catch{return""}const o=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\])$/i.test(i.hostname);return s?i.origin:o?"":i.origin}const Ye=uS();const cS=40*1024*1024;function dS(e){return e==="viewer"||e==="compare"}function Ip(e){return`${Ye}/thumb?path=${encodeURIComponent(e)}`}function _p(e){return`${Ye}/file?path=${encodeURIComponent(e)}`}const Ju="lenslet.client_id",Fp="lenslet.client_id.session",Ly="lenslet.last_event_id",fS=1e3,hS=3e4,pS=5;let wd=null,Xl=null,Op=0,Xs=null,qs=0,Za=!0,ja=!1;function Iy(){return typeof window<"u"&&typeof EventSource<"u"}function Ap(e,t){if(!e)return null;try{return e.getItem(t)}catch{return null}}function Dp(e,t,n){if(e)try{e.setItem(t,n)}catch{}}function mS(e,t){if(e)try{e.removeItem(t)}catch{}}function gS(){if(typeof navigator>"u")return"server";const e=navigator.userAgent||"",t=navigator.language||"",n=navigator.platform||"",r=typeof Intl<"u"&&Intl.DateTimeFormat().resolvedOptions().timeZone||"",s=typeof screen<"u"?`${screen.width}x${screen.height}x${screen.colorDepth}`:"";return[e,t,n,r,s].join("|")}function vS(e){let t=2166136261;for(let n=0;n<e.length;n+=1)t^=e.charCodeAt(n),t=t*16777619>>>0;return t.toString(16).padStart(8,"0")}function zp(){return typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`client_${Math.random().toString(36).slice(2,10)}_${Date.now()}`}function Ui(e){return wd=e,e}function Ma(e){if(typeof window>"u")return null;try{return e==="local"?window.localStorage:window.sessionStorage}catch{return null}}function vi(){if(wd)return wd;const e=Ma("local"),t=Ma("session"),n=Ap(t,Fp);if(n)return Ui(n);const r=Ap(e,Ju);if(t){const i=zp();return Dp(t,Fp,i),r&&mS(e,Ju),Ui(i)}if(r)return Ui(r);if(e){const i=zp();return Dp(e,Ju,i),Ui(i)}const s=`fp_${vS(gS())}_${Math.random().toString(36).slice(2,8)}`;return Ui(s)}function eu(e="lenslet"){Op+=1;const t=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`nonce_${Math.random().toString(36).slice(2,10)}_${Date.now()}_${Op}`;return`${e}:${vi()}:${t}`}function yS(){if(Xl!=null)return Xl;if(typeof window>"u")return null;const e=Ma("local");if(!e)return null;try{const t=e.getItem(Ly);if(!t)return null;const n=Number(t);return!Number.isFinite(n)||n<=0?null:(Xl=n,n)}catch{return null}}function xS(e){if(!Number.isFinite(e)||e<=0||(Xl=e,typeof window>"u"))return;const t=Ma("local");if(t)try{t.setItem(Ly,String(e))}catch{}}function wS(){if(typeof window>"u")return`${Ye}/events`;const e=new URL(`${Ye}/events`,window.location.origin),t=yS();return t!=null&&Number.isFinite(t)&&e.searchParams.set("last_event_id",String(t)),e.toString()}function SS(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}let vn=null,_y="idle";const Sd=new Set,bd=new Set,Cd=new Set;function Gs(e){_y=e;for(const t of bd)t(e)}function Df(e){if(ja!==e){ja=e;for(const t of Cd)t(e)}}function zf(){Xs!=null&&(window.clearTimeout(Xs),Xs=null)}function bS(){qs=0,zf()}function CS(){if(!Za||Xs!=null)return;qs+=1;const e=Math.min(fS*Math.pow(2,qs-1),hS);qs>=pS?(Gs("offline"),Df(!0)):Gs("reconnecting"),Xs=window.setTimeout(()=>{Xs=null,Fy()},e)}function Fy(){if(!Za||!Iy()||(vn&&vn.readyState===EventSource.CLOSED&&(vn.close(),vn=null),vn))return;qs>0?Gs("reconnecting"):Gs("connecting");const e=new EventSource(wS());vn=e;const t=n=>r=>{const s=SS(r.data);if(!s)return;const i=r.lastEventId?Number(r.lastEventId):null,o=i!=null&&Number.isFinite(i)?i:null;o!=null&&xS(o);for(const l of Sd)l({type:n,id:o,data:s})};e.addEventListener("item-updated",t("item-updated")),e.addEventListener("metrics-updated",t("metrics-updated")),e.addEventListener("presence",t("presence")),e.onopen=()=>{bS(),Df(!1),Gs("live")},e.onerror=()=>{vn===e&&(e.close(),vn=null,CS())}}function kS(){Za=!0,Iy()&&(zf(),Fy())}function ES(){Za=!1,zf(),qs=0,vn&&(vn.close(),vn=null),Df(!1),Gs("offline")}function NS(e){return Sd.add(e),()=>{Sd.delete(e)}}function jS(e){return bd.add(e),e(_y),()=>{bd.delete(e)}}function MS(e){return Cd.add(e),e(ja),()=>{Cd.delete(e)}}function RS(){return ja}function PS(e,t){const n=JSON.stringify(t),r=`${Ye}${e}`;if(typeof navigator<"u"&&typeof navigator.sendBeacon=="function")try{if(navigator.sendBeacon(r,new Blob([n],{type:"application/json"})))return!0}catch{}if(typeof fetch!="function")return!1;try{return fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0}),!0}catch{return!1}}function TS(e,t,n){return PS("/presence/leave",{gallery_id:e,lease_id:t,client_id:n??vi()})}function Nl(e){return e??vi()}function jl(e,t){return vt(`${Ye}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).promise}function LS(e,t){const n=new URLSearchParams({path:e});return(t==null?void 0:t.page)!=null&&n.set("page",String(t.page)),(t==null?void 0:t.pageSize)!=null&&n.set("page_size",String(t.pageSize)),t!=null&&t.recursive&&n.set("recursive","1"),t!=null&&t.legacyRecursive&&n.set("legacy_recursive","1"),n.toString()}const xe={getFolder:(e,t)=>vt(`${Ye}/folders?${LS(e,t)}`).promise,search:(e,t)=>{const n=new URLSearchParams;return e&&n.set("q",e),t&&n.set("path",t),vt(`${Ye}/search?${n}`).promise},getEmbeddings:()=>vt(`${Ye}/embeddings`).promise,searchEmbeddings:e=>vt(`${Ye}/embeddings/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,refreshFolder:e=>{const t=new URLSearchParams({path:e});return vt(`${Ye}/refresh?${t}`,{method:"POST"}).promise},getSidecar:e=>vt(`${Ye}/item?path=${encodeURIComponent(e)}`).promise,patchSidecar:(e,t,n)=>{const s={"Content-Type":"application/json","Idempotency-Key":(n==null?void 0:n.idempotencyKey)??eu("patch"),"x-client-id":vi(),"x-updated-by":"web"};return(n==null?void 0:n.ifMatch)!=null&&(s["If-Match"]=String(n.ifMatch)),vt(`${Ye}/item?path=${encodeURIComponent(e)}`,{method:"PATCH",headers:s,body:JSON.stringify(t)}).promise},getMetadata:e=>vt(`${Ye}/metadata?path=${encodeURIComponent(e)}`).promise,putSidecar:(e,t)=>vt(`${Ye}/item?path=${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json","x-client-id":vi(),"x-updated-by":"web"},body:JSON.stringify(t)}).promise,getHealth:()=>vt(`${Ye}/health`).promise,joinPresence:(e,t,n)=>jl("/presence/join",{gallery_id:e,client_id:Nl(n),lease_id:t}),movePresence:(e,t,n,r)=>jl("/presence/move",{from_gallery_id:e,to_gallery_id:t,client_id:Nl(r),lease_id:n}),leavePresence:(e,t,n)=>jl("/presence/leave",{gallery_id:e,client_id:Nl(n),lease_id:t}),postPresence:(e,t,n)=>jl("/presence",{gallery_id:e,client_id:Nl(n),lease_id:t}),getThumb:e=>xd.getOrFetch(e,()=>Bi(Ip(e))),prefetchThumb:e=>{xd.prefetch(e,()=>Bi(Ip(e)))},getFile:e=>Ps.getOrFetch(e,()=>Bi(_p(e))),exportComparison:e=>Bi(`${Ye}/export-comparison`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,prefetchFile:async(e,t)=>{if(dS(t)&&!(Ps.has(e)||Ps.isInflight(e)))try{const n=await Bi(_p(e),{headers:{"x-lenslet-prefetch":t}}).promise;n.size<=cS&&Ps.set(e,n)}catch{}},cancelPrefetch:e=>{Ps.cancelPrefetch(e)},uploadFile:async(e,t)=>{const n=new FormData;return n.append("dest",e),n.append("file",t),vt(`${Ye}/file`,{method:"POST",body:n,timeoutMs:6e4}).promise},moveFile:async(e,t)=>{const n=new FormData;return n.append("src",e),n.append("dest",t),vt(`${Ye}/move`,{method:"POST",body:n}).promise},deleteFiles:async e=>vt(`${Ye}/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paths:e})}).promise,exportIntent:async e=>{const t=new FormData;return t.append("path",e),vt(`${Ye}/export-intent`,{method:"POST",body:t}).promise},getViews:()=>vt(`${Ye}/views`).promise,saveViews:e=>vt(`${Ye}/views`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise};class IS{constructor(t=400){lt(this,"cache",new Map);lt(this,"maxSize");this.maxSize=t,typeof window<"u"&&window.addEventListener("beforeunload",()=>this.clear(),{once:!0})}get(t){const n=this.cache.get(t);return n&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){for(this.cache.has(t)&&this.cache.delete(t);this.cache.size>=this.maxSize;){const r=this.cache.keys().next().value;if(r===void 0)break;const s=this.cache.get(r);if(this.cache.delete(r),s)try{URL.revokeObjectURL(s)}catch{}}this.cache.set(t,n)}clear(){for(const t of this.cache.values())try{URL.revokeObjectURL(t)}catch{}this.cache.clear()}}const Zu=new IS(400);function _S({path:e,name:t,onClick:n,selected:r,highlighted:s,highlightKey:i,displayW:o,displayH:l,ioRoot:c,isScrolling:d,priority:f}){const p=u.useRef(null),[h,S]=u.useState(()=>Zu.get(e)??null),[x,w]=u.useState(!1),[C,y]=u.useState(()=>!!h);u.useEffect(()=>{const v=p.current;if(!v)return;const g=new IntersectionObserver(b=>{for(const N of b)N.target===v&&w(N.isIntersecting||N.intersectionRatio>0)},{root:c??null,rootMargin:"200px 0px",threshold:.01});return g.observe(v),()=>{g.unobserve(v),g.disconnect()}},[c]),u.useEffect(()=>{if(h||!(x&&!d||f))return;let v=!0;return xe.getThumb(e).then(g=>{if(!v)return;const b=URL.createObjectURL(g);Zu.set(e,b),S(b)}).catch(()=>{}),()=>{v=!1}},[e,h,x,d,f]),u.useEffect(()=>{var g;if(!h){y(!1);return}const v=(g=p.current)==null?void 0:g.querySelector("img");v&&v.complete&&v.naturalWidth>0?y(!0):y(!1)},[h]),u.useEffect(()=>{S(Zu.get(e)??null)},[e]);const m=["absolute inset-0 relative bg-hover border border-border rounded-lg overflow-hidden select-none",r?"outline-2 outline-accent":"",s?"thumb-updated-ring":"","hover:outline hover:outline-1 hover:outline-accent"].filter(Boolean).join(" ");return a.jsx("div",{ref:p,"data-highlight-key":i??void 0,className:m,onClick:n,children:h?a.jsx("img",{className:`w-full h-full object-cover block pointer-events-none select-none opacity-0 transition-opacity duration-[160ms] ${C?"opacity-100":""}`,src:h,alt:t,loading:"lazy",decoding:"async",onLoad:()=>y(!0),width:o?Math.round(o):void 0,height:l?Math.round(l):void 0}):null})}function js(e,t,n){let r=n.initialDeps??[],s,i=!0;function o(){var l,c,d;let f;n.key&&((l=n.debug)!=null&&l.call(n))&&(f=Date.now());const p=e();if(!(p.length!==r.length||p.some((x,w)=>r[w]!==x)))return s;r=p;let S;if(n.key&&((c=n.debug)!=null&&c.call(n))&&(S=Date.now()),s=t(...p),n.key&&((d=n.debug)!=null&&d.call(n))){const x=Math.round((Date.now()-f)*100)/100,w=Math.round((Date.now()-S)*100)/100,C=w/16,y=(m,v)=>{for(m=String(m);m.length<v;)m=" "+m;return m};console.info(`%c ${y(w,5)} /${y(x,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*C,120))}deg 100% 31%);`,n==null?void 0:n.key)}return n!=null&&n.onChange&&!(i&&n.skipInitialOnChange)&&n.onChange(s),i=!1,s}return o.updateDeps=l=>{r=l},o}function $p(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const FS=(e,t)=>Math.abs(e-t)<1.01,OS=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},Bp=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},AS=e=>e,DS=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},zS=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=o=>{const{width:l,height:c}=o;t({width:Math.round(l),height:Math.round(c)})};if(s(Bp(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(o=>{const l=()=>{const c=o[0];if(c!=null&&c.borderBoxSize){const d=c.borderBoxSize[0];if(d){s({width:d.inlineSize,height:d.blockSize});return}}s(Bp(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},Up={passive:!0},Vp=typeof window>"u"?!0:"onscrollend"in window,$S=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&Vp?()=>{}:OS(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),o=f=>()=>{const{horizontal:p,isRtl:h}=e.options;s=p?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,f)},l=o(!0),c=o(!1);c(),n.addEventListener("scroll",l,Up);const d=e.options.useScrollendEvent&&Vp;return d&&n.addEventListener("scrollend",c,Up),()=>{n.removeEventListener("scroll",l),d&&n.removeEventListener("scrollend",c)}},BS=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},US=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const o=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class VS{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:AS,rangeExtractor:DS,onChange:()=>{},measureElement:BS,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=js(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let o=r-1;o>=0;o--){const l=n[o];if(s.has(l.lane))continue;const c=i.get(l.lane);if(c==null||l.end>c.end?i.set(l.lane,l):l.end<c.end&&s.set(l.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=js(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(n,r,s,i,o,l)=>(this.prevLanes!==void 0&&this.prevLanes!==l&&(this.lanesChangedFlag=!0),this.prevLanes=l,this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=js(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l},c)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>n)for(const h of this.laneAssignments.keys())h>=n&&this.laneAssignments.delete(h);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(h=>{this.itemSizeCache.set(h.key,h.size)}));const d=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===n&&(this.lanesSettling=!1);const f=this.measurementsCache.slice(0,d),p=new Array(l).fill(void 0);for(let h=0;h<d;h++){const S=f[h];S&&(p[S.lane]=h)}for(let h=d;h<n;h++){const S=i(h),x=this.laneAssignments.get(h);let w,C;if(x!==void 0&&this.options.lanes>1){w=x;const g=p[w],b=g!==void 0?f[g]:void 0;C=b?b.end+this.options.gap:r+s}else{const g=this.options.lanes===1?f[h-1]:this.getFurthestMeasurement(f,h);C=g?g.end+this.options.gap:r+s,w=g?g.lane:h%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(h,w)}const y=c.get(S),m=typeof y=="number"?y:this.options.estimateSize(h),v=C+m;f[h]={index:h,start:C,size:m,end:v,key:S,lane:w},p[w]=h}return this.measurementsCache=f,f},{key:!1,debug:()=>this.options.debug}),this.calculateRange=js(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?WS({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=js(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,o)=>i===null||o===null?[]:n({startIndex:i,endIndex:o,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==n&&(l&&this.observer.unobserve(l),this.observer.observe(n),this.elementsCache.set(o,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,o=r-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,o,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=js(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,o=n.length;i<o;i++){const l=n[i],c=r[l];s.push(c)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return $p(r[Oy(0,r.length-1,s=>$p(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),o=this.getScrollOffset();r==="auto"&&(r=n>=o+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),o=this.getScrollOffset();if(r==="auto")if(s.end>=o+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=o+this.options.scrollPaddingStart)r="start";else return[o,r];const l=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),n=Math.max(0,Math.min(n,this.options.count-1));let i=0;const o=10,l=d=>{if(!this.targetWindow)return;const f=this.getOffsetForIndex(n,d);if(!f){console.warn("Failed to get offset for index:",n);return}const[p,h]=f;this._scrollToOffset(p,{adjustments:void 0,behavior:s}),this.targetWindow.requestAnimationFrame(()=>{const S=this.getScrollOffset(),x=this.getOffsetForIndex(n,h);if(!x){console.warn("Failed to get offset for index:",n);return}FS(x[0],S)||c(h)})},c=d=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(d)):console.warn(`Failed to scroll to index ${n} after ${o} attempts.`))};l(r)},this.scrollBy=(n,{behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=r.length-1;for(;o>=0&&i.some(l=>l===null);){const l=r[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}s=Math.max(...i.filter(l=>l!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(t)}}const Oy=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function WS({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=c=>e[c].start;if(e.length<=r)return{startIndex:0,endIndex:s};let o=Oy(0,s,i,n),l=o;if(r===1)for(;l<s&&e[l].end<n+t;)l++;else if(r>1){const c=Array(r).fill(0);for(;l<s&&c.some(f=>f<n+t);){const f=e[l];c[f.lane]=f.end,l++}const d=Array(r).fill(n+t);for(;o>=0&&d.some(f=>f>=n);){const f=e[o];d[f.lane]=f.start,o--}o=Math.max(0,o-o%r),l=Math.min(s,l+(r-1-l%r))}return{startIndex:o,endIndex:l}}const Wp=typeof document<"u"?u.useLayoutEffect:u.useEffect;function HS(e){const t=u.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var o;i?Ga.flushSync(t):t(),(o=e.onChange)==null||o.call(e,s,i)}},[r]=u.useState(()=>new VS(n));return r.setOptions(n),Wp(()=>r._didMount(),[]),Wp(()=>r._willUpdate()),r}function QS(e){return HS({observeElementRect:zS,observeElementOffset:$S,scrollToFn:US,...e})}function KS({containerW:e,gap:t,targetCell:n,aspect:r,captionH:s}){const i=Math.max(1,Math.floor((e+t)/(n+t))),o=(e-t*(i-1))/i,l=o*r.h/r.w,c=l+s+t;return{columns:i,cellW:o,mediaH:l,rowH:c}}const YS=1.333;function XS({items:e,containerWidth:t,targetHeight:n,gap:r,captionH:s}){if(t<=0)return[];const i=[];let o=[],l=0;const c=(d,f)=>({index:i.length,height:f+s+r,imageH:f,items:d.map(p=>({item:p.item,displayW:p.aspect*f,displayH:f,originalIndex:p.originalIndex}))});for(let d=0;d<e.length;d++){const f=e[d],p=f.w>0&&f.h>0?f.w/f.h:YS;o.push({item:f,aspect:p,originalIndex:d}),l+=p;const h=(o.length-1)*r;if(l*n+h>=t){const x=(t-h)/l;i.push(c(o,x)),o=[],l=0}}return o.length>0&&i.push(c(o,n)),i}function qS(e,t,n){return{mode:"adaptive",rows:XS({items:t,containerWidth:e,targetHeight:n.targetCell,gap:n.gap,captionH:n.captionH})}}function GS(e,t,n){const{columns:r,cellW:s,mediaH:i,rowH:o}=KS({containerW:e,gap:n.gap,targetCell:n.targetCell,aspect:n.aspect,captionH:n.captionH}),l=Math.ceil(t.length/Math.max(1,r));return{mode:"grid",columns:r,cellW:s,mediaH:i,rowH:o,rowCount:l}}function JS(e,t,n){const[r,s]=u.useState(0);u.useLayoutEffect(()=>{const c=e.current;if(!c)return;const d=()=>{const p=getComputedStyle(c),h=c.clientWidth-parseFloat(p.paddingLeft)-parseFloat(p.paddingRight);s(h)},f=new ResizeObserver(d);return f.observe(c),d(),()=>f.disconnect()},[]);const i=u.useMemo(()=>n.viewMode==="adaptive"?qS(r,t,n):GS(r,t,n),[r,t,n.viewMode,n.gap,n.targetCell,n.aspect.w,n.aspect.h,n.captionH]),o=QS({count:i.mode==="adaptive"?i.rows.length:i.rowCount,getScrollElement:()=>e.current,estimateSize:c=>i.mode==="adaptive"?i.rows[c].height:i.rowH,overscan:8}),l=o.getVirtualItems();return u.useEffect(()=>{o.measure()},[i,o]),{width:r,layout:i,rowVirtualizer:o,virtualRows:l}}function ZS(e,t,n,r){if(!e.length)return null;const s=n?e.findIndex(l=>l.path===n):0,i=Math.max(1,t);let o=s;if(r.key==="ArrowRight"||r.key==="d")o=Math.min(e.length-1,s+1);else if(r.key==="ArrowLeft"||r.key==="a")o=Math.max(0,s-1);else if(r.key==="ArrowDown"||r.key==="s")o=Math.min(e.length-1,s+i);else if(r.key==="ArrowUp"||r.key==="w")o=Math.max(0,s-i);else return r.key==="Enter"&&n?"open":null;return o}function eb(e,t,n){const r=[];for(const s of e){if(t.mode==="adaptive"){const l=t.rows[s.index];if(!l)continue;for(const c of l.items)r.push(c.item.path);continue}const i=s.index*t.columns,o=n.slice(i,i+t.columns);for(const l of o)r.push(l.path)}return Array.from(new Set(r))}const tb=500,nb=450,rb=600,sb=8;function ib(e){return Math.max(nb,Math.min(rb,e))}class ob{constructor(t){lt(this,"delayMs");lt(this,"moveTolerancePx");lt(this,"onLongPress");lt(this,"onCancel");lt(this,"timerId",null);lt(this,"activePointerId",null);lt(this,"startX",0);lt(this,"startY",0);lt(this,"lastEvent",null);lt(this,"fired",!1);this.delayMs=ib(t.delayMs??tb),this.moveTolerancePx=Math.max(0,t.moveTolerancePx??sb),this.onLongPress=t.onLongPress,this.onCancel=t.onCancel}pointerDown(t){return(t.pointerType??"mouse")==="mouse"?!1:t.isPrimary===!1?(this.cancel("multitouch"),!1):this.activePointerId!=null&&this.activePointerId!==t.pointerId?(this.cancel("multitouch"),!1):(this.activePointerId=t.pointerId,this.startX=t.clientX,this.startY=t.clientY,this.lastEvent=t,this.fired=!1,this.clearTimer(),this.timerId=setTimeout(()=>{this.activePointerId==null||this.fired||this.lastEvent==null||(this.fired=!0,this.clearTimer(),this.onLongPress(this.lastEvent))},this.delayMs),!0)}pointerMove(t){if(!this.matchesPointer(t.pointerId)||this.fired)return;this.lastEvent=t;const n=t.clientX-this.startX,r=t.clientY-this.startY;Math.hypot(n,r)>this.moveTolerancePx&&this.cancel("movement")}pointerUp(t){if(!(t!=null&&!this.matchesPointer(t))){if(!this.fired){this.cancel("pointerup");return}this.reset()}}pointerCancel(t){t!=null&&!this.matchesPointer(t)||this.cancel("pointercancel")}cancelFromScroll(){this.cancel("scroll")}destroy(){this.cancel("cleanup")}matchesPointer(t){return this.activePointerId!=null&&this.activePointerId===t}clearTimer(){this.timerId!=null&&(clearTimeout(this.timerId),this.timerId=null)}reset(){this.clearTimer(),this.activePointerId=null,this.lastEvent=null,this.fired=!1}cancel(t){var r;const n=this.timerId!=null&&!this.fired&&t!=="cleanup";this.reset(),n&&((r=this.onCancel)==null||r.call(this,t))}}function lb(e){return e==="touch"||e==="pen"}function ab(e){return e.multiSelectMode||e.isShift||e.isToggle||!lb(e.pointerType)?!1:e.selectedPaths.length===1&&e.selectedPaths[0]===e.path}function Hp(e,t){return e.includes(t)?e.filter(n=>n!==t):[...e,t]}const Dn=12,ub=44,cb={w:4,h:3},db=350,fb=120;function hb(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Qp(e){return{pointerId:e.pointerId,pointerType:e.pointerType,clientX:e.clientX,clientY:e.clientY,isPrimary:e.isPrimary}}function pb(e,t){var s,i;let n=0,r=e.length-1;for(;n<=r;){const o=n+r>>1,l=e[o],c=((s=l.items[0])==null?void 0:s.originalIndex)??-1,d=((i=l.items[l.items.length-1])==null?void 0:i.originalIndex)??-1;if(t>=c&&t<=d)return o;t<c?r=o-1:n=o+1}return 0}function mb(e,t){const n=(t??"").trim();if(!n)return e;const r=e.toLowerCase().indexOf(n.toLowerCase());if(r===-1)return e;const s=e.slice(0,r),i=e.slice(r,r+n.length),o=e.slice(r+n.length);return a.jsxs(a.Fragment,{children:[s,a.jsx("mark",{className:"bg-accent/20 text-inherit rounded px-0.5",children:i}),o]})}function gb({items:e,selected:t,restoreToSelectionToken:n,multiSelectMode:r=!1,onSelectionChange:s,onOpenViewer:i,onContextMenuItem:o,onOpenItemActions:l,highlight:c,recentlyUpdated:d,onVisiblePathsChange:f,suppressSelectionHighlight:p=!1,viewMode:h="grid",targetCellSize:S=220,scrollRef:x,hideScrollbar:w=!1}){const[C,y]=u.useState(null),[m,v]=u.useState(null),[g,b]=u.useState(!1),[N,j]=u.useState(null),[E,O]=u.useState(null),L=u.useRef(null),A=u.useRef(null),z=u.useRef(null),H=x??z,Z=u.useRef(null),B=u.useRef(new Set),T=u.useRef(null),R=u.useRef(null),M=u.useRef(null),_=u.useRef(null),F=u.useRef({path:null,pointerType:null}),W=S,{width:U,layout:I,rowVirtualizer:X,virtualRows:J}=JS(H,e,{gap:Dn,targetCell:W,aspect:cb,captionH:ub,viewMode:h}),ne=u.useMemo(()=>{const D=new Map;for(let q=0;q<e.length;q++)D.set(e[q].path,q);return D},[e]),ee=u.useMemo(()=>{if(I.mode!=="adaptive")return null;const D=new Map;return I.rows.forEach((q,K)=>{let me=0;q.items.forEach((ge,ye)=>{const ce=me+ge.displayW/2;D.set(ge.item.path,{row:K,center:ce,order:ye}),me+=ge.displayW+Dn})}),D},[I]);u.useEffect(()=>{if(!t.length)return;const D=t[0];N!==D&&j(D)},[t,N]);const Y=u.useMemo(()=>{if(I.mode!=="adaptive")return null;let D=0;return I.rows.map(q=>{const K=D;return D+=q.height,{start:K,height:q.height}})},[I]),V=u.useRef(null),pe=(D,q)=>{try{if(V.current!=null){try{cancelAnimationFrame(V.current)}catch{}V.current=null}const K=D.scrollTop,me=q-K;if(Math.abs(me)<1){D.scrollTop=q;return}const ge=140,ye=performance.now(),ce=_e=>1-Math.pow(1-_e,3),je=_e=>{const ft=Math.min(1,(_e-ye)/ge),Te=ce(ft);D.scrollTop=K+me*Te,ft<1?V.current=requestAnimationFrame(je):V.current=null};V.current=requestAnimationFrame(je)}catch{D.scrollTop=q}},[ae,$e]=u.useState(!1);u.useEffect(()=>{const D=H.current;if(!D)return;let q=0;const K=()=>{var me;(me=T.current)==null||me.cancelFromScroll(),$e(!0),window.clearTimeout(q),q=window.setTimeout(()=>$e(!1),fb)};return D.addEventListener("scroll",K,{passive:!0}),()=>D.removeEventListener("scroll",K)},[]),u.useEffect(()=>{const D=new ob({onLongPress:q=>{const K=R.current;if(!K||!l)return;const me=M.current??{x:q.clientX,y:q.clientY};l(K,me),_.current={path:K,untilMs:Date.now()+700}}});return T.current=D,()=>{D.destroy(),T.current===D&&(T.current=null)}},[l]);const Pe=()=>{A.current!=null&&(window.clearTimeout(A.current),A.current=null)},Fe=()=>{if(Pe(),b(!1),y(null),L.current){try{URL.revokeObjectURL(L.current)}catch{}L.current=null}v(null)},dt=D=>{ae||(Pe(),y(D),b(!1),A.current=window.setTimeout(async()=>{A.current=null;try{const q=await xe.getFile(D),K=URL.createObjectURL(q);if(L.current)try{URL.revokeObjectURL(L.current)}catch{}L.current=K,v(K),b(!0)}catch{}},db))},Ue=I.mode==="grid"?I.columns:Math.max(1,Math.floor(U/(W+Dn))),St=(D,q)=>{if(I.mode!=="adaptive")return null;const K=I.rows[D];if(!K)return null;let me=0,ge=null;for(const ye of K.items){const ce=me+ye.displayW/2,je=Math.abs(ce-q);(!ge||je<ge.dist)&&(ge={path:ye.item.path,dist:je}),me+=ye.displayW+Dn}return ge?ge.path:null},ue=(D,q)=>{var Te,De,Qe,rt;if(!e.length)return null;const K=D??e[0].path;if(I.mode!=="adaptive"){const fn=ZS(e,Ue,K,q);return fn==="open"||fn==null?fn:((Te=e[fn])==null?void 0:Te.path)??null}const me=ee==null?void 0:ee.get(K);if(!me)return K;const ge=ne.get(K)??0,ye=q.key;if(ye==="Enter")return"open";if(ye==="ArrowRight"||ye==="d")return((De=e[Math.min(e.length-1,ge+1)])==null?void 0:De.path)??K;if(ye==="ArrowLeft"||ye==="a")return((Qe=e[Math.max(0,ge-1)])==null?void 0:Qe.path)??K;const ce=ye==="ArrowDown"||ye==="s"?1:ye==="ArrowUp"||ye==="w"?-1:0;if(ce===0)return null;const je=me.row+ce;if(je<0||je>=(((rt=I.rows)==null?void 0:rt.length)??0))return K;const _e=me.center;return St(je,_e)??K},oe=D=>{var q;try{(q=document.getElementById(`cell-${encodeURIComponent(D)}`))==null||q.focus()}catch{}},Se=u.useCallback(D=>{try{xe.prefetchThumb(D)}catch{}},[]),Oe=u.useCallback((D,q)=>{l==null||l(D,q)},[l]),Ce=()=>{R.current=null,M.current=null},ve=(D,q)=>{var K;q.target.closest("[data-grid-action]")||(F.current={path:D,pointerType:q.pointerType},!r&&(R.current=D,M.current={x:q.clientX,y:q.clientY},(K=T.current)==null||K.pointerDown(Qp(q))))},At=D=>{var q;r||(M.current={x:D.clientX,y:D.clientY},(q=T.current)==null||q.pointerMove(Qp(D)))},tn=D=>{var q;r||((q=T.current)==null||q.pointerUp(D.pointerId),Ce())},nt=D=>{var q;r||((q=T.current)==null||q.pointerCancel(D.pointerId),Ce())},zr=(D,q)=>{const K=_.current;if(K&&K.path===D&&K.untilMs>Date.now()){_.current=null,oe(D);return}K&&K.untilMs<=Date.now()&&(_.current=null),j(D),O(D);const me=!!q.shiftKey,ge=!!(q.ctrlKey||q.metaKey);if(r)s(Hp(t,D)),Z.current=D;else if(ab({pointerType:F.current.path===D?F.current.pointerType:null,multiSelectMode:r,isShift:me,isToggle:ge,selectedPaths:t,path:D}))s([D]),Z.current=D,i(D);else if(me){const ye=Z.current??N??t[0]??D,ce=ne.get(ye)??e.findIndex(_e=>_e.path===ye),je=ne.get(D)??e.findIndex(_e=>_e.path===D);if(ce!==-1&&je!==-1){const _e=Math.min(ce,je),ft=Math.max(ce,je),Te=e.slice(_e,ft+1).map(De=>De.path);if(ge){const De=new Set(t);for(const Qe of Te)De.add(Qe);s(Array.from(De))}else s(Te)}else s([D])}else ge?(s(Hp(t,D)),Z.current=D):(s([D]),Z.current=D);ae||Se(D),oe(D)},$r=(D,q)=>{var K,me;try{const ge=rr.has(D)&&t.length>0?t:[D];(K=q.dataTransfer)==null||K.setData("application/x-lenslet-paths",JSON.stringify(ge)),q.dataTransfer&&(q.dataTransfer.effectAllowed="copyMove");try{document.body.classList.add("drag-active")}catch{}const ce=q.currentTarget.querySelector(".cell-content img"),je=document.createElement("div");je.className="drag-ghost";const _e=document.createElement("img");_e.draggable=!1,_e.alt="drag",ce&&ce.src&&(_e.src=ce.src),je.appendChild(_e),document.body.appendChild(je);const ft=je.getBoundingClientRect().width||150;(me=q.dataTransfer)==null||me.setDragImage(je,Math.round(ft/2),0);const Te=()=>{try{je.remove()}catch{}try{document.body.classList.remove("drag-active")}catch{}window.removeEventListener("dragend",Te),window.removeEventListener("pointerup",Te),document.removeEventListener("visibilitychange",Te)};window.addEventListener("dragend",Te),window.addEventListener("pointerup",Te),document.addEventListener("visibilitychange",Te)}catch{}};u.useEffect(()=>{const D=H.current;if(!D)return;const q=K=>{var Te,De,Qe;const me=ue(E,K);if(me==null)return;if(K.preventDefault(),me==="open"){E&&i(E);return}const ge=e.find(rt=>rt.path===me);if(!ge)return;O(ge.path),j(ge.path),s([ge.path]),Z.current=ge.path;const ye=I.mode==="grid"?Math.floor((ne.get(ge.path)??0)/Math.max(1,I.columns)):((Te=ee==null?void 0:ee.get(ge.path))==null?void 0:Te.row)??0,ce=D.scrollTop,je=ce+D.clientHeight,_e=I.mode==="adaptive"?((De=Y==null?void 0:Y[ye])==null?void 0:De.start)??0:ye*I.rowH,ft=I.mode==="adaptive"?_e+(((Qe=Y==null?void 0:Y[ye])==null?void 0:Qe.height)??0):_e+I.rowH;(_e<ce||ft>je)&&pe(D,_e),oe(ge.path)};return D.addEventListener("keydown",q),()=>{D.removeEventListener("keydown",q)}},[e,E,Ue,i,I,ee,Y,ne]),u.useLayoutEffect(()=>{var ye;const D=H.current;if(!D||!n||t.length===0)return;const q=t[0],K=ne.get(q);if(K==null||K<0)return;const me=I.mode==="grid"?Math.floor(K/Math.max(1,I.columns)):pb(I.rows,K),ge=I.mode==="adaptive"?((ye=Y==null?void 0:Y[me])==null?void 0:ye.start)??0:me*I.rowH;try{D.scrollTop=ge}catch{}},[n,I,Y]);const rr=u.useMemo(()=>new Set(t),[t]),Fn=!!(C&&m&&g),Rt=u.useMemo(()=>eb(J,I,e),[e,I,J]);u.useEffect(()=>{if(!(ae||Rt.length===0))for(const D of Rt)Se(D)},[ae,Rt,Se]),u.useEffect(()=>{var D;(D=H.current)==null||D.focus()},[]),u.useEffect(()=>{var D;if(p){try{(D=H.current)==null||D.blur()}catch{}O(null)}},[p]);const bt=u.useMemo(()=>{const D=new Set;for(const q of J){if(I.mode==="adaptive"){const ge=I.rows[q.index];if(!ge)continue;for(const ye of ge.items)D.add(ye.item.path);continue}const K=q.index*I.columns,me=Math.min(e.length,K+I.columns);for(let ge=K;ge<me;ge+=1){const ye=e[ge];ye&&D.add(ye.path)}}return D},[e,I,J]);u.useEffect(()=>{f&&(hb(B.current,bt)||(B.current=bt,f(bt)))},[f,bt]);const Dt=E?`cell-${encodeURIComponent(E)}`:void 0;return a.jsx("div",{role:"grid","aria-label":"Gallery",className:`relative h-full overflow-auto p-3 outline-none ${w?"scrollbar-hidden pr-4":"scrollbar-thin"} ${Fn?"cursor-zoom-in":""}`,ref:H,tabIndex:0,"aria-activedescendant":Dt,onMouseDown:()=>{var D;return(D=H.current)==null?void 0:D.focus()},style:{"--gap":`${Dn}px`},children:a.jsxs("div",{className:"relative w-full",style:{height:X.getTotalSize()},children:[J.map(D=>{var ye;let q=[],K={},me="";if(I.mode==="adaptive"){const ce=I.rows[D.index];if(!ce)return null;q=ce.items,K={height:ce.height,transform:`translate3d(0, ${D.start}px, 0)`,display:"flex",gap:Dn,paddingBottom:Dn},me="absolute top-0 left-0 right-0 w-full will-change-transform"}else{const ce=D.index*I.columns;q=e.slice(ce,ce+I.columns).map(_e=>({item:_e,displayW:I.cellW,displayH:I.mediaH})),K={transform:`translate3d(0, ${D.start}px, 0)`,gridTemplateColumns:`repeat(${I.columns}, minmax(0, 1fr))`,gap:Dn,paddingBottom:Dn},me="absolute top-0 left-0 right-0 w-full grid will-change-transform"}const ge=D.index===((ye=J[0])==null?void 0:ye.index);return a.jsx("div",{className:me,role:"row",style:K,children:q.map(({item:ce,displayW:je,displayH:_e})=>{const ft=!p&&(N===ce.path||rr.has(ce.path)),Te=(d==null?void 0:d.get(ce.path))??null,De=Te!=null,Qe=I.mode==="adaptive"?{width:je}:{},rt=I.mode==="adaptive"?{height:_e}:{},fn=I.mode==="adaptive"?"relative rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group shrink-0":"relative aspect-[4/3] rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group";return a.jsxs("div",{id:`cell-${encodeURIComponent(ce.path)}`,className:`relative min-w-0 ${ft?"outline outline-2 outline-accent outline-offset-2 rounded-[10px]":""}`,role:"gridcell","aria-selected":ft,tabIndex:E===ce.path?0:-1,onFocus:()=>O(ce.path),draggable:!0,style:Qe,onDragStart:Ke=>$r(ce.path,Ke),onPointerDown:Ke=>ve(ce.path,Ke),onPointerMove:At,onPointerUp:tn,onPointerCancel:nt,onContextMenu:Ke=>{Ke.preventDefault(),Ke.stopPropagation(),o==null||o(Ke,ce.path)},children:[a.jsxs("div",{className:fn,style:rt,onDoubleClick:()=>{r||i(ce.path)},onMouseLeave:Fe,children:[a.jsx("button",{type:"button",className:"grid-item-action-btn touch-manipulation","data-grid-action":"1","aria-label":`Open actions for ${ce.name}`,"aria-haspopup":"menu",onPointerDown:Ke=>Ke.stopPropagation(),onClick:Ke=>{Ke.stopPropagation();const Br=Ke.currentTarget.getBoundingClientRect();Oe(ce.path,{x:Br.right-4,y:Br.bottom-4})},children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})}),a.jsx("div",{className:"cell-content absolute inset-0",children:a.jsx(_S,{path:ce.path,name:ce.name,selected:ft,highlighted:De,highlightKey:Te,displayW:je,displayH:_e,ioRoot:H.current,isScrolling:ae,priority:ge,onClick:Ke=>zr(ce.path,Ke)})}),a.jsx("div",{className:"absolute right-0 bottom-0 w-7 h-7 cursor-zoom-in",onMouseEnter:()=>dt(ce.path),onMouseLeave:Fe,children:a.jsx("div",{className:"grid-item-preview-corner absolute right-0 bottom-0 h-[18px] w-[18px] flex items-center justify-center text-text select-none",style:{clipPath:'path("M0 9C0 4.02944 4.02944 0 9 0H18V18H0V9Z")',background:"linear-gradient(135deg, rgba(18,18,18,0.9) 0%, rgba(34,34,34,0.9) 60%, rgba(22,22,22,0.9) 100%)",borderTop:"1px solid rgba(255,255,255,0.08)",borderLeft:"1px solid rgba(255,255,255,0.08)",boxShadow:"0 1px 2px rgba(0,0,0,0.45)",backdropFilter:"blur(1px)"},children:a.jsxs("svg",{width:"11",height:"11",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round",className:"text-[#d9dce2]","aria-hidden":"true",style:{transform:"translate(0px,0px)"},children:[a.jsx("circle",{cx:"11",cy:"11",r:"5.4"}),a.jsx("path",{d:"M15.5 15.5 L19 19"})]})})})]}),a.jsxs("div",{className:"flex flex-col items-center text-center gap-0 mt-1 px-0.5 text-white/90",children:[a.jsx("div",{className:"text-sm leading-[18px] thumb-filename line-clamp-2 break-words hyphens-auto text-center",title:ce.name,children:mb(ce.name,c)}),a.jsxs("div",{className:"text-[11px] leading-[15px] opacity-70",children:[ce.w,"  ",ce.h]})]})]},ce.path)})},D.key)}),C&&m&&g&&Ga.createPortal(a.jsx("div",{className:"toolbar-offset fixed inset-0 z-[999] flex items-center justify-center pointer-events-none bg-black/20 opacity-100",children:a.jsx("img",{src:m,alt:"preview",className:"max-w-[80vw] max-h-[80vh] object-contain opacity-[0.98]"})}),document.body)]},`${h}-${Ue}`)})}const vb=48,yb=[.1,.24,.5,.74,.9];function xb({items:e,metricKey:t,scrollRef:n,sortDir:r}){const{orderedValues:s,numericValues:i}=u.useMemo(()=>{var L;const E=[],O=[];for(const A of e){const z=(L=A.metrics)==null?void 0:L[t],H=z==null||Number.isNaN(z)?null:z;E.push(H),H!=null&&O.push(H)}return{orderedValues:E,numericValues:O}},[e,t]),o=u.useMemo(()=>wb(i,vb),[i]),l=u.useMemo(()=>Sb(i,yb),[i]),[c,d]=u.useState(0),[f,p]=u.useState(null),[h,S]=u.useState(!1),x=u.useRef(null);if(u.useEffect(()=>{const E=n.current;if(!E)return;const O=()=>{const L=Math.max(1,E.scrollHeight-E.clientHeight),A=Gr(L>0?E.scrollTop/L:0);d(A)};return O(),E.addEventListener("scroll",O,{passive:!0}),window.addEventListener("resize",O),()=>{E.removeEventListener("scroll",O),window.removeEventListener("resize",O)}},[n,e.length]),u.useEffect(()=>{p(null)},[t,e.length]),!o)return null;const w={min:o.min,max:o.max},C=f!=null?Yp(f):null,y=Yp(c),m=r==="desc",v=u.useMemo(()=>f==null?null:kb(s,f),[s,f]);function g(E){p(Gr(E))}function b(){p(null)}function N(E){const O=n.current;if(!O)return;const L=Math.max(0,O.scrollHeight-O.clientHeight);O.scrollTop=Gr(E)*L}function j(E){var L;const O=(L=x.current)==null?void 0:L.getBoundingClientRect();return O?Gr((E.clientY-O.top)/O.height):null}return a.jsxs("div",{className:"absolute right-0 top-3 bottom-3 w-[14px] flex items-stretch pointer-events-auto",children:[a.jsxs("svg",{ref:x,viewBox:"0 0 10 100",preserveAspectRatio:"none",className:"w-full h-full rounded bg-surface-inset border border-border/60 cursor-ns-resize",onPointerDown:E=>{var L;E.preventDefault();const O=j(E);O!=null&&(S(!0),g(O),N(O),(L=x.current)==null||L.setPointerCapture(E.pointerId))},onPointerMove:E=>{const O=j(E);if(O==null){h||b();return}g(O),h&&N(O)},onPointerUp:E=>{var O;S(!1),(O=x.current)==null||O.releasePointerCapture(E.pointerId)},onPointerLeave:()=>{h||b()},children:[bb(o.bins,"var(--border-strong)",{flip:m}),Cb(l,w,{flip:m,color:"var(--muted)"}),Kp(y,{color:"var(--highlight)",strokeWidth:.8}),C!=null&&Kp(C,{color:"var(--text-secondary)",strokeWidth:.6,dashed:!0})]}),v!=null&&f!=null&&a.jsx("div",{className:"pointer-events-none absolute right-full mr-2 px-1.5 py-0.5 rounded border border-border bg-surface text-[10px] text-text shadow",style:{top:`calc(${(f*100).toFixed(2)}% - 8px)`},children:Nb(v)})]})}function wb(e,t){if(!e.length)return null;const n=Math.min(...e);let r=Math.max(...e);n===r&&(r=n+1);const s=new Array(t).fill(0),i=t/(r-n);for(const o of e){const l=Math.max(0,Math.min(t-1,Math.floor((o-n)*i)));s[l]+=1}return{bins:s,min:n,max:r}}function Sb(e,t){if(!e.length)return[];const n=[...e].sort((s,i)=>s-i),r=n.length-1;return t.map(s=>{const i=r*s,o=Math.floor(i),l=Math.ceil(i);if(o===l)return n[o];const c=i-o;return n[o]+(n[l]-n[o])*c})}function bb(e,t,n){const r=Math.max(1,...e),s=100/e.length,i=(n==null?void 0:n.flip)??!1;return e.map((o,l)=>{const c=Math.max(.8,o/r*10),d=(i?e.length-1-l:l)*s;return a.jsx("rect",{x:10-c,y:d,width:c,height:Math.max(.2,s-.2),fill:t,opacity:.9},`sb-${l}`)})}function Cb(e,t,n){const r=(n==null?void 0:n.flip)??!1,s=n==null?void 0:n.color;return e.map((i,o)=>{const l=Eb(i,t,r),c=o===2;return a.jsx("line",{x1:0,y1:l,x2:10,y2:l,stroke:s,strokeWidth:c?.8:.5,opacity:c?.9:.6,vectorEffect:"non-scaling-stroke"},`qt-${o}-${i}`)})}function Kp(e,t){return a.jsx("line",{x1:0,y1:e,x2:10,y2:e,stroke:t.color,strokeWidth:t.strokeWidth??.6,strokeDasharray:t.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}function kb(e,t){if(!e.length)return null;const n=Math.round(Gr(t)*(e.length-1)),r=e[n];if(r!=null)return r;for(let s=1;s<e.length;s++){const i=n-s;if(i>=0&&e[i]!=null)return e[i];const o=n+s;if(o<e.length&&e[o]!=null)return e[o]}return null}function Eb(e,t,n){const r=t.max-t.min;if(r===0)return 0;const s=Gr((e-t.min)/r);return(n?1-s:s)*100}function Yp(e){return Gr(e)*100}function Gr(e){return e<0?0:e>1?1:e}function Nb(e){if(e==null||Number.isNaN(e))return"-";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function Jr(e,t){const[n,r]=u.useState(null),s=u.useRef(null);return u.useEffect(()=>{if(!e){if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}r(null);return}let i=!0;return e().then(o=>{if(!i)return;const l=URL.createObjectURL(o);if(s.current)try{URL.revokeObjectURL(s.current)}catch{}s.current=l,r(l)}).catch(()=>{}),()=>{i=!1}},t),u.useEffect(()=>()=>{if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}},[]),n}const jb=1.2,Mb=.05,Rb=8;function ec(e){return Number(Math.min(Rb,Math.max(Mb,e)).toFixed(4))}function Xp(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function qp(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function Pb(e,t){try{e.setPointerCapture(t)}catch{}}function Tb(e,t){try{e.releasePointerCapture(t)}catch{}}function Lb(){const[e,t]=u.useState(1),[n,r]=u.useState(0),[s,i]=u.useState(0),[o,l]=u.useState(1),[c,d]=u.useState(!1),[f,p]=u.useState(!1),[h,S]=u.useState(!1),x=u.useRef(null),w=u.useRef(null),C=u.useRef(1),y=u.useRef(0),m=u.useRef(0),v=u.useRef(new Map),g=u.useRef(null),b=u.useRef(null),N=(R,M)=>{y.current=R,m.current=M,r(R),i(M)},j=R=>{const M=ec(R);C.current=M,t(M)},E=(R,M)=>{g.current={pointerId:R,startX:M.x,startY:M.y,startTx:y.current,startTy:m.current},b.current=null,p(!0)},O=()=>{const R=Array.from(v.current.entries());if(R.length<2)return;const[M,_]=R,[F,W]=M,[U,I]=_,X=Xp(W,I);!Number.isFinite(X)||X<=2||(b.current={pointerIds:[F,U],startDistance:X,startCenter:qp(W,I),startScale:C.current,startTx:y.current,startTy:m.current},g.current=null,p(!0))},L=()=>{const R=x.current,M=w.current;if(!R||!M||!M.naturalWidth||!M.naturalHeight)return;const _=R.getBoundingClientRect(),F=_.width/M.naturalWidth,W=_.height/M.naturalHeight,U=Math.min(1,Math.min(F,W));l(U);const I=M.naturalWidth*U,X=M.naturalHeight*U;N((_.width-I)/2,(_.height-X)/2),j(1)};u.useEffect(()=>{const R=x.current;if(!R)return;const M=new ResizeObserver(()=>{try{requestAnimationFrame(()=>L())}catch{L()}});return M.observe(R),()=>M.disconnect()},[]),u.useEffect(()=>{C.current=e,y.current=n,m.current=s},[e,n,s]),u.useEffect(()=>()=>{v.current.clear(),g.current=null,b.current=null},[]);const A=R=>{R.preventDefault();const M=R.deltaY>0?-1:1,_=x.current;if(!_)return;const F=_.getBoundingClientRect(),W=R.clientX-F.left,U=R.clientY-F.top,I=C.current,X=ec(I*Math.pow(jb,M));if(X===I)return;const J=X/I,ne=W-J*(W-y.current),ee=U-J*(U-m.current);j(X),N(ne,ee)},z=R=>{if((R.pointerType??"mouse")==="mouse"&&R.button!==0)return;const _=v.current,F=w.current;if(!F||_.size===0&&R.target!==F)return;const W=R.currentTarget,U=W.getBoundingClientRect();if(!(R.clientX<U.left||R.clientX>U.right||R.clientY<U.top||R.clientY>U.bottom)){if(R.preventDefault(),R.stopPropagation(),_.set(R.pointerId,{x:R.clientX,y:R.clientY}),Pb(W,R.pointerId),_.size>=2){O();return}E(R.pointerId,{x:R.clientX,y:R.clientY})}},H=R=>{const M=v.current;if(!M.has(R.pointerId))return;M.set(R.pointerId,{x:R.clientX,y:R.clientY});const _=b.current;if(_){const I=M.get(_.pointerIds[0]),X=M.get(_.pointerIds[1]);if(I&&X){const J=Xp(I,X);if(J>2){const ne=qp(I,X),ee=ec(_.startScale*(J/_.startDistance)),Y=ee/_.startScale,V=ne.x-Y*(_.startCenter.x-_.startTx),pe=ne.y-Y*(_.startCenter.y-_.startTy);j(ee),N(V,pe)}}return}const F=g.current;if(!F||F.pointerId!==R.pointerId)return;const W=R.clientX-F.startX,U=R.clientY-F.startY;N(F.startTx+W,F.startTy+U)},Z=(R,M)=>{const _=v.current;if(!_.has(R))return;if(_.delete(R),Tb(M,R),_.size===0){g.current=null,b.current=null,p(!1);return}if(_.size>=2){O();return}const[F,W]=_.entries().next().value;E(F,W)};return{scale:e,setScale:t,tx:n,setTx:r,ty:s,setTy:i,base:o,setBase:l,ready:c,setReady:d,dragging:f,setDragging:p,visible:h,setVisible:S,containerRef:x,imgRef:w,fitAndCenter:L,handleWheel:A,handlePointerDown:z,handlePointerMove:H,handlePointerUp:R=>{Z(R.pointerId,R.currentTarget)},handlePointerCancel:R=>{Z(R.pointerId,R.currentTarget)}}}function Ib({path:e,onClose:t,onNavigate:n,canPrev:r=!1,canNext:s=!1,onZoomChange:i,requestedZoomPercent:o,onZoomRequestConsumed:l}){const{scale:c,setScale:d,tx:f,setTx:p,ty:h,setTy:S,base:x,ready:w,setReady:C,dragging:y,visible:m,setVisible:v,containerRef:g,imgRef:b,fitAndCenter:N,handleWheel:j,handlePointerDown:E,handlePointerMove:O,handlePointerUp:L,handlePointerCancel:A}=Lb(),z=Jr(()=>xe.getFile(e),[e]),H=Jr(()=>xe.getThumb(e),[e]),Z=u.useCallback(()=>{v(!1),window.setTimeout(t,110)},[t,v]);return u.useEffect(()=>{requestAnimationFrame(()=>{var B;v(!0),(B=g.current)==null||B.focus()})},[e]),u.useEffect(()=>{const B=T=>{T.key==="Escape"?Z():(T.key==="ArrowRight"||T.key==="d")&&n?n(1):(T.key==="ArrowLeft"||T.key==="a")&&n&&n(-1)};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[Z,n]),u.useEffect(()=>{C(!1)},[z]),u.useEffect(()=>{i&&i(x*c*100)},[x,c,i]),u.useEffect(()=>{if(o==null)return;const B=g.current;if(!B){l&&l();return}const T=Math.max(.05,Math.min(8,o/100/Math.max(1e-6,x))),R=B.getBoundingClientRect(),M=R.width/2,_=R.height/2;d(F=>{const W=T/F;return p(U=>M-W*(M-U)),S(U=>_-W*(_-U)),Number(T.toFixed(4))}),l&&l()},[o,x,l]),a.jsxs("div",{ref:g,role:"dialog","aria-modal":!0,"aria-label":"Image viewer",tabIndex:-1,className:`toolbar-offset touch-none absolute inset-0 left-[var(--left)] right-[var(--right)] flex items-start justify-start bg-panel z-viewer overflow-hidden transition-opacity duration-[110ms] ease-out cursor-grab focus:outline-none focus-visible:outline-none ${y?"cursor-grabbing select-none":""} ${m?"opacity-100":"opacity-0"}`,style:{outline:"none"},onClick:Z,onWheel:j,onPointerDown:E,onPointerMove:O,onPointerUp:L,onPointerCancel:A,onKeyDown:B=>{B.key==="Tab"&&B.preventDefault()},children:[a.jsxs("button",{"aria-label":"Close",onClick:B=>{B.stopPropagation(),Z()},className:"btn btn-sm absolute top-3 right-3 z-10",title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]}),H&&a.jsx("img",{src:H,alt:"thumb",className:"absolute top-0 left-0 max-w-none max-h-none object-contain pointer-events-none transition-opacity duration-[110ms] ease-out",draggable:!1,onDragStart:B=>B.preventDefault(),style:{transform:`translate(${f}px, ${h}px) scale(${x})`,transformOrigin:"0 0",opacity:w?0:.5,filter:"blur(0.25px)"}}),z&&a.jsx("img",{ref:b,src:z,alt:"viewer",className:"max-w-none max-h-none object-contain transition-opacity duration-[110ms] ease-out will-change-transform select-none",draggable:!1,onDragStart:B=>{B.preventDefault()},onLoad:B=>{N(),d(1);try{requestAnimationFrame(()=>C(!0))}catch{C(!0)}},onClick:B=>B.stopPropagation(),style:{transform:`translate(${f}px, ${h}px) scale(${x*c})`,transformOrigin:"0 0",opacity:w?.99:0,WebkitUserDrag:"none"}}),n&&a.jsxs("div",{className:"viewer-mobile-nav",onClick:B=>B.stopPropagation(),children:[a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${r?"":"is-disabled"}`,onClick:()=>r&&n(-1),"aria-label":"Previous image","aria-disabled":!r,disabled:!r,children:"Prev"}),a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${s?"":"is-disabled"}`,onClick:()=>s&&n(1),"aria-label":"Next image","aria-disabled":!s,disabled:!s,children:"Next"})]})]})}function $f(e){return!e||!(e instanceof HTMLElement)?!1:e.closest('input, textarea, [contenteditable="true"]')!==null}const _b=1.2,Fb=.05,Ob=8;function tc(e){return Number(Math.min(Ob,Math.max(Fb,e)).toFixed(4))}function Gp(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Jp(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function Ab(e,t){try{e.setPointerCapture(t)}catch{}}function Db(e,t){try{e.releasePointerCapture(t)}catch{}}function zb(){const[e,t]=u.useState(1),[n,r]=u.useState(0),[s,i]=u.useState(0),[o,l]=u.useState(0),[c,d]=u.useState(0),[f,p]=u.useState(1),[h,S]=u.useState(1),[x,w]=u.useState(!1),C=u.useRef(null),y=u.useRef(null),m=u.useRef(null),v=u.useRef(1),g=u.useRef(0),b=u.useRef(0),N=u.useRef(0),j=u.useRef(0),E=u.useRef(new Map),O=u.useRef(null),L=u.useRef(null),A=u.useCallback(I=>{g.current=I.txA,b.current=I.tyA,N.current=I.txB,j.current=I.tyB,r(I.txA),i(I.tyA),l(I.txB),d(I.tyB)},[]),z=u.useCallback(I=>{const X=tc(I);v.current=X,t(X)},[]),H=u.useCallback((I,X)=>{O.current={pointerId:I,startX:X.x,startY:X.y,startTxA:g.current,startTyA:b.current,startTxB:N.current,startTyB:j.current},L.current=null,w(!0)},[]),Z=u.useCallback(()=>{const I=Array.from(E.current.entries());if(I.length<2)return;const[X,J]=I,[ne,ee]=X,[Y,V]=J,pe=Gp(ee,V);!Number.isFinite(pe)||pe<=2||(L.current={pointerIds:[ne,Y],startDistance:pe,startCenter:Jp(ee,V),startScale:v.current,startTxA:g.current,startTyA:b.current,startTxB:N.current,startTyB:j.current},O.current=null,w(!0))},[]),B=u.useCallback((I,X)=>{const J=E.current;if(!J.has(I))return;if(J.delete(I),Db(X,I),J.size===0){O.current=null,L.current=null,w(!1);return}if(J.size>=2){Z();return}const[ne,ee]=J.entries().next().value;H(ne,ee)},[H,Z]),T=u.useCallback(()=>{const I=C.current;if(!I)return;const X=I.getBoundingClientRect(),J=Y=>{if(!Y||!Y.naturalWidth||!Y.naturalHeight)return;const V=X.width/Y.naturalWidth,pe=X.height/Y.naturalHeight,ae=Math.min(1,Math.min(V,pe)),$e=Y.naturalWidth*ae,Pe=Y.naturalHeight*ae;return{base:ae,tx:(X.width-$e)/2,ty:(X.height-Pe)/2}},ne=J(y.current);ne&&(p(ne.base),g.current=ne.tx,b.current=ne.ty,r(ne.tx),i(ne.ty));const ee=J(m.current);ee&&(S(ee.base),N.current=ee.tx,j.current=ee.ty,l(ee.tx),d(ee.ty))},[]);u.useEffect(()=>{const I=C.current;if(!I)return;const X=new ResizeObserver(()=>{try{requestAnimationFrame(()=>T())}catch{T()}});return X.observe(I),()=>X.disconnect()},[T]);const R=u.useCallback(()=>{z(1),T()},[T,z]);u.useEffect(()=>{v.current=e,g.current=n,b.current=s,N.current=o,j.current=c},[e,n,s,o,c]),u.useEffect(()=>()=>{E.current.clear(),O.current=null,L.current=null},[]);const M=u.useCallback(I=>{I.preventDefault();const X=I.deltaY>0?-1:1,J=C.current;if(!J)return;const ne=J.getBoundingClientRect(),ee=I.clientX-ne.left,Y=I.clientY-ne.top,V=v.current,pe=tc(V*Math.pow(_b,X));if(pe===V)return;const ae=pe/V;z(pe),A({txA:ee-ae*(ee-g.current),tyA:Y-ae*(Y-b.current),txB:ee-ae*(ee-N.current),tyB:Y-ae*(Y-j.current)})},[A,z]),_=u.useCallback(I=>{if((I.pointerType??"mouse")==="mouse"&&I.button!==0)return;const J=I.currentTarget;if(I.preventDefault(),E.current.set(I.pointerId,{x:I.clientX,y:I.clientY}),Ab(J,I.pointerId),E.current.size>=2){Z();return}H(I.pointerId,{x:I.clientX,y:I.clientY})},[H,Z]),F=u.useCallback(I=>{const X=E.current;if(!X.has(I.pointerId))return;X.set(I.pointerId,{x:I.clientX,y:I.clientY});const J=L.current;if(J){const V=X.get(J.pointerIds[0]),pe=X.get(J.pointerIds[1]);if(V&&pe){const ae=Gp(V,pe);if(ae>2){const $e=Jp(V,pe),Pe=tc(J.startScale*(ae/J.startDistance)),Fe=Pe/J.startScale;z(Pe),A({txA:$e.x-Fe*(J.startCenter.x-J.startTxA),tyA:$e.y-Fe*(J.startCenter.y-J.startTyA),txB:$e.x-Fe*(J.startCenter.x-J.startTxB),tyB:$e.y-Fe*(J.startCenter.y-J.startTyB)})}}return}const ne=O.current;if(!ne||ne.pointerId!==I.pointerId)return;const ee=I.clientX-ne.startX,Y=I.clientY-ne.startY;A({txA:ne.startTxA+ee,tyA:ne.startTyA+Y,txB:ne.startTxB+ee,tyB:ne.startTyB+Y})},[A,z]),W=u.useCallback(I=>{B(I.pointerId,I.currentTarget)},[B]),U=u.useCallback(I=>{B(I.pointerId,I.currentTarget)},[B]);return{scale:e,baseA:f,baseB:h,txA:n,tyA:s,txB:o,tyB:c,dragging:x,containerRef:C,imgARef:y,imgBRef:m,fitAndCenter:T,resetView:R,handleWheel:M,handlePointerDown:_,handlePointerMove:F,handlePointerUp:W,handlePointerCancel:U}}function $b({aItem:e,bItem:t,index:n,total:r,canPrev:s,canNext:i,onNavigate:o,onClose:l}){const c=u.useRef(null),[d,f]=u.useState(50),[p,h]=u.useState(!1),[S,x]=u.useState(!1),{scale:w,baseA:C,baseB:y,txA:m,tyA:v,txB:g,tyB:b,dragging:N,containerRef:j,imgARef:E,imgBRef:O,fitAndCenter:L,resetView:A,handleWheel:z,handlePointerDown:H,handlePointerMove:Z,handlePointerUp:B,handlePointerCancel:T}=zb(),R=(e==null?void 0:e.path)??null,M=(t==null?void 0:t.path)??null,_=(e==null?void 0:e.name)??R??"Select an image",F=(t==null?void 0:t.name)??M??"Select another image";u.useEffect(()=>{requestAnimationFrame(()=>{var Y;return(Y=c.current)==null?void 0:Y.focus()})},[R,M]),u.useEffect(()=>{A(),h(!1),x(!1)},[R,M,A]),u.useEffect(()=>{const Y=V=>{if(!$f(V.target)){if(V.key==="Escape"){V.preventDefault(),l();return}if((V.key==="ArrowRight"||V.key==="d")&&i){V.preventDefault(),o(1);return}(V.key==="ArrowLeft"||V.key==="a")&&s&&(V.preventDefault(),o(-1))}};return window.addEventListener("keydown",Y),()=>window.removeEventListener("keydown",Y)},[l,o,s,i]);const W=Jr(R?()=>xe.getFile(R):null,[R]),U=Jr(M?()=>xe.getFile(M):null,[M]),I=Jr(R?()=>xe.getThumb(R):null,[R]),X=Jr(M?()=>xe.getThumb(M):null,[M]),J=u.useCallback(Y=>Math.min(95,Math.max(5,Y)),[]),ne=u.useCallback(Y=>{const V=Y.target;V!=null&&V.closest(".compare-label")||V!=null&&V.closest(".compare-divider-hit")||H(Y)},[H]),ee=u.useCallback(Y=>{const V=j.current;if(!V)return;Y.preventDefault(),Y.stopPropagation();const pe=V.getBoundingClientRect(),ae=Y.currentTarget;ae.setPointerCapture(Y.pointerId);const $e=Fe=>{const dt=(Fe.clientX-pe.left)/pe.width*100;f(J(dt))},Pe=Fe=>{try{ae.releasePointerCapture(Fe.pointerId)}catch{}window.removeEventListener("pointermove",$e),window.removeEventListener("pointerup",Pe),window.removeEventListener("pointercancel",Pe)};window.addEventListener("pointermove",$e),window.addEventListener("pointerup",Pe),window.addEventListener("pointercancel",Pe)},[J]);return a.jsxs("div",{ref:c,role:"dialog","aria-modal":!0,"aria-label":"Compare images",tabIndex:-1,className:"toolbar-offset absolute inset-0 left-[var(--left)] right-[var(--right)] bg-panel z-viewer flex flex-col overflow-hidden focus:outline-none",onKeyDown:Y=>{Y.key==="Tab"&&Y.preventDefault()},children:[a.jsxs("div",{className:"compare-header flex items-center gap-3 px-3 py-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Compare"}),a.jsx("div",{className:"text-xs text-muted",children:r>=2?`${n+1}-${Math.min(n+2,r)} of ${r}`:"Select 2 images"}),a.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(-1),disabled:!s,title:"Previous (Left Arrow or A)",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Prev"]}),a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(1),disabled:!i,title:"Next (Right Arrow or D)",children:["Next",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"btn btn-sm",onClick:l,title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]})]})]}),a.jsx("div",{className:"flex-1 min-h-0 p-3 bg-panel",children:a.jsx("div",{ref:j,className:`compare-stage ${N?"is-dragging":""}`,onWheel:z,onPointerDown:ne,onPointerMove:Z,onPointerUp:B,onPointerCancel:T,children:!e||!t?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-sm text-muted",children:"Select 2 images to compare."}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"compare-label left-3",children:[a.jsx("span",{className:"compare-label-tag",children:"A"}),a.jsx("span",{className:"truncate",title:e.path,children:_})]}),a.jsxs("div",{className:"compare-label right-3",children:[a.jsx("span",{className:"compare-label-tag",children:"B"}),a.jsx("span",{className:"truncate",title:t.path,children:F})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 ${100-d}% 0 0)`},children:[I&&a.jsx("img",{src:I,alt:"thumb A",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:Y=>Y.preventDefault(),style:{transform:`translate(${m}px, ${v}px) scale(${C})`,transformOrigin:"0 0",opacity:p?0:.5}}),W&&a.jsx("img",{ref:E,src:W,alt:"compare A",className:"compare-image",draggable:!1,onDragStart:Y=>Y.preventDefault(),onLoad:()=>{L();try{requestAnimationFrame(()=>h(!0))}catch{h(!0)}},style:{transform:`translate(${m}px, ${v}px) scale(${C*w})`,transformOrigin:"0 0",opacity:p?.99:0}})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 0 0 ${d}%)`},children:[X&&a.jsx("img",{src:X,alt:"thumb B",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:Y=>Y.preventDefault(),style:{transform:`translate(${g}px, ${b}px) scale(${y})`,transformOrigin:"0 0",opacity:S?0:.5}}),U&&a.jsx("img",{ref:O,src:U,alt:"compare B",className:"compare-image",draggable:!1,onDragStart:Y=>Y.preventDefault(),onLoad:()=>{L();try{requestAnimationFrame(()=>x(!0))}catch{x(!0)}},style:{transform:`translate(${g}px, ${b}px) scale(${y*w})`,transformOrigin:"0 0",opacity:S?.99:0}})]}),a.jsxs("div",{className:"compare-divider-hit",style:{left:`${d}%`},onPointerDown:ee,children:[a.jsx("div",{className:"compare-divider-line"}),a.jsx("div",{className:"compare-divider-handle"})]})]})})})]})}function tu(){const[e,t]=u.useState(RS());return u.useEffect(()=>MS(t),[]),e}const To=e=>["item",e],Bb={v:1,tags:[],notes:"",version:1,updated_at:"",updated_by:"web"},mn=new Map,ql=new Map,kd=new Map,Bf=new Map;let Zp=0;const _n=new Map,Ji=new Map,Ub=12e3,Ed=new Set,Nd=new Set;let Uf={state:"idle"},Lo=null,jd=0;function Ml(e){Uf=e;for(const t of Ed)t(e)}function Xn(){const e=_n.size>0,t=mn.size+ql.size+jd;if(e){Ml({state:"error",message:"Conflict detected"});return}if(Lo){Ml({state:"error",message:Lo});return}if(t>0){Ml({state:"syncing"});return}Ml({state:"idle"})}function Vf(){let e=null;for(const t of kd.values())e=e==null?t:Math.min(e,t);for(const t of Bf.values())e=e==null?t:Math.min(e,t);return e}function Ra(){const e=Vf();for(const t of Nd)t(e)}function Pa(e){Lo=e,Xn()}function Ay(){Lo&&(Lo=null,Xn())}function em(e){jd=Math.max(0,jd+e),Xn()}function Vb(){Zp+=1;const e=Zp;return Bf.set(e,Date.now()),Ra(),e}function Wb(e){e!=null&&Bf.delete(e)&&Ra()}function nu(e){const t=Ji.get(e);if(!t||!t.size)return;const n=_n.get(e)??null;for(const r of t)r(n)}function tm(e){return _n.get(e)??null}function ru(e){_n.delete(e)&&(nu(e),Xn())}function Hb(e,t){_n.set(e,t),nu(e),Xn()}function Qb(e,t){const n=Ji.get(e)??new Set;return n.add(t),Ji.set(e,n),t(_n.get(e)??null),()=>{const r=Ji.get(e);r&&(r.delete(t),r.size||Ji.delete(e))}}function Kb(e){const[t,n]=u.useState(()=>e?tm(e):null);return u.useEffect(()=>{if(!e){n(null);return}return n(tm(e)),Qb(e,n)},[e]),t}function Yb(e){return Ed.add(e),e(Uf),()=>{Ed.delete(e)}}function Xb(){const[e,t]=u.useState(Uf);return u.useEffect(()=>Yb(t),[]),e}function qb(e){return Nd.add(e),e(Vf()),()=>{Nd.delete(e)}}function Gb(){const[e,t]=u.useState(()=>Vf()),[n,r]=u.useState(()=>e==null?null:Date.now()-e);return u.useEffect(()=>qb(t),[]),u.useEffect(()=>{if(e==null){r(null);return}r(Date.now()-e);const s=window.setInterval(()=>{r(Date.now()-e)},1e3);return()=>window.clearInterval(s)},[e]),n}function Md(e){const t={};return Object.prototype.hasOwnProperty.call(e,"star")&&(t.set_star=e.star??null),Object.prototype.hasOwnProperty.call(e,"notes")&&(t.set_notes=e.notes??""),Object.prototype.hasOwnProperty.call(e,"tags")&&(t.set_tags=Array.isArray(e.tags)?e.tags:[]),t}function Rd(e){var t,n;return e.set_star!==void 0||e.set_notes!==void 0||e.set_tags!==void 0||(((t=e.add_tags)==null?void 0:t.length)??0)>0||(((n=e.remove_tags)==null?void 0:n.length)??0)>0}function Vi(e){const t=[],n=new Set;for(const r of e??[]){if(typeof r!="string")continue;const s=r.trim();!s||n.has(s)||(n.add(s),t.push(s))}return t}function Jb(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function Zb(e,t){if(e.set_star!==void 0&&(t.star??null)!==e.set_star||e.set_notes!==void 0&&(t.notes??"")!==(e.set_notes??""))return!1;if(e.set_tags!==void 0){const r=Vi(e.set_tags),s=Vi(t.tags);return Jb(r,s)}const n=Vi(t.tags);for(const r of Vi(e.add_tags))if(!n.includes(r))return!1;for(const r of Vi(e.remove_tags))if(n.includes(r))return!1;return!0}function Dy(e,t,n){if(n instanceof Gt&&n.status===409){const r=n.body;if(r!=null&&r.current)return Hb(e,{path:e,current:r.current,pending:t,receivedAt:new Date().toISOString()}),!0}return!1}function eC(e,t){const n=_n.get(e);if(n){if(Zb(n.pending,t)){ru(e);return}_n.set(e,{...n,current:t}),nu(e),Xn()}}function tC(e){const t=tu();return Ja({queryKey:To(e),queryFn:()=>xe.getSidecar(e),enabled:!!e,staleTime:3e4,gcTime:5*6e4,retry:2,refetchInterval:t?Ub:!1,refetchIntervalInBackground:t})}function nC(e){const t=nr();return Q1({mutationFn:async({patch:n,baseVersion:r,idempotencyKey:s})=>{const i=Md(n);if(!Rd(i))return t.getQueryData(To(e))??Bb;const o={...i,base_version:r};try{return await xe.patchSidecar(e,o,{idempotencyKey:s??eu("patch"),ifMatch:r})}catch(l){throw Dy(e,i,l),l}},retry:(n,r)=>r instanceof Gt&&r.status===409?!1:n<2,retryDelay:n=>Math.min(1e3*Math.pow(2,n),4e3),onMutate:()=>(Ay(),em(1),{inflightId:Vb()}),onSuccess:n=>{ru(e),t.setQueryData(To(e),n)},onError:n=>{n instanceof Gt&&n.status===409||(n instanceof Gt?Pa(n.message):Pa("Failed to save"))},onSettled:(n,r,s,i)=>{em(-1),Wb(i==null?void 0:i.inflightId)}})}const rC=6;async function zy(e,t){if(!e.length)return;let n=0;const r=[],s=async()=>{for(;n<e.length;){const o=n++,l=e[o];try{await $y(l,t)}catch(c){r.push({path:l,error:c}),console.error(`[bulkUpdateSidecars] Failed for ${l}:`,c)}}},i=Array.from({length:Math.min(rC,e.length)},()=>s());if(await Promise.all(i),r.length===e.length)throw new Error(`All ${e.length} sidecar updates failed`)}async function $y(e,t){const n=mn.get(e)||{};mn.set(e,{...n,...t}),Ay(),Xn();const r=ql.get(e);if(r)return r;kd.set(e,Date.now()),Ra();const s=(async()=>{try{for(;mn.has(e);){const i=mn.get(e);if(!i)break;const o=Md(i);if(!Rd(o)){mn.get(e)===i&&mn.delete(e);continue}let l=1;try{l=(await xe.getSidecar(e)).version??1}catch{l=1}const c={...o,base_version:l};try{await xe.patchSidecar(e,c,{idempotencyKey:eu("patch"),ifMatch:l}),ru(e),mn.get(e)===i&&mn.delete(e)}catch(d){if(Dy(e,o,d)){const p=mn.get(e);if(p&&p!==i){const h=Md(p);if(Rd(h)){const S=_n.get(e);S&&(_n.set(e,{...S,pending:h}),nu(e))}}mn.delete(e)}else d instanceof Gt?Pa(d.message):Pa("Failed to save");throw d}}}finally{ql.delete(e),kd.delete(e),Ra(),Xn()}})();return ql.set(e,s),Xn(),s}const Rl=2;function Wi(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Vo(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function By(e){return e==="pil_info"||e.startsWith("pil_info.")||e.startsWith("pil_info[")}function Pd(e,t){if(typeof t=="number")return e?`${e}[${t}]`:`[${t}]`;const n=/^[A-Za-z0-9_$-]+$/.test(t);return e?n?`${e}.${t}`:`${e}["${t}"]`:n?t:`["${t}"]`}function Ta(e){return e==null?String(e):typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):Array.isArray(e)?`[${e.map(Ta).join(",")}]`:typeof e=="object"?`{${Object.entries(e).sort(([n],[r])=>n.localeCompare(r)).map(([n,r])=>`${n}:${Ta(r)}`).join(",")}}`:String(e)}function Pl(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return String(e);try{return JSON.stringify(e,null,1)}catch{return String(e)}}function La(e,t,n,r,s){if(s.skipPilInfo&&By(t))return;const i=t||"(root)";if(r>=s.maxDepth){n.set(i,e);return}if(Array.isArray(e)){if(!e.length){n.set(i,[]);return}if(e.length>s.maxArray){n.set(i,e);return}e.forEach((o,l)=>La(o,Pd(t,l),n,r+1,s));return}if(Vo(e)){const o=Object.keys(e).sort((l,c)=>l.localeCompare(c));if(!o.length){n.set(t||"(root)",{});return}for(const l of o)s.skipPilInfo&&!t&&l==="pil_info"||La(e[l],Pd(t,l),n,r+1,s);return}n.set(i,e)}function Gl(e){if(Array.isArray(e))return e.map(Gl);if(e&&typeof e=="object")return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,Gl(n)]));if(typeof e=="string"){const t=e.trim();if(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]")||t.startsWith('"')&&t.endsWith('"'))try{const r=JSON.parse(t);return Gl(r)}catch{return e}}return e}function nc(e){return e?Gl(e):null}function rc(e,t){if(!e)return null;if(!t&&Vo(e)&&"pil_info"in e){const n={};for(const[r,s]of Object.entries(e))n[r]=r==="pil_info"?"Hidden (toggle Show PIL info to expand)":s;return n}return e}function ao(e,t,n){if(e===null)return'<span style="color:var(--json-literal)">null</span>';if(e===void 0)return'<span style="color:var(--json-fallback)">undefined</span>';if(typeof e=="string")return`<span style="color:var(--json-string)">${Wi(JSON.stringify(e))}</span>`;if(typeof e=="number")return`<span style="color:var(--json-number)">${Wi(String(e))}</span>`;if(typeof e=="boolean")return`<span style="color:var(--json-literal)">${e?"true":"false"}</span>`;if(Array.isArray(e)){if(e.length===0)return"[]";const r=" ".repeat(n),s=" ".repeat(n+Rl);let i=`[
`;return e.forEach((o,l)=>{const c=ao(o,[...t,l],n+Rl);i+=`${s}${c}${l<e.length-1?",":""}
`}),i+=`${r}]`,i}if(Vo(e)){const r=Object.keys(e);if(!r.length)return"{}";const s=" ".repeat(n),i=" ".repeat(n+Rl);let o=`{
`;return r.forEach((l,c)=>{const d=Wi(JSON.stringify([...t,l])),f=Wi(JSON.stringify(l)),p=`<span class="ui-json-key" data-json-path='${d}' style="color:var(--json-key)">${f}</span>`,h=ao(e[l],[...t,l],n+Rl);o+=`${i}${p}: ${h}${c<r.length-1?",":""}
`}),o+=`${s}}`,o}return`<span style="color:var(--json-fallback)">${Wi(String(e))}</span>`}function sc(e){let t="";for(const n of e)t=Pd(t,n);return t||"(root)"}function ic(e,t){let n=e;for(const r of t){if(typeof r=="number"){if(!Array.isArray(n))return;n=n[r];continue}if(!Vo(n))return;n=n[r]}return n}function nm(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e;try{return JSON.stringify(e,null,1)}catch{return String(e)}}function oc(e){return!!e&&Vo(e)&&"pil_info"in e}function sC(e,t,n){if(e==null||t==null)return null;const r=new Map,s=new Map,i={maxDepth:n.maxDepth,maxArray:n.maxArray,skipPilInfo:!n.includePilInfo};La(e,"",r,0,i),La(t,"",s,0,i);const o=new Set([...r.keys(),...s.keys()]),l=[];let c=0,d=0,f=0;const p=Array.from(o).sort((w,C)=>w.localeCompare(C)),h=!n.includePilInfo;for(const w of p){if(h&&By(w))continue;const C=r.has(w),y=s.has(w);if(!C&&y){d+=1,l.push({key:w,kind:"onlyB",aText:"",bText:Pl(s.get(w))});continue}if(C&&!y){c+=1,l.push({key:w,kind:"onlyA",aText:Pl(r.get(w)),bText:""});continue}const m=r.get(w),v=s.get(w),g=Ta(m),b=Ta(v);g!==b&&(f+=1,l.push({key:w,kind:"different",aText:Pl(m),bText:Pl(v)}))}const S=Math.max(0,l.length-n.limit);return{entries:S?l.slice(0,n.limit):l,onlyA:c,onlyB:d,different:f,truncatedCount:S}}function Td(e){const t=["B","KB","MB","GB","TB"];let n=0,r=e;for(;r>=1024&&n<t.length-1;)r/=1024,n+=1;return`${r.toFixed(1)} ${t[n]}`}function lc(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function iC(e,t=28){if(e.length<=t)return e;const n=Math.max(4,Math.floor((t-1)/2));return`${e.slice(0,n)}${e.slice(-n)}`}const oC=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"});function lC(e){const t=e.trim();return!t||/[zZ]|[+-]\d{2}:?\d{2}$/.test(t)?t:`${t.includes("T")?t:t.replace(" ","T")}Z`}function Uy(e){if(!e)return null;const t=Date.parse(lC(e));return Number.isFinite(t)?t:null}function aC(e,t=Date.now()){const n=Math.max(0,t-e),r=Math.max(1,Math.floor(n/1e3));if(r<60)return`${r} second${r===1?"":"s"} ago`;const s=Math.floor(r/60);if(s<60)return`${s} minute${s===1?"":"s"} ago`;const i=Math.floor(s/60);return`${i} hour${i===1?"":"s"} ago`}function uC(e){return oC.format(new Date(e))}function Wo({title:e,open:t,onToggle:n,actions:r,children:s,contentClassName:i}){const[o,l]=u.useState(t),[c,d]=u.useState(t?"open":"closed");return u.useEffect(()=>{if(t){l(!0);const p=window.requestAnimationFrame(()=>d("open"));return()=>window.cancelAnimationFrame(p)}d("closing");const f=window.setTimeout(()=>{l(!1),d("closed")},140);return()=>window.clearTimeout(f)},[t]),a.jsxs("div",{className:"border-b border-border/60",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[a.jsxs("button",{type:"button",onClick:n,"aria-expanded":t,className:"flex items-center gap-2 inspector-section-title hover:text-text transition-colors",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`transition-transform ${t?"rotate-90":""}`,"aria-hidden":"true",children:a.jsx("path",{d:"m9 18 6-6-6-6"})}),a.jsx("span",{children:e})]}),r]}),o&&a.jsx("div",{className:"inspector-section-body","data-state":c,"aria-hidden":!t,children:a.jsx("div",{className:i??"px-3 pb-3",children:s})})]})}function cC(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function dC({open:e,onToggle:t,multi:n,star:r,onSelectStar:s,hasStarConflict:i,onApplyConflict:o,onKeepTheirs:l,currentItem:c,sourceValue:d,sortSpec:f,copiedField:p,onCopyInfo:h,valueHeights:S,onRememberHeight:x,metricsExpanded:w,onToggleMetricsExpanded:C,metricsPreviewLimit:y}){return a.jsxs(Wo,{title:"Basics",open:e,onToggle:t,children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs mb-1",role:"radiogroup","aria-label":"Star rating",children:[a.jsx("span",{className:"ui-kv-label w-16 shrink-0",children:n?"Rating (all)":"Rating"}),a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(m=>{const v=(r??0)>=m;return a.jsx("button",{className:`w-6 h-6 flex items-center justify-center rounded-lg border border-border/60 bg-transparent text-[13px] ${v?"text-star-active":"text-star-inactive"} hover:border-border hover:text-star-hover transition-colors`,onClick:()=>{s(r===m&&!n?null:m)},title:`${m} star${m>1?"s":""} (key ${m})`,"aria-label":`${m} star${m>1?"s":""}`,"aria-pressed":r===m,children:v?"":""},m)})})]}),i&&a.jsxs("div",{className:"ui-banner ui-banner-danger mt-2 text-[11px] flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Rating conflict."}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:o,children:"Apply again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:l,children:"Keep theirs"})]})]}),!n&&c&&a.jsxs("div",{className:"text-[12px] space-y-1.5 leading-relaxed",children:[a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("dimensions",`${c.w}${c.h}`),children:"Dimensions"}),a.jsx("span",{className:"ui-kv-value inline-block text-right min-w-[80px]",ref:m=>x("dimensions",m),style:S.dimensions?{minHeight:S.dimensions}:void 0,children:p==="dimensions"?"Copied":`${c.w}${c.h}`})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("size",Td(c.size)),children:"Size"}),a.jsx("span",{className:"ui-kv-value inline-block text-right min-w-[80px]",ref:m=>x("size",m),style:S.size?{minHeight:S.size}:void 0,children:p==="size"?"Copied":Td(c.size)})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("type",c.type),children:"Type"}),a.jsx("span",{className:"ui-kv-value break-all text-right inline-block min-w-[80px]",ref:m=>x("type",m),style:S.type?{minHeight:S.type}:void 0,children:p==="type"?"Copied":c.type})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>d&&h("source",d),children:"Source"}),a.jsx("span",{className:"ui-kv-value inspector-value-clamp break-words text-right max-w-[70%] inline-block min-w-[80px]",ref:m=>x("source",m),style:S.source?{minHeight:S.source}:void 0,title:d,children:p==="source"?"Copied":d})]}),(()=>{const m=c.metrics||null;if(!m)return null;const v=Object.entries(m).filter(([,A])=>A!=null);if(!v.length)return null;const g=(f==null?void 0:f.kind)==="metric"?f.key:null,b=[...v].sort(([A],[z])=>A.localeCompare(z));let N=b;if(g){const A=b.findIndex(([z])=>z===g);A>0&&(N=[b[A],...b.slice(0,A),...b.slice(A+1)])}const j=N.length>y,O=w||!j?N:N.slice(0,y),L=N.length-y;return a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"ui-subsection-title mb-1",children:"Metrics"}),a.jsxs("div",{className:"space-y-1",children:[O.map(([A,z])=>{const H=g===A;return a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:`w-24 shrink-0 ${H?"text-accent font-medium":"ui-kv-label"}`,children:A}),a.jsx("span",{className:`ui-kv-value text-right ${H?"text-accent font-medium":""}`,children:cC(z)})]},A)}),j&&a.jsx("button",{type:"button",className:"text-[11px] text-muted underline underline-offset-2 hover:text-text",onClick:C,"aria-expanded":w,children:w?"Show less":`+${L} more`})]})]})})()]})]})}const Vy=fo.memo(function({compareDiff:t}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-muted",children:[a.jsxs("span",{children:[t.different," ","different"," ",""," ",t.onlyA," ","only A"," ",""," ",t.onlyB," ","only B"]}),a.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:"Deep paths"})]}),t.entries.length===0?a.jsx("div",{className:"text-muted",children:"No differences found."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2 text-[10px] uppercase tracking-wide text-muted",children:[a.jsx("div",{children:"Path"}),a.jsx("div",{children:"A"}),a.jsx("div",{children:"B"})]}),t.entries.map(n=>a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2",children:[a.jsx("div",{className:"text-[11px] text-muted font-mono break-all",children:n.key}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.aText}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.bText})]},n.key)),t.truncatedCount>0&&a.jsxs("div",{className:"text-muted text-[11px]",children:["+",t.truncatedCount," ","more differences not shown."]})]})]})});Vy.displayName="CompareDiffTable";function fC({open:e,onToggle:t,compareMetaState:n,compareMetaError:r,compareLabelA:s,compareLabelB:i,compareIncludePilInfo:o,onToggleCompareIncludePilInfo:l,onReload:c,compareDiff:d,compareHasPilInfoA:f,compareHasPilInfoB:p,compareShowPilInfoA:h,compareShowPilInfoB:S,onToggleCompareShowPilInfoA:x,onToggleCompareShowPilInfoB:w,compareMetaCopied:C,onCopyCompareMetadata:y,compareValueCopiedPathA:m,compareValueCopiedPathB:v,compareDisplayHtmlA:g,compareDisplayHtmlB:b,compareMetaContent:N,onCompareMetaClickA:j,onCompareMetaClickB:E,compareExportLabelsText:O,onCompareExportLabelsTextChange:L,compareExportEmbedMetadata:A,onCompareExportEmbedMetadataChange:z,compareExportBusy:H,compareReady:Z,compareExportMode:B,onComparisonExport:T,compareExportError:R}){return a.jsx(Wo,{title:"Compare Metadata",open:e,onToggle:t,actions:a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:c,disabled:n==="loading",children:n==="loading"?"Loading":"Reload"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:l,disabled:n!=="loaded",children:o?"Hide PIL info":"Include PIL info"})]}),children:a.jsxs("div",{className:"space-y-2 text-[11px]",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] text-muted",children:[a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"A"}),a.jsx("div",{className:"text-text break-all",title:s,children:s})]}),a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"B"}),a.jsx("div",{className:"text-text break-all",title:i,children:i})]})]}),n==="loading"&&a.jsx("div",{className:"text-muted",children:"Loading metadata"}),n==="error"&&r&&a.jsx("div",{className:"text-danger break-words",children:r}),n==="loaded"&&d&&a.jsx(Vy,{compareDiff:d}),a.jsxs("div",{className:"grid gap-3 pt-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Metadata A"}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[f&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:x,disabled:n!=="loaded",children:h?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:()=>y("A"),disabled:n!=="loaded",children:C==="A"?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[m&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",m]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",onClick:j,children:n==="loaded"&&g?a.jsx("code",{className:"block whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:g}}):N})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Metadata B"}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[p&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:w,disabled:n!=="loaded",children:S?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:()=>y("B"),disabled:n!=="loaded",children:C==="B"?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[v&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",v]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",onClick:E,children:n==="loaded"&&b?a.jsx("code",{className:"block whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:b}}):N})]})]})]}),a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Export Comparison"}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full h-20 scrollbar-thin",placeholder:`Label for A
Label for B`,value:O,onChange:M=>L(M.target.value),disabled:H,"aria-label":"Comparison export labels"}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-[11px] text-muted",children:[a.jsx("input",{type:"checkbox",checked:A,onChange:M=>z(M.target.checked),disabled:H}),a.jsx("span",{children:"Embed metadata"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>T(!1),disabled:!Z||H,children:B==="normal"?"Exporting":"Export comparison"}),a.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",onClick:()=>T(!0),disabled:!Z||H,children:B==="reverse"?"Exporting":"Export (reverse order)"})]}),R&&a.jsx("div",{className:"text-danger break-words",children:R})]})]})})}const Wy=fo.memo(fC);Wy.displayName="CompareMetadataSection";function hC({open:e,onToggle:t,metadataLoading:n,metadataActionLabel:r,onMetadataAction:s,metadataActionDisabled:i,hasPilInfo:o,showPilInfo:l,onToggleShowPilInfo:c,metaValueCopiedPath:d,metaHeightClass:f,metaLoaded:p,metaDisplayHtml:h,metaContent:S,metaError:x,onMetaClick:w}){const C=a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[p&&o&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:c,disabled:!p,children:l?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[78px]",onClick:s,disabled:i||n,children:r})]});return a.jsxs(Wo,{title:"Metadata",open:e,onToggle:t,actions:C,children:[a.jsxs("div",{className:"relative",children:[d&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",d]}),a.jsx("pre",{className:`ui-code-block ui-code-block-resizable ${f} overflow-auto whitespace-pre-wrap`,onClick:w,children:p?a.jsx("code",{className:"block whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:h}}):S})]}),x&&a.jsx("div",{className:"text-[11px] text-danger mt-1 break-words",children:x})]})}const Hy=fo.memo(hC);Hy.displayName="MetadataSection";function pC({open:e,onToggle:t,multi:n,showConflictBanner:r,onApplyConflict:s,onKeepTheirs:i,notes:o,onNotesChange:l,onNotesBlur:c,tags:d,onTagsChange:f,onTagsBlur:p}){return a.jsxs(Wo,{title:"Notes & Tags",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",children:[r&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Conflicting edits detected."}),a.jsx("div",{className:"text-[11px] text-muted mt-0.5",children:"Your changes were not saved because this item was updated elsewhere."}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:s,children:"Apply my changes again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:i,children:"Keep theirs"})]})]}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full scrollbar-thin",placeholder:"Add notes",value:o,onChange:h=>l(h.target.value),onBlur:c,"aria-label":n?"Notes for selected items":"Notes"}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:n?"Tags (apply to all, comma-separated)":"Tags (comma-separated)"}),a.jsx("input",{className:"ui-input inspector-input w-full",placeholder:"tag1, tag2",value:d,onChange:h=>f(h.target.value),onBlur:p,"aria-label":n?"Tags for selected items":"Tags"})]})]})}function mC({open:e,onToggle:t,multi:n,selectedCount:r,totalSize:s,filename:i,onFindSimilar:o,canFindSimilar:l,findSimilarDisabledReason:c}){return a.jsxs(Wo,{title:n?"Selection":"Item",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",actions:o&&a.jsx("button",{type:"button",className:"btn btn-sm",onClick:o,disabled:!l,title:c??"Find similar",children:"Find similar"}),children:[n?a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Selected"}),a.jsxs("div",{className:"inspector-field-value",children:[r," files"]})]}),a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Total size"}),a.jsx("div",{className:"inspector-field-value",children:Td(s)})]})]}):a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Filename"}),a.jsx("div",{className:"inspector-field-value break-all",title:i,children:i})]}),c&&a.jsx("div",{className:"text-[11px] text-muted",children:c})]})}function gC(e,t){const n=vC(e)||"view",r=new Set(t.map(i=>i.id));if(!r.has(n))return n;let s=2;for(;r.has(`${n}-${s}`);)s+=1;return`${n}-${s}`}function vC(e){return e.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function ac(e){const t=e.filter(s=>s>0).sort((s,i)=>i-s),n=e.includes(0),r=[...t.map(s=>String(s))];return n&&r.push("None"),r.join(", ")}function yC(e,t){return e&&t?`${e} to ${t}`:e?`from ${e}`:t?`to ${t}`:""}function xC(e){if(e==="/"||e==="")return"Root";const t=e.split("/").filter(Boolean);return t.length?t.length<=2?`/${t.join("/")}`:`.../${t.slice(-2).join("/")}`:"Root"}function wC(e,t,n,r){return!n||r?t:e==="/"||e===""?e||"/":n===e||n.startsWith(`${e}/`)?e:t}function SC(e,t){return`${rm(e)}${rm(t)}`}function rm(e){const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function bC(e){const t=e.toLowerCase();return t.endsWith(".png")?"image/png":t.endsWith(".webp")?"image/webp":"image/jpeg"}function CC(e,t){const n=e.split("/").pop()??e;return{path:e,name:n,type:bC(e),w:0,h:0,size:0,hasThumb:!0,hasMeta:!1,star:t??null}}function uo(e,t){const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}const sm=2,im=120,om=!0;function kC(e){return e.replace(/[\u0000-\u001f\u007f]/g,"").trim()}function EC(e){const n=e.replace(/\r\n?/g,`
`).replace(/\n+$/g,"");return n?n.split(`
`):[]}function NC(e){const{pathA:t,pathB:n,labelsText:r,embedMetadata:s,reverseOrder:i}=e;if(!t||!n)return{ok:!1,message:"Comparison export requires both A and B image paths."};const o=EC(r);if(o.length>sm)return{ok:!1,message:`Enter at most ${sm} label lines (line 1 = A, line 2 = B).`};const l=o.map(p=>kC(p));if(l.some(p=>p.length>im))return{ok:!1,message:`Each label must be at most ${im} characters.`};const d=l.some(p=>p.length>0)?l:void 0,f={v:1,paths:[t,n],embed_metadata:s,reverse_order:i};return d&&(f.labels=d),{ok:!0,payload:f}}function Hi(e){return String(e).padStart(2,"0")}function jC(e,t=new Date){const n=t.getUTCFullYear(),r=Hi(t.getUTCMonth()+1),s=Hi(t.getUTCDate()),i=Hi(t.getUTCHours()),o=Hi(t.getUTCMinutes()),l=Hi(t.getUTCSeconds());return`comparison${e?"_reverse":""}_${n}${r}${s}_${i}${o}${l}.png`}function MC({path:e,sidecarUpdatedAt:t,compareReady:n,comparePathA:r,comparePathB:s}){const[i,o]=u.useState(null),[l,c]=u.useState(null),[d,f]=u.useState("idle"),[p,h]=u.useState(!1),[S,x]=u.useState("idle"),[w,C]=u.useState(null),[y,m]=u.useState(null),[v,g]=u.useState(null),[b,N]=u.useState(!1),[j,E]=u.useState(!1),[O,L]=u.useState(!1),A=u.useRef(0),[z,H]=u.useState(""),[Z,B]=u.useState(om),[T,R]=u.useState(null),[M,_]=u.useState(null),F=T!==null;u.useEffect(()=>{o(null),c(null),f("idle"),h(!1)},[e,t]);const W=u.useCallback(async()=>{if(e){f("loading"),c(null);try{const ee=await xe.getMetadata(e);o(ee.meta),f("loaded")}catch(ee){const Y=ee instanceof Error?ee.message:"Failed to load metadata";o(null),c(Y),f("error")}}},[e]),U=u.useCallback(async(ee,Y)=>{const V=A.current+1;A.current=V,x("loading"),C(null);try{const[pe,ae]=await Promise.all([xe.getMetadata(ee),xe.getMetadata(Y)]);if(A.current!==V)return;m(pe.meta),g(ae.meta),x("loaded")}catch(pe){if(A.current!==V)return;const ae=pe instanceof Error?pe.message:"Failed to load metadata";m(null),g(null),C(ae),x("error")}},[]);u.useEffect(()=>{if(!n||!r||!s){A.current+=1,x("idle"),C(null),m(null),g(null),E(!1),L(!1),H(""),B(om),R(null),_(null);return}N(!1),E(!1),L(!1),R(null),_(null),U(r,s)},[n,r,s,U]);const I=u.useCallback(()=>{!r||!s||U(r,s)},[r,s,U]),X=u.useCallback(ee=>{H(ee),_(null)},[]),J=u.useCallback(ee=>{B(ee)},[]),ne=u.useCallback(async ee=>{if(!r||!s){_("Comparison export requires two selected images.");return}if(F)return;const Y=NC({pathA:r,pathB:s,labelsText:z,embedMetadata:Z,reverseOrder:ee});if(!Y.ok){_(Y.message);return}R(ee?"reverse":"normal"),_(null);try{const V=await xe.exportComparison(Y.payload);uo(V,jC(ee))}catch(V){const pe=V instanceof Error?V.message:"Failed to export comparison.";_(pe)}finally{R(null)}},[F,Z,z,r,s]);return{metaRaw:i,metaError:l,metaState:d,showPilInfo:p,setMetaError:c,compareMetaState:S,compareMetaError:w,compareMetaA:y,compareMetaB:v,compareIncludePilInfo:b,compareShowPilInfoA:j,compareShowPilInfoB:O,compareExportLabelsText:z,compareExportEmbedMetadata:Z,compareExportMode:T,compareExportError:M,compareExportBusy:F,setShowPilInfo:h,setCompareIncludePilInfo:N,setCompareShowPilInfoA:E,setCompareShowPilInfoB:L,fetchMetadata:W,reloadCompareMetadata:I,handleCompareExportLabelsTextChange:X,handleCompareExportEmbedMetadataChange:J,runComparisonExport:ne}}function lm(e){return e.split(",").map(t=>t.trim()).filter(Boolean)}function RC({path:e,selectedPaths:t,multi:n,sidecar:r,conflict:s,star:i,queryClient:o,mutateSidecar:l,onStarChanged:c,onLocalTypingChange:d}){const[f,p]=u.useState(""),[h,S]=u.useState(""),x=u.useRef(!1),w=u.useCallback(E=>{x.current!==E&&(x.current=E,d==null||d(E))},[d]);u.useEffect(()=>{r&&(p((r.tags||[]).join(", ")),S(r.notes||"")),w(!1)},[r==null?void 0:r.updated_at,w,e]),u.useEffect(()=>()=>{w(!1)},[w]);const C=u.useCallback(E=>{if(n&&t.length){zy(t,E);return}e&&l(E,(r==null?void 0:r.version)??1)},[n,l,e,t,r==null?void 0:r.version]),y=u.useMemo(()=>({tags:!!(s!=null&&s.pending.set_tags),notes:(s==null?void 0:s.pending.set_notes)!==void 0,star:(s==null?void 0:s.pending.set_star)!==void 0}),[s]),m=u.useCallback(E=>{S(E),w(!0)},[w]),v=u.useCallback(()=>{C({notes:h}),w(!1)},[C,h,w]),g=u.useCallback(E=>{p(E),w(!0)},[w]),b=u.useCallback(()=>{C({tags:lm(f)}),w(!1)},[C,w,f]),N=u.useCallback(()=>{if(!s||!e)return;const E={};s.pending.set_tags!==void 0&&(E.tags=lm(f)),s.pending.set_notes!==void 0&&(E.notes=h),s.pending.set_star!==void 0&&(E.star=i??null),l(E,s.current.version??1)},[s,l,h,e,i,f]),j=u.useCallback(()=>{if(!s||!e)return;const E=s.current;p((E.tags||[]).join(", ")),S(E.notes||""),o.setQueryData(To(e),E),ru(e),c==null||c([e],E.star??null)},[s,c,e,o]);return{tags:f,notes:h,conflictFields:y,commitSidecar:C,applyConflict:N,keepTheirs:j,handleNotesChange:m,handleNotesBlur:v,handleTagsChange:g,handleTagsBlur:b}}const PC=["overview","compare","basics","metadata","notes"],am="lenslet.inspector.sections",um="lenslet.inspector.metricsExpanded",TC=12,LC=120,IC=8,_C=80,FC={overview:!0,compare:!0,metadata:!0,basics:!0,notes:!0};function OC({path:e,selectedPaths:t=[],items:n=[],compareActive:r=!1,compareA:s=null,compareB:i=null,onResize:o,onStarChanged:l,sortSpec:c,onFindSimilar:d,embeddingsAvailable:f=!1,embeddingsLoading:p=!1,onLocalTypingChange:h}){const S=!!e,{data:x}=tC(e??""),w=nC(e??""),C=nr(),[y,m]=u.useState(FC),v=u.useCallback(G=>{m(re=>({...re,[G]:!re[G]}))},[]),g=u.useCallback(()=>v("overview"),[v]),b=u.useCallback(()=>v("compare"),[v]),N=u.useCallback(()=>v("basics"),[v]),j=u.useCallback(()=>v("metadata"),[v]),E=u.useCallback(()=>v("notes"),[v]),[O,L]=u.useState(!1),A=t.length>1,z=!!d&&f&&!A,H=d?f?A?"Select a single image to search.":null:p?"Loading embeddings...":"No embeddings detected.":null,[Z,B]=u.useState(null),[T,R]=u.useState({}),[M,_]=u.useState(!1),[F,W]=u.useState(null),U=u.useRef(null),[I,X]=u.useState(null),[J,ne]=u.useState(null),[ee,Y]=u.useState(null),V=u.useRef(null),ae=u.useMemo(()=>{var re;return((re=n.find(ke=>ke.path===e))==null?void 0:re.star)??null},[n,e])??(x==null?void 0:x.star)??null,$e=Kb(A?null:e),Pe=(s==null?void 0:s.path)??null,Fe=(i==null?void 0:i.path)??null,dt=r&&!!Pe&&!!Fe,Ue=dt&&r&&y.compare,St=!A&&y.metadata,ue=(s==null?void 0:s.name)??Pe??"A",oe=(i==null?void 0:i.name)??Fe??"B",Se=u.useCallback((G,re)=>{w.mutate({patch:G,baseVersion:re,idempotencyKey:eu("patch")})},[w]),{tags:Oe,notes:Ce,conflictFields:ve,commitSidecar:At,applyConflict:tn,keepTheirs:nt,handleNotesChange:zr,handleNotesBlur:$r,handleTagsChange:rr,handleTagsBlur:Fn}=RC({path:e,selectedPaths:t,multi:A,sidecar:x,conflict:$e,star:ae,queryClient:C,mutateSidecar:Se,onStarChanged:l,onLocalTypingChange:h}),{metaRaw:Rt,metaError:bt,metaState:Dt,showPilInfo:D,setMetaError:q,compareMetaState:K,compareMetaError:me,compareMetaA:ge,compareMetaB:ye,compareIncludePilInfo:ce,compareShowPilInfoA:je,compareShowPilInfoB:_e,compareExportLabelsText:ft,compareExportEmbedMetadata:Te,compareExportMode:De,compareExportError:Qe,compareExportBusy:rt,setShowPilInfo:fn,setCompareIncludePilInfo:Ke,setCompareShowPilInfoA:Br,setCompareShowPilInfoB:Ho,fetchMetadata:Qo,reloadCompareMetadata:bi,handleCompareExportLabelsTextChange:Ko,handleCompareExportEmbedMetadataChange:Yo,runComparisonExport:Xo}=MC({path:e,sidecarUpdatedAt:x==null?void 0:x.updated_at,compareReady:dt,comparePathA:Pe,comparePathB:Fe}),qo=u.useMemo(()=>{const G=new Set(t);return n.filter(re=>G.has(re.path))},[n,t]),su=u.useMemo(()=>qo.reduce((G,re)=>G+(re.size||0),0),[qo]);u.useEffect(()=>{_(!1),W(null),U.current&&(window.clearTimeout(U.current),U.current=null)},[x==null?void 0:x.updated_at,e]),u.useEffect(()=>{X(null),ne(null),Y(null),V.current&&(window.clearTimeout(V.current),V.current=null)},[Pe,Fe,dt]),u.useEffect(()=>()=>{U.current&&(window.clearTimeout(U.current),U.current=null),V.current&&(window.clearTimeout(V.current),V.current=null)},[]),u.useEffect(()=>{if(!e)return;const G=re=>{if($f(re.target))return;const ke=re.key;if(!/^[0-5]$/.test(ke))return;re.preventDefault();const be=ke==="0"?null:Number(ke);if(A&&t.length){At({star:be}),l==null||l(t,be);return}At({star:be}),l==null||l([e],be)};return window.addEventListener("keydown",G),()=>window.removeEventListener("keydown",G)},[e,A,t,At,l]);const Ci=Jr(e?()=>xe.getThumb(e):null,[e]),sr=e?e.split("/").pop()||e:"",Go=u.useMemo(()=>{var re;if(sr.includes("."))return sr.slice(sr.lastIndexOf(".")+1).toUpperCase();const G=n.find(ke=>ke.path===e);return(re=G==null?void 0:G.type)!=null&&re.includes("/")?G.type.split("/")[1].toUpperCase():""},[sr,n,e]),Ur=u.useMemo(()=>n.find(G=>G.path===e),[n,e]),iu=u.useMemo(()=>e?(Ur==null?void 0:Ur.source)??e:"",[Ur,e]),Vr=u.useMemo(()=>{if(!Rt)return"";try{return JSON.stringify(Rt,null,1)}catch{return""}},[Rt]),Jo=u.useMemo(()=>nc(Rt),[Rt]),ws=u.useMemo(()=>nc(ge),[ge]),Ss=u.useMemo(()=>nc(ye),[ye]),hn=u.useMemo(()=>rc(Jo,D),[Jo,D]),ki=u.useMemo(()=>{if(!ge)return"";try{return JSON.stringify(ge,null,1)}catch{return""}},[ge]),Ei=u.useMemo(()=>{if(!ye)return"";try{return JSON.stringify(ye,null,1)}catch{return""}},[ye]),ir=u.useMemo(()=>rc(ws,je),[ws,je]),On=u.useMemo(()=>rc(Ss,_e),[Ss,_e]),Zo=u.useCallback(()=>{var G;Vr&&((G=navigator.clipboard)==null||G.writeText(Vr).then(()=>{_(!0),setTimeout(()=>_(!1),1200)}).catch(re=>{const ke=re instanceof Error?re.message:"Copy failed";q(ke)}))},[Vr]),ou=u.useMemo(()=>!St||!hn?"":ao(hn,[],0),[St,hn]),bs=u.useMemo(()=>!Ue||!ir?"":ao(ir,[],0),[Ue,ir]),el=u.useMemo(()=>!Ue||!On?"":ao(On,[],0),[Ue,On]),tl=u.useCallback(G=>{W(G),U.current&&window.clearTimeout(U.current),U.current=window.setTimeout(()=>{W(null),U.current=null},900)},[]),Wr=u.useCallback((G,re)=>{var be;const ke=nm(re);(be=navigator.clipboard)==null||be.writeText(ke).then(()=>{tl(G)}).catch(()=>{})},[tl]),nl=u.useCallback((G,re)=>{G==="A"?ne(re):Y(re),V.current&&window.clearTimeout(V.current),V.current=window.setTimeout(()=>{ne(null),Y(null),V.current=null},900)},[]),Cs=u.useCallback((G,re,ke)=>{var gt;const be=nm(ke);(gt=navigator.clipboard)==null||gt.writeText(be).then(()=>{nl(G,re)}).catch(()=>{})},[nl]),lu=u.useCallback(G=>{if(!hn)return;const re=G.target;if(!re)return;const ke=re.closest("[data-json-path]");if(!ke)return;const be=ke.getAttribute("data-json-path");if(!be)return;let gt;try{gt=JSON.parse(be)}catch{return}const An=ic(hn,gt);Wr(sc(gt),An)},[hn,Wr]),au=u.useCallback(G=>{if(!ir)return;const re=G.target;if(!re)return;const ke=re.closest("[data-json-path]");if(!ke)return;const be=ke.getAttribute("data-json-path");if(!be)return;let gt;try{gt=JSON.parse(be)}catch{return}const An=ic(ir,gt);Cs("A",sc(gt),An)},[ir,Cs]),uu=u.useCallback(G=>{if(!On)return;const re=G.target;if(!re)return;const ke=re.closest("[data-json-path]");if(!ke)return;const be=ke.getAttribute("data-json-path");if(!be)return;let gt;try{gt=JSON.parse(be)}catch{return}const An=ic(On,gt);Cs("B",sc(gt),An)},[On,Cs]),cu=u.useCallback(G=>{var ke;const re=G==="A"?ki:Ei;re&&((ke=navigator.clipboard)==null||ke.writeText(re).then(()=>{X(G),setTimeout(()=>X(be=>be===G?null:be),1200)}).catch(()=>{}))},[ki,Ei]);let Ni=hn?"":"PNG metadata not loaded yet.";Dt==="loading"?Ni="Loading metadata":Dt==="error"&&bt&&(Ni=bt);let ji="Metadata not loaded yet.";K==="loading"?ji="Loading metadata":K==="error"&&me&&(ji=me);const rl=Dt==="loading",ks=Dt==="loaded"&&!!Vr,du=ks?"h-48":"h-24";let Mi="Load meta";rl?Mi="Loading":ks&&(Mi=M?"Copied":"Copy");const Ri=ks?Zo:Qo,sl=oc(Rt),il=oc(ge),Pi=oc(ye),fu=u.useMemo(()=>Ue?sC(ws,Ss,{includePilInfo:ce,limit:LC,maxDepth:IC,maxArray:_C}):null,[Ue,ws,Ss,ce]);u.useEffect(()=>{try{const G=localStorage.getItem(am);if(!G)return;const re=JSON.parse(G);if(!re||typeof re!="object")return;const ke={};for(const be of PC)typeof re[be]=="boolean"&&(ke[be]=re[be]);Object.keys(ke).length>0&&m(be=>({...be,...ke}))}catch{}},[]),u.useEffect(()=>{try{localStorage.setItem(am,JSON.stringify(y))}catch{}},[y]),u.useEffect(()=>{try{const G=localStorage.getItem(um);G==="1"||G==="true"?L(!0):(G==="0"||G==="false")&&L(!1)}catch{}},[]),u.useEffect(()=>{try{localStorage.setItem(um,O?"1":"0")}catch{}},[O]);const hu=u.useCallback((G,re)=>{var ke;re&&((ke=navigator.clipboard)==null||ke.writeText(re).then(()=>{B(G),setTimeout(()=>B(be=>be===G?null:be),1e3)}).catch(()=>{}))},[]),En=u.useCallback((G,re)=>{if(re&&!T[G]){const ke=re.offsetHeight;ke&&R(be=>be[G]?be:{...be,[G]:ke})}},[T]),Es=u.useCallback(G=>{if(A&&t.length){l==null||l(t,G),zy(t,{star:G});return}e&&(l==null||l([e],G),$y(e,{star:G}))},[A,l,e,t]),Ti=u.useCallback(()=>{L(G=>!G)},[]),pu=u.useCallback(()=>{fn(G=>!G)},[fn]),mu=u.useCallback(()=>{Ke(G=>!G)},[Ke]),gu=u.useCallback(()=>{Br(G=>!G)},[Br]),vu=u.useCallback(()=>{Ho(G=>!G)},[Ho]),yu=u.useCallback(G=>{Xo(G)},[Xo]),xu=!A&&!!$e&&(ve.tags||ve.notes),wu=!A&&!!$e&&ve.star,Li="toolbar-offset sidebar-resize-handle absolute bottom-0 left-0";return S?a.jsxs("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:[!A&&a.jsx("div",{className:"p-3 border-b border-border flex justify-center",children:a.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-border w-[220px] h-[160px] bg-panel select-none",children:[Ci&&a.jsx("img",{src:Ci,alt:"thumb",className:"block w-full h-full object-contain"}),!!Go&&a.jsx("div",{className:"absolute top-1.5 left-1.5 bg-surface border border-border text-text text-xs px-1.5 py-0.5 rounded-md select-none",children:Go})]})}),a.jsx(mC,{open:y.overview,onToggle:g,multi:A,selectedCount:t.length,totalSize:su,filename:sr,onFindSimilar:d,canFindSimilar:z,findSimilarDisabledReason:H}),r&&dt&&a.jsx(Wy,{open:y.compare,onToggle:b,compareMetaState:K,compareMetaError:me,compareLabelA:ue,compareLabelB:oe,compareIncludePilInfo:ce,onToggleCompareIncludePilInfo:mu,onReload:bi,compareDiff:fu,compareHasPilInfoA:il,compareHasPilInfoB:Pi,compareShowPilInfoA:je,compareShowPilInfoB:_e,onToggleCompareShowPilInfoA:gu,onToggleCompareShowPilInfoB:vu,compareMetaCopied:I,onCopyCompareMetadata:cu,compareValueCopiedPathA:J,compareValueCopiedPathB:ee,compareDisplayHtmlA:bs,compareDisplayHtmlB:el,compareMetaContent:ji,onCompareMetaClickA:au,onCompareMetaClickB:uu,compareExportLabelsText:ft,onCompareExportLabelsTextChange:Ko,compareExportEmbedMetadata:Te,onCompareExportEmbedMetadataChange:Yo,compareExportBusy:rt,compareReady:dt,compareExportMode:De,onComparisonExport:yu,compareExportError:Qe}),a.jsx(dC,{open:y.basics,onToggle:N,multi:A,star:ae,onSelectStar:Es,hasStarConflict:wu,onApplyConflict:tn,onKeepTheirs:nt,currentItem:Ur??null,sourceValue:iu,sortSpec:c,copiedField:Z,onCopyInfo:hu,valueHeights:T,onRememberHeight:En,metricsExpanded:O,onToggleMetricsExpanded:Ti,metricsPreviewLimit:TC}),!A&&a.jsx(Hy,{open:y.metadata,onToggle:j,metadataLoading:rl,metadataActionLabel:Mi,onMetadataAction:Ri,metadataActionDisabled:!e,hasPilInfo:sl,showPilInfo:D,onToggleShowPilInfo:pu,metaValueCopiedPath:F,metaHeightClass:du,metaLoaded:ks,metaDisplayHtml:ou,metaContent:Ni,metaError:bt,onMetaClick:lu}),a.jsx(pC,{open:y.notes,onToggle:E,multi:A,showConflictBanner:xu,onApplyConflict:tn,onKeepTheirs:nt,notes:Ce,onNotesChange:zr,onNotesBlur:$r,tags:Oe,onTagsChange:rr,onTagsBlur:Fn}),a.jsx("div",{className:Li,onPointerDown:o})]}):a.jsx("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:a.jsx("div",{className:Li,onPointerDown:o})})}function AC({open:e,embeddings:t,rejected:n=[],selectedPath:r,embeddingsLoading:s=!1,embeddingsError:i,onClose:o,onSearch:l}){const[c,d]=u.useState(""),[f,p]=u.useState("path"),[h,S]=u.useState(""),[x,w]=u.useState(""),[C,y]=u.useState("50"),[m,v]=u.useState(""),[g,b]=u.useState(null),[N,j]=u.useState(!1),E=u.useRef(null),O=u.useRef(null),L=u.useMemo(()=>t.find(T=>T.name===c)??t[0]??null,[t,c]);u.useEffect(()=>{e&&(b(null),t.length>0&&!t.some(T=>T.name===c)&&d(t[0].name),r?(p("path"),S(r)):(p("vector"),S("")))},[e,t,c,r]),u.useEffect(()=>{if(!e)return;const T=f==="vector"?O.current:E.current,R=window.requestAnimationFrame(()=>T==null?void 0:T.focus());return()=>window.cancelAnimationFrame(R)},[e,f]);const A=u.useCallback(async()=>{if(b(null),!t.length){b("No embeddings available for similarity search.");return}if(!L){b("Select an embedding to search.");return}const T=h.trim(),R=x.trim(),M=Number(C);if(!Number.isFinite(M)||M<=0){b("Top K must be a positive number.");return}const _=Math.min(1e3,Math.max(1,Math.floor(M))),F=m.trim()===""?null:Number(m);if(F!=null&&!Number.isFinite(F)){b("Min score must be a valid number.");return}if(f==="path"&&!T){b("Select an image path for the query.");return}if(f==="vector"&&!R){b("Paste a base64 vector for the query.");return}const W={embedding:L.name,query_path:f==="path"?T:null,query_vector_b64:f==="vector"?R:null,top_k:_,min_score:F};j(!0);try{await l(W),o()}catch(U){U instanceof Gt||U instanceof Error?b(U.message):b("Failed to run similarity search.")}finally{j(!1)}},[t.length,L,h,x,C,m,f,l,o]);u.useEffect(()=>{if(!e)return;const T=R=>{if(R.key==="Escape"){R.preventDefault(),o();return}(R.ctrlKey||R.metaKey)&&R.key==="Enter"&&(R.preventDefault(),A())};return window.addEventListener("keydown",T),()=>window.removeEventListener("keydown",T)},[e,o,A]);const z=u.useCallback(()=>{var T;r&&(p("path"),S(r),(T=E.current)==null||T.focus())},[r]);if(!e)return null;const H=t.map(T=>({value:T.name,label:T.name})),Z=n.length>0,B=n.slice(0,3);return a.jsx("div",{className:"fixed inset-0 z-[var(--z-overlay)] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",onClick:T=>{T.target===T.currentTarget&&o()},children:a.jsxs("div",{className:"w-full max-w-2xl rounded-lg border border-border bg-panel shadow-[0_20px_50px_rgba(0,0,0,0.55)]",onClick:T=>T.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Find similar",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Find similar"}),a.jsx("div",{className:"text-xs text-muted",children:"Search with embeddings"})]}),a.jsx("button",{className:"btn btn-sm",onClick:o,"aria-label":"Close",children:"Close"})]}),a.jsxs("div",{className:"px-4 py-4 space-y-4",children:[i&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:i}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Embedding"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Af,{value:(L==null?void 0:L.name)??"",onChange:d,options:H,placeholder:s?"Loading embeddings...":"Select embedding",disabled:!t.length,triggerClassName:"min-w-[180px]"}),L&&a.jsxs("span",{className:"text-xs text-muted",children:[L.dimension," dims, ",L.metric,", ",L.dtype]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Query mode"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:`btn btn-sm ${f==="path"?"btn-active":""}`,onClick:()=>p("path"),"aria-pressed":f==="path",children:"Selected image"}),a.jsx("button",{type:"button",className:`btn btn-sm ${f==="vector"?"btn-active":""}`,onClick:()=>p("vector"),"aria-pressed":f==="vector",children:"Vector input"})]})]}),f==="path"?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Image path"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{ref:E,type:"text",className:"input w-full",value:h,onChange:T=>S(T.target.value),placeholder:r?"Selected image path":"Select an image first"}),a.jsx("button",{type:"button",className:"btn btn-sm",onClick:z,disabled:!r,title:r?"Use selected image":"Select an image first",children:"Use selected"})]})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Vector (base64 float32)"}),a.jsx("textarea",{ref:O,className:"ui-textarea w-full font-mono text-[11px]",rows:5,value:x,onChange:T=>w(T.target.value),placeholder:"Paste base64-encoded float32 vector"}),a.jsx("div",{className:"text-[11px] text-muted",children:"Base64 of little-endian float32. Length must match embedding dimension."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Top K"}),a.jsx("input",{type:"number",min:1,max:1e3,step:1,className:"input ui-number w-full",value:C,onChange:T=>y(T.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Min score"}),a.jsx("input",{type:"number",step:.01,className:"input ui-number w-full",value:m,onChange:T=>v(T.target.value),placeholder:"Optional"})]})]}),Z&&a.jsxs("div",{className:"ui-banner text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Skipped columns"}),a.jsxs("div",{className:"mt-1 space-y-1 text-muted",children:[B.map(T=>a.jsxs("div",{children:[T.name,": ",T.reason]},T.name)),n.length>B.length&&a.jsxs("div",{children:["+",n.length-B.length," more"]})]})]}),g&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:g})]}),a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-border",children:[a.jsx("div",{className:"text-xs text-muted",children:L?`Metric: ${L.metric}`:"Metric: cosine"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:o,disabled:N,children:"Cancel"}),a.jsx("button",{className:"btn btn-sm btn-active",onClick:A,disabled:N||!t.length,children:N?"Searching...":"Find similar"})]})]})]})})}const DC=/^[\/@a-zA-Z0-9._\-\/]{1,512}$/,zC=[".jpg",".jpeg",".png",".webp"];function jt(e){try{const t=decodeURI(e||""),r=(t.startsWith("/")?t:`/${t}`).replace(/\/{2,}/g,"/"),s=r.length>1?r.replace(/\/$/,""):r;return DC.test(s)?s:"/"}catch{return"/"}}function cm(){return(window.location.hash||"").replace(/^#/,"")}function Qy(e){const t=jt(e),n=`#${encodeURI(t)}`;window.location.hash!==n&&(window.location.hash=n)}function Tl(e){const t=jt(e),n=`#${encodeURI(t)}`;if(window.location.hash!==n){const r=`${window.location.pathname}${window.location.search}${n}`;window.history.replaceState(window.history.state,"",r)}}function $C(e){const n=jt(e).toLowerCase();return zC.some(r=>n.endsWith(r))}function Ky(e,t){const n=e.replace(/\/+$/,""),r=t.replace(/^\/+/,""),s=[n,r].filter(Boolean).join("/");return s.startsWith("/")?s:`/${s}`}function dm(e){const n=jt(e).split("/").filter(Boolean);return n.length<=1?"/":"/"+n.slice(0,-1).join("/")}function Wf(e){return jt(e).split("/").filter(Boolean).pop()||""}function BC(e){return e.endsWith("/_trash_")}const UC=new Set([0,1,2,3,4,5]),Hf=new Set(["<","<=",">",">="]),VC=/^\d{4}-\d{2}-\d{2}$/;function WC(e,t){return!t||!t.and.length?e:e.filter(n=>HC(n,t.and))}function HC(e,t){for(const n of t)if(!QC(e,n))return!1;return!0}function QC(e,t){var n,r,s,i,o,l,c;if("stars"in t){const d=t.stars;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsIn"in t){const d=t.starsIn.values;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsNotIn"in t){const d=t.starsNotIn.values;if(!d||!d.length)return!0;const f=e.star??0;return!d.includes(f)}if("nameContains"in t){const d=(n=t.nameContains.value)==null?void 0:n.trim();return d?(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("nameNotContains"in t){const d=(r=t.nameNotContains.value)==null?void 0:r.trim();return d?!(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("commentsContains"in t){const d=(s=t.commentsContains.value)==null?void 0:s.trim();if(!d)return!0;const f=e.comments??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("commentsNotContains"in t){const d=(i=t.commentsNotContains.value)==null?void 0:i.trim();if(!d)return!0;const f=e.comments??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("urlContains"in t){const d=(o=t.urlContains.value)==null?void 0:o.trim();if(!d)return!0;const f=e.source??e.url??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("urlNotContains"in t){const d=(l=t.urlNotContains.value)==null?void 0:l.trim();if(!d)return!0;const f=e.source??e.url??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("dateRange"in t){const{from:d,to:f}=t.dateRange;if(!d&&!f)return!0;if(!e.addedAt)return!1;const p=Date.parse(e.addedAt);if(Number.isNaN(p))return!1;const h=pm(d,!1),S=pm(f,!0);return!(h!=null&&p<h||S!=null&&p>S)}if("widthCompare"in t){const{op:d,value:f}=t.widthCompare;if(!Number.isFinite(f))return!0;const p=e.w;return!Number.isFinite(p)||p<=0?!1:mm(p,d,f)}if("heightCompare"in t){const{op:d,value:f}=t.heightCompare;if(!Number.isFinite(f))return!0;const p=e.h;return!Number.isFinite(p)||p<=0?!1:mm(p,d,f)}if("metricRange"in t){const{key:d,min:f,max:p}=t.metricRange,h=(c=e.metrics)==null?void 0:c[d];return!(h==null||h<f||h>p)}return!0}function Ld(e){if(!e||typeof e!="object")return null;const t=e.and;if(!Array.isArray(t))return null;const n=[];for(const r of t){const s=lk(r);s&&n.push(s)}return{and:n}}function fm(e){var r;const t=e.and.find(s=>"stars"in s),n=e.and.find(s=>"starsIn"in s);return(r=n==null?void 0:n.starsIn)!=null&&r.values?n.starsIn.values:(t==null?void 0:t.stars)??[]}function uc(e,t){return Yy(e,t)}function KC(e){var n;const t=e.and.find(r=>"starsIn"in r);return((n=t==null?void 0:t.starsIn)==null?void 0:n.values)??[]}function Yy(e,t){const n=co(t),r=e.and.filter(s=>!("starsIn"in s)&&!("stars"in s));return n.length?{and:[{starsIn:{values:n}},...r]}:{and:r}}function YC(e){var n;const t=e.and.find(r=>"starsNotIn"in r);return((n=t==null?void 0:t.starsNotIn)==null?void 0:n.values)??[]}function Xy(e,t){const n=co(t),r=e.and.filter(s=>!("starsNotIn"in s));return n.length?{and:[{starsNotIn:{values:n}},...r]}:{and:r}}function XC(e){var n;const t=e.and.find(r=>"nameContains"in r);return((n=t==null?void 0:t.nameContains)==null?void 0:n.value)??null}function qy(e,t){const n=ln(t),r=e.and.filter(s=>!("nameContains"in s));return n?{and:[{nameContains:{value:n}},...r]}:{and:r}}function qC(e){var n;const t=e.and.find(r=>"nameNotContains"in r);return((n=t==null?void 0:t.nameNotContains)==null?void 0:n.value)??null}function Gy(e,t){const n=ln(t),r=e.and.filter(s=>!("nameNotContains"in s));return n?{and:[{nameNotContains:{value:n}},...r]}:{and:r}}function GC(e){var n;const t=e.and.find(r=>"commentsContains"in r);return((n=t==null?void 0:t.commentsContains)==null?void 0:n.value)??null}function Jy(e,t){const n=ln(t),r=e.and.filter(s=>!("commentsContains"in s));return n?{and:[{commentsContains:{value:n}},...r]}:{and:r}}function JC(e){var n;const t=e.and.find(r=>"commentsNotContains"in r);return((n=t==null?void 0:t.commentsNotContains)==null?void 0:n.value)??null}function Zy(e,t){const n=ln(t),r=e.and.filter(s=>!("commentsNotContains"in s));return n?{and:[{commentsNotContains:{value:n}},...r]}:{and:r}}function ZC(e){var n;const t=e.and.find(r=>"urlContains"in r);return((n=t==null?void 0:t.urlContains)==null?void 0:n.value)??null}function ex(e,t){const n=ln(t),r=e.and.filter(s=>!("urlContains"in s));return n?{and:[{urlContains:{value:n}},...r]}:{and:r}}function ek(e){var n;const t=e.and.find(r=>"urlNotContains"in r);return((n=t==null?void 0:t.urlNotContains)==null?void 0:n.value)??null}function tx(e,t){const n=ln(t),r=e.and.filter(s=>!("urlNotContains"in s));return n?{and:[{urlNotContains:{value:n}},...r]}:{and:r}}function tk(e){const t=e.and.find(n=>"dateRange"in n);return(t==null?void 0:t.dateRange)??null}function Id(e,t){const n=Ia((t==null?void 0:t.from)??null),r=Ia((t==null?void 0:t.to)??null),s=e.and.filter(i=>!("dateRange"in i));return!n&&!r?{and:s}:{and:[{dateRange:{...n?{from:n}:{},...r?{to:r}:{}}},...s]}}function nk(e){const t=e.and.find(n=>"widthCompare"in n);return(t==null?void 0:t.widthCompare)??null}function Jl(e,t){const n=e.and.filter(r=>!("widthCompare"in r));return!t||!Number.isFinite(t.value)||!Hf.has(t.op)?{and:n}:{and:[{widthCompare:{op:t.op,value:t.value}},...n]}}function rk(e){const t=e.and.find(n=>"heightCompare"in n);return(t==null?void 0:t.heightCompare)??null}function Zl(e,t){const n=e.and.filter(r=>!("heightCompare"in r));return!t||!Number.isFinite(t.value)||!Hf.has(t.op)?{and:n}:{and:[{heightCompare:{op:t.op,value:t.value}},...n]}}function sk(e,t){const n=e.and.find(r=>"metricRange"in r&&r.metricRange.key===t);return(n==null?void 0:n.metricRange)??null}function ik(e,t,n){const r=e.and.filter(s=>!("metricRange"in s&&s.metricRange.key===t));return n?{and:[{metricRange:{key:t,min:n.min,max:n.max}},...r]}:{and:r}}function ok(e){const t=Ld(e);return t?t.and.length:0}function lk(e){var t,n,r,s,i,o,l,c;if(!e||typeof e!="object")return null;if("stars"in e){const d=co(e.stars);return d.length?{starsIn:{values:d}}:null}if("starsIn"in e){const d=co((t=e.starsIn)==null?void 0:t.values);return d.length?{starsIn:{values:d}}:null}if("starsNotIn"in e){const d=co((n=e.starsNotIn)==null?void 0:n.values);return d.length?{starsNotIn:{values:d}}:null}if("nameContains"in e){const d=ln((r=e.nameContains)==null?void 0:r.value);return d?{nameContains:{value:d}}:null}if("nameNotContains"in e){const d=ln((s=e.nameNotContains)==null?void 0:s.value);return d?{nameNotContains:{value:d}}:null}if("commentsContains"in e){const d=ln((i=e.commentsContains)==null?void 0:i.value);return d?{commentsContains:{value:d}}:null}if("commentsNotContains"in e){const d=ln((o=e.commentsNotContains)==null?void 0:o.value);return d?{commentsNotContains:{value:d}}:null}if("urlContains"in e){const d=ln((l=e.urlContains)==null?void 0:l.value);return d?{urlContains:{value:d}}:null}if("urlNotContains"in e){const d=ln((c=e.urlNotContains)==null?void 0:c.value);return d?{urlNotContains:{value:d}}:null}if("dateRange"in e){const d=e.dateRange,f=Ia((d==null?void 0:d.from)??null),p=Ia((d==null?void 0:d.to)??null);return!f&&!p?null:{dateRange:{...f?{from:f}:{},...p?{to:p}:{}}}}if("widthCompare"in e){const d=e.widthCompare,f=hm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{widthCompare:f}:null}if("heightCompare"in e){const d=e.heightCompare,f=hm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{heightCompare:f}:null}if("metricRange"in e){const d=e.metricRange;if(!d||typeof d!="object")return null;const f=typeof d.key=="string"?d.key:"",p=_d(d.min),h=_d(d.max);return!f||p==null||h==null||p>h?null:{metricRange:{key:f,min:p,max:h}}}return null}function co(e){if(!Array.isArray(e))return[];const t=[],n=new Set;for(const r of e){const s=typeof r=="number"?r:typeof r=="string"?Number(r):NaN;!Number.isInteger(s)||!UC.has(s)||n.has(s)||(n.add(s),t.push(s))}return t}function ln(e){if(typeof e!="string")return null;const t=e.trim();return t||null}function Ia(e){if(typeof e!="string")return null;const t=e.trim();if(!t)return null;const n=Date.parse(t);return Number.isNaN(n)?null:t}function hm(e,t){if(typeof e!="string"||!Hf.has(e))return null;const n=_d(t);return n==null?null:{op:e,value:n}}function pm(e,t){if(!e)return null;const n=e.trim();if(!n)return null;const r=Date.parse(n);return Number.isNaN(r)?null:t&&VC.test(n)?r+24*60*60*1e3-1:r}function mm(e,t,n){switch(t){case"<":return e<n;case"<=":return e<=n;case">":return e>n;case">=":return e>=n;default:return!0}}function _d(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null}const gm="leftW.folders",vm="leftW.metrics",ak="leftW",ym="rightW",xm=200,wm=240,Sm=200;function uk(e){return(e.pointerType??"mouse")==="mouse"&&e.button!==0}function ck(e,t){try{e.setPointerCapture(t)}catch{}}function dk(e,t){try{e.releasePointerCapture(t)}catch{}}function fk(e,t){const[n,r]=u.useState(240),[s,i]=u.useState(320),[o,l]=u.useState(240),c=t==="metrics"?s:n,d=u.useRef(c),f=u.useRef(o);u.useEffect(()=>{d.current=c},[c]),u.useEffect(()=>{f.current=o},[o]),u.useEffect(()=>{try{const x=window.localStorage,w=Number(x.getItem(gm)??x.getItem(ak));Number.isFinite(w)&&w>0&&r(w);const C=Number(x.getItem(vm));Number.isFinite(C)&&C>0&&i(C);const y=Number(x.getItem(ym));Number.isFinite(y)&&y>0&&l(y)}catch{}},[]);const p=(x,w,C)=>{if(uk(x))return;x.preventDefault();const y=x.currentTarget,m=x.pointerId;ck(y,m);const v=N=>{N.pointerId===m&&w(N)};function g(){window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",b),window.removeEventListener("pointercancel",b),dk(y,m)}function b(N){N.pointerId===m&&(g(),C())}window.addEventListener("pointermove",v),window.addEventListener("pointerup",b),window.addEventListener("pointercancel",b)};return{leftW:c,rightW:o,onResizeLeft:x=>{const w=e.current;if(!w)return;const C=w.getBoundingClientRect(),y=t==="metrics"?vm:gm;let m=d.current;p(x,v=>{const g=v.clientX-C.left,b=Math.max(xm,C.width-f.current-Sm),N=Math.min(Math.max(g,xm),b);m=N,t==="metrics"?i(N):r(N)},()=>{try{window.localStorage.setItem(y,String(m))}catch{}})},onResizeRight:x=>{const w=e.current;if(!w)return;const C=w.getBoundingClientRect();let y=f.current;p(x,m=>{const v=m.clientX-C.left,g=C.width-v,b=Math.max(wm,C.width-d.current-Sm),N=Math.min(Math.max(g,wm),b);y=N,f.current=N,l(N)},()=>{try{window.localStorage.setItem(ym,String(y))}catch{}})}}}const nx=1,ea=200,hk=5*6e4,pk=6e4,rx=(e,t)=>t!=null&&t.recursive?["folder",e,"recursive",t.page??nx,t.pageSize??ea]:["folder",e];function sx(e){return e[0]!=="folder"||e[2]!=="recursive"||typeof e[1]!="string"||typeof e[3]!="number"||typeof e[4]!="number"?null:e}function mk(e){return sx(e)!==null}function gk(e,t,n=!0){if(!mk(e))return!0;const r=sx(e);if(r==null)return!1;const[,s,,i]=r;return i!==nx?!1:!!(s===t||n&&s==="/")}function vk(e,t,n=!0){return!Array.isArray(e)||e[0]!=="folder"?!1:!gk(e,t,n)}const yk=15e3;function xk(e,t){return xe.getFolder(e,t)}function Fd(e,t=!1,n){const r=tu(),s={recursive:t,page:n==null?void 0:n.page,pageSize:n==null?void 0:n.pageSize,legacyRecursive:n==null?void 0:n.legacyRecursive},i=!!s.recursive;return Ja({queryKey:rx(e,s),queryFn:()=>xk(e,s),enabled:(n==null?void 0:n.enabled)??!0,staleTime:1e4,gcTime:i?pk:hk,retry:2,retryDelay:o=>Math.min(1e3*Math.pow(2,o),5e3),refetchOnWindowFocus:!1,refetchInterval:r?yk:!1,refetchIntervalInBackground:r})}const ix="application/x-lenslet-paths",wk='[role="treeitem"].drop-target';function bm(e){var n;return Array.from(((n=e.dataTransfer)==null?void 0:n.types)||[]).includes(ix)}function Sk(e){document.querySelectorAll(wk).forEach(t=>{t!==e&&t.classList.remove("drop-target")})}function Cm(e){Sk(e),e.classList.add("drop-target")}function km(e){return e.startsWith("/")?e:`/${e}`}function bk({path:e,isLeaf:t}){const n=nr(),r=u.useCallback(l=>{bm(l)&&(l.preventDefault(),t&&Cm(l.currentTarget))},[t]),s=u.useCallback(l=>{!t||!bm(l)||(l.preventDefault(),Cm(l.currentTarget))},[t]),i=u.useCallback(l=>{const c=l.currentTarget,d=document.elementFromPoint(l.clientX,l.clientY);d&&c.contains(d)||c.classList.remove("drop-target")},[]),o=u.useCallback(async l=>{const c=l.dataTransfer;if(!c)return;l.preventDefault(),l.currentTarget.classList.remove("drop-target");const d=c.getData(ix),p=(d?JSON.parse(d):[]).filter(Boolean);if(!p.length)return;let h=p[0].split("/").slice(0,-1).join("/")||"/";h=km(h);const S=km(e);try{for(const x of p)await xe.moveFile(x,S);n.invalidateQueries({queryKey:["folder",h]}),n.invalidateQueries({queryKey:["folder",S]}),n.setQueryData(["folder",h],x=>!x||!Array.isArray(x.items)?x:{...x,items:x.items.filter(w=>!p.includes(w.path))})}catch{}},[e,n]);return{onDragOver:r,onDragEnter:s,onDragLeave:i,onDrop:o}}const Ck='[role="tree"] [role="treeitem"]';function kk(){return Array.from(document.querySelectorAll(Ck))}function Ek(e,t){var i;const n=kk(),r=n.findIndex(o=>o===e);if(r===-1)return;let s=r;t==="ArrowDown"?s=Math.min(n.length-1,r+1):t==="ArrowUp"?s=Math.max(0,r-1):t==="Home"?s=0:t==="End"&&(s=n.length-1),(i=n[s])==null||i.focus()}function Nk({path:e,isLeaf:t,isExpanded:n,setExpanded:r,onOpen:s}){return u.useCallback(i=>{if(i.key==="Enter"){i.preventDefault(),s(e);return}if(i.key==="ArrowRight"){!t&&!n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.add(e),l}));return}if(i.key==="ArrowLeft"){!t&&n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.delete(e),l}));return}(i.key==="ArrowDown"||i.key==="ArrowUp"||i.key==="Home"||i.key==="End")&&(i.preventDefault(),Ek(i.currentTarget,i.key))},[e,t,n,r,s])}const Em=64,jk=120;function Mk(e){const t=e.split("/").filter(Boolean),n=["/"];let r="";for(const s of t)r=r?`${r}/${s}`:`/${s}`,n.push(r);return n}function Rk({current:e,roots:t,data:n,onOpen:r,onPullRefresh:s,onResize:i,onContextMenu:o,onOpenActions:l,countVersion:c,className:d,showResizeHandle:f=!0}){const[p,h]=u.useState(new Set(["/"])),S=u.useRef(new Map),x=u.useRef(new Map),[w,C]=u.useState(!1),[y,m]=u.useState(0),v=u.useRef(null),g=u.useRef(!1),b=nr(),N=u.useCallback(()=>{m(0),v.current=null,g.current=!1},[]),j=u.useCallback(async R=>{const M=jt(R||"/"),_=S.current,F=x.current,W=_.get(M);if(W!==void 0)return W;const U=b.getQueryData(rx(M,{recursive:!0}));if(U){const J=U.totalItems??U.items.length;return _.set(M,J),J}const I=F.get(M);if(I)return I;const X=(async()=>{try{const J=await xe.getFolder(M,{recursive:!0}),ne=J.totalItems??J.items.length;return _.set(M,ne),ne}finally{F.delete(M)}})();return F.set(M,X),X},[b]);u.useEffect(()=>{S.current.clear(),x.current.clear()},[c]),u.useEffect(()=>{const R=Mk(e);h(M=>{const _=new Set(M);for(const F of R)_.add(F);return _})},[e]);const E=u.useCallback(async()=>{if(!(!s||w)){C(!0);try{await s()}catch(R){console.error("Failed to refresh folders:",R)}finally{C(!1),m(0)}}},[s,w]),O=u.useCallback(R=>{!s||w||R.touches.length===1&&(R.currentTarget.scrollTop>0||(v.current=R.touches[0].clientY,g.current=!1))},[s,w]),L=u.useCallback(R=>{if(!s||w||R.touches.length!==1)return;const M=v.current;if(M==null)return;if(R.currentTarget.scrollTop>0){N();return}const _=R.touches[0].clientY-M;if(_<=0){g.current&&m(0);return}!g.current&&_<8||(g.current=!0,R.preventDefault(),m(Math.min(jk,_*.55)))},[w,s,N]),A=u.useCallback(()=>{if(!s||w){N();return}const R=g.current&&y>=Em;if(v.current=null,g.current=!1,R){E();return}m(0)},[E,w,s,y,N]),z=d??"h-full overflow-auto bg-panel scrollbar-thin",H=s?`${z} overscroll-y-contain`:z,Z=!!s&&(w||y>0),B=y>=Em,T=w?28:Math.min(44,y);return a.jsxs("div",{className:H,onTouchStart:s?O:void 0,onTouchMove:s?L:void 0,onTouchEnd:s?A:void 0,onTouchCancel:s?A:void 0,children:[Z&&a.jsx("div",{className:"flex items-end justify-center text-[11px] text-muted select-none transition-[height,opacity] duration-150",style:{height:T,opacity:w||y>8?1:.65},"aria-live":"polite",children:w?"Refreshing":B?"Release to refresh":"Pull to refresh"}),a.jsx("div",{className:"p-1",role:"tree","aria-label":"Folders",children:t.map(R=>a.jsx(ox,{path:R.path,label:R.label,depth:0,current:e,expanded:p,setExpanded:h,onOpen:r,onContextMenu:o,onOpenActions:l,initial:n,getSubtreeCount:j,countVersion:c},R.path))}),f&&a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 left-[calc(var(--left)-6px)]",onPointerDown:i})]})}function ox({path:e,label:t,depth:n,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:c,initial:d,getSubtreeCount:f,countVersion:p}){var z;const h=s.has(e),S=r===e,x=e==="/"||h||S,{data:w}=Fd(e,!1,{enabled:x}),C=d&&e===d.path?d:w,m=!!C?C.dirs.length===0:!1,[v,g]=u.useState(C?C.items.length:null),b=Nk({path:e,isLeaf:m,isExpanded:h,setExpanded:i,onOpen:o}),{onDragOver:N,onDragEnter:j,onDragLeave:E,onDrop:O}=bk({path:e,isLeaf:m}),L=H=>{H.stopPropagation(),!m&&i(Z=>{const B=new Set(Z);return B.has(e)?B.delete(e):B.add(e),B})},A=H=>{if(H.stopPropagation(),!c)return;const Z=H.currentTarget.getBoundingClientRect();c(e,{x:Z.right-4,y:Z.bottom-4})};return u.useEffect(()=>{let H=!1;if(!C){g(null);return}if(g(C.items.length),!!(h&&(n>0||S)))return f(e).then(B=>{H||g(B)}).catch(B=>{H||console.warn(`Failed to compute subtree count for ${e}:`,B)}),()=>{H=!0}},[C,e,f,p,h,n,S]),a.jsxs("div",{children:[a.jsxs("div",{className:`tree-row flex items-center gap-1.5 py-1 px-2 rounded-md cursor-pointer min-h-[40px] outline-none transition-colors duration-75 ${S?"bg-accent/20 text-accent font-medium":"hover:bg-white/5 text-text"}`,role:"treeitem","aria-level":n+1,"aria-expanded":m?void 0:h,"aria-selected":S,tabIndex:S?0:-1,style:{paddingLeft:8+n*14},onClick:()=>o(e),onContextMenu:H=>{H.preventDefault(),H.stopPropagation(),l==null||l(H,e)},onKeyDown:b,onDragOver:N,onDragEnter:j,onDragLeave:E,onDrop:O,children:[a.jsx("button",{type:"button",className:"tree-expand-btn touch-manipulation",onClick:L,"aria-label":m?`No subfolders in ${t}`:`${h?"Collapse":"Expand"} ${t}`,"aria-expanded":m?void 0:h,disabled:m,children:m?"":h?"":""}),a.jsx("span",{className:"flex-1 overflow-hidden truncate text-sm",title:t,children:iC(t,28)}),v!==null&&a.jsx("span",{className:"text-[10px] opacity-50 bg-white/5 border border-white/5 rounded px-1.5 min-w-[24px] text-center",children:v}),c&&a.jsx("button",{type:"button",className:"tree-row-action-btn touch-manipulation","aria-label":`Open actions for ${t}`,"aria-haspopup":"menu",onPointerDown:H=>H.stopPropagation(),onClick:A,children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]}),h&&((z=C==null?void 0:C.dirs)==null?void 0:z.map(H=>a.jsx(ox,{path:Ky(e,H.name),label:H.name,depth:n+1,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:c,getSubtreeCount:f,countVersion:p},H.name)))]})}const Nm=[5,4,3,2,1],jm=["<","<=",">",">="];function Pk({filters:e,onChangeFilters:t}){const n=u.useMemo(()=>KC(e),[e]),r=u.useMemo(()=>YC(e),[e]),s=u.useMemo(()=>XC(e)??"",[e]),i=u.useMemo(()=>qC(e)??"",[e]),o=u.useMemo(()=>GC(e)??"",[e]),l=u.useMemo(()=>JC(e)??"",[e]),c=u.useMemo(()=>ZC(e)??"",[e]),d=u.useMemo(()=>ek(e)??"",[e]),f=u.useMemo(()=>tk(e)??{},[e]),p=u.useMemo(()=>Mm(f.from),[f.from]),h=u.useMemo(()=>Mm(f.to),[f.to]),S=u.useMemo(()=>nk(e),[e]),x=u.useMemo(()=>rk(e),[e]),[w,C]=u.useState((S==null?void 0:S.op)??">="),[y,m]=u.useState((x==null?void 0:x.op)??">=");u.useEffect(()=>{S!=null&&S.op&&C(S.op)},[S==null?void 0:S.op]),u.useEffect(()=>{x!=null&&x.op&&m(x.op)},[x==null?void 0:x.op]);const v=(g,b)=>{const N=new Set(n),j=new Set(r);g==="include"?N.has(b)?N.delete(b):(N.add(b),j.delete(b)):j.has(b)?j.delete(b):(j.add(b),N.delete(b));let E=Yy(e,Array.from(N));E=Xy(E,Array.from(j)),t(E)};return a.jsxs("div",{className:"ui-card",children:[a.jsx("div",{className:"ui-section-title mb-3",children:"Attributes"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Rating"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Include"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[Nm.map(g=>{const b=n.includes(g);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${b?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("include",g),"aria-pressed":b,title:`Include ${g} star${g>1?"s":""}`,children:[g,""]},`stars-in-${g}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${n.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("include",0),"aria-pressed":n.includes(0),title:"Include unrated",children:"None"})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Exclude"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[Nm.map(g=>{const b=r.includes(g);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${b?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("exclude",g),"aria-pressed":b,title:`Exclude ${g} star${g>1?"s":""}`,children:[g,""]},`stars-out-${g}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${r.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("exclude",0),"aria-pressed":r.includes(0),title:"Exclude unrated",children:"None"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Filename"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:s,placeholder:"e.g. draft",onChange:g=>t(qy(e,g.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:i,placeholder:"e.g. v1",onChange:g=>t(Gy(e,g.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Comments"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:o,placeholder:"e.g. hero",onChange:g=>t(Jy(e,g.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:l,placeholder:"e.g. todo",onChange:g=>t(Zy(e,g.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"URL"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:c,placeholder:"e.g. s3://bucket",onChange:g=>t(ex(e,g.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:d,placeholder:"e.g. http://",onChange:g=>t(tx(e,g.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Date Added"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"From"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:p,onChange:g=>t(Id(e,{from:g.target.value||null,to:f.to??null}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"To"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:h,onChange:g=>t(Id(e,{from:f.from??null,to:g.target.value||null}))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Dimensions"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Width"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:w,onChange:g=>{const b=g.target.value;C(b),S&&t(Jl(e,{op:b,value:S.value}))},children:jm.map(g=>a.jsx("option",{value:g,children:g},`w-${g}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:S?String(S.value):"",min:0,placeholder:"px",onChange:g=>{const b=g.target.value;if(!b){t(Jl(e,null));return}const N=Number(b);Number.isFinite(N)&&t(Jl(e,{op:w,value:N}))}})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Height"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:y,onChange:g=>{const b=g.target.value;m(b),x&&t(Zl(e,{op:b,value:x.value}))},children:jm.map(g=>a.jsx("option",{value:g,children:g},`h-${g}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:x?String(x.value):"",min:0,placeholder:"px",onChange:g=>{const b=g.target.value;if(!b){t(Zl(e,null));return}const N=Number(b);Number.isFinite(N)&&t(Zl(e,{op:y,value:N}))}})]})]})]})]})]})]})}function Mm(e){return e?e.length>=10?e.slice(0,10):e:""}const Tk=[];function Od(e,t){if(t!=null&&t.length)return Lk(e,t);const n=new Map;for(const r of e){const s=r.metrics;if(s)for(const[i,o]of Object.entries(s)){if(o==null||Number.isNaN(o))continue;const l=n.get(i);l?l.push(o):n.set(i,[o])}}return n}function Lk(e,t){const n=t.map(s=>({key:s,values:[]}));for(const s of e){const i=s.metrics;if(i)for(const o of n){const l=i[o.key];l==null||Number.isNaN(l)||o.values.push(l)}}const r=new Map;for(const s of n)s.values.length&&r.set(s.key,s.values);return r}function Ms(e,t){return e.get(t)??Tk}function cc(e,t,n){if(!e.length)return null;const r=n?n.min:Math.min(...e);let s=n?n.max:Math.max(...e);r===s&&(s=r+1);const i=new Array(t).fill(0),o=t/(s-r);for(const l of e){const c=Math.max(0,Math.min(t-1,Math.floor((l-r)*o)));i[c]+=1}return{bins:i,min:r,max:s,count:e.length}}function lx(e,t){return e<t?{min:e,max:t}:{min:t,max:e}}function Kt(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function lr(e){if(!Number.isFinite(e))return"";const t=e.toString();return t.includes("e")?e.toFixed(6):t}function Rm(e){const t=e.trim();if(!t)return{value:null,valid:!0};const n=Number(t);return Number.isFinite(n)?{value:n,valid:!0}:{value:null,valid:!1}}function Pm(e,t,n){return e<t?t:e>n?n:e}function Qf(e){return e<0?0:e>1?1:e}function Rs(e,t){const n=Math.max(1,Math.abs(e),Math.abs(t));return Math.abs(e-t)<=1e-6*n}function Ik(e,t,n){const r=Qf((e-t.left)/t.width);return n.min+(n.max-n.min)*r}function _k(e,t,n=4){return e==null?!1:Math.abs(t-e)>=n}function ax(e,t){return lx(e??t,t)}function Fk(e,t,n,r){return e&&t!=null?{commitRange:ax(n,t),shouldClear:!1}:{commitRange:null,shouldClear:r!=null}}function Ok({metricKey:e,domain:t,activeRange:n,onChangeRange:r}){const[s,i]=u.useState(null),[o,l]=u.useState(!1),c=u.useRef(null),d=u.useRef(null),f=u.useRef(!1),p=u.useRef(null),[h,S]=u.useState(null),x=s??n;u.useEffect(()=>{S(null)},[e,t==null?void 0:t.min,t==null?void 0:t.max]);const w=v=>{var b;if(!t)return null;const g=(b=p.current)==null?void 0:b.getBoundingClientRect();return g?Ik(v,{left:g.left,width:g.width},t):null};return{svgRef:p,hoverValue:h,displayRange:x,onPointerDown:v=>{var b;if(!t)return;v.preventDefault();const g=w(v.clientX);g!=null&&(l(!0),i(null),c.current=g,d.current=v.clientX,f.current=!1,S(g),(b=p.current)==null||b.setPointerCapture(v.pointerId))},onPointerMove:v=>{const g=w(v.clientX);if(g==null){o||S(null);return}S(g),o&&(!f.current&&!_k(d.current,v.clientX)||(f.current=!0,i(ax(c.current,g))))},onPointerUp:v=>{var N;if(!o)return;l(!1),(N=p.current)==null||N.releasePointerCapture(v.pointerId);const g=w(v.clientX),b=Fk(f.current,g,c.current,n);b.commitRange?(S(g),r(b.commitRange)):b.shouldClear&&r(null),c.current=null,d.current=null,f.current=!1,setTimeout(()=>i(null),0)},onPointerLeave:()=>S(null)}}const Zr=40;function Tm({metricKey:e,populationValues:t,filteredValues:n,selectedValues:r=[],filters:s,onChangeRange:i,showTitle:o=!1}){const l=u.useMemo(()=>cc(t,Zr),[t]),c=u.useMemo(()=>l?cc(n,Zr,l):null,[n,l]),d=sk(s,e),f=l?{min:l.min,max:l.max}:null,{svgRef:p,hoverValue:h,displayRange:S,onPointerDown:x,onPointerMove:w,onPointerUp:C,onPointerLeave:y}=Ok({metricKey:e,domain:f,activeRange:d,onChangeRange:z=>i(e,z)}),[m,v]=u.useState(""),[g,b]=u.useState(""),[N,j]=u.useState(null),E=r.length===1?r[0]:null,O=u.useMemo(()=>!l||r.length<2?null:cc(r,Zr,l),[r,l]);u.useEffect(()=>{if(!d||!f){N!=="min"&&v(d?lr(d.min):""),N!=="max"&&b(d?lr(d.max):"");return}if(N!=="min"){const z=Rs(d.min,f.min)?"":lr(d.min);v(z)}if(N!=="max"){const z=Rs(d.max,f.max)?"":lr(d.max);b(z)}},[d,f,N]);const L=(z,H)=>{if(!f)return;const Z=Rm(z),B=Rm(H);if(!Z.valid||!B.valid){Z.valid||v(d?lr(d.min):""),B.valid||b(d?lr(d.max):"");return}if(Z.value==null&&B.value==null){i(e,null);return}const T=Z.value??f.min,R=B.value??f.max,M=Pm(T,f.min,f.max),_=Pm(R,f.min,f.max),F=lx(M,_);if(Rs(F.min,f.min)&&Rs(F.max,f.max)){i(e,null);return}i(e,F)};if(!l||!f)return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]});const A=r.length;return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mb-2 tabular-nums",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{children:["Population: ",l.count]}),a.jsxs("span",{children:["Filtered: ",(c==null?void 0:c.count)??0]}),A>1&&a.jsxs("span",{className:"text-text",children:["Selected: ",A]})]}),E!=null&&a.jsxs("span",{className:"text-text",children:["Selected: ",Kt(E)]})]}),a.jsxs("svg",{ref:p,viewBox:`0 0 ${Zr} 100`,preserveAspectRatio:"none",className:"w-full h-28 cursor-crosshair rounded-md bg-surface-inset",onPointerDown:x,onPointerMove:w,onPointerUp:C,onPointerLeave:y,children:[dc(l.bins,"#2e3a4b"),c&&dc(c.bins,"#3a8fff"),O&&dc(O.bins,"#f59e0b",{opacity:.55}),S&&Ak(S,f),E!=null&&Lm(E,f,{color:"var(--highlight)",strokeWidth:.7}),h!=null&&Lm(h,f,{color:"rgba(255,255,255,0.75)",strokeWidth:.5,dashed:!0})]}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mt-2 tabular-nums",children:[a.jsx("span",{children:Kt(f.min)}),a.jsxs("div",{className:"flex flex-col items-center text-center leading-tight",children:[S?a.jsx("span",{className:"text-text",children:Rs(S.min,f.min)?` ${Kt(S.max)}`:Rs(S.max,f.max)?` ${Kt(S.min)}`:`${Kt(S.min)}  ${Kt(S.max)}`}):h!=null?a.jsxs("span",{className:"text-text",children:["Cursor: ",Kt(h)]}):a.jsx("span",{children:"Drag to filter"}),S&&h!=null&&a.jsxs("span",{className:"text-[11px] text-muted",children:["Cursor: ",Kt(h)]})]}),a.jsx("span",{children:Kt(f.max)})]}),a.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2 mt-3 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Min"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:m,placeholder:lr(f.min),onFocus:()=>j("min"),onBlur:()=>{j(null),L(m,g)},onChange:z=>v(z.target.value),onKeyDown:z=>{z.key==="Enter"&&z.currentTarget.blur()}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Max"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:g,placeholder:lr(f.max),onFocus:()=>j("max"),onBlur:()=>{j(null),L(m,g)},onChange:z=>b(z.target.value),onKeyDown:z=>{z.key==="Enter"&&z.currentTarget.blur()}})]}),a.jsx("button",{className:"btn btn-xs btn-ghost text-muted hover:text-text",onClick:()=>i(e,null),children:"Clear"})]})]})}function dc(e,t,n){const r=Math.max(1,...e),s=(n==null?void 0:n.opacity)??.9;return e.map((i,o)=>{const l=i/r*100;return a.jsx("rect",{x:o+.05,y:100-l,width:.9,height:l,fill:t,opacity:s},`${t}-${o}`)})}function Ak(e,t){const n=(e.min-t.min)/(t.max-t.min),r=(e.max-t.min)/(t.max-t.min),s=Zr*Qf(Math.min(n,r)),i=Zr*Math.abs(r-n);return a.jsx("rect",{x:s,y:0,width:Math.max(.5,i),height:100,fill:"rgba(255,255,255,0.08)",stroke:"rgba(255,255,255,0.4)",strokeWidth:.4})}function Lm(e,t,n){const r=Qf((e-t.min)/(t.max-t.min)),s=Zr*r;return a.jsx("line",{x1:s,y1:0,x2:s,y2:100,stroke:n.color,strokeWidth:n.strokeWidth??.5,strokeDasharray:n.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}const Dk=new Map;function zk({items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}){const[c,d]=u.useState(!1),f=s&&n.includes(s)?s:n[0],p=u.useMemo(()=>c?n:f?[f]:[],[c,n,f]),h=u.useMemo(()=>Od(e,p),[e,p]),S=u.useMemo(()=>Od(t,p),[t,p]),x=r??Dk;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("label",{className:"ui-label",children:"Metric"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-[11px]",onClick:()=>d(w=>!w),"aria-pressed":c,children:c?"Show one":"Show all"})]}),c?a.jsx("div",{className:"ui-input ui-input-readonly w-full flex items-center text-xs",children:"All metrics"}):a.jsx("select",{className:"ui-select w-full",value:f,onChange:w=>i(w.target.value),children:n.map(w=>a.jsx("option",{value:w,children:w},w))})]}),c?a.jsx("div",{className:"space-y-3",children:n.map(w=>a.jsx(Tm,{metricKey:w,populationValues:Ms(h,w),filteredValues:Ms(S,w),selectedValues:Ms(x,w),filters:o,onChangeRange:l,showTitle:!0},w))}):f?a.jsx(Tm,{metricKey:f,populationValues:Ms(h,f),filteredValues:Ms(S,f),selectedValues:Ms(x,f),filters:o,onChangeRange:l}):a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]})}const $k=12;function Bk({items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l,onChangeFilters:c}){const d=u.useMemo(()=>r!=null&&r.length?Od(r,n):null,[r,n]),f=d&&r&&r.length?a.jsx(Uk,{selectedValuesByKey:d,totalItems:r.length,metricKeys:n}):null,p=a.jsx(Pk,{filters:o,onChangeFilters:c});return n.length?a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,a.jsx(zk,{items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:d,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}),p]}):a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,p,a.jsx("div",{className:"p-4 text-sm text-muted",children:"No metrics found in this dataset."})]})}function Uk({selectedValuesByKey:e,totalItems:t,metricKeys:n}){const r=u.useMemo(()=>e.size?{entries:(n.length?n.filter(p=>e.has(p)):Array.from(e.keys()).sort()).map(p=>{const h=e.get(p)??[],S=Math.min(...h),x=Math.max(...h),w=h.reduce((C,y)=>C+y,0)/Math.max(1,h.length);return{key:p,value:h[0],min:S,max:x,avg:w,count:h.length}}),totalItems:t}:null,[e,n,t]);if(!r)return null;const{entries:s,totalItems:i}=r,o=s.slice(0,$k),l=s.length-o.length,c=i>1;return a.jsxs("div",{className:"ui-card",children:[a.jsxs("div",{className:"ui-card-header",children:[a.jsx("div",{className:"ui-section-title",children:"Selected metrics"}),a.jsxs("div",{className:"text-[11px] text-muted",children:[i," item",i===1?"":"s"]})]}),a.jsxs("div",{className:"space-y-1 text-[12px]",children:[o.map(d=>a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-muted w-28 shrink-0 truncate",title:d.key,children:d.key}),a.jsxs("span",{className:"font-mono text-text text-right tabular-nums",children:[c?`${Kt(d.min)}  ${Kt(d.max)}`:Kt(d.value),c&&a.jsxs("span",{className:"text-[11px] text-muted ml-2",children:["avg ",Kt(d.avg),d.count!==i?`  ${d.count}/${i}`:""]})]})]},d.key)),l>0&&a.jsxs("div",{className:"text-[11px] text-muted",children:["+",l," more"]})]})]})}const Vk=[{label:"Root",path:"/"}],Wk="w-11 h-11 rounded-md border border-border flex items-center justify-center transition-colors",Hk="bg-accent-muted text-accent",Qk="bg-surface text-text hover:bg-surface-hover";function Ll(e){return`${Wk} ${e?Hk:Qk}`}function Kk({leftTool:e,onToolChange:t,compareEnabled:n,compareActive:r,onOpenCompare:s,views:i,activeViewId:o,onActivateView:l,onSaveView:c,current:d,data:f,onOpenFolder:p,onOpenFolderActions:h,onPullRefreshFolders:S,onContextMenu:x,countVersion:w,items:C,filteredItems:y,metricKeys:m,selectedItems:v,selectedMetric:g,onSelectMetric:b,filters:N,onChangeRange:j,onChangeFilters:E,onResize:O}){const L=Ll(e==="folders"),A=Ll(e==="metrics"),z=Ll(r),H=`${Ll(!1)} cursor-pointer`;return a.jsxs("div",{className:"app-left-panel col-start-1 row-start-2 relative border-r border-border bg-panel overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-y-0 left-0 w-12 border-r border-border flex flex-col items-center gap-2 py-3 bg-surface-overlay",children:[a.jsx("button",{className:L,title:"Folders","aria-label":"Folders","aria-pressed":e==="folders",onClick:()=>t("folders"),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M3 7.5h6l2-2h10a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2z"})})}),a.jsx("button",{className:A,title:"Metrics / Filters","aria-label":"Metrics and Filters","aria-pressed":e==="metrics",onClick:()=>t("metrics"),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]})}),a.jsx("div",{className:"w-6 h-px bg-border/70 my-1"}),a.jsx("button",{className:`${z} ${n?"":"opacity-40 cursor-not-allowed"}`,title:n?"Compare selected images":"Compare (select 2+)","aria-label":"Compare selected images","aria-pressed":r,"aria-disabled":!n,disabled:!n,onClick:()=>{n&&s()},children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("rect",{x:"3",y:"4",width:"8",height:"16",rx:"1"}),a.jsx("rect",{x:"13",y:"4",width:"8",height:"16",rx:"1"})]})}),a.jsx("div",{className:"flex-1"}),a.jsx("a",{className:H,href:"https://github.com/trojblue/lenslet",title:"Lenslet on GitHub","aria-label":"Lenslet on GitHub",target:"_blank",rel:"noreferrer",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:a.jsx("path",{d:"M12 .5C5.73.5.5 5.74.5 12.02c0 5.1 3.29 9.42 7.86 10.95.58.11.79-.25.79-.56v-2.17c-3.2.7-3.88-1.55-3.88-1.55-.53-1.35-1.29-1.71-1.29-1.71-1.05-.72.08-.71.08-.71 1.16.08 1.78 1.2 1.78 1.2 1.03 1.77 2.71 1.26 3.37.96.1-.75.4-1.26.73-1.55-2.55-.29-5.23-1.29-5.23-5.74 0-1.27.45-2.31 1.19-3.13-.12-.29-.52-1.46.11-3.05 0 0 .97-.31 3.18 1.19.92-.26 1.91-.39 2.89-.39.98 0 1.97.13 2.89.39 2.2-1.5 3.18-1.19 3.18-1.19.63 1.59.23 2.76.11 3.05.74.82 1.19 1.86 1.19 3.13 0 4.46-2.69 5.45-5.25 5.73.41.36.78 1.07.78 2.16v3.2c0 .31.21.67.8.56 4.56-1.53 7.85-5.85 7.85-10.95C23.5 5.74 18.27.5 12 .5z"})})})]}),a.jsx("div",{className:"ml-12 h-full",children:e==="folders"?a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-2 py-2 border-b border-border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Smart Folders"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:c,title:"Save current view as Smart Folder",children:"+ New"})]}),i.length?a.jsx("div",{className:"flex flex-col gap-1",children:i.map(Z=>{const B=Z.id===o;return a.jsx("button",{className:`text-left px-2 py-2 rounded-md text-sm ${B?"bg-accent-muted text-accent":"hover:bg-hover text-text"}`,onClick:()=>l(Z),children:Z.name},Z.id)})}):a.jsx("div",{className:"text-xs text-muted px-1 py-1.5",children:"No saved Smart Folders yet."})]}),a.jsx(Rk,{current:d,roots:Vk,data:f,onOpen:p,onPullRefresh:S,onContextMenu:x,onOpenActions:h,countVersion:w,className:"flex-1 min-h-0 overflow-auto scrollbar-thin",showResizeHandle:!1})]}):a.jsx(Bk,{items:C,filteredItems:y,metricKeys:m,selectedItems:v,selectedMetric:g,onSelectMetric:b,filters:N,onChangeRange:j,onChangeFilters:E})}),a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 right-0",onPointerDown:O})]})}function Yk({persistenceEnabled:e,offViewSummary:t,onRevealOffView:n,canRevealOffView:r=!1,onClearOffView:s,browserZoomPercent:i}){const l=!!(t!=null&&t.names.length)&&t?` (${t.names.join(", ")}${t.extra?` +${t.extra}`:""})`:"",c=r&&n!=null,d=typeof i=="number"?i:null,f=d!==null&&Math.abs(d-100)>=2;return!e||f||!!t?a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-col gap-2",children:[!e&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Not persisted."})," Workspace is read-only; edits stay in memory until restart."]}),f&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Browser zoom ",Math.round(d),"%."]})," For best results, set it to 100% so UI elements stay in correct proportions."]}),t&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex items-center justify-between gap-3",children:[a.jsxs("span",{children:["Updates outside current view: ",t.count," item",t.count===1?"":"s",l]}),a.jsxs("div",{className:"flex items-center gap-2",children:[c&&a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>n==null?void 0:n(),"aria-label":"Reveal off-view updates",children:"Reveal"}),a.jsx("button",{className:"text-muted hover:text-text transition-colors text-base leading-none",onClick:s,"aria-label":"Clear off-view updates",children:""})]})]})]})}):null}function Xk(e){return e.isOffline?"offline":e.isUnstable?"unstable":e.recentEditActive?"recent":Number.isFinite(e.editingCount)&&e.editingCount>0?"editing":"live"}const qk=6e3,Gk=1e4,Jk=24*60*6e4,Zk=3e4,eE=350,tE=1400,ux=[-2,-1,1,2],cx=[-2,-1,0,1,2,3];ux.length;cx.length;function nE(e,t,n){return Math.min(Math.max(e,t),n)}function dx(e,t,n){const r=new Set,s=[];for(const i of n){const o=t+i;if(o<0||o>=e.length)continue;const l=e[o];!l||r.has(l)||(r.add(l),s.push(l))}return s}function rE(e,t){if(!t)return[];const n=e.indexOf(t);return n<0?[]:dx(e,n,ux)}function sE(e,t){if(e.length<2)return[];const n=Math.max(0,e.length-2),r=nE(t,0,n);return dx(e,r,cx)}function iE({paths:e,defaultDestination:t,destinations:n,loadingDestinations:r,onClose:s,onSubmit:i}){const[o,l]=u.useState(()=>jt(t||"/")),[c,d]=u.useState(!1);u.useEffect(()=>{l(jt(t||"/"))},[t,e]);const f=jt(o||"/"),p=e.length>0&&!c,h=e.slice(0,3).map(C=>Wf(C)||C),S=Math.max(0,e.length-h.length),x=n.filter(C=>C!==f).slice(0,8),w=async C=>{if(C.preventDefault(),!!p){d(!0);try{await i(e,f)}finally{d(!1)}}};return a.jsx("div",{className:"toolbar-offset fixed inset-0 z-overlay bg-black/45 backdrop-blur-[1px] flex items-center justify-center p-3",children:a.jsxs("div",{className:"w-full max-w-[560px] rounded-xl border border-border bg-panel shadow-[0_20px_60px_rgba(0,0,0,0.55)]",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Move to folder"}),a.jsxs("div",{className:"text-xs text-muted",children:[e.length," item(s) selected"]})]}),a.jsx("button",{type:"button",className:"btn btn-icon",onClick:s,"aria-label":"Close move dialog",disabled:c,children:""})]}),a.jsxs("form",{className:"px-4 py-3 flex flex-col gap-3",onSubmit:w,children:[a.jsxs("div",{className:"text-xs text-muted",children:[h.join(", "),S>0?` and ${S} more`:""]}),a.jsxs("label",{className:"text-xs text-muted flex flex-col gap-1.5",children:["Destination folder",a.jsx("input",{value:o,onChange:C=>l(C.target.value),className:"input w-full",list:"move-destination-list",placeholder:"/",autoFocus:!0,disabled:c})]}),a.jsx("datalist",{id:"move-destination-list",children:n.map(C=>a.jsx("option",{value:C},C))}),a.jsx("div",{className:"text-[11px] text-muted",children:r?"Loading folder list":`${n.length.toLocaleString()} destination(s) loaded`}),x.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.map(C=>a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>l(C),disabled:c,children:C},C))}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-border",children:[a.jsx("button",{type:"button",className:"btn",onClick:s,disabled:c,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-active",disabled:!p,children:c?"Moving":"Move"})]})]})]})})}function oE(e){return JSON.stringify(e,null,2)}function lE(e){const t=s=>'"'+s.replaceAll('"','""')+'"',n="path,folder,name,star,type,size,width,height,tags,notes",r=e.map(s=>{const i=(s.tags||[]).join(" "),o=s.notes||"";return[s.path,s.folder,s.name,String(s.star??""),s.type??"",s.size??"",s.width??"",s.height??"",i,o].map(l=>t(String(l))).join(",")});return[n,...r].join(`
`)}function aE(e){return e.map(t=>{const n=t.path.split("/").filter(Boolean);n.pop();const r=n.length?`/${n.join("/")}`:"/";return{path:t.path,folder:r,name:t.name,star:t.star??null,type:t.type,size:t.size,width:t.w,height:t.h}})}function uE({x:e,y:t,items:n}){const r=u.useRef(null),[s,i]=u.useState({x:e,y:t}),[o,l]=u.useState(!1),c=u.useCallback((f,p)=>{p.stopPropagation(),f.disabled||f.onClick()},[]),d=u.useCallback(()=>{const f=r.current,p=My(),h=f==null?void 0:f.getBoundingClientRect(),S=(h==null?void 0:h.width)??180,x=(h==null?void 0:h.height)??Math.max(40,n.length*36),w=jy({x:e,y:t,menuWidth:S,menuHeight:x,viewport:p});i(C=>C.x===w.x&&C.y===w.y?C:w),l(!0)},[n.length,e,t]);return u.useLayoutEffect(()=>{d()},[d]),u.useEffect(()=>(window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}),[d]),a.jsx("div",{ref:r,className:"dropdown-panel fixed",role:"menu",style:{left:s.x,top:s.y,minWidth:180,visibility:o?"visible":"hidden"},onClick:f=>f.stopPropagation(),children:n.map((f,p)=>a.jsxs("button",{className:`dropdown-item w-full ${f.danger?"text-danger hover:text-danger":""}`,role:"menuitem","aria-disabled":f.disabled,disabled:f.disabled,onClick:h=>c(f,h),children:[f.icon&&a.jsx("span",{className:"shrink-0",children:f.icon}),a.jsx("span",{children:f.label})]},p))})}function Im(e){return e==="csv"?"text/csv;charset=utf-8":"application/json;charset=utf-8"}function _m(e,t){const n=aE(e);return t==="csv"?lE(n):oE(n)}function Fm(){return new Date().toISOString().replace(/[:.]/g,"-")}function cE({ctx:e,current:t,items:n,setCtx:r,onRefetch:s,onOpenMoveDialog:i,onRefreshFolder:o}){const l=BC(t),[c,d]=u.useState(!1),[f,p]=u.useState(null),h=e.kind==="grid"?e.payload.paths:[],S=u.useMemo(()=>new Map(n.map(j=>[j.path,j])),[n]),x=()=>{r(null)},w=async()=>{const j=e.kind==="tree"?e.payload.path:"/";d(!0);try{await o(j)}catch(E){console.error("Failed to refresh folder:",E)}finally{d(!1),x()}},C=j=>async()=>{p(j);const E=e.kind==="tree"?e.payload.path:t;try{const O=await xe.getFolder(E,{recursive:!0,legacyRecursive:!0}),L=_m(O.items,j),A=Im(j),z=E==="/"?"root":(E.replace(/^\/+/,"")||"root").replace(/\//g,"_");uo(new Blob([L],{type:A}),`metadata_${z}_${Fm()}.${j}`)}catch(O){console.error("Failed to export folder:",O),alert("Failed to export folder. See console for details.")}finally{p(null),x()}},y=j=>async()=>{p(j);try{const E=new Set(h),O=n.filter(z=>E.has(z.path)),L=_m(O,j),A=Im(j);uo(new Blob([L],{type:A}),`metadata_selection_${Fm()}.${j}`)}finally{p(null),x()}},m=async()=>{var j;if(h.length){x();for(const E of h)try{const O=await xe.getFile(E),L=((j=S.get(E))==null?void 0:j.name)||Wf(E)||"image";uo(O,L)}catch(O){console.error(`Failed to download ${E}:`,O)}}},v=async()=>{if(!l){for(const j of h)try{await xe.moveFile(j,"/_trash_")}catch(E){console.error(`Failed to trash ${j}:`,E)}s(),x()}},g=async()=>{if(confirm(`Delete ${h.length} file(s) permanently? This cannot be undone.`)){try{await xe.deleteFiles(h)}catch(j){console.error("Failed to delete files:",j)}s(),x()}},b=async()=>{for(const j of h)try{const O=(await xe.getSidecar(j)).original_position,L=O&&O.split("/").slice(0,-1).join("/")||"/";await xe.moveFile(j,L)}catch(E){console.error(`Failed to recover ${j}:`,E)}s(),x()},N=e.kind==="tree"?[{label:c?"Refreshing":"Refresh",disabled:c,onClick:w},{label:f==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!f||c,onClick:C("csv")},{label:f==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!f||c,onClick:C("json")}]:dE({selectedPaths:h,inTrash:l,exporting:f,onDownloadSelection:m,onMoveSelection:i,onMoveToTrash:v,onPermanentDelete:g,onRecover:b,onExportCsv:y("csv"),onExportJson:y("json")});return a.jsx(uE,{x:e.x,y:e.y,items:N})}function dE({selectedPaths:e,inTrash:t,exporting:n,onDownloadSelection:r,onMoveSelection:s,onMoveToTrash:i,onPermanentDelete:o,onRecover:l,onExportCsv:c,onExportJson:d}){const f=[];return e.length&&f.push({label:e.length>1?`Download (${e.length})`:"Download",onClick:r}),e.length&&f.push({label:"Move to",disabled:t,onClick:()=>{t||s(e)}}),f.push({label:"Move to trash",disabled:t,onClick:i}),t&&(f.push({label:"Permanent delete",danger:!0,onClick:o}),f.push({label:"Recover",onClick:l})),e.length&&(f.push({label:n==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!n,onClick:c}),f.push({label:n==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!n,onClick:d})),f}function Il(e){const t=u.useRef(e);return t.current=e,t}function fE(e,t){return t?e.some(n=>{var s;const r=(s=n.metrics)==null?void 0:s[t];return r!=null&&!Number.isNaN(r)}):!1}function hE(e,t){const n={0:0,1:0,2:0,3:0,4:0,5:0};for(const r of e){const s=t[r.path]??r.star??0,i=String(s);n[i]=(n[i]||0)+1}return n}function pE(e,t=250){const n=new Set;let r=0;for(const s of e){const i=s.metrics;if(i)for(const o of Object.keys(i))n.add(o);if(r+=1,r>=t&&n.size>0)break}return Array.from(n).sort()}function mE(e,t,n,r){return e||t?n:r}function gE(e,t,n,r,s,i){return e?n:t||i==="/"?r:s}function vE(e){if(!e)return null;if(e.queryPath){const t=e.queryPath.split("/").filter(Boolean);return t.length?t[t.length-1]:e.queryPath}return e.queryVector?"Vector query":null}function yE(e,t,n,r){return e?t>0?`${n} of ${r}`:`${r}`:null}const xE=(e,t)=>["search",e,t],wE=2e4;function SE(e,t){const n=tu();return Ja({enabled:!!e.trim(),queryKey:xE(e,t),queryFn:()=>xe.search(e,t),staleTime:3e3,gcTime:6e4,placeholderData:r=>r,retry:1,refetchInterval:n?wE:!1,refetchIntervalInBackground:n})}const bE=()=>["embeddings"];function CE(){return Ja({queryKey:bE(),queryFn:xe.getEmbeddings,staleTime:6e4,gcTime:5*6e4,retry:1,refetchOnWindowFocus:!1})}function kE(e,t=250){const[n,r]=fo.useState(e);return fo.useEffect(()=>{const s=window.setTimeout(()=>r(e),Math.max(0,t));return()=>window.clearTimeout(s)},[e,t]),n}function Om(e){return e.addedAt?Date.parse(e.addedAt):0}function _a(e,t){return e.name.localeCompare(t.name)}function EE(e,t){const n=Om(e),r=Om(t);return n===r?_a(e,t):n-r}function NE(e){return(t,n)=>{var i,o;const r=(i=t.metrics)==null?void 0:i[e],s=(o=n.metrics)==null?void 0:o[e];return r==null&&s==null?_a(t,n):r==null?1:s==null?-1:r===s?_a(t,n):r-s}}function Am(e,t){return WC(e,t)}function jE(e){let t=e>>>0;return()=>{t+=1831565813;let n=Math.imul(t^t>>>15,1|t);return n^=n+Math.imul(n^n>>>7,61|n),((n^n>>>14)>>>0)/4294967296}}function ME(e,t){const n=jE(t||1),r=[...e];for(let s=r.length-1;s>0;s-=1){const i=Math.floor(n()*(s+1));[r[s],r[i]]=[r[i],r[s]]}return r}function RE(e,t,n){if(t.kind==="builtin"&&t.key==="random"){const i=n??Date.now();return ME(e,i)}let r=EE;t.kind==="metric"?r=NE(t.key):t.key==="name"&&(r=_a);const s=[...e].sort(r);return t.dir==="desc"?s.reverse():s}function fx(e){if(!e.length)return e;const t=new Set,n=[];for(const r of e)t.has(r.path)||(t.add(r.path),n.push(r));return n}function hx(e){return{...e,items:fx(e.items)}}function PE(e,t){const n=e.pageCount??1,r=e.pageSize??t,s=(e.page??1)+1;return n<=1||s>n?null:{startPage:s,endPage:n,pageSize:r}}function TE(e,t){if(e.path!==t.path)return hx(t);const n=fx([...e.items,...t.items]);return{...e,generatedAt:t.generatedAt??e.generatedAt,dirs:e.dirs.length?e.dirs:t.dirs,items:n,page:t.page??e.page,pageSize:t.pageSize??e.pageSize,pageCount:t.pageCount??e.pageCount,totalItems:t.totalItems??e.totalItems}}async function LE(e,t){const n=t.shouldContinue??(()=>!0),r=t.progressiveUpdates??!0;let s=hx(e);t.onUpdate(s);const i=PE(e,t.defaultPageSize);if(!i)return;let o=!1;for(let l=i.startPage;l<=i.endPage;l+=1){let c;try{c=await t.fetchPage(l,i.pageSize)}catch{return}if(!n())return;s=TE(s,c),o=!0,r&&t.onUpdate(s)}!r&&o&&t.onUpdate(s)}function IE(e,t){return e?t instanceof Gt||t instanceof Error?t.message:"Failed to load embeddings.":null}function _E({current:e,query:t,similarityState:n,viewState:r,randomSeed:s,localStarOverrides:i}){var M,_;const o=nr(),{data:l,refetch:c,isLoading:d,isError:f}=Fd(e,!0,{page:1,pageSize:ea}),[p,h]=u.useState(),S=u.useRef(0),x=u.useCallback(()=>c(),[c]),{data:w}=Fd("/",!0,{enabled:!1,page:1,pageSize:ea});u.useEffect(()=>{o.removeQueries({predicate:({queryKey:F})=>vk(F,e,!0)})},[e,o]),u.useEffect(()=>{S.current+=1,h(void 0)},[e]),u.useEffect(()=>{if(!l)return;const F=++S.current;let W=!1;return LE(l,{defaultPageSize:ea,fetchPage:(U,I)=>xe.getFolder(l.path,{recursive:!0,page:U,pageSize:I}),onUpdate:h,shouldContinue:()=>!W&&S.current===F,progressiveUpdates:!1}),()=>{W=!0}},[l]);const C=n!==null,y=!C&&t.trim().length>0,m=kE(t,250),v=u.useMemo(()=>m.trim().replace(/\s+/g," "),[m]),g=SE(y?v:"",e),b=CE(),N=((M=b.data)==null?void 0:M.embeddings)??[],j=((_=b.data)==null?void 0:_.rejected)??[],E=N.length>0,O=IE(b.isError,b.error),L=u.useMemo(()=>{var W;return(y?((W=g.data)==null?void 0:W.items)??[]:(p==null?void 0:p.items)??[]).map(U=>({...U,star:i[U.path]!==void 0?i[U.path]:U.star}))},[y,g.data,p,i]),A=u.useMemo(()=>{var U;const F=new Map;for(const I of L)F.set(I.path,I);const W=((U=g.data)==null?void 0:U.items)??[];for(const I of W){if(F.has(I.path))continue;const X=i[I.path]!==void 0?i[I.path]:I.star;F.set(I.path,{...I,star:X})}return F},[L,g.data,i]),z=u.useMemo(()=>n?n.items.map(F=>{const W=A.get(F.path);return W||CC(F.path,i[F.path])}):[],[n,A,i]),H=u.useMemo(()=>{if(n)return Am(z,r.filters);const F=Am(L,r.filters);return RE(F,r.sort,s)},[n,z,L,r.filters,r.sort,s]),Z=n?z.length:L.length,B=H.length,T=(p==null?void 0:p.totalItems)??(p==null?void 0:p.items.length)??Z,R=e==="/"?T:(w==null?void 0:w.totalItems)??(w==null?void 0:w.items.length)??T;return{data:p,refetch:x,isLoading:d,isError:f,searching:y,normalizedQ:v,similarityActive:C,embeddings:N,embeddingsRejected:j,embeddingsAvailable:E,embeddingsLoading:b.isLoading,embeddingsError:O,poolItems:L,similarityItems:z,items:H,totalCount:Z,filteredCount:B,scopeTotal:T,rootTotal:R}}function FE({current:e,itemPaths:t,items:n,selectionPool:r,focusGridCell:s}){const[i,o]=u.useState([]),[l,c]=u.useState(null),[d,f]=u.useState(!1),[p,h]=u.useState(0),[S,x]=u.useState(0),w=u.useRef(!1),C=u.useRef(!1),y=u.useRef(null),m=u.useMemo(()=>new Set(i),[i]),v=u.useMemo(()=>{if(!i.length)return[];const V=new Map(r.map(ae=>[ae.path,ae])),pe=new Map(n.map(ae=>[ae.path,ae]));return i.map(ae=>V.get(ae)??pe.get(ae)).filter(ae=>!!ae)},[i,r,n]),g=u.useMemo(()=>n.filter(V=>m.has(V.path)),[n,m]),b=u.useMemo(()=>g.map(V=>V.path),[g]),N=Math.max(0,g.length-2),j=Math.min(p,N),E=g[j]??null,O=g[j+1]??null,L=j>0,A=j<g.length-2,z=g.length>=2,H=l!=null||d,Z=l??i[0]??null,B=Z?t.indexOf(Z):-1,T=B>0,R=B>=0&&B<t.length-1;u.useEffect(()=>{h(V=>V>N?N:V)},[N]);const M=u.useCallback(()=>{x(V=>V+1)},[]),_=u.useCallback(V=>{y.current=V},[]),F=u.useCallback(()=>{c(null),w.current=!1},[]),W=u.useCallback(V=>{if(V){c(V),o([V]);return}F()},[F]),U=u.useCallback(V=>{l&&(c(null),w.current=!1,Tl(V))},[l]),I=u.useCallback(V=>{c(V),w.current=!0,Qy(V)},[]),X=u.useCallback(()=>{c(null),w.current?(w.current=!1,window.history.back()):Tl(e),s(y.current)},[e,s]),J=u.useCallback(()=>{d||!z||(i[0]&&(y.current=i[0]),h(0),f(!0),l&&(c(null),w.current&&(w.current=!1),Tl(e)),C.current||(window.history.pushState({compare:!0},"",window.location.href),C.current=!0))},[d,z,e,i,l]),ne=u.useCallback(()=>{f(!1),C.current&&(C.current=!1,window.history.back()),s(y.current??i[0])},[s,i]),ee=u.useCallback(V=>{g.length<2||h(pe=>{const ae=Math.max(0,g.length-2);return Math.min(ae,Math.max(0,pe+V))})},[g.length]),Y=u.useCallback(V=>{if(!t.length)return;const pe=l??i[0];if(!pe)return;const ae=t.indexOf(pe);if(ae===-1)return;const $e=Math.min(t.length-1,Math.max(0,ae+V)),Pe=t[$e];!Pe||Pe===pe||(l&&(c(Pe),Tl(Pe)),o([Pe]))},[t,i,l]);return u.useEffect(()=>{d&&(z||ne())},[d,z,ne]),u.useEffect(()=>{const V=()=>{l&&(w.current=!1,c(null)),d&&(C.current=!1,f(!1))};return window.addEventListener("popstate",V),()=>window.removeEventListener("popstate",V)},[l,d]),{selectedPaths:i,setSelectedPaths:o,viewer:l,compareOpen:d,restoreGridToSelectionToken:S,bumpRestoreGridToSelectionToken:M,selectedItems:v,compareItems:g,comparePaths:b,compareIndexClamped:j,compareA:E,compareB:O,canComparePrev:L,canCompareNext:A,compareEnabled:z,canPrevImage:T,canNextImage:R,overlayActive:H,rememberFocusedPath:_,openViewer:I,closeViewer:X,openCompare:J,closeCompare:ne,handleCompareNavigate:ee,handleNavigate:Y,resetViewerState:F,clearViewerForSearch:U,syncHashImageSelection:W}}const OE=2048,AE=6,DE=10;function px(e){const t=new Map;for(const n of e)t.set(n.path,n.name);return t}function mx(e,t){return t.get(e)??e.split("/").pop()??e}function Dm(e,t){const n=e.filter(r=>!t.has(r.path));return n.length===e.length?e:n}function zm(e,t,n,r,s){const i=e.filter(l=>l.path!==t);return[{path:t,ts:n,kind:r},...i].slice(0,s)}function zE(e,t){if(!e.length)return null;const n=px(t),r=new Set,s=[];for(const o of e)r.has(o.path)||(r.add(o.path),s.push(o.path));const i=s.slice(0,2).map(o=>mx(o,n));return{count:s.length,names:i,extra:Math.max(0,s.length-i.length)}}function $E(e,t,n,r){if(!e.length)return[];const s=px(t);return e.map(i=>({path:i.path,label:mx(i.path,s),timeLabel:r(i.ts,n)}))}function BE(e){const[t,n]=u.useState([]),[r,s]=u.useState([]),[i,o]=u.useState(new Map),l=u.useRef(new Map),c=u.useRef(new Set),d=u.useRef(new Set),f=u.useRef(new Set);u.useEffect(()=>()=>{for(const C of l.current.values())window.clearTimeout(C);l.current.clear(),c.current.clear()},[]),u.useEffect(()=>{d.current=new Set(e),n(C=>Dm(C,f.current))},[e]);const p=u.useCallback((C,y)=>{if(y!=null){if(c.current.has(y))return;if(c.current.add(y),c.current.size>OE){const N=c.current.values().next().value;N!=null&&c.current.delete(N)}}const m=y!=null?`event:${y}`:`event:${C}:${Date.now()}`;o(N=>{if(N.get(C)===m)return N;const j=new Map(N);return j.set(C,m),j});const v=l.current,g=v.get(C);g!=null&&window.clearTimeout(g);const b=window.setTimeout(()=>{o(N=>{if(N.get(C)!==m)return N;const j=new Map(N);return j.delete(C),j}),v.delete(C)},tE);v.set(C,b)},[]),h=u.useCallback(C=>{f.current=C,n(y=>Dm(y,C))},[]),S=u.useCallback((C,y,m)=>{const v=Date.now();d.current.has(C)&&f.current.has(C)||n(b=>zm(b,C,v,y,AE)),p(C,m)},[p]),x=u.useCallback((C,y,m)=>{const v=Date.now(),g=Uy(m)??v;s(b=>zm(b,C,g,y,DE))},[]),w=u.useCallback(()=>{n([])},[]);return{offViewActivity:t,recentTouches:r,highlightedPaths:i,onVisiblePathsChange:h,markRecentActivity:S,markRecentTouch:x,clearOffViewActivity:w}}function UE(e){switch(e){case"live":return"Live";case"reconnecting":return"Reconnecting";case"offline":return"Offline";case"connecting":case"idle":default:return"Connecting"}}function $m(e){if(!(e instanceof Gt))return null;const t=e.body;if(!t||typeof t!="object")return null;const n=t.error;return typeof n=="string"?n:null}function Bm(e,t){return t-e<Jk?aC(e,t):uC(e)}function VE({current:e,currentGalleryId:t,itemPaths:n,items:r,queryClient:s,updateItemCaches:i,setLocalStarOverrides:o}){const l=u.useRef(vi()),c=u.useRef(null),d=u.useRef(null),f=u.useRef(null),p=u.useRef(!1),h=u.useRef(null),S=u.useRef("idle"),[x,w]=u.useState("idle"),[C,y]=u.useState({}),[m,v]=u.useState(null),[g,b]=u.useState(null),[N,j]=u.useState(!1),[E,O]=u.useState(()=>Date.now()),[L,A]=u.useState(!0);u.useEffect(()=>{if(g==null){j(!1);return}j(!0);const ue=window.setTimeout(()=>j(!1),qk);return()=>window.clearTimeout(ue)},[g]),u.useEffect(()=>{if(m==null)return;O(Date.now());const ue=window.setInterval(()=>O(Date.now()),1e4);return()=>window.clearInterval(ue)},[m]);const{offViewActivity:z,recentTouches:H,highlightedPaths:Z,onVisiblePathsChange:B,markRecentActivity:T,markRecentTouch:R,clearOffViewActivity:M}=BE(n),_=u.useCallback(ue=>{const oe=Date.now(),Oe=Uy(ue)??oe,Ce=Oe>oe?oe:Oe;v(ve=>ve==null?Ce:ve>Ce?ve:Ce),b(oe),O(oe)},[]),F=u.useCallback(ue=>{ue.length&&y(oe=>{let Se=!1;const Oe={...oe};for(const Ce of ue){const ve=oe[Ce.gallery_id];ve&&ve.viewing===Ce.viewing&&ve.editing===Ce.editing||(Oe[Ce.gallery_id]=Ce,Se=!0)}return Se?Oe:oe})},[]),W=u.useCallback(()=>{h.current!=null&&(window.clearTimeout(h.current),h.current=null)},[]),U=u.useCallback(ue=>{ue&&y(oe=>{if(!(ue in oe))return oe;const Se={...oe};return delete Se[ue],Se})},[]),I=u.useCallback(ue=>{c.current=ue.lease_id,d.current=ue.gallery_id,F([ue])},[F]),X=u.useCallback(async(ue,oe=!1)=>{const Se=l.current,Oe=oe?void 0:c.current??void 0,Ce=ve=>xe.joinPresence(ue,ve,Se);try{I(await Ce(Oe));return}catch(ve){if(!oe&&$m(ve)==="invalid_lease"){I(await Ce(void 0));return}throw ve}},[I]),J=u.useCallback(async(ue,oe)=>{if(ue===oe){await X(oe);return}const Se=c.current;if(!Se){await X(oe,!0);return}try{const Oe=await xe.movePresence(ue,oe,Se,l.current);d.current=Oe.to_scope.gallery_id,F([Oe.from_scope,Oe.to_scope]);return}catch(Oe){const Ce=$m(Oe);if(Ce==="invalid_lease"){await X(oe,!0);return}if(Ce==="scope_mismatch"){await X(oe);return}throw Oe}},[F,X]),ne=u.useCallback(async ue=>{const oe=d.current;if(!oe){await X(ue,!0);return}if(oe===ue){await X(ue);return}await J(oe,ue)},[X,J]),ee=u.useCallback(async()=>{if(p.current)return;const ue=f.current;if(ue){f.current=null,p.current=!0;try{await ne(ue)}catch{}finally{p.current=!1;const oe=f.current;oe&&oe!==d.current&&ee()}}},[ne]),Y=u.useCallback((ue,oe=!1)=>{if(f.current=ue,W(),oe||d.current==null){ee();return}h.current=window.setTimeout(()=>{h.current=null,ee()},eE)},[W,ee]),V=u.useCallback(()=>{d.current=null,c.current=null,f.current=null,W()},[W]),pe=u.useCallback(ue=>{const oe=d.current,Se=c.current;!oe||!Se||(TS(oe,Se,l.current),ue&&U(oe),V())},[U,V]);u.useEffect(()=>{kS();const ue=NS(Se=>{if(Se.type==="presence"){const ve=Se.data;if(!(ve!=null&&ve.gallery_id))return;F([ve]);return}const Oe=Se.data;if(!(Oe!=null&&Oe.path))return;const Ce=Oe.path;if(Se.type==="item-updated"){const ve=Se.data,At={v:1,tags:ve.tags??[],notes:ve.notes??"",star:ve.star??null,version:ve.version??1,updated_at:ve.updated_at??"",updated_by:ve.updated_by??"server"};s.setQueryData(To(Ce),At),i({path:Ce,star:ve.star??null,metrics:ve.metrics,comments:ve.notes??""}),eC(Ce,At),T(Ce,"item-updated",Se.id),R(Ce,"item-updated",ve.updated_at),_(ve.updated_at),o(tn=>{if(tn[Ce]===void 0)return tn;const nt={...tn};return delete nt[Ce],nt})}else if(Se.type==="metrics-updated"){const ve=Se.data;i({path:Ce,metrics:ve.metrics}),T(Ce,"metrics-updated",Se.id),R(Ce,"metrics-updated",ve.updated_at),_(ve.updated_at)}}),oe=jS(w);return()=>{ue(),oe(),ES()}},[F,T,R,s,o,i,_]),u.useEffect(()=>{const ue=d.current;ue!==t&&Y(t,ue==null)},[t,Y]),u.useEffect(()=>{const ue=window.setInterval(()=>{const oe=d.current;oe&&X(oe)},Zk);return()=>{window.clearInterval(ue)}},[X]),u.useEffect(()=>{const ue=S.current;if(S.current=x,x==="live"&&ue!=="live"){Y(t,!0);return}(x==="reconnecting"||x==="offline")&&U(d.current)},[U,x,t,Y]),u.useEffect(()=>{const ue=()=>pe(!0),oe=()=>pe(!0),Se=()=>{Y(t,!0)};return window.addEventListener("pagehide",ue),window.addEventListener("beforeunload",oe),window.addEventListener("pageshow",Se),()=>{window.removeEventListener("pagehide",ue),window.removeEventListener("beforeunload",oe),window.removeEventListener("pageshow",Se),pe(!1)}},[t,Y,pe]),u.useEffect(()=>{let ue=!1;return xe.getHealth().then(oe=>{var Oe;if(ue)return;const Se=((Oe=oe==null?void 0:oe.labels)==null?void 0:Oe.enabled)??!0;A(Se)}).catch(()=>{}),()=>{ue=!0}},[]);const ae=C[e],$e=(ae==null?void 0:ae.editing)??0,Pe=m!=null,Fe=u.useMemo(()=>UE(x),[x]),dt=u.useMemo(()=>!Pe||m==null?"No edits yet.":Bm(m,E),[Pe,m,E]),Ue=u.useMemo(()=>zE(z,r),[z,r]),St=u.useMemo(()=>$E(H,r,E,Bm),[r,E,H]);return{connectionStatus:x,connectionLabel:Fe,presence:ae,editingCount:$e,recentEditActive:N,hasEdits:Pe,lastEditedLabel:dt,persistenceEnabled:L,highlightedPaths:Z,onVisiblePathsChange:B,offViewSummary:Ue,recentTouchesDisplay:St,clearOffViewActivity:M}}const WE=600;function HE(e){if(!(e instanceof Gt))return!1;if(e.status===403||e.status===405)return!0;const t=String(e.message||"").toLowerCase();return t.includes("read-only")||t.includes("no-write")||t.includes("write")}function Qi(e,t){return HE(e)?"This workspace is read-only. Upload and move actions are disabled.":e instanceof Gt||e instanceof Error&&e.message?e.message:t}function fc(e){return Array.from(new Set(e.filter(Boolean)))}function Um(e,t){return t.length?t.length===1?t[0]:`${e} failed for ${t.length} item(s). ${t[0]}`:""}async function QE(){const e=["/"],t=new Set,n=new Set(["/"]);for(;e.length>0&&t.size<WE;){const r=e.shift()??"/",s=jt(r);if(t.has(s))continue;t.add(s);let i=null;try{i=await xe.getFolder(s)}catch{i=null}if(i)for(const o of i.dirs??[]){const l=jt(Ky(s,o.name));n.has(l)||(n.add(l),e.push(l))}}return Array.from(n).sort((r,s)=>r==="/"?-1:s==="/"?1:r.localeCompare(s))}function KE({appRef:e,uploadInputRef:t,current:n,currentDirCount:r,selectedPaths:s,setSelectedPaths:i,refetch:o,invalidateDerivedCounts:l}){const c=nr(),[d,f]=u.useState(!1),[p,h]=u.useState(null),[S,x]=u.useState(!1),[w,C]=u.useState(null),[y,m]=u.useState(["/"]),[v,g]=u.useState(!1),[b,N]=u.useState(null);u.useEffect(()=>{h(null)},[n]);const j=u.useCallback(T=>{const R=fc(s);return R.includes(T)?R:[T]},[s]),E=u.useCallback((T,R)=>{const M=j(T);i(M),N({x:R.x,y:R.y,kind:"grid",payload:{paths:M}})},[j,i]),O=u.useCallback((T,R)=>{N({x:R.x,y:R.y,kind:"tree",payload:{path:T}})},[]);u.useEffect(()=>{if(!w)return;let T=!1;return g(!0),QE().then(R=>{T||m(R)}).catch(R=>{T||h(Qi(R,"Failed to load destination folders."))}).finally(()=>{T||g(!1)}),()=>{T=!0}},[w]);const L=u.useCallback(async(T,R)=>{const M=fc(T);if(!M.length)return!1;const _=jt(R||"/");h(null);const F=[],W=[];for(const I of M)try{await xe.moveFile(I,_)}catch(X){F.push(`${Wf(I)||I}: ${Qi(X,"Move failed.")}`),W.push(I)}try{await c.invalidateQueries({predicate:({queryKey:I})=>Array.isArray(I)&&I[0]==="folder"}),l(),await o()}catch(I){F.push(Qi(I,"Move completed, but refresh failed."))}if(F.length)return h(Um("Move",F)),i(W),!1;C(null),N(null);const U=new Set(M);return i(I=>I.filter(X=>!U.has(X))),!0},[l,c,o,i]),A=u.useCallback(T=>{const R=fc(T);R.length&&(h(null),C({paths:R}),N(null))},[]),z=u.useCallback(async T=>{if(!T.length)return;if(!(r===0)){h("Uploads are only allowed into folders without subdirectories.");return}f(!0),h(null);const M=[];try{for(const _ of T)try{await xe.uploadFile(n,_)}catch(F){M.push(`${_.name}: ${Qi(F,"Upload failed.")}`)}try{await o()}catch(_){M.push(Qi(_,"Upload completed, but refresh failed."))}}finally{f(!1)}if(M.length){h(Um("Upload",M));return}h(null)},[n,r,o]),H=u.useCallback(()=>{var T;d||(T=t.current)==null||T.click()},[t,d]),Z=u.useCallback(async T=>{const R=Array.from(T.target.files??[]);T.target.value="",R.length&&await z(R)},[z]);u.useEffect(()=>{const T=e.current;if(!T)return;const R=F=>{F.dataTransfer&&Array.from(F.dataTransfer.types).includes("Files")&&(F.preventDefault(),x(!0))},M=F=>{const W=F.relatedTarget;W&&T.contains(W)||x(!1)},_=async F=>{var U;F.preventDefault(),x(!1);const W=Array.from(((U=F.dataTransfer)==null?void 0:U.files)??[]);W.length&&await z(W)};return T.addEventListener("dragover",R),T.addEventListener("dragleave",M),T.addEventListener("drop",_),()=>{T.removeEventListener("dragover",R),T.removeEventListener("dragleave",M),T.removeEventListener("drop",_)}},[e,z]),u.useEffect(()=>{const T=()=>N(null),R=M=>{M.key==="Escape"&&N(null)};return window.addEventListener("click",T),window.addEventListener("keydown",R),()=>{window.removeEventListener("click",T),window.removeEventListener("keydown",R)}},[]);const B=u.useCallback(()=>{C(null)},[]);return{uploading:d,actionError:p,isDraggingOver:S,moveDialog:w,moveFolders:y,moveFoldersLoading:v,ctx:b,setCtx:N,closeMoveDialog:B,openUploadPicker:H,handleUploadInputChange:Z,openGridActions:E,openFolderActions:O,openMoveDialogForPaths:A,moveSelectedToFolder:L}}const et={sortKey:"sortKey",sortDir:"sortDir",sortSpec:"sortSpec",starFilters:"starFilters",filterAst:"filterAst",selectedMetric:"selectedMetric",viewMode:"viewMode",gridItemSize:"gridItemSize",leftOpen:"leftOpen",rightOpen:"rightOpen"};function Vm(e,t){for(const n of e)xe.prefetchFile(n,t),xe.prefetchThumb(n)}function YE(){var rh;const[e,t]=u.useState("/"),[n,r]=u.useState(""),[s,i]=u.useState(!1),[o,l]=u.useState(null),[c,d]=u.useState(null),[f,p]=u.useState(100),[h,S]=u.useState(null),[x,w]=u.useState(()=>({filters:{and:[]},sort:{kind:"builtin",key:"added",dir:"desc"},selectedMetric:void 0})),[C,y]=u.useState(()=>Date.now()),[m,v]=u.useState("adaptive"),[g,b]=u.useState(220),[N,j]=u.useState(!1),[E,O]=u.useState(!0),[L,A]=u.useState(!0),[z,H]=u.useState(()=>typeof window>"u"?1440:window.innerWidth),Z=Yl(Kl.narrow),[B,T]=u.useState("folders"),[R,M]=u.useState([]),[_,F]=u.useState(null),[W,U]=u.useState(0),[I,X]=u.useState({}),J=u.useRef(null),ne=u.useRef(null),ee=u.useRef(null),Y=u.useRef(null),V=u.useRef(null),pe=u.useRef(null),ae=u.useRef(!1),{leftW:$e,rightW:Pe,onResizeLeft:Fe,onResizeRight:dt}=fk(J,B),Ue=nr(),St=Xb(),ue=tu(),oe=Gb(),[Se,Oe]=u.useState(!1),{data:Ce,refetch:ve,searching:At,normalizedQ:tn,similarityActive:nt,embeddings:zr,embeddingsRejected:$r,embeddingsAvailable:rr,embeddingsLoading:Fn,embeddingsError:Rt,poolItems:bt,similarityItems:Dt,items:D,totalCount:q,filteredCount:K,scopeTotal:me,rootTotal:ge}=_E({current:e,query:n,similarityState:o,viewState:x,randomSeed:C,localStarOverrides:I}),ye=u.useMemo(()=>jt(e||"/"),[e]),ce=u.useMemo(()=>fm(x.filters),[x.filters]),je=u.useMemo(()=>D.map(P=>P.path),[D]),_e=u.useCallback(P=>{if(!P)return;const $=document.getElementById(`cell-${encodeURIComponent(P)}`);$==null||$.focus()},[]),ft=o?Dt:bt,{selectedPaths:Te,setSelectedPaths:De,viewer:Qe,compareOpen:rt,restoreGridToSelectionToken:fn,bumpRestoreGridToSelectionToken:Ke,selectedItems:Br,compareItems:Ho,comparePaths:Qo,compareIndexClamped:bi,compareA:Ko,compareB:Yo,canComparePrev:Xo,canCompareNext:qo,compareEnabled:su,canPrevImage:Ci,canNextImage:sr,overlayActive:Go,rememberFocusedPath:Ur,openViewer:iu,closeViewer:Vr,openCompare:Jo,closeCompare:ws,handleCompareNavigate:Ss,handleNavigate:hn,resetViewerState:ki,clearViewerForSearch:Ei,syncHashImageSelection:ir}=FE({current:e,itemPaths:je,items:D,selectionPool:ft,focusGridCell:_e}),On=Il(ir),Zo=Il(Ke);u.useEffect(()=>{const P=se=>{const he=jt(se),Le=$C(he)?he:null,it=Le?dm(he):he,Ne=!ae.current;ae.current=!0,On.current(Le),t(le=>{const de=wC(le,it,Le,Ne);return le===de?le:(Zo.current(),de)})};P(cm());const $=()=>P(cm());return window.addEventListener("hashchange",$),()=>window.removeEventListener("hashchange",$)},[Zo,On]);const ou=ft,bs=o?null:x.sort.kind==="metric"?x.sort.key:null,el=u.useMemo(()=>fE(D,bs),[D,bs]),tl=u.useCallback(P=>{const $=Object.prototype.hasOwnProperty.call(P,"star"),se=P.metrics!==void 0,he=P.comments!==void 0;if(!$&&!se&&!he)return;const Le=Ne=>{if(Ne.path!==P.path)return Ne;let le=Ne;return $&&Ne.star!==P.star&&(le={...le,star:P.star??null}),se&&(le={...le,metrics:P.metrics??void 0}),he&&Ne.comments!==P.comments&&(le={...le,comments:P.comments??""}),le},it=Ne=>{if(!Ne)return Ne;let le=!1;const de=Ne.items.map(Me=>{const zt=Le(Me);return zt!==Me&&(le=!0),zt});return le?{...Ne,items:de}:Ne};Ue.setQueriesData({predicate:({queryKey:Ne})=>Array.isArray(Ne)&&Ne[0]==="folder"},it),Ue.setQueriesData({predicate:({queryKey:Ne})=>Array.isArray(Ne)&&Ne[0]==="search"},it)},[Ue]),{connectionStatus:Wr,connectionLabel:nl,presence:Cs,editingCount:lu,recentEditActive:au,hasEdits:uu,lastEditedLabel:cu,persistenceEnabled:Ni,highlightedPaths:ji,onVisiblePathsChange:rl,offViewSummary:ks,recentTouchesDisplay:du,clearOffViewActivity:Mi}=VE({current:e,currentGalleryId:ye,itemPaths:je,items:D,queryClient:Ue,updateItemCaches:tl,setLocalStarOverrides:X}),Ri=u.useCallback(()=>{U(P=>P+1)},[]),sl=u.useCallback(P=>{const $=jt(P||"/");return $===""?"/":$},[]),il=u.useCallback(P=>{const $=se=>P==="/"?!0:se===P||se.startsWith(`${P}/`);Ue.invalidateQueries({predicate:({queryKey:se})=>{if(!Array.isArray(se)||se[0]!=="folder")return!1;const he=typeof se[1]=="string"?se[1]:"";return $(he)}})},[Ue]),Pi=u.useCallback(async P=>{const $=sl(P);await xe.refreshFolder($),il($),Ri(),(e===$||e.startsWith($==="/"?"/":`${$}/`))&&await ve(),xd.evictPrefix($),Ps.evictPrefix($)},[e,Ri,il,sl,ve]),fu=u.useCallback(async()=>{try{await Pi(e)}catch(P){console.error("Failed to refresh folder:",P)}},[e,Pi]),hu=u.useMemo(()=>hE(o?Dt:bt,I),[o,Dt,bt,I]),En=u.useMemo(()=>pE(o?Dt:bt),[o,Dt,bt]);u.useEffect(()=>{nt||En.length&&w(P=>{const $=P.selectedMetric&&En.includes(P.selectedMetric)?P.selectedMetric:En[0];return $===P.selectedMetric?P:{...P,selectedMetric:$}})},[En,nt]),u.useEffect(()=>{nt||x.sort.kind==="metric"&&(En.includes(x.sort.key)||w(P=>({...P,sort:{kind:"builtin",key:"added",dir:P.sort.dir}})))},[En,x.sort,nt]);const Es=u.useMemo(()=>ok(x.filters),[x.filters]),Ti=nt||At||Es>0,pu=St.state==="syncing"?"Syncing":St.state==="error"?St.message?`Not saved  ${St.message}`:"Not saved  retry":"All changes saved",mu=oe!=null&&oe>Gk,gu=Wr==="offline"||Wr==="connecting"||Wr==="idle",vu=Wr==="reconnecting"||ue||St.state==="error"||mu,yu=Xk({isOffline:gu,isUnstable:vu,recentEditActive:au,editingCount:lu}),xu=mE(nt,Ti,K,me),wu=gE(nt,Ti,q,me,ge,e),Li=u.useMemo(()=>vE(o),[o]),G=u.useMemo(()=>yE(o!==null,Es,K,q),[o,Es,K,q]),re=u.useCallback(P=>{w($=>({...$,filters:P($.filters)}))},[]),ke=u.useCallback(P=>{w($=>({...$,filters:P}))},[]),be=u.useCallback(()=>{re(P=>uc(P,[]))},[re]),gt=u.useCallback(()=>{w(P=>({...P,filters:{and:[]}}))},[]),An=u.useCallback(()=>{l(null);const P=pe.current;pe.current=null,P&&P.length?(De(P),Ke()):De([])},[Ke,De]),gx=u.useCallback(()=>{o&&An(),r(""),w(P=>({...P,filters:{and:[]}}))},[An,o]),vx=u.useCallback(async P=>{!o&&pe.current===null&&(pe.current=Te);const $=await xe.searchEmbeddings(P);if(l({embedding:$.embedding,queryPath:P.query_path??null,queryVector:P.query_vector_b64??null,topK:P.top_k??50,minScore:P.min_score??null,items:$.items,createdAt:Date.now()}),$.items.length){const se=P.query_path&&$.items.some(he=>he.path===P.query_path)?P.query_path:$.items[0].path;De([se]),Ke()}else De([])},[Ke,Te,De,o]),Su=u.useCallback((P,$)=>{re(se=>ik(se,P,$))},[re]),Kf=u.useMemo(()=>{var $,se,he,Le,it,Ne;const P=[];for(const le of x.filters.and)if("stars"in le){const de=le.stars||[];if(!de.length)continue;P.push({id:"stars",label:`Rating in: ${ac(de)}`,onRemove:()=>be()})}else if("starsIn"in le){const de=le.starsIn.values||[];if(!de.length)continue;P.push({id:"stars-in",label:`Rating in: ${ac(de)}`,onRemove:()=>be()})}else if("starsNotIn"in le){const de=le.starsNotIn.values||[];if(!de.length)continue;P.push({id:"stars-not-in",label:`Rating not in: ${ac(de)}`,onRemove:()=>re(Me=>Xy(Me,[]))})}else if("nameContains"in le){const de=($=le.nameContains.value)==null?void 0:$.trim();if(!de)continue;P.push({id:"name-contains",label:`Filename contains: ${de}`,onRemove:()=>re(Me=>qy(Me,""))})}else if("nameNotContains"in le){const de=(se=le.nameNotContains.value)==null?void 0:se.trim();if(!de)continue;P.push({id:"name-not-contains",label:`Filename not: ${de}`,onRemove:()=>re(Me=>Gy(Me,""))})}else if("commentsContains"in le){const de=(he=le.commentsContains.value)==null?void 0:he.trim();if(!de)continue;P.push({id:"comments-contains",label:`Comments contain: ${de}`,onRemove:()=>re(Me=>Jy(Me,""))})}else if("commentsNotContains"in le){const de=(Le=le.commentsNotContains.value)==null?void 0:Le.trim();if(!de)continue;P.push({id:"comments-not-contains",label:`Comments not: ${de}`,onRemove:()=>re(Me=>Zy(Me,""))})}else if("urlContains"in le){const de=(it=le.urlContains.value)==null?void 0:it.trim();if(!de)continue;P.push({id:"url-contains",label:`URL contains: ${de}`,onRemove:()=>re(Me=>ex(Me,""))})}else if("urlNotContains"in le){const de=(Ne=le.urlNotContains.value)==null?void 0:Ne.trim();if(!de)continue;P.push({id:"url-not-contains",label:`URL not: ${de}`,onRemove:()=>re(Me=>tx(Me,""))})}else if("dateRange"in le){const{from:de,to:Me}=le.dateRange;if(!de&&!Me)continue;P.push({id:"date-range",label:`Date: ${yC(de,Me)}`,onRemove:()=>re(zt=>Id(zt,null))})}else if("widthCompare"in le){const{op:de,value:Me}=le.widthCompare;P.push({id:"width-compare",label:`Width ${de} ${Me}`,onRemove:()=>re(zt=>Jl(zt,null))})}else if("heightCompare"in le){const{op:de,value:Me}=le.heightCompare;P.push({id:"height-compare",label:`Height ${de} ${Me}`,onRemove:()=>re(zt=>Zl(zt,null))})}else if("metricRange"in le){const{key:de,min:Me,max:zt}=le.metricRange;P.push({id:`metric:${de}`,label:`${de}: ${SC(Me,zt)}`,onRemove:()=>Su(de,null)})}return P},[x.filters,be,Su,re]),yx=u.useCallback(P=>{const $=new Set(ce);$.has(P)?$.delete(P):$.add(P),w(se=>({...se,filters:uc(se.filters,Array.from($))}))},[ce]),xx=u.useCallback(()=>{O(!0),T("metrics")},[]),wx=u.useCallback(P=>{w($=>({...$,sort:P})),P.kind==="builtin"&&P.key==="random"&&y(Date.now())},[]),Yf=u.useCallback(P=>{if(P==="/"||P==="")return"Lenslet | Root";const $=P.split("/").filter(Boolean);if(!$.length)return"Lenslet";const se=$.slice(-2).join("/");return`Lenslet | ${$.length>2?`.../${se}`:`/${se}`}`},[]),Sx=u.useMemo(()=>xC(e),[e]);u.useEffect(()=>{document.title=Yf(e)},[e,Yf]),u.useEffect(()=>{let P=!0;return xe.getViews().then($=>{P&&M($.views||[])}).catch(()=>{P&&M([])}),()=>{P=!1}},[]),u.useEffect(()=>{At&&(De([]),Ei(e))},[Ei,e,At,De]),u.useEffect(()=>{const P=J.current,$=Y.current;if(!P||!$)return;const se=()=>{const Le=Math.max(48,Math.round($.getBoundingClientRect().height));P.style.setProperty("--toolbar-h",`${Le}px`)};se();const he=window.ResizeObserver;if(he){const Le=new he(se);return Le.observe($),()=>Le.disconnect()}return window.addEventListener("resize",se),()=>window.removeEventListener("resize",se)},[]),u.useEffect(()=>{try{const P=localStorage.getItem(et.sortKey),$=localStorage.getItem(et.sortDir),se=localStorage.getItem(et.sortSpec),he=localStorage.getItem(et.starFilters),Le=localStorage.getItem(et.filterAst),it=localStorage.getItem(et.selectedMetric),Ne=localStorage.getItem(et.viewMode),le=localStorage.getItem(et.gridItemSize),de=localStorage.getItem(et.leftOpen),Me=localStorage.getItem(et.rightOpen),sh=(Ct=>{if(!Ct)return null;const ot=lc(Ct);return!ot||typeof ot!="object"?null:ot.kind==="builtin"&&(ot.key==="name"||ot.key==="added"||ot.key==="random")&&(ot.dir==="asc"||ot.dir==="desc")||ot.kind==="metric"&&typeof ot.key=="string"&&ot.key.length>0&&(ot.dir==="asc"||ot.dir==="desc")?ot:null})(se)??{kind:"builtin",key:P==="name"||P==="added"||P==="random"?P:"added",dir:$==="asc"||$==="desc"?$:"desc"};sh.key==="random"&&y(Date.now());let Cu=(Ct=>{if(!Ct)return null;const ot=lc(Ct);return Ld(ot)})(Le)??{and:[]};if(he){const Ct=lc(he);if(Array.isArray(Ct)){const ot=Ct.filter(Fx=>[0,1,2,3,4,5].includes(Fx));Cu=uc(Cu,ot)}}if(w(Ct=>({...Ct,sort:sh,filters:Cu,selectedMetric:it||Ct.selectedMetric})),(Ne==="grid"||Ne==="adaptive")&&v(Ne),le){const Ct=Number(le);!isNaN(Ct)&&Ct>=80&&Ct<=500&&b(Ct)}(de==="0"||de==="false")&&O(!1),(Me==="0"||Me==="false")&&A(!1)}catch{}},[]),u.useEffect(()=>{Z&&(O(!1),A(!1))},[Z]),u.useEffect(()=>{if(typeof window>"u")return;const P=[1,1.25,1.5,1.75,2,3,4],$=Le=>P.reduce((it,Ne)=>Math.abs(Ne-Le)<Math.abs(it-Le)?Ne:it,P[0]),se=()=>{var zt;const Le=window.devicePixelRatio||1,it=$(Le),Ne=((zt=window.visualViewport)==null?void 0:zt.scale)??1,le=Le*Ne/it;if(!Number.isFinite(le)){S(null);return}const de=Math.round(le*100),Me=Math.min(500,Math.max(25,de));S(Me)};se(),window.addEventListener("resize",se),window.addEventListener("orientationchange",se);const he=window.visualViewport;return he&&he.addEventListener("resize",se),()=>{window.removeEventListener("resize",se),window.removeEventListener("orientationchange",se),he&&he.removeEventListener("resize",se)}},[]),u.useEffect(()=>{try{localStorage.setItem(et.sortKey,x.sort.kind==="builtin"?x.sort.key:"added"),localStorage.setItem(et.sortDir,x.sort.dir),localStorage.setItem(et.sortSpec,JSON.stringify(x.sort));const P=fm(x.filters);localStorage.setItem(et.starFilters,JSON.stringify(P)),localStorage.setItem(et.filterAst,JSON.stringify(x.filters)),x.selectedMetric?localStorage.setItem(et.selectedMetric,x.selectedMetric):localStorage.removeItem(et.selectedMetric),localStorage.setItem(et.viewMode,m),localStorage.setItem(et.gridItemSize,String(g)),localStorage.setItem(et.leftOpen,E?"1":"0"),localStorage.setItem(et.rightOpen,L?"1":"0")}catch{}},[x,m,g,E,L]),u.useEffect(()=>{if(typeof window>"u")return;const P=()=>H(window.innerWidth);return P(),window.addEventListener("resize",P),window.addEventListener("orientationchange",P),()=>{window.removeEventListener("resize",P),window.removeEventListener("orientationchange",P)}},[]);const ol=z<=Ir.mobileMax,Xf=Il(g);u.useEffect(()=>{ol||N&&j(!1)},[ol,N]),u.useEffect(()=>{const P=ne.current;if(!P)return;const $=he=>Math.min(500,Math.max(80,he)),se=he=>{he.ctrlKey&&(Qe||rt||(he.preventDefault(),b(Le=>$(Le+(he.deltaY<0?20:-20)))))};return P.addEventListener("wheel",se,{passive:!1}),()=>P.removeEventListener("wheel",se)},[Qe,rt]),u.useEffect(()=>{if(Qe||rt)return;const P=ne.current;if(!P)return;const $=le=>Math.min(500,Math.max(80,le));let se=null;const he=le=>{if(le.length<2)return 0;const[de,Me]=[le[0],le[1]];return Math.hypot(de.clientX-Me.clientX,de.clientY-Me.clientY)},Le=le=>{if(le.touches.length!==2)return;const de=he(le.touches);de&&(se={dist:de,size:Xf.current})},it=le=>{if(!se||le.touches.length!==2)return;const de=he(le.touches);if(!de)return;le.preventDefault();const Me=$(se.size*(de/se.dist));b(Me)},Ne=()=>{se=null};return P.addEventListener("touchstart",Le,{passive:!0}),P.addEventListener("touchmove",it,{passive:!1}),P.addEventListener("touchend",Ne),P.addEventListener("touchcancel",Ne),()=>{P.removeEventListener("touchstart",Le),P.removeEventListener("touchmove",it),P.removeEventListener("touchend",Ne),P.removeEventListener("touchcancel",Ne)}},[Qe,rt,Xf]),u.useEffect(()=>{Vm(rE(je,Qe),"viewer")},[Qe,je]),u.useEffect(()=>{rt&&Vm(sE(Qo,bi),"compare")},[rt,Qo,bi]);const bu=u.useCallback(P=>{ki();const $=jt(P);t($),Qy($)},[ki]),{uploading:bx,actionError:qf,isDraggingOver:Cx,moveDialog:Gf,moveFolders:kx,moveFoldersLoading:Ex,ctx:Jf,setCtx:Nx,closeMoveDialog:jx,openUploadPicker:Mx,handleUploadInputChange:Rx,openGridActions:Zf,openFolderActions:eh,openMoveDialogForPaths:Px,moveSelectedToFolder:Tx}=KE({appRef:J,uploadInputRef:V,current:e,currentDirCount:((rh=Ce==null?void 0:Ce.dirs)==null?void 0:rh.length)??0,selectedPaths:Te,setSelectedPaths:De,refetch:ve,invalidateDerivedCounts:Ri}),Lx=u.useCallback(async()=>{const P=window.prompt("Save Smart Folder as:","New Smart Folder");if(!P)return;const $=gC(P,R),se={id:$,name:P,pool:{kind:"folder",path:e},view:JSON.parse(JSON.stringify(x))},he=[...R.filter(Le=>Le.id!==$),se];M(he),F($);try{await xe.saveViews({version:1,views:he})}catch(Le){if(Le instanceof Gt&&Le.status===403){const it=new Blob([JSON.stringify({version:1,views:he},null,2)],{type:"application/json"});uo(it,`lenslet-smart-folder-${$}.json`),alert("No-write mode: exported Smart Folder JSON instead of saving.");return}console.error("Failed to save Smart Folder:",Le)}},[e,x,R]);u.useEffect(()=>{if(!_)return;const P=R.find(he=>he.id===_);if(!P){F(null);return}const $=P.pool.path===e,se=JSON.stringify(P.view)===JSON.stringify(x);(!$||!se)&&F(null)},[_,R,e,x]);const th=Il({current:e,items:D,selectedPaths:Te,viewer:Qe,compareOpen:rt,mobileSelectMode:N,openFolder:bu});u.useEffect(()=>{const P=$=>{const se=th.current;if(!$f($.target)){if(($.ctrlKey||$.metaKey)&&$.key.toLowerCase()==="b"){$.preventDefault(),$.altKey?A(he=>!he):O(he=>!he);return}if(!(se.viewer||se.compareOpen)){if($.key==="Backspace"||$.key==="Delete")$.preventDefault(),se.openFolder(dm(se.current));else if(($.ctrlKey||$.metaKey)&&$.key.toLowerCase()==="a")$.preventDefault(),De(se.items.map(he=>he.path));else if($.key==="Escape"){if(se.selectedPaths.length){$.preventDefault(),De([]);return}se.mobileSelectMode&&($.preventDefault(),j(!1))}else if($.key==="/"){$.preventDefault();const he=document.querySelector(".toolbar-right .input");he==null||he.focus()}}}};return window.addEventListener("keydown",P),()=>window.removeEventListener("keydown",P)},[th,De]);const nh=u.useMemo(()=>nS({viewportWidth:z,leftOpen:E,rightOpen:L,leftWidth:$e,rightWidth:Pe}),[z,E,L,$e,Pe]),Ix=E?`${nh.leftWidth}px`:"0px",_x=L?`${nh.rightWidth}px`:"0px";return a.jsxs("div",{className:"app-shell grid h-full grid-cols-[var(--left)_1fr_var(--right)]",ref:J,style:{"--left":Ix,"--right":_x},children:[a.jsx(iS,{rootRef:Y,onSearch:r,viewerActive:!!Qe,onBack:Vr,zoomPercent:Qe?f:void 0,onZoomPercentChange:P=>d(P),currentLabel:Sx,itemCount:xu,totalCount:wu,sortSpec:x.sort,metricKeys:En,onSortChange:wx,sortDisabled:nt,filterCount:Es,onOpenFilters:xx,starFilters:ce,onToggleStar:yx,onClearStars:be,onClearFilters:gt,starCounts:hu,viewMode:m,onViewMode:v,gridItemSize:g,onGridItemSize:b,leftOpen:E,rightOpen:L,onToggleLeft:()=>O(P=>!P),onToggleRight:()=>A(P=>!P),onPrevImage:()=>hn(-1),onNextImage:()=>hn(1),canPrevImage:Ci,canNextImage:sr,searchDisabled:nt,searchPlaceholder:nt?"Exit similarity to search":void 0,onUploadClick:Mx,uploadBusy:bx,uploadDisabled:rt,multiSelectMode:N,selectedCount:Te.length,onToggleMultiSelectMode:ol?()=>j(P=>!P):void 0,syncIndicator:{state:yu,presence:Cs,syncLabel:pu,connectionLabel:nl,lastEditedLabel:cu,hasEdits:uu,localTypingActive:Se,recentTouches:du}}),a.jsx("input",{ref:V,type:"file",multiple:!0,accept:"image/*",className:"sr-only",onChange:Rx}),E&&a.jsx(Kk,{leftTool:B,onToolChange:T,compareEnabled:su,compareActive:rt,onOpenCompare:Jo,views:R,activeViewId:_,onActivateView:P=>{var se;F(P.id);const $=Ld((se=P.view)==null?void 0:se.filters)??{and:[]};w({...P.view,filters:$}),bu(P.pool.path)},onSaveView:Lx,current:e,data:Ce,onOpenFolder:P=>{F(null),bu(P)},onOpenFolderActions:eh,onPullRefreshFolders:fu,onContextMenu:(P,$)=>{P.preventDefault(),eh($,{x:P.clientX,y:P.clientY})},countVersion:W,items:ou,filteredItems:D,metricKeys:En,selectedItems:Br,selectedMetric:x.selectedMetric,onSelectMetric:P=>w($=>({...$,selectedMetric:P})),filters:x.filters,onChangeRange:Su,onChangeFilters:ke,onResize:Fe}),a.jsxs("div",{className:"grid-shell col-start-2 row-start-2 relative overflow-hidden flex flex-col",ref:ne,children:[a.jsx("div",{"aria-live":"polite",className:"sr-only",children:Te.length?`${Te.length} selected`:""}),a.jsx(Yk,{persistenceEnabled:Ni,offViewSummary:ks,canRevealOffView:Ti,onRevealOffView:gx,onClearOffView:Mi,browserZoomPercent:h}),qf&&a.jsx("div",{className:"border-b border-border bg-panel px-3 py-2",children:a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",children:qf})}),o&&a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"font-semibold",children:"Similarity mode"}),a.jsxs("span",{className:"text-muted",children:["Embedding: ",o.embedding]}),Li&&a.jsxs("span",{className:"text-muted",children:["Query: ",Li]}),G&&a.jsxs("span",{className:"text-muted",children:["Results: ",G]}),a.jsxs("span",{className:"text-muted",children:["Top K: ",o.topK]}),o.minScore!=null&&a.jsxs("span",{className:"text-muted",children:["Min score: ",o.minScore]})]}),a.jsx("button",{className:"btn btn-sm",onClick:An,children:"Exit similarity"})]})}),Kf.length>0&&a.jsx("div",{className:"sticky top-0 z-10 px-3 py-2 bg-panel border-b border-border",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Filters"}),Kf.map(P=>a.jsxs("span",{className:"filter-chip",children:[a.jsx("span",{className:"truncate max-w-[240px]",title:P.label,children:P.label}),a.jsx("button",{className:"filter-chip-remove","aria-label":`Clear filter ${P.label}`,onClick:P.onRemove,children:""})]},P.id)),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:gt,children:"Clear all"})]})}),!1,a.jsxs("div",{className:"flex-1 min-h-0 relative",children:[a.jsx(gb,{items:D,selected:Te,restoreToSelectionToken:fn,multiSelectMode:ol&&N,onSelectionChange:De,onOpenViewer:P=>{Ur(P),iu(P),De([P])},highlight:At?tn:"",recentlyUpdated:ji,onVisiblePathsChange:rl,suppressSelectionHighlight:Go,viewMode:m,targetCellSize:g,onContextMenuItem:(P,$)=>{P.preventDefault(),Zf($,{x:P.clientX,y:P.clientY})},onOpenItemActions:Zf,scrollRef:ee,hideScrollbar:el}),el&&bs&&a.jsx(xb,{items:D,metricKey:bs,scrollRef:ee,sortDir:x.sort.dir})]})]}),L&&a.jsx(OC,{path:Te[0]??null,selectedPaths:Te,items:D,compareActive:rt,compareA:Ko,compareB:Yo,sortSpec:x.sort,onResize:dt,onStarChanged:(P,$)=>{X(se=>{const he={...se};for(const Le of P)he[Le]=$;return he})},onFindSimilar:()=>i(!0),embeddingsAvailable:rr,embeddingsLoading:Fn,onLocalTypingChange:Oe}),a.jsx(AC,{open:s,embeddings:zr,rejected:$r,selectedPath:Te[0]??null,embeddingsLoading:Fn,embeddingsError:Rt,onClose:()=>i(!1),onSearch:vx}),Qe&&a.jsx(Ib,{path:Qe,onClose:Vr,onZoomChange:P=>p(Math.round(P)),requestedZoomPercent:c,onZoomRequestConsumed:()=>d(null),canPrev:Ci,canNext:sr,onNavigate:hn}),rt&&a.jsx($b,{aItem:Ko,bItem:Yo,index:bi,total:Ho.length,canPrev:Xo,canNext:qo,onNavigate:Ss,onClose:ws}),Gf&&a.jsx(iE,{paths:Gf.paths,defaultDestination:e,destinations:kx,loadingDestinations:Ex,onClose:jx,onSubmit:Tx}),Cx&&a.jsx("div",{className:"toolbar-offset fixed inset-0 left-[var(--left)] right-[var(--right)] bg-accent/10 border-2 border-dashed border-accent text-text flex items-center justify-center text-lg z-overlay pointer-events-none",children:"Drop images to upload"}),Jf&&a.jsx(cE,{ctx:Jf,current:e,items:D,setCtx:Nx,onRefetch:ve,onOpenMoveDialog:Px,onRefreshFolder:Pi})]})}const XE=new I1({defaultOptions:{queries:{staleTime:1e4,gcTime:5*6e4,retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),1e4),refetchOnWindowFocus:!1,refetchOnReconnect:"always"},mutations:{retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),5e3)}}});function qE(){return a.jsx(_1,{client:XE,children:a.jsx(YE,{})})}hy(document.getElementById("root")).render(a.jsx(qE,{}));
