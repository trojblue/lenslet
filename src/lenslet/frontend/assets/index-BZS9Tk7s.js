var N0=Object.defineProperty;var Ah=e=>{throw TypeError(e)};var j0=(e,t,n)=>t in e?N0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ot=(e,t,n)=>j0(e,typeof t!="symbol"?t+"":t,n),Xu=(e,t,n)=>t.has(e)||Ah("Cannot "+n);var b=(e,t,n)=>(Xu(e,t,"read from private field"),n?n.call(e):t.get(e)),pe=(e,t,n)=>t.has(e)?Ah("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),re=(e,t,n,r)=>(Xu(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),be=(e,t,n)=>(Xu(e,t,"access private method"),n);var Rl=(e,t,n,r)=>({set _(s){re(e,t,s,n)},get _(){return b(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function M0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Og={exports:{}},ru={},Ag={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ll=Symbol.for("react.element"),R0=Symbol.for("react.portal"),P0=Symbol.for("react.fragment"),T0=Symbol.for("react.strict_mode"),L0=Symbol.for("react.profiler"),_0=Symbol.for("react.provider"),I0=Symbol.for("react.context"),F0=Symbol.for("react.forward_ref"),O0=Symbol.for("react.suspense"),A0=Symbol.for("react.memo"),D0=Symbol.for("react.lazy"),Dh=Symbol.iterator;function z0(e){return e===null||typeof e!="object"?null:(e=Dh&&e[Dh]||e["@@iterator"],typeof e=="function"?e:null)}var Dg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zg=Object.assign,$g={};function Wi(e,t,n){this.props=e,this.context=t,this.refs=$g,this.updater=n||Dg}Wi.prototype.isReactComponent={};Wi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Wi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Bg(){}Bg.prototype=Wi.prototype;function af(e,t,n){this.props=e,this.context=t,this.refs=$g,this.updater=n||Dg}var uf=af.prototype=new Bg;uf.constructor=af;zg(uf,Wi.prototype);uf.isPureReactComponent=!0;var zh=Array.isArray,Ug=Object.prototype.hasOwnProperty,cf={current:null},Vg={key:!0,ref:!0,__self:!0,__source:!0};function Hg(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Ug.call(t,r)&&!Vg.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ll,type:e,key:i,ref:o,props:s,_owner:cf.current}}function $0(e,t){return{$$typeof:ll,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function df(e){return typeof e=="object"&&e!==null&&e.$$typeof===ll}function B0(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var $h=/\/+/g;function qu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?B0(""+e.key):t.toString(36)}function na(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ll:case R0:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+qu(o,0):r,zh(s)?(n="",e!=null&&(n=e.replace($h,"$&/")+"/"),na(s,t,n,"",function(d){return d})):s!=null&&(df(s)&&(s=$0(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace($h,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",zh(e))for(var l=0;l<e.length;l++){i=e[l];var u=r+qu(i,l);o+=na(i,t,n,u,s)}else if(u=z0(e),typeof u=="function")for(e=u.call(e),l=0;!(i=e.next()).done;)i=i.value,u=r+qu(i,l++),o+=na(i,t,n,u,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Pl(e,t,n){if(e==null)return e;var r=[],s=0;return na(e,r,"","",function(i){return t.call(n,i,s++)}),r}function U0(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var $t={current:null},ra={transition:null},V0={ReactCurrentDispatcher:$t,ReactCurrentBatchConfig:ra,ReactCurrentOwner:cf};function Wg(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:Pl,forEach:function(e,t,n){Pl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Pl(e,function(){t++}),t},toArray:function(e){return Pl(e,function(t){return t})||[]},only:function(e){if(!df(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ke.Component=Wi;ke.Fragment=P0;ke.Profiler=L0;ke.PureComponent=af;ke.StrictMode=T0;ke.Suspense=O0;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V0;ke.act=Wg;ke.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=zg({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=cf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)Ug.call(t,u)&&!Vg.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:ll,type:e.type,key:s,ref:i,props:r,_owner:o}};ke.createContext=function(e){return e={$$typeof:I0,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:_0,_context:e},e.Consumer=e};ke.createElement=Hg;ke.createFactory=function(e){var t=Hg.bind(null,e);return t.type=e,t};ke.createRef=function(){return{current:null}};ke.forwardRef=function(e){return{$$typeof:F0,render:e}};ke.isValidElement=df;ke.lazy=function(e){return{$$typeof:D0,_payload:{_status:-1,_result:e},_init:U0}};ke.memo=function(e,t){return{$$typeof:A0,type:e,compare:t===void 0?null:t}};ke.startTransition=function(e){var t=ra.transition;ra.transition={};try{e()}finally{ra.transition=t}};ke.unstable_act=Wg;ke.useCallback=function(e,t){return $t.current.useCallback(e,t)};ke.useContext=function(e){return $t.current.useContext(e)};ke.useDebugValue=function(){};ke.useDeferredValue=function(e){return $t.current.useDeferredValue(e)};ke.useEffect=function(e,t){return $t.current.useEffect(e,t)};ke.useId=function(){return $t.current.useId()};ke.useImperativeHandle=function(e,t,n){return $t.current.useImperativeHandle(e,t,n)};ke.useInsertionEffect=function(e,t){return $t.current.useInsertionEffect(e,t)};ke.useLayoutEffect=function(e,t){return $t.current.useLayoutEffect(e,t)};ke.useMemo=function(e,t){return $t.current.useMemo(e,t)};ke.useReducer=function(e,t,n){return $t.current.useReducer(e,t,n)};ke.useRef=function(e){return $t.current.useRef(e)};ke.useState=function(e){return $t.current.useState(e)};ke.useSyncExternalStore=function(e,t,n){return $t.current.useSyncExternalStore(e,t,n)};ke.useTransition=function(){return $t.current.useTransition()};ke.version="18.3.1";Ag.exports=ke;var c=Ag.exports;const Bh=M0(c);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H0=c,W0=Symbol.for("react.element"),Q0=Symbol.for("react.fragment"),K0=Object.prototype.hasOwnProperty,Y0=H0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,X0={key:!0,ref:!0,__self:!0,__source:!0};function Qg(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)K0.call(t,r)&&!X0.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:W0,type:e,key:i,ref:o,props:s,_owner:Y0.current}}ru.Fragment=Q0;ru.jsx=Qg;ru.jsxs=Qg;Og.exports=ru;var a=Og.exports,Kg={exports:{}},an={},Yg={exports:{}},Xg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,D){var V=P.length;P.push(D);e:for(;0<V;){var ee=V-1>>>1,se=P[ee];if(0<s(se,D))P[ee]=D,P[V]=se,V=ee;else break e}}function n(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var D=P[0],V=P.pop();if(V!==D){P[0]=V;e:for(var ee=0,se=P.length,I=se>>>1;ee<I;){var U=2*(ee+1)-1,Y=P[U],Z=U+1,q=P[Z];if(0>s(Y,V))Z<se&&0>s(q,Y)?(P[ee]=q,P[Z]=V,ee=Z):(P[ee]=Y,P[U]=V,ee=U);else if(Z<se&&0>s(q,V))P[ee]=q,P[Z]=V,ee=Z;else break e}}return D}function s(P,D){var V=P.sortIndex-D.sortIndex;return V!==0?V:P.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],d=[],f=1,h=null,p=3,S=!1,w=!1,E=!1,j=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(P){for(var D=n(d);D!==null;){if(D.callback===null)r(d);else if(D.startTime<=P)r(d),D.sortIndex=D.expirationTime,t(u,D);else break;D=n(d)}}function y(P){if(E=!1,x(P),!w)if(n(u)!==null)w=!0,A(k);else{var D=n(d);D!==null&&_(y,D.startTime-P)}}function k(P,D){w=!1,E&&(E=!1,v(N),N=-1),S=!0;var V=p;try{for(x(D),h=n(u);h!==null&&(!(h.expirationTime>D)||P&&!X());){var ee=h.callback;if(typeof ee=="function"){h.callback=null,p=h.priorityLevel;var se=ee(h.expirationTime<=D);D=e.unstable_now(),typeof se=="function"?h.callback=se:h===n(u)&&r(u),x(D)}else r(u);h=n(u)}if(h!==null)var I=!0;else{var U=n(d);U!==null&&_(y,U.startTime-D),I=!1}return I}finally{h=null,p=V,S=!1}}var R=!1,M=null,N=-1,O=5,T=-1;function X(){return!(e.unstable_now()-T<O)}function J(){if(M!==null){var P=e.unstable_now();T=P;var D=!0;try{D=M(!0,P)}finally{D?$():(R=!1,M=null)}}else R=!1}var $;if(typeof m=="function")$=function(){m(J)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,Q=oe.port2;oe.port1.onmessage=J,$=function(){Q.postMessage(null)}}else $=function(){j(J,0)};function A(P){M=P,R||(R=!0,$())}function _(P,D){N=j(function(){P(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){w||S||(w=!0,A(k))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(P){switch(p){case 1:case 2:case 3:var D=3;break;default:D=p}var V=p;p=D;try{return P()}finally{p=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,D){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var V=p;p=P;try{return D()}finally{p=V}},e.unstable_scheduleCallback=function(P,D,V){var ee=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?ee+V:ee):V=ee,P){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=V+se,P={id:f++,callback:D,priorityLevel:P,startTime:V,expirationTime:se,sortIndex:-1},V>ee?(P.sortIndex=V,t(d,P),n(u)===null&&P===n(d)&&(E?(v(N),N=-1):E=!0,_(y,V-ee))):(P.sortIndex=se,t(u,P),w||S||(w=!0,A(k))),P},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(P){var D=p;return function(){var V=p;p=D;try{return P.apply(this,arguments)}finally{p=V}}}})(Xg);Yg.exports=Xg;var q0=Yg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G0=c,ln=q0;function W(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var qg=new Set,Fo={};function Hs(e,t){Ai(e,t),Ai(e+"Capture",t)}function Ai(e,t){for(Fo[e]=t,e=0;e<t.length;e++)qg.add(t[e])}var br=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dc=Object.prototype.hasOwnProperty,J0=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Uh={},Vh={};function Z0(e){return Dc.call(Vh,e)?!0:Dc.call(Uh,e)?!1:J0.test(e)?Vh[e]=!0:(Uh[e]=!0,!1)}function ew(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function tw(e,t,n,r){if(t===null||typeof t>"u"||ew(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Bt(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){wt[e]=new Bt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];wt[t]=new Bt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){wt[e]=new Bt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){wt[e]=new Bt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){wt[e]=new Bt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){wt[e]=new Bt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){wt[e]=new Bt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){wt[e]=new Bt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){wt[e]=new Bt(e,5,!1,e.toLowerCase(),null,!1,!1)});var ff=/[\-:]([a-z])/g;function hf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ff,hf);wt[t]=new Bt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ff,hf);wt[t]=new Bt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ff,hf);wt[t]=new Bt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){wt[e]=new Bt(e,1,!1,e.toLowerCase(),null,!1,!1)});wt.xlinkHref=new Bt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){wt[e]=new Bt(e,1,!1,e.toLowerCase(),null,!0,!0)});function pf(e,t,n,r){var s=wt.hasOwnProperty(t)?wt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(tw(t,n,s,r)&&(n=null),r||s===null?Z0(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Nr=G0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Tl=Symbol.for("react.element"),ri=Symbol.for("react.portal"),si=Symbol.for("react.fragment"),mf=Symbol.for("react.strict_mode"),zc=Symbol.for("react.profiler"),Gg=Symbol.for("react.provider"),Jg=Symbol.for("react.context"),gf=Symbol.for("react.forward_ref"),$c=Symbol.for("react.suspense"),Bc=Symbol.for("react.suspense_list"),vf=Symbol.for("react.memo"),Fr=Symbol.for("react.lazy"),Zg=Symbol.for("react.offscreen"),Hh=Symbol.iterator;function so(e){return e===null||typeof e!="object"?null:(e=Hh&&e[Hh]||e["@@iterator"],typeof e=="function"?e:null)}var He=Object.assign,Gu;function yo(e){if(Gu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Gu=t&&t[1]||""}return`
`+Gu+e}var Ju=!1;function Zu(e,t){if(!e||Ju)return"";Ju=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=l);break}}}finally{Ju=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?yo(e):""}function nw(e){switch(e.tag){case 5:return yo(e.type);case 16:return yo("Lazy");case 13:return yo("Suspense");case 19:return yo("SuspenseList");case 0:case 2:case 15:return e=Zu(e.type,!1),e;case 11:return e=Zu(e.type.render,!1),e;case 1:return e=Zu(e.type,!0),e;default:return""}}function Uc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case si:return"Fragment";case ri:return"Portal";case zc:return"Profiler";case mf:return"StrictMode";case $c:return"Suspense";case Bc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Jg:return(e.displayName||"Context")+".Consumer";case Gg:return(e._context.displayName||"Context")+".Provider";case gf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case vf:return t=e.displayName||null,t!==null?t:Uc(e.type)||"Memo";case Fr:t=e._payload,e=e._init;try{return Uc(e(t))}catch{}}return null}function rw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Uc(t);case 8:return t===mf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function os(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ev(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function sw(e){var t=ev(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ll(e){e._valueTracker||(e._valueTracker=sw(e))}function tv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ev(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ca(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Vc(e,t){var n=t.checked;return He({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Wh(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=os(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function nv(e,t){t=t.checked,t!=null&&pf(e,"checked",t,!1)}function Hc(e,t){nv(e,t);var n=os(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Wc(e,t.type,n):t.hasOwnProperty("defaultValue")&&Wc(e,t.type,os(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Qh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Wc(e,t,n){(t!=="number"||Ca(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var xo=Array.isArray;function mi(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+os(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Qc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(W(91));return He({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Kh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(W(92));if(xo(n)){if(1<n.length)throw Error(W(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:os(n)}}function rv(e,t){var n=os(t.value),r=os(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Yh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function sv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?sv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _l,iv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_l=_l||document.createElement("div"),_l.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_l.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Oo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ko={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},iw=["Webkit","ms","Moz","O"];Object.keys(ko).forEach(function(e){iw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ko[t]=ko[e]})});function ov(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ko.hasOwnProperty(e)&&ko[e]?(""+t).trim():t+"px"}function lv(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ov(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var ow=He({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yc(e,t){if(t){if(ow[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(W(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(W(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(W(61))}if(t.style!=null&&typeof t.style!="object")throw Error(W(62))}}function Xc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qc=null;function yf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Gc=null,gi=null,vi=null;function Xh(e){if(e=cl(e)){if(typeof Gc!="function")throw Error(W(280));var t=e.stateNode;t&&(t=au(t),Gc(e.stateNode,e.type,t))}}function av(e){gi?vi?vi.push(e):vi=[e]:gi=e}function uv(){if(gi){var e=gi,t=vi;if(vi=gi=null,Xh(e),t)for(e=0;e<t.length;e++)Xh(t[e])}}function cv(e,t){return e(t)}function dv(){}var ec=!1;function fv(e,t,n){if(ec)return e(t,n);ec=!0;try{return cv(e,t,n)}finally{ec=!1,(gi!==null||vi!==null)&&(dv(),uv())}}function Ao(e,t){var n=e.stateNode;if(n===null)return null;var r=au(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(W(231,t,typeof n));return n}var Jc=!1;if(br)try{var io={};Object.defineProperty(io,"passive",{get:function(){Jc=!0}}),window.addEventListener("test",io,io),window.removeEventListener("test",io,io)}catch{Jc=!1}function lw(e,t,n,r,s,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(f){this.onError(f)}}var Eo=!1,ka=null,Ea=!1,Zc=null,aw={onError:function(e){Eo=!0,ka=e}};function uw(e,t,n,r,s,i,o,l,u){Eo=!1,ka=null,lw.apply(aw,arguments)}function cw(e,t,n,r,s,i,o,l,u){if(uw.apply(this,arguments),Eo){if(Eo){var d=ka;Eo=!1,ka=null}else throw Error(W(198));Ea||(Ea=!0,Zc=d)}}function Ws(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function hv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function qh(e){if(Ws(e)!==e)throw Error(W(188))}function dw(e){var t=e.alternate;if(!t){if(t=Ws(e),t===null)throw Error(W(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return qh(s),e;if(i===r)return qh(s),t;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?e:t}function pv(e){return e=dw(e),e!==null?mv(e):null}function mv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=mv(e);if(t!==null)return t;e=e.sibling}return null}var gv=ln.unstable_scheduleCallback,Gh=ln.unstable_cancelCallback,fw=ln.unstable_shouldYield,hw=ln.unstable_requestPaint,Ge=ln.unstable_now,pw=ln.unstable_getCurrentPriorityLevel,xf=ln.unstable_ImmediatePriority,vv=ln.unstable_UserBlockingPriority,Na=ln.unstable_NormalPriority,mw=ln.unstable_LowPriority,yv=ln.unstable_IdlePriority,su=null,Zn=null;function gw(e){if(Zn&&typeof Zn.onCommitFiberRoot=="function")try{Zn.onCommitFiberRoot(su,e,void 0,(e.current.flags&128)===128)}catch{}}var An=Math.clz32?Math.clz32:xw,vw=Math.log,yw=Math.LN2;function xw(e){return e>>>=0,e===0?32:31-(vw(e)/yw|0)|0}var Il=64,Fl=4194304;function wo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ja(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=wo(l):(i&=o,i!==0&&(r=wo(i)))}else o=n&~s,o!==0?r=wo(o):i!==0&&(r=wo(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-An(t),s=1<<n,r|=e[n],t&=~s;return r}function ww(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Sw(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-An(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=ww(l,t)):u<=t&&(e.expiredLanes|=l),i&=~l}}function ed(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function xv(){var e=Il;return Il<<=1,!(Il&4194240)&&(Il=64),e}function tc(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function al(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-An(t),e[t]=n}function bw(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-An(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function wf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-An(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Ie=0;function wv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Sv,Sf,bv,Cv,kv,td=!1,Ol=[],qr=null,Gr=null,Jr=null,Do=new Map,zo=new Map,Ar=[],Cw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Jh(e,t){switch(e){case"focusin":case"focusout":qr=null;break;case"dragenter":case"dragleave":Gr=null;break;case"mouseover":case"mouseout":Jr=null;break;case"pointerover":case"pointerout":Do.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zo.delete(t.pointerId)}}function oo(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=cl(t),t!==null&&Sf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function kw(e,t,n,r,s){switch(t){case"focusin":return qr=oo(qr,e,t,n,r,s),!0;case"dragenter":return Gr=oo(Gr,e,t,n,r,s),!0;case"mouseover":return Jr=oo(Jr,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return Do.set(i,oo(Do.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,zo.set(i,oo(zo.get(i)||null,e,t,n,r,s)),!0}return!1}function Ev(e){var t=xs(e.target);if(t!==null){var n=Ws(t);if(n!==null){if(t=n.tag,t===13){if(t=hv(n),t!==null){e.blockedOn=t,kv(e.priority,function(){bv(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function sa(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=nd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);qc=r,n.target.dispatchEvent(r),qc=null}else return t=cl(n),t!==null&&Sf(t),e.blockedOn=n,!1;t.shift()}return!0}function Zh(e,t,n){sa(e)&&n.delete(t)}function Ew(){td=!1,qr!==null&&sa(qr)&&(qr=null),Gr!==null&&sa(Gr)&&(Gr=null),Jr!==null&&sa(Jr)&&(Jr=null),Do.forEach(Zh),zo.forEach(Zh)}function lo(e,t){e.blockedOn===t&&(e.blockedOn=null,td||(td=!0,ln.unstable_scheduleCallback(ln.unstable_NormalPriority,Ew)))}function $o(e){function t(s){return lo(s,e)}if(0<Ol.length){lo(Ol[0],e);for(var n=1;n<Ol.length;n++){var r=Ol[n];r.blockedOn===e&&(r.blockedOn=null)}}for(qr!==null&&lo(qr,e),Gr!==null&&lo(Gr,e),Jr!==null&&lo(Jr,e),Do.forEach(t),zo.forEach(t),n=0;n<Ar.length;n++)r=Ar[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Ar.length&&(n=Ar[0],n.blockedOn===null);)Ev(n),n.blockedOn===null&&Ar.shift()}var yi=Nr.ReactCurrentBatchConfig,Ma=!0;function Nw(e,t,n,r){var s=Ie,i=yi.transition;yi.transition=null;try{Ie=1,bf(e,t,n,r)}finally{Ie=s,yi.transition=i}}function jw(e,t,n,r){var s=Ie,i=yi.transition;yi.transition=null;try{Ie=4,bf(e,t,n,r)}finally{Ie=s,yi.transition=i}}function bf(e,t,n,r){if(Ma){var s=nd(e,t,n,r);if(s===null)dc(e,t,r,Ra,n),Jh(e,r);else if(kw(s,e,t,n,r))r.stopPropagation();else if(Jh(e,r),t&4&&-1<Cw.indexOf(e)){for(;s!==null;){var i=cl(s);if(i!==null&&Sv(i),i=nd(e,t,n,r),i===null&&dc(e,t,r,Ra,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else dc(e,t,r,null,n)}}var Ra=null;function nd(e,t,n,r){if(Ra=null,e=yf(r),e=xs(e),e!==null)if(t=Ws(e),t===null)e=null;else if(n=t.tag,n===13){if(e=hv(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ra=e,null}function Nv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pw()){case xf:return 1;case vv:return 4;case Na:case mw:return 16;case yv:return 536870912;default:return 16}default:return 16}}var Yr=null,Cf=null,ia=null;function jv(){if(ia)return ia;var e,t=Cf,n=t.length,r,s="value"in Yr?Yr.value:Yr.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return ia=s.slice(e,1<r?1-r:void 0)}function oa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Al(){return!0}function ep(){return!1}function un(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Al:ep,this.isPropagationStopped=ep,this}return He(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Al)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Al)},persist:function(){},isPersistent:Al}),t}var Qi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kf=un(Qi),ul=He({},Qi,{view:0,detail:0}),Mw=un(ul),nc,rc,ao,iu=He({},ul,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ef,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ao&&(ao&&e.type==="mousemove"?(nc=e.screenX-ao.screenX,rc=e.screenY-ao.screenY):rc=nc=0,ao=e),nc)},movementY:function(e){return"movementY"in e?e.movementY:rc}}),tp=un(iu),Rw=He({},iu,{dataTransfer:0}),Pw=un(Rw),Tw=He({},ul,{relatedTarget:0}),sc=un(Tw),Lw=He({},Qi,{animationName:0,elapsedTime:0,pseudoElement:0}),_w=un(Lw),Iw=He({},Qi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Fw=un(Iw),Ow=He({},Qi,{data:0}),np=un(Ow),Aw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $w(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=zw[e])?!!t[e]:!1}function Ef(){return $w}var Bw=He({},ul,{key:function(e){if(e.key){var t=Aw[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=oa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Dw[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ef,charCode:function(e){return e.type==="keypress"?oa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?oa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Uw=un(Bw),Vw=He({},iu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rp=un(Vw),Hw=He({},ul,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ef}),Ww=un(Hw),Qw=He({},Qi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Kw=un(Qw),Yw=He({},iu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Xw=un(Yw),qw=[9,13,27,32],Nf=br&&"CompositionEvent"in window,No=null;br&&"documentMode"in document&&(No=document.documentMode);var Gw=br&&"TextEvent"in window&&!No,Mv=br&&(!Nf||No&&8<No&&11>=No),sp=" ",ip=!1;function Rv(e,t){switch(e){case"keyup":return qw.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ii=!1;function Jw(e,t){switch(e){case"compositionend":return Pv(t);case"keypress":return t.which!==32?null:(ip=!0,sp);case"textInput":return e=t.data,e===sp&&ip?null:e;default:return null}}function Zw(e,t){if(ii)return e==="compositionend"||!Nf&&Rv(e,t)?(e=jv(),ia=Cf=Yr=null,ii=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mv&&t.locale!=="ko"?null:t.data;default:return null}}var e1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function op(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!e1[e.type]:t==="textarea"}function Tv(e,t,n,r){av(r),t=Pa(t,"onChange"),0<t.length&&(n=new kf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var jo=null,Bo=null;function t1(e){Uv(e,0)}function ou(e){var t=ai(e);if(tv(t))return e}function n1(e,t){if(e==="change")return t}var Lv=!1;if(br){var ic;if(br){var oc="oninput"in document;if(!oc){var lp=document.createElement("div");lp.setAttribute("oninput","return;"),oc=typeof lp.oninput=="function"}ic=oc}else ic=!1;Lv=ic&&(!document.documentMode||9<document.documentMode)}function ap(){jo&&(jo.detachEvent("onpropertychange",_v),Bo=jo=null)}function _v(e){if(e.propertyName==="value"&&ou(Bo)){var t=[];Tv(t,Bo,e,yf(e)),fv(t1,t)}}function r1(e,t,n){e==="focusin"?(ap(),jo=t,Bo=n,jo.attachEvent("onpropertychange",_v)):e==="focusout"&&ap()}function s1(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ou(Bo)}function i1(e,t){if(e==="click")return ou(t)}function o1(e,t){if(e==="input"||e==="change")return ou(t)}function l1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var zn=typeof Object.is=="function"?Object.is:l1;function Uo(e,t){if(zn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Dc.call(t,s)||!zn(e[s],t[s]))return!1}return!0}function up(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cp(e,t){var n=up(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=up(n)}}function Iv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Iv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Fv(){for(var e=window,t=Ca();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ca(e.document)}return t}function jf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function a1(e){var t=Fv(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Iv(n.ownerDocument.documentElement,n)){if(r!==null&&jf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=cp(n,i);var o=cp(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var u1=br&&"documentMode"in document&&11>=document.documentMode,oi=null,rd=null,Mo=null,sd=!1;function dp(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;sd||oi==null||oi!==Ca(r)||(r=oi,"selectionStart"in r&&jf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Mo&&Uo(Mo,r)||(Mo=r,r=Pa(rd,"onSelect"),0<r.length&&(t=new kf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=oi)))}function Dl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var li={animationend:Dl("Animation","AnimationEnd"),animationiteration:Dl("Animation","AnimationIteration"),animationstart:Dl("Animation","AnimationStart"),transitionend:Dl("Transition","TransitionEnd")},lc={},Ov={};br&&(Ov=document.createElement("div").style,"AnimationEvent"in window||(delete li.animationend.animation,delete li.animationiteration.animation,delete li.animationstart.animation),"TransitionEvent"in window||delete li.transitionend.transition);function lu(e){if(lc[e])return lc[e];if(!li[e])return e;var t=li[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Ov)return lc[e]=t[n];return e}var Av=lu("animationend"),Dv=lu("animationiteration"),zv=lu("animationstart"),$v=lu("transitionend"),Bv=new Map,fp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function as(e,t){Bv.set(e,t),Hs(t,[e])}for(var ac=0;ac<fp.length;ac++){var uc=fp[ac],c1=uc.toLowerCase(),d1=uc[0].toUpperCase()+uc.slice(1);as(c1,"on"+d1)}as(Av,"onAnimationEnd");as(Dv,"onAnimationIteration");as(zv,"onAnimationStart");as("dblclick","onDoubleClick");as("focusin","onFocus");as("focusout","onBlur");as($v,"onTransitionEnd");Ai("onMouseEnter",["mouseout","mouseover"]);Ai("onMouseLeave",["mouseout","mouseover"]);Ai("onPointerEnter",["pointerout","pointerover"]);Ai("onPointerLeave",["pointerout","pointerover"]);Hs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Hs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Hs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Hs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Hs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Hs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var So="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f1=new Set("cancel close invalid load scroll toggle".split(" ").concat(So));function hp(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,cw(r,t,void 0,e),e.currentTarget=null}function Uv(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;hp(s,l,d),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;hp(s,l,d),i=u}}}if(Ea)throw e=Zc,Ea=!1,Zc=null,e}function Ae(e,t){var n=t[ud];n===void 0&&(n=t[ud]=new Set);var r=e+"__bubble";n.has(r)||(Vv(t,e,2,!1),n.add(r))}function cc(e,t,n){var r=0;t&&(r|=4),Vv(n,e,r,t)}var zl="_reactListening"+Math.random().toString(36).slice(2);function Vo(e){if(!e[zl]){e[zl]=!0,qg.forEach(function(n){n!=="selectionchange"&&(f1.has(n)||cc(n,!1,e),cc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[zl]||(t[zl]=!0,cc("selectionchange",!1,t))}}function Vv(e,t,n,r){switch(Nv(t)){case 1:var s=Nw;break;case 4:s=jw;break;default:s=bf}n=s.bind(null,t,n,e),s=void 0,!Jc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function dc(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=xs(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}fv(function(){var d=i,f=yf(n),h=[];e:{var p=Bv.get(e);if(p!==void 0){var S=kf,w=e;switch(e){case"keypress":if(oa(n)===0)break e;case"keydown":case"keyup":S=Uw;break;case"focusin":w="focus",S=sc;break;case"focusout":w="blur",S=sc;break;case"beforeblur":case"afterblur":S=sc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=tp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=Pw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=Ww;break;case Av:case Dv:case zv:S=_w;break;case $v:S=Kw;break;case"scroll":S=Mw;break;case"wheel":S=Xw;break;case"copy":case"cut":case"paste":S=Fw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=rp}var E=(t&4)!==0,j=!E&&e==="scroll",v=E?p!==null?p+"Capture":null:p;E=[];for(var m=d,x;m!==null;){x=m;var y=x.stateNode;if(x.tag===5&&y!==null&&(x=y,v!==null&&(y=Ao(m,v),y!=null&&E.push(Ho(m,y,x)))),j)break;m=m.return}0<E.length&&(p=new S(p,w,null,n,f),h.push({event:p,listeners:E}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",S=e==="mouseout"||e==="pointerout",p&&n!==qc&&(w=n.relatedTarget||n.fromElement)&&(xs(w)||w[Cr]))break e;if((S||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,S?(w=n.relatedTarget||n.toElement,S=d,w=w?xs(w):null,w!==null&&(j=Ws(w),w!==j||w.tag!==5&&w.tag!==6)&&(w=null)):(S=null,w=d),S!==w)){if(E=tp,y="onMouseLeave",v="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(E=rp,y="onPointerLeave",v="onPointerEnter",m="pointer"),j=S==null?p:ai(S),x=w==null?p:ai(w),p=new E(y,m+"leave",S,n,f),p.target=j,p.relatedTarget=x,y=null,xs(f)===d&&(E=new E(v,m+"enter",w,n,f),E.target=x,E.relatedTarget=j,y=E),j=y,S&&w)t:{for(E=S,v=w,m=0,x=E;x;x=Zs(x))m++;for(x=0,y=v;y;y=Zs(y))x++;for(;0<m-x;)E=Zs(E),m--;for(;0<x-m;)v=Zs(v),x--;for(;m--;){if(E===v||v!==null&&E===v.alternate)break t;E=Zs(E),v=Zs(v)}E=null}else E=null;S!==null&&pp(h,p,S,E,!1),w!==null&&j!==null&&pp(h,j,w,E,!0)}}e:{if(p=d?ai(d):window,S=p.nodeName&&p.nodeName.toLowerCase(),S==="select"||S==="input"&&p.type==="file")var k=n1;else if(op(p))if(Lv)k=o1;else{k=s1;var R=r1}else(S=p.nodeName)&&S.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(k=i1);if(k&&(k=k(e,d))){Tv(h,k,n,f);break e}R&&R(e,p,d),e==="focusout"&&(R=p._wrapperState)&&R.controlled&&p.type==="number"&&Wc(p,"number",p.value)}switch(R=d?ai(d):window,e){case"focusin":(op(R)||R.contentEditable==="true")&&(oi=R,rd=d,Mo=null);break;case"focusout":Mo=rd=oi=null;break;case"mousedown":sd=!0;break;case"contextmenu":case"mouseup":case"dragend":sd=!1,dp(h,n,f);break;case"selectionchange":if(u1)break;case"keydown":case"keyup":dp(h,n,f)}var M;if(Nf)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else ii?Rv(e,n)&&(N="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(Mv&&n.locale!=="ko"&&(ii||N!=="onCompositionStart"?N==="onCompositionEnd"&&ii&&(M=jv()):(Yr=f,Cf="value"in Yr?Yr.value:Yr.textContent,ii=!0)),R=Pa(d,N),0<R.length&&(N=new np(N,e,null,n,f),h.push({event:N,listeners:R}),M?N.data=M:(M=Pv(n),M!==null&&(N.data=M)))),(M=Gw?Jw(e,n):Zw(e,n))&&(d=Pa(d,"onBeforeInput"),0<d.length&&(f=new np("onBeforeInput","beforeinput",null,n,f),h.push({event:f,listeners:d}),f.data=M))}Uv(h,t)})}function Ho(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Pa(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Ao(e,n),i!=null&&r.unshift(Ho(e,i,s)),i=Ao(e,t),i!=null&&r.push(Ho(e,i,s))),e=e.return}return r}function Zs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function pp(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,s?(u=Ao(n,i),u!=null&&o.unshift(Ho(n,u,l))):s||(u=Ao(n,i),u!=null&&o.push(Ho(n,u,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var h1=/\r\n?/g,p1=/\u0000|\uFFFD/g;function mp(e){return(typeof e=="string"?e:""+e).replace(h1,`
`).replace(p1,"")}function $l(e,t,n){if(t=mp(t),mp(e)!==t&&n)throw Error(W(425))}function Ta(){}var id=null,od=null;function ld(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ad=typeof setTimeout=="function"?setTimeout:void 0,m1=typeof clearTimeout=="function"?clearTimeout:void 0,gp=typeof Promise=="function"?Promise:void 0,g1=typeof queueMicrotask=="function"?queueMicrotask:typeof gp<"u"?function(e){return gp.resolve(null).then(e).catch(v1)}:ad;function v1(e){setTimeout(function(){throw e})}function fc(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),$o(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);$o(t)}function Zr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function vp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Ki=Math.random().toString(36).slice(2),Jn="__reactFiber$"+Ki,Wo="__reactProps$"+Ki,Cr="__reactContainer$"+Ki,ud="__reactEvents$"+Ki,y1="__reactListeners$"+Ki,x1="__reactHandles$"+Ki;function xs(e){var t=e[Jn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Cr]||n[Jn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=vp(e);e!==null;){if(n=e[Jn])return n;e=vp(e)}return t}e=n,n=e.parentNode}return null}function cl(e){return e=e[Jn]||e[Cr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ai(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(W(33))}function au(e){return e[Wo]||null}var cd=[],ui=-1;function us(e){return{current:e}}function De(e){0>ui||(e.current=cd[ui],cd[ui]=null,ui--)}function Fe(e,t){ui++,cd[ui]=e.current,e.current=t}var ls={},Rt=us(ls),Xt=us(!1),As=ls;function Di(e,t){var n=e.type.contextTypes;if(!n)return ls;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function qt(e){return e=e.childContextTypes,e!=null}function La(){De(Xt),De(Rt)}function yp(e,t,n){if(Rt.current!==ls)throw Error(W(168));Fe(Rt,t),Fe(Xt,n)}function Hv(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(W(108,rw(e)||"Unknown",s));return He({},n,r)}function _a(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ls,As=Rt.current,Fe(Rt,e),Fe(Xt,Xt.current),!0}function xp(e,t,n){var r=e.stateNode;if(!r)throw Error(W(169));n?(e=Hv(e,t,As),r.__reactInternalMemoizedMergedChildContext=e,De(Xt),De(Rt),Fe(Rt,e)):De(Xt),Fe(Xt,n)}var fr=null,uu=!1,hc=!1;function Wv(e){fr===null?fr=[e]:fr.push(e)}function w1(e){uu=!0,Wv(e)}function cs(){if(!hc&&fr!==null){hc=!0;var e=0,t=Ie;try{var n=fr;for(Ie=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}fr=null,uu=!1}catch(s){throw fr!==null&&(fr=fr.slice(e+1)),gv(xf,cs),s}finally{Ie=t,hc=!1}}return null}var ci=[],di=0,Ia=null,Fa=0,xn=[],wn=0,Ds=null,vr=1,yr="";function vs(e,t){ci[di++]=Fa,ci[di++]=Ia,Ia=e,Fa=t}function Qv(e,t,n){xn[wn++]=vr,xn[wn++]=yr,xn[wn++]=Ds,Ds=e;var r=vr;e=yr;var s=32-An(r)-1;r&=~(1<<s),n+=1;var i=32-An(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,vr=1<<32-An(t)+s|n<<s|r,yr=i+e}else vr=1<<i|n<<s|r,yr=e}function Mf(e){e.return!==null&&(vs(e,1),Qv(e,1,0))}function Rf(e){for(;e===Ia;)Ia=ci[--di],ci[di]=null,Fa=ci[--di],ci[di]=null;for(;e===Ds;)Ds=xn[--wn],xn[wn]=null,yr=xn[--wn],xn[wn]=null,vr=xn[--wn],xn[wn]=null}var sn=null,rn=null,$e=!1,On=null;function Kv(e,t){var n=bn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function wp(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,sn=e,rn=Zr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,sn=e,rn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ds!==null?{id:vr,overflow:yr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=bn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,sn=e,rn=null,!0):!1;default:return!1}}function dd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function fd(e){if($e){var t=rn;if(t){var n=t;if(!wp(e,t)){if(dd(e))throw Error(W(418));t=Zr(n.nextSibling);var r=sn;t&&wp(e,t)?Kv(r,n):(e.flags=e.flags&-4097|2,$e=!1,sn=e)}}else{if(dd(e))throw Error(W(418));e.flags=e.flags&-4097|2,$e=!1,sn=e}}}function Sp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;sn=e}function Bl(e){if(e!==sn)return!1;if(!$e)return Sp(e),$e=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ld(e.type,e.memoizedProps)),t&&(t=rn)){if(dd(e))throw Yv(),Error(W(418));for(;t;)Kv(e,t),t=Zr(t.nextSibling)}if(Sp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(W(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){rn=Zr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}rn=null}}else rn=sn?Zr(e.stateNode.nextSibling):null;return!0}function Yv(){for(var e=rn;e;)e=Zr(e.nextSibling)}function zi(){rn=sn=null,$e=!1}function Pf(e){On===null?On=[e]:On.push(e)}var S1=Nr.ReactCurrentBatchConfig;function uo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,e))}return e}function Ul(e,t){throw e=Object.prototype.toString.call(t),Error(W(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function bp(e){var t=e._init;return t(e._payload)}function Xv(e){function t(v,m){if(e){var x=v.deletions;x===null?(v.deletions=[m],v.flags|=16):x.push(m)}}function n(v,m){if(!e)return null;for(;m!==null;)t(v,m),m=m.sibling;return null}function r(v,m){for(v=new Map;m!==null;)m.key!==null?v.set(m.key,m):v.set(m.index,m),m=m.sibling;return v}function s(v,m){return v=rs(v,m),v.index=0,v.sibling=null,v}function i(v,m,x){return v.index=x,e?(x=v.alternate,x!==null?(x=x.index,x<m?(v.flags|=2,m):x):(v.flags|=2,m)):(v.flags|=1048576,m)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,m,x,y){return m===null||m.tag!==6?(m=wc(x,v.mode,y),m.return=v,m):(m=s(m,x),m.return=v,m)}function u(v,m,x,y){var k=x.type;return k===si?f(v,m,x.props.children,y,x.key):m!==null&&(m.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Fr&&bp(k)===m.type)?(y=s(m,x.props),y.ref=uo(v,m,x),y.return=v,y):(y=ha(x.type,x.key,x.props,null,v.mode,y),y.ref=uo(v,m,x),y.return=v,y)}function d(v,m,x,y){return m===null||m.tag!==4||m.stateNode.containerInfo!==x.containerInfo||m.stateNode.implementation!==x.implementation?(m=Sc(x,v.mode,y),m.return=v,m):(m=s(m,x.children||[]),m.return=v,m)}function f(v,m,x,y,k){return m===null||m.tag!==7?(m=Os(x,v.mode,y,k),m.return=v,m):(m=s(m,x),m.return=v,m)}function h(v,m,x){if(typeof m=="string"&&m!==""||typeof m=="number")return m=wc(""+m,v.mode,x),m.return=v,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Tl:return x=ha(m.type,m.key,m.props,null,v.mode,x),x.ref=uo(v,null,m),x.return=v,x;case ri:return m=Sc(m,v.mode,x),m.return=v,m;case Fr:var y=m._init;return h(v,y(m._payload),x)}if(xo(m)||so(m))return m=Os(m,v.mode,x,null),m.return=v,m;Ul(v,m)}return null}function p(v,m,x,y){var k=m!==null?m.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return k!==null?null:l(v,m,""+x,y);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Tl:return x.key===k?u(v,m,x,y):null;case ri:return x.key===k?d(v,m,x,y):null;case Fr:return k=x._init,p(v,m,k(x._payload),y)}if(xo(x)||so(x))return k!==null?null:f(v,m,x,y,null);Ul(v,x)}return null}function S(v,m,x,y,k){if(typeof y=="string"&&y!==""||typeof y=="number")return v=v.get(x)||null,l(m,v,""+y,k);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Tl:return v=v.get(y.key===null?x:y.key)||null,u(m,v,y,k);case ri:return v=v.get(y.key===null?x:y.key)||null,d(m,v,y,k);case Fr:var R=y._init;return S(v,m,x,R(y._payload),k)}if(xo(y)||so(y))return v=v.get(x)||null,f(m,v,y,k,null);Ul(m,y)}return null}function w(v,m,x,y){for(var k=null,R=null,M=m,N=m=0,O=null;M!==null&&N<x.length;N++){M.index>N?(O=M,M=null):O=M.sibling;var T=p(v,M,x[N],y);if(T===null){M===null&&(M=O);break}e&&M&&T.alternate===null&&t(v,M),m=i(T,m,N),R===null?k=T:R.sibling=T,R=T,M=O}if(N===x.length)return n(v,M),$e&&vs(v,N),k;if(M===null){for(;N<x.length;N++)M=h(v,x[N],y),M!==null&&(m=i(M,m,N),R===null?k=M:R.sibling=M,R=M);return $e&&vs(v,N),k}for(M=r(v,M);N<x.length;N++)O=S(M,v,N,x[N],y),O!==null&&(e&&O.alternate!==null&&M.delete(O.key===null?N:O.key),m=i(O,m,N),R===null?k=O:R.sibling=O,R=O);return e&&M.forEach(function(X){return t(v,X)}),$e&&vs(v,N),k}function E(v,m,x,y){var k=so(x);if(typeof k!="function")throw Error(W(150));if(x=k.call(x),x==null)throw Error(W(151));for(var R=k=null,M=m,N=m=0,O=null,T=x.next();M!==null&&!T.done;N++,T=x.next()){M.index>N?(O=M,M=null):O=M.sibling;var X=p(v,M,T.value,y);if(X===null){M===null&&(M=O);break}e&&M&&X.alternate===null&&t(v,M),m=i(X,m,N),R===null?k=X:R.sibling=X,R=X,M=O}if(T.done)return n(v,M),$e&&vs(v,N),k;if(M===null){for(;!T.done;N++,T=x.next())T=h(v,T.value,y),T!==null&&(m=i(T,m,N),R===null?k=T:R.sibling=T,R=T);return $e&&vs(v,N),k}for(M=r(v,M);!T.done;N++,T=x.next())T=S(M,v,N,T.value,y),T!==null&&(e&&T.alternate!==null&&M.delete(T.key===null?N:T.key),m=i(T,m,N),R===null?k=T:R.sibling=T,R=T);return e&&M.forEach(function(J){return t(v,J)}),$e&&vs(v,N),k}function j(v,m,x,y){if(typeof x=="object"&&x!==null&&x.type===si&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Tl:e:{for(var k=x.key,R=m;R!==null;){if(R.key===k){if(k=x.type,k===si){if(R.tag===7){n(v,R.sibling),m=s(R,x.props.children),m.return=v,v=m;break e}}else if(R.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Fr&&bp(k)===R.type){n(v,R.sibling),m=s(R,x.props),m.ref=uo(v,R,x),m.return=v,v=m;break e}n(v,R);break}else t(v,R);R=R.sibling}x.type===si?(m=Os(x.props.children,v.mode,y,x.key),m.return=v,v=m):(y=ha(x.type,x.key,x.props,null,v.mode,y),y.ref=uo(v,m,x),y.return=v,v=y)}return o(v);case ri:e:{for(R=x.key;m!==null;){if(m.key===R)if(m.tag===4&&m.stateNode.containerInfo===x.containerInfo&&m.stateNode.implementation===x.implementation){n(v,m.sibling),m=s(m,x.children||[]),m.return=v,v=m;break e}else{n(v,m);break}else t(v,m);m=m.sibling}m=Sc(x,v.mode,y),m.return=v,v=m}return o(v);case Fr:return R=x._init,j(v,m,R(x._payload),y)}if(xo(x))return w(v,m,x,y);if(so(x))return E(v,m,x,y);Ul(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,m!==null&&m.tag===6?(n(v,m.sibling),m=s(m,x),m.return=v,v=m):(n(v,m),m=wc(x,v.mode,y),m.return=v,v=m),o(v)):n(v,m)}return j}var $i=Xv(!0),qv=Xv(!1),Oa=us(null),Aa=null,fi=null,Tf=null;function Lf(){Tf=fi=Aa=null}function _f(e){var t=Oa.current;De(Oa),e._currentValue=t}function hd(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function xi(e,t){Aa=e,Tf=fi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Yt=!0),e.firstContext=null)}function kn(e){var t=e._currentValue;if(Tf!==e)if(e={context:e,memoizedValue:t,next:null},fi===null){if(Aa===null)throw Error(W(308));fi=e,Aa.dependencies={lanes:0,firstContext:e}}else fi=fi.next=e;return t}var ws=null;function If(e){ws===null?ws=[e]:ws.push(e)}function Gv(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,If(t)):(n.next=s.next,s.next=n),t.interleaved=n,kr(e,r)}function kr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Or=!1;function Ff(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function xr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function es(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,kr(e,n)}return s=r.interleaved,s===null?(t.next=t,If(r)):(t.next=s.next,s.next=t),r.interleaved=t,kr(e,n)}function la(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,wf(e,n)}}function Cp(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Da(e,t,n,r){var s=e.updateQueue;Or=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=u))}if(i!==null){var h=s.baseState;o=0,f=d=u=null,l=i;do{var p=l.lane,S=l.eventTime;if((r&p)===p){f!==null&&(f=f.next={eventTime:S,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var w=e,E=l;switch(p=t,S=n,E.tag){case 1:if(w=E.payload,typeof w=="function"){h=w.call(S,h,p);break e}h=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=E.payload,p=typeof w=="function"?w.call(S,h,p):w,p==null)break e;h=He({},h,p);break e;case 2:Or=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else S={eventTime:S,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=S,u=h):f=f.next=S,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(f===null&&(u=h),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);$s|=o,e.lanes=o,e.memoizedState=h}}function kp(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var dl={},er=us(dl),Qo=us(dl),Ko=us(dl);function Ss(e){if(e===dl)throw Error(W(174));return e}function Of(e,t){switch(Fe(Ko,t),Fe(Qo,e),Fe(er,dl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Kc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Kc(t,e)}De(er),Fe(er,t)}function Bi(){De(er),De(Qo),De(Ko)}function Zv(e){Ss(Ko.current);var t=Ss(er.current),n=Kc(t,e.type);t!==n&&(Fe(Qo,e),Fe(er,n))}function Af(e){Qo.current===e&&(De(er),De(Qo))}var Ue=us(0);function za(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var pc=[];function Df(){for(var e=0;e<pc.length;e++)pc[e]._workInProgressVersionPrimary=null;pc.length=0}var aa=Nr.ReactCurrentDispatcher,mc=Nr.ReactCurrentBatchConfig,zs=0,Ve=null,lt=null,ft=null,$a=!1,Ro=!1,Yo=0,b1=0;function Et(){throw Error(W(321))}function zf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!zn(e[n],t[n]))return!1;return!0}function $f(e,t,n,r,s,i){if(zs=i,Ve=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,aa.current=e===null||e.memoizedState===null?N1:j1,e=n(r,s),Ro){i=0;do{if(Ro=!1,Yo=0,25<=i)throw Error(W(301));i+=1,ft=lt=null,t.updateQueue=null,aa.current=M1,e=n(r,s)}while(Ro)}if(aa.current=Ba,t=lt!==null&&lt.next!==null,zs=0,ft=lt=Ve=null,$a=!1,t)throw Error(W(300));return e}function Bf(){var e=Yo!==0;return Yo=0,e}function Yn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ft===null?Ve.memoizedState=ft=e:ft=ft.next=e,ft}function En(){if(lt===null){var e=Ve.alternate;e=e!==null?e.memoizedState:null}else e=lt.next;var t=ft===null?Ve.memoizedState:ft.next;if(t!==null)ft=t,lt=e;else{if(e===null)throw Error(W(310));lt=e,e={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},ft===null?Ve.memoizedState=ft=e:ft=ft.next=e}return ft}function Xo(e,t){return typeof t=="function"?t(e):t}function gc(e){var t=En(),n=t.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=e;var r=lt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,d=i;do{var f=d.lane;if((zs&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=h,o=r):u=u.next=h,Ve.lanes|=f,$s|=f}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=l,zn(r,t.memoizedState)||(Yt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Ve.lanes|=i,$s|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function vc(e){var t=En(),n=t.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);zn(i,t.memoizedState)||(Yt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function ey(){}function ty(e,t){var n=Ve,r=En(),s=t(),i=!zn(r.memoizedState,s);if(i&&(r.memoizedState=s,Yt=!0),r=r.queue,Uf(sy.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||ft!==null&&ft.memoizedState.tag&1){if(n.flags|=2048,qo(9,ry.bind(null,n,r,s,t),void 0,null),ht===null)throw Error(W(349));zs&30||ny(n,t,s)}return s}function ny(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ve.updateQueue,t===null?(t={lastEffect:null,stores:null},Ve.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function ry(e,t,n,r){t.value=n,t.getSnapshot=r,iy(t)&&oy(e)}function sy(e,t,n){return n(function(){iy(t)&&oy(e)})}function iy(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!zn(e,n)}catch{return!0}}function oy(e){var t=kr(e,1);t!==null&&Dn(t,e,1,-1)}function Ep(e){var t=Yn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xo,lastRenderedState:e},t.queue=e,e=e.dispatch=E1.bind(null,Ve,e),[t.memoizedState,e]}function qo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ve.updateQueue,t===null?(t={lastEffect:null,stores:null},Ve.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function ly(){return En().memoizedState}function ua(e,t,n,r){var s=Yn();Ve.flags|=e,s.memoizedState=qo(1|t,n,void 0,r===void 0?null:r)}function cu(e,t,n,r){var s=En();r=r===void 0?null:r;var i=void 0;if(lt!==null){var o=lt.memoizedState;if(i=o.destroy,r!==null&&zf(r,o.deps)){s.memoizedState=qo(t,n,i,r);return}}Ve.flags|=e,s.memoizedState=qo(1|t,n,i,r)}function Np(e,t){return ua(8390656,8,e,t)}function Uf(e,t){return cu(2048,8,e,t)}function ay(e,t){return cu(4,2,e,t)}function uy(e,t){return cu(4,4,e,t)}function cy(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function dy(e,t,n){return n=n!=null?n.concat([e]):null,cu(4,4,cy.bind(null,t,e),n)}function Vf(){}function fy(e,t){var n=En();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&zf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function hy(e,t){var n=En();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&zf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function py(e,t,n){return zs&21?(zn(n,t)||(n=xv(),Ve.lanes|=n,$s|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Yt=!0),e.memoizedState=n)}function C1(e,t){var n=Ie;Ie=n!==0&&4>n?n:4,e(!0);var r=mc.transition;mc.transition={};try{e(!1),t()}finally{Ie=n,mc.transition=r}}function my(){return En().memoizedState}function k1(e,t,n){var r=ns(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},gy(e))vy(t,n);else if(n=Gv(e,t,n,r),n!==null){var s=zt();Dn(n,e,r,s),yy(n,t,r)}}function E1(e,t,n){var r=ns(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(gy(e))vy(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,zn(l,o)){var u=t.interleaved;u===null?(s.next=s,If(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}n=Gv(e,t,s,r),n!==null&&(s=zt(),Dn(n,e,r,s),yy(n,t,r))}}function gy(e){var t=e.alternate;return e===Ve||t!==null&&t===Ve}function vy(e,t){Ro=$a=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function yy(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,wf(e,n)}}var Ba={readContext:kn,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useInsertionEffect:Et,useLayoutEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useMutableSource:Et,useSyncExternalStore:Et,useId:Et,unstable_isNewReconciler:!1},N1={readContext:kn,useCallback:function(e,t){return Yn().memoizedState=[e,t===void 0?null:t],e},useContext:kn,useEffect:Np,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ua(4194308,4,cy.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ua(4194308,4,e,t)},useInsertionEffect:function(e,t){return ua(4,2,e,t)},useMemo:function(e,t){var n=Yn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Yn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=k1.bind(null,Ve,e),[r.memoizedState,e]},useRef:function(e){var t=Yn();return e={current:e},t.memoizedState=e},useState:Ep,useDebugValue:Vf,useDeferredValue:function(e){return Yn().memoizedState=e},useTransition:function(){var e=Ep(!1),t=e[0];return e=C1.bind(null,e[1]),Yn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ve,s=Yn();if($e){if(n===void 0)throw Error(W(407));n=n()}else{if(n=t(),ht===null)throw Error(W(349));zs&30||ny(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Np(sy.bind(null,r,i,e),[e]),r.flags|=2048,qo(9,ry.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Yn(),t=ht.identifierPrefix;if($e){var n=yr,r=vr;n=(r&~(1<<32-An(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Yo++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=b1++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},j1={readContext:kn,useCallback:fy,useContext:kn,useEffect:Uf,useImperativeHandle:dy,useInsertionEffect:ay,useLayoutEffect:uy,useMemo:hy,useReducer:gc,useRef:ly,useState:function(){return gc(Xo)},useDebugValue:Vf,useDeferredValue:function(e){var t=En();return py(t,lt.memoizedState,e)},useTransition:function(){var e=gc(Xo)[0],t=En().memoizedState;return[e,t]},useMutableSource:ey,useSyncExternalStore:ty,useId:my,unstable_isNewReconciler:!1},M1={readContext:kn,useCallback:fy,useContext:kn,useEffect:Uf,useImperativeHandle:dy,useInsertionEffect:ay,useLayoutEffect:uy,useMemo:hy,useReducer:vc,useRef:ly,useState:function(){return vc(Xo)},useDebugValue:Vf,useDeferredValue:function(e){var t=En();return lt===null?t.memoizedState=e:py(t,lt.memoizedState,e)},useTransition:function(){var e=vc(Xo)[0],t=En().memoizedState;return[e,t]},useMutableSource:ey,useSyncExternalStore:ty,useId:my,unstable_isNewReconciler:!1};function Tn(e,t){if(e&&e.defaultProps){t=He({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function pd(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:He({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var du={isMounted:function(e){return(e=e._reactInternals)?Ws(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=zt(),s=ns(e),i=xr(r,s);i.payload=t,n!=null&&(i.callback=n),t=es(e,i,s),t!==null&&(Dn(t,e,s,r),la(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=zt(),s=ns(e),i=xr(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=es(e,i,s),t!==null&&(Dn(t,e,s,r),la(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=zt(),r=ns(e),s=xr(n,r);s.tag=2,t!=null&&(s.callback=t),t=es(e,s,r),t!==null&&(Dn(t,e,r,n),la(t,e,r))}};function jp(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!Uo(n,r)||!Uo(s,i):!0}function xy(e,t,n){var r=!1,s=ls,i=t.contextType;return typeof i=="object"&&i!==null?i=kn(i):(s=qt(t)?As:Rt.current,r=t.contextTypes,i=(r=r!=null)?Di(e,s):ls),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=du,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Mp(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&du.enqueueReplaceState(t,t.state,null)}function md(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Ff(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=kn(i):(i=qt(t)?As:Rt.current,s.context=Di(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(pd(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&du.enqueueReplaceState(s,s.state,null),Da(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Ui(e,t){try{var n="",r=t;do n+=nw(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function yc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function gd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var R1=typeof WeakMap=="function"?WeakMap:Map;function wy(e,t,n){n=xr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Va||(Va=!0,Nd=r),gd(e,t)},n}function Sy(e,t,n){n=xr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){gd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){gd(e,t),typeof r!="function"&&(ts===null?ts=new Set([this]):ts.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Rp(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new R1;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=V1.bind(null,e,t,n),t.then(e,e))}function Pp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Tp(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=xr(-1,1),t.tag=2,es(n,t,1))),n.lanes|=1),e)}var P1=Nr.ReactCurrentOwner,Yt=!1;function At(e,t,n,r){t.child=e===null?qv(t,null,n,r):$i(t,e.child,n,r)}function Lp(e,t,n,r,s){n=n.render;var i=t.ref;return xi(t,s),r=$f(e,t,n,r,i,s),n=Bf(),e!==null&&!Yt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Er(e,t,s)):($e&&n&&Mf(t),t.flags|=1,At(e,t,r,s),t.child)}function _p(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!Gf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,by(e,t,i,r,s)):(e=ha(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Uo,n(o,r)&&e.ref===t.ref)return Er(e,t,s)}return t.flags|=1,e=rs(i,r),e.ref=t.ref,e.return=t,t.child=e}function by(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(Uo(i,r)&&e.ref===t.ref)if(Yt=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Yt=!0);else return t.lanes=e.lanes,Er(e,t,s)}return vd(e,t,n,r,s)}function Cy(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fe(pi,nn),nn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Fe(pi,nn),nn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Fe(pi,nn),nn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Fe(pi,nn),nn|=r;return At(e,t,s,n),t.child}function ky(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function vd(e,t,n,r,s){var i=qt(n)?As:Rt.current;return i=Di(t,i),xi(t,s),n=$f(e,t,n,r,i,s),r=Bf(),e!==null&&!Yt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Er(e,t,s)):($e&&r&&Mf(t),t.flags|=1,At(e,t,n,s),t.child)}function Ip(e,t,n,r,s){if(qt(n)){var i=!0;_a(t)}else i=!1;if(xi(t,s),t.stateNode===null)ca(e,t),xy(t,n,r),md(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=kn(d):(d=qt(n)?As:Rt.current,d=Di(t,d));var f=n.getDerivedStateFromProps,h=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&Mp(t,o,r,d),Or=!1;var p=t.memoizedState;o.state=p,Da(t,r,o,s),u=t.memoizedState,l!==r||p!==u||Xt.current||Or?(typeof f=="function"&&(pd(t,n,f,r),u=t.memoizedState),(l=Or||jp(t,n,l,r,p,u,d))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Jv(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Tn(t.type,l),o.props=d,h=t.pendingProps,p=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=kn(u):(u=qt(n)?As:Rt.current,u=Di(t,u));var S=n.getDerivedStateFromProps;(f=typeof S=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||p!==u)&&Mp(t,o,r,u),Or=!1,p=t.memoizedState,o.state=p,Da(t,r,o,s);var w=t.memoizedState;l!==h||p!==w||Xt.current||Or?(typeof S=="function"&&(pd(t,n,S,r),w=t.memoizedState),(d=Or||jp(t,n,d,r,p,w,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,w,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,w,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=w),o.props=r,o.state=w,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return yd(e,t,n,r,i,s)}function yd(e,t,n,r,s,i){ky(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&xp(t,n,!1),Er(e,t,i);r=t.stateNode,P1.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=$i(t,e.child,null,i),t.child=$i(t,null,l,i)):At(e,t,l,i),t.memoizedState=r.state,s&&xp(t,n,!0),t.child}function Ey(e){var t=e.stateNode;t.pendingContext?yp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&yp(e,t.context,!1),Of(e,t.containerInfo)}function Fp(e,t,n,r,s){return zi(),Pf(s),t.flags|=256,At(e,t,n,r),t.child}var xd={dehydrated:null,treeContext:null,retryLane:0};function wd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ny(e,t,n){var r=t.pendingProps,s=Ue.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Fe(Ue,s&1),e===null)return fd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=pu(o,r,0,null),e=Os(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=wd(n),t.memoizedState=xd,e):Hf(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return T1(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=rs(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=rs(l,i):(i=Os(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?wd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=xd,r}return i=e.child,e=i.sibling,r=rs(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Hf(e,t){return t=pu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Vl(e,t,n,r){return r!==null&&Pf(r),$i(t,e.child,null,n),e=Hf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function T1(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=yc(Error(W(422))),Vl(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=pu({mode:"visible",children:r.children},s,0,null),i=Os(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&$i(t,e.child,null,o),t.child.memoizedState=wd(o),t.memoizedState=xd,i);if(!(t.mode&1))return Vl(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(W(419)),r=yc(i,r,void 0),Vl(e,t,o,r)}if(l=(o&e.childLanes)!==0,Yt||l){if(r=ht,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,kr(e,s),Dn(r,e,s,-1))}return qf(),r=yc(Error(W(421))),Vl(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=H1.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,rn=Zr(s.nextSibling),sn=t,$e=!0,On=null,e!==null&&(xn[wn++]=vr,xn[wn++]=yr,xn[wn++]=Ds,vr=e.id,yr=e.overflow,Ds=t),t=Hf(t,r.children),t.flags|=4096,t)}function Op(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),hd(e.return,t,n)}function xc(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function jy(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(At(e,t,r.children,n),r=Ue.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Op(e,n,t);else if(e.tag===19)Op(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Fe(Ue,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&za(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),xc(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&za(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}xc(t,!0,n,null,i);break;case"together":xc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ca(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Er(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),$s|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(W(153));if(t.child!==null){for(e=t.child,n=rs(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=rs(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function L1(e,t,n){switch(t.tag){case 3:Ey(t),zi();break;case 5:Zv(t);break;case 1:qt(t.type)&&_a(t);break;case 4:Of(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Fe(Oa,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Fe(Ue,Ue.current&1),t.flags|=128,null):n&t.child.childLanes?Ny(e,t,n):(Fe(Ue,Ue.current&1),e=Er(e,t,n),e!==null?e.sibling:null);Fe(Ue,Ue.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return jy(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Fe(Ue,Ue.current),r)break;return null;case 22:case 23:return t.lanes=0,Cy(e,t,n)}return Er(e,t,n)}var My,Sd,Ry,Py;My=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Sd=function(){};Ry=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Ss(er.current);var i=null;switch(n){case"input":s=Vc(e,s),r=Vc(e,r),i=[];break;case"select":s=He({},s,{value:void 0}),r=He({},r,{value:void 0}),i=[];break;case"textarea":s=Qc(e,s),r=Qc(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ta)}Yc(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Fo.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Fo.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Ae("scroll",e),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Py=function(e,t,n,r){n!==r&&(t.flags|=4)};function co(e,t){if(!$e)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Nt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function _1(e,t,n){var r=t.pendingProps;switch(Rf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(t),null;case 1:return qt(t.type)&&La(),Nt(t),null;case 3:return r=t.stateNode,Bi(),De(Xt),De(Rt),Df(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Bl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,On!==null&&(Rd(On),On=null))),Sd(e,t),Nt(t),null;case 5:Af(t);var s=Ss(Ko.current);if(n=t.type,e!==null&&t.stateNode!=null)Ry(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(W(166));return Nt(t),null}if(e=Ss(er.current),Bl(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Jn]=t,r[Wo]=i,e=(t.mode&1)!==0,n){case"dialog":Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":case"embed":Ae("load",r);break;case"video":case"audio":for(s=0;s<So.length;s++)Ae(So[s],r);break;case"source":Ae("error",r);break;case"img":case"image":case"link":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"input":Wh(r,i),Ae("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ae("invalid",r);break;case"textarea":Kh(r,i),Ae("invalid",r)}Yc(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&$l(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&$l(r.textContent,l,e),s=["children",""+l]):Fo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ae("scroll",r)}switch(n){case"input":Ll(r),Qh(r,i,!0);break;case"textarea":Ll(r),Yh(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ta)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=sv(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Jn]=t,e[Wo]=r,My(e,t,!1,!1),t.stateNode=e;e:{switch(o=Xc(n,r),n){case"dialog":Ae("cancel",e),Ae("close",e),s=r;break;case"iframe":case"object":case"embed":Ae("load",e),s=r;break;case"video":case"audio":for(s=0;s<So.length;s++)Ae(So[s],e);s=r;break;case"source":Ae("error",e),s=r;break;case"img":case"image":case"link":Ae("error",e),Ae("load",e),s=r;break;case"details":Ae("toggle",e),s=r;break;case"input":Wh(e,r),s=Vc(e,r),Ae("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=He({},r,{value:void 0}),Ae("invalid",e);break;case"textarea":Kh(e,r),s=Qc(e,r),Ae("invalid",e);break;default:s=r}Yc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?lv(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&iv(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Oo(e,u):typeof u=="number"&&Oo(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Fo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ae("scroll",e):u!=null&&pf(e,i,u,o))}switch(n){case"input":Ll(e),Qh(e,r,!1);break;case"textarea":Ll(e),Yh(e);break;case"option":r.value!=null&&e.setAttribute("value",""+os(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?mi(e,!!r.multiple,i,!1):r.defaultValue!=null&&mi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Ta)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nt(t),null;case 6:if(e&&t.stateNode!=null)Py(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(W(166));if(n=Ss(Ko.current),Ss(er.current),Bl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Jn]=t,(i=r.nodeValue!==n)&&(e=sn,e!==null))switch(e.tag){case 3:$l(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&$l(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Jn]=t,t.stateNode=r}return Nt(t),null;case 13:if(De(Ue),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if($e&&rn!==null&&t.mode&1&&!(t.flags&128))Yv(),zi(),t.flags|=98560,i=!1;else if(i=Bl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(W(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Jn]=t}else zi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nt(t),i=!1}else On!==null&&(Rd(On),On=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ue.current&1?ut===0&&(ut=3):qf())),t.updateQueue!==null&&(t.flags|=4),Nt(t),null);case 4:return Bi(),Sd(e,t),e===null&&Vo(t.stateNode.containerInfo),Nt(t),null;case 10:return _f(t.type._context),Nt(t),null;case 17:return qt(t.type)&&La(),Nt(t),null;case 19:if(De(Ue),i=t.memoizedState,i===null)return Nt(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)co(i,!1);else{if(ut!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=za(e),o!==null){for(t.flags|=128,co(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Fe(Ue,Ue.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ge()>Vi&&(t.flags|=128,r=!0,co(i,!1),t.lanes=4194304)}else{if(!r)if(e=za(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),co(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!$e)return Nt(t),null}else 2*Ge()-i.renderingStartTime>Vi&&n!==1073741824&&(t.flags|=128,r=!0,co(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ge(),t.sibling=null,n=Ue.current,Fe(Ue,r?n&1|2:n&1),t):(Nt(t),null);case 22:case 23:return Xf(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?nn&1073741824&&(Nt(t),t.subtreeFlags&6&&(t.flags|=8192)):Nt(t),null;case 24:return null;case 25:return null}throw Error(W(156,t.tag))}function I1(e,t){switch(Rf(t),t.tag){case 1:return qt(t.type)&&La(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Bi(),De(Xt),De(Rt),Df(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Af(t),null;case 13:if(De(Ue),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(W(340));zi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return De(Ue),null;case 4:return Bi(),null;case 10:return _f(t.type._context),null;case 22:case 23:return Xf(),null;case 24:return null;default:return null}}var Hl=!1,Mt=!1,F1=typeof WeakSet=="function"?WeakSet:Set,ue=null;function hi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ye(e,t,r)}else n.current=null}function bd(e,t,n){try{n()}catch(r){Ye(e,t,r)}}var Ap=!1;function O1(e,t){if(id=Ma,e=Fv(),jf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,f=0,h=e,p=null;t:for(;;){for(var S;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(u=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(S=h.firstChild)!==null;)p=h,h=S;for(;;){if(h===e)break t;if(p===n&&++d===s&&(l=o),p===i&&++f===r&&(u=o),(S=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=S}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(od={focusedElem:e,selectionRange:n},Ma=!1,ue=t;ue!==null;)if(t=ue,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ue=e;else for(;ue!==null;){t=ue;try{var w=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var E=w.memoizedProps,j=w.memoizedState,v=t.stateNode,m=v.getSnapshotBeforeUpdate(t.elementType===t.type?E:Tn(t.type,E),j);v.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(y){Ye(t,t.return,y)}if(e=t.sibling,e!==null){e.return=t.return,ue=e;break}ue=t.return}return w=Ap,Ap=!1,w}function Po(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&bd(t,n,i)}s=s.next}while(s!==r)}}function fu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Cd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Ty(e){var t=e.alternate;t!==null&&(e.alternate=null,Ty(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Jn],delete t[Wo],delete t[ud],delete t[y1],delete t[x1])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ly(e){return e.tag===5||e.tag===3||e.tag===4}function Dp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ly(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function kd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ta));else if(r!==4&&(e=e.child,e!==null))for(kd(e,t,n),e=e.sibling;e!==null;)kd(e,t,n),e=e.sibling}function Ed(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Ed(e,t,n),e=e.sibling;e!==null;)Ed(e,t,n),e=e.sibling}var yt=null,Fn=!1;function Lr(e,t,n){for(n=n.child;n!==null;)_y(e,t,n),n=n.sibling}function _y(e,t,n){if(Zn&&typeof Zn.onCommitFiberUnmount=="function")try{Zn.onCommitFiberUnmount(su,n)}catch{}switch(n.tag){case 5:Mt||hi(n,t);case 6:var r=yt,s=Fn;yt=null,Lr(e,t,n),yt=r,Fn=s,yt!==null&&(Fn?(e=yt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):yt.removeChild(n.stateNode));break;case 18:yt!==null&&(Fn?(e=yt,n=n.stateNode,e.nodeType===8?fc(e.parentNode,n):e.nodeType===1&&fc(e,n),$o(e)):fc(yt,n.stateNode));break;case 4:r=yt,s=Fn,yt=n.stateNode.containerInfo,Fn=!0,Lr(e,t,n),yt=r,Fn=s;break;case 0:case 11:case 14:case 15:if(!Mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&bd(n,t,o),s=s.next}while(s!==r)}Lr(e,t,n);break;case 1:if(!Mt&&(hi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ye(n,t,l)}Lr(e,t,n);break;case 21:Lr(e,t,n);break;case 22:n.mode&1?(Mt=(r=Mt)||n.memoizedState!==null,Lr(e,t,n),Mt=r):Lr(e,t,n);break;default:Lr(e,t,n)}}function zp(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new F1),t.forEach(function(r){var s=W1.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Rn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:yt=l.stateNode,Fn=!1;break e;case 3:yt=l.stateNode.containerInfo,Fn=!0;break e;case 4:yt=l.stateNode.containerInfo,Fn=!0;break e}l=l.return}if(yt===null)throw Error(W(160));_y(i,o,s),yt=null,Fn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Ye(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Iy(t,e),t=t.sibling}function Iy(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Rn(t,e),Kn(e),r&4){try{Po(3,e,e.return),fu(3,e)}catch(E){Ye(e,e.return,E)}try{Po(5,e,e.return)}catch(E){Ye(e,e.return,E)}}break;case 1:Rn(t,e),Kn(e),r&512&&n!==null&&hi(n,n.return);break;case 5:if(Rn(t,e),Kn(e),r&512&&n!==null&&hi(n,n.return),e.flags&32){var s=e.stateNode;try{Oo(s,"")}catch(E){Ye(e,e.return,E)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&nv(s,i),Xc(l,o);var d=Xc(l,i);for(o=0;o<u.length;o+=2){var f=u[o],h=u[o+1];f==="style"?lv(s,h):f==="dangerouslySetInnerHTML"?iv(s,h):f==="children"?Oo(s,h):pf(s,f,h,d)}switch(l){case"input":Hc(s,i);break;case"textarea":rv(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var S=i.value;S!=null?mi(s,!!i.multiple,S,!1):p!==!!i.multiple&&(i.defaultValue!=null?mi(s,!!i.multiple,i.defaultValue,!0):mi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Wo]=i}catch(E){Ye(e,e.return,E)}}break;case 6:if(Rn(t,e),Kn(e),r&4){if(e.stateNode===null)throw Error(W(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(E){Ye(e,e.return,E)}}break;case 3:if(Rn(t,e),Kn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{$o(t.containerInfo)}catch(E){Ye(e,e.return,E)}break;case 4:Rn(t,e),Kn(e);break;case 13:Rn(t,e),Kn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Kf=Ge())),r&4&&zp(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(Mt=(d=Mt)||f,Rn(t,e),Mt=d):Rn(t,e),Kn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!f&&e.mode&1)for(ue=e,f=e.child;f!==null;){for(h=ue=f;ue!==null;){switch(p=ue,S=p.child,p.tag){case 0:case 11:case 14:case 15:Po(4,p,p.return);break;case 1:hi(p,p.return);var w=p.stateNode;if(typeof w.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,w.props=t.memoizedProps,w.state=t.memoizedState,w.componentWillUnmount()}catch(E){Ye(r,n,E)}}break;case 5:hi(p,p.return);break;case 22:if(p.memoizedState!==null){Bp(h);continue}}S!==null?(S.return=p,ue=S):Bp(h)}f=f.sibling}e:for(f=null,h=e;;){if(h.tag===5){if(f===null){f=h;try{s=h.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,u=h.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=ov("display",o))}catch(E){Ye(e,e.return,E)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(E){Ye(e,e.return,E)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Rn(t,e),Kn(e),r&4&&zp(e);break;case 21:break;default:Rn(t,e),Kn(e)}}function Kn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Ly(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Oo(s,""),r.flags&=-33);var i=Dp(e);Ed(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Dp(e);kd(e,l,o);break;default:throw Error(W(161))}}catch(u){Ye(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function A1(e,t,n){ue=e,Fy(e)}function Fy(e,t,n){for(var r=(e.mode&1)!==0;ue!==null;){var s=ue,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Hl;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||Mt;l=Hl;var d=Mt;if(Hl=o,(Mt=u)&&!d)for(ue=s;ue!==null;)o=ue,u=o.child,o.tag===22&&o.memoizedState!==null?Up(s):u!==null?(u.return=o,ue=u):Up(s);for(;i!==null;)ue=i,Fy(i),i=i.sibling;ue=s,Hl=l,Mt=d}$p(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ue=i):$p(e)}}function $p(e){for(;ue!==null;){var t=ue;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Mt||fu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Mt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Tn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&kp(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}kp(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&$o(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}Mt||t.flags&512&&Cd(t)}catch(p){Ye(t,t.return,p)}}if(t===e){ue=null;break}if(n=t.sibling,n!==null){n.return=t.return,ue=n;break}ue=t.return}}function Bp(e){for(;ue!==null;){var t=ue;if(t===e){ue=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ue=n;break}ue=t.return}}function Up(e){for(;ue!==null;){var t=ue;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{fu(4,t)}catch(u){Ye(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(u){Ye(t,s,u)}}var i=t.return;try{Cd(t)}catch(u){Ye(t,i,u)}break;case 5:var o=t.return;try{Cd(t)}catch(u){Ye(t,o,u)}}}catch(u){Ye(t,t.return,u)}if(t===e){ue=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ue=l;break}ue=t.return}}var D1=Math.ceil,Ua=Nr.ReactCurrentDispatcher,Wf=Nr.ReactCurrentOwner,Cn=Nr.ReactCurrentBatchConfig,Re=0,ht=null,Ze=null,xt=0,nn=0,pi=us(0),ut=0,Go=null,$s=0,hu=0,Qf=0,To=null,Kt=null,Kf=0,Vi=1/0,dr=null,Va=!1,Nd=null,ts=null,Wl=!1,Xr=null,Ha=0,Lo=0,jd=null,da=-1,fa=0;function zt(){return Re&6?Ge():da!==-1?da:da=Ge()}function ns(e){return e.mode&1?Re&2&&xt!==0?xt&-xt:S1.transition!==null?(fa===0&&(fa=xv()),fa):(e=Ie,e!==0||(e=window.event,e=e===void 0?16:Nv(e.type)),e):1}function Dn(e,t,n,r){if(50<Lo)throw Lo=0,jd=null,Error(W(185));al(e,n,r),(!(Re&2)||e!==ht)&&(e===ht&&(!(Re&2)&&(hu|=n),ut===4&&Dr(e,xt)),Gt(e,r),n===1&&Re===0&&!(t.mode&1)&&(Vi=Ge()+500,uu&&cs()))}function Gt(e,t){var n=e.callbackNode;Sw(e,t);var r=ja(e,e===ht?xt:0);if(r===0)n!==null&&Gh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Gh(n),t===1)e.tag===0?w1(Vp.bind(null,e)):Wv(Vp.bind(null,e)),g1(function(){!(Re&6)&&cs()}),n=null;else{switch(wv(r)){case 1:n=xf;break;case 4:n=vv;break;case 16:n=Na;break;case 536870912:n=yv;break;default:n=Na}n=Vy(n,Oy.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Oy(e,t){if(da=-1,fa=0,Re&6)throw Error(W(327));var n=e.callbackNode;if(wi()&&e.callbackNode!==n)return null;var r=ja(e,e===ht?xt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Wa(e,r);else{t=r;var s=Re;Re|=2;var i=Dy();(ht!==e||xt!==t)&&(dr=null,Vi=Ge()+500,Fs(e,t));do try{B1();break}catch(l){Ay(e,l)}while(!0);Lf(),Ua.current=i,Re=s,Ze!==null?t=0:(ht=null,xt=0,t=ut)}if(t!==0){if(t===2&&(s=ed(e),s!==0&&(r=s,t=Md(e,s))),t===1)throw n=Go,Fs(e,0),Dr(e,r),Gt(e,Ge()),n;if(t===6)Dr(e,r);else{if(s=e.current.alternate,!(r&30)&&!z1(s)&&(t=Wa(e,r),t===2&&(i=ed(e),i!==0&&(r=i,t=Md(e,i))),t===1))throw n=Go,Fs(e,0),Dr(e,r),Gt(e,Ge()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(W(345));case 2:ys(e,Kt,dr);break;case 3:if(Dr(e,r),(r&130023424)===r&&(t=Kf+500-Ge(),10<t)){if(ja(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){zt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=ad(ys.bind(null,e,Kt,dr),t);break}ys(e,Kt,dr);break;case 4:if(Dr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-An(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*D1(r/1960))-r,10<r){e.timeoutHandle=ad(ys.bind(null,e,Kt,dr),r);break}ys(e,Kt,dr);break;case 5:ys(e,Kt,dr);break;default:throw Error(W(329))}}}return Gt(e,Ge()),e.callbackNode===n?Oy.bind(null,e):null}function Md(e,t){var n=To;return e.current.memoizedState.isDehydrated&&(Fs(e,t).flags|=256),e=Wa(e,t),e!==2&&(t=Kt,Kt=n,t!==null&&Rd(t)),e}function Rd(e){Kt===null?Kt=e:Kt.push.apply(Kt,e)}function z1(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!zn(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Dr(e,t){for(t&=~Qf,t&=~hu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-An(t),r=1<<n;e[n]=-1,t&=~r}}function Vp(e){if(Re&6)throw Error(W(327));wi();var t=ja(e,0);if(!(t&1))return Gt(e,Ge()),null;var n=Wa(e,t);if(e.tag!==0&&n===2){var r=ed(e);r!==0&&(t=r,n=Md(e,r))}if(n===1)throw n=Go,Fs(e,0),Dr(e,t),Gt(e,Ge()),n;if(n===6)throw Error(W(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ys(e,Kt,dr),Gt(e,Ge()),null}function Yf(e,t){var n=Re;Re|=1;try{return e(t)}finally{Re=n,Re===0&&(Vi=Ge()+500,uu&&cs())}}function Bs(e){Xr!==null&&Xr.tag===0&&!(Re&6)&&wi();var t=Re;Re|=1;var n=Cn.transition,r=Ie;try{if(Cn.transition=null,Ie=1,e)return e()}finally{Ie=r,Cn.transition=n,Re=t,!(Re&6)&&cs()}}function Xf(){nn=pi.current,De(pi)}function Fs(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,m1(n)),Ze!==null)for(n=Ze.return;n!==null;){var r=n;switch(Rf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&La();break;case 3:Bi(),De(Xt),De(Rt),Df();break;case 5:Af(r);break;case 4:Bi();break;case 13:De(Ue);break;case 19:De(Ue);break;case 10:_f(r.type._context);break;case 22:case 23:Xf()}n=n.return}if(ht=e,Ze=e=rs(e.current,null),xt=nn=t,ut=0,Go=null,Qf=hu=$s=0,Kt=To=null,ws!==null){for(t=0;t<ws.length;t++)if(n=ws[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ws=null}return e}function Ay(e,t){do{var n=Ze;try{if(Lf(),aa.current=Ba,$a){for(var r=Ve.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}$a=!1}if(zs=0,ft=lt=Ve=null,Ro=!1,Yo=0,Wf.current=null,n===null||n.return===null){ut=1,Go=t,Ze=null;break}e:{var i=e,o=n.return,l=n,u=t;if(t=xt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=l,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var S=Pp(o);if(S!==null){S.flags&=-257,Tp(S,o,l,i,t),S.mode&1&&Rp(i,d,t),t=S,u=d;var w=t.updateQueue;if(w===null){var E=new Set;E.add(u),t.updateQueue=E}else w.add(u);break e}else{if(!(t&1)){Rp(i,d,t),qf();break e}u=Error(W(426))}}else if($e&&l.mode&1){var j=Pp(o);if(j!==null){!(j.flags&65536)&&(j.flags|=256),Tp(j,o,l,i,t),Pf(Ui(u,l));break e}}i=u=Ui(u,l),ut!==4&&(ut=2),To===null?To=[i]:To.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=wy(i,u,t);Cp(i,v);break e;case 1:l=u;var m=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ts===null||!ts.has(x)))){i.flags|=65536,t&=-t,i.lanes|=t;var y=Sy(i,l,t);Cp(i,y);break e}}i=i.return}while(i!==null)}$y(n)}catch(k){t=k,Ze===n&&n!==null&&(Ze=n=n.return);continue}break}while(!0)}function Dy(){var e=Ua.current;return Ua.current=Ba,e===null?Ba:e}function qf(){(ut===0||ut===3||ut===2)&&(ut=4),ht===null||!($s&268435455)&&!(hu&268435455)||Dr(ht,xt)}function Wa(e,t){var n=Re;Re|=2;var r=Dy();(ht!==e||xt!==t)&&(dr=null,Fs(e,t));do try{$1();break}catch(s){Ay(e,s)}while(!0);if(Lf(),Re=n,Ua.current=r,Ze!==null)throw Error(W(261));return ht=null,xt=0,ut}function $1(){for(;Ze!==null;)zy(Ze)}function B1(){for(;Ze!==null&&!fw();)zy(Ze)}function zy(e){var t=Uy(e.alternate,e,nn);e.memoizedProps=e.pendingProps,t===null?$y(e):Ze=t,Wf.current=null}function $y(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=I1(n,t),n!==null){n.flags&=32767,Ze=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ut=6,Ze=null;return}}else if(n=_1(n,t,nn),n!==null){Ze=n;return}if(t=t.sibling,t!==null){Ze=t;return}Ze=t=e}while(t!==null);ut===0&&(ut=5)}function ys(e,t,n){var r=Ie,s=Cn.transition;try{Cn.transition=null,Ie=1,U1(e,t,n,r)}finally{Cn.transition=s,Ie=r}return null}function U1(e,t,n,r){do wi();while(Xr!==null);if(Re&6)throw Error(W(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(W(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(bw(e,i),e===ht&&(Ze=ht=null,xt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Wl||(Wl=!0,Vy(Na,function(){return wi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Cn.transition,Cn.transition=null;var o=Ie;Ie=1;var l=Re;Re|=4,Wf.current=null,O1(e,n),Iy(n,e),a1(od),Ma=!!id,od=id=null,e.current=n,A1(n),hw(),Re=l,Ie=o,Cn.transition=i}else e.current=n;if(Wl&&(Wl=!1,Xr=e,Ha=s),i=e.pendingLanes,i===0&&(ts=null),gw(n.stateNode),Gt(e,Ge()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Va)throw Va=!1,e=Nd,Nd=null,e;return Ha&1&&e.tag!==0&&wi(),i=e.pendingLanes,i&1?e===jd?Lo++:(Lo=0,jd=e):Lo=0,cs(),null}function wi(){if(Xr!==null){var e=wv(Ha),t=Cn.transition,n=Ie;try{if(Cn.transition=null,Ie=16>e?16:e,Xr===null)var r=!1;else{if(e=Xr,Xr=null,Ha=0,Re&6)throw Error(W(331));var s=Re;for(Re|=4,ue=e.current;ue!==null;){var i=ue,o=i.child;if(ue.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(ue=d;ue!==null;){var f=ue;switch(f.tag){case 0:case 11:case 15:Po(8,f,i)}var h=f.child;if(h!==null)h.return=f,ue=h;else for(;ue!==null;){f=ue;var p=f.sibling,S=f.return;if(Ty(f),f===d){ue=null;break}if(p!==null){p.return=S,ue=p;break}ue=S}}}var w=i.alternate;if(w!==null){var E=w.child;if(E!==null){w.child=null;do{var j=E.sibling;E.sibling=null,E=j}while(E!==null)}}ue=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ue=o;else e:for(;ue!==null;){if(i=ue,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Po(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,ue=v;break e}ue=i.return}}var m=e.current;for(ue=m;ue!==null;){o=ue;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,ue=x;else e:for(o=m;ue!==null;){if(l=ue,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:fu(9,l)}}catch(k){Ye(l,l.return,k)}if(l===o){ue=null;break e}var y=l.sibling;if(y!==null){y.return=l.return,ue=y;break e}ue=l.return}}if(Re=s,cs(),Zn&&typeof Zn.onPostCommitFiberRoot=="function")try{Zn.onPostCommitFiberRoot(su,e)}catch{}r=!0}return r}finally{Ie=n,Cn.transition=t}}return!1}function Hp(e,t,n){t=Ui(n,t),t=wy(e,t,1),e=es(e,t,1),t=zt(),e!==null&&(al(e,1,t),Gt(e,t))}function Ye(e,t,n){if(e.tag===3)Hp(e,e,n);else for(;t!==null;){if(t.tag===3){Hp(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ts===null||!ts.has(r))){e=Ui(n,e),e=Sy(t,e,1),t=es(t,e,1),e=zt(),t!==null&&(al(t,1,e),Gt(t,e));break}}t=t.return}}function V1(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=zt(),e.pingedLanes|=e.suspendedLanes&n,ht===e&&(xt&n)===n&&(ut===4||ut===3&&(xt&130023424)===xt&&500>Ge()-Kf?Fs(e,0):Qf|=n),Gt(e,t)}function By(e,t){t===0&&(e.mode&1?(t=Fl,Fl<<=1,!(Fl&130023424)&&(Fl=4194304)):t=1);var n=zt();e=kr(e,t),e!==null&&(al(e,t,n),Gt(e,n))}function H1(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),By(e,n)}function W1(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(t),By(e,n)}var Uy;Uy=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Xt.current)Yt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Yt=!1,L1(e,t,n);Yt=!!(e.flags&131072)}else Yt=!1,$e&&t.flags&1048576&&Qv(t,Fa,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;ca(e,t),e=t.pendingProps;var s=Di(t,Rt.current);xi(t,n),s=$f(null,t,r,e,s,n);var i=Bf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,qt(r)?(i=!0,_a(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ff(t),s.updater=du,t.stateNode=s,s._reactInternals=t,md(t,r,e,n),t=yd(null,t,r,!0,i,n)):(t.tag=0,$e&&i&&Mf(t),At(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(ca(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=K1(r),e=Tn(r,e),s){case 0:t=vd(null,t,r,e,n);break e;case 1:t=Ip(null,t,r,e,n);break e;case 11:t=Lp(null,t,r,e,n);break e;case 14:t=_p(null,t,r,Tn(r.type,e),n);break e}throw Error(W(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Tn(r,s),vd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Tn(r,s),Ip(e,t,r,s,n);case 3:e:{if(Ey(t),e===null)throw Error(W(387));r=t.pendingProps,i=t.memoizedState,s=i.element,Jv(e,t),Da(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Ui(Error(W(423)),t),t=Fp(e,t,r,n,s);break e}else if(r!==s){s=Ui(Error(W(424)),t),t=Fp(e,t,r,n,s);break e}else for(rn=Zr(t.stateNode.containerInfo.firstChild),sn=t,$e=!0,On=null,n=qv(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(zi(),r===s){t=Er(e,t,n);break e}At(e,t,r,n)}t=t.child}return t;case 5:return Zv(t),e===null&&fd(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,ld(r,s)?o=null:i!==null&&ld(r,i)&&(t.flags|=32),ky(e,t),At(e,t,o,n),t.child;case 6:return e===null&&fd(t),null;case 13:return Ny(e,t,n);case 4:return Of(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=$i(t,null,r,n):At(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Tn(r,s),Lp(e,t,r,s,n);case 7:return At(e,t,t.pendingProps,n),t.child;case 8:return At(e,t,t.pendingProps.children,n),t.child;case 12:return At(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Fe(Oa,r._currentValue),r._currentValue=o,i!==null)if(zn(i.value,o)){if(i.children===s.children&&!Xt.current){t=Er(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=xr(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),hd(i.return,n,t),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),hd(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}At(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,xi(t,n),s=kn(s),r=r(s),t.flags|=1,At(e,t,r,n),t.child;case 14:return r=t.type,s=Tn(r,t.pendingProps),s=Tn(r.type,s),_p(e,t,r,s,n);case 15:return by(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Tn(r,s),ca(e,t),t.tag=1,qt(r)?(e=!0,_a(t)):e=!1,xi(t,n),xy(t,r,s),md(t,r,s,n),yd(null,t,r,!0,e,n);case 19:return jy(e,t,n);case 22:return Cy(e,t,n)}throw Error(W(156,t.tag))};function Vy(e,t){return gv(e,t)}function Q1(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bn(e,t,n,r){return new Q1(e,t,n,r)}function Gf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function K1(e){if(typeof e=="function")return Gf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===gf)return 11;if(e===vf)return 14}return 2}function rs(e,t){var n=e.alternate;return n===null?(n=bn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ha(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")Gf(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case si:return Os(n.children,s,i,t);case mf:o=8,s|=8;break;case zc:return e=bn(12,n,t,s|2),e.elementType=zc,e.lanes=i,e;case $c:return e=bn(13,n,t,s),e.elementType=$c,e.lanes=i,e;case Bc:return e=bn(19,n,t,s),e.elementType=Bc,e.lanes=i,e;case Zg:return pu(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Gg:o=10;break e;case Jg:o=9;break e;case gf:o=11;break e;case vf:o=14;break e;case Fr:o=16,r=null;break e}throw Error(W(130,e==null?e:typeof e,""))}return t=bn(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function Os(e,t,n,r){return e=bn(7,e,r,t),e.lanes=n,e}function pu(e,t,n,r){return e=bn(22,e,r,t),e.elementType=Zg,e.lanes=n,e.stateNode={isHidden:!1},e}function wc(e,t,n){return e=bn(6,e,null,t),e.lanes=n,e}function Sc(e,t,n){return t=bn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Y1(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=tc(0),this.expirationTimes=tc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=tc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Jf(e,t,n,r,s,i,o,l,u){return e=new Y1(e,t,n,l,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=bn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ff(i),e}function X1(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ri,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Hy(e){if(!e)return ls;e=e._reactInternals;e:{if(Ws(e)!==e||e.tag!==1)throw Error(W(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(qt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(W(171))}if(e.tag===1){var n=e.type;if(qt(n))return Hv(e,n,t)}return t}function Wy(e,t,n,r,s,i,o,l,u){return e=Jf(n,r,!0,e,s,i,o,l,u),e.context=Hy(null),n=e.current,r=zt(),s=ns(n),i=xr(r,s),i.callback=t??null,es(n,i,s),e.current.lanes=s,al(e,s,r),Gt(e,r),e}function mu(e,t,n,r){var s=t.current,i=zt(),o=ns(s);return n=Hy(n),t.context===null?t.context=n:t.pendingContext=n,t=xr(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=es(s,t,o),e!==null&&(Dn(e,s,o,i),la(e,s,o)),o}function Qa(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Wp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Zf(e,t){Wp(e,t),(e=e.alternate)&&Wp(e,t)}function q1(){return null}var Qy=typeof reportError=="function"?reportError:function(e){console.error(e)};function eh(e){this._internalRoot=e}gu.prototype.render=eh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(W(409));mu(e,t,null,null)};gu.prototype.unmount=eh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Bs(function(){mu(null,e,null,null)}),t[Cr]=null}};function gu(e){this._internalRoot=e}gu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Cv();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ar.length&&t!==0&&t<Ar[n].priority;n++);Ar.splice(n,0,e),n===0&&Ev(e)}};function th(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function vu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Qp(){}function G1(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Qa(o);i.call(d)}}var o=Wy(t,r,e,0,null,!1,!1,"",Qp);return e._reactRootContainer=o,e[Cr]=o.current,Vo(e.nodeType===8?e.parentNode:e),Bs(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=Qa(u);l.call(d)}}var u=Jf(e,0,!1,null,null,!1,!1,"",Qp);return e._reactRootContainer=u,e[Cr]=u.current,Vo(e.nodeType===8?e.parentNode:e),Bs(function(){mu(t,u,n,r)}),u}function yu(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=Qa(o);l.call(u)}}mu(t,o,e,s)}else o=G1(n,t,e,s,r);return Qa(o)}Sv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=wo(t.pendingLanes);n!==0&&(wf(t,n|1),Gt(t,Ge()),!(Re&6)&&(Vi=Ge()+500,cs()))}break;case 13:Bs(function(){var r=kr(e,1);if(r!==null){var s=zt();Dn(r,e,1,s)}}),Zf(e,1)}};Sf=function(e){if(e.tag===13){var t=kr(e,134217728);if(t!==null){var n=zt();Dn(t,e,134217728,n)}Zf(e,134217728)}};bv=function(e){if(e.tag===13){var t=ns(e),n=kr(e,t);if(n!==null){var r=zt();Dn(n,e,t,r)}Zf(e,t)}};Cv=function(){return Ie};kv=function(e,t){var n=Ie;try{return Ie=e,t()}finally{Ie=n}};Gc=function(e,t,n){switch(t){case"input":if(Hc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=au(r);if(!s)throw Error(W(90));tv(r),Hc(r,s)}}}break;case"textarea":rv(e,n);break;case"select":t=n.value,t!=null&&mi(e,!!n.multiple,t,!1)}};cv=Yf;dv=Bs;var J1={usingClientEntryPoint:!1,Events:[cl,ai,au,av,uv,Yf]},fo={findFiberByHostInstance:xs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Z1={bundleType:fo.bundleType,version:fo.version,rendererPackageName:fo.rendererPackageName,rendererConfig:fo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Nr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=pv(e),e===null?null:e.stateNode},findFiberByHostInstance:fo.findFiberByHostInstance||q1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ql=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ql.isDisabled&&Ql.supportsFiber)try{su=Ql.inject(Z1),Zn=Ql}catch{}}an.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J1;an.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!th(t))throw Error(W(200));return X1(e,t,null,n)};an.createRoot=function(e,t){if(!th(e))throw Error(W(299));var n=!1,r="",s=Qy;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Jf(e,1,!1,null,null,n,!1,r,s),e[Cr]=t.current,Vo(e.nodeType===8?e.parentNode:e),new eh(t)};an.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(W(188)):(e=Object.keys(e).join(","),Error(W(268,e)));return e=pv(t),e=e===null?null:e.stateNode,e};an.flushSync=function(e){return Bs(e)};an.hydrate=function(e,t,n){if(!vu(t))throw Error(W(200));return yu(null,e,t,!0,n)};an.hydrateRoot=function(e,t,n){if(!th(e))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Qy;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Wy(t,null,e,1,n??null,s,!1,i,o),e[Cr]=t.current,Vo(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new gu(t)};an.render=function(e,t,n){if(!vu(t))throw Error(W(200));return yu(null,e,t,!1,n)};an.unmountComponentAtNode=function(e){if(!vu(e))throw Error(W(40));return e._reactRootContainer?(Bs(function(){yu(null,null,e,!1,function(){e._reactRootContainer=null,e[Cr]=null})}),!0):!1};an.unstable_batchedUpdates=Yf;an.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!vu(n))throw Error(W(200));if(e==null||e._reactInternals===void 0)throw Error(W(38));return yu(e,t,n,!1,r)};an.version="18.3.1-next-f1338f8080-20240426";function Ky(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ky)}catch(e){console.error(e)}}Ky(),Kg.exports=an;var xu=Kg.exports,Yy,Kp=xu;Yy=Kp.createRoot,Kp.hydrateRoot;var Yi=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},eS={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},zr,lf,Eg,tS=(Eg=class{constructor(){pe(this,zr,eS);pe(this,lf,!1)}setTimeoutProvider(e){re(this,zr,e)}setTimeout(e,t){return b(this,zr).setTimeout(e,t)}clearTimeout(e){b(this,zr).clearTimeout(e)}setInterval(e,t){return b(this,zr).setInterval(e,t)}clearInterval(e){b(this,zr).clearInterval(e)}},zr=new WeakMap,lf=new WeakMap,Eg),bs=new tS;function nS(e){setTimeout(e,0)}var Us=typeof window>"u"||"Deno"in globalThis;function Dt(){}function rS(e,t){return typeof e=="function"?e(t):e}function Pd(e){return typeof e=="number"&&e>=0&&e!==1/0}function Xy(e,t){return Math.max(e+(t||0)-Date.now(),0)}function ss(e,t){return typeof e=="function"?e(t):e}function yn(e,t){return typeof e=="function"?e(t):e}function Yp(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(r){if(t.queryHash!==nh(o,t.options))return!1}else if(!Jo(t.queryKey,o))return!1}if(n!=="all"){const u=t.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function Xp(e,t){const{exact:n,status:r,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(Vs(t.options.mutationKey)!==Vs(i))return!1}else if(!Jo(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function nh(e,t){return((t==null?void 0:t.queryKeyHashFn)||Vs)(e)}function Vs(e){return JSON.stringify(e,(t,n)=>Td(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function Jo(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Jo(e[n],t[n])):!1}var sS=Object.prototype.hasOwnProperty;function qy(e,t){if(e===t)return e;const n=qp(e)&&qp(t);if(!n&&!(Td(e)&&Td(t)))return t;const s=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),o=i.length,l=n?new Array(o):{};let u=0;for(let d=0;d<o;d++){const f=n?d:i[d],h=e[f],p=t[f];if(h===p){l[f]=h,(n?d<s:sS.call(e,f))&&u++;continue}if(h===null||p===null||typeof h!="object"||typeof p!="object"){l[f]=p;continue}const S=qy(h,p);l[f]=S,S===h&&u++}return s===o&&u===s?e:l}function Ka(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function qp(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Td(e){if(!Gp(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!Gp(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Gp(e){return Object.prototype.toString.call(e)==="[object Object]"}function iS(e){return new Promise(t=>{bs.setTimeout(t,e)})}function Ld(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?qy(e,t):t}function oS(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function lS(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var rh=Symbol();function Gy(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===rh?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Jy(e,t){return typeof e=="function"?e(...t):!!e}function aS(e,t,n){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=t()),r||(r=!0,s.aborted?n():s.addEventListener("abort",n,{once:!0})),s)}),e}var Ns,$r,Ei,Ng,uS=(Ng=class extends Yi{constructor(){super();pe(this,Ns);pe(this,$r);pe(this,Ei);re(this,Ei,t=>{if(!Us&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){b(this,$r)||this.setEventListener(b(this,Ei))}onUnsubscribe(){var t;this.hasListeners()||((t=b(this,$r))==null||t.call(this),re(this,$r,void 0))}setEventListener(t){var n;re(this,Ei,t),(n=b(this,$r))==null||n.call(this),re(this,$r,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){b(this,Ns)!==t&&(re(this,Ns,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof b(this,Ns)=="boolean"?b(this,Ns):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Ns=new WeakMap,$r=new WeakMap,Ei=new WeakMap,Ng),sh=new uS;function _d(){let e,t;const n=new Promise((s,i)=>{e=s,t=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}var cS=nS;function dS(){let e=[],t=0,n=l=>{l()},r=l=>{l()},s=cS;const i=l=>{t?e.push(l):s(()=>{n(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{r(()=>{l.forEach(u=>{n(u)})})})};return{batch:l=>{let u;t++;try{u=l()}finally{t--,t||o()}return u},batchCalls:l=>(...u)=>{i(()=>{l(...u)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var at=dS(),Ni,Br,ji,jg,fS=(jg=class extends Yi{constructor(){super();pe(this,Ni,!0);pe(this,Br);pe(this,ji);re(this,ji,t=>{if(!Us&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){b(this,Br)||this.setEventListener(b(this,ji))}onUnsubscribe(){var t;this.hasListeners()||((t=b(this,Br))==null||t.call(this),re(this,Br,void 0))}setEventListener(t){var n;re(this,ji,t),(n=b(this,Br))==null||n.call(this),re(this,Br,t(this.setOnline.bind(this)))}setOnline(t){b(this,Ni)!==t&&(re(this,Ni,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return b(this,Ni)}},Ni=new WeakMap,Br=new WeakMap,ji=new WeakMap,jg),Ya=new fS;function hS(e){return Math.min(1e3*2**e,3e4)}function Zy(e){return(e??"online")==="online"?Ya.isOnline():!0}var Id=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function ex(e){let t=!1,n=0,r;const s=_d(),i=()=>s.status!=="pending",o=E=>{var j;if(!i()){const v=new Id(E);p(v),(j=e.onCancel)==null||j.call(e,v)}},l=()=>{t=!0},u=()=>{t=!1},d=()=>sh.isFocused()&&(e.networkMode==="always"||Ya.isOnline())&&e.canRun(),f=()=>Zy(e.networkMode)&&e.canRun(),h=E=>{i()||(r==null||r(),s.resolve(E))},p=E=>{i()||(r==null||r(),s.reject(E))},S=()=>new Promise(E=>{var j;r=v=>{(i()||d())&&E(v)},(j=e.onPause)==null||j.call(e)}).then(()=>{var E;r=void 0,i()||(E=e.onContinue)==null||E.call(e)}),w=()=>{if(i())return;let E;const j=n===0?e.initialPromise:void 0;try{E=j??e.fn()}catch(v){E=Promise.reject(v)}Promise.resolve(E).then(h).catch(v=>{var R;if(i())return;const m=e.retry??(Us?0:3),x=e.retryDelay??hS,y=typeof x=="function"?x(n,v):x,k=m===!0||typeof m=="number"&&n<m||typeof m=="function"&&m(n,v);if(t||!k){p(v);return}n++,(R=e.onFail)==null||R.call(e,n,v),iS(y).then(()=>d()?void 0:S()).then(()=>{t?p(v):w()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:l,continueRetry:u,canStart:f,start:()=>(f()?w():S().then(w),s)}}var js,Mg,tx=(Mg=class{constructor(){pe(this,js)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Pd(this.gcTime)&&re(this,js,bs.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Us?1/0:5*60*1e3))}clearGcTimeout(){b(this,js)&&(bs.clearTimeout(b(this,js)),re(this,js,void 0))}},js=new WeakMap,Mg),Ms,Mi,vn,Rs,dt,nl,Ps,_n,cr,Rg,pS=(Rg=class extends tx{constructor(t){super();pe(this,_n);pe(this,Ms);pe(this,Mi);pe(this,vn);pe(this,Rs);pe(this,dt);pe(this,nl);pe(this,Ps);re(this,Ps,!1),re(this,nl,t.defaultOptions),this.setOptions(t.options),this.observers=[],re(this,Rs,t.client),re(this,vn,b(this,Rs).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,re(this,Ms,Zp(this.options)),this.state=t.state??b(this,Ms),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=b(this,dt))==null?void 0:t.promise}setOptions(t){if(this.options={...b(this,nl),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Zp(this.options);n.data!==void 0&&(this.setState(Jp(n.data,n.dataUpdatedAt)),re(this,Ms,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&b(this,vn).remove(this)}setData(t,n){const r=Ld(this.state.data,t,this.options);return be(this,_n,cr).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){be(this,_n,cr).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=b(this,dt))==null?void 0:r.promise;return(s=b(this,dt))==null||s.cancel(t),n?n.then(Dt).catch(Dt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(b(this,Ms))}isActive(){return this.observers.some(t=>yn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===rh||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ss(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Xy(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=b(this,dt))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=b(this,dt))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),b(this,vn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(b(this,dt)&&(b(this,Ps)?b(this,dt).cancel({revert:!0}):b(this,dt).cancelRetry()),this.scheduleGc()),b(this,vn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||be(this,_n,cr).call(this,{type:"invalidate"})}async fetch(t,n){var u,d,f,h,p,S,w,E,j,v,m,x;if(this.state.fetchStatus!=="idle"&&((u=b(this,dt))==null?void 0:u.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(b(this,dt))return b(this,dt).continueRetry(),b(this,dt).promise}if(t&&this.setOptions(t),!this.options.queryFn){const y=this.observers.find(k=>k.options.queryFn);y&&this.setOptions(y.options)}const r=new AbortController,s=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(re(this,Ps,!0),r.signal)})},i=()=>{const y=Gy(this.options,n),R=(()=>{const M={client:b(this,Rs),queryKey:this.queryKey,meta:this.meta};return s(M),M})();return re(this,Ps,!1),this.options.persister?this.options.persister(y,R,this):y(R)},l=(()=>{const y={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:b(this,Rs),state:this.state,fetchFn:i};return s(y),y})();(d=this.options.behavior)==null||d.onFetch(l,this),re(this,Mi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&be(this,_n,cr).call(this,{type:"fetch",meta:(h=l.fetchOptions)==null?void 0:h.meta}),re(this,dt,ex({initialPromise:n==null?void 0:n.initialPromise,fn:l.fetchFn,onCancel:y=>{y instanceof Id&&y.revert&&this.setState({...b(this,Mi),fetchStatus:"idle"}),r.abort()},onFail:(y,k)=>{be(this,_n,cr).call(this,{type:"failed",failureCount:y,error:k})},onPause:()=>{be(this,_n,cr).call(this,{type:"pause"})},onContinue:()=>{be(this,_n,cr).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const y=await b(this,dt).start();if(y===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(y),(S=(p=b(this,vn).config).onSuccess)==null||S.call(p,y,this),(E=(w=b(this,vn).config).onSettled)==null||E.call(w,y,this.state.error,this),y}catch(y){if(y instanceof Id){if(y.silent)return b(this,dt).promise;if(y.revert){if(this.state.data===void 0)throw y;return this.state.data}}throw be(this,_n,cr).call(this,{type:"error",error:y}),(v=(j=b(this,vn).config).onError)==null||v.call(j,y,this),(x=(m=b(this,vn).config).onSettled)==null||x.call(m,this.state.data,y,this),y}finally{this.scheduleGc()}}},Ms=new WeakMap,Mi=new WeakMap,vn=new WeakMap,Rs=new WeakMap,dt=new WeakMap,nl=new WeakMap,Ps=new WeakMap,_n=new WeakSet,cr=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...nx(r.data,this.options),fetchMeta:t.meta??null};case"success":const s={...r,...Jp(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return re(this,Mi,t.manual?s:void 0),s;case"error":const i=t.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),at.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),b(this,vn).notify({query:this,type:"updated",action:t})})},Rg);function nx(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Zy(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Jp(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Zp(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Wt,je,rl,Ft,Ts,Ri,hr,Ur,sl,Pi,Ti,Ls,_s,Vr,Li,Le,bo,Fd,Od,Ad,Dd,zd,$d,Bd,rx,Pg,mS=(Pg=class extends Yi{constructor(t,n){super();pe(this,Le);pe(this,Wt);pe(this,je);pe(this,rl);pe(this,Ft);pe(this,Ts);pe(this,Ri);pe(this,hr);pe(this,Ur);pe(this,sl);pe(this,Pi);pe(this,Ti);pe(this,Ls);pe(this,_s);pe(this,Vr);pe(this,Li,new Set);this.options=n,re(this,Wt,t),re(this,Ur,null),re(this,hr,_d()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(b(this,je).addObserver(this),em(b(this,je),this.options)?be(this,Le,bo).call(this):this.updateResult(),be(this,Le,Dd).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Ud(b(this,je),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Ud(b(this,je),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,be(this,Le,zd).call(this),be(this,Le,$d).call(this),b(this,je).removeObserver(this)}setOptions(t){const n=this.options,r=b(this,je);if(this.options=b(this,Wt).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof yn(this.options.enabled,b(this,je))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");be(this,Le,Bd).call(this),b(this,je).setOptions(this.options),n._defaulted&&!Ka(this.options,n)&&b(this,Wt).getQueryCache().notify({type:"observerOptionsUpdated",query:b(this,je),observer:this});const s=this.hasListeners();s&&tm(b(this,je),r,this.options,n)&&be(this,Le,bo).call(this),this.updateResult(),s&&(b(this,je)!==r||yn(this.options.enabled,b(this,je))!==yn(n.enabled,b(this,je))||ss(this.options.staleTime,b(this,je))!==ss(n.staleTime,b(this,je)))&&be(this,Le,Fd).call(this);const i=be(this,Le,Od).call(this);s&&(b(this,je)!==r||yn(this.options.enabled,b(this,je))!==yn(n.enabled,b(this,je))||i!==b(this,Vr))&&be(this,Le,Ad).call(this,i)}getOptimisticResult(t){const n=b(this,Wt).getQueryCache().build(b(this,Wt),t),r=this.createResult(n,t);return vS(this,r)&&(re(this,Ft,r),re(this,Ri,this.options),re(this,Ts,b(this,je).state)),r}getCurrentResult(){return b(this,Ft)}trackResult(t,n){return new Proxy(t,{get:(r,s)=>(this.trackProp(s),n==null||n(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&b(this,hr).status==="pending"&&b(this,hr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(t){b(this,Li).add(t)}getCurrentQuery(){return b(this,je)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=b(this,Wt).defaultQueryOptions(t),r=b(this,Wt).getQueryCache().build(b(this,Wt),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return be(this,Le,bo).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),b(this,Ft)))}createResult(t,n){var O;const r=b(this,je),s=this.options,i=b(this,Ft),o=b(this,Ts),l=b(this,Ri),d=t!==r?t.state:b(this,rl),{state:f}=t;let h={...f},p=!1,S;if(n._optimisticResults){const T=this.hasListeners(),X=!T&&em(t,n),J=T&&tm(t,r,n,s);(X||J)&&(h={...h,...nx(f.data,t.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:w,errorUpdatedAt:E,status:j}=h;S=h.data;let v=!1;if(n.placeholderData!==void 0&&S===void 0&&j==="pending"){let T;i!=null&&i.isPlaceholderData&&n.placeholderData===(l==null?void 0:l.placeholderData)?(T=i.data,v=!0):T=typeof n.placeholderData=="function"?n.placeholderData((O=b(this,Ti))==null?void 0:O.state.data,b(this,Ti)):n.placeholderData,T!==void 0&&(j="success",S=Ld(i==null?void 0:i.data,T,n),p=!0)}if(n.select&&S!==void 0&&!v)if(i&&S===(o==null?void 0:o.data)&&n.select===b(this,sl))S=b(this,Pi);else try{re(this,sl,n.select),S=n.select(S),S=Ld(i==null?void 0:i.data,S,n),re(this,Pi,S),re(this,Ur,null)}catch(T){re(this,Ur,T)}b(this,Ur)&&(w=b(this,Ur),S=b(this,Pi),E=Date.now(),j="error");const m=h.fetchStatus==="fetching",x=j==="pending",y=j==="error",k=x&&m,R=S!==void 0,N={status:j,fetchStatus:h.fetchStatus,isPending:x,isSuccess:j==="success",isError:y,isInitialLoading:k,isLoading:k,data:S,dataUpdatedAt:h.dataUpdatedAt,error:w,errorUpdatedAt:E,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>d.dataUpdateCount||h.errorUpdateCount>d.errorUpdateCount,isFetching:m,isRefetching:m&&!x,isLoadingError:y&&!R,isPaused:h.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:y&&R,isStale:ih(t,n),refetch:this.refetch,promise:b(this,hr),isEnabled:yn(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const T=$=>{N.status==="error"?$.reject(N.error):N.data!==void 0&&$.resolve(N.data)},X=()=>{const $=re(this,hr,N.promise=_d());T($)},J=b(this,hr);switch(J.status){case"pending":t.queryHash===r.queryHash&&T(J);break;case"fulfilled":(N.status==="error"||N.data!==J.value)&&X();break;case"rejected":(N.status!=="error"||N.error!==J.reason)&&X();break}}return N}updateResult(){const t=b(this,Ft),n=this.createResult(b(this,je),this.options);if(re(this,Ts,b(this,je).state),re(this,Ri,this.options),b(this,Ts).data!==void 0&&re(this,Ti,b(this,je)),Ka(n,t))return;re(this,Ft,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!b(this,Li).size)return!0;const o=new Set(i??b(this,Li));return this.options.throwOnError&&o.add("error"),Object.keys(b(this,Ft)).some(l=>{const u=l;return b(this,Ft)[u]!==t[u]&&o.has(u)})};be(this,Le,rx).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&be(this,Le,Dd).call(this)}},Wt=new WeakMap,je=new WeakMap,rl=new WeakMap,Ft=new WeakMap,Ts=new WeakMap,Ri=new WeakMap,hr=new WeakMap,Ur=new WeakMap,sl=new WeakMap,Pi=new WeakMap,Ti=new WeakMap,Ls=new WeakMap,_s=new WeakMap,Vr=new WeakMap,Li=new WeakMap,Le=new WeakSet,bo=function(t){be(this,Le,Bd).call(this);let n=b(this,je).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Dt)),n},Fd=function(){be(this,Le,zd).call(this);const t=ss(this.options.staleTime,b(this,je));if(Us||b(this,Ft).isStale||!Pd(t))return;const r=Xy(b(this,Ft).dataUpdatedAt,t)+1;re(this,Ls,bs.setTimeout(()=>{b(this,Ft).isStale||this.updateResult()},r))},Od=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(b(this,je)):this.options.refetchInterval)??!1},Ad=function(t){be(this,Le,$d).call(this),re(this,Vr,t),!(Us||yn(this.options.enabled,b(this,je))===!1||!Pd(b(this,Vr))||b(this,Vr)===0)&&re(this,_s,bs.setInterval(()=>{(this.options.refetchIntervalInBackground||sh.isFocused())&&be(this,Le,bo).call(this)},b(this,Vr)))},Dd=function(){be(this,Le,Fd).call(this),be(this,Le,Ad).call(this,be(this,Le,Od).call(this))},zd=function(){b(this,Ls)&&(bs.clearTimeout(b(this,Ls)),re(this,Ls,void 0))},$d=function(){b(this,_s)&&(bs.clearInterval(b(this,_s)),re(this,_s,void 0))},Bd=function(){const t=b(this,Wt).getQueryCache().build(b(this,Wt),this.options);if(t===b(this,je))return;const n=b(this,je);re(this,je,t),re(this,rl,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},rx=function(t){at.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(b(this,Ft))}),b(this,Wt).getQueryCache().notify({query:b(this,je),type:"observerResultsUpdated"})})},Pg);function gS(e,t){return yn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function em(e,t){return gS(e,t)||e.state.data!==void 0&&Ud(e,t,t.refetchOnMount)}function Ud(e,t,n){if(yn(t.enabled,e)!==!1&&ss(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&ih(e,t)}return!1}function tm(e,t,n,r){return(e!==t||yn(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&ih(e,n)}function ih(e,t){return yn(t.enabled,e)!==!1&&e.isStaleByTime(ss(t.staleTime,e))}function vS(e,t){return!Ka(e.getCurrentResult(),t)}function nm(e){return{onFetch:(t,n)=>{var f,h,p,S,w;const r=t.options,s=(p=(h=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:h.fetchMore)==null?void 0:p.direction,i=((S=t.state.data)==null?void 0:S.pages)||[],o=((w=t.state.data)==null?void 0:w.pageParams)||[];let l={pages:[],pageParams:[]},u=0;const d=async()=>{let E=!1;const j=x=>{aS(x,()=>t.signal,()=>E=!0)},v=Gy(t.options,t.fetchOptions),m=async(x,y,k)=>{if(E)return Promise.reject();if(y==null&&x.pages.length)return Promise.resolve(x);const M=(()=>{const X={client:t.client,queryKey:t.queryKey,pageParam:y,direction:k?"backward":"forward",meta:t.options.meta};return j(X),X})(),N=await v(M),{maxPages:O}=t.options,T=k?lS:oS;return{pages:T(x.pages,N,O),pageParams:T(x.pageParams,y,O)}};if(s&&i.length){const x=s==="backward",y=x?yS:rm,k={pages:i,pageParams:o},R=y(r,k);l=await m(k,R,x)}else{const x=e??i.length;do{const y=u===0?o[0]??r.initialPageParam:rm(r,l);if(u>0&&y==null)break;l=await m(l,y),u++}while(u<x)}return l};t.options.persister?t.fetchFn=()=>{var E,j;return(j=(E=t.options).persister)==null?void 0:j.call(E,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=d}}}function rm(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function yS(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var il,Xn,Ot,Is,qn,Ir,Tg,xS=(Tg=class extends tx{constructor(t){super();pe(this,qn);pe(this,il);pe(this,Xn);pe(this,Ot);pe(this,Is);re(this,il,t.client),this.mutationId=t.mutationId,re(this,Ot,t.mutationCache),re(this,Xn,[]),this.state=t.state||sx(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){b(this,Xn).includes(t)||(b(this,Xn).push(t),this.clearGcTimeout(),b(this,Ot).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){re(this,Xn,b(this,Xn).filter(n=>n!==t)),this.scheduleGc(),b(this,Ot).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){b(this,Xn).length||(this.state.status==="pending"?this.scheduleGc():b(this,Ot).remove(this))}continue(){var t;return((t=b(this,Is))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,u,d,f,h,p,S,w,E,j,v,m,x,y,k,R,M,N,O;const n=()=>{be(this,qn,Ir).call(this,{type:"continue"})},r={client:b(this,il),meta:this.options.meta,mutationKey:this.options.mutationKey};re(this,Is,ex({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(T,X)=>{be(this,qn,Ir).call(this,{type:"failed",failureCount:T,error:X})},onPause:()=>{be(this,qn,Ir).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>b(this,Ot).canRun(this)}));const s=this.state.status==="pending",i=!b(this,Is).canStart();try{if(s)n();else{be(this,qn,Ir).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(o=b(this,Ot).config).onMutate)==null?void 0:l.call(o,t,this,r));const X=await((d=(u=this.options).onMutate)==null?void 0:d.call(u,t,r));X!==this.state.context&&be(this,qn,Ir).call(this,{type:"pending",context:X,variables:t,isPaused:i})}const T=await b(this,Is).start();return await((h=(f=b(this,Ot).config).onSuccess)==null?void 0:h.call(f,T,t,this.state.context,this,r)),await((S=(p=this.options).onSuccess)==null?void 0:S.call(p,T,t,this.state.context,r)),await((E=(w=b(this,Ot).config).onSettled)==null?void 0:E.call(w,T,null,this.state.variables,this.state.context,this,r)),await((v=(j=this.options).onSettled)==null?void 0:v.call(j,T,null,t,this.state.context,r)),be(this,qn,Ir).call(this,{type:"success",data:T}),T}catch(T){try{await((x=(m=b(this,Ot).config).onError)==null?void 0:x.call(m,T,t,this.state.context,this,r))}catch(X){Promise.reject(X)}try{await((k=(y=this.options).onError)==null?void 0:k.call(y,T,t,this.state.context,r))}catch(X){Promise.reject(X)}try{await((M=(R=b(this,Ot).config).onSettled)==null?void 0:M.call(R,void 0,T,this.state.variables,this.state.context,this,r))}catch(X){Promise.reject(X)}try{await((O=(N=this.options).onSettled)==null?void 0:O.call(N,void 0,T,t,this.state.context,r))}catch(X){Promise.reject(X)}throw be(this,qn,Ir).call(this,{type:"error",error:T}),T}finally{b(this,Ot).runNext(this)}}},il=new WeakMap,Xn=new WeakMap,Ot=new WeakMap,Is=new WeakMap,qn=new WeakSet,Ir=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),at.batch(()=>{b(this,Xn).forEach(r=>{r.onMutationUpdate(t)}),b(this,Ot).notify({mutation:this,type:"updated",action:t})})},Tg);function sx(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var pr,In,ol,Lg,wS=(Lg=class extends Yi{constructor(t={}){super();pe(this,pr);pe(this,In);pe(this,ol);this.config=t,re(this,pr,new Set),re(this,In,new Map),re(this,ol,0)}build(t,n,r){const s=new xS({client:t,mutationCache:this,mutationId:++Rl(this,ol)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){b(this,pr).add(t);const n=Kl(t);if(typeof n=="string"){const r=b(this,In).get(n);r?r.push(t):b(this,In).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(b(this,pr).delete(t)){const n=Kl(t);if(typeof n=="string"){const r=b(this,In).get(n);if(r)if(r.length>1){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}else r[0]===t&&b(this,In).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Kl(t);if(typeof n=="string"){const r=b(this,In).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var r;const n=Kl(t);if(typeof n=="string"){const s=(r=b(this,In).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){at.batch(()=>{b(this,pr).forEach(t=>{this.notify({type:"removed",mutation:t})}),b(this,pr).clear(),b(this,In).clear()})}getAll(){return Array.from(b(this,pr))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Xp(n,r))}findAll(t={}){return this.getAll().filter(n=>Xp(t,n))}notify(t){at.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return at.batch(()=>Promise.all(t.map(n=>n.continue().catch(Dt))))}},pr=new WeakMap,In=new WeakMap,ol=new WeakMap,Lg);function Kl(e){var t;return(t=e.options.scope)==null?void 0:t.id}var mr,Hr,Qt,gr,Sr,pa,Vd,_g,SS=(_g=class extends Yi{constructor(n,r){super();pe(this,Sr);pe(this,mr);pe(this,Hr);pe(this,Qt);pe(this,gr);re(this,mr,n),this.setOptions(r),this.bindMethods(),be(this,Sr,pa).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var s;const r=this.options;this.options=b(this,mr).defaultMutationOptions(n),Ka(this.options,r)||b(this,mr).getMutationCache().notify({type:"observerOptionsUpdated",mutation:b(this,Qt),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Vs(r.mutationKey)!==Vs(this.options.mutationKey)?this.reset():((s=b(this,Qt))==null?void 0:s.state.status)==="pending"&&b(this,Qt).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=b(this,Qt))==null||n.removeObserver(this)}onMutationUpdate(n){be(this,Sr,pa).call(this),be(this,Sr,Vd).call(this,n)}getCurrentResult(){return b(this,Hr)}reset(){var n;(n=b(this,Qt))==null||n.removeObserver(this),re(this,Qt,void 0),be(this,Sr,pa).call(this),be(this,Sr,Vd).call(this)}mutate(n,r){var s;return re(this,gr,r),(s=b(this,Qt))==null||s.removeObserver(this),re(this,Qt,b(this,mr).getMutationCache().build(b(this,mr),this.options)),b(this,Qt).addObserver(this),b(this,Qt).execute(n)}},mr=new WeakMap,Hr=new WeakMap,Qt=new WeakMap,gr=new WeakMap,Sr=new WeakSet,pa=function(){var r;const n=((r=b(this,Qt))==null?void 0:r.state)??sx();re(this,Hr,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Vd=function(n){at.batch(()=>{var r,s,i,o,l,u,d,f;if(b(this,gr)&&this.hasListeners()){const h=b(this,Hr).variables,p=b(this,Hr).context,S={client:b(this,mr),meta:this.options.meta,mutationKey:this.options.mutationKey};if((n==null?void 0:n.type)==="success"){try{(s=(r=b(this,gr)).onSuccess)==null||s.call(r,n.data,h,p,S)}catch(w){Promise.reject(w)}try{(o=(i=b(this,gr)).onSettled)==null||o.call(i,n.data,null,h,p,S)}catch(w){Promise.reject(w)}}else if((n==null?void 0:n.type)==="error"){try{(u=(l=b(this,gr)).onError)==null||u.call(l,n.error,h,p,S)}catch(w){Promise.reject(w)}try{(f=(d=b(this,gr)).onSettled)==null||f.call(d,void 0,n.error,h,p,S)}catch(w){Promise.reject(w)}}}this.listeners.forEach(h=>{h(b(this,Hr))})})},_g),Gn,Ig,bS=(Ig=class extends Yi{constructor(t={}){super();pe(this,Gn);this.config=t,re(this,Gn,new Map)}build(t,n,r){const s=n.queryKey,i=n.queryHash??nh(s,n);let o=this.get(i);return o||(o=new pS({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){b(this,Gn).has(t.queryHash)||(b(this,Gn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=b(this,Gn).get(t.queryHash);n&&(t.destroy(),n===t&&b(this,Gn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){at.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return b(this,Gn).get(t)}getAll(){return[...b(this,Gn).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Yp(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>Yp(t,r)):n}notify(t){at.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){at.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){at.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Gn=new WeakMap,Ig),Qe,Wr,Qr,_i,Ii,Kr,Fi,Oi,Fg,CS=(Fg=class{constructor(e={}){pe(this,Qe);pe(this,Wr);pe(this,Qr);pe(this,_i);pe(this,Ii);pe(this,Kr);pe(this,Fi);pe(this,Oi);re(this,Qe,e.queryCache||new bS),re(this,Wr,e.mutationCache||new wS),re(this,Qr,e.defaultOptions||{}),re(this,_i,new Map),re(this,Ii,new Map),re(this,Kr,0)}mount(){Rl(this,Kr)._++,b(this,Kr)===1&&(re(this,Fi,sh.subscribe(async e=>{e&&(await this.resumePausedMutations(),b(this,Qe).onFocus())})),re(this,Oi,Ya.subscribe(async e=>{e&&(await this.resumePausedMutations(),b(this,Qe).onOnline())})))}unmount(){var e,t;Rl(this,Kr)._--,b(this,Kr)===0&&((e=b(this,Fi))==null||e.call(this),re(this,Fi,void 0),(t=b(this,Oi))==null||t.call(this),re(this,Oi,void 0))}isFetching(e){return b(this,Qe).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return b(this,Wr).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=b(this,Qe).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=b(this,Qe).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(ss(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return b(this,Qe).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=b(this,Qe).get(r.queryHash),i=s==null?void 0:s.state.data,o=rS(t,i);if(o!==void 0)return b(this,Qe).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return at.batch(()=>b(this,Qe).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=b(this,Qe).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=b(this,Qe);at.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=b(this,Qe);return at.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=at.batch(()=>b(this,Qe).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(Dt).catch(Dt)}invalidateQueries(e,t={}){return at.batch(()=>(b(this,Qe).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=at.batch(()=>b(this,Qe).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(Dt)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Dt)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=b(this,Qe).build(this,t);return n.isStaleByTime(ss(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Dt).catch(Dt)}fetchInfiniteQuery(e){return e.behavior=nm(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Dt).catch(Dt)}ensureInfiniteQueryData(e){return e.behavior=nm(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Ya.isOnline()?b(this,Wr).resumePausedMutations():Promise.resolve()}getQueryCache(){return b(this,Qe)}getMutationCache(){return b(this,Wr)}getDefaultOptions(){return b(this,Qr)}setDefaultOptions(e){re(this,Qr,e)}setQueryDefaults(e,t){b(this,_i).set(Vs(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...b(this,_i).values()],n={};return t.forEach(r=>{Jo(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){b(this,Ii).set(Vs(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...b(this,Ii).values()],n={};return t.forEach(r=>{Jo(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...b(this,Qr).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=nh(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===rh&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...b(this,Qr).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){b(this,Qe).clear(),b(this,Wr).clear()}},Qe=new WeakMap,Wr=new WeakMap,Qr=new WeakMap,_i=new WeakMap,Ii=new WeakMap,Kr=new WeakMap,Fi=new WeakMap,Oi=new WeakMap,Fg),ix=c.createContext(void 0),Qs=e=>{const t=c.useContext(ix);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},kS=({client:e,children:t})=>(c.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(ix.Provider,{value:e,children:t})),ox=c.createContext(!1),ES=()=>c.useContext(ox);ox.Provider;function NS(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var jS=c.createContext(NS()),MS=()=>c.useContext(jS),RS=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},PS=e=>{c.useEffect(()=>{e.clearReset()},[e])},TS=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||Jy(n,[e.error,r])),LS=e=>{if(e.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},_S=(e,t)=>e.isLoading&&e.isFetching&&!t,IS=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,sm=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function FS(e,t,n){var h,p,S,w,E;const r=ES(),s=MS(),i=Qs(),o=i.defaultQueryOptions(e);(p=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||p.call(h,o),o._optimisticResults=r?"isRestoring":"optimistic",LS(o),RS(o,s),PS(s);const l=!i.getQueryCache().get(o.queryHash),[u]=c.useState(()=>new t(i,o)),d=u.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(c.useSyncExternalStore(c.useCallback(j=>{const v=f?u.subscribe(at.batchCalls(j)):Dt;return u.updateResult(),v},[u,f]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),c.useEffect(()=>{u.setOptions(o)},[o,u]),IS(o,d))throw sm(o,u,s);if(TS({result:d,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((w=(S=i.getDefaultOptions().queries)==null?void 0:S._experimental_afterQuery)==null||w.call(S,o,d),o.experimental_prefetchInRender&&!Us&&_S(d,r)){const j=l?sm(o,u,s):(E=i.getQueryCache().get(o.queryHash))==null?void 0:E.promise;j==null||j.catch(Dt).finally(()=>{u.updateResult()})}return o.notifyOnChangeProps?d:u.trackResult(d)}function wu(e,t){return FS(e,mS)}function OS(e,t){const n=Qs(),[r]=c.useState(()=>new SS(n,e));c.useEffect(()=>{r.setOptions(e)},[r,e]);const s=c.useSyncExternalStore(c.useCallback(o=>r.subscribe(at.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=c.useCallback((o,l)=>{r.mutate(o,l).catch(Dt)},[r]);if(s.error&&Jy(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}const lx=8,AS=6;function im(e,t,n){return n<t?t:Math.min(n,Math.max(t,e))}function ax({x:e,y:t,menuWidth:n,menuHeight:r,viewport:s,margin:i=lx}){const o=i,l=i,u=s.width-Math.max(0,n)-i,d=s.height-Math.max(0,r)-i;return{x:im(e,o,u),y:im(t,l,d)}}function DS({anchorRect:e,menuSize:t,viewport:n,align:r="left",margin:s=lx,sideOffset:i=AS}){const o=r==="right"?e.right-t.width:e.left,l=e.bottom+i,u=e.top-t.height-i,d=l+t.height+s<=n.height,f=u>=s;return ax({x:o,y:!d&&f?u:l,menuWidth:t.width,menuHeight:t.height,viewport:n,margin:s})}function ux(){return typeof window>"u"?{width:1024,height:768}:{width:window.innerWidth,height:window.innerHeight}}function om(e){return e.length>0&&"options"in e[0]}function lm(){return{x:0,y:0,ready:!1}}function oh({value:e,onChange:t,options:n,placeholder:r="Select...",trigger:s,triggerClassName:i="",panelClassName:o="",align:l="left",width:u="auto",showChevron:d=!0,title:f,disabled:h=!1,"aria-label":p}){var $,oe;const[S,w]=c.useState(!1),E=c.useRef(null),j=c.useRef(null),v=c.useRef(null),[m,x]=c.useState(lm),k=c.useCallback(()=>{const Q=A=>{const _=A.find(P=>P.value===e);return _?_.label:null};if(om(n))for(const A of n){const _=Q(A.options);if(_)return _}else{const A=Q(n);if(A)return A}return r},[e,n,r])(),R=(($=E.current)==null?void 0:$.getBoundingClientRect().width)??((oe=j.current)==null?void 0:oe.offsetWidth)??0,M=u==="trigger"?R:u==="auto"?void 0:u,N=c.useCallback(()=>{if(!S)return;const Q=E.current,A=v.current;if(!Q||!A)return;const _=Q.getBoundingClientRect(),P=A.getBoundingClientRect(),D=M??P.width??180,V=P.height||A.scrollHeight||1,ee=DS({anchorRect:_,menuSize:{width:D,height:V},viewport:ux(),align:l});x(se=>se.x===ee.x&&se.y===ee.y&&se.ready?se:{x:ee.x,y:ee.y,ready:!0})},[l,M,S]);c.useLayoutEffect(()=>{if(!S){x(lm());return}N()},[S,N,n,e]),c.useEffect(()=>{if(!S)return;const Q=P=>{var V,ee;const D=P.target;(V=E.current)!=null&&V.contains(D)||(ee=v.current)!=null&&ee.contains(D)||w(!1)},A=P=>{var D;P.key==="Escape"&&(w(!1),(D=j.current)==null||D.focus())},_=()=>N();return window.addEventListener("click",Q),window.addEventListener("keydown",A),window.addEventListener("resize",_),window.addEventListener("scroll",_,!0),()=>{window.removeEventListener("click",Q),window.removeEventListener("keydown",A),window.removeEventListener("resize",_),window.removeEventListener("scroll",_,!0)}},[S,N]);const O=Q=>{var A;t(Q),w(!1),(A=j.current)==null||A.focus()},T=Q=>Q.map(A=>a.jsxs("button",{className:"dropdown-item","data-active":A.value===e,disabled:A.disabled,onClick:()=>!A.disabled&&O(A.value),role:"menuitem",children:[A.icon&&a.jsx("span",{className:"shrink-0",children:A.icon}),a.jsx("span",{className:"flex-1 truncate",children:A.label}),A.value===e&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0 text-accent",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})]},A.value)),X=c.useMemo(()=>({position:"fixed",left:m.x,top:m.y,visibility:m.ready?"visible":"hidden",...M?{width:M,minWidth:M}:{}}),[M,m]),J=S?a.jsx("div",{ref:v,className:`dropdown-panel ${o}`,style:X,role:"listbox","aria-label":p,children:om(n)?n.map((Q,A)=>a.jsxs("div",{children:[Q.label&&a.jsx("div",{className:"dropdown-label",children:Q.label}),T(Q.options),A<n.length-1&&a.jsx("div",{className:"dropdown-divider"})]},Q.label||A)):T(n)}):null;return a.jsxs("div",{ref:E,className:"relative",children:[s?a.jsx("div",{onClick:()=>!h&&w(Q=>!Q),children:s}):a.jsxs("button",{ref:j,type:"button",className:`dropdown-trigger ${i}`,onClick:()=>w(Q=>!Q),disabled:h,title:f,"aria-label":p,"aria-haspopup":"listbox","aria-expanded":S,children:[a.jsx("span",{className:"truncate",children:k}),d&&a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`shrink-0 opacity-60 transition-transform ${S?"rotate-180":""}`,children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),J&&typeof document<"u"?xu.createPortal(J,document.body):J]})}const zS={offline:"sync-dot-offline",unstable:"sync-dot-unstable",recent:"sync-dot-recent",editing:"sync-dot-editing",live:"sync-dot-live"};function $S({state:e,presence:t,syncLabel:n,connectionLabel:r,lastEditedLabel:s,hasEdits:i,localTypingActive:o,recentTouches:l,isNarrow:u}){const[d,f]=c.useState(!1),[h,p]=c.useState(null),S=c.useRef(null),w=c.useRef(null),E=c.useRef(null),j=t?`${t.viewing} viewing  ${t.editing} editing`:"- viewing  - editing",v=t?String(t.viewing):"-",m=c.useCallback(()=>{E.current&&(window.clearTimeout(E.current),E.current=null)},[]),x=c.useCallback((k,R)=>{var M;R&&((M=navigator.clipboard)==null||M.writeText(R).then(()=>{p(k),m(),E.current=window.setTimeout(()=>{p(N=>N===k?null:N)},1e3)}).catch(()=>{}))},[m]),y=c.useCallback(()=>{f(!1),window.requestAnimationFrame(()=>{var k;return(k=w.current)==null?void 0:k.focus()})},[]);return c.useEffect(()=>{if(!d)return;const k=M=>{!S.current||S.current.contains(M.target)||y()},R=M=>{M.key==="Escape"&&y()};return window.addEventListener("mousedown",k),window.addEventListener("keydown",R),()=>{window.removeEventListener("mousedown",k),window.removeEventListener("keydown",R)}},[d,y]),c.useEffect(()=>()=>{m()},[m]),a.jsxs("div",{ref:S,className:"sync-indicator",children:[a.jsxs("button",{ref:w,type:"button",className:"sync-indicator-button",onClick:()=>d?y():f(!0),"aria-haspopup":"dialog","aria-expanded":d,"aria-label":"Sync status",title:j,children:[a.jsx("span",{className:`sync-indicator-dot ${zS[e]}`,"aria-hidden":"true"}),!u&&a.jsx("span",{className:"sync-indicator-count tabular-nums",children:v}),!u&&o&&a.jsx("span",{className:"sync-indicator-local",children:"typing"})]}),d&&a.jsxs("div",{role:"dialog","aria-label":"Sync status",className:"sync-indicator-card select-text",children:[a.jsx("div",{className:"sync-indicator-line sync-indicator-primary",children:n}),a.jsx("div",{className:"sync-indicator-line",children:r}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:j}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:i?`Last edited: ${s}`:"No edits yet."}),o&&a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:"Local typing in progress (saved on blur)."}),a.jsxs("div",{className:"sync-indicator-section",children:[a.jsx("div",{className:"sync-indicator-section-title",children:"Recently touched files"}),l.length>0?a.jsx("div",{className:"sync-indicator-list",children:l.map(k=>a.jsxs("div",{className:"sync-indicator-item",children:[a.jsx("button",{type:"button",className:"sync-indicator-item-name",title:`Copy filename: ${k.label}`,onClick:()=>x(k.path,k.label),children:k.label}),a.jsx("span",{className:"sync-indicator-item-time tabular-nums",children:h===k.path?"Copied":k.timeLabel})]},k.path))}):a.jsx("div",{className:"sync-indicator-empty",children:"No recent touches."})]})]})]})}const is={phoneMax:480,mobileMax:767,narrowMax:900,tabletMax:1024,mediumMax:1180},ma={phone:`(max-width: ${is.phoneMax}px)`,narrow:`(max-width: ${is.narrowMax}px)`,toolbarCompact:`(max-width: ${is.mediumMax}px)`},am=200,um=240,BS=320,US=360,VS=420;function cm(e,t,n){return Math.min(Math.max(e,t),n)}function HS(e){return e<=is.tabletMax?BS:e<=is.mediumMax?US:VS}function WS(e){return e<=is.tabletMax?360:e<=is.mediumMax?420:520}function QS({viewportWidth:e,leftOpen:t,rightOpen:n,leftWidth:r,rightWidth:s}){const i=HS(e);let o=t?cm(r,am,i):0,l=n?cm(s,um,i):0;const u=Math.max(0,e-WS(e));if(o+l>u){let d=o+l-u;if(l>0){const f=Math.max(0,l-um),h=Math.min(f,d);l-=h,d-=h}if(d>0&&o>0){const f=Math.max(0,o-am),h=Math.min(f,d);o-=h,d-=h}d>0&&l>0&&(l=Math.max(0,u-o)),o+l>u&&(o=Math.max(0,u-l))}return{leftWidth:Number(o.toFixed(2)),rightWidth:Number(l.toFixed(2))}}function ga(e,t=!1){const[n,r]=c.useState(t);return c.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;const s=window.matchMedia(e),i=s,o=()=>r(s.matches);if(o(),typeof s.addEventListener=="function")return s.addEventListener("change",o),()=>s.removeEventListener("change",o);if(typeof i.addListener=="function"&&typeof i.removeListener=="function")return i.addListener(o),()=>{var l;return(l=i.removeListener)==null?void 0:l.call(i,o)}},[e]),n}function cx({isRandom:e,dir:t}){return e?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),a.jsx("path",{d:"M21 3v5h-5"})]}):t==="desc"?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 5v14"}),a.jsx("path",{d:"M19 12l-7 7-7-7"})]}):a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 19V5"}),a.jsx("path",{d:"M5 12l7-7 7 7"})]})}function KS({viewerActive:e,filtersOpen:t,filtersRef:n,totalFilterCount:r,filterCount:s,starFilterList:i,starCounts:o,onToggleFilters:l,onOpenFilters:u,onToggleStar:d,onClearFilters:f,onClearStars:h}){return a.jsxs("div",{ref:n,className:`toolbar-filter relative ${e?"opacity-40 pointer-events-none":""}`,children:[a.jsxs("button",{className:`btn ${r>0?"btn-active":""}`,onClick:l,"aria-haspopup":"dialog","aria-expanded":t,title:"Filters","aria-disabled":e,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),a.jsx("span",{className:"toolbar-filters-label",children:"Filters"}),r>0&&a.jsx("span",{className:"toolbar-filters-count px-1.5 py-0.5 text-[11px] rounded-full bg-accent-strong text-text",children:r})]}),t&&a.jsxs("div",{role:"dialog","aria-label":"Filters",className:"dropdown-panel w-[240px]",style:{top:"38px",left:0},children:[a.jsx("div",{className:"dropdown-label",children:"Rating"}),a.jsxs("div",{className:"px-1",children:[[5,4,3,2,1].map(p=>{const S=i.includes(p),w=(o==null?void 0:o[String(p)])??0;return a.jsxs("button",{onClick:()=>d==null?void 0:d(p),className:`dropdown-item justify-between ${S?"bg-accent-muted":""}`,children:[a.jsxs("span",{className:S?"text-star-active":"text-text",children:["".repeat(p),"".repeat(5-p)]}),a.jsx("span",{className:"text-xs text-muted",children:w})]},p)}),a.jsxs("button",{onClick:()=>d==null?void 0:d(0),className:`dropdown-item justify-between ${i.includes(0)?"bg-accent-muted":""}`,children:[a.jsx("span",{className:"text-text",children:"Unrated"}),a.jsx("span",{className:"text-xs text-muted",children:(o==null?void 0:o["0"])??0})]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("div",{className:"dropdown-label",children:"Metrics"}),a.jsxs("button",{className:"dropdown-item",onClick:()=>{l(),u==null||u()},children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]}),a.jsx("span",{children:"Open Metrics Panel"}),(s||0)>0&&a.jsxs("span",{className:"ml-auto text-xs text-muted",children:[s," active"]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("button",{className:"dropdown-item text-muted hover:text-text",onClick:()=>{f?f():h==null||h()},disabled:r===0,children:"Clear all filters"})]})]})}function YS({viewMode:e,currentSort:t,sortOnlyOptions:n,sortDisabled:r,sortControlsDisabled:s,sortDir:i,isRandom:o,showSelectModeToggle:l,multiSelectMode:u,selectModeLabel:d,uploadBusy:f,uploadDisabled:h,onViewMode:p,onSortChange:S,onToggleSortDir:w,onToggleMultiSelectMode:E,onUploadClick:j}){return a.jsx("div",{className:"mobile-drawer",children:a.jsxs("div",{className:"mobile-drawer-row",children:[a.jsxs("div",{className:"mobile-pill-group",children:[a.jsx("button",{className:`mobile-pill ${e==="grid"?"is-active":""}`,onClick:()=>p==null?void 0:p("grid"),"aria-pressed":e==="grid",children:"Grid"}),a.jsx("button",{className:`mobile-pill ${e==="adaptive"?"is-active":""}`,onClick:()=>p==null?void 0:p("adaptive"),"aria-pressed":e==="adaptive",children:"Masonry"})]}),a.jsx(oh,{value:t,onChange:v=>S==null?void 0:S(v),options:n,"aria-label":"Sort",triggerClassName:"mobile-pill mobile-pill-dropdown",panelClassName:"mobile-drawer-panel",disabled:r}),a.jsx("button",{className:`mobile-pill mobile-pill-icon ${s?"opacity-50 cursor-not-allowed":""}`,onClick:w,title:r?"Sorting disabled":o?"Shuffle":`Sort ${i==="desc"?"descending":"ascending"}`,"aria-label":o?"Shuffle":"Toggle sort direction","aria-disabled":s,disabled:s,children:a.jsx(cx,{isRandom:o,dir:i})}),l&&a.jsx("button",{className:`mobile-pill ${u?"is-active":""}`,onClick:()=>E==null?void 0:E(),"aria-pressed":u,title:u?"Exit select mode":"Enter select mode",children:d}),j&&a.jsx("button",{className:`mobile-pill ${h||f?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!h&&!f&&j(),disabled:h||f,children:f?"Uploading":"Upload"})]})})}function XS({rootRef:e,onSearch:t,viewerActive:n,onBack:r,zoomPercent:s,onZoomPercentChange:i,currentLabel:o,itemCount:l,totalCount:u,sortSpec:d,metricKeys:f,onSortChange:h,sortDisabled:p=!1,filterCount:S,onOpenFilters:w,starFilters:E,onToggleStar:j,onClearStars:v,onClearFilters:m,starCounts:x,viewMode:y,onViewMode:k,gridItemSize:R,onGridItemSize:M,leftOpen:N,rightOpen:O,onToggleLeft:T,onToggleRight:X,onPrevImage:J,onNextImage:$,canPrevImage:oe,canNextImage:Q,searchDisabled:A=!1,searchPlaceholder:_,onUploadClick:P,uploadBusy:D=!1,uploadDisabled:V=!1,multiSelectMode:ee=!1,selectedCount:se=0,onToggleMultiSelectMode:I,syncIndicator:U}){const[Y,Z]=c.useState(!1),[q,te]=c.useState(!1),he=c.useRef(null),Ee=c.useRef(null),ye=ga(ma.narrow),Oe=ga(ma.phone),Se=ga(ma.toolbarCompact);c.useEffect(()=>{if(!Y)return;const K=le=>{he.current&&!he.current.contains(le.target)&&Z(!1)};return window.addEventListener("click",K),()=>window.removeEventListener("click",K)},[Y]),c.useEffect(()=>{if(A){te(!1);return}if(!ye||n){te(!1);return}if(!q)return;const K=window.requestAnimationFrame(()=>{var le;return(le=Ee.current)==null?void 0:le.focus()});return()=>window.cancelAnimationFrame(K)},[ye,q,n,A]);const _e=d??{kind:"builtin",key:"added",dir:"desc"},ct=_e.dir,St=_e.kind==="builtin"&&_e.key==="random",cn=n||p,$n=f!=null&&f.length?f.map(K=>({value:`metric:${K}`,label:K,disabled:p})):[],Jt=[{value:"builtin:added",label:"Date added",disabled:p},{value:"builtin:name",label:"Filename",disabled:p},{value:"builtin:random",label:"Random",disabled:p},...$n],et=[{label:"Layout",options:[{value:"layout:grid",label:"Grid"},{value:"layout:masonry",label:"Masonry"}]},{label:"Sort by",options:Jt}],Zt=_e.kind==="metric"?`metric:${_e.key}`:`builtin:${_e.key}`,Ut=[{label:"Sort by",options:Jt}],dn=ye&&!n,fn=!(!!n&&Se),tt=!!n&&!Oe,pt=dn&&!!I,en=ee?se>0?`Done (${se})`:"Done":"Select",Pt=K=>{if(K.startsWith("layout:")){const le=K==="layout:masonry"?"adaptive":"grid";k==null||k(le)}else{if(p)return;h==null||h(dm(K,_e))}},Bn=()=>{!h||p||h(St?_e:{..._e,dir:ct==="desc"?"asc":"desc"})},Je=E??[],jn=Je.length,jr=GS(S,jn),z=qS(l,u),ne=o||"Root";return a.jsxs("div",{ref:e,className:`toolbar-shell ${n?"toolbar-shell-viewer":""} ${Oe?"toolbar-shell-phone":""} ${Se?"toolbar-shell-compact":""} fixed top-0 left-0 right-0 h-12 grid grid-cols-[minmax(0,1fr)_minmax(0,1fr)_auto] items-center px-3 gap-3 bg-panel border-b border-border z-[var(--z-toolbar)] col-span-full row-start-1 select-none`,children:[a.jsxs("div",{className:"toolbar-left flex items-center gap-4 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope flex items-center gap-3 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope-text flex flex-col min-w-0 leading-tight",children:[a.jsx("span",{className:"toolbar-scope-label text-[10px] uppercase tracking-widest text-muted",children:"Scope"}),a.jsx("span",{className:"text-sm font-medium text-text truncate",title:ne,children:ne})]}),z&&a.jsx("span",{className:"toolbar-count text-xs text-muted whitespace-nowrap tabular-nums",children:z})]}),n&&a.jsxs("button",{className:"toolbar-back-btn btn btn-sm",onClick:r,title:"Back to grid",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]}),fn&&a.jsxs("div",{className:"toolbar-sort flex items-center gap-2",children:[a.jsxs("div",{className:`toolbar-sort-controls flex items-center gap-2 ${n?"opacity-40 pointer-events-none":""}`,children:[a.jsx(oh,{value:Zt,onChange:Pt,options:et,title:"Sort and layout options","aria-label":"Sort and layout",triggerClassName:"min-w-[110px]"}),a.jsx("button",{className:"toolbar-sort-dir btn btn-icon",onClick:Bn,title:p?"Sorting disabled":St?"Shuffle":`Sort ${ct==="desc"?"descending":"ascending"}`,"aria-label":St?"Shuffle":"Toggle sort direction","aria-disabled":cn,disabled:cn,children:a.jsx(cx,{isRandom:St,dir:ct})})]}),a.jsx(KS,{viewerActive:!!n,filtersOpen:Y,filtersRef:he,totalFilterCount:jr,filterCount:S,starFilterList:Je,starCounts:x,onToggleFilters:()=>Z(K=>!K),onOpenFilters:w,onToggleStar:j,onClearFilters:m,onClearStars:v})]})]}),a.jsx("div",{className:"toolbar-center flex items-center gap-3 justify-center min-w-0",children:n?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"range",min:5,max:800,step:1,value:Math.round(Math.max(5,Math.min(800,s??100))),onChange:K=>i==null?void 0:i(Number(K.target.value)),className:"zoom-slider","aria-label":"Zoom level"}),a.jsxs("span",{className:"text-xs text-muted min-w-[42px] text-right",children:[Math.round(s??100),"%"]})]}):M&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-muted",children:"Size"}),a.jsx("input",{type:"range",min:80,max:500,step:10,value:R??220,onChange:K=>M(Number(K.target.value)),className:"w-28 h-1.5 bg-border rounded-full appearance-none cursor-pointer hover:bg-hover transition-colors [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-text [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-text [&::-moz-range-thumb]:border-0","aria-label":"Thumbnail size"})]})}),a.jsxs("div",{className:"toolbar-right flex items-center gap-2 justify-end",children:[tt&&a.jsxs("div",{className:"toolbar-nav flex items-center gap-1 mr-1",children:[a.jsx("button",{className:`btn btn-icon ${oe?"":"opacity-40 cursor-not-allowed"}`,title:"Previous image (A / )",onClick:()=>oe&&(J==null?void 0:J()),"aria-label":"Previous image","aria-disabled":!oe,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("button",{className:`btn btn-icon ${Q?"":"opacity-40 cursor-not-allowed"}`,title:"Next image (D / )",onClick:()=>Q&&($==null?void 0:$()),"aria-label":"Next image","aria-disabled":!Q,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 6l6 6-6 6"})})})]}),a.jsxs("div",{className:"toolbar-panels flex items-center gap-1",children:[a.jsx("button",{className:`btn btn-icon ${N?"":"opacity-50"}`,title:N?"Hide left panel (Ctrl+B)":"Show left panel (Ctrl+B)",onClick:T,"aria-pressed":N,"aria-label":"Toggle left panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"11",y:"5",width:"10",height:"14",rx:"1.5"})]})}),a.jsx("button",{className:`btn btn-icon ${O?"":"opacity-50"}`,title:O?"Hide right panel (Ctrl+Alt+B)":"Show right panel (Ctrl+Alt+B)",onClick:X,"aria-pressed":O,"aria-label":"Toggle right panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"15",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"3",y:"5",width:"10",height:"14",rx:"1.5"})]})})]}),!n&&P&&a.jsxs("button",{className:`btn ${V?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!V&&P(),"aria-label":"Upload images",title:D?"Uploading":"Upload images","aria-disabled":V||D,disabled:V||D,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M12 16V5"}),a.jsx("path",{d:"M7 10l5-5 5 5"}),a.jsx("path",{d:"M4 19h16"})]}),a.jsx("span",{children:D?"Uploading":"Upload"})]}),U&&a.jsx($S,{...U,isNarrow:ye||Se}),!n&&ye&&a.jsx("button",{className:`btn btn-icon ${q?"btn-active":""} ${A?"opacity-50 cursor-not-allowed":""}`,"aria-label":q?"Close search":"Open search",title:A?"Search disabled":q?"Close search":"Search",onClick:()=>!A&&te(K=>!K),disabled:A,children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"11",cy:"11",r:"7"}),a.jsx("path",{d:"M21 21l-4.35-4.35"})]})}),!n&&!ye?a.jsx("div",{className:"toolbar-search toolbar-search-desktop w-[240px]",children:a.jsx("input",{ref:Ee,"aria-label":"Search filename, tags, notes",placeholder:A?_??"Search disabled":"Search...",onChange:K=>t(K.target.value),className:"toolbar-search-input input w-full focus:w-full transition-all duration-200 select-text",disabled:A})}):null]}),!n&&ye&&q&&!A&&a.jsx("div",{className:"toolbar-search-row",children:a.jsx("input",{ref:Ee,"aria-label":"Search filename, tags, notes",placeholder:_??"Search...",onChange:K=>t(K.target.value),className:"toolbar-search-input-mobile input input-lg w-full select-text"})}),dn&&a.jsx(YS,{viewMode:y,currentSort:Zt,sortOnlyOptions:Ut,sortDisabled:p,sortControlsDisabled:cn,sortDir:ct,isRandom:St,showSelectModeToggle:pt,multiSelectMode:ee,selectModeLabel:en,uploadBusy:D,uploadDisabled:V,onViewMode:k,onSortChange:K=>h==null?void 0:h(dm(K,_e)),onToggleSortDir:Bn,onToggleMultiSelectMode:I,onUploadClick:P})]})}function qS(e,t){if(typeof e!="number")return null;const n=e.toLocaleString();if(typeof t!="number")return`${n} items`;const r=t.toLocaleString();return t===e?`${n} items`:`${n} / ${r} items`}function GS(e,t){return typeof e=="number"?e:t>0?1:0}function dm(e,t){if(e.startsWith("metric:")){const n=e.slice(7);return n?{kind:"metric",key:n,dir:t.dir}:t}if(e.startsWith("builtin:")){const n=e.slice(8);if(n==="name"||n==="added"||n==="random")return{kind:"builtin",key:n,dir:t.dir}}return t}class on extends Error{constructor(n,r,s,i){super(r);ot(this,"status");ot(this,"url");ot(this,"body");this.name="FetchError",this.status=n,this.url=s,this.body=i}}function JS(e){const t=e.trim();return t.startsWith("{")||t.startsWith("[")}function dx(e,t,n){if(t&&typeof t=="object"){const r=t,s=typeof r.error=="string"?r.error:null,i=typeof r.message=="string"?r.message:null;if(s&&i)return`${s}: ${i}`;if(s)return s;if(i)return i}return typeof t=="string"&&t?t:`HTTP ${e} for ${n}`}function vt(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{let u=null;const d=await l.text().catch(()=>"");if(d)if((l.headers.get("content-type")||"").includes("application/json")||JS(d))try{u=JSON.parse(d)}catch{u=d}else u=d;if(!l.ok)throw new on(l.status,dx(l.status,u,e),e,u);return u}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}function Yl(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{if(!l.ok){const u=await l.text().catch(()=>""),d=u||null;throw new on(l.status,dx(l.status,d,e),e,d)}return l.blob()}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}class fx{constructor(t){ot(this,"store",new Map);ot(this,"inflight",new Map);ot(this,"totalBytes",0);this.maxBytes=t}getMaxBytes(){return this.maxBytes}getTotalBytes(){return this.totalBytes}getSize(){return this.store.size}has(t){return this.store.has(t)}isInflight(t){return this.inflight.has(t)}get(t){const n=this.store.get(t);if(n)return this.store.delete(t),this.store.set(t,n),n.blob}evictIfNeeded(t){for(;this.totalBytes+t>this.maxBytes&&this.store.size>0;){const n=this.store.keys().next().value;if(n==null)break;const r=this.store.get(n);r&&(this.totalBytes-=r.size),this.store.delete(n)}}set(t,n){const r=n.size||0;if(!(r>this.maxBytes)){if(this.store.has(t)){const s=this.store.get(t);this.totalBytes-=s.size,this.store.delete(t)}this.evictIfNeeded(r),this.store.set(t,{blob:n,size:r}),this.totalBytes+=r}}async getOrFetch(t,n){const r=this.get(t);if(r)return r;const s=this.inflight.get(t);if(s)return s.promise;const i=n(),o=typeof i=="object"&&"promise"in i,l=o?i.promise:i,u=o?i.abort:void 0,d=l.then(f=>(this.set(t,f),f)).finally(()=>{this.inflight.delete(t)});return this.inflight.set(t,{promise:d,abort:u}),d}prefetch(t,n){if(this.store.has(t)||this.inflight.has(t))return;const r=n(),s=typeof r=="object"&&"promise"in r,i=s?r.promise:r,o=s?r.abort:void 0,l=i.then(u=>(this.set(t,u),u)).catch(()=>new Blob).finally(()=>{this.inflight.delete(t)});this.inflight.set(t,{promise:l,abort:o})}cancelPrefetch(t){const n=this.inflight.get(t);if(n!=null&&n.abort)try{n.abort()}catch{}this.inflight.delete(t)}clear(){for(const[t,n]of this.inflight)if(n.abort)try{n.abort()}catch{}this.inflight.clear(),this.store.clear(),this.totalBytes=0}evictPrefix(t){const n=(()=>{const s=t?`/${t.replace(/^\/+/,"")}`:"/";return s==="/"?"/":s.replace(/\/+$/,"")})(),r=s=>{const i=s.startsWith("/")?s.replace(/\/+$/,""):`/${s.replace(/\/+$/,"")}`;return n==="/"?!0:i===n||i.startsWith(`${n}/`)};for(const[s,i]of Array.from(this.store.entries()))r(s)&&(this.totalBytes-=i.size,this.store.delete(s));for(const[s,i]of Array.from(this.inflight.entries()))if(r(s)){if(i.abort)try{i.abort()}catch{}this.inflight.delete(s)}this.totalBytes<0&&(this.totalBytes=0)}}const ni=new fx(60*1024*1024),Hd=new fx(20*1024*1024),bc={};function ZS(){const e=bc==null?void 0:bc.VITE_API_BASE,t=typeof window<"u",n=t?window.location.origin:"http://localhost",r=t?window.location.hostname:"localhost",s=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\]|.+\.localhost)$/i.test(r);if(!e)return"";let i;try{i=new URL(e,n)}catch{return""}const o=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\])$/i.test(i.hostname);return s?i.origin:o?"":i.origin}const Ke=ZS();const eb=40*1024*1024;function tb(e){return e==="viewer"||e==="compare"}function fm(e){return`${Ke}/thumb?path=${encodeURIComponent(e)}`}function hm(e){return`${Ke}/file?path=${encodeURIComponent(e)}`}const Cc="lenslet.client_id",pm="lenslet.client_id.session",hx="lenslet.last_event_id",nb=1e3,rb=3e4,sb=5;let Wd=null,va=null,mm=0,Si=null,bi=0,Su=!0,Xa=!1;function px(){return typeof window<"u"&&typeof EventSource<"u"}function gm(e,t){if(!e)return null;try{return e.getItem(t)}catch{return null}}function vm(e,t,n){if(e)try{e.setItem(t,n)}catch{}}function ib(e,t){if(e)try{e.removeItem(t)}catch{}}function ob(){if(typeof navigator>"u")return"server";const e=navigator.userAgent||"",t=navigator.language||"",n=navigator.platform||"",r=typeof Intl<"u"&&Intl.DateTimeFormat().resolvedOptions().timeZone||"",s=typeof screen<"u"?`${screen.width}x${screen.height}x${screen.colorDepth}`:"";return[e,t,n,r,s].join("|")}function lb(e){let t=2166136261;for(let n=0;n<e.length;n+=1)t^=e.charCodeAt(n),t=t*16777619>>>0;return t.toString(16).padStart(8,"0")}function ym(){return typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`client_${Math.random().toString(36).slice(2,10)}_${Date.now()}`}function ho(e){return Wd=e,e}function qa(e){if(typeof window>"u")return null;try{return e==="local"?window.localStorage:window.sessionStorage}catch{return null}}function Hi(){if(Wd)return Wd;const e=qa("local"),t=qa("session"),n=gm(t,pm);if(n)return ho(n);const r=gm(e,Cc);if(t){const i=ym();return vm(t,pm,i),r&&ib(e,Cc),ho(i)}if(r)return ho(r);if(e){const i=ym();return vm(e,Cc,i),ho(i)}const s=`fp_${lb(ob())}_${Math.random().toString(36).slice(2,8)}`;return ho(s)}function Zo(e="lenslet"){mm+=1;const t=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`nonce_${Math.random().toString(36).slice(2,10)}_${Date.now()}_${mm}`;return`${e}:${Hi()}:${t}`}function ab(){if(va!=null)return va;if(typeof window>"u")return null;const e=qa("local");if(!e)return null;try{const t=e.getItem(hx);if(!t)return null;const n=Number(t);return!Number.isFinite(n)||n<=0?null:(va=n,n)}catch{return null}}function ub(e){if(!Number.isFinite(e)||e<=0||(va=e,typeof window>"u"))return;const t=qa("local");if(t)try{t.setItem(hx,String(e))}catch{}}function cb(){if(typeof window>"u")return`${Ke}/events`;const e=new URL(`${Ke}/events`,window.location.origin),t=ab();return t!=null&&Number.isFinite(t)&&e.searchParams.set("last_event_id",String(t)),e.toString()}function db(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}let Ln=null,mx="idle";const Qd=new Set,Kd=new Set,Yd=new Set;function Ci(e){mx=e;for(const t of Kd)t(e)}function lh(e){if(Xa!==e){Xa=e;for(const t of Yd)t(e)}}function ah(){Si!=null&&(window.clearTimeout(Si),Si=null)}function fb(){bi=0,ah()}function hb(){if(!Su||Si!=null)return;bi+=1;const e=Math.min(nb*Math.pow(2,bi-1),rb);bi>=sb?(Ci("offline"),lh(!0)):Ci("reconnecting"),Si=window.setTimeout(()=>{Si=null,gx()},e)}function gx(){if(!Su||!px()||(Ln&&Ln.readyState===EventSource.CLOSED&&(Ln.close(),Ln=null),Ln))return;bi>0?Ci("reconnecting"):Ci("connecting");const e=new EventSource(cb());Ln=e;const t=n=>r=>{const s=db(r.data);if(!s)return;const i=r.lastEventId?Number(r.lastEventId):null,o=i!=null&&Number.isFinite(i)?i:null;o!=null&&ub(o);for(const l of Qd)l({type:n,id:o,data:s})};e.addEventListener("item-updated",t("item-updated")),e.addEventListener("metrics-updated",t("metrics-updated")),e.addEventListener("presence",t("presence")),e.onopen=()=>{fb(),lh(!1),Ci("live")},e.onerror=()=>{Ln===e&&(e.close(),Ln=null,hb())}}function pb(){Su=!0,px()&&(ah(),gx())}function mb(){Su=!1,ah(),bi=0,Ln&&(Ln.close(),Ln=null),lh(!1),Ci("offline")}function gb(e){return Qd.add(e),()=>{Qd.delete(e)}}function vb(e){return Kd.add(e),e(mx),()=>{Kd.delete(e)}}function yb(e){return Yd.add(e),e(Xa),()=>{Yd.delete(e)}}function xb(){return Xa}function wb(e,t){const n=JSON.stringify(t),r=`${Ke}${e}`;if(typeof navigator<"u"&&typeof navigator.sendBeacon=="function")try{if(navigator.sendBeacon(r,new Blob([n],{type:"application/json"})))return!0}catch{}if(typeof fetch!="function")return!1;try{return fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0}),!0}catch{return!1}}function Sb(e,t,n){return wb("/presence/leave",{gallery_id:e,lease_id:t,client_id:n??Hi()})}function Xl(e){return e??Hi()}function ql(e,t){return vt(`${Ke}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).promise}function bb(e,t){const n=new URLSearchParams({path:e});return(t==null?void 0:t.page)!=null&&n.set("page",String(t.page)),(t==null?void 0:t.pageSize)!=null&&n.set("page_size",String(t.pageSize)),t!=null&&t.recursive&&n.set("recursive","1"),t!=null&&t.legacyRecursive&&n.set("legacy_recursive","1"),n.toString()}const we={getFolder:(e,t)=>vt(`${Ke}/folders?${bb(e,t)}`).promise,search:(e,t)=>{const n=new URLSearchParams;return e&&n.set("q",e),t&&n.set("path",t),vt(`${Ke}/search?${n}`).promise},getEmbeddings:()=>vt(`${Ke}/embeddings`).promise,searchEmbeddings:e=>vt(`${Ke}/embeddings/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,refreshFolder:e=>{const t=new URLSearchParams({path:e});return vt(`${Ke}/refresh?${t}`,{method:"POST"}).promise},getSidecar:e=>vt(`${Ke}/item?path=${encodeURIComponent(e)}`).promise,patchSidecar:(e,t,n)=>{const s={"Content-Type":"application/json","Idempotency-Key":(n==null?void 0:n.idempotencyKey)??Zo("patch"),"x-client-id":Hi(),"x-updated-by":"web"};return(n==null?void 0:n.ifMatch)!=null&&(s["If-Match"]=String(n.ifMatch)),vt(`${Ke}/item?path=${encodeURIComponent(e)}`,{method:"PATCH",headers:s,body:JSON.stringify(t)}).promise},getMetadata:e=>vt(`${Ke}/metadata?path=${encodeURIComponent(e)}`).promise,putSidecar:(e,t)=>vt(`${Ke}/item?path=${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json","x-client-id":Hi(),"x-updated-by":"web"},body:JSON.stringify(t)}).promise,getHealth:()=>vt(`${Ke}/health`).promise,joinPresence:(e,t,n)=>ql("/presence/join",{gallery_id:e,client_id:Xl(n),lease_id:t}),movePresence:(e,t,n,r)=>ql("/presence/move",{from_gallery_id:e,to_gallery_id:t,client_id:Xl(r),lease_id:n}),leavePresence:(e,t,n)=>ql("/presence/leave",{gallery_id:e,client_id:Xl(n),lease_id:t}),postPresence:(e,t,n)=>ql("/presence",{gallery_id:e,client_id:Xl(n),lease_id:t}),getThumb:e=>Hd.getOrFetch(e,()=>Yl(fm(e))),prefetchThumb:e=>{Hd.prefetch(e,()=>Yl(fm(e)))},getFile:e=>ni.getOrFetch(e,()=>Yl(hm(e))),prefetchFile:async(e,t)=>{if(tb(t)&&!(ni.has(e)||ni.isInflight(e)))try{const n=await Yl(hm(e),{headers:{"x-lenslet-prefetch":t}}).promise;n.size<=eb&&ni.set(e,n)}catch{}},cancelPrefetch:e=>{ni.cancelPrefetch(e)},uploadFile:async(e,t)=>{const n=new FormData;return n.append("dest",e),n.append("file",t),vt(`${Ke}/file`,{method:"POST",body:n,timeoutMs:6e4}).promise},moveFile:async(e,t)=>{const n=new FormData;return n.append("src",e),n.append("dest",t),vt(`${Ke}/move`,{method:"POST",body:n}).promise},deleteFiles:async e=>vt(`${Ke}/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paths:e})}).promise,exportIntent:async e=>{const t=new FormData;return t.append("path",e),vt(`${Ke}/export-intent`,{method:"POST",body:t}).promise},getViews:()=>vt(`${Ke}/views`).promise,saveViews:e=>vt(`${Ke}/views`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise};class Cb{constructor(t=400){ot(this,"cache",new Map);ot(this,"maxSize");this.maxSize=t,typeof window<"u"&&window.addEventListener("beforeunload",()=>this.clear(),{once:!0})}get(t){const n=this.cache.get(t);return n&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){for(this.cache.has(t)&&this.cache.delete(t);this.cache.size>=this.maxSize;){const r=this.cache.keys().next().value;if(r===void 0)break;const s=this.cache.get(r);if(this.cache.delete(r),s)try{URL.revokeObjectURL(s)}catch{}}this.cache.set(t,n)}clear(){for(const t of this.cache.values())try{URL.revokeObjectURL(t)}catch{}this.cache.clear()}}const kc=new Cb(400);function kb({path:e,name:t,onClick:n,selected:r,highlighted:s,highlightKey:i,displayW:o,displayH:l,ioRoot:u,isScrolling:d,priority:f}){const h=c.useRef(null),[p,S]=c.useState(()=>kc.get(e)??null),[w,E]=c.useState(!1),[j,v]=c.useState(()=>!!p);c.useEffect(()=>{const x=h.current;if(!x)return;const y=new IntersectionObserver(k=>{for(const R of k)R.target===x&&E(R.isIntersecting||R.intersectionRatio>0)},{root:u??null,rootMargin:"200px 0px",threshold:.01});return y.observe(x),()=>{y.unobserve(x),y.disconnect()}},[u]),c.useEffect(()=>{if(p||!(w&&!d||f))return;let x=!0;return we.getThumb(e).then(y=>{if(!x)return;const k=URL.createObjectURL(y);kc.set(e,k),S(k)}).catch(()=>{}),()=>{x=!1}},[e,p,w,d,f]),c.useEffect(()=>{var y;if(!p){v(!1);return}const x=(y=h.current)==null?void 0:y.querySelector("img");x&&x.complete&&x.naturalWidth>0?v(!0):v(!1)},[p]),c.useEffect(()=>{S(kc.get(e)??null)},[e]);const m=["absolute inset-0 relative bg-hover border border-border rounded-lg overflow-hidden select-none",r?"outline-2 outline-accent":"",s?"thumb-updated-ring":"","hover:outline hover:outline-1 hover:outline-accent"].filter(Boolean).join(" ");return a.jsx("div",{ref:h,"data-highlight-key":i??void 0,className:m,onClick:n,children:p?a.jsx("img",{className:`w-full h-full object-cover block pointer-events-none select-none opacity-0 transition-opacity duration-[160ms] ${j?"opacity-100":""}`,src:p,alt:t,loading:"lazy",decoding:"async",onLoad:()=>v(!0),width:o?Math.round(o):void 0,height:l?Math.round(l):void 0}):null})}function ei(e,t,n){let r=n.initialDeps??[],s,i=!0;function o(){var l,u,d;let f;n.key&&((l=n.debug)!=null&&l.call(n))&&(f=Date.now());const h=e();if(!(h.length!==r.length||h.some((w,E)=>r[E]!==w)))return s;r=h;let S;if(n.key&&((u=n.debug)!=null&&u.call(n))&&(S=Date.now()),s=t(...h),n.key&&((d=n.debug)!=null&&d.call(n))){const w=Math.round((Date.now()-f)*100)/100,E=Math.round((Date.now()-S)*100)/100,j=E/16,v=(m,x)=>{for(m=String(m);m.length<x;)m=" "+m;return m};console.info(`%c ${v(E,5)} /${v(w,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*j,120))}deg 100% 31%);`,n==null?void 0:n.key)}return n!=null&&n.onChange&&!(i&&n.skipInitialOnChange)&&n.onChange(s),i=!1,s}return o.updateDeps=l=>{r=l},o}function xm(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const Eb=(e,t)=>Math.abs(e-t)<1.01,Nb=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},wm=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},jb=e=>e,Mb=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},Rb=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=o=>{const{width:l,height:u}=o;t({width:Math.round(l),height:Math.round(u)})};if(s(wm(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(o=>{const l=()=>{const u=o[0];if(u!=null&&u.borderBoxSize){const d=u.borderBoxSize[0];if(d){s({width:d.inlineSize,height:d.blockSize});return}}s(wm(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},Sm={passive:!0},bm=typeof window>"u"?!0:"onscrollend"in window,Pb=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&bm?()=>{}:Nb(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),o=f=>()=>{const{horizontal:h,isRtl:p}=e.options;s=h?n.scrollLeft*(p&&-1||1):n.scrollTop,i(),t(s,f)},l=o(!0),u=o(!1);u(),n.addEventListener("scroll",l,Sm);const d=e.options.useScrollendEvent&&bm;return d&&n.addEventListener("scrollend",u,Sm),()=>{n.removeEventListener("scroll",l),d&&n.removeEventListener("scrollend",u)}},Tb=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},Lb=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const o=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class _b{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:jb,rangeExtractor:Mb,onChange:()=>{},measureElement:Tb,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=ei(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let o=r-1;o>=0;o--){const l=n[o];if(s.has(l.lane))continue;const u=i.get(l.lane);if(u==null||l.end>u.end?i.set(l.lane,l):l.end<u.end&&s.set(l.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=ei(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(n,r,s,i,o,l)=>(this.prevLanes!==void 0&&this.prevLanes!==l&&(this.lanesChangedFlag=!0),this.prevLanes=l,this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=ei(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l},u)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>n)for(const p of this.laneAssignments.keys())p>=n&&this.laneAssignments.delete(p);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(p=>{this.itemSizeCache.set(p.key,p.size)}));const d=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===n&&(this.lanesSettling=!1);const f=this.measurementsCache.slice(0,d),h=new Array(l).fill(void 0);for(let p=0;p<d;p++){const S=f[p];S&&(h[S.lane]=p)}for(let p=d;p<n;p++){const S=i(p),w=this.laneAssignments.get(p);let E,j;if(w!==void 0&&this.options.lanes>1){E=w;const y=h[E],k=y!==void 0?f[y]:void 0;j=k?k.end+this.options.gap:r+s}else{const y=this.options.lanes===1?f[p-1]:this.getFurthestMeasurement(f,p);j=y?y.end+this.options.gap:r+s,E=y?y.lane:p%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(p,E)}const v=u.get(S),m=typeof v=="number"?v:this.options.estimateSize(p),x=j+m;f[p]={index:p,start:j,size:m,end:x,key:S,lane:E},h[E]=p}return this.measurementsCache=f,f},{key:!1,debug:()=>this.options.debug}),this.calculateRange=ei(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?Ib({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=ei(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,o)=>i===null||o===null?[]:n({startIndex:i,endIndex:o,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==n&&(l&&this.observer.unobserve(l),this.observer.observe(n),this.elementsCache.set(o,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,o=r-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,o,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=ei(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,o=n.length;i<o;i++){const l=n[i],u=r[l];s.push(u)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return xm(r[vx(0,r.length-1,s=>xm(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),o=this.getScrollOffset();r==="auto"&&(r=n>=o+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),o=this.getScrollOffset();if(r==="auto")if(s.end>=o+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=o+this.options.scrollPaddingStart)r="start";else return[o,r];const l=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),n=Math.max(0,Math.min(n,this.options.count-1));let i=0;const o=10,l=d=>{if(!this.targetWindow)return;const f=this.getOffsetForIndex(n,d);if(!f){console.warn("Failed to get offset for index:",n);return}const[h,p]=f;this._scrollToOffset(h,{adjustments:void 0,behavior:s}),this.targetWindow.requestAnimationFrame(()=>{const S=this.getScrollOffset(),w=this.getOffsetForIndex(n,p);if(!w){console.warn("Failed to get offset for index:",n);return}Eb(w[0],S)||u(p)})},u=d=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(d)):console.warn(`Failed to scroll to index ${n} after ${o} attempts.`))};l(r)},this.scrollBy=(n,{behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=r.length-1;for(;o>=0&&i.some(l=>l===null);){const l=r[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}s=Math.max(...i.filter(l=>l!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(t)}}const vx=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function Ib({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=u=>e[u].start;if(e.length<=r)return{startIndex:0,endIndex:s};let o=vx(0,s,i,n),l=o;if(r===1)for(;l<s&&e[l].end<n+t;)l++;else if(r>1){const u=Array(r).fill(0);for(;l<s&&u.some(f=>f<n+t);){const f=e[l];u[f.lane]=f.end,l++}const d=Array(r).fill(n+t);for(;o>=0&&d.some(f=>f>=n);){const f=e[o];d[f.lane]=f.start,o--}o=Math.max(0,o-o%r),l=Math.min(s,l+(r-1-l%r))}return{startIndex:o,endIndex:l}}const Cm=typeof document<"u"?c.useLayoutEffect:c.useEffect;function Fb(e){const t=c.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var o;i?xu.flushSync(t):t(),(o=e.onChange)==null||o.call(e,s,i)}},[r]=c.useState(()=>new _b(n));return r.setOptions(n),Cm(()=>r._didMount(),[]),Cm(()=>r._willUpdate()),r}function Ob(e){return Fb({observeElementRect:Rb,observeElementOffset:Pb,scrollToFn:Lb,...e})}function Ab({containerW:e,gap:t,targetCell:n,aspect:r,captionH:s}){const i=Math.max(1,Math.floor((e+t)/(n+t))),o=(e-t*(i-1))/i,l=o*r.h/r.w,u=l+s+t;return{columns:i,cellW:o,mediaH:l,rowH:u}}const Db=1.333;function zb({items:e,containerWidth:t,targetHeight:n,gap:r,captionH:s}){if(t<=0)return[];const i=[];let o=[],l=0;const u=(d,f)=>({index:i.length,height:f+s+r,imageH:f,items:d.map(h=>({item:h.item,displayW:h.aspect*f,displayH:f,originalIndex:h.originalIndex}))});for(let d=0;d<e.length;d++){const f=e[d],h=f.w>0&&f.h>0?f.w/f.h:Db;o.push({item:f,aspect:h,originalIndex:d}),l+=h;const p=(o.length-1)*r;if(l*n+p>=t){const w=(t-p)/l;i.push(u(o,w)),o=[],l=0}}return o.length>0&&i.push(u(o,n)),i}function $b(e,t,n){return{mode:"adaptive",rows:zb({items:t,containerWidth:e,targetHeight:n.targetCell,gap:n.gap,captionH:n.captionH})}}function Bb(e,t,n){const{columns:r,cellW:s,mediaH:i,rowH:o}=Ab({containerW:e,gap:n.gap,targetCell:n.targetCell,aspect:n.aspect,captionH:n.captionH}),l=Math.ceil(t.length/Math.max(1,r));return{mode:"grid",columns:r,cellW:s,mediaH:i,rowH:o,rowCount:l}}function Ub(e,t,n){const[r,s]=c.useState(0);c.useLayoutEffect(()=>{const u=e.current;if(!u)return;const d=()=>{const h=getComputedStyle(u),p=u.clientWidth-parseFloat(h.paddingLeft)-parseFloat(h.paddingRight);s(p)},f=new ResizeObserver(d);return f.observe(u),d(),()=>f.disconnect()},[]);const i=c.useMemo(()=>n.viewMode==="adaptive"?$b(r,t,n):Bb(r,t,n),[r,t,n.viewMode,n.gap,n.targetCell,n.aspect.w,n.aspect.h,n.captionH]),o=Ob({count:i.mode==="adaptive"?i.rows.length:i.rowCount,getScrollElement:()=>e.current,estimateSize:u=>i.mode==="adaptive"?i.rows[u].height:i.rowH,overscan:8}),l=o.getVirtualItems();return c.useEffect(()=>{o.measure()},[i,o]),{width:r,layout:i,rowVirtualizer:o,virtualRows:l}}function Vb(e,t,n,r){if(!e.length)return null;const s=n?e.findIndex(l=>l.path===n):0,i=Math.max(1,t);let o=s;if(r.key==="ArrowRight"||r.key==="d")o=Math.min(e.length-1,s+1);else if(r.key==="ArrowLeft"||r.key==="a")o=Math.max(0,s-1);else if(r.key==="ArrowDown"||r.key==="s")o=Math.min(e.length-1,s+i);else if(r.key==="ArrowUp"||r.key==="w")o=Math.max(0,s-i);else return r.key==="Enter"&&n?"open":null;return o}function Hb(e,t,n){const r=[];for(const s of e){if(t.mode==="adaptive"){const l=t.rows[s.index];if(!l)continue;for(const u of l.items)r.push(u.item.path);continue}const i=s.index*t.columns,o=n.slice(i,i+t.columns);for(const l of o)r.push(l.path)}return Array.from(new Set(r))}const Wb=500,Qb=450,Kb=600,Yb=8;function Xb(e){return Math.max(Qb,Math.min(Kb,e))}class qb{constructor(t){ot(this,"delayMs");ot(this,"moveTolerancePx");ot(this,"onLongPress");ot(this,"onCancel");ot(this,"timerId",null);ot(this,"activePointerId",null);ot(this,"startX",0);ot(this,"startY",0);ot(this,"lastEvent",null);ot(this,"fired",!1);this.delayMs=Xb(t.delayMs??Wb),this.moveTolerancePx=Math.max(0,t.moveTolerancePx??Yb),this.onLongPress=t.onLongPress,this.onCancel=t.onCancel}pointerDown(t){return(t.pointerType??"mouse")==="mouse"?!1:t.isPrimary===!1?(this.cancel("multitouch"),!1):this.activePointerId!=null&&this.activePointerId!==t.pointerId?(this.cancel("multitouch"),!1):(this.activePointerId=t.pointerId,this.startX=t.clientX,this.startY=t.clientY,this.lastEvent=t,this.fired=!1,this.clearTimer(),this.timerId=setTimeout(()=>{this.activePointerId==null||this.fired||this.lastEvent==null||(this.fired=!0,this.clearTimer(),this.onLongPress(this.lastEvent))},this.delayMs),!0)}pointerMove(t){if(!this.matchesPointer(t.pointerId)||this.fired)return;this.lastEvent=t;const n=t.clientX-this.startX,r=t.clientY-this.startY;Math.hypot(n,r)>this.moveTolerancePx&&this.cancel("movement")}pointerUp(t){if(!(t!=null&&!this.matchesPointer(t))){if(!this.fired){this.cancel("pointerup");return}this.reset()}}pointerCancel(t){t!=null&&!this.matchesPointer(t)||this.cancel("pointercancel")}cancelFromScroll(){this.cancel("scroll")}destroy(){this.cancel("cleanup")}matchesPointer(t){return this.activePointerId!=null&&this.activePointerId===t}clearTimer(){this.timerId!=null&&(clearTimeout(this.timerId),this.timerId=null)}reset(){this.clearTimer(),this.activePointerId=null,this.lastEvent=null,this.fired=!1}cancel(t){var r;const n=this.timerId!=null&&!this.fired&&t!=="cleanup";this.reset(),n&&((r=this.onCancel)==null||r.call(this,t))}}function Gb(e){return e==="touch"||e==="pen"}function Jb(e){return e.multiSelectMode||e.isShift||e.isToggle||!Gb(e.pointerType)?!1:e.selectedPaths.length===1&&e.selectedPaths[0]===e.path}function km(e,t){return e.includes(t)?e.filter(n=>n!==t):[...e,t]}const ur=12,Zb=44,eC={w:4,h:3},tC=350,nC=120;function rC(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Em(e){return{pointerId:e.pointerId,pointerType:e.pointerType,clientX:e.clientX,clientY:e.clientY,isPrimary:e.isPrimary}}function sC(e,t){var s,i;let n=0,r=e.length-1;for(;n<=r;){const o=n+r>>1,l=e[o],u=((s=l.items[0])==null?void 0:s.originalIndex)??-1,d=((i=l.items[l.items.length-1])==null?void 0:i.originalIndex)??-1;if(t>=u&&t<=d)return o;t<u?r=o-1:n=o+1}return 0}function iC(e,t){const n=(t??"").trim();if(!n)return e;const r=e.toLowerCase().indexOf(n.toLowerCase());if(r===-1)return e;const s=e.slice(0,r),i=e.slice(r,r+n.length),o=e.slice(r+n.length);return a.jsxs(a.Fragment,{children:[s,a.jsx("mark",{className:"bg-accent/20 text-inherit rounded px-0.5",children:i}),o]})}function oC({items:e,selected:t,restoreToSelectionToken:n,multiSelectMode:r=!1,onSelectionChange:s,onOpenViewer:i,onContextMenuItem:o,onOpenItemActions:l,highlight:u,recentlyUpdated:d,onVisiblePathsChange:f,suppressSelectionHighlight:h=!1,viewMode:p="grid",targetCellSize:S=220,scrollRef:w,hideScrollbar:E=!1}){const[j,v]=c.useState(null),[m,x]=c.useState(null),[y,k]=c.useState(!1),[R,M]=c.useState(null),[N,O]=c.useState(null),T=c.useRef(null),X=c.useRef(null),J=c.useRef(null),$=w??J,oe=c.useRef(null),Q=c.useRef(new Set),A=c.useRef(null),_=c.useRef(null),P=c.useRef(null),D=c.useRef(null),V=c.useRef({path:null,pointerType:null}),ee=S,{width:se,layout:I,rowVirtualizer:U,virtualRows:Y}=Ub($,e,{gap:ur,targetCell:ee,aspect:eC,captionH:Zb,viewMode:p}),Z=c.useMemo(()=>{const z=new Map;for(let ne=0;ne<e.length;ne++)z.set(e[ne].path,ne);return z},[e]),q=c.useMemo(()=>{if(I.mode!=="adaptive")return null;const z=new Map;return I.rows.forEach((ne,K)=>{let le=0;ne.items.forEach((ge,xe)=>{const de=le+ge.displayW/2;z.set(ge.item.path,{row:K,center:de,order:xe}),le+=ge.displayW+ur})}),z},[I]);c.useEffect(()=>{if(!t.length)return;const z=t[0];R!==z&&M(z)},[t,R]);const te=c.useMemo(()=>{if(I.mode!=="adaptive")return null;let z=0;return I.rows.map(ne=>{const K=z;return z+=ne.height,{start:K,height:ne.height}})},[I]),he=c.useRef(null),Ee=(z,ne)=>{try{if(he.current!=null){try{cancelAnimationFrame(he.current)}catch{}he.current=null}const K=z.scrollTop,le=ne-K;if(Math.abs(le)<1){z.scrollTop=ne;return}const ge=140,xe=performance.now(),de=Pe=>1-Math.pow(1-Pe,3),Ce=Pe=>{const mt=Math.min(1,(Pe-xe)/ge),ze=de(mt);z.scrollTop=K+le*ze,mt<1?he.current=requestAnimationFrame(Ce):he.current=null};he.current=requestAnimationFrame(Ce)}catch{z.scrollTop=ne}},[ye,Oe]=c.useState(!1);c.useEffect(()=>{const z=$.current;if(!z)return;let ne=0;const K=()=>{var le;(le=A.current)==null||le.cancelFromScroll(),Oe(!0),window.clearTimeout(ne),ne=window.setTimeout(()=>Oe(!1),nC)};return z.addEventListener("scroll",K,{passive:!0}),()=>z.removeEventListener("scroll",K)},[]),c.useEffect(()=>{const z=new qb({onLongPress:ne=>{const K=_.current;if(!K||!l)return;const le=P.current??{x:ne.clientX,y:ne.clientY};l(K,le),D.current={path:K,untilMs:Date.now()+700}}});return A.current=z,()=>{z.destroy(),A.current===z&&(A.current=null)}},[l]);const Se=()=>{X.current!=null&&(window.clearTimeout(X.current),X.current=null)},_e=()=>{if(Se(),k(!1),v(null),T.current){try{URL.revokeObjectURL(T.current)}catch{}T.current=null}x(null)},ct=z=>{ye||(Se(),v(z),k(!1),X.current=window.setTimeout(async()=>{X.current=null;try{const ne=await we.getFile(z),K=URL.createObjectURL(ne);if(T.current)try{URL.revokeObjectURL(T.current)}catch{}T.current=K,x(K),k(!0)}catch{}},tC))},St=I.mode==="grid"?I.columns:Math.max(1,Math.floor(se/(ee+ur))),cn=(z,ne)=>{if(I.mode!=="adaptive")return null;const K=I.rows[z];if(!K)return null;let le=0,ge=null;for(const xe of K.items){const de=le+xe.displayW/2,Ce=Math.abs(de-ne);(!ge||Ce<ge.dist)&&(ge={path:xe.item.path,dist:Ce}),le+=xe.displayW+ur}return ge?ge.path:null},$n=(z,ne)=>{var ze,bt,Tt,hn;if(!e.length)return null;const K=z??e[0].path;if(I.mode!=="adaptive"){const nt=Vb(e,St,K,ne);return nt==="open"||nt==null?nt:((ze=e[nt])==null?void 0:ze.path)??null}const le=q==null?void 0:q.get(K);if(!le)return K;const ge=Z.get(K)??0,xe=ne.key;if(xe==="Enter")return"open";if(xe==="ArrowRight"||xe==="d")return((bt=e[Math.min(e.length-1,ge+1)])==null?void 0:bt.path)??K;if(xe==="ArrowLeft"||xe==="a")return((Tt=e[Math.max(0,ge-1)])==null?void 0:Tt.path)??K;const de=xe==="ArrowDown"||xe==="s"?1:xe==="ArrowUp"||xe==="w"?-1:0;if(de===0)return null;const Ce=le.row+de;if(Ce<0||Ce>=(((hn=I.rows)==null?void 0:hn.length)??0))return K;const Pe=le.center;return cn(Ce,Pe)??K},Jt=z=>{var ne;try{(ne=document.getElementById(`cell-${encodeURIComponent(z)}`))==null||ne.focus()}catch{}},et=c.useCallback(z=>{try{we.prefetchThumb(z)}catch{}},[]),Zt=c.useCallback((z,ne)=>{l==null||l(z,ne)},[l]),Ut=()=>{_.current=null,P.current=null},dn=(z,ne)=>{var K;ne.target.closest("[data-grid-action]")||(V.current={path:z,pointerType:ne.pointerType},!r&&(_.current=z,P.current={x:ne.clientX,y:ne.clientY},(K=A.current)==null||K.pointerDown(Em(ne))))},Nn=z=>{var ne;r||(P.current={x:z.clientX,y:z.clientY},(ne=A.current)==null||ne.pointerMove(Em(z)))},fn=z=>{var ne;r||((ne=A.current)==null||ne.pointerUp(z.pointerId),Ut())},tt=z=>{var ne;r||((ne=A.current)==null||ne.pointerCancel(z.pointerId),Ut())},pt=(z,ne)=>{const K=D.current;if(K&&K.path===z&&K.untilMs>Date.now()){D.current=null,Jt(z);return}K&&K.untilMs<=Date.now()&&(D.current=null),M(z),O(z);const le=!!ne.shiftKey,ge=!!(ne.ctrlKey||ne.metaKey);if(r)s(km(t,z)),oe.current=z;else if(Jb({pointerType:V.current.path===z?V.current.pointerType:null,multiSelectMode:r,isShift:le,isToggle:ge,selectedPaths:t,path:z}))s([z]),oe.current=z,i(z);else if(le){const xe=oe.current??R??t[0]??z,de=Z.get(xe)??e.findIndex(Pe=>Pe.path===xe),Ce=Z.get(z)??e.findIndex(Pe=>Pe.path===z);if(de!==-1&&Ce!==-1){const Pe=Math.min(de,Ce),mt=Math.max(de,Ce),ze=e.slice(Pe,mt+1).map(bt=>bt.path);if(ge){const bt=new Set(t);for(const Tt of ze)bt.add(Tt);s(Array.from(bt))}else s(ze)}else s([z])}else ge?(s(km(t,z)),oe.current=z):(s([z]),oe.current=z);ye||et(z),Jt(z)},en=(z,ne)=>{var K,le;try{const ge=Pt.has(z)&&t.length>0?t:[z];(K=ne.dataTransfer)==null||K.setData("application/x-lenslet-paths",JSON.stringify(ge)),ne.dataTransfer&&(ne.dataTransfer.effectAllowed="copyMove");try{document.body.classList.add("drag-active")}catch{}const de=ne.currentTarget.querySelector(".cell-content img"),Ce=document.createElement("div");Ce.className="drag-ghost";const Pe=document.createElement("img");Pe.draggable=!1,Pe.alt="drag",de&&de.src&&(Pe.src=de.src),Ce.appendChild(Pe),document.body.appendChild(Ce);const mt=Ce.getBoundingClientRect().width||150;(le=ne.dataTransfer)==null||le.setDragImage(Ce,Math.round(mt/2),0);const ze=()=>{try{Ce.remove()}catch{}try{document.body.classList.remove("drag-active")}catch{}window.removeEventListener("dragend",ze),window.removeEventListener("pointerup",ze),document.removeEventListener("visibilitychange",ze)};window.addEventListener("dragend",ze),window.addEventListener("pointerup",ze),document.addEventListener("visibilitychange",ze)}catch{}};c.useEffect(()=>{const z=$.current;if(!z)return;const ne=K=>{var ze,bt,Tt;const le=$n(N,K);if(le==null)return;if(K.preventDefault(),le==="open"){N&&i(N);return}const ge=e.find(hn=>hn.path===le);if(!ge)return;O(ge.path),M(ge.path),s([ge.path]),oe.current=ge.path;const xe=I.mode==="grid"?Math.floor((Z.get(ge.path)??0)/Math.max(1,I.columns)):((ze=q==null?void 0:q.get(ge.path))==null?void 0:ze.row)??0,de=z.scrollTop,Ce=de+z.clientHeight,Pe=I.mode==="adaptive"?((bt=te==null?void 0:te[xe])==null?void 0:bt.start)??0:xe*I.rowH,mt=I.mode==="adaptive"?Pe+(((Tt=te==null?void 0:te[xe])==null?void 0:Tt.height)??0):Pe+I.rowH;(Pe<de||mt>Ce)&&Ee(z,Pe),Jt(ge.path)};return z.addEventListener("keydown",ne),()=>{z.removeEventListener("keydown",ne)}},[e,N,St,i,I,q,te,Z]),c.useLayoutEffect(()=>{var xe;const z=$.current;if(!z||!n||t.length===0)return;const ne=t[0],K=Z.get(ne);if(K==null||K<0)return;const le=I.mode==="grid"?Math.floor(K/Math.max(1,I.columns)):sC(I.rows,K),ge=I.mode==="adaptive"?((xe=te==null?void 0:te[le])==null?void 0:xe.start)??0:le*I.rowH;try{z.scrollTop=ge}catch{}},[n,I,te]);const Pt=c.useMemo(()=>new Set(t),[t]),Bn=!!(j&&m&&y),Je=c.useMemo(()=>Hb(Y,I,e),[e,I,Y]);c.useEffect(()=>{if(!(ye||Je.length===0))for(const z of Je)et(z)},[ye,Je,et]),c.useEffect(()=>{var z;(z=$.current)==null||z.focus()},[]),c.useEffect(()=>{var z;if(h){try{(z=$.current)==null||z.blur()}catch{}O(null)}},[h]);const jn=c.useMemo(()=>{const z=new Set;for(const ne of Y){if(I.mode==="adaptive"){const ge=I.rows[ne.index];if(!ge)continue;for(const xe of ge.items)z.add(xe.item.path);continue}const K=ne.index*I.columns,le=Math.min(e.length,K+I.columns);for(let ge=K;ge<le;ge+=1){const xe=e[ge];xe&&z.add(xe.path)}}return z},[e,I,Y]);c.useEffect(()=>{f&&(rC(Q.current,jn)||(Q.current=jn,f(jn)))},[f,jn]);const jr=N?`cell-${encodeURIComponent(N)}`:void 0;return a.jsx("div",{role:"grid","aria-label":"Gallery",className:`relative h-full overflow-auto p-3 outline-none ${E?"scrollbar-hidden pr-4":"scrollbar-thin"} ${Bn?"cursor-zoom-in":""}`,ref:$,tabIndex:0,"aria-activedescendant":jr,onMouseDown:()=>{var z;return(z=$.current)==null?void 0:z.focus()},style:{"--gap":`${ur}px`},children:a.jsxs("div",{className:"relative w-full",style:{height:U.getTotalSize()},children:[Y.map(z=>{var xe;let ne=[],K={},le="";if(I.mode==="adaptive"){const de=I.rows[z.index];if(!de)return null;ne=de.items,K={height:de.height,transform:`translate3d(0, ${z.start}px, 0)`,display:"flex",gap:ur,paddingBottom:ur},le="absolute top-0 left-0 right-0 w-full will-change-transform"}else{const de=z.index*I.columns;ne=e.slice(de,de+I.columns).map(Pe=>({item:Pe,displayW:I.cellW,displayH:I.mediaH})),K={transform:`translate3d(0, ${z.start}px, 0)`,gridTemplateColumns:`repeat(${I.columns}, minmax(0, 1fr))`,gap:ur,paddingBottom:ur},le="absolute top-0 left-0 right-0 w-full grid will-change-transform"}const ge=z.index===((xe=Y[0])==null?void 0:xe.index);return a.jsx("div",{className:le,role:"row",style:K,children:ne.map(({item:de,displayW:Ce,displayH:Pe})=>{const mt=!h&&(R===de.path||Pt.has(de.path)),ze=(d==null?void 0:d.get(de.path))??null,bt=ze!=null,Tt=I.mode==="adaptive"?{width:Ce}:{},hn=I.mode==="adaptive"?{height:Pe}:{},nt=I.mode==="adaptive"?"relative rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group shrink-0":"relative aspect-[4/3] rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group";return a.jsxs("div",{id:`cell-${encodeURIComponent(de.path)}`,className:`relative min-w-0 ${mt?"outline outline-2 outline-accent outline-offset-2 rounded-[10px]":""}`,role:"gridcell","aria-selected":mt,tabIndex:N===de.path?0:-1,onFocus:()=>O(de.path),draggable:!0,style:Tt,onDragStart:Me=>en(de.path,Me),onPointerDown:Me=>dn(de.path,Me),onPointerMove:Nn,onPointerUp:fn,onPointerCancel:tt,onContextMenu:Me=>{Me.preventDefault(),Me.stopPropagation(),o==null||o(Me,de.path)},children:[a.jsxs("div",{className:nt,style:hn,onDoubleClick:()=>{r||i(de.path)},onMouseLeave:_e,children:[a.jsx("button",{type:"button",className:"grid-item-action-btn touch-manipulation","data-grid-action":"1","aria-label":`Open actions for ${de.name}`,"aria-haspopup":"menu",onPointerDown:Me=>Me.stopPropagation(),onClick:Me=>{Me.stopPropagation();const Mn=Me.currentTarget.getBoundingClientRect();Zt(de.path,{x:Mn.right-4,y:Mn.bottom-4})},children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})}),a.jsx("div",{className:"cell-content absolute inset-0",children:a.jsx(kb,{path:de.path,name:de.name,selected:mt,highlighted:bt,highlightKey:ze,displayW:Ce,displayH:Pe,ioRoot:$.current,isScrolling:ye,priority:ge,onClick:Me=>pt(de.path,Me)})}),a.jsx("div",{className:"absolute right-0 bottom-0 w-7 h-7 cursor-zoom-in",onMouseEnter:()=>ct(de.path),onMouseLeave:_e,children:a.jsx("div",{className:"grid-item-preview-corner absolute right-0 bottom-0 h-[18px] w-[18px] flex items-center justify-center text-text select-none",style:{clipPath:'path("M0 9C0 4.02944 4.02944 0 9 0H18V18H0V9Z")',background:"linear-gradient(135deg, rgba(18,18,18,0.9) 0%, rgba(34,34,34,0.9) 60%, rgba(22,22,22,0.9) 100%)",borderTop:"1px solid rgba(255,255,255,0.08)",borderLeft:"1px solid rgba(255,255,255,0.08)",boxShadow:"0 1px 2px rgba(0,0,0,0.45)",backdropFilter:"blur(1px)"},children:a.jsxs("svg",{width:"11",height:"11",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round",className:"text-[#d9dce2]","aria-hidden":"true",style:{transform:"translate(0px,0px)"},children:[a.jsx("circle",{cx:"11",cy:"11",r:"5.4"}),a.jsx("path",{d:"M15.5 15.5 L19 19"})]})})})]}),a.jsxs("div",{className:"flex flex-col items-center text-center gap-0 mt-1 px-0.5 text-white/90",children:[a.jsx("div",{className:"text-sm leading-[18px] thumb-filename line-clamp-2 break-words hyphens-auto text-center",title:de.name,children:iC(de.name,u)}),a.jsxs("div",{className:"text-[11px] leading-[15px] opacity-70",children:[de.w,"  ",de.h]})]})]},de.path)})},z.key)}),j&&m&&y&&xu.createPortal(a.jsx("div",{className:"toolbar-offset fixed inset-0 z-[999] flex items-center justify-center pointer-events-none bg-black/20 opacity-100",children:a.jsx("img",{src:m,alt:"preview",className:"max-w-[80vw] max-h-[80vh] object-contain opacity-[0.98]"})}),document.body)]},`${p}-${St}`)})}const lC=48,aC=[.1,.24,.5,.74,.9];function uC({items:e,metricKey:t,scrollRef:n,sortDir:r}){const{orderedValues:s,numericValues:i}=c.useMemo(()=>{var T;const N=[],O=[];for(const X of e){const J=(T=X.metrics)==null?void 0:T[t],$=J==null||Number.isNaN(J)?null:J;N.push($),$!=null&&O.push($)}return{orderedValues:N,numericValues:O}},[e,t]),o=c.useMemo(()=>cC(i,lC),[i]),l=c.useMemo(()=>dC(i,aC),[i]),[u,d]=c.useState(0),[f,h]=c.useState(null),[p,S]=c.useState(!1),w=c.useRef(null);if(c.useEffect(()=>{const N=n.current;if(!N)return;const O=()=>{const T=Math.max(1,N.scrollHeight-N.clientHeight),X=Cs(T>0?N.scrollTop/T:0);d(X)};return O(),N.addEventListener("scroll",O,{passive:!0}),window.addEventListener("resize",O),()=>{N.removeEventListener("scroll",O),window.removeEventListener("resize",O)}},[n,e.length]),c.useEffect(()=>{h(null)},[t,e.length]),!o)return null;const E={min:o.min,max:o.max},j=f!=null?jm(f):null,v=jm(u),m=r==="desc",x=c.useMemo(()=>f==null?null:pC(s,f),[s,f]);function y(N){h(Cs(N))}function k(){h(null)}function R(N){const O=n.current;if(!O)return;const T=Math.max(0,O.scrollHeight-O.clientHeight);O.scrollTop=Cs(N)*T}function M(N){var T;const O=(T=w.current)==null?void 0:T.getBoundingClientRect();return O?Cs((N.clientY-O.top)/O.height):null}return a.jsxs("div",{className:"absolute right-0 top-3 bottom-3 w-[14px] flex items-stretch pointer-events-auto",children:[a.jsxs("svg",{ref:w,viewBox:"0 0 10 100",preserveAspectRatio:"none",className:"w-full h-full rounded bg-surface-inset border border-border/60 cursor-ns-resize",onPointerDown:N=>{var T;N.preventDefault();const O=M(N);O!=null&&(S(!0),y(O),R(O),(T=w.current)==null||T.setPointerCapture(N.pointerId))},onPointerMove:N=>{const O=M(N);if(O==null){p||k();return}y(O),p&&R(O)},onPointerUp:N=>{var O;S(!1),(O=w.current)==null||O.releasePointerCapture(N.pointerId)},onPointerLeave:()=>{p||k()},children:[fC(o.bins,"var(--border-strong)",{flip:m}),hC(l,E,{flip:m,color:"var(--muted)"}),Nm(v,{color:"var(--highlight)",strokeWidth:.8}),j!=null&&Nm(j,{color:"var(--text-secondary)",strokeWidth:.6,dashed:!0})]}),x!=null&&f!=null&&a.jsx("div",{className:"pointer-events-none absolute right-full mr-2 px-1.5 py-0.5 rounded border border-border bg-surface text-[10px] text-text shadow",style:{top:`calc(${(f*100).toFixed(2)}% - 8px)`},children:gC(x)})]})}function cC(e,t){if(!e.length)return null;const n=Math.min(...e);let r=Math.max(...e);n===r&&(r=n+1);const s=new Array(t).fill(0),i=t/(r-n);for(const o of e){const l=Math.max(0,Math.min(t-1,Math.floor((o-n)*i)));s[l]+=1}return{bins:s,min:n,max:r}}function dC(e,t){if(!e.length)return[];const n=[...e].sort((s,i)=>s-i),r=n.length-1;return t.map(s=>{const i=r*s,o=Math.floor(i),l=Math.ceil(i);if(o===l)return n[o];const u=i-o;return n[o]+(n[l]-n[o])*u})}function fC(e,t,n){const r=Math.max(1,...e),s=100/e.length,i=(n==null?void 0:n.flip)??!1;return e.map((o,l)=>{const u=Math.max(.8,o/r*10),d=(i?e.length-1-l:l)*s;return a.jsx("rect",{x:10-u,y:d,width:u,height:Math.max(.2,s-.2),fill:t,opacity:.9},`sb-${l}`)})}function hC(e,t,n){const r=(n==null?void 0:n.flip)??!1,s=n==null?void 0:n.color;return e.map((i,o)=>{const l=mC(i,t,r),u=o===2;return a.jsx("line",{x1:0,y1:l,x2:10,y2:l,stroke:s,strokeWidth:u?.8:.5,opacity:u?.9:.6,vectorEffect:"non-scaling-stroke"},`qt-${o}-${i}`)})}function Nm(e,t){return a.jsx("line",{x1:0,y1:e,x2:10,y2:e,stroke:t.color,strokeWidth:t.strokeWidth??.6,strokeDasharray:t.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}function pC(e,t){if(!e.length)return null;const n=Math.round(Cs(t)*(e.length-1)),r=e[n];if(r!=null)return r;for(let s=1;s<e.length;s++){const i=n-s;if(i>=0&&e[i]!=null)return e[i];const o=n+s;if(o<e.length&&e[o]!=null)return e[o]}return null}function mC(e,t,n){const r=t.max-t.min;if(r===0)return 0;const s=Cs((e-t.min)/r);return(n?1-s:s)*100}function jm(e){return Cs(e)*100}function Cs(e){return e<0?0:e>1?1:e}function gC(e){if(e==null||Number.isNaN(e))return"-";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function ks(e,t){const[n,r]=c.useState(null),s=c.useRef(null);return c.useEffect(()=>{if(!e){if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}r(null);return}let i=!0;return e().then(o=>{if(!i)return;const l=URL.createObjectURL(o);if(s.current)try{URL.revokeObjectURL(s.current)}catch{}s.current=l,r(l)}).catch(()=>{}),()=>{i=!1}},t),c.useEffect(()=>()=>{if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}},[]),n}const vC=1.2,yC=.05,xC=8;function Ec(e){return Number(Math.min(xC,Math.max(yC,e)).toFixed(4))}function Mm(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Rm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function wC(e,t){try{e.setPointerCapture(t)}catch{}}function SC(e,t){try{e.releasePointerCapture(t)}catch{}}function bC(){const[e,t]=c.useState(1),[n,r]=c.useState(0),[s,i]=c.useState(0),[o,l]=c.useState(1),[u,d]=c.useState(!1),[f,h]=c.useState(!1),[p,S]=c.useState(!1),w=c.useRef(null),E=c.useRef(null),j=c.useRef(1),v=c.useRef(0),m=c.useRef(0),x=c.useRef(new Map),y=c.useRef(null),k=c.useRef(null),R=(_,P)=>{v.current=_,m.current=P,r(_),i(P)},M=_=>{const P=Ec(_);j.current=P,t(P)},N=(_,P)=>{y.current={pointerId:_,startX:P.x,startY:P.y,startTx:v.current,startTy:m.current},k.current=null,h(!0)},O=()=>{const _=Array.from(x.current.entries());if(_.length<2)return;const[P,D]=_,[V,ee]=P,[se,I]=D,U=Mm(ee,I);!Number.isFinite(U)||U<=2||(k.current={pointerIds:[V,se],startDistance:U,startCenter:Rm(ee,I),startScale:j.current,startTx:v.current,startTy:m.current},y.current=null,h(!0))},T=()=>{const _=w.current,P=E.current;if(!_||!P||!P.naturalWidth||!P.naturalHeight)return;const D=_.getBoundingClientRect(),V=D.width/P.naturalWidth,ee=D.height/P.naturalHeight,se=Math.min(1,Math.min(V,ee));l(se);const I=P.naturalWidth*se,U=P.naturalHeight*se;R((D.width-I)/2,(D.height-U)/2),M(1)};c.useEffect(()=>{const _=w.current;if(!_)return;const P=new ResizeObserver(()=>{try{requestAnimationFrame(()=>T())}catch{T()}});return P.observe(_),()=>P.disconnect()},[]),c.useEffect(()=>{j.current=e,v.current=n,m.current=s},[e,n,s]),c.useEffect(()=>()=>{x.current.clear(),y.current=null,k.current=null},[]);const X=_=>{_.preventDefault();const P=_.deltaY>0?-1:1,D=w.current;if(!D)return;const V=D.getBoundingClientRect(),ee=_.clientX-V.left,se=_.clientY-V.top,I=j.current,U=Ec(I*Math.pow(vC,P));if(U===I)return;const Y=U/I,Z=ee-Y*(ee-v.current),q=se-Y*(se-m.current);M(U),R(Z,q)},J=_=>{if((_.pointerType??"mouse")==="mouse"&&_.button!==0)return;const D=x.current,V=E.current;if(!V||D.size===0&&_.target!==V)return;const ee=_.currentTarget,se=ee.getBoundingClientRect();if(!(_.clientX<se.left||_.clientX>se.right||_.clientY<se.top||_.clientY>se.bottom)){if(_.preventDefault(),_.stopPropagation(),D.set(_.pointerId,{x:_.clientX,y:_.clientY}),wC(ee,_.pointerId),D.size>=2){O();return}N(_.pointerId,{x:_.clientX,y:_.clientY})}},$=_=>{const P=x.current;if(!P.has(_.pointerId))return;P.set(_.pointerId,{x:_.clientX,y:_.clientY});const D=k.current;if(D){const I=P.get(D.pointerIds[0]),U=P.get(D.pointerIds[1]);if(I&&U){const Y=Mm(I,U);if(Y>2){const Z=Rm(I,U),q=Ec(D.startScale*(Y/D.startDistance)),te=q/D.startScale,he=Z.x-te*(D.startCenter.x-D.startTx),Ee=Z.y-te*(D.startCenter.y-D.startTy);M(q),R(he,Ee)}}return}const V=y.current;if(!V||V.pointerId!==_.pointerId)return;const ee=_.clientX-V.startX,se=_.clientY-V.startY;R(V.startTx+ee,V.startTy+se)},oe=(_,P)=>{const D=x.current;if(!D.has(_))return;if(D.delete(_),SC(P,_),D.size===0){y.current=null,k.current=null,h(!1);return}if(D.size>=2){O();return}const[V,ee]=D.entries().next().value;N(V,ee)};return{scale:e,setScale:t,tx:n,setTx:r,ty:s,setTy:i,base:o,setBase:l,ready:u,setReady:d,dragging:f,setDragging:h,visible:p,setVisible:S,containerRef:w,imgRef:E,fitAndCenter:T,handleWheel:X,handlePointerDown:J,handlePointerMove:$,handlePointerUp:_=>{oe(_.pointerId,_.currentTarget)},handlePointerCancel:_=>{oe(_.pointerId,_.currentTarget)}}}function CC({path:e,onClose:t,onNavigate:n,canPrev:r=!1,canNext:s=!1,onZoomChange:i,requestedZoomPercent:o,onZoomRequestConsumed:l}){const{scale:u,setScale:d,tx:f,setTx:h,ty:p,setTy:S,base:w,ready:E,setReady:j,dragging:v,visible:m,setVisible:x,containerRef:y,imgRef:k,fitAndCenter:R,handleWheel:M,handlePointerDown:N,handlePointerMove:O,handlePointerUp:T,handlePointerCancel:X}=bC(),J=ks(()=>we.getFile(e),[e]),$=ks(()=>we.getThumb(e),[e]),oe=c.useCallback(()=>{x(!1),window.setTimeout(t,110)},[t,x]);return c.useEffect(()=>{requestAnimationFrame(()=>{var Q;x(!0),(Q=y.current)==null||Q.focus()})},[e]),c.useEffect(()=>{const Q=A=>{A.key==="Escape"?oe():(A.key==="ArrowRight"||A.key==="d")&&n?n(1):(A.key==="ArrowLeft"||A.key==="a")&&n&&n(-1)};return window.addEventListener("keydown",Q),()=>window.removeEventListener("keydown",Q)},[oe,n]),c.useEffect(()=>{j(!1)},[J]),c.useEffect(()=>{i&&i(w*u*100)},[w,u,i]),c.useEffect(()=>{if(o==null)return;const Q=y.current;if(!Q){l&&l();return}const A=Math.max(.05,Math.min(8,o/100/Math.max(1e-6,w))),_=Q.getBoundingClientRect(),P=_.width/2,D=_.height/2;d(V=>{const ee=A/V;return h(se=>P-ee*(P-se)),S(se=>D-ee*(D-se)),Number(A.toFixed(4))}),l&&l()},[o,w,l]),a.jsxs("div",{ref:y,role:"dialog","aria-modal":!0,"aria-label":"Image viewer",tabIndex:-1,className:`toolbar-offset touch-none absolute inset-0 left-[var(--left)] right-[var(--right)] flex items-start justify-start bg-panel z-viewer overflow-hidden transition-opacity duration-[110ms] ease-out cursor-grab focus:outline-none focus-visible:outline-none ${v?"cursor-grabbing select-none":""} ${m?"opacity-100":"opacity-0"}`,style:{outline:"none"},onClick:oe,onWheel:M,onPointerDown:N,onPointerMove:O,onPointerUp:T,onPointerCancel:X,onKeyDown:Q=>{Q.key==="Tab"&&Q.preventDefault()},children:[a.jsxs("button",{"aria-label":"Close",onClick:Q=>{Q.stopPropagation(),oe()},className:"btn btn-sm absolute top-3 right-3 z-10",title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]}),$&&a.jsx("img",{src:$,alt:"thumb",className:"absolute top-0 left-0 max-w-none max-h-none object-contain pointer-events-none transition-opacity duration-[110ms] ease-out",draggable:!1,onDragStart:Q=>Q.preventDefault(),style:{transform:`translate(${f}px, ${p}px) scale(${w})`,transformOrigin:"0 0",opacity:E?0:.5,filter:"blur(0.25px)"}}),J&&a.jsx("img",{ref:k,src:J,alt:"viewer",className:"max-w-none max-h-none object-contain transition-opacity duration-[110ms] ease-out will-change-transform select-none",draggable:!1,onDragStart:Q=>{Q.preventDefault()},onLoad:Q=>{R(),d(1);try{requestAnimationFrame(()=>j(!0))}catch{j(!0)}},onClick:Q=>Q.stopPropagation(),style:{transform:`translate(${f}px, ${p}px) scale(${w*u})`,transformOrigin:"0 0",opacity:E?.99:0,WebkitUserDrag:"none"}}),n&&a.jsxs("div",{className:"viewer-mobile-nav",onClick:Q=>Q.stopPropagation(),children:[a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${r?"":"is-disabled"}`,onClick:()=>r&&n(-1),"aria-label":"Previous image","aria-disabled":!r,disabled:!r,children:"Prev"}),a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${s?"":"is-disabled"}`,onClick:()=>s&&n(1),"aria-label":"Next image","aria-disabled":!s,disabled:!s,children:"Next"})]})]})}function uh(e){return!e||!(e instanceof HTMLElement)?!1:e.closest('input, textarea, [contenteditable="true"]')!==null}const kC=1.2,EC=.05,NC=8;function Nc(e){return Number(Math.min(NC,Math.max(EC,e)).toFixed(4))}function Pm(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Tm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function jC(e,t){try{e.setPointerCapture(t)}catch{}}function MC(e,t){try{e.releasePointerCapture(t)}catch{}}function RC(){const[e,t]=c.useState(1),[n,r]=c.useState(0),[s,i]=c.useState(0),[o,l]=c.useState(0),[u,d]=c.useState(0),[f,h]=c.useState(1),[p,S]=c.useState(1),[w,E]=c.useState(!1),j=c.useRef(null),v=c.useRef(null),m=c.useRef(null),x=c.useRef(1),y=c.useRef(0),k=c.useRef(0),R=c.useRef(0),M=c.useRef(0),N=c.useRef(new Map),O=c.useRef(null),T=c.useRef(null),X=c.useCallback(I=>{y.current=I.txA,k.current=I.tyA,R.current=I.txB,M.current=I.tyB,r(I.txA),i(I.tyA),l(I.txB),d(I.tyB)},[]),J=c.useCallback(I=>{const U=Nc(I);x.current=U,t(U)},[]),$=c.useCallback((I,U)=>{O.current={pointerId:I,startX:U.x,startY:U.y,startTxA:y.current,startTyA:k.current,startTxB:R.current,startTyB:M.current},T.current=null,E(!0)},[]),oe=c.useCallback(()=>{const I=Array.from(N.current.entries());if(I.length<2)return;const[U,Y]=I,[Z,q]=U,[te,he]=Y,Ee=Pm(q,he);!Number.isFinite(Ee)||Ee<=2||(T.current={pointerIds:[Z,te],startDistance:Ee,startCenter:Tm(q,he),startScale:x.current,startTxA:y.current,startTyA:k.current,startTxB:R.current,startTyB:M.current},O.current=null,E(!0))},[]),Q=c.useCallback((I,U)=>{const Y=N.current;if(!Y.has(I))return;if(Y.delete(I),MC(U,I),Y.size===0){O.current=null,T.current=null,E(!1);return}if(Y.size>=2){oe();return}const[Z,q]=Y.entries().next().value;$(Z,q)},[$,oe]),A=c.useCallback(()=>{const I=j.current;if(!I)return;const U=I.getBoundingClientRect(),Y=te=>{if(!te||!te.naturalWidth||!te.naturalHeight)return;const he=U.width/te.naturalWidth,Ee=U.height/te.naturalHeight,ye=Math.min(1,Math.min(he,Ee)),Oe=te.naturalWidth*ye,Se=te.naturalHeight*ye;return{base:ye,tx:(U.width-Oe)/2,ty:(U.height-Se)/2}},Z=Y(v.current);Z&&(h(Z.base),y.current=Z.tx,k.current=Z.ty,r(Z.tx),i(Z.ty));const q=Y(m.current);q&&(S(q.base),R.current=q.tx,M.current=q.ty,l(q.tx),d(q.ty))},[]);c.useEffect(()=>{const I=j.current;if(!I)return;const U=new ResizeObserver(()=>{try{requestAnimationFrame(()=>A())}catch{A()}});return U.observe(I),()=>U.disconnect()},[A]);const _=c.useCallback(()=>{J(1),A()},[A,J]);c.useEffect(()=>{x.current=e,y.current=n,k.current=s,R.current=o,M.current=u},[e,n,s,o,u]),c.useEffect(()=>()=>{N.current.clear(),O.current=null,T.current=null},[]);const P=c.useCallback(I=>{I.preventDefault();const U=I.deltaY>0?-1:1,Y=j.current;if(!Y)return;const Z=Y.getBoundingClientRect(),q=I.clientX-Z.left,te=I.clientY-Z.top,he=x.current,Ee=Nc(he*Math.pow(kC,U));if(Ee===he)return;const ye=Ee/he;J(Ee),X({txA:q-ye*(q-y.current),tyA:te-ye*(te-k.current),txB:q-ye*(q-R.current),tyB:te-ye*(te-M.current)})},[X,J]),D=c.useCallback(I=>{if((I.pointerType??"mouse")==="mouse"&&I.button!==0)return;const Y=I.currentTarget;if(I.preventDefault(),N.current.set(I.pointerId,{x:I.clientX,y:I.clientY}),jC(Y,I.pointerId),N.current.size>=2){oe();return}$(I.pointerId,{x:I.clientX,y:I.clientY})},[$,oe]),V=c.useCallback(I=>{const U=N.current;if(!U.has(I.pointerId))return;U.set(I.pointerId,{x:I.clientX,y:I.clientY});const Y=T.current;if(Y){const he=U.get(Y.pointerIds[0]),Ee=U.get(Y.pointerIds[1]);if(he&&Ee){const ye=Pm(he,Ee);if(ye>2){const Oe=Tm(he,Ee),Se=Nc(Y.startScale*(ye/Y.startDistance)),_e=Se/Y.startScale;J(Se),X({txA:Oe.x-_e*(Y.startCenter.x-Y.startTxA),tyA:Oe.y-_e*(Y.startCenter.y-Y.startTyA),txB:Oe.x-_e*(Y.startCenter.x-Y.startTxB),tyB:Oe.y-_e*(Y.startCenter.y-Y.startTyB)})}}return}const Z=O.current;if(!Z||Z.pointerId!==I.pointerId)return;const q=I.clientX-Z.startX,te=I.clientY-Z.startY;X({txA:Z.startTxA+q,tyA:Z.startTyA+te,txB:Z.startTxB+q,tyB:Z.startTyB+te})},[X,J]),ee=c.useCallback(I=>{Q(I.pointerId,I.currentTarget)},[Q]),se=c.useCallback(I=>{Q(I.pointerId,I.currentTarget)},[Q]);return{scale:e,baseA:f,baseB:p,txA:n,tyA:s,txB:o,tyB:u,dragging:w,containerRef:j,imgARef:v,imgBRef:m,fitAndCenter:A,resetView:_,handleWheel:P,handlePointerDown:D,handlePointerMove:V,handlePointerUp:ee,handlePointerCancel:se}}function PC({aItem:e,bItem:t,index:n,total:r,canPrev:s,canNext:i,onNavigate:o,onClose:l}){const u=c.useRef(null),[d,f]=c.useState(50),[h,p]=c.useState(!1),[S,w]=c.useState(!1),{scale:E,baseA:j,baseB:v,txA:m,tyA:x,txB:y,tyB:k,dragging:R,containerRef:M,imgARef:N,imgBRef:O,fitAndCenter:T,resetView:X,handleWheel:J,handlePointerDown:$,handlePointerMove:oe,handlePointerUp:Q,handlePointerCancel:A}=RC(),_=(e==null?void 0:e.path)??null,P=(t==null?void 0:t.path)??null,D=(e==null?void 0:e.name)??_??"Select an image",V=(t==null?void 0:t.name)??P??"Select another image";c.useEffect(()=>{requestAnimationFrame(()=>{var te;return(te=u.current)==null?void 0:te.focus()})},[_,P]),c.useEffect(()=>{X(),p(!1),w(!1)},[_,P,X]),c.useEffect(()=>{const te=he=>{if(!uh(he.target)){if(he.key==="Escape"){he.preventDefault(),l();return}if((he.key==="ArrowRight"||he.key==="d")&&i){he.preventDefault(),o(1);return}(he.key==="ArrowLeft"||he.key==="a")&&s&&(he.preventDefault(),o(-1))}};return window.addEventListener("keydown",te),()=>window.removeEventListener("keydown",te)},[l,o,s,i]);const ee=ks(_?()=>we.getFile(_):null,[_]),se=ks(P?()=>we.getFile(P):null,[P]),I=ks(_?()=>we.getThumb(_):null,[_]),U=ks(P?()=>we.getThumb(P):null,[P]),Y=c.useCallback(te=>Math.min(95,Math.max(5,te)),[]),Z=c.useCallback(te=>{const he=te.target;he!=null&&he.closest(".compare-label")||he!=null&&he.closest(".compare-divider-hit")||$(te)},[$]),q=c.useCallback(te=>{const he=M.current;if(!he)return;te.preventDefault(),te.stopPropagation();const Ee=he.getBoundingClientRect(),ye=te.currentTarget;ye.setPointerCapture(te.pointerId);const Oe=_e=>{const ct=(_e.clientX-Ee.left)/Ee.width*100;f(Y(ct))},Se=_e=>{try{ye.releasePointerCapture(_e.pointerId)}catch{}window.removeEventListener("pointermove",Oe),window.removeEventListener("pointerup",Se),window.removeEventListener("pointercancel",Se)};window.addEventListener("pointermove",Oe),window.addEventListener("pointerup",Se),window.addEventListener("pointercancel",Se)},[Y]);return a.jsxs("div",{ref:u,role:"dialog","aria-modal":!0,"aria-label":"Compare images",tabIndex:-1,className:"toolbar-offset absolute inset-0 left-[var(--left)] right-[var(--right)] bg-panel z-viewer flex flex-col overflow-hidden focus:outline-none",onKeyDown:te=>{te.key==="Tab"&&te.preventDefault()},children:[a.jsxs("div",{className:"compare-header flex items-center gap-3 px-3 py-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Compare"}),a.jsx("div",{className:"text-xs text-muted",children:r>=2?`${n+1}-${Math.min(n+2,r)} of ${r}`:"Select 2 images"}),a.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(-1),disabled:!s,title:"Previous (Left Arrow or A)",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Prev"]}),a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(1),disabled:!i,title:"Next (Right Arrow or D)",children:["Next",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"btn btn-sm",onClick:l,title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]})]})]}),a.jsx("div",{className:"flex-1 min-h-0 p-3 bg-panel",children:a.jsx("div",{ref:M,className:`compare-stage ${R?"is-dragging":""}`,onWheel:J,onPointerDown:Z,onPointerMove:oe,onPointerUp:Q,onPointerCancel:A,children:!e||!t?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-sm text-muted",children:"Select 2 images to compare."}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"compare-label left-3",children:[a.jsx("span",{className:"compare-label-tag",children:"A"}),a.jsx("span",{className:"truncate",title:e.path,children:D})]}),a.jsxs("div",{className:"compare-label right-3",children:[a.jsx("span",{className:"compare-label-tag",children:"B"}),a.jsx("span",{className:"truncate",title:t.path,children:V})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 ${100-d}% 0 0)`},children:[I&&a.jsx("img",{src:I,alt:"thumb A",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:te=>te.preventDefault(),style:{transform:`translate(${m}px, ${x}px) scale(${j})`,transformOrigin:"0 0",opacity:h?0:.5}}),ee&&a.jsx("img",{ref:N,src:ee,alt:"compare A",className:"compare-image",draggable:!1,onDragStart:te=>te.preventDefault(),onLoad:()=>{T();try{requestAnimationFrame(()=>p(!0))}catch{p(!0)}},style:{transform:`translate(${m}px, ${x}px) scale(${j*E})`,transformOrigin:"0 0",opacity:h?.99:0}})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 0 0 ${d}%)`},children:[U&&a.jsx("img",{src:U,alt:"thumb B",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:te=>te.preventDefault(),style:{transform:`translate(${y}px, ${k}px) scale(${v})`,transformOrigin:"0 0",opacity:S?0:.5}}),se&&a.jsx("img",{ref:O,src:se,alt:"compare B",className:"compare-image",draggable:!1,onDragStart:te=>te.preventDefault(),onLoad:()=>{T();try{requestAnimationFrame(()=>w(!0))}catch{w(!0)}},style:{transform:`translate(${y}px, ${k}px) scale(${v*E})`,transformOrigin:"0 0",opacity:S?.99:0}})]}),a.jsxs("div",{className:"compare-divider-hit",style:{left:`${d}%`},onPointerDown:q,children:[a.jsx("div",{className:"compare-divider-line"}),a.jsx("div",{className:"compare-divider-handle"})]})]})})})]})}function bu(){const[e,t]=c.useState(xb());return c.useEffect(()=>yb(t),[]),e}const el=e=>["item",e],TC={v:1,tags:[],notes:"",version:1,updated_at:"",updated_by:"web"},Pn=new Map,ya=new Map,Xd=new Map,ch=new Map;let Lm=0;const tr=new Map,Co=new Map,LC=12e3,qd=new Set,Gd=new Set;let dh={state:"idle"},tl=null,Jd=0;function Gl(e){dh=e;for(const t of qd)t(e)}function wr(){const e=tr.size>0,t=Pn.size+ya.size+Jd;if(e){Gl({state:"error",message:"Conflict detected"});return}if(tl){Gl({state:"error",message:tl});return}if(t>0){Gl({state:"syncing"});return}Gl({state:"idle"})}function fh(){let e=null;for(const t of Xd.values())e=e==null?t:Math.min(e,t);for(const t of ch.values())e=e==null?t:Math.min(e,t);return e}function Ga(){const e=fh();for(const t of Gd)t(e)}function Ja(e){tl=e,wr()}function yx(){tl&&(tl=null,wr())}function _m(e){Jd=Math.max(0,Jd+e),wr()}function _C(){Lm+=1;const e=Lm;return ch.set(e,Date.now()),Ga(),e}function IC(e){e!=null&&ch.delete(e)&&Ga()}function Cu(e){const t=Co.get(e);if(!t||!t.size)return;const n=tr.get(e)??null;for(const r of t)r(n)}function Im(e){return tr.get(e)??null}function ku(e){tr.delete(e)&&(Cu(e),wr())}function FC(e,t){tr.set(e,t),Cu(e),wr()}function OC(e,t){const n=Co.get(e)??new Set;return n.add(t),Co.set(e,n),t(tr.get(e)??null),()=>{const r=Co.get(e);r&&(r.delete(t),r.size||Co.delete(e))}}function AC(e){const[t,n]=c.useState(()=>e?Im(e):null);return c.useEffect(()=>{if(!e){n(null);return}return n(Im(e)),OC(e,n)},[e]),t}function DC(e){return qd.add(e),e(dh),()=>{qd.delete(e)}}function zC(){const[e,t]=c.useState(dh);return c.useEffect(()=>DC(t),[]),e}function $C(e){return Gd.add(e),e(fh()),()=>{Gd.delete(e)}}function BC(){const[e,t]=c.useState(()=>fh()),[n,r]=c.useState(()=>e==null?null:Date.now()-e);return c.useEffect(()=>$C(t),[]),c.useEffect(()=>{if(e==null){r(null);return}r(Date.now()-e);const s=window.setInterval(()=>{r(Date.now()-e)},1e3);return()=>window.clearInterval(s)},[e]),n}function Zd(e){const t={};return Object.prototype.hasOwnProperty.call(e,"star")&&(t.set_star=e.star??null),Object.prototype.hasOwnProperty.call(e,"notes")&&(t.set_notes=e.notes??""),Object.prototype.hasOwnProperty.call(e,"tags")&&(t.set_tags=Array.isArray(e.tags)?e.tags:[]),t}function ef(e){var t,n;return e.set_star!==void 0||e.set_notes!==void 0||e.set_tags!==void 0||(((t=e.add_tags)==null?void 0:t.length)??0)>0||(((n=e.remove_tags)==null?void 0:n.length)??0)>0}function po(e){const t=[],n=new Set;for(const r of e??[]){if(typeof r!="string")continue;const s=r.trim();!s||n.has(s)||(n.add(s),t.push(s))}return t}function UC(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function VC(e,t){if(e.set_star!==void 0&&(t.star??null)!==e.set_star||e.set_notes!==void 0&&(t.notes??"")!==(e.set_notes??""))return!1;if(e.set_tags!==void 0){const r=po(e.set_tags),s=po(t.tags);return UC(r,s)}const n=po(t.tags);for(const r of po(e.add_tags))if(!n.includes(r))return!1;for(const r of po(e.remove_tags))if(n.includes(r))return!1;return!0}function xx(e,t,n){if(n instanceof on&&n.status===409){const r=n.body;if(r!=null&&r.current)return FC(e,{path:e,current:r.current,pending:t,receivedAt:new Date().toISOString()}),!0}return!1}function HC(e,t){const n=tr.get(e);if(n){if(VC(n.pending,t)){ku(e);return}tr.set(e,{...n,current:t}),Cu(e),wr()}}function WC(e){const t=bu();return wu({queryKey:el(e),queryFn:()=>we.getSidecar(e),enabled:!!e,staleTime:3e4,gcTime:5*6e4,retry:2,refetchInterval:t?LC:!1,refetchIntervalInBackground:t})}function QC(e){const t=Qs();return OS({mutationFn:async({patch:n,baseVersion:r,idempotencyKey:s})=>{const i=Zd(n);if(!ef(i))return t.getQueryData(el(e))??TC;const o={...i,base_version:r};try{return await we.patchSidecar(e,o,{idempotencyKey:s??Zo("patch"),ifMatch:r})}catch(l){throw xx(e,i,l),l}},retry:(n,r)=>r instanceof on&&r.status===409?!1:n<2,retryDelay:n=>Math.min(1e3*Math.pow(2,n),4e3),onMutate:()=>(yx(),_m(1),{inflightId:_C()}),onSuccess:n=>{ku(e),t.setQueryData(el(e),n)},onError:n=>{n instanceof on&&n.status===409||(n instanceof on?Ja(n.message):Ja("Failed to save"))},onSettled:(n,r,s,i)=>{_m(-1),IC(i==null?void 0:i.inflightId)}})}const KC=6;async function Fm(e,t){if(!e.length)return;let n=0;const r=[],s=async()=>{for(;n<e.length;){const o=n++,l=e[o];try{await wx(l,t)}catch(u){r.push({path:l,error:u}),console.error(`[bulkUpdateSidecars] Failed for ${l}:`,u)}}},i=Array.from({length:Math.min(KC,e.length)},()=>s());if(await Promise.all(i),r.length===e.length)throw new Error(`All ${e.length} sidecar updates failed`)}async function wx(e,t){const n=Pn.get(e)||{};Pn.set(e,{...n,...t}),yx(),wr();const r=ya.get(e);if(r)return r;Xd.set(e,Date.now()),Ga();const s=(async()=>{try{for(;Pn.has(e);){const i=Pn.get(e);if(!i)break;const o=Zd(i);if(!ef(o)){Pn.get(e)===i&&Pn.delete(e);continue}let l=1;try{l=(await we.getSidecar(e)).version??1}catch{l=1}const u={...o,base_version:l};try{await we.patchSidecar(e,u,{idempotencyKey:Zo("patch"),ifMatch:l}),ku(e),Pn.get(e)===i&&Pn.delete(e)}catch(d){if(xx(e,o,d)){const h=Pn.get(e);if(h&&h!==i){const p=Zd(h);if(ef(p)){const S=tr.get(e);S&&(tr.set(e,{...S,pending:p}),Cu(e))}}Pn.delete(e)}else d instanceof on?Ja(d.message):Ja("Failed to save");throw d}}}finally{ya.delete(e),Xd.delete(e),Ga(),wr()}})();return ya.set(e,s),wr(),s}function jc(e){const t=["B","KB","MB","GB","TB"];let n=0,r=e;for(;r>=1024&&n<t.length-1;)r/=1024,n+=1;return`${r.toFixed(1)} ${t[n]}`}function Mc(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function YC(e,t=28){if(e.length<=t)return e;const n=Math.max(4,Math.floor((t-1)/2));return`${e.slice(0,n)}${e.slice(-n)}`}const XC=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"});function qC(e){const t=e.trim();return!t||/[zZ]|[+-]\d{2}:?\d{2}$/.test(t)?t:`${t.includes("T")?t:t.replace(" ","T")}Z`}function Sx(e){if(!e)return null;const t=Date.parse(qC(e));return Number.isFinite(t)?t:null}function GC(e,t=Date.now()){const n=Math.max(0,t-e),r=Math.max(1,Math.floor(n/1e3));if(r<60)return`${r} second${r===1?"":"s"} ago`;const s=Math.floor(r/60);if(s<60)return`${s} minute${s===1?"":"s"} ago`;const i=Math.floor(s/60);return`${i} hour${i===1?"":"s"} ago`}function JC(e){return XC.format(new Date(e))}function ki(e){if(Array.isArray(e))return e.map(ki);if(e&&typeof e=="object")return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,ki(n)]));if(typeof e=="string"){const t=e.trim();if(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]")||t.startsWith('"')&&t.endsWith('"'))try{const r=JSON.parse(t);return ki(r)}catch{return e}}return e}function mo(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function ZC(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function Om(e){return e.split(",").map(t=>t.trim()).filter(Boolean)}const Jl=2;function _o(e,t,n){if(e===null)return'<span style="color:var(--json-literal)">null</span>';if(e===void 0)return'<span style="color:var(--json-fallback)">undefined</span>';if(typeof e=="string")return`<span style="color:var(--json-string)">${mo(JSON.stringify(e))}</span>`;if(typeof e=="number")return`<span style="color:var(--json-number)">${mo(String(e))}</span>`;if(typeof e=="boolean")return`<span style="color:var(--json-literal)">${e?"true":"false"}</span>`;if(Array.isArray(e)){if(e.length===0)return"[]";const r=" ".repeat(n),s=" ".repeat(n+Jl);let i=`[
`;return e.forEach((o,l)=>{const u=_o(o,[...t,l],n+Jl);i+=`${s}${u}${l<e.length-1?",":""}
`}),i+=`${r}]`,i}if(Eu(e)){const r=Object.keys(e);if(!r.length)return"{}";const s=" ".repeat(n),i=" ".repeat(n+Jl);let o=`{
`;return r.forEach((l,u)=>{const d=mo(JSON.stringify([...t,l])),f=mo(JSON.stringify(l)),h=`<span class="ui-json-key" data-json-path='${d}' style="color:var(--json-key)">${f}</span>`,p=_o(e[l],[...t,l],n+Jl);o+=`${i}${h}: ${p}${u<r.length-1?",":""}
`}),o+=`${s}}`,o}return`<span style="color:var(--json-fallback)">${mo(String(e))}</span>`}function Rc(e,t){if(!e)return null;const n=ki(e);if(!t&&Eu(n)&&"pil_info"in n){const r={};for(const[s,i]of Object.entries(n))r[s]=s==="pil_info"?"Hidden (toggle Show PIL info to expand)":i;return r}return n}function Za(e){return e==null?String(e):typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):Array.isArray(e)?`[${e.map(Za).join(",")}]`:typeof e=="object"?`{${Object.entries(e).sort(([n],[r])=>n.localeCompare(r)).map(([n,r])=>`${n}:${Za(r)}`).join(",")}}`:String(e)}function Zl(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return String(e);try{return JSON.stringify(e,null,1)}catch{return String(e)}}function Eu(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function bx(e){return e==="pil_info"||e.startsWith("pil_info.")||e.startsWith("pil_info[")}function tf(e,t){if(typeof t=="number")return e?`${e}[${t}]`:`[${t}]`;const n=/^[A-Za-z0-9_$-]+$/.test(t);return e?n?`${e}.${t}`:`${e}["${t}"]`:n?t:`["${t}"]`}function Pc(e){let t="";for(const n of e)t=tf(t,n);return t||"(root)"}function Tc(e,t){let n=e;for(const r of t){if(typeof r=="number"){if(!Array.isArray(n))return;n=n[r];continue}if(!Eu(n))return;n=n[r]}return n}function Am(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e;try{return JSON.stringify(e,null,1)}catch{return String(e)}}function eu(e,t,n,r,s){if(s.skipPilInfo&&bx(t))return;const i=t||"(root)";if(r>=s.maxDepth){n.set(i,e);return}if(Array.isArray(e)){if(!e.length){n.set(i,[]);return}if(e.length>s.maxArray){n.set(i,e);return}e.forEach((o,l)=>eu(o,tf(t,l),n,r+1,s));return}if(Eu(e)){const o=Object.keys(e).sort((l,u)=>l.localeCompare(u));if(!o.length){n.set(t||"(root)",{});return}for(const l of o)s.skipPilInfo&&!t&&l==="pil_info"||eu(e[l],tf(t,l),n,r+1,s);return}n.set(i,e)}const ek=["overview","compare","basics","metadata","notes"],Dm="lenslet.inspector.sections",zm="lenslet.inspector.metricsExpanded",Lc=12,$m=120,tk=8,nk=80,rk={overview:!0,compare:!0,metadata:!0,basics:!0,notes:!0};function go({title:e,open:t,onToggle:n,actions:r,children:s,contentClassName:i}){const[o,l]=c.useState(t),[u,d]=c.useState(t?"open":"closed");return c.useEffect(()=>{if(t){l(!0);const h=window.requestAnimationFrame(()=>d("open"));return()=>window.cancelAnimationFrame(h)}d("closing");const f=window.setTimeout(()=>{l(!1),d("closed")},140);return()=>window.clearTimeout(f)},[t]),a.jsxs("div",{className:"border-b border-border/60",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[a.jsxs("button",{type:"button",onClick:n,"aria-expanded":t,className:"flex items-center gap-2 inspector-section-title hover:text-text transition-colors",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`transition-transform ${t?"rotate-90":""}`,"aria-hidden":"true",children:a.jsx("path",{d:"m9 18 6-6-6-6"})}),a.jsx("span",{children:e})]}),r]}),o&&a.jsx("div",{className:"inspector-section-body","data-state":u,"aria-hidden":!t,children:a.jsx("div",{className:i??"px-3 pb-3",children:s})})]})}function sk({path:e,selectedPaths:t=[],items:n=[],compareActive:r=!1,compareA:s=null,compareB:i=null,onResize:o,onStarChanged:l,sortSpec:u,onFindSimilar:d,embeddingsAvailable:f=!1,embeddingsLoading:h=!1,onLocalTypingChange:p}){const S=!!e,{data:w,isLoading:E}=WC(e??""),j=QC(e??""),v=Qs(),[m,x]=c.useState(rk),y=c.useCallback(F=>{x(ae=>({...ae,[F]:!ae[F]}))},[]),[k,R]=c.useState(!1),M=t.length>1,N=!!d&&f&&!M,O=d?f?M?"Select a single image to search.":null:h?"Loading embeddings...":"No embeddings detected.":null,[T,X]=c.useState(""),[J,$]=c.useState(""),[oe,Q]=c.useState(null),[A,_]=c.useState(null),[P,D]=c.useState("idle"),[V,ee]=c.useState(!1),[se,I]=c.useState(null),U=c.useRef(null),[Y,Z]=c.useState(!1),[q,te]=c.useState("idle"),[he,Ee]=c.useState(null),[ye,Oe]=c.useState(null),[Se,_e]=c.useState(null),[ct,St]=c.useState(!1),[cn,$n]=c.useState(!1),[Jt,et]=c.useState(!1),[Zt,Ut]=c.useState(null),[dn,Nn]=c.useState(null),[fn,tt]=c.useState(null),pt=c.useRef(null),en=c.useRef(0),[Pt,Bn]=c.useState(null),[Je,jn]=c.useState({}),jr=c.useRef(!1),z=c.useCallback(F=>{jr.current!==F&&(jr.current=F,p==null||p(F))},[p]),K=c.useMemo(()=>{const F=n.find(ae=>ae.path===e);return F&&F.star!==void 0?F.star:null},[n,e])??(w==null?void 0:w.star)??null,le=AC(M?null:e),ge={tags:!!(le!=null&&le.pending.set_tags),notes:(le==null?void 0:le.pending.set_notes)!==void 0,star:(le==null?void 0:le.pending.set_star)!==void 0},xe=c.useMemo(()=>{const F=new Set(t);return n.filter(ae=>F.has(ae.path))},[n,t]),de=c.useMemo(()=>xe.reduce((F,ae)=>F+(ae.size||0),0),[xe]);c.useEffect(()=>{w&&(X((w.tags||[]).join(", ")),$(w.notes||"")),Q(null),_(null),D("idle"),ee(!1),I(null),U.current&&(window.clearTimeout(U.current),U.current=null),Z(!1),z(!1)},[w==null?void 0:w.updated_at,z,e]),c.useEffect(()=>()=>{U.current&&(window.clearTimeout(U.current),U.current=null),pt.current&&(window.clearTimeout(pt.current),pt.current=null),z(!1)},[z]);const Ce=c.useCallback(F=>{if(M&&t.length){Fm(t,F);return}if(!e)return;const ae=(w==null?void 0:w.version)??1;j.mutate({patch:F,baseVersion:ae,idempotencyKey:Zo("patch")})},[M,t,e,w==null?void 0:w.version,j]),Pe=c.useCallback(F=>{$(F),z(!0)},[z]),mt=c.useCallback(()=>{Ce({notes:J}),z(!1)},[Ce,J,z]),ze=c.useCallback(F=>{X(F),z(!0)},[z]),bt=c.useCallback(()=>{Ce({tags:Om(T)}),z(!1)},[Ce,z,T]),Tt=c.useCallback(()=>{if(!le||!e)return;const F={};le.pending.set_tags!==void 0&&(F.tags=Om(T)),le.pending.set_notes!==void 0&&(F.notes=J),le.pending.set_star!==void 0&&(F.star=K??null);const ae=le.current.version??1;j.mutate({patch:F,baseVersion:ae,idempotencyKey:Zo("patch")})},[le,e,T,J,K,j]),hn=c.useCallback(()=>{if(!le||!e)return;const F=le.current;X((F.tags||[]).join(", ")),$(F.notes||""),v.setQueryData(el(e),F),ku(e),l==null||l([e],F.star??null)},[le,e,v,l]);c.useEffect(()=>{if(!e)return;const F=ae=>{if(uh(ae.target))return;const ce=ae.key;if(!/^[0-5]$/.test(ce))return;ae.preventDefault();const me=ce==="0"?null:Number(ce);if(M&&t.length){Ce({star:me}),l==null||l(t,me);return}Ce({star:me}),l==null||l([e],me)};return window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[e,M,t,Ce,l]);const nt=ks(e?()=>we.getThumb(e):null,[e]),Me=e?e.split("/").pop()||e:"",Mn=c.useMemo(()=>{var ae;if(Me.includes("."))return Me.slice(Me.lastIndexOf(".")+1).toUpperCase();const F=n.find(ce=>ce.path===e);return(ae=F==null?void 0:F.type)!=null&&ae.includes("/")?F.type.split("/")[1].toUpperCase():""},[Me,n,e]),Ct=c.useMemo(()=>n.find(F=>F.path===e),[n,e]),ds=c.useMemo(()=>e?(Ct==null?void 0:Ct.source)??e:"",[Ct,e]),rt=(s==null?void 0:s.path)??null,Un=(i==null?void 0:i.path)??null,Xi=r&&!!rt&&!!Un,qi=(s==null?void 0:s.name)??rt??"A",nr=(i==null?void 0:i.name)??Un??"B",Nu=c.useCallback(async()=>{if(e){D("loading"),_(null);try{const F=await we.getMetadata(e);Q(F.meta),D("loaded")}catch(F){const ae=F instanceof Error?F.message:"Failed to load metadata";Q(null),_(ae),D("error")}}},[e]),fs=c.useCallback(async(F,ae)=>{const ce=en.current+1;en.current=ce,te("loading"),Ee(null);try{const[me,Te]=await Promise.all([we.getMetadata(F),we.getMetadata(ae)]);if(en.current!==ce)return;Oe(me.meta),_e(Te.meta),te("loaded")}catch(me){if(en.current!==ce)return;const Te=me instanceof Error?me.message:"Failed to load metadata";Oe(null),_e(null),Ee(Te),te("error")}},[]);c.useEffect(()=>{if(!Xi||!rt||!Un){en.current+=1,te("idle"),Ee(null),Oe(null),_e(null),$n(!1),et(!1),Ut(null),Nn(null),tt(null);return}St(!1),$n(!1),et(!1),Ut(null),Nn(null),tt(null),fs(rt,Un)},[Xi,rt,Un,fs]);const Ks=c.useMemo(()=>{if(!oe)return"";try{return JSON.stringify(oe,null,1)}catch{return""}},[oe]),rr=c.useMemo(()=>Rc(oe,Y),[oe,Y]),Ys=c.useMemo(()=>{if(!ye)return"";try{return JSON.stringify(ye,null,1)}catch{return""}},[ye]),hs=c.useMemo(()=>{if(!Se)return"";try{return JSON.stringify(Se,null,1)}catch{return""}},[Se]),Vn=c.useMemo(()=>Rc(ye,cn),[ye,cn]),Mr=c.useMemo(()=>Rc(Se,Jt),[Se,Jt]),ju=c.useCallback(()=>{var F;Ks&&((F=navigator.clipboard)==null||F.writeText(Ks).then(()=>{ee(!0),setTimeout(()=>ee(!1),1200)}).catch(ae=>{const ce=ae instanceof Error?ae.message:"Copy failed";_(ce)}))},[Ks]),Mu=c.useMemo(()=>rr?_o(rr,[],0):"",[rr]),fl=c.useMemo(()=>Vn?_o(Vn,[],0):"",[Vn]),ps=c.useMemo(()=>Mr?_o(Mr,[],0):"",[Mr]),Gi=c.useCallback(F=>{I(F),U.current&&window.clearTimeout(U.current),U.current=window.setTimeout(()=>{I(null),U.current=null},900)},[]),Ru=c.useCallback((F,ae)=>{var me;const ce=Am(ae);(me=navigator.clipboard)==null||me.writeText(ce).then(()=>{Gi(F)}).catch(()=>{})},[Gi]),Pu=c.useCallback((F,ae)=>{F==="A"?Nn(ae):tt(ae),pt.current&&window.clearTimeout(pt.current),pt.current=window.setTimeout(()=>{Nn(null),tt(null),pt.current=null},900)},[]),We=c.useCallback((F,ae,ce)=>{var Te;const me=Am(ce);(Te=navigator.clipboard)==null||Te.writeText(me).then(()=>{Pu(F,ae)}).catch(()=>{})},[Pu]),hl=c.useCallback(F=>{if(!rr)return;const ae=F.target;if(!ae)return;const ce=ae.closest("[data-json-path]");if(!ce)return;const me=ce.getAttribute("data-json-path");if(!me)return;let Te;try{Te=JSON.parse(me)}catch{return}const mn=Tc(rr,Te);Ru(Pc(Te),mn)},[rr,Ru]),Ji=c.useCallback(F=>{if(!Vn)return;const ae=F.target;if(!ae)return;const ce=ae.closest("[data-json-path]");if(!ce)return;const me=ce.getAttribute("data-json-path");if(!me)return;let Te;try{Te=JSON.parse(me)}catch{return}const mn=Tc(Vn,Te);We("A",Pc(Te),mn)},[Vn,We]),sr=c.useCallback(F=>{if(!Mr)return;const ae=F.target;if(!ae)return;const ce=ae.closest("[data-json-path]");if(!ce)return;const me=ce.getAttribute("data-json-path");if(!me)return;let Te;try{Te=JSON.parse(me)}catch{return}const mn=Tc(Mr,Te);We("B",Pc(Te),mn)},[Mr,We]),ir=c.useCallback(F=>{var ce;const ae=F==="A"?Ys:hs;ae&&((ce=navigator.clipboard)==null||ce.writeText(ae).then(()=>{Ut(F),setTimeout(()=>Ut(me=>me===F?null:me),1200)}).catch(()=>{}))},[Ys,hs]);let Lt=rr?"":"PNG metadata not loaded yet.";P==="loading"?Lt="Loading metadata":P==="error"&&A&&(Lt=A);let pn="Metadata not loaded yet.";q==="loading"?pn="Loading metadata":q==="error"&&he&&(pn=he);const Zi=P==="loading",or=P==="loaded"&&!!Ks,Xs=or?"h-48":"h-24";let Hn="Load meta";Zi?Hn="Loading":or&&(Hn=V?"Copied":"Copy");const pl=or?ju:Nu,Tu=!!oe&&typeof oe=="object"&&!Array.isArray(oe)&&"pil_info"in oe,Lu=!!ye&&typeof ye=="object"&&!Array.isArray(ye)&&"pil_info"in ye,_u=!!Se&&typeof Se=="object"&&!Array.isArray(Se)&&"pil_info"in Se,lr=M?null:a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[or&&Tu&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:()=>Z(F=>!F),disabled:!or,children:Y?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[78px]",onClick:pl,disabled:!e||Zi,children:Hn})]}),eo=c.useCallback(()=>{!rt||!Un||fs(rt,Un)},[rt,Un,fs]),Xe=c.useMemo(()=>{if(!ye||!Se)return null;const F=ki(ye),ae=ki(Se),ce=new Map,me=new Map,Te={maxDepth:tk,maxArray:nk,skipPilInfo:!ct};eu(F,"",ce,0,Te),eu(ae,"",me,0,Te);const mn=new Set([...ce.keys(),...me.keys()]),ar=[];let Rr=0,Pr=0,st=0;const Wn=Array.from(mn).sort((gt,gn)=>gt.localeCompare(gn)),qs=!ct;for(const gt of Wn){if(qs&&bx(gt))continue;const gn=ce.has(gt),to=me.has(gt);if(!gn&&to){Pr+=1,ar.push({key:gt,kind:"onlyB",aText:"",bText:Zl(me.get(gt))});continue}if(gn&&!to){Rr+=1,ar.push({key:gt,kind:"onlyA",aText:Zl(ce.get(gt)),bText:""});continue}const no=ce.get(gt),ml=me.get(gt),Fu=Za(no),gs=Za(ml);Fu!==gs&&(st+=1,ar.push({key:gt,kind:"different",aText:Zl(no),bText:Zl(ml)}))}const Vt=Math.max(0,ar.length-$m);return{entries:Vt?ar.slice(0,$m):ar,onlyA:Rr,onlyB:Pr,different:st,truncatedCount:Vt}},[ye,Se,ct]);c.useEffect(()=>{try{const F=localStorage.getItem(Dm);if(!F)return;const ae=JSON.parse(F);if(!ae||typeof ae!="object")return;const ce={};for(const me of ek)typeof ae[me]=="boolean"&&(ce[me]=ae[me]);Object.keys(ce).length>0&&x(me=>({...me,...ce}))}catch{}},[]),c.useEffect(()=>{try{localStorage.setItem(Dm,JSON.stringify(m))}catch{}},[m]),c.useEffect(()=>{try{const F=localStorage.getItem(zm);F==="1"||F==="true"?R(!0):(F==="0"||F==="false")&&R(!1)}catch{}},[]),c.useEffect(()=>{try{localStorage.setItem(zm,k?"1":"0")}catch{}},[k]);const ms=c.useCallback((F,ae)=>{var ce;ae&&((ce=navigator.clipboard)==null||ce.writeText(ae).then(()=>{Bn(F),setTimeout(()=>Bn(me=>me===F?null:me),1e3)}).catch(()=>{}))},[]),_t=c.useCallback((F,ae)=>{if(ae&&!Je[F]){const ce=ae.offsetHeight;ce&&jn(me=>me[F]?me:{...me,[F]:ce})}},[Je]),Be="toolbar-offset sidebar-resize-handle absolute bottom-0 left-0";return S?a.jsxs("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:[!M&&a.jsx("div",{className:"p-3 border-b border-border flex justify-center",children:a.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-border w-[220px] h-[160px] bg-panel select-none",children:[nt&&a.jsx("img",{src:nt,alt:"thumb",className:"block w-full h-full object-contain"}),!!Mn&&a.jsx("div",{className:"absolute top-1.5 left-1.5 bg-surface border border-border text-text text-xs px-1.5 py-0.5 rounded-md select-none",children:Mn})]})}),a.jsxs(go,{title:M?"Selection":"Item",open:m.overview,onToggle:()=>y("overview"),contentClassName:"px-3 pb-3 space-y-2",actions:d&&a.jsx("button",{type:"button",className:"btn btn-sm",onClick:d,disabled:!N,title:O??"Find similar",children:"Find similar"}),children:[M?a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Selected"}),a.jsxs("div",{className:"inspector-field-value",children:[t.length," files"]})]}),a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Total size"}),a.jsx("div",{className:"inspector-field-value",children:jc(de)})]})]}):a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Filename"}),a.jsx("div",{className:"inspector-field-value break-all",title:Me,children:Me})]}),O&&a.jsx("div",{className:"text-[11px] text-muted",children:O})]}),r&&Xi&&a.jsx(go,{title:"Compare Metadata",open:m.compare,onToggle:()=>y("compare"),actions:a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:eo,disabled:q==="loading",children:q==="loading"?"Loading":"Reload"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:()=>St(F=>!F),disabled:q!=="loaded",children:ct?"Hide PIL info":"Include PIL info"})]}),children:a.jsxs("div",{className:"space-y-2 text-[11px]",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] text-muted",children:[a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"A"}),a.jsx("div",{className:"text-text break-all",title:qi,children:qi})]}),a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"B"}),a.jsx("div",{className:"text-text break-all",title:nr,children:nr})]})]}),q==="loading"&&a.jsx("div",{className:"text-muted",children:"Loading metadata"}),q==="error"&&he&&a.jsx("div",{className:"text-danger break-words",children:he}),q==="loaded"&&Xe&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-muted",children:[a.jsxs("span",{children:[Xe.different," different  ",Xe.onlyA," only A  ",Xe.onlyB," only B"]}),a.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:"Deep paths"})]}),Xe.entries.length===0?a.jsx("div",{className:"text-muted",children:"No differences found."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2 text-[10px] uppercase tracking-wide text-muted",children:[a.jsx("div",{children:"Path"}),a.jsx("div",{children:"A"}),a.jsx("div",{children:"B"})]}),Xe.entries.map(F=>a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2",children:[a.jsx("div",{className:"text-[11px] text-muted font-mono break-all",children:F.key}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:F.aText}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:F.bText})]},F.key)),Xe.truncatedCount>0&&a.jsxs("div",{className:"text-muted text-[11px]",children:["+",Xe.truncatedCount," more differences not shown."]})]})]}),a.jsxs("div",{className:"grid gap-3 pt-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Metadata A"}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[Lu&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:()=>$n(F=>!F),disabled:q!=="loaded",children:cn?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:()=>ir("A"),disabled:q!=="loaded",children:Zt==="A"?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[dn&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value: ",dn]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",onClick:Ji,children:q==="loaded"&&fl?a.jsx("code",{className:"block whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:fl}}):pn})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Metadata B"}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[_u&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:()=>et(F=>!F),disabled:q!=="loaded",children:Jt?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:()=>ir("B"),disabled:q!=="loaded",children:Zt==="B"?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[fn&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value: ",fn]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",onClick:sr,children:q==="loaded"&&ps?a.jsx("code",{className:"block whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:ps}}):pn})]})]})]})]})}),a.jsxs(go,{title:"Basics",open:m.basics,onToggle:()=>y("basics"),children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs mb-1",role:"radiogroup","aria-label":"Star rating",children:[a.jsx("span",{className:"ui-kv-label w-16 shrink-0",children:M?"Rating (all)":"Rating"}),a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(F=>{const ae=(K??0)>=F;return a.jsx("button",{className:`w-6 h-6 flex items-center justify-center rounded-lg border border-border/60 bg-transparent text-[13px] ${ae?"text-star-active":"text-star-inactive"} hover:border-border hover:text-star-hover transition-colors`,onClick:()=>{const ce=K===F&&!M?null:F;M&&t.length?(l==null||l(t,ce),Fm(t,{star:ce})):e&&(l==null||l([e],ce),wx(e,{star:ce}))},title:`${F} star${F>1?"s":""} (key ${F})`,"aria-label":`${F} star${F>1?"s":""}`,"aria-pressed":K===F,children:ae?"":""},F)})})]}),!M&&le&&ge.star&&a.jsxs("div",{className:"ui-banner ui-banner-danger mt-2 text-[11px] flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Rating conflict."}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:Tt,children:"Apply again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:hn,children:"Keep theirs"})]})]}),!M&&Ct&&a.jsxs("div",{className:"text-[12px] space-y-1.5 leading-relaxed",children:[a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>ms("dimensions",`${Ct.w}${Ct.h}`),children:"Dimensions"}),a.jsx("span",{className:"ui-kv-value inline-block text-right min-w-[80px]",ref:F=>_t("dimensions",F),style:Je.dimensions?{minHeight:Je.dimensions}:void 0,children:Pt==="dimensions"?"Copied":`${Ct.w}${Ct.h}`})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>ms("size",jc(Ct.size)),children:"Size"}),a.jsx("span",{className:"ui-kv-value inline-block text-right min-w-[80px]",ref:F=>_t("size",F),style:Je.size?{minHeight:Je.size}:void 0,children:Pt==="size"?"Copied":jc(Ct.size)})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>ms("type",Ct.type),children:"Type"}),a.jsx("span",{className:"ui-kv-value break-all text-right inline-block min-w-[80px]",ref:F=>_t("type",F),style:Je.type?{minHeight:Je.type}:void 0,children:Pt==="type"?"Copied":Ct.type})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>ds&&ms("source",ds),children:"Source"}),a.jsx("span",{className:"ui-kv-value inspector-value-clamp break-words text-right max-w-[70%] inline-block min-w-[80px]",ref:F=>_t("source",F),style:Je.source?{minHeight:Je.source}:void 0,title:ds,children:Pt==="source"?"Copied":ds})]}),(()=>{const F=Ct.metrics||null;if(!F)return null;const ae=Object.entries(F).filter(([,st])=>st!=null);if(!ae.length)return null;const ce=(u==null?void 0:u.kind)==="metric"?u.key:null,me=[...ae].sort(([st],[Wn])=>st.localeCompare(Wn));let Te=me;if(ce){const st=me.findIndex(([Wn])=>Wn===ce);st>0&&(Te=[me[st],...me.slice(0,st),...me.slice(st+1)])}const mn=Te.length>Lc,Rr=k||!mn?Te:Te.slice(0,Lc),Pr=Te.length-Lc;return a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"ui-subsection-title mb-1",children:"Metrics"}),a.jsxs("div",{className:"space-y-1",children:[Rr.map(([st,Wn])=>{const qs=ce===st;return a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:`w-24 shrink-0 ${qs?"text-accent font-medium":"ui-kv-label"}`,children:st}),a.jsx("span",{className:`ui-kv-value text-right ${qs?"text-accent font-medium":""}`,children:ZC(Wn)})]},st)}),mn&&a.jsx("button",{type:"button",className:"text-[11px] text-muted underline underline-offset-2 hover:text-text",onClick:()=>R(st=>!st),"aria-expanded":k,children:k?"Show less":`+${Pr} more`})]})]})})()]})]}),!M&&a.jsxs(go,{title:"Metadata",open:m.metadata,onToggle:()=>y("metadata"),actions:lr,children:[a.jsxs("div",{className:"relative",children:[se&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value: ",se]}),a.jsx("pre",{className:`ui-code-block ui-code-block-resizable ${Xs} overflow-auto whitespace-pre-wrap`,onClick:hl,children:or?a.jsx("code",{className:"block whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:Mu}}):Lt})]}),A&&a.jsx("div",{className:"text-[11px] text-danger mt-1 break-words",children:A})]}),a.jsxs(go,{title:"Notes & Tags",open:m.notes,onToggle:()=>y("notes"),contentClassName:"px-3 pb-3 space-y-2",children:[!M&&le&&(ge.tags||ge.notes)&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Conflicting edits detected."}),a.jsx("div",{className:"text-[11px] text-muted mt-0.5",children:"Your changes were not saved because this item was updated elsewhere."}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:Tt,children:"Apply my changes again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:hn,children:"Keep theirs"})]})]}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full scrollbar-thin",placeholder:"Add notes",value:J,onChange:F=>Pe(F.target.value),onBlur:mt,"aria-label":M?"Notes for selected items":"Notes"}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:M?"Tags (apply to all, comma-separated)":"Tags (comma-separated)"}),a.jsx("input",{className:"ui-input inspector-input w-full",placeholder:"tag1, tag2",value:T,onChange:F=>ze(F.target.value),onBlur:bt,"aria-label":M?"Tags for selected items":"Tags"})]})]}),a.jsx("div",{className:Be,onPointerDown:o})]}):a.jsx("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:a.jsx("div",{className:Be,onPointerDown:o})})}function ik({open:e,embeddings:t,rejected:n=[],selectedPath:r,embeddingsLoading:s=!1,embeddingsError:i,onClose:o,onSearch:l}){const[u,d]=c.useState(""),[f,h]=c.useState("path"),[p,S]=c.useState(""),[w,E]=c.useState(""),[j,v]=c.useState("50"),[m,x]=c.useState(""),[y,k]=c.useState(null),[R,M]=c.useState(!1),N=c.useRef(null),O=c.useRef(null),T=c.useMemo(()=>t.find(A=>A.name===u)??t[0]??null,[t,u]);c.useEffect(()=>{e&&(k(null),t.length>0&&!t.some(A=>A.name===u)&&d(t[0].name),r?(h("path"),S(r)):(h("vector"),S("")))},[e,t,u,r]),c.useEffect(()=>{if(!e)return;const A=f==="vector"?O.current:N.current,_=window.requestAnimationFrame(()=>A==null?void 0:A.focus());return()=>window.cancelAnimationFrame(_)},[e,f]);const X=c.useCallback(async()=>{if(k(null),!t.length){k("No embeddings available for similarity search.");return}if(!T){k("Select an embedding to search.");return}const A=p.trim(),_=w.trim(),P=Number(j);if(!Number.isFinite(P)||P<=0){k("Top K must be a positive number.");return}const D=Math.min(1e3,Math.max(1,Math.floor(P))),V=m.trim()===""?null:Number(m);if(V!=null&&!Number.isFinite(V)){k("Min score must be a valid number.");return}if(f==="path"&&!A){k("Select an image path for the query.");return}if(f==="vector"&&!_){k("Paste a base64 vector for the query.");return}const ee={embedding:T.name,query_path:f==="path"?A:null,query_vector_b64:f==="vector"?_:null,top_k:D,min_score:V};M(!0);try{await l(ee),o()}catch(se){se instanceof on||se instanceof Error?k(se.message):k("Failed to run similarity search.")}finally{M(!1)}},[t.length,T,p,w,j,m,f,l,o]);c.useEffect(()=>{if(!e)return;const A=_=>{if(_.key==="Escape"){_.preventDefault(),o();return}(_.ctrlKey||_.metaKey)&&_.key==="Enter"&&(_.preventDefault(),X())};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[e,o,X]);const J=c.useCallback(()=>{var A;r&&(h("path"),S(r),(A=N.current)==null||A.focus())},[r]);if(!e)return null;const $=t.map(A=>({value:A.name,label:A.name})),oe=n.length>0,Q=n.slice(0,3);return a.jsx("div",{className:"fixed inset-0 z-[var(--z-overlay)] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",onClick:A=>{A.target===A.currentTarget&&o()},children:a.jsxs("div",{className:"w-full max-w-2xl rounded-lg border border-border bg-panel shadow-[0_20px_50px_rgba(0,0,0,0.55)]",onClick:A=>A.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Find similar",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Find similar"}),a.jsx("div",{className:"text-xs text-muted",children:"Search with embeddings"})]}),a.jsx("button",{className:"btn btn-sm",onClick:o,"aria-label":"Close",children:"Close"})]}),a.jsxs("div",{className:"px-4 py-4 space-y-4",children:[i&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:i}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Embedding"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(oh,{value:(T==null?void 0:T.name)??"",onChange:d,options:$,placeholder:s?"Loading embeddings...":"Select embedding",disabled:!t.length,triggerClassName:"min-w-[180px]"}),T&&a.jsxs("span",{className:"text-xs text-muted",children:[T.dimension," dims, ",T.metric,", ",T.dtype]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Query mode"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:`btn btn-sm ${f==="path"?"btn-active":""}`,onClick:()=>h("path"),"aria-pressed":f==="path",children:"Selected image"}),a.jsx("button",{type:"button",className:`btn btn-sm ${f==="vector"?"btn-active":""}`,onClick:()=>h("vector"),"aria-pressed":f==="vector",children:"Vector input"})]})]}),f==="path"?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Image path"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{ref:N,type:"text",className:"input w-full",value:p,onChange:A=>S(A.target.value),placeholder:r?"Selected image path":"Select an image first"}),a.jsx("button",{type:"button",className:"btn btn-sm",onClick:J,disabled:!r,title:r?"Use selected image":"Select an image first",children:"Use selected"})]})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Vector (base64 float32)"}),a.jsx("textarea",{ref:O,className:"ui-textarea w-full font-mono text-[11px]",rows:5,value:w,onChange:A=>E(A.target.value),placeholder:"Paste base64-encoded float32 vector"}),a.jsx("div",{className:"text-[11px] text-muted",children:"Base64 of little-endian float32. Length must match embedding dimension."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Top K"}),a.jsx("input",{type:"number",min:1,max:1e3,step:1,className:"input ui-number w-full",value:j,onChange:A=>v(A.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Min score"}),a.jsx("input",{type:"number",step:.01,className:"input ui-number w-full",value:m,onChange:A=>x(A.target.value),placeholder:"Optional"})]})]}),oe&&a.jsxs("div",{className:"ui-banner text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Skipped columns"}),a.jsxs("div",{className:"mt-1 space-y-1 text-muted",children:[Q.map(A=>a.jsxs("div",{children:[A.name,": ",A.reason]},A.name)),n.length>Q.length&&a.jsxs("div",{children:["+",n.length-Q.length," more"]})]})]}),y&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:y})]}),a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-border",children:[a.jsx("div",{className:"text-xs text-muted",children:T?`Metric: ${T.metric}`:"Metric: cosine"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:o,disabled:R,children:"Cancel"}),a.jsx("button",{className:"btn btn-sm btn-active",onClick:X,disabled:R||!t.length,children:R?"Searching...":"Find similar"})]})]})]})})}const Cx=1,xa=200,ok=5*6e4,lk=6e4,kx=(e,t)=>t!=null&&t.recursive?["folder",e,"recursive",t.page??Cx,t.pageSize??xa]:["folder",e];function Ex(e){return e[0]!=="folder"||e[2]!=="recursive"||typeof e[1]!="string"||typeof e[3]!="number"||typeof e[4]!="number"?null:e}function ak(e){return Ex(e)!==null}function uk(e,t,n=!0){if(!ak(e))return!0;const r=Ex(e);if(r==null)return!1;const[,s,,i]=r;return i!==Cx?!1:!!(s===t||n&&s==="/")}function ck(e,t,n=!0){return!Array.isArray(e)||e[0]!=="folder"?!1:!uk(e,t,n)}const dk=15e3;function fk(e,t){return we.getFolder(e,t)}function nf(e,t=!1,n){const r=bu(),s={recursive:t,page:n==null?void 0:n.page,pageSize:n==null?void 0:n.pageSize,legacyRecursive:n==null?void 0:n.legacyRecursive},i=!!s.recursive;return wu({queryKey:kx(e,s),queryFn:()=>fk(e,s),enabled:(n==null?void 0:n.enabled)??!0,staleTime:1e4,gcTime:i?lk:ok,retry:2,retryDelay:o=>Math.min(1e3*Math.pow(2,o),5e3),refetchOnWindowFocus:!1,refetchInterval:r?dk:!1,refetchIntervalInBackground:r})}const hk=(e,t)=>["search",e,t],pk=2e4;function mk(e,t){const n=bu();return wu({enabled:!!e.trim(),queryKey:hk(e,t),queryFn:()=>we.search(e,t),staleTime:3e3,gcTime:6e4,placeholderData:r=>r,retry:1,refetchInterval:n?pk:!1,refetchIntervalInBackground:n})}const gk=()=>["embeddings"];function vk(){return wu({queryKey:gk(),queryFn:we.getEmbeddings,staleTime:6e4,gcTime:5*6e4,retry:1,refetchOnWindowFocus:!1})}const yk=/^[\/@a-zA-Z0-9._\-\/]{1,512}$/,xk=[".jpg",".jpeg",".png",".webp"];function jt(e){try{const t=decodeURI(e||""),r=(t.startsWith("/")?t:`/${t}`).replace(/\/{2,}/g,"/"),s=r.length>1?r.replace(/\/$/,""):r;return yk.test(s)?s:"/"}catch{return"/"}}function Bm(){return(window.location.hash||"").replace(/^#/,"")}function Um(e){const t=jt(e),n=`#${encodeURI(t)}`;window.location.hash!==n&&(window.location.hash=n)}function ea(e){const t=jt(e),n=`#${encodeURI(t)}`;if(window.location.hash!==n){const r=`${window.location.pathname}${window.location.search}${n}`;window.history.replaceState(window.history.state,"",r)}}function wk(e){const n=jt(e).toLowerCase();return xk.some(r=>n.endsWith(r))}function Nx(e,t){const n=e.replace(/\/+$/,""),r=t.replace(/^\/+/,""),s=[n,r].filter(Boolean).join("/");return s.startsWith("/")?s:`/${s}`}function Vm(e){const n=jt(e).split("/").filter(Boolean);return n.length<=1?"/":"/"+n.slice(0,-1).join("/")}function hh(e){return jt(e).split("/").filter(Boolean).pop()||""}function Sk(e){return e.endsWith("/_trash_")}const bk=new Set([0,1,2,3,4,5]),ph=new Set(["<","<=",">",">="]),Ck=/^\d{4}-\d{2}-\d{2}$/;function kk(e,t){return!t||!t.and.length?e:e.filter(n=>Ek(n,t.and))}function Ek(e,t){for(const n of t)if(!Nk(e,n))return!1;return!0}function Nk(e,t){var n,r,s,i,o,l,u;if("stars"in t){const d=t.stars;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsIn"in t){const d=t.starsIn.values;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsNotIn"in t){const d=t.starsNotIn.values;if(!d||!d.length)return!0;const f=e.star??0;return!d.includes(f)}if("nameContains"in t){const d=(n=t.nameContains.value)==null?void 0:n.trim();return d?(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("nameNotContains"in t){const d=(r=t.nameNotContains.value)==null?void 0:r.trim();return d?!(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("commentsContains"in t){const d=(s=t.commentsContains.value)==null?void 0:s.trim();if(!d)return!0;const f=e.comments??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("commentsNotContains"in t){const d=(i=t.commentsNotContains.value)==null?void 0:i.trim();if(!d)return!0;const f=e.comments??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("urlContains"in t){const d=(o=t.urlContains.value)==null?void 0:o.trim();if(!d)return!0;const f=e.source??e.url??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("urlNotContains"in t){const d=(l=t.urlNotContains.value)==null?void 0:l.trim();if(!d)return!0;const f=e.source??e.url??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("dateRange"in t){const{from:d,to:f}=t.dateRange;if(!d&&!f)return!0;if(!e.addedAt)return!1;const h=Date.parse(e.addedAt);if(Number.isNaN(h))return!1;const p=Qm(d,!1),S=Qm(f,!0);return!(p!=null&&h<p||S!=null&&h>S)}if("widthCompare"in t){const{op:d,value:f}=t.widthCompare;if(!Number.isFinite(f))return!0;const h=e.w;return!Number.isFinite(h)||h<=0?!1:Km(h,d,f)}if("heightCompare"in t){const{op:d,value:f}=t.heightCompare;if(!Number.isFinite(f))return!0;const h=e.h;return!Number.isFinite(h)||h<=0?!1:Km(h,d,f)}if("metricRange"in t){const{key:d,min:f,max:h}=t.metricRange,p=(u=e.metrics)==null?void 0:u[d];return!(p==null||p<f||p>h)}return!0}function rf(e){if(!e||typeof e!="object")return null;const t=e.and;if(!Array.isArray(t))return null;const n=[];for(const r of t){const s=Bk(r);s&&n.push(s)}return{and:n}}function Hm(e){var r;const t=e.and.find(s=>"stars"in s),n=e.and.find(s=>"starsIn"in s);return(r=n==null?void 0:n.starsIn)!=null&&r.values?n.starsIn.values:(t==null?void 0:t.stars)??[]}function _c(e,t){return jx(e,t)}function jk(e){var n;const t=e.and.find(r=>"starsIn"in r);return((n=t==null?void 0:t.starsIn)==null?void 0:n.values)??[]}function jx(e,t){const n=Io(t),r=e.and.filter(s=>!("starsIn"in s)&&!("stars"in s));return n.length?{and:[{starsIn:{values:n}},...r]}:{and:r}}function Mk(e){var n;const t=e.and.find(r=>"starsNotIn"in r);return((n=t==null?void 0:t.starsNotIn)==null?void 0:n.values)??[]}function Mx(e,t){const n=Io(t),r=e.and.filter(s=>!("starsNotIn"in s));return n.length?{and:[{starsNotIn:{values:n}},...r]}:{and:r}}function Rk(e){var n;const t=e.and.find(r=>"nameContains"in r);return((n=t==null?void 0:t.nameContains)==null?void 0:n.value)??null}function Rx(e,t){const n=Sn(t),r=e.and.filter(s=>!("nameContains"in s));return n?{and:[{nameContains:{value:n}},...r]}:{and:r}}function Pk(e){var n;const t=e.and.find(r=>"nameNotContains"in r);return((n=t==null?void 0:t.nameNotContains)==null?void 0:n.value)??null}function Px(e,t){const n=Sn(t),r=e.and.filter(s=>!("nameNotContains"in s));return n?{and:[{nameNotContains:{value:n}},...r]}:{and:r}}function Tk(e){var n;const t=e.and.find(r=>"commentsContains"in r);return((n=t==null?void 0:t.commentsContains)==null?void 0:n.value)??null}function Tx(e,t){const n=Sn(t),r=e.and.filter(s=>!("commentsContains"in s));return n?{and:[{commentsContains:{value:n}},...r]}:{and:r}}function Lk(e){var n;const t=e.and.find(r=>"commentsNotContains"in r);return((n=t==null?void 0:t.commentsNotContains)==null?void 0:n.value)??null}function Lx(e,t){const n=Sn(t),r=e.and.filter(s=>!("commentsNotContains"in s));return n?{and:[{commentsNotContains:{value:n}},...r]}:{and:r}}function _k(e){var n;const t=e.and.find(r=>"urlContains"in r);return((n=t==null?void 0:t.urlContains)==null?void 0:n.value)??null}function _x(e,t){const n=Sn(t),r=e.and.filter(s=>!("urlContains"in s));return n?{and:[{urlContains:{value:n}},...r]}:{and:r}}function Ik(e){var n;const t=e.and.find(r=>"urlNotContains"in r);return((n=t==null?void 0:t.urlNotContains)==null?void 0:n.value)??null}function Ix(e,t){const n=Sn(t),r=e.and.filter(s=>!("urlNotContains"in s));return n?{and:[{urlNotContains:{value:n}},...r]}:{and:r}}function Fk(e){const t=e.and.find(n=>"dateRange"in n);return(t==null?void 0:t.dateRange)??null}function sf(e,t){const n=tu((t==null?void 0:t.from)??null),r=tu((t==null?void 0:t.to)??null),s=e.and.filter(i=>!("dateRange"in i));return!n&&!r?{and:s}:{and:[{dateRange:{...n?{from:n}:{},...r?{to:r}:{}}},...s]}}function Ok(e){const t=e.and.find(n=>"widthCompare"in n);return(t==null?void 0:t.widthCompare)??null}function wa(e,t){const n=e.and.filter(r=>!("widthCompare"in r));return!t||!Number.isFinite(t.value)||!ph.has(t.op)?{and:n}:{and:[{widthCompare:{op:t.op,value:t.value}},...n]}}function Ak(e){const t=e.and.find(n=>"heightCompare"in n);return(t==null?void 0:t.heightCompare)??null}function Sa(e,t){const n=e.and.filter(r=>!("heightCompare"in r));return!t||!Number.isFinite(t.value)||!ph.has(t.op)?{and:n}:{and:[{heightCompare:{op:t.op,value:t.value}},...n]}}function Dk(e,t){const n=e.and.find(r=>"metricRange"in r&&r.metricRange.key===t);return(n==null?void 0:n.metricRange)??null}function zk(e,t,n){const r=e.and.filter(s=>!("metricRange"in s&&s.metricRange.key===t));return n?{and:[{metricRange:{key:t,min:n.min,max:n.max}},...r]}:{and:r}}function $k(e){const t=rf(e);return t?t.and.length:0}function Bk(e){var t,n,r,s,i,o,l,u;if(!e||typeof e!="object")return null;if("stars"in e){const d=Io(e.stars);return d.length?{starsIn:{values:d}}:null}if("starsIn"in e){const d=Io((t=e.starsIn)==null?void 0:t.values);return d.length?{starsIn:{values:d}}:null}if("starsNotIn"in e){const d=Io((n=e.starsNotIn)==null?void 0:n.values);return d.length?{starsNotIn:{values:d}}:null}if("nameContains"in e){const d=Sn((r=e.nameContains)==null?void 0:r.value);return d?{nameContains:{value:d}}:null}if("nameNotContains"in e){const d=Sn((s=e.nameNotContains)==null?void 0:s.value);return d?{nameNotContains:{value:d}}:null}if("commentsContains"in e){const d=Sn((i=e.commentsContains)==null?void 0:i.value);return d?{commentsContains:{value:d}}:null}if("commentsNotContains"in e){const d=Sn((o=e.commentsNotContains)==null?void 0:o.value);return d?{commentsNotContains:{value:d}}:null}if("urlContains"in e){const d=Sn((l=e.urlContains)==null?void 0:l.value);return d?{urlContains:{value:d}}:null}if("urlNotContains"in e){const d=Sn((u=e.urlNotContains)==null?void 0:u.value);return d?{urlNotContains:{value:d}}:null}if("dateRange"in e){const d=e.dateRange,f=tu((d==null?void 0:d.from)??null),h=tu((d==null?void 0:d.to)??null);return!f&&!h?null:{dateRange:{...f?{from:f}:{},...h?{to:h}:{}}}}if("widthCompare"in e){const d=e.widthCompare,f=Wm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{widthCompare:f}:null}if("heightCompare"in e){const d=e.heightCompare,f=Wm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{heightCompare:f}:null}if("metricRange"in e){const d=e.metricRange;if(!d||typeof d!="object")return null;const f=typeof d.key=="string"?d.key:"",h=of(d.min),p=of(d.max);return!f||h==null||p==null||h>p?null:{metricRange:{key:f,min:h,max:p}}}return null}function Io(e){if(!Array.isArray(e))return[];const t=[],n=new Set;for(const r of e){const s=typeof r=="number"?r:typeof r=="string"?Number(r):NaN;!Number.isInteger(s)||!bk.has(s)||n.has(s)||(n.add(s),t.push(s))}return t}function Sn(e){if(typeof e!="string")return null;const t=e.trim();return t||null}function tu(e){if(typeof e!="string")return null;const t=e.trim();if(!t)return null;const n=Date.parse(t);return Number.isNaN(n)?null:t}function Wm(e,t){if(typeof e!="string"||!ph.has(e))return null;const n=of(t);return n==null?null:{op:e,value:n}}function Qm(e,t){if(!e)return null;const n=e.trim();if(!n)return null;const r=Date.parse(n);return Number.isNaN(r)?null:t&&Ck.test(n)?r+24*60*60*1e3-1:r}function Km(e,t,n){switch(t){case"<":return e<n;case"<=":return e<=n;case">":return e>n;case">=":return e>=n;default:return!0}}function of(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null}function Ym(e){return e.addedAt?Date.parse(e.addedAt):0}function nu(e,t){return e.name.localeCompare(t.name)}function Uk(e,t){const n=Ym(e),r=Ym(t);return n===r?nu(e,t):n-r}function Vk(e){return(t,n)=>{var i,o;const r=(i=t.metrics)==null?void 0:i[e],s=(o=n.metrics)==null?void 0:o[e];return r==null&&s==null?nu(t,n):r==null?1:s==null?-1:r===s?nu(t,n):r-s}}function Xm(e,t){return kk(e,t)}function Hk(e){let t=e>>>0;return()=>{t+=1831565813;let n=Math.imul(t^t>>>15,1|t);return n^=n+Math.imul(n^n>>>7,61|n),((n^n>>>14)>>>0)/4294967296}}function Wk(e,t){const n=Hk(t||1),r=[...e];for(let s=r.length-1;s>0;s-=1){const i=Math.floor(n()*(s+1));[r[s],r[i]]=[r[i],r[s]]}return r}function Qk(e,t,n){if(t.kind==="builtin"&&t.key==="random"){const i=n??Date.now();return Wk(e,i)}let r=Uk;t.kind==="metric"?r=Vk(t.key):t.key==="name"&&(r=nu);const s=[...e].sort(r);return t.dir==="desc"?s.reverse():s}const qm="leftW.folders",Gm="leftW.metrics",Kk="leftW",Jm="rightW",Zm=200,eg=240,tg=200;function Yk(e){return(e.pointerType??"mouse")==="mouse"&&e.button!==0}function Xk(e,t){try{e.setPointerCapture(t)}catch{}}function qk(e,t){try{e.releasePointerCapture(t)}catch{}}function Gk(e,t){const[n,r]=c.useState(240),[s,i]=c.useState(320),[o,l]=c.useState(240),u=t==="metrics"?s:n,d=c.useRef(u),f=c.useRef(o);c.useEffect(()=>{d.current=u},[u]),c.useEffect(()=>{f.current=o},[o]),c.useEffect(()=>{try{const w=window.localStorage,E=Number(w.getItem(qm)??w.getItem(Kk));Number.isFinite(E)&&E>0&&r(E);const j=Number(w.getItem(Gm));Number.isFinite(j)&&j>0&&i(j);const v=Number(w.getItem(Jm));Number.isFinite(v)&&v>0&&l(v)}catch{}},[]);const h=(w,E,j)=>{if(Yk(w))return;w.preventDefault();const v=w.currentTarget,m=w.pointerId;Xk(v,m);const x=R=>{R.pointerId===m&&E(R)};function y(){window.removeEventListener("pointermove",x),window.removeEventListener("pointerup",k),window.removeEventListener("pointercancel",k),qk(v,m)}function k(R){R.pointerId===m&&(y(),j())}window.addEventListener("pointermove",x),window.addEventListener("pointerup",k),window.addEventListener("pointercancel",k)};return{leftW:u,rightW:o,onResizeLeft:w=>{const E=e.current;if(!E)return;const j=E.getBoundingClientRect(),v=t==="metrics"?Gm:qm;let m=d.current;h(w,x=>{const y=x.clientX-j.left,k=Math.max(Zm,j.width-f.current-tg),R=Math.min(Math.max(y,Zm),k);m=R,t==="metrics"?i(R):r(R)},()=>{try{window.localStorage.setItem(v,String(m))}catch{}})},onResizeRight:w=>{const E=e.current;if(!E)return;const j=E.getBoundingClientRect();let v=f.current;h(w,m=>{const x=m.clientX-j.left,y=j.width-x,k=Math.max(eg,j.width-d.current-tg),R=Math.min(Math.max(y,eg),k);v=R,f.current=R,l(R)},()=>{try{window.localStorage.setItem(Jm,String(v))}catch{}})}}}function Jk(e,t=250){const[n,r]=Bh.useState(e);return Bh.useEffect(()=>{const s=window.setTimeout(()=>r(e),Math.max(0,t));return()=>window.clearTimeout(s)},[e,t]),n}const Fx="application/x-lenslet-paths",Zk='[role="treeitem"].drop-target';function ng(e){var n;return Array.from(((n=e.dataTransfer)==null?void 0:n.types)||[]).includes(Fx)}function eE(e){document.querySelectorAll(Zk).forEach(t=>{t!==e&&t.classList.remove("drop-target")})}function rg(e){eE(e),e.classList.add("drop-target")}function sg(e){return e.startsWith("/")?e:`/${e}`}function tE({path:e,isLeaf:t}){const n=Qs(),r=c.useCallback(l=>{ng(l)&&(l.preventDefault(),t&&rg(l.currentTarget))},[t]),s=c.useCallback(l=>{!t||!ng(l)||(l.preventDefault(),rg(l.currentTarget))},[t]),i=c.useCallback(l=>{const u=l.currentTarget,d=document.elementFromPoint(l.clientX,l.clientY);d&&u.contains(d)||u.classList.remove("drop-target")},[]),o=c.useCallback(async l=>{const u=l.dataTransfer;if(!u)return;l.preventDefault(),l.currentTarget.classList.remove("drop-target");const d=u.getData(Fx),h=(d?JSON.parse(d):[]).filter(Boolean);if(!h.length)return;let p=h[0].split("/").slice(0,-1).join("/")||"/";p=sg(p);const S=sg(e);try{for(const w of h)await we.moveFile(w,S);n.invalidateQueries({queryKey:["folder",p]}),n.invalidateQueries({queryKey:["folder",S]}),n.setQueryData(["folder",p],w=>!w||!Array.isArray(w.items)?w:{...w,items:w.items.filter(E=>!h.includes(E.path))})}catch{}},[e,n]);return{onDragOver:r,onDragEnter:s,onDragLeave:i,onDrop:o}}const nE='[role="tree"] [role="treeitem"]';function rE(){return Array.from(document.querySelectorAll(nE))}function sE(e,t){var i;const n=rE(),r=n.findIndex(o=>o===e);if(r===-1)return;let s=r;t==="ArrowDown"?s=Math.min(n.length-1,r+1):t==="ArrowUp"?s=Math.max(0,r-1):t==="Home"?s=0:t==="End"&&(s=n.length-1),(i=n[s])==null||i.focus()}function iE({path:e,isLeaf:t,isExpanded:n,setExpanded:r,onOpen:s}){return c.useCallback(i=>{if(i.key==="Enter"){i.preventDefault(),s(e);return}if(i.key==="ArrowRight"){!t&&!n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.add(e),l}));return}if(i.key==="ArrowLeft"){!t&&n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.delete(e),l}));return}(i.key==="ArrowDown"||i.key==="ArrowUp"||i.key==="Home"||i.key==="End")&&(i.preventDefault(),sE(i.currentTarget,i.key))},[e,t,n,r,s])}const ig=64,oE=120;function lE(e){const t=e.split("/").filter(Boolean),n=["/"];let r="";for(const s of t)r=r?`${r}/${s}`:`/${s}`,n.push(r);return n}function aE({current:e,roots:t,data:n,onOpen:r,onPullRefresh:s,onResize:i,onContextMenu:o,onOpenActions:l,countVersion:u,className:d,showResizeHandle:f=!0}){const[h,p]=c.useState(new Set(["/"])),S=c.useRef(new Map),w=c.useRef(new Map),[E,j]=c.useState(!1),[v,m]=c.useState(0),x=c.useRef(null),y=c.useRef(!1),k=Qs(),R=c.useCallback(()=>{m(0),x.current=null,y.current=!1},[]),M=c.useCallback(async _=>{const P=jt(_||"/"),D=S.current,V=w.current,ee=D.get(P);if(ee!==void 0)return ee;const se=k.getQueryData(kx(P,{recursive:!0}));if(se){const Y=se.totalItems??se.items.length;return D.set(P,Y),Y}const I=V.get(P);if(I)return I;const U=(async()=>{try{const Y=await we.getFolder(P,{recursive:!0}),Z=Y.totalItems??Y.items.length;return D.set(P,Z),Z}finally{V.delete(P)}})();return V.set(P,U),U},[k]);c.useEffect(()=>{S.current.clear(),w.current.clear()},[u]),c.useEffect(()=>{const _=lE(e);p(P=>{const D=new Set(P);for(const V of _)D.add(V);return D})},[e]);const N=c.useCallback(async()=>{if(!(!s||E)){j(!0);try{await s()}catch(_){console.error("Failed to refresh folders:",_)}finally{j(!1),m(0)}}},[s,E]),O=c.useCallback(_=>{!s||E||_.touches.length===1&&(_.currentTarget.scrollTop>0||(x.current=_.touches[0].clientY,y.current=!1))},[s,E]),T=c.useCallback(_=>{if(!s||E||_.touches.length!==1)return;const P=x.current;if(P==null)return;if(_.currentTarget.scrollTop>0){R();return}const D=_.touches[0].clientY-P;if(D<=0){y.current&&m(0);return}!y.current&&D<8||(y.current=!0,_.preventDefault(),m(Math.min(oE,D*.55)))},[E,s,R]),X=c.useCallback(()=>{if(!s||E){R();return}const _=y.current&&v>=ig;if(x.current=null,y.current=!1,_){N();return}m(0)},[N,E,s,v,R]),J=d??"h-full overflow-auto bg-panel scrollbar-thin",$=s?`${J} overscroll-y-contain`:J,oe=!!s&&(E||v>0),Q=v>=ig,A=E?28:Math.min(44,v);return a.jsxs("div",{className:$,onTouchStart:s?O:void 0,onTouchMove:s?T:void 0,onTouchEnd:s?X:void 0,onTouchCancel:s?X:void 0,children:[oe&&a.jsx("div",{className:"flex items-end justify-center text-[11px] text-muted select-none transition-[height,opacity] duration-150",style:{height:A,opacity:E||v>8?1:.65},"aria-live":"polite",children:E?"Refreshing":Q?"Release to refresh":"Pull to refresh"}),a.jsx("div",{className:"p-1",role:"tree","aria-label":"Folders",children:t.map(_=>a.jsx(Ox,{path:_.path,label:_.label,depth:0,current:e,expanded:h,setExpanded:p,onOpen:r,onContextMenu:o,onOpenActions:l,initial:n,getSubtreeCount:M,countVersion:u},_.path))}),f&&a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 left-[calc(var(--left)-6px)]",onPointerDown:i})]})}function Ox({path:e,label:t,depth:n,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:u,initial:d,getSubtreeCount:f,countVersion:h}){var J;const p=s.has(e),S=r===e,w=e==="/"||p||S,{data:E}=nf(e,!1,{enabled:w}),j=d&&e===d.path?d:E,m=!!j?j.dirs.length===0:!1,[x,y]=c.useState(j?j.items.length:null),k=iE({path:e,isLeaf:m,isExpanded:p,setExpanded:i,onOpen:o}),{onDragOver:R,onDragEnter:M,onDragLeave:N,onDrop:O}=tE({path:e,isLeaf:m}),T=$=>{$.stopPropagation(),!m&&i(oe=>{const Q=new Set(oe);return Q.has(e)?Q.delete(e):Q.add(e),Q})},X=$=>{if($.stopPropagation(),!u)return;const oe=$.currentTarget.getBoundingClientRect();u(e,{x:oe.right-4,y:oe.bottom-4})};return c.useEffect(()=>{let $=!1;if(!j){y(null);return}if(y(j.items.length),!!(p&&(n>0||S)))return f(e).then(Q=>{$||y(Q)}).catch(Q=>{$||console.warn(`Failed to compute subtree count for ${e}:`,Q)}),()=>{$=!0}},[j,e,f,h,p,n,S]),a.jsxs("div",{children:[a.jsxs("div",{className:`tree-row flex items-center gap-1.5 py-1 px-2 rounded-md cursor-pointer min-h-[40px] outline-none transition-colors duration-75 ${S?"bg-accent/20 text-accent font-medium":"hover:bg-white/5 text-text"}`,role:"treeitem","aria-level":n+1,"aria-expanded":m?void 0:p,"aria-selected":S,tabIndex:S?0:-1,style:{paddingLeft:8+n*14},onClick:()=>o(e),onContextMenu:$=>{$.preventDefault(),$.stopPropagation(),l==null||l($,e)},onKeyDown:k,onDragOver:R,onDragEnter:M,onDragLeave:N,onDrop:O,children:[a.jsx("button",{type:"button",className:"tree-expand-btn touch-manipulation",onClick:T,"aria-label":m?`No subfolders in ${t}`:`${p?"Collapse":"Expand"} ${t}`,"aria-expanded":m?void 0:p,disabled:m,children:m?"":p?"":""}),a.jsx("span",{className:"flex-1 overflow-hidden truncate text-sm",title:t,children:YC(t,28)}),x!==null&&a.jsx("span",{className:"text-[10px] opacity-50 bg-white/5 border border-white/5 rounded px-1.5 min-w-[24px] text-center",children:x}),u&&a.jsx("button",{type:"button",className:"tree-row-action-btn touch-manipulation","aria-label":`Open actions for ${t}`,"aria-haspopup":"menu",onPointerDown:$=>$.stopPropagation(),onClick:X,children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]}),p&&((J=j==null?void 0:j.dirs)==null?void 0:J.map($=>a.jsx(Ox,{path:Nx(e,$.name),label:$.name,depth:n+1,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:u,getSubtreeCount:f,countVersion:h},$.name)))]})}const Es=40,uE=12,og=[5,4,3,2,1],lg=["<","<=",">",">="];function cE({items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l,onChangeFilters:u}){const d=r&&r.length?a.jsx(dE,{selectedItems:r,metricKeys:n}):null,f=a.jsx(fE,{filters:o,onChangeFilters:u});return n.length?a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[d,a.jsx(hE,{items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}),f]}):a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[d,f,a.jsx("div",{className:"p-4 text-sm text-muted",children:"No metrics found in this dataset."})]})}function dE({selectedItems:e,metricKeys:t}){const n=c.useMemo(()=>{if(!e.length)return null;const u=new Map;for(const h of e){const p=h.metrics;if(p)for(const[S,w]of Object.entries(p)){if(w==null||Number.isNaN(w))continue;const E=u.get(S);E?E.push(w):u.set(S,[w])}}return u.size?{entries:(t.length?t.filter(h=>u.has(h)):Array.from(u.keys()).sort()).map(h=>{const p=u.get(h)??[],S=Math.min(...p),w=Math.max(...p),E=p.reduce((j,v)=>j+v,0)/Math.max(1,p.length);return{key:h,value:p[0],min:S,max:w,avg:E,count:p.length}}),totalItems:e.length}:null},[e,t]);if(!n)return null;const{entries:r,totalItems:s}=n,i=r.slice(0,uE),o=r.length-i.length,l=s>1;return a.jsxs("div",{className:"ui-card",children:[a.jsxs("div",{className:"ui-card-header",children:[a.jsx("div",{className:"ui-section-title",children:"Selected metrics"}),a.jsxs("div",{className:"text-[11px] text-muted",children:[s," item",s===1?"":"s"]})]}),a.jsxs("div",{className:"space-y-1 text-[12px]",children:[i.map(u=>a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-muted w-28 shrink-0 truncate",title:u.key,children:u.key}),a.jsxs("span",{className:"font-mono text-text text-right tabular-nums",children:[l?`${tn(u.min)}  ${tn(u.max)}`:tn(u.value),l&&a.jsxs("span",{className:"text-[11px] text-muted ml-2",children:["avg ",tn(u.avg),u.count!==s?`  ${u.count}/${s}`:""]})]})]},u.key)),o>0&&a.jsxs("div",{className:"text-[11px] text-muted",children:["+",o," more"]})]})]})}function fE({filters:e,onChangeFilters:t}){const n=c.useMemo(()=>jk(e),[e]),r=c.useMemo(()=>Mk(e),[e]),s=c.useMemo(()=>Rk(e)??"",[e]),i=c.useMemo(()=>Pk(e)??"",[e]),o=c.useMemo(()=>Tk(e)??"",[e]),l=c.useMemo(()=>Lk(e)??"",[e]),u=c.useMemo(()=>_k(e)??"",[e]),d=c.useMemo(()=>Ik(e)??"",[e]),f=c.useMemo(()=>Fk(e)??{},[e]),h=c.useMemo(()=>pg(f.from),[f.from]),p=c.useMemo(()=>pg(f.to),[f.to]),S=c.useMemo(()=>Ok(e),[e]),w=c.useMemo(()=>Ak(e),[e]),[E,j]=c.useState((S==null?void 0:S.op)??">="),[v,m]=c.useState((w==null?void 0:w.op)??">=");c.useEffect(()=>{S!=null&&S.op&&j(S.op)},[S==null?void 0:S.op]),c.useEffect(()=>{w!=null&&w.op&&m(w.op)},[w==null?void 0:w.op]);const x=(y,k)=>{const R=new Set(n),M=new Set(r);y==="include"?R.has(k)?R.delete(k):(R.add(k),M.delete(k)):M.has(k)?M.delete(k):(M.add(k),R.delete(k));let N=jx(e,Array.from(R));N=Mx(N,Array.from(M)),t(N)};return a.jsxs("div",{className:"ui-card",children:[a.jsx("div",{className:"ui-section-title mb-3",children:"Attributes"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Rating"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Include"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[og.map(y=>{const k=n.includes(y);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${k?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>x("include",y),"aria-pressed":k,title:`Include ${y} star${y>1?"s":""}`,children:[y,""]},`stars-in-${y}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${n.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>x("include",0),"aria-pressed":n.includes(0),title:"Include unrated",children:"None"})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Exclude"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[og.map(y=>{const k=r.includes(y);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${k?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>x("exclude",y),"aria-pressed":k,title:`Exclude ${y} star${y>1?"s":""}`,children:[y,""]},`stars-out-${y}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${r.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>x("exclude",0),"aria-pressed":r.includes(0),title:"Exclude unrated",children:"None"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Filename"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:s,placeholder:"e.g. draft",onChange:y=>t(Rx(e,y.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:i,placeholder:"e.g. v1",onChange:y=>t(Px(e,y.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Comments"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:o,placeholder:"e.g. hero",onChange:y=>t(Tx(e,y.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:l,placeholder:"e.g. todo",onChange:y=>t(Lx(e,y.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"URL"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:u,placeholder:"e.g. s3://bucket",onChange:y=>t(_x(e,y.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:d,placeholder:"e.g. http://",onChange:y=>t(Ix(e,y.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Date Added"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"From"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:h,onChange:y=>t(sf(e,{from:y.target.value||null,to:f.to??null}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"To"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:p,onChange:y=>t(sf(e,{from:f.from??null,to:y.target.value||null}))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Dimensions"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Width"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:E,onChange:y=>{const k=y.target.value;j(k),S&&t(wa(e,{op:k,value:S.value}))},children:lg.map(y=>a.jsx("option",{value:y,children:y},`w-${y}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:S?String(S.value):"",min:0,placeholder:"px",onChange:y=>{const k=y.target.value;if(!k){t(wa(e,null));return}const R=Number(k);Number.isFinite(R)&&t(wa(e,{op:E,value:R}))}})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Height"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:v,onChange:y=>{const k=y.target.value;m(k),w&&t(Sa(e,{op:k,value:w.value}))},children:lg.map(y=>a.jsx("option",{value:y,children:y},`h-${y}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:w?String(w.value):"",min:0,placeholder:"px",onChange:y=>{const k=y.target.value;if(!k){t(Sa(e,null));return}const R=Number(k);Number.isFinite(R)&&t(Sa(e,{op:v,value:R}))}})]})]})]})]})]})]})}function hE({items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}){const[u,d]=c.useState(!1),f=s&&n.includes(s)?s:n[0];return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("label",{className:"ui-label",children:"Metric"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-[11px]",onClick:()=>d(h=>!h),"aria-pressed":u,children:u?"Show one":"Show all"})]}),u?a.jsx("div",{className:"ui-input ui-input-readonly w-full flex items-center text-xs",children:"All metrics"}):a.jsx("select",{className:"ui-select w-full",value:f,onChange:h=>i(h.target.value),children:n.map(h=>a.jsx("option",{value:h,children:h},h))})]}),u?a.jsx("div",{className:"space-y-3",children:n.map(h=>a.jsx(ag,{metricKey:h,items:e,filteredItems:t,selectedItems:r,filters:o,onChangeRange:l,showTitle:!0},h))}):f?a.jsx(ag,{metricKey:f,items:e,filteredItems:t,selectedItems:r,filters:o,onChangeRange:l}):a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]})}function ag({items:e,filteredItems:t,metricKey:n,selectedItems:r,filters:s,onChangeRange:i,showTitle:o=!1}){const l=c.useMemo(()=>ug(e,n),[e,n]),u=c.useMemo(()=>Ic(l,Es),[l]),d=c.useMemo(()=>ug(t,n),[t,n]),f=c.useMemo(()=>u?Ic(d,Es,u):null,[d,u]),h=Dk(s,n),[p,S]=c.useState(null),[w,E]=c.useState(!1),j=c.useRef(null),v=c.useRef(null),m=c.useRef(!1),x=c.useRef(null),[y,k]=c.useState(null),[R,M]=c.useState(""),[N,O]=c.useState(""),[T,X]=c.useState(null),J=p??h,$=u?{min:u.min,max:u.max}:null,oe=c.useMemo(()=>{var Y;if(!(r!=null&&r.length))return[];const U=[];for(const Z of r){const q=(Y=Z.metrics)==null?void 0:Y[n];q==null||Number.isNaN(q)||U.push(q)}return U},[r,n]),Q=oe.length===1?oe[0]:null,A=c.useMemo(()=>!u||oe.length<2?null:Ic(oe,Es,u),[oe,u]);c.useEffect(()=>{if(!h||!$){T!=="min"&&M(h?_r(h.min):""),T!=="max"&&O(h?_r(h.max):"");return}if(T!=="min"){const U=ti(h.min,$.min)?"":_r(h.min);M(U)}if(T!=="max"){const U=ti(h.max,$.max)?"":_r(h.max);O(U)}},[h,$,T]),c.useEffect(()=>{k(null)},[n,$==null?void 0:$.min,$==null?void 0:$.max]);const _=U=>{var q;if(!$)return null;const Y=(q=x.current)==null?void 0:q.getBoundingClientRect();if(!Y)return null;const Z=mh((U.clientX-Y.left)/Y.width);return $.min+($.max-$.min)*Z},P=(U,Y)=>{if(!$)return;const Z=j.current??U,q=dg(Z,U);S(q),Y&&i(n,q)},D=U=>{var Z;if(!$)return;U.preventDefault();const Y=_(U);Y!=null&&(E(!0),S(null),j.current=Y,v.current=U.clientX,m.current=!1,k(Y),(Z=x.current)==null||Z.setPointerCapture(U.pointerId))},V=U=>{const Y=_(U);if(Y==null){w||k(null);return}if(k(Y),w){const Z=v.current;if(!m.current&&Z!=null){if(Math.abs(U.clientX-Z)<4)return;m.current=!0}m.current&&P(Y,!1)}},ee=U=>{var Z;if(!w)return;E(!1),(Z=x.current)==null||Z.releasePointerCapture(U.pointerId);const Y=_(U);m.current&&Y!=null?(k(Y),P(Y,!0)):h&&i(n,null),j.current=null,v.current=null,m.current=!1,setTimeout(()=>S(null),0)},se=(U,Y)=>{if(!$)return;const Z=fg(U),q=fg(Y);if(!Z.valid||!q.valid){Z.valid||M(h?_r(h.min):""),q.valid||O(h?_r(h.max):"");return}if(Z.value==null&&q.value==null){i(n,null);return}const te=Z.value??$.min,he=q.value??$.max,Ee=hg(te,$.min,$.max),ye=hg(he,$.min,$.max),Oe=dg(Ee,ye);if(ti(Oe.min,$.min)&&ti(Oe.max,$.max)){i(n,null);return}i(n,Oe)};if(!u||!$)return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:n}),a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]});const I=oe.length;return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:n}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mb-2 tabular-nums",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{children:["Population: ",u.count]}),a.jsxs("span",{children:["Filtered: ",(f==null?void 0:f.count)??0]}),I>1&&a.jsxs("span",{className:"text-text",children:["Selected: ",I]})]}),Q!=null&&a.jsxs("span",{className:"text-text",children:["Selected: ",tn(Q)]})]}),a.jsxs("svg",{ref:x,viewBox:`0 0 ${Es} 100`,preserveAspectRatio:"none",className:"w-full h-28 cursor-crosshair rounded-md bg-surface-inset",onPointerDown:D,onPointerMove:V,onPointerUp:ee,onPointerLeave:()=>k(null),children:[Fc(u.bins,"#2e3a4b"),f&&Fc(f.bins,"#3a8fff"),A&&Fc(A.bins,"#f59e0b",{opacity:.55}),J&&pE(J,$),Q!=null&&cg(Q,$,{color:"var(--highlight)",strokeWidth:.7}),y!=null&&cg(y,$,{color:"rgba(255,255,255,0.75)",strokeWidth:.5,dashed:!0})]}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mt-2 tabular-nums",children:[a.jsx("span",{children:tn($==null?void 0:$.min)}),a.jsxs("div",{className:"flex flex-col items-center text-center leading-tight",children:[J?a.jsx("span",{className:"text-text",children:ti(J.min,$.min)?` ${tn(J.max)}`:ti(J.max,$.max)?` ${tn(J.min)}`:`${tn(J.min)}  ${tn(J.max)}`}):y!=null?a.jsxs("span",{className:"text-text",children:["Cursor: ",tn(y)]}):a.jsx("span",{children:"Drag to filter"}),J&&y!=null&&a.jsxs("span",{className:"text-[11px] text-muted",children:["Cursor: ",tn(y)]})]}),a.jsx("span",{children:tn($==null?void 0:$.max)})]}),a.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2 mt-3 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Min"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:R,placeholder:_r($.min),onFocus:()=>X("min"),onBlur:()=>{X(null),se(R,N)},onChange:U=>M(U.target.value),onKeyDown:U=>{U.key==="Enter"&&U.currentTarget.blur()}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Max"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:N,placeholder:_r($.max),onFocus:()=>X("max"),onBlur:()=>{X(null),se(R,N)},onChange:U=>O(U.target.value),onKeyDown:U=>{U.key==="Enter"&&U.currentTarget.blur()}})]}),a.jsx("button",{className:"btn btn-xs btn-ghost text-muted hover:text-text",onClick:()=>i(n,null),children:"Clear"})]})]})}function Ic(e,t,n){if(!e.length)return null;const r=n?n.min:Math.min(...e);let s=n?n.max:Math.max(...e);r===s&&(s=r+1);const i=new Array(t).fill(0),o=t/(s-r);for(const l of e){const u=Math.max(0,Math.min(t-1,Math.floor((l-r)*o)));i[u]+=1}return{bins:i,min:r,max:s,count:e.length}}function ug(e,t){var r;const n=[];for(const s of e){const i=(r=s.metrics)==null?void 0:r[t];i==null||Number.isNaN(i)||n.push(i)}return n}function Fc(e,t,n){const r=Math.max(1,...e),s=(n==null?void 0:n.opacity)??.9;return e.map((i,o)=>{const l=i/r*100;return a.jsx("rect",{x:o+.05,y:100-l,width:.9,height:l,fill:t,opacity:s},`${t}-${o}`)})}function pE(e,t){const n=(e.min-t.min)/(t.max-t.min),r=(e.max-t.min)/(t.max-t.min),s=Es*mh(Math.min(n,r)),i=Es*Math.abs(r-n);return a.jsx("rect",{x:s,y:0,width:Math.max(.5,i),height:100,fill:"rgba(255,255,255,0.08)",stroke:"rgba(255,255,255,0.4)",strokeWidth:.4})}function cg(e,t,n){const r=mh((e-t.min)/(t.max-t.min)),s=Es*r;return a.jsx("line",{x1:s,y1:0,x2:s,y2:100,stroke:n.color,strokeWidth:n.strokeWidth??.5,strokeDasharray:n.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}function dg(e,t){return e<t?{min:e,max:t}:{min:t,max:e}}function mh(e){return e<0?0:e>1?1:e}function tn(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function _r(e){if(!Number.isFinite(e))return"";const t=e.toString();return t.includes("e")?e.toFixed(6):t}function fg(e){const t=e.trim();if(!t)return{value:null,valid:!0};const n=Number(t);return Number.isFinite(n)?{value:n,valid:!0}:{value:null,valid:!1}}function hg(e,t,n){return e<t?t:e>n?n:e}function ti(e,t){const n=Math.max(1,Math.abs(e),Math.abs(t));return Math.abs(e-t)<=1e-6*n}function pg(e){return e?e.length>=10?e.slice(0,10):e:""}const mE=[{label:"Root",path:"/"}],gE="w-11 h-11 rounded-md border border-border flex items-center justify-center transition-colors",vE="bg-accent-muted text-accent",yE="bg-surface text-text hover:bg-surface-hover";function ta(e){return`${gE} ${e?vE:yE}`}function xE({leftTool:e,onToolChange:t,compareEnabled:n,compareActive:r,onOpenCompare:s,views:i,activeViewId:o,onActivateView:l,onSaveView:u,current:d,data:f,onOpenFolder:h,onOpenFolderActions:p,onPullRefreshFolders:S,onContextMenu:w,countVersion:E,items:j,filteredItems:v,metricKeys:m,selectedItems:x,selectedMetric:y,onSelectMetric:k,filters:R,onChangeRange:M,onChangeFilters:N,onResize:O}){const T=ta(e==="folders"),X=ta(e==="metrics"),J=ta(r),$=`${ta(!1)} cursor-pointer`;return a.jsxs("div",{className:"app-left-panel col-start-1 row-start-2 relative border-r border-border bg-panel overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-y-0 left-0 w-12 border-r border-border flex flex-col items-center gap-2 py-3 bg-surface-overlay",children:[a.jsx("button",{className:T,title:"Folders","aria-label":"Folders","aria-pressed":e==="folders",onClick:()=>t("folders"),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M3 7.5h6l2-2h10a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2z"})})}),a.jsx("button",{className:X,title:"Metrics / Filters","aria-label":"Metrics and Filters","aria-pressed":e==="metrics",onClick:()=>t("metrics"),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]})}),a.jsx("div",{className:"w-6 h-px bg-border/70 my-1"}),a.jsx("button",{className:`${J} ${n?"":"opacity-40 cursor-not-allowed"}`,title:n?"Compare selected images":"Compare (select 2+)","aria-label":"Compare selected images","aria-pressed":r,"aria-disabled":!n,disabled:!n,onClick:()=>{n&&s()},children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("rect",{x:"3",y:"4",width:"8",height:"16",rx:"1"}),a.jsx("rect",{x:"13",y:"4",width:"8",height:"16",rx:"1"})]})}),a.jsx("div",{className:"flex-1"}),a.jsx("a",{className:$,href:"https://github.com/trojblue/lenslet",title:"Lenslet on GitHub","aria-label":"Lenslet on GitHub",target:"_blank",rel:"noreferrer",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:a.jsx("path",{d:"M12 .5C5.73.5.5 5.74.5 12.02c0 5.1 3.29 9.42 7.86 10.95.58.11.79-.25.79-.56v-2.17c-3.2.7-3.88-1.55-3.88-1.55-.53-1.35-1.29-1.71-1.29-1.71-1.05-.72.08-.71.08-.71 1.16.08 1.78 1.2 1.78 1.2 1.03 1.77 2.71 1.26 3.37.96.1-.75.4-1.26.73-1.55-2.55-.29-5.23-1.29-5.23-5.74 0-1.27.45-2.31 1.19-3.13-.12-.29-.52-1.46.11-3.05 0 0 .97-.31 3.18 1.19.92-.26 1.91-.39 2.89-.39.98 0 1.97.13 2.89.39 2.2-1.5 3.18-1.19 3.18-1.19.63 1.59.23 2.76.11 3.05.74.82 1.19 1.86 1.19 3.13 0 4.46-2.69 5.45-5.25 5.73.41.36.78 1.07.78 2.16v3.2c0 .31.21.67.8.56 4.56-1.53 7.85-5.85 7.85-10.95C23.5 5.74 18.27.5 12 .5z"})})})]}),a.jsx("div",{className:"ml-12 h-full",children:e==="folders"?a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-2 py-2 border-b border-border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Smart Folders"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:u,title:"Save current view as Smart Folder",children:"+ New"})]}),i.length?a.jsx("div",{className:"flex flex-col gap-1",children:i.map(oe=>{const Q=oe.id===o;return a.jsx("button",{className:`text-left px-2 py-2 rounded-md text-sm ${Q?"bg-accent-muted text-accent":"hover:bg-hover text-text"}`,onClick:()=>l(oe),children:oe.name},oe.id)})}):a.jsx("div",{className:"text-xs text-muted px-1 py-1.5",children:"No saved Smart Folders yet."})]}),a.jsx(aE,{current:d,roots:mE,data:f,onOpen:h,onPullRefresh:S,onContextMenu:w,onOpenActions:p,countVersion:E,className:"flex-1 min-h-0 overflow-auto scrollbar-thin",showResizeHandle:!1})]}):a.jsx(cE,{items:j,filteredItems:v,metricKeys:m,selectedItems:x,selectedMetric:y,onSelectMetric:k,filters:R,onChangeRange:M,onChangeFilters:N})}),a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 right-0",onPointerDown:O})]})}function wE({persistenceEnabled:e,offViewSummary:t,onRevealOffView:n,canRevealOffView:r=!1,onClearOffView:s,browserZoomPercent:i}){const l=!!(t!=null&&t.names.length)&&t?` (${t.names.join(", ")}${t.extra?` +${t.extra}`:""})`:"",u=r&&n!=null,d=typeof i=="number"?i:null,f=d!==null&&Math.abs(d-100)>=2;return!e||f||!!t?a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-col gap-2",children:[!e&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Not persisted."})," Workspace is read-only; edits stay in memory until restart."]}),f&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Browser zoom ",Math.round(d),"%."]})," For best results, set it to 100% so UI elements stay in correct proportions."]}),t&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex items-center justify-between gap-3",children:[a.jsxs("span",{children:["Updates outside current view: ",t.count," item",t.count===1?"":"s",l]}),a.jsxs("div",{className:"flex items-center gap-2",children:[u&&a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>n==null?void 0:n(),"aria-label":"Reveal off-view updates",children:"Reveal"}),a.jsx("button",{className:"text-muted hover:text-text transition-colors text-base leading-none",onClick:s,"aria-label":"Clear off-view updates",children:""})]})]})]})}):null}const SE=6e3,bE=1e4,CE=24*60*6e4,kE=3e4,EE=350,NE=1400,jE=2048,ME=6,RE=10;function Ax(e){const t=new Map;for(const n of e)t.set(n.path,n.name);return t}function Dx(e,t){return t.get(e)??e.split("/").pop()??e}function mg(e,t){const n=e.filter(r=>!t.has(r.path));return n.length===e.length?e:n}function gg(e,t,n,r,s){const i=e.filter(l=>l.path!==t);return[{path:t,ts:n,kind:r},...i].slice(0,s)}function PE(e,t){if(!e.length)return null;const n=Ax(t),r=new Set,s=[];for(const o of e)r.has(o.path)||(r.add(o.path),s.push(o.path));const i=s.slice(0,2).map(o=>Dx(o,n));return{count:s.length,names:i,extra:Math.max(0,s.length-i.length)}}function TE(e,t,n,r){if(!e.length)return[];const s=Ax(t);return e.map(i=>({path:i.path,label:Dx(i.path,s),timeLabel:r(i.ts,n)}))}function LE(e){const[t,n]=c.useState([]),[r,s]=c.useState([]),[i,o]=c.useState(new Map),l=c.useRef(new Map),u=c.useRef(new Set),d=c.useRef(new Set),f=c.useRef(new Set);c.useEffect(()=>()=>{for(const j of l.current.values())window.clearTimeout(j);l.current.clear(),u.current.clear()},[]),c.useEffect(()=>{d.current=new Set(e),n(j=>mg(j,f.current))},[e]);const h=c.useCallback((j,v)=>{if(v!=null){if(u.current.has(v))return;if(u.current.add(v),u.current.size>jE){const R=u.current.values().next().value;R!=null&&u.current.delete(R)}}const m=v!=null?`event:${v}`:`event:${j}:${Date.now()}`;o(R=>{if(R.get(j)===m)return R;const M=new Map(R);return M.set(j,m),M});const x=l.current,y=x.get(j);y!=null&&window.clearTimeout(y);const k=window.setTimeout(()=>{o(R=>{if(R.get(j)!==m)return R;const M=new Map(R);return M.delete(j),M}),x.delete(j)},NE);x.set(j,k)},[]),p=c.useCallback(j=>{f.current=j,n(v=>mg(v,j))},[]),S=c.useCallback((j,v,m)=>{const x=Date.now();d.current.has(j)&&f.current.has(j)||n(k=>gg(k,j,x,v,ME)),h(j,m)},[h]),w=c.useCallback((j,v,m)=>{const x=Date.now(),y=Sx(m)??x;s(k=>gg(k,j,y,v,RE))},[]),E=c.useCallback(()=>{n([])},[]);return{offViewActivity:t,recentTouches:r,highlightedPaths:i,onVisiblePathsChange:p,markRecentActivity:S,markRecentTouch:w,clearOffViewActivity:E}}function _E(e){return e.isOffline?"offline":e.isUnstable?"unstable":e.recentEditActive?"recent":Number.isFinite(e.editingCount)&&e.editingCount>0?"editing":"live"}function zx(e){if(!e.length)return e;const t=new Set,n=[];for(const r of e)t.has(r.path)||(t.add(r.path),n.push(r));return n}function $x(e){return{...e,items:zx(e.items)}}function IE(e,t){const n=e.pageCount??1,r=e.pageSize??t,s=(e.page??1)+1;return n<=1||s>n?null:{startPage:s,endPage:n,pageSize:r}}function FE(e,t){if(e.path!==t.path)return $x(t);const n=zx([...e.items,...t.items]);return{...e,generatedAt:t.generatedAt??e.generatedAt,dirs:e.dirs.length?e.dirs:t.dirs,items:n,page:t.page??e.page,pageSize:t.pageSize??e.pageSize,pageCount:t.pageCount??e.pageCount,totalItems:t.totalItems??e.totalItems}}async function OE(e,t){const n=t.shouldContinue??(()=>!0);let r=$x(e);t.onUpdate(r);const s=IE(e,t.defaultPageSize);if(s)for(let i=s.startPage;i<=s.endPage;i+=1){let o;try{o=await t.fetchPage(i,s.pageSize)}catch{return}if(!n())return;r=FE(r,o),t.onUpdate(r)}}const Bx=[-2,-1,1,2],Ux=[-2,-1,0,1,2,3];Bx.length;Ux.length;function AE(e,t,n){return Math.min(Math.max(e,t),n)}function Vx(e,t,n){const r=new Set,s=[];for(const i of n){const o=t+i;if(o<0||o>=e.length)continue;const l=e[o];!l||r.has(l)||(r.add(l),s.push(l))}return s}function DE(e,t){if(!t)return[];const n=e.indexOf(t);return n<0?[]:Vx(e,n,Bx)}function zE(e,t){if(e.length<2)return[];const n=Math.max(0,e.length-2),r=AE(t,0,n);return Vx(e,r,Ux)}function $E({paths:e,defaultDestination:t,destinations:n,loadingDestinations:r,onClose:s,onSubmit:i}){const[o,l]=c.useState(()=>jt(t||"/")),[u,d]=c.useState(!1);c.useEffect(()=>{l(jt(t||"/"))},[t,e]);const f=jt(o||"/"),h=e.length>0&&!u,p=e.slice(0,3).map(j=>hh(j)||j),S=Math.max(0,e.length-p.length),w=n.filter(j=>j!==f).slice(0,8),E=async j=>{if(j.preventDefault(),!!h){d(!0);try{await i(e,f)}finally{d(!1)}}};return a.jsx("div",{className:"toolbar-offset fixed inset-0 z-overlay bg-black/45 backdrop-blur-[1px] flex items-center justify-center p-3",children:a.jsxs("div",{className:"w-full max-w-[560px] rounded-xl border border-border bg-panel shadow-[0_20px_60px_rgba(0,0,0,0.55)]",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Move to folder"}),a.jsxs("div",{className:"text-xs text-muted",children:[e.length," item(s) selected"]})]}),a.jsx("button",{type:"button",className:"btn btn-icon",onClick:s,"aria-label":"Close move dialog",disabled:u,children:""})]}),a.jsxs("form",{className:"px-4 py-3 flex flex-col gap-3",onSubmit:E,children:[a.jsxs("div",{className:"text-xs text-muted",children:[p.join(", "),S>0?` and ${S} more`:""]}),a.jsxs("label",{className:"text-xs text-muted flex flex-col gap-1.5",children:["Destination folder",a.jsx("input",{value:o,onChange:j=>l(j.target.value),className:"input w-full",list:"move-destination-list",placeholder:"/",autoFocus:!0,disabled:u})]}),a.jsx("datalist",{id:"move-destination-list",children:n.map(j=>a.jsx("option",{value:j},j))}),a.jsx("div",{className:"text-[11px] text-muted",children:r?"Loading folder list":`${n.length.toLocaleString()} destination(s) loaded`}),w.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5",children:w.map(j=>a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>l(j),disabled:u,children:j},j))}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-border",children:[a.jsx("button",{type:"button",className:"btn",onClick:s,disabled:u,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-active",disabled:!h,children:u?"Moving":"Move"})]})]})]})})}function BE(e){return JSON.stringify(e,null,2)}function UE(e){const t=s=>'"'+s.replaceAll('"','""')+'"',n="path,folder,name,star,type,size,width,height,tags,notes",r=e.map(s=>{const i=(s.tags||[]).join(" "),o=s.notes||"";return[s.path,s.folder,s.name,String(s.star??""),s.type??"",s.size??"",s.width??"",s.height??"",i,o].map(l=>t(String(l))).join(",")});return[n,...r].join(`
`)}function VE(e){return e.map(t=>{const n=t.path.split("/").filter(Boolean);n.pop();const r=n.length?`/${n.join("/")}`:"/";return{path:t.path,folder:r,name:t.name,star:t.star??null,type:t.type,size:t.size,width:t.w,height:t.h}})}function HE({x:e,y:t,items:n}){const r=c.useRef(null),[s,i]=c.useState({x:e,y:t}),[o,l]=c.useState(!1),u=c.useCallback((f,h)=>{h.stopPropagation(),f.disabled||f.onClick()},[]),d=c.useCallback(()=>{const f=r.current,h=ux(),p=f==null?void 0:f.getBoundingClientRect(),S=(p==null?void 0:p.width)??180,w=(p==null?void 0:p.height)??Math.max(40,n.length*36),E=ax({x:e,y:t,menuWidth:S,menuHeight:w,viewport:h});i(j=>j.x===E.x&&j.y===E.y?j:E),l(!0)},[n.length,e,t]);return c.useLayoutEffect(()=>{d()},[d]),c.useEffect(()=>(window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}),[d]),a.jsx("div",{ref:r,className:"dropdown-panel fixed",role:"menu",style:{left:s.x,top:s.y,minWidth:180,visibility:o?"visible":"hidden"},onClick:f=>f.stopPropagation(),children:n.map((f,h)=>a.jsxs("button",{className:`dropdown-item w-full ${f.danger?"text-danger hover:text-danger":""}`,role:"menuitem","aria-disabled":f.disabled,disabled:f.disabled,onClick:p=>u(f,p),children:[f.icon&&a.jsx("span",{className:"shrink-0",children:f.icon}),a.jsx("span",{children:f.label})]},h))})}function WE(e,t){const n=QE(e)||"view",r=new Set(t.map(i=>i.id));if(!r.has(n))return n;let s=2;for(;r.has(`${n}-${s}`);)s+=1;return`${n}-${s}`}function QE(e){return e.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function Oc(e){const t=e.filter(s=>s>0).sort((s,i)=>i-s),n=e.includes(0),r=[...t.map(s=>String(s))];return n&&r.push("None"),r.join(", ")}function KE(e,t){return e&&t?`${e} to ${t}`:e?`from ${e}`:t?`to ${t}`:""}function YE(e){if(e==="/"||e==="")return"Root";const t=e.split("/").filter(Boolean);return t.length?t.length<=2?`/${t.join("/")}`:`.../${t.slice(-2).join("/")}`:"Root"}function XE(e,t){return`${vg(e)}${vg(t)}`}function vg(e){const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function qE(e){const t=e.toLowerCase();return t.endsWith(".png")?"image/png":t.endsWith(".webp")?"image/webp":"image/jpeg"}function GE(e,t){const n=e.split("/").pop()??e;return{path:e,name:n,type:qE(e),w:0,h:0,size:0,hasThumb:!0,hasMeta:!1,star:t??null}}function ba(e,t){const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}function yg(e){return e==="csv"?"text/csv;charset=utf-8":"application/json;charset=utf-8"}function xg(e,t){const n=VE(e);return t==="csv"?UE(n):BE(n)}function wg(){return new Date().toISOString().replace(/[:.]/g,"-")}function JE({ctx:e,current:t,items:n,setCtx:r,onRefetch:s,onOpenMoveDialog:i,onRefreshFolder:o}){const l=Sk(t),[u,d]=c.useState(!1),[f,h]=c.useState(null),p=e.kind==="grid"?e.payload.paths:[],S=c.useMemo(()=>new Map(n.map(M=>[M.path,M])),[n]),w=()=>{r(null)},E=async()=>{const M=e.kind==="tree"?e.payload.path:"/";d(!0);try{await o(M)}catch(N){console.error("Failed to refresh folder:",N)}finally{d(!1),w()}},j=M=>async()=>{h(M);const N=e.kind==="tree"?e.payload.path:t;try{const O=await we.getFolder(N,{recursive:!0,legacyRecursive:!0}),T=xg(O.items,M),X=yg(M),J=N==="/"?"root":(N.replace(/^\/+/,"")||"root").replace(/\//g,"_");ba(new Blob([T],{type:X}),`metadata_${J}_${wg()}.${M}`)}catch(O){console.error("Failed to export folder:",O),alert("Failed to export folder. See console for details.")}finally{h(null),w()}},v=M=>async()=>{h(M);try{const N=new Set(p),O=n.filter(J=>N.has(J.path)),T=xg(O,M),X=yg(M);ba(new Blob([T],{type:X}),`metadata_selection_${wg()}.${M}`)}finally{h(null),w()}},m=async()=>{var M;if(p.length){w();for(const N of p)try{const O=await we.getFile(N),T=((M=S.get(N))==null?void 0:M.name)||hh(N)||"image";ba(O,T)}catch(O){console.error(`Failed to download ${N}:`,O)}}},x=async()=>{if(!l){for(const M of p)try{await we.moveFile(M,"/_trash_")}catch(N){console.error(`Failed to trash ${M}:`,N)}s(),w()}},y=async()=>{if(confirm(`Delete ${p.length} file(s) permanently? This cannot be undone.`)){try{await we.deleteFiles(p)}catch(M){console.error("Failed to delete files:",M)}s(),w()}},k=async()=>{for(const M of p)try{const O=(await we.getSidecar(M)).original_position,T=O&&O.split("/").slice(0,-1).join("/")||"/";await we.moveFile(M,T)}catch(N){console.error(`Failed to recover ${M}:`,N)}s(),w()},R=e.kind==="tree"?[{label:u?"Refreshing":"Refresh",disabled:u,onClick:E},{label:f==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!f||u,onClick:j("csv")},{label:f==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!f||u,onClick:j("json")}]:ZE({selectedPaths:p,inTrash:l,exporting:f,onDownloadSelection:m,onMoveSelection:i,onMoveToTrash:x,onPermanentDelete:y,onRecover:k,onExportCsv:v("csv"),onExportJson:v("json")});return a.jsx(HE,{x:e.x,y:e.y,items:R})}function ZE({selectedPaths:e,inTrash:t,exporting:n,onDownloadSelection:r,onMoveSelection:s,onMoveToTrash:i,onPermanentDelete:o,onRecover:l,onExportCsv:u,onExportJson:d}){const f=[];return e.length&&f.push({label:e.length>1?`Download (${e.length})`:"Download",onClick:r}),e.length&&f.push({label:"Move to",disabled:t,onClick:()=>{t||s(e)}}),f.push({label:"Move to trash",disabled:t,onClick:i}),t&&(f.push({label:"Permanent delete",danger:!0,onClick:o}),f.push({label:"Recover",onClick:l})),e.length&&(f.push({label:n==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!n,onClick:u}),f.push({label:n==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!n,onClick:d})),f}const qe={sortKey:"sortKey",sortDir:"sortDir",sortSpec:"sortSpec",starFilters:"starFilters",filterAst:"filterAst",selectedMetric:"selectedMetric",viewMode:"viewMode",gridItemSize:"gridItemSize",leftOpen:"leftOpen",rightOpen:"rightOpen"},eN=600;function tN(e){switch(e){case"live":return"Live";case"reconnecting":return"Reconnecting";case"offline":return"Offline";case"connecting":case"idle":default:return"Connecting"}}function Sg(e){if(!(e instanceof on))return null;const t=e.body;if(!t||typeof t!="object")return null;const n=t.error;return typeof n=="string"?n:null}function bg(e,t){for(const n of e)we.prefetchFile(n,t),we.prefetchThumb(n)}function Cg(e,t){return t-e<CE?GC(e,t):JC(e)}function nN(e,t){return e?t instanceof on||t instanceof Error?t.message:"Failed to load embeddings.":null}function rN(e,t,n,r){return e||t?n:r}function sN(e,t,n,r,s,i){return e?n:t||i==="/"?r:s}function iN(e){if(!(e instanceof on))return!1;if(e.status===403||e.status===405)return!0;const t=String(e.message||"").toLowerCase();return t.includes("read-only")||t.includes("no-write")||t.includes("write")}function vo(e,t){return iN(e)?"This workspace is read-only. Upload and move actions are disabled.":e instanceof on||e instanceof Error&&e.message?e.message:t}function Ac(e){return Array.from(new Set(e.filter(Boolean)))}function kg(e,t){return t.length?t.length===1?t[0]:`${e} failed for ${t.length} item(s). ${t[0]}`:""}function oN(){var _h,Ih,Fh;const[e,t]=c.useState("/"),[n,r]=c.useState(""),[s,i]=c.useState([]),[o,l]=c.useState(!1),[u,d]=c.useState(null),[f,h]=c.useState(null),[p,S]=c.useState(!1),[w,E]=c.useState(0),[j,v]=c.useState(0),[m,x]=c.useState(null),[y,k]=c.useState(100),[R,M]=c.useState(null),[N,O]=c.useState(()=>({filters:{and:[]},sort:{kind:"builtin",key:"added",dir:"desc"},selectedMetric:void 0})),[T,X]=c.useState(()=>Date.now()),[J,$]=c.useState("adaptive"),[oe,Q]=c.useState(220),[A,_]=c.useState(!1),[P,D]=c.useState(!0),[V,ee]=c.useState(!0),[se,I]=c.useState(()=>typeof window>"u"?1440:window.innerWidth),U=ga(ma.narrow),[Y,Z]=c.useState("folders"),[q,te]=c.useState([]),[he,Ee]=c.useState(null),[ye,Oe]=c.useState(0),[Se,_e]=c.useState({}),ct=c.useRef(null),St=c.useRef(null),cn=c.useRef(null),$n=c.useRef(null),Jt=c.useRef(null),et=c.useRef(!1),Zt=c.useRef(!1),Ut=c.useRef(null),dn=c.useRef(null),Nn=c.useRef(Hi()),fn=c.useRef(null),tt=c.useRef(null),pt=c.useRef(null),en=c.useRef(!1),Pt=c.useRef(null),Bn=c.useRef("idle"),{leftW:Je,rightW:jn,onResizeLeft:jr,onResizeRight:z}=Gk(ct,Y),[ne,K]=c.useState(!1),[le,ge]=c.useState(!1),[xe,de]=c.useState(null),[Ce,Pe]=c.useState(null),[mt,ze]=c.useState(["/"]),[bt,Tt]=c.useState(!1),[hn,nt]=c.useState(null),Me=Qs(),Mn=zC(),Ct=bu(),ds=BC(),[rt,Un]=c.useState("idle"),[Xi,qi]=c.useState({}),[nr,Nu]=c.useState(null),[fs,Ks]=c.useState(null),[rr,Ys]=c.useState(!1),[hs,Vn]=c.useState(()=>Date.now()),[Mr,ju]=c.useState(!0),[Mu,fl]=c.useState(!1);c.useEffect(()=>{const g=L=>{const B=jt(L),H=wk(B)?B:null,ie=H?Vm(B):B;H?(h(H),i([H])):(h(null),et.current=!1),t(ve=>ve===ie?ve:(v(G=>G+1),ie))};g(Bm());const C=()=>g(Bm());return window.addEventListener("hashchange",C),()=>window.removeEventListener("hashchange",C)},[]),c.useEffect(()=>{if(fs==null){Ys(!1);return}Ys(!0);const g=window.setTimeout(()=>Ys(!1),SE);return()=>window.clearTimeout(g)},[fs]),c.useEffect(()=>{if(nr==null)return;Vn(Date.now());const g=window.setInterval(()=>Vn(Date.now()),1e4);return()=>window.clearInterval(g)},[nr]);const{data:ps,refetch:Gi,isLoading:Ru,isError:Pu}=nf(e,!0,{page:1,pageSize:xa}),[We,hl]=c.useState(),Ji=c.useRef(0),sr=c.useCallback(()=>Gi(),[Gi]),{data:ir}=nf("/",!0,{enabled:!1,page:1,pageSize:xa});c.useEffect(()=>{Me.removeQueries({predicate:({queryKey:g})=>ck(g,e,!0)})},[e,Me]),c.useEffect(()=>{Ji.current+=1,hl(void 0),de(null)},[e]),c.useEffect(()=>{if(!ps)return;const g=++Ji.current;let C=!1;return OE(ps,{defaultPageSize:xa,fetchPage:(L,B)=>we.getFolder(ps.path,{recursive:!0,page:L,pageSize:B}),onUpdate:hl,shouldContinue:()=>!C&&Ji.current===g}),()=>{C=!0}},[ps]);const Lt=u!==null,pn=!Lt&&n.trim().length>0,Zi=Jk(n,250),or=c.useMemo(()=>Zi.trim().replace(/\s+/g," "),[Zi]),Xs=mk(pn?or:"",e),Hn=vk(),pl=((_h=Hn.data)==null?void 0:_h.embeddings)??[],Tu=((Ih=Hn.data)==null?void 0:Ih.rejected)??[],Lu=pl.length>0,_u=nN(Hn.isError,Hn.error),lr=c.useMemo(()=>jt(e||"/"),[e]),eo=c.useMemo(()=>Hm(N.filters),[N.filters]),Xe=c.useMemo(()=>{var C;return(pn?((C=Xs.data)==null?void 0:C.items)??[]:(We==null?void 0:We.items)??[]).map(L=>({...L,star:Se[L.path]!==void 0?Se[L.path]:L.star}))},[pn,Xs.data,We,Se]),ms=c.useMemo(()=>{var L;const g=new Map;for(const B of Xe)g.set(B.path,B);const C=((L=Xs.data)==null?void 0:L.items)??[];for(const B of C){if(g.has(B.path))continue;const H=Se[B.path]!==void 0?Se[B.path]:B.star;g.set(B.path,{...B,star:H})}return g},[Xe,Xs.data,Se]),_t=c.useMemo(()=>u?u.items.map(g=>{const C=ms.get(g.path);return C||GE(g.path,Se[g.path])}):[],[u,ms,Se]),Be=c.useMemo(()=>{if(u)return Xm(_t,N.filters);const g=Xm(Xe,N.filters);return Qk(g,N.sort,T)},[u,_t,Xe,N.filters,N.sort,T]),F=u?_t.length:Xe.length,ae=Be.length,ce=c.useMemo(()=>Be.map(g=>g.path),[Be]),{offViewActivity:me,recentTouches:Te,highlightedPaths:mn,onVisiblePathsChange:ar,markRecentActivity:Rr,markRecentTouch:Pr,clearOffViewActivity:st}=LE(ce),Wn=c.useMemo(()=>new Set(s),[s]),qs=c.useMemo(()=>{if(!s.length)return[];const g=u?_t:Xe,C=new Map(g.map(B=>[B.path,B])),L=new Map(Be.map(B=>[B.path,B]));return s.map(B=>C.get(B)??L.get(B)).filter(B=>!!B)},[s,u,_t,Xe,Be]),Vt=c.useMemo(()=>Be.filter(g=>Wn.has(g.path)),[Be,Wn]),Iu=c.useMemo(()=>Vt.map(g=>g.path),[Vt]),gt=Math.max(0,Vt.length-2),gn=Math.min(w,gt),to=Vt[gn]??null,no=Vt[gn+1]??null,ml=gn>0,Fu=gn<Vt.length-2,gs=Vt.length>=2,Hx=u?_t:Xe,ro=u?null:N.sort.kind==="metric"?N.sort.key:null,gh=c.useMemo(()=>ro?Be.some(g=>{var L;const C=(L=g.metrics)==null?void 0:L[ro];return C!=null&&!Number.isNaN(C)}):!1,[Be,ro]);c.useEffect(()=>{E(g=>g>gt?gt:g)},[gt]);const Ou=c.useCallback(g=>{const C=Date.now(),B=Sx(g)??C,H=B>C?C:B;Nu(ie=>ie==null?H:ie>H?ie:H),Ks(C),Vn(C)},[]),Au=c.useCallback(g=>{const C=Object.prototype.hasOwnProperty.call(g,"star"),L=g.metrics!==void 0,B=g.comments!==void 0;if(!C&&!L&&!B)return;const H=ve=>{if(ve.path!==g.path)return ve;let G=ve;return C&&ve.star!==g.star&&(G={...G,star:g.star??null}),L&&(G={...G,metrics:g.metrics??null}),B&&ve.comments!==g.comments&&(G={...G,comments:g.comments??""}),G},ie=ve=>{if(!ve)return ve;let G=!1;const fe=ve.items.map(Ne=>{const Ht=H(Ne);return Ht!==Ne&&(G=!0),Ht});return G?{...ve,items:fe}:ve};Me.setQueriesData({predicate:({queryKey:ve})=>Array.isArray(ve)&&ve[0]==="folder"},ie),Me.setQueriesData({predicate:({queryKey:ve})=>Array.isArray(ve)&&ve[0]==="search"},ie)},[Me]),gl=c.useCallback(()=>{Oe(g=>g+1)},[]),vh=c.useCallback(g=>{const C=jt(g||"/");return C===""?"/":C},[]),yh=c.useCallback(g=>{const C=L=>g==="/"?!0:L===g||L.startsWith(`${g}/`);Me.invalidateQueries({predicate:({queryKey:L})=>{if(!Array.isArray(L)||L[0]!=="folder")return!1;const B=typeof L[1]=="string"?L[1]:"";return C(B)}})},[Me]),Du=c.useCallback(async g=>{const C=vh(g);await we.refreshFolder(C),yh(C),gl(),(e===C||e.startsWith(C==="/"?"/":`${C}/`))&&await sr(),Hd.evictPrefix(C),ni.evictPrefix(C)},[e,gl,yh,vh,sr]),Wx=c.useCallback(async()=>{try{await Du(e)}catch(g){console.error("Failed to refresh folder:",g)}},[e,Du]),Gs=c.useCallback(g=>{g.length&&qi(C=>{let L=!1;const B={...C};for(const H of g){const ie=C[H.gallery_id];ie&&ie.viewing===H.viewing&&ie.editing===H.editing||(B[H.gallery_id]=H,L=!0)}return L?B:C})},[]),vl=c.useCallback(()=>{Pt.current!=null&&(window.clearTimeout(Pt.current),Pt.current=null)},[]),yl=c.useCallback(g=>{g&&qi(C=>{if(!(g in C))return C;const L={...C};return delete L[g],L})},[]),zu=c.useCallback(g=>{fn.current=g.lease_id,tt.current=g.gallery_id,Gs([g])},[Gs]),Qn=c.useCallback(async(g,C=!1)=>{const L=Nn.current,B=C?void 0:fn.current??void 0,H=ie=>we.joinPresence(g,ie,L);try{zu(await H(B));return}catch(ie){if(!C&&Sg(ie)==="invalid_lease"){zu(await H(void 0));return}throw ie}},[zu]),xh=c.useCallback(async(g,C)=>{if(g===C){await Qn(C);return}const L=fn.current;if(!L){await Qn(C,!0);return}try{const B=await we.movePresence(g,C,L,Nn.current);tt.current=B.to_scope.gallery_id,Gs([B.from_scope,B.to_scope]);return}catch(B){const H=Sg(B);if(H==="invalid_lease"){await Qn(C,!0);return}if(H==="scope_mismatch"){await Qn(C);return}throw B}},[Gs,Qn]),wh=c.useCallback(async g=>{const C=tt.current;if(!C){await Qn(g,!0);return}if(C===g){await Qn(g);return}await xh(C,g)},[Qn,xh]),xl=c.useCallback(async()=>{if(en.current)return;const g=pt.current;if(g){pt.current=null,en.current=!0;try{await wh(g)}catch{}finally{en.current=!1;const C=pt.current;C&&C!==tt.current&&xl()}}},[wh]),Js=c.useCallback((g,C=!1)=>{if(pt.current=g,vl(),C||tt.current==null){xl();return}Pt.current=window.setTimeout(()=>{Pt.current=null,xl()},EE)},[vl,xl]),Sh=c.useCallback(()=>{tt.current=null,fn.current=null,pt.current=null,vl()},[vl]),wl=c.useCallback(g=>{const C=tt.current,L=fn.current;!C||!L||(Sb(C,L,Nn.current),g&&yl(C),Sh())},[yl,Sh]);c.useEffect(()=>{pb();const g=gb(L=>{if(L.type==="presence"){const ie=L.data;if(!(ie!=null&&ie.gallery_id))return;Gs([ie]);return}const B=L.data;if(!(B!=null&&B.path))return;const H=B.path;if(L.type==="item-updated"){const ie=L.data,ve={v:1,tags:ie.tags??[],notes:ie.notes??"",star:ie.star??null,version:ie.version??1,updated_at:ie.updated_at??"",updated_by:ie.updated_by??"server"};Me.setQueryData(el(H),ve),Au({path:H,star:ie.star??null,metrics:ie.metrics,comments:ie.notes??""}),HC(H,ve),Rr(H,"item-updated",L.id),Pr(H,"item-updated",ie.updated_at),Ou(ie.updated_at),_e(G=>{if(G[H]===void 0)return G;const fe={...G};return delete fe[H],fe})}else if(L.type==="metrics-updated"){const ie=L.data;Au({path:H,metrics:ie.metrics}),Rr(H,"metrics-updated",L.id),Pr(H,"metrics-updated",ie.updated_at),Ou(ie.updated_at)}}),C=vb(Un);return()=>{g(),C(),mb()}},[Gs,Rr,Pr,Me,Au,Ou]),c.useEffect(()=>{const g=tt.current;g!==lr&&Js(lr,g==null)},[lr,Js]),c.useEffect(()=>{const g=window.setInterval(()=>{const C=tt.current;C&&Qn(C)},kE);return()=>{window.clearInterval(g)}},[Qn]),c.useEffect(()=>{const g=Bn.current;if(Bn.current=rt,rt==="live"&&g!=="live"){Js(lr,!0);return}(rt==="reconnecting"||rt==="offline")&&yl(tt.current)},[yl,rt,lr,Js]),c.useEffect(()=>{const g=()=>wl(!0),C=()=>wl(!0),L=()=>{Js(lr,!0)};return window.addEventListener("pagehide",g),window.addEventListener("beforeunload",C),window.addEventListener("pageshow",L),()=>{window.removeEventListener("pagehide",g),window.removeEventListener("beforeunload",C),window.removeEventListener("pageshow",L),wl(!1)}},[lr,Js,wl]),c.useEffect(()=>{let g=!1;return we.getHealth().then(C=>{var B;if(g)return;const L=((B=C==null?void 0:C.labels)==null?void 0:B.enabled)??!0;ju(L)}).catch(()=>{}),()=>{g=!0}},[]);const Qx=c.useMemo(()=>{const g=u?_t:Xe,C={0:0,1:0,2:0,3:0,4:0,5:0};for(const L of g){const B=Se[L.path]??L.star??0;C[String(B)]=(C[String(B)]||0)+1}return C},[u,_t,Xe,Se]),Tr=c.useMemo(()=>{const g=new Set;let C=0;const L=u?_t:Xe;for(const B of L){const H=B.metrics;if(H)for(const ie of Object.keys(H))g.add(ie);if(C+=1,C>=250&&g.size>0)break}return Array.from(g).sort()},[u,_t,Xe]);c.useEffect(()=>{Lt||Tr.length&&O(g=>{const C=g.selectedMetric&&Tr.includes(g.selectedMetric)?g.selectedMetric:Tr[0];return C===g.selectedMetric?g:{...g,selectedMetric:C}})},[Tr,Lt]),c.useEffect(()=>{Lt||N.sort.kind==="metric"&&(Tr.includes(N.sort.key)||O(g=>({...g,sort:{kind:"builtin",key:"added",dir:g.sort.dir}})))},[Tr,N.sort,Lt]);const Sl=c.useMemo(()=>$k(N.filters),[N.filters]),bl=(We==null?void 0:We.totalItems)??(We==null?void 0:We.items.length)??F,Kx=e==="/"?bl:(ir==null?void 0:ir.totalItems)??(ir==null?void 0:ir.items.length)??bl,$u=Lt||pn||Sl>0,Cl=Xi[e],Yx=Mn.state==="syncing"?"Syncing":Mn.state==="error"?Mn.message?`Not saved  ${Mn.message}`:"Not saved  retry":"All changes saved",Xx=tN(rt),Bu=nr!=null,qx=c.useMemo(()=>!Bu||nr==null?"No edits yet.":Cg(nr,hs),[Bu,nr,hs]),Gx=(Cl==null?void 0:Cl.editing)??0,Jx=ds!=null&&ds>bE,Zx=rt==="offline"||rt==="connecting"||rt==="idle",e0=rt==="reconnecting"||Ct||Mn.state==="error"||Jx,t0=_E({isOffline:Zx,isUnstable:e0,recentEditActive:rr,editingCount:Gx}),n0=c.useMemo(()=>PE(me,Be),[me,Be]),r0=c.useMemo(()=>TE(Te,Be,hs,Cg),[Be,hs,Te]),s0=rN(Lt,$u,ae,bl),i0=sN(Lt,$u,F,bl,Kx,e),bh=c.useMemo(()=>{if(!u)return null;if(u.queryPath){const g=u.queryPath.split("/").filter(Boolean);return g.length?g[g.length-1]:u.queryPath}return u.queryVector?"Vector query":null},[u]),Ch=c.useMemo(()=>u?Sl>0?`${ae} of ${F}`:`${F}`:null,[u,Sl,ae,F]),It=c.useCallback(g=>{O(C=>({...C,filters:g(C.filters)}))},[]),o0=c.useCallback(g=>{O(C=>({...C,filters:g}))},[]),kl=c.useCallback(()=>{It(g=>_c(g,[]))},[It]),kh=c.useCallback(()=>{O(g=>({...g,filters:{and:[]}}))},[]),Uu=c.useCallback(()=>{d(null);const g=dn.current;dn.current=null,g&&g.length?(i(g),v(C=>C+1)):i([])},[]),l0=c.useCallback(()=>{u&&Uu(),r(""),O(g=>({...g,filters:{and:[]}}))},[Uu,u]),a0=c.useCallback(async g=>{!u&&dn.current===null&&(dn.current=s);const C=await we.searchEmbeddings(g);if(d({embedding:C.embedding,queryPath:g.query_path??null,queryVector:g.query_vector_b64??null,topK:g.top_k??50,minScore:g.min_score??null,items:C.items,createdAt:Date.now()}),C.items.length){const L=g.query_path&&C.items.some(B=>B.path===g.query_path)?g.query_path:C.items[0].path;i([L]),v(B=>B+1)}else i([])},[u,s]),Vu=c.useCallback((g,C)=>{It(L=>zk(L,g,C))},[It]),Eh=c.useMemo(()=>{var C,L,B,H,ie,ve;const g=[];for(const G of N.filters.and)if("stars"in G){const fe=G.stars||[];if(!fe.length)continue;g.push({id:"stars",label:`Rating in: ${Oc(fe)}`,onRemove:()=>kl()})}else if("starsIn"in G){const fe=G.starsIn.values||[];if(!fe.length)continue;g.push({id:"stars-in",label:`Rating in: ${Oc(fe)}`,onRemove:()=>kl()})}else if("starsNotIn"in G){const fe=G.starsNotIn.values||[];if(!fe.length)continue;g.push({id:"stars-not-in",label:`Rating not in: ${Oc(fe)}`,onRemove:()=>It(Ne=>Mx(Ne,[]))})}else if("nameContains"in G){const fe=(C=G.nameContains.value)==null?void 0:C.trim();if(!fe)continue;g.push({id:"name-contains",label:`Filename contains: ${fe}`,onRemove:()=>It(Ne=>Rx(Ne,""))})}else if("nameNotContains"in G){const fe=(L=G.nameNotContains.value)==null?void 0:L.trim();if(!fe)continue;g.push({id:"name-not-contains",label:`Filename not: ${fe}`,onRemove:()=>It(Ne=>Px(Ne,""))})}else if("commentsContains"in G){const fe=(B=G.commentsContains.value)==null?void 0:B.trim();if(!fe)continue;g.push({id:"comments-contains",label:`Comments contain: ${fe}`,onRemove:()=>It(Ne=>Tx(Ne,""))})}else if("commentsNotContains"in G){const fe=(H=G.commentsNotContains.value)==null?void 0:H.trim();if(!fe)continue;g.push({id:"comments-not-contains",label:`Comments not: ${fe}`,onRemove:()=>It(Ne=>Lx(Ne,""))})}else if("urlContains"in G){const fe=(ie=G.urlContains.value)==null?void 0:ie.trim();if(!fe)continue;g.push({id:"url-contains",label:`URL contains: ${fe}`,onRemove:()=>It(Ne=>_x(Ne,""))})}else if("urlNotContains"in G){const fe=(ve=G.urlNotContains.value)==null?void 0:ve.trim();if(!fe)continue;g.push({id:"url-not-contains",label:`URL not: ${fe}`,onRemove:()=>It(Ne=>Ix(Ne,""))})}else if("dateRange"in G){const{from:fe,to:Ne}=G.dateRange;if(!fe&&!Ne)continue;g.push({id:"date-range",label:`Date: ${KE(fe,Ne)}`,onRemove:()=>It(Ht=>sf(Ht,null))})}else if("widthCompare"in G){const{op:fe,value:Ne}=G.widthCompare;g.push({id:"width-compare",label:`Width ${fe} ${Ne}`,onRemove:()=>It(Ht=>wa(Ht,null))})}else if("heightCompare"in G){const{op:fe,value:Ne}=G.heightCompare;g.push({id:"height-compare",label:`Height ${fe} ${Ne}`,onRemove:()=>It(Ht=>Sa(Ht,null))})}else if("metricRange"in G){const{key:fe,min:Ne,max:Ht}=G.metricRange;g.push({id:`metric:${fe}`,label:`${fe}: ${XE(Ne,Ht)}`,onRemove:()=>Vu(fe,null)})}return g},[N.filters,kl,Vu,It]),u0=c.useCallback(g=>{const C=new Set(eo);C.has(g)?C.delete(g):C.add(g),O(L=>({...L,filters:_c(L.filters,Array.from(C))}))},[eo]),c0=c.useCallback(()=>{D(!0),Z("metrics")},[]),d0=c.useCallback(g=>{O(C=>({...C,sort:g})),g.kind==="builtin"&&g.key==="random"&&X(Date.now())},[]),Nh=c.useCallback(g=>{if(g==="/"||g==="")return"Lenslet | Root";const C=g.split("/").filter(Boolean);if(!C.length)return"Lenslet";const L=C.slice(-2).join("/");return`Lenslet | ${C.length>2?`.../${L}`:`/${L}`}`},[]),f0=c.useMemo(()=>YE(e),[e]);c.useEffect(()=>{document.title=Nh(e)},[e,Nh]),c.useEffect(()=>{let g=!0;return we.getViews().then(C=>{g&&te(C.views||[])}).catch(()=>{g&&te([])}),()=>{g=!1}},[]),c.useEffect(()=>{pn&&(i([]),f&&(h(null),et.current=!1,ea(e)))},[pn,f,e]),c.useEffect(()=>{const g=ct.current,C=$n.current;if(!g||!C)return;const L=()=>{const B=Math.max(48,Math.round(C.getBoundingClientRect().height));g.style.setProperty("--toolbar-h",`${B}px`)};if(L(),"ResizeObserver"in window){const B=new ResizeObserver(L);return B.observe(C),()=>B.disconnect()}return window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[]),c.useEffect(()=>{try{const g=localStorage.getItem(qe.sortKey),C=localStorage.getItem(qe.sortDir),L=localStorage.getItem(qe.sortSpec),B=localStorage.getItem(qe.starFilters),H=localStorage.getItem(qe.filterAst),ie=localStorage.getItem(qe.selectedMetric),ve=localStorage.getItem(qe.viewMode),G=localStorage.getItem(qe.gridItemSize),fe=localStorage.getItem(qe.leftOpen),Ne=localStorage.getItem(qe.rightOpen),Oh=(kt=>{if(!kt)return null;const it=Mc(kt);return!it||typeof it!="object"?null:it.kind==="builtin"&&(it.key==="name"||it.key==="added"||it.key==="random")&&(it.dir==="asc"||it.dir==="desc")||it.kind==="metric"&&typeof it.key=="string"&&it.key.length>0&&(it.dir==="asc"||it.dir==="desc")?it:null})(L)??{kind:"builtin",key:g==="name"||g==="added"||g==="random"?g:"added",dir:C==="asc"||C==="desc"?C:"desc"};Oh.key==="random"&&X(Date.now());let Yu=(kt=>{if(!kt)return null;const it=Mc(kt);return rf(it)})(H)??{and:[]};if(B){const kt=Mc(B);if(Array.isArray(kt)){const it=kt.filter(E0=>[0,1,2,3,4,5].includes(E0));Yu=_c(Yu,it)}}if(O(kt=>({...kt,sort:Oh,filters:Yu,selectedMetric:ie||kt.selectedMetric})),(ve==="grid"||ve==="adaptive")&&$(ve),G){const kt=Number(G);!isNaN(kt)&&kt>=80&&kt<=500&&Q(kt)}(fe==="0"||fe==="false")&&D(!1),(Ne==="0"||Ne==="false")&&ee(!1)}catch{}},[]),c.useEffect(()=>{U&&(D(!1),ee(!1))},[U]),c.useEffect(()=>{if(typeof window>"u")return;const g=[1,1.25,1.5,1.75,2,3,4],C=H=>g.reduce((ie,ve)=>Math.abs(ve-H)<Math.abs(ie-H)?ve:ie,g[0]),L=()=>{var Ht;const H=window.devicePixelRatio||1,ie=C(H),ve=((Ht=window.visualViewport)==null?void 0:Ht.scale)??1,G=H*ve/ie;if(!Number.isFinite(G)){M(null);return}const fe=Math.round(G*100),Ne=Math.min(500,Math.max(25,fe));M(Ne)};L(),window.addEventListener("resize",L),window.addEventListener("orientationchange",L);const B=window.visualViewport;return B&&B.addEventListener("resize",L),()=>{window.removeEventListener("resize",L),window.removeEventListener("orientationchange",L),B&&B.removeEventListener("resize",L)}},[]),c.useEffect(()=>{try{localStorage.setItem(qe.sortKey,N.sort.kind==="builtin"?N.sort.key:"added"),localStorage.setItem(qe.sortDir,N.sort.dir),localStorage.setItem(qe.sortSpec,JSON.stringify(N.sort));const g=Hm(N.filters);localStorage.setItem(qe.starFilters,JSON.stringify(g)),localStorage.setItem(qe.filterAst,JSON.stringify(N.filters)),N.selectedMetric?localStorage.setItem(qe.selectedMetric,N.selectedMetric):localStorage.removeItem(qe.selectedMetric),localStorage.setItem(qe.viewMode,J),localStorage.setItem(qe.gridItemSize,String(oe)),localStorage.setItem(qe.leftOpen,P?"1":"0"),localStorage.setItem(qe.rightOpen,V?"1":"0")}catch{}},[N,J,oe,P,V]),c.useEffect(()=>{if(typeof window>"u")return;const g=()=>I(window.innerWidth);return g(),window.addEventListener("resize",g),window.addEventListener("orientationchange",g),()=>{window.removeEventListener("resize",g),window.removeEventListener("orientationchange",g)}},[]);const El=se<=is.mobileMax;c.useEffect(()=>{El||A&&_(!1)},[El,A]),c.useEffect(()=>{const g=St.current;if(!g)return;const C=B=>Math.min(500,Math.max(80,B)),L=B=>{B.ctrlKey&&(f||p||(B.preventDefault(),Q(H=>C(H+(B.deltaY<0?20:-20)))))};return g.addEventListener("wheel",L,{passive:!1}),()=>g.removeEventListener("wheel",L)},[f,p]),c.useEffect(()=>{if(f||p)return;const g=St.current;if(!g)return;const C=G=>Math.min(500,Math.max(80,G));let L=null;const B=G=>{if(G.length<2)return 0;const[fe,Ne]=[G[0],G[1]];return Math.hypot(fe.clientX-Ne.clientX,fe.clientY-Ne.clientY)},H=G=>{if(G.touches.length!==2)return;const fe=B(G.touches);fe&&(L={dist:fe,size:oe})},ie=G=>{if(!L||G.touches.length!==2)return;const fe=B(G.touches);if(!fe)return;G.preventDefault();const Ne=C(L.size*(fe/L.dist));Q(Ne)},ve=()=>{L=null};return g.addEventListener("touchstart",H,{passive:!0}),g.addEventListener("touchmove",ie,{passive:!1}),g.addEventListener("touchend",ve),g.addEventListener("touchcancel",ve),()=>{g.removeEventListener("touchstart",H),g.removeEventListener("touchmove",ie),g.removeEventListener("touchend",ve),g.removeEventListener("touchcancel",ve)}},[f,p,oe]),c.useEffect(()=>{bg(DE(ce,f),"viewer")},[f,ce]),c.useEffect(()=>{p&&bg(zE(Iu,gn),"compare")},[p,Iu,gn]);const Nl=c.useCallback(g=>{h(null),et.current=!1;const C=jt(g);t(C),Um(C)},[]),Hu=c.useCallback(g=>{const C=Ac(s);return C.includes(g)?C:[g]},[s]),h0=c.useCallback((g,C)=>{const L=Hu(g);i(L),nt({x:C.x,y:C.y,kind:"grid",payload:{paths:L}})},[Hu]),p0=c.useCallback((g,C)=>{nt({x:C.x,y:C.y,kind:"tree",payload:{path:g}})},[]),jh=c.useCallback(async()=>{const g=["/"],C=new Set,L=new Set(["/"]);for(;g.length>0&&C.size<eN;){const B=g.shift()??"/",H=jt(B);if(C.has(H))continue;C.add(H);let ie=null;try{ie=await we.getFolder(H)}catch{ie=null}if(ie)for(const ve of ie.dirs??[]){const G=jt(Nx(H,ve.name));L.has(G)||(L.add(G),g.push(G))}}return Array.from(L).sort((B,H)=>B==="/"?-1:H==="/"?1:B.localeCompare(H))},[]);c.useEffect(()=>{if(!Ce)return;let g=!1;return Tt(!0),jh().then(C=>{g||ze(C)}).catch(C=>{g||de(vo(C,"Failed to load destination folders."))}).finally(()=>{g||Tt(!1)}),()=>{g=!0}},[jh,Ce]);const m0=c.useCallback(async(g,C)=>{const L=Ac(g);if(!L.length)return!1;const B=jt(C||"/");de(null);const H=[],ie=[];for(const G of L)try{await we.moveFile(G,B)}catch(fe){H.push(`${hh(G)||G}: ${vo(fe,"Move failed.")}`),ie.push(G)}try{await Me.invalidateQueries({predicate:({queryKey:G})=>Array.isArray(G)&&G[0]==="folder"}),gl(),await sr()}catch(G){H.push(vo(G,"Move completed, but refresh failed."))}if(H.length)return de(kg("Move",H)),i(ie),!1;Pe(null),nt(null);const ve=new Set(L);return i(G=>G.filter(fe=>!ve.has(fe))),!0},[gl,Me,sr]),g0=c.useCallback(g=>{const C=Ac(g);C.length&&(de(null),Pe({paths:C}),nt(null))},[]),jl=c.useCallback(async g=>{var B;if(!g.length)return;if(!((((B=We==null?void 0:We.dirs)==null?void 0:B.length)??0)===0)){de("Uploads are only allowed into folders without subdirectories.");return}ge(!0),de(null);const L=[];try{for(const H of g)try{await we.uploadFile(e,H)}catch(ie){L.push(`${H.name}: ${vo(ie,"Upload failed.")}`)}try{await sr()}catch(H){L.push(vo(H,"Upload completed, but refresh failed."))}}finally{ge(!1)}if(L.length){de(kg("Upload",L));return}de(null)},[e,(Fh=We==null?void 0:We.dirs)==null?void 0:Fh.length,sr]),v0=c.useCallback(()=>{var g;le||(g=Jt.current)==null||g.click()},[le]),y0=c.useCallback(async g=>{const C=Array.from(g.target.files??[]);g.target.value="",C.length&&await jl(C)},[jl]),x0=c.useCallback(async()=>{const g=window.prompt("Save Smart Folder as:","New Smart Folder");if(!g)return;const C=WE(g,q),L={id:C,name:g,pool:{kind:"folder",path:e},view:JSON.parse(JSON.stringify(N))},B=[...q.filter(H=>H.id!==C),L];te(B),Ee(C);try{await we.saveViews({version:1,views:B})}catch(H){if(H instanceof on&&H.status===403){const ie=new Blob([JSON.stringify({version:1,views:B},null,2)],{type:"application/json"});ba(ie,`lenslet-smart-folder-${C}.json`),alert("No-write mode: exported Smart Folder JSON instead of saving.");return}console.error("Failed to save Smart Folder:",H)}},[e,N,q]);c.useEffect(()=>{if(!he)return;const g=q.find(B=>B.id===he);if(!g){Ee(null);return}const C=g.pool.path===e,L=JSON.stringify(g.view)===JSON.stringify(N);(!C||!L)&&Ee(null)},[he,q,e,N]);const Ml=c.useCallback(g=>{if(!g)return;const C=document.getElementById(`cell-${encodeURIComponent(g)}`);C==null||C.focus()},[]),w0=c.useCallback(g=>{h(g),et.current=!0,Um(g)},[]),Mh=c.useCallback(()=>{h(null),et.current?(et.current=!1,window.history.back()):ea(e),Ml(Ut.current)},[Ml]),S0=c.useCallback(()=>{p||!gs||(s[0]&&(Ut.current=s[0]),E(0),S(!0),f&&(h(null),et.current&&(et.current=!1),ea(e)),Zt.current||(window.history.pushState({compare:!0},"",window.location.href),Zt.current=!0))},[p,gs,s,f,e]),Wu=c.useCallback(()=>{S(!1),Zt.current&&(Zt.current=!1,window.history.back()),Ml(Ut.current??s[0])},[Ml,s]),b0=c.useCallback(g=>{Vt.length<2||E(C=>{const L=Math.max(0,Vt.length-2);return Math.min(L,Math.max(0,C+g))})},[Vt.length]);c.useEffect(()=>{p&&(gs||Wu())},[p,gs,Wu]),c.useEffect(()=>{const g=()=>{f&&(et.current=!1,h(null)),p&&(Zt.current=!1,S(!1))};return window.addEventListener("popstate",g),()=>window.removeEventListener("popstate",g)},[f,p]),c.useEffect(()=>{const g=ct.current;if(!g)return;const C=H=>{H.dataTransfer&&Array.from(H.dataTransfer.types).includes("Files")&&(H.preventDefault(),K(!0))},L=H=>{const ie=H.relatedTarget;ie&&g.contains(ie)||K(!1)},B=async H=>{var ve;H.preventDefault(),K(!1);const ie=Array.from(((ve=H.dataTransfer)==null?void 0:ve.files)??[]);ie.length&&await jl(ie)};return g.addEventListener("dragover",C),g.addEventListener("dragleave",L),g.addEventListener("drop",B),()=>{g.removeEventListener("dragover",C),g.removeEventListener("dragleave",L),g.removeEventListener("drop",B)}},[jl]),c.useEffect(()=>{const g=()=>nt(null),C=L=>{L.key==="Escape"&&nt(null)};return window.addEventListener("click",g),window.addEventListener("keydown",C),()=>{window.removeEventListener("click",g),window.removeEventListener("keydown",C)}},[]),c.useEffect(()=>{const g=C=>{if(!uh(C.target)){if((C.ctrlKey||C.metaKey)&&C.key.toLowerCase()==="b"){C.preventDefault(),C.altKey?ee(L=>!L):D(L=>!L);return}if(!(f||p)){if(C.key==="Backspace"||C.key==="Delete")C.preventDefault(),Nl(Vm(e));else if((C.ctrlKey||C.metaKey)&&C.key.toLowerCase()==="a")C.preventDefault(),i(Be.map(L=>L.path));else if(C.key==="Escape"){if(s.length){C.preventDefault(),i([]);return}A&&(C.preventDefault(),_(!1))}else if(C.key==="/"){C.preventDefault();const L=document.querySelector(".toolbar-right .input");L==null||L.focus()}}}};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[e,Be,s,f,p,Nl,A]);const Rh=c.useMemo(()=>QS({viewportWidth:se,leftOpen:P,rightOpen:V,leftWidth:Je,rightWidth:jn}),[se,P,V,Je,jn]),C0=P?`${Rh.leftWidth}px`:"0px",k0=V?`${Rh.rightWidth}px`:"0px",Ph=f??s[0]??null,Qu=Ph?ce.indexOf(Ph):-1,Th=Qu>0,Lh=Qu>=0&&Qu<ce.length-1,Ku=c.useCallback(g=>{if(!ce.length)return;const C=f??s[0];if(!C)return;const L=ce.indexOf(C);if(L===-1)return;const B=Math.min(ce.length-1,Math.max(0,L+g)),H=ce[B];!H||H===C||(f&&(h(H),ea(H)),i([H]))},[ce,f,s]);return a.jsxs("div",{className:"app-shell grid h-full grid-cols-[var(--left)_1fr_var(--right)]",ref:ct,style:{"--left":C0,"--right":k0},children:[a.jsx(XS,{rootRef:$n,onSearch:r,viewerActive:!!f,onBack:Mh,zoomPercent:f?y:void 0,onZoomPercentChange:g=>x(g),currentLabel:f0,itemCount:s0,totalCount:i0,sortSpec:N.sort,metricKeys:Tr,onSortChange:d0,sortDisabled:Lt,filterCount:Sl,onOpenFilters:c0,starFilters:eo,onToggleStar:u0,onClearStars:kl,onClearFilters:kh,starCounts:Qx,viewMode:J,onViewMode:$,gridItemSize:oe,onGridItemSize:Q,leftOpen:P,rightOpen:V,onToggleLeft:()=>D(g=>!g),onToggleRight:()=>ee(g=>!g),onPrevImage:()=>Ku(-1),onNextImage:()=>Ku(1),canPrevImage:Th,canNextImage:Lh,searchDisabled:Lt,searchPlaceholder:Lt?"Exit similarity to search":void 0,onUploadClick:v0,uploadBusy:le,uploadDisabled:p,multiSelectMode:A,selectedCount:s.length,onToggleMultiSelectMode:El?()=>_(g=>!g):void 0,syncIndicator:{state:t0,presence:Cl,syncLabel:Yx,connectionLabel:Xx,lastEditedLabel:qx,hasEdits:Bu,localTypingActive:Mu,recentTouches:r0}}),a.jsx("input",{ref:Jt,type:"file",multiple:!0,accept:"image/*",className:"sr-only",onChange:y0}),P&&a.jsx(xE,{leftTool:Y,onToolChange:Z,compareEnabled:gs,compareActive:p,onOpenCompare:S0,views:q,activeViewId:he,onActivateView:g=>{var L;Ee(g.id);const C=rf((L=g.view)==null?void 0:L.filters)??{and:[]};O({...g.view,filters:C}),Nl(g.pool.path)},onSaveView:x0,current:e,data:We,onOpenFolder:g=>{Ee(null),Nl(g)},onOpenFolderActions:p0,onPullRefreshFolders:Wx,onContextMenu:(g,C)=>{g.preventDefault(),nt({x:g.clientX,y:g.clientY,kind:"tree",payload:{path:C}})},countVersion:ye,items:Hx,filteredItems:Be,metricKeys:Tr,selectedItems:qs,selectedMetric:N.selectedMetric,onSelectMetric:g=>O(C=>({...C,selectedMetric:g})),filters:N.filters,onChangeRange:Vu,onChangeFilters:o0,onResize:jr}),a.jsxs("div",{className:"grid-shell col-start-2 row-start-2 relative overflow-hidden flex flex-col",ref:St,children:[a.jsx("div",{"aria-live":"polite",className:"sr-only",children:s.length?`${s.length} selected`:""}),a.jsx(wE,{persistenceEnabled:Mr,offViewSummary:n0,canRevealOffView:$u,onRevealOffView:l0,onClearOffView:st,browserZoomPercent:R}),xe&&a.jsx("div",{className:"border-b border-border bg-panel px-3 py-2",children:a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",children:xe})}),u&&a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"font-semibold",children:"Similarity mode"}),a.jsxs("span",{className:"text-muted",children:["Embedding: ",u.embedding]}),bh&&a.jsxs("span",{className:"text-muted",children:["Query: ",bh]}),Ch&&a.jsxs("span",{className:"text-muted",children:["Results: ",Ch]}),a.jsxs("span",{className:"text-muted",children:["Top K: ",u.topK]}),u.minScore!=null&&a.jsxs("span",{className:"text-muted",children:["Min score: ",u.minScore]})]}),a.jsx("button",{className:"btn btn-sm",onClick:Uu,children:"Exit similarity"})]})}),Eh.length>0&&a.jsx("div",{className:"sticky top-0 z-10 px-3 py-2 bg-panel border-b border-border",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Filters"}),Eh.map(g=>a.jsxs("span",{className:"filter-chip",children:[a.jsx("span",{className:"truncate max-w-[240px]",title:g.label,children:g.label}),a.jsx("button",{className:"filter-chip-remove","aria-label":`Clear filter ${g.label}`,onClick:g.onRemove,children:""})]},g.id)),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:kh,children:"Clear all"})]})}),!1,a.jsxs("div",{className:"flex-1 min-h-0 relative",children:[a.jsx(oC,{items:Be,selected:s,restoreToSelectionToken:j,multiSelectMode:El&&A,onSelectionChange:i,onOpenViewer:g=>{try{Ut.current=g}catch{}w0(g),i([g])},highlight:pn?or:"",recentlyUpdated:mn,onVisiblePathsChange:ar,suppressSelectionHighlight:!!f||p,viewMode:J,targetCellSize:oe,onContextMenuItem:(g,C)=>{g.preventDefault();const L=Hu(C);i(L),nt({x:g.clientX,y:g.clientY,kind:"grid",payload:{paths:L}})},onOpenItemActions:h0,scrollRef:cn,hideScrollbar:gh}),gh&&ro&&a.jsx(uC,{items:Be,metricKey:ro,scrollRef:cn,sortDir:N.sort.dir})]})]}),V&&a.jsx(sk,{path:s[0]??null,selectedPaths:s,items:Be,compareActive:p,compareA:to,compareB:no,sortSpec:N.sort,onResize:z,onStarChanged:(g,C)=>{_e(L=>{const B={...L};for(const H of g)B[H]=C;return B})},onFindSimilar:()=>l(!0),embeddingsAvailable:Lu,embeddingsLoading:Hn.isLoading,onLocalTypingChange:fl}),a.jsx(ik,{open:o,embeddings:pl,rejected:Tu,selectedPath:s[0]??null,embeddingsLoading:Hn.isLoading,embeddingsError:_u,onClose:()=>l(!1),onSearch:a0}),f&&a.jsx(CC,{path:f,onClose:Mh,onZoomChange:g=>k(Math.round(g)),requestedZoomPercent:m,onZoomRequestConsumed:()=>x(null),canPrev:Th,canNext:Lh,onNavigate:Ku}),p&&a.jsx(PC,{aItem:to,bItem:no,index:gn,total:Vt.length,canPrev:ml,canNext:Fu,onNavigate:b0,onClose:Wu}),Ce&&a.jsx($E,{paths:Ce.paths,defaultDestination:e,destinations:mt,loadingDestinations:bt,onClose:()=>Pe(null),onSubmit:m0}),ne&&a.jsx("div",{className:"toolbar-offset fixed inset-0 left-[var(--left)] right-[var(--right)] bg-accent/10 border-2 border-dashed border-accent text-text flex items-center justify-center text-lg z-overlay pointer-events-none",children:"Drop images to upload"}),hn&&a.jsx(JE,{ctx:hn,current:e,items:Be,setCtx:nt,onRefetch:sr,onOpenMoveDialog:g0,onRefreshFolder:Du})]})}const lN=new CS({defaultOptions:{queries:{staleTime:1e4,gcTime:5*6e4,retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),1e4),refetchOnWindowFocus:!1,refetchOnReconnect:"always"},mutations:{retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),5e3)}}});function aN(){return a.jsx(kS,{client:lN,children:a.jsx(oN,{})})}Yy(document.getElementById("root")).render(a.jsx(aN,{}));
