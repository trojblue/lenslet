var P0=Object.defineProperty;var $h=e=>{throw TypeError(e)};var T0=(e,t,n)=>t in e?P0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var rt=(e,t,n)=>T0(e,typeof t!="symbol"?t+"":t,n),tc=(e,t,n)=>t.has(e)||$h("Cannot "+n);var b=(e,t,n)=>(tc(e,t,"read from private field"),n?n.call(e):t.get(e)),pe=(e,t,n)=>t.has(e)?$h("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),re=(e,t,n,r)=>(tc(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),Ce=(e,t,n)=>(tc(e,t,"access private method"),n);var Wl=(e,t,n,r)=>({set _(s){re(e,t,s,n)},get _(){return b(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function L0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ug={exports:{}},vu={},Hg={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vl=Symbol.for("react.element"),_0=Symbol.for("react.portal"),I0=Symbol.for("react.fragment"),F0=Symbol.for("react.strict_mode"),O0=Symbol.for("react.profiler"),A0=Symbol.for("react.provider"),D0=Symbol.for("react.context"),z0=Symbol.for("react.forward_ref"),$0=Symbol.for("react.suspense"),B0=Symbol.for("react.memo"),U0=Symbol.for("react.lazy"),Bh=Symbol.iterator;function H0(e){return e===null||typeof e!="object"?null:(e=Bh&&e[Bh]||e["@@iterator"],typeof e=="function"?e:null)}var Vg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Wg=Object.assign,Qg={};function Ji(e,t,n){this.props=e,this.context=t,this.refs=Qg,this.updater=n||Vg}Ji.prototype.isReactComponent={};Ji.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ji.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Kg(){}Kg.prototype=Ji.prototype;function pf(e,t,n){this.props=e,this.context=t,this.refs=Qg,this.updater=n||Vg}var mf=pf.prototype=new Kg;mf.constructor=pf;Wg(mf,Ji.prototype);mf.isPureReactComponent=!0;var Uh=Array.isArray,Yg=Object.prototype.hasOwnProperty,gf={current:null},Xg={key:!0,ref:!0,__self:!0,__source:!0};function qg(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Yg.call(t,r)&&!Xg.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:vl,type:e,key:i,ref:o,props:s,_owner:gf.current}}function V0(e,t){return{$$typeof:vl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function vf(e){return typeof e=="object"&&e!==null&&e.$$typeof===vl}function W0(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Hh=/\/+/g;function nc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?W0(""+e.key):t.toString(36)}function va(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case vl:case _0:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+nc(o,0):r,Uh(s)?(n="",e!=null&&(n=e.replace(Hh,"$&/")+"/"),va(s,t,n,"",function(d){return d})):s!=null&&(vf(s)&&(s=V0(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Hh,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",Uh(e))for(var l=0;l<e.length;l++){i=e[l];var u=r+nc(i,l);o+=va(i,t,n,u,s)}else if(u=H0(e),typeof u=="function")for(e=u.call(e),l=0;!(i=e.next()).done;)i=i.value,u=r+nc(i,l++),o+=va(i,t,n,u,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Ql(e,t,n){if(e==null)return e;var r=[],s=0;return va(e,r,"","",function(i){return t.call(n,i,s++)}),r}function Q0(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ot={current:null},ya={transition:null},K0={ReactCurrentDispatcher:Ot,ReactCurrentBatchConfig:ya,ReactCurrentOwner:gf};function Gg(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:Ql,forEach:function(e,t,n){Ql(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Ql(e,function(){t++}),t},toArray:function(e){return Ql(e,function(t){return t})||[]},only:function(e){if(!vf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ke.Component=Ji;ke.Fragment=I0;ke.Profiler=O0;ke.PureComponent=pf;ke.StrictMode=F0;ke.Suspense=$0;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K0;ke.act=Gg;ke.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Wg({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=gf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)Yg.call(t,u)&&!Xg.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:vl,type:e.type,key:s,ref:i,props:r,_owner:o}};ke.createContext=function(e){return e={$$typeof:D0,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:A0,_context:e},e.Consumer=e};ke.createElement=qg;ke.createFactory=function(e){var t=qg.bind(null,e);return t.type=e,t};ke.createRef=function(){return{current:null}};ke.forwardRef=function(e){return{$$typeof:z0,render:e}};ke.isValidElement=vf;ke.lazy=function(e){return{$$typeof:U0,_payload:{_status:-1,_result:e},_init:Q0}};ke.memo=function(e,t){return{$$typeof:B0,type:e,compare:t===void 0?null:t}};ke.startTransition=function(e){var t=ya.transition;ya.transition={};try{e()}finally{ya.transition=t}};ke.unstable_act=Gg;ke.useCallback=function(e,t){return Ot.current.useCallback(e,t)};ke.useContext=function(e){return Ot.current.useContext(e)};ke.useDebugValue=function(){};ke.useDeferredValue=function(e){return Ot.current.useDeferredValue(e)};ke.useEffect=function(e,t){return Ot.current.useEffect(e,t)};ke.useId=function(){return Ot.current.useId()};ke.useImperativeHandle=function(e,t,n){return Ot.current.useImperativeHandle(e,t,n)};ke.useInsertionEffect=function(e,t){return Ot.current.useInsertionEffect(e,t)};ke.useLayoutEffect=function(e,t){return Ot.current.useLayoutEffect(e,t)};ke.useMemo=function(e,t){return Ot.current.useMemo(e,t)};ke.useReducer=function(e,t,n){return Ot.current.useReducer(e,t,n)};ke.useRef=function(e){return Ot.current.useRef(e)};ke.useState=function(e){return Ot.current.useState(e)};ke.useSyncExternalStore=function(e,t,n){return Ot.current.useSyncExternalStore(e,t,n)};ke.useTransition=function(){return Ot.current.useTransition()};ke.version="18.3.1";Hg.exports=ke;var c=Hg.exports;const Vh=L0(c);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y0=c,X0=Symbol.for("react.element"),q0=Symbol.for("react.fragment"),G0=Object.prototype.hasOwnProperty,J0=Y0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Z0={key:!0,ref:!0,__self:!0,__source:!0};function Jg(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)G0.call(t,r)&&!Z0.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:X0,type:e,key:i,ref:o,props:s,_owner:J0.current}}vu.Fragment=q0;vu.jsx=Jg;vu.jsxs=Jg;Ug.exports=vu;var a=Ug.exports,Zg={exports:{}},cn={},ev={exports:{}},tv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,D){var H=P.length;P.push(D);e:for(;0<H;){var te=H-1>>>1,se=P[te];if(0<s(se,D))P[te]=D,P[H]=se,H=te;else break e}}function n(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var D=P[0],H=P.pop();if(H!==D){P[0]=H;e:for(var te=0,se=P.length,I=se>>>1;te<I;){var U=2*(te+1)-1,Y=P[U],Z=U+1,q=P[Z];if(0>s(Y,H))Z<se&&0>s(q,Y)?(P[te]=q,P[Z]=H,te=Z):(P[te]=Y,P[U]=H,te=U);else if(Z<se&&0>s(q,H))P[te]=q,P[Z]=H,te=Z;else break e}}return D}function s(P,D){var H=P.sortIndex-D.sortIndex;return H!==0?H:P.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],d=[],f=1,h=null,p=3,S=!1,w=!1,E=!1,j=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(P){for(var D=n(d);D!==null;){if(D.callback===null)r(d);else if(D.startTime<=P)r(d),D.sortIndex=D.expirationTime,t(u,D);else break;D=n(d)}}function y(P){if(E=!1,x(P),!w)if(n(u)!==null)w=!0,A(k);else{var D=n(d);D!==null&&_(y,D.startTime-P)}}function k(P,D){w=!1,E&&(E=!1,v(N),N=-1),S=!0;var H=p;try{for(x(D),h=n(u);h!==null&&(!(h.expirationTime>D)||P&&!X());){var te=h.callback;if(typeof te=="function"){h.callback=null,p=h.priorityLevel;var se=te(h.expirationTime<=D);D=e.unstable_now(),typeof se=="function"?h.callback=se:h===n(u)&&r(u),x(D)}else r(u);h=n(u)}if(h!==null)var I=!0;else{var U=n(d);U!==null&&_(y,U.startTime-D),I=!1}return I}finally{h=null,p=H,S=!1}}var R=!1,M=null,N=-1,O=5,T=-1;function X(){return!(e.unstable_now()-T<O)}function J(){if(M!==null){var P=e.unstable_now();T=P;var D=!0;try{D=M(!0,P)}finally{D?z():(R=!1,M=null)}}else R=!1}var z;if(typeof m=="function")z=function(){m(J)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,K=ae.port2;ae.port1.onmessage=J,z=function(){K.postMessage(null)}}else z=function(){j(J,0)};function A(P){M=P,R||(R=!0,z())}function _(P,D){N=j(function(){P(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){w||S||(w=!0,A(k))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(P){switch(p){case 1:case 2:case 3:var D=3;break;default:D=p}var H=p;p=D;try{return P()}finally{p=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,D){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var H=p;p=P;try{return D()}finally{p=H}},e.unstable_scheduleCallback=function(P,D,H){var te=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?te+H:te):H=te,P){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=H+se,P={id:f++,callback:D,priorityLevel:P,startTime:H,expirationTime:se,sortIndex:-1},H>te?(P.sortIndex=H,t(d,P),n(u)===null&&P===n(d)&&(E?(v(N),N=-1):E=!0,_(y,H-te))):(P.sortIndex=se,t(u,P),w||S||(w=!0,A(k))),P},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(P){var D=p;return function(){var H=p;p=D;try{return P.apply(this,arguments)}finally{p=H}}}})(tv);ev.exports=tv;var ew=ev.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tw=c,un=ew;function Q(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nv=new Set,Wo={};function Qs(e,t){Vi(e,t),Vi(e+"Capture",t)}function Vi(e,t){for(Wo[e]=t,e=0;e<t.length;e++)nv.add(t[e])}var kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vc=Object.prototype.hasOwnProperty,nw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Wh={},Qh={};function rw(e){return Vc.call(Qh,e)?!0:Vc.call(Wh,e)?!1:nw.test(e)?Qh[e]=!0:(Wh[e]=!0,!1)}function sw(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function iw(e,t,n,r){if(t===null||typeof t>"u"||sw(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function At(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){yt[e]=new At(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];yt[t]=new At(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){yt[e]=new At(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){yt[e]=new At(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){yt[e]=new At(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){yt[e]=new At(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){yt[e]=new At(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){yt[e]=new At(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){yt[e]=new At(e,5,!1,e.toLowerCase(),null,!1,!1)});var yf=/[\-:]([a-z])/g;function xf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(yf,xf);yt[t]=new At(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(yf,xf);yt[t]=new At(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(yf,xf);yt[t]=new At(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){yt[e]=new At(e,1,!1,e.toLowerCase(),null,!1,!1)});yt.xlinkHref=new At("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){yt[e]=new At(e,1,!1,e.toLowerCase(),null,!0,!0)});function wf(e,t,n,r){var s=yt.hasOwnProperty(t)?yt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(iw(t,n,s,r)&&(n=null),r||s===null?rw(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Mr=tw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Kl=Symbol.for("react.element"),ci=Symbol.for("react.portal"),di=Symbol.for("react.fragment"),Sf=Symbol.for("react.strict_mode"),Wc=Symbol.for("react.profiler"),rv=Symbol.for("react.provider"),sv=Symbol.for("react.context"),bf=Symbol.for("react.forward_ref"),Qc=Symbol.for("react.suspense"),Kc=Symbol.for("react.suspense_list"),Cf=Symbol.for("react.memo"),Dr=Symbol.for("react.lazy"),iv=Symbol.for("react.offscreen"),Kh=Symbol.iterator;function fo(e){return e===null||typeof e!="object"?null:(e=Kh&&e[Kh]||e["@@iterator"],typeof e=="function"?e:null)}var Qe=Object.assign,rc;function jo(e){if(rc===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);rc=t&&t[1]||""}return`
`+rc+e}var sc=!1;function ic(e,t){if(!e||sc)return"";sc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=l);break}}}finally{sc=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?jo(e):""}function ow(e){switch(e.tag){case 5:return jo(e.type);case 16:return jo("Lazy");case 13:return jo("Suspense");case 19:return jo("SuspenseList");case 0:case 2:case 15:return e=ic(e.type,!1),e;case 11:return e=ic(e.type.render,!1),e;case 1:return e=ic(e.type,!0),e;default:return""}}function Yc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case di:return"Fragment";case ci:return"Portal";case Wc:return"Profiler";case Sf:return"StrictMode";case Qc:return"Suspense";case Kc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case sv:return(e.displayName||"Context")+".Consumer";case rv:return(e._context.displayName||"Context")+".Provider";case bf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Cf:return t=e.displayName||null,t!==null?t:Yc(e.type)||"Memo";case Dr:t=e._payload,e=e._init;try{return Yc(e(t))}catch{}}return null}function lw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Yc(t);case 8:return t===Sf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function us(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ov(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function aw(e){var t=ov(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Yl(e){e._valueTracker||(e._valueTracker=aw(e))}function lv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ov(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Aa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Xc(e,t){var n=t.checked;return Qe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Yh(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=us(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function av(e,t){t=t.checked,t!=null&&wf(e,"checked",t,!1)}function qc(e,t){av(e,t);var n=us(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Gc(e,t.type,n):t.hasOwnProperty("defaultValue")&&Gc(e,t.type,us(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Xh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Gc(e,t,n){(t!=="number"||Aa(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Mo=Array.isArray;function bi(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+us(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Jc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Q(91));return Qe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function qh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Q(92));if(Mo(n)){if(1<n.length)throw Error(Q(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:us(n)}}function uv(e,t){var n=us(t.value),r=us(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Gh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function cv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?cv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Xl,dv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Xl=Xl||document.createElement("div"),Xl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Xl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Qo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var _o={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uw=["Webkit","ms","Moz","O"];Object.keys(_o).forEach(function(e){uw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_o[t]=_o[e]})});function fv(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||_o.hasOwnProperty(e)&&_o[e]?(""+t).trim():t+"px"}function hv(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=fv(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var cw=Qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ed(e,t){if(t){if(cw[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Q(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Q(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Q(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Q(62))}}function td(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nd=null;function kf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var rd=null,Ci=null,ki=null;function Jh(e){if(e=wl(e)){if(typeof rd!="function")throw Error(Q(280));var t=e.stateNode;t&&(t=bu(t),rd(e.stateNode,e.type,t))}}function pv(e){Ci?ki?ki.push(e):ki=[e]:Ci=e}function mv(){if(Ci){var e=Ci,t=ki;if(ki=Ci=null,Jh(e),t)for(e=0;e<t.length;e++)Jh(t[e])}}function gv(e,t){return e(t)}function vv(){}var oc=!1;function yv(e,t,n){if(oc)return e(t,n);oc=!0;try{return gv(e,t,n)}finally{oc=!1,(Ci!==null||ki!==null)&&(vv(),mv())}}function Ko(e,t){var n=e.stateNode;if(n===null)return null;var r=bu(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Q(231,t,typeof n));return n}var sd=!1;if(kr)try{var ho={};Object.defineProperty(ho,"passive",{get:function(){sd=!0}}),window.addEventListener("test",ho,ho),window.removeEventListener("test",ho,ho)}catch{sd=!1}function dw(e,t,n,r,s,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(f){this.onError(f)}}var Io=!1,Da=null,za=!1,id=null,fw={onError:function(e){Io=!0,Da=e}};function hw(e,t,n,r,s,i,o,l,u){Io=!1,Da=null,dw.apply(fw,arguments)}function pw(e,t,n,r,s,i,o,l,u){if(hw.apply(this,arguments),Io){if(Io){var d=Da;Io=!1,Da=null}else throw Error(Q(198));za||(za=!0,id=d)}}function Ks(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function xv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Zh(e){if(Ks(e)!==e)throw Error(Q(188))}function mw(e){var t=e.alternate;if(!t){if(t=Ks(e),t===null)throw Error(Q(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Zh(s),e;if(i===r)return Zh(s),t;i=i.sibling}throw Error(Q(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(Q(189))}}if(n.alternate!==r)throw Error(Q(190))}if(n.tag!==3)throw Error(Q(188));return n.stateNode.current===n?e:t}function wv(e){return e=mw(e),e!==null?Sv(e):null}function Sv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Sv(e);if(t!==null)return t;e=e.sibling}return null}var bv=un.unstable_scheduleCallback,ep=un.unstable_cancelCallback,gw=un.unstable_shouldYield,vw=un.unstable_requestPaint,Ge=un.unstable_now,yw=un.unstable_getCurrentPriorityLevel,Ef=un.unstable_ImmediatePriority,Cv=un.unstable_UserBlockingPriority,$a=un.unstable_NormalPriority,xw=un.unstable_LowPriority,kv=un.unstable_IdlePriority,yu=null,ir=null;function ww(e){if(ir&&typeof ir.onCommitFiberRoot=="function")try{ir.onCommitFiberRoot(yu,e,void 0,(e.current.flags&128)===128)}catch{}}var zn=Math.clz32?Math.clz32:Cw,Sw=Math.log,bw=Math.LN2;function Cw(e){return e>>>=0,e===0?32:31-(Sw(e)/bw|0)|0}var ql=64,Gl=4194304;function Ro(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ba(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Ro(l):(i&=o,i!==0&&(r=Ro(i)))}else o=n&~s,o!==0?r=Ro(o):i!==0&&(r=Ro(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-zn(t),s=1<<n,r|=e[n],t&=~s;return r}function kw(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ew(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-zn(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=kw(l,t)):u<=t&&(e.expiredLanes|=l),i&=~l}}function od(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ev(){var e=ql;return ql<<=1,!(ql&4194240)&&(ql=64),e}function lc(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-zn(t),e[t]=n}function Nw(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-zn(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Nf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-zn(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Fe=0;function Nv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var jv,jf,Mv,Rv,Pv,ld=!1,Jl=[],Zr=null,es=null,ts=null,Yo=new Map,Xo=new Map,$r=[],jw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tp(e,t){switch(e){case"focusin":case"focusout":Zr=null;break;case"dragenter":case"dragleave":es=null;break;case"mouseover":case"mouseout":ts=null;break;case"pointerover":case"pointerout":Yo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xo.delete(t.pointerId)}}function po(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=wl(t),t!==null&&jf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Mw(e,t,n,r,s){switch(t){case"focusin":return Zr=po(Zr,e,t,n,r,s),!0;case"dragenter":return es=po(es,e,t,n,r,s),!0;case"mouseover":return ts=po(ts,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return Yo.set(i,po(Yo.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Xo.set(i,po(Xo.get(i)||null,e,t,n,r,s)),!0}return!1}function Tv(e){var t=Ss(e.target);if(t!==null){var n=Ks(t);if(n!==null){if(t=n.tag,t===13){if(t=xv(n),t!==null){e.blockedOn=t,Pv(e.priority,function(){Mv(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function xa(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=ad(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);nd=r,n.target.dispatchEvent(r),nd=null}else return t=wl(n),t!==null&&jf(t),e.blockedOn=n,!1;t.shift()}return!0}function np(e,t,n){xa(e)&&n.delete(t)}function Rw(){ld=!1,Zr!==null&&xa(Zr)&&(Zr=null),es!==null&&xa(es)&&(es=null),ts!==null&&xa(ts)&&(ts=null),Yo.forEach(np),Xo.forEach(np)}function mo(e,t){e.blockedOn===t&&(e.blockedOn=null,ld||(ld=!0,un.unstable_scheduleCallback(un.unstable_NormalPriority,Rw)))}function qo(e){function t(s){return mo(s,e)}if(0<Jl.length){mo(Jl[0],e);for(var n=1;n<Jl.length;n++){var r=Jl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Zr!==null&&mo(Zr,e),es!==null&&mo(es,e),ts!==null&&mo(ts,e),Yo.forEach(t),Xo.forEach(t),n=0;n<$r.length;n++)r=$r[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<$r.length&&(n=$r[0],n.blockedOn===null);)Tv(n),n.blockedOn===null&&$r.shift()}var Ei=Mr.ReactCurrentBatchConfig,Ua=!0;function Pw(e,t,n,r){var s=Fe,i=Ei.transition;Ei.transition=null;try{Fe=1,Mf(e,t,n,r)}finally{Fe=s,Ei.transition=i}}function Tw(e,t,n,r){var s=Fe,i=Ei.transition;Ei.transition=null;try{Fe=4,Mf(e,t,n,r)}finally{Fe=s,Ei.transition=i}}function Mf(e,t,n,r){if(Ua){var s=ad(e,t,n,r);if(s===null)vc(e,t,r,Ha,n),tp(e,r);else if(Mw(s,e,t,n,r))r.stopPropagation();else if(tp(e,r),t&4&&-1<jw.indexOf(e)){for(;s!==null;){var i=wl(s);if(i!==null&&jv(i),i=ad(e,t,n,r),i===null&&vc(e,t,r,Ha,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else vc(e,t,r,null,n)}}var Ha=null;function ad(e,t,n,r){if(Ha=null,e=kf(r),e=Ss(e),e!==null)if(t=Ks(e),t===null)e=null;else if(n=t.tag,n===13){if(e=xv(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ha=e,null}function Lv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yw()){case Ef:return 1;case Cv:return 4;case $a:case xw:return 16;case kv:return 536870912;default:return 16}default:return 16}}var Gr=null,Rf=null,wa=null;function _v(){if(wa)return wa;var e,t=Rf,n=t.length,r,s="value"in Gr?Gr.value:Gr.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return wa=s.slice(e,1<r?1-r:void 0)}function Sa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Zl(){return!0}function rp(){return!1}function dn(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Zl:rp,this.isPropagationStopped=rp,this}return Qe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Zl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Zl)},persist:function(){},isPersistent:Zl}),t}var Zi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pf=dn(Zi),xl=Qe({},Zi,{view:0,detail:0}),Lw=dn(xl),ac,uc,go,xu=Qe({},xl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==go&&(go&&e.type==="mousemove"?(ac=e.screenX-go.screenX,uc=e.screenY-go.screenY):uc=ac=0,go=e),ac)},movementY:function(e){return"movementY"in e?e.movementY:uc}}),sp=dn(xu),_w=Qe({},xu,{dataTransfer:0}),Iw=dn(_w),Fw=Qe({},xl,{relatedTarget:0}),cc=dn(Fw),Ow=Qe({},Zi,{animationName:0,elapsedTime:0,pseudoElement:0}),Aw=dn(Ow),Dw=Qe({},Zi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),zw=dn(Dw),$w=Qe({},Zi,{data:0}),ip=dn($w),Bw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Uw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vw(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Hw[e])?!!t[e]:!1}function Tf(){return Vw}var Ww=Qe({},xl,{key:function(e){if(e.key){var t=Bw[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Sa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Uw[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tf,charCode:function(e){return e.type==="keypress"?Sa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Sa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Qw=dn(Ww),Kw=Qe({},xu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),op=dn(Kw),Yw=Qe({},xl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tf}),Xw=dn(Yw),qw=Qe({},Zi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gw=dn(qw),Jw=Qe({},xu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zw=dn(Jw),e1=[9,13,27,32],Lf=kr&&"CompositionEvent"in window,Fo=null;kr&&"documentMode"in document&&(Fo=document.documentMode);var t1=kr&&"TextEvent"in window&&!Fo,Iv=kr&&(!Lf||Fo&&8<Fo&&11>=Fo),lp=" ",ap=!1;function Fv(e,t){switch(e){case"keyup":return e1.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ov(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var fi=!1;function n1(e,t){switch(e){case"compositionend":return Ov(t);case"keypress":return t.which!==32?null:(ap=!0,lp);case"textInput":return e=t.data,e===lp&&ap?null:e;default:return null}}function r1(e,t){if(fi)return e==="compositionend"||!Lf&&Fv(e,t)?(e=_v(),wa=Rf=Gr=null,fi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Iv&&t.locale!=="ko"?null:t.data;default:return null}}var s1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function up(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!s1[e.type]:t==="textarea"}function Av(e,t,n,r){pv(r),t=Va(t,"onChange"),0<t.length&&(n=new Pf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Oo=null,Go=null;function i1(e){Yv(e,0)}function wu(e){var t=mi(e);if(lv(t))return e}function o1(e,t){if(e==="change")return t}var Dv=!1;if(kr){var dc;if(kr){var fc="oninput"in document;if(!fc){var cp=document.createElement("div");cp.setAttribute("oninput","return;"),fc=typeof cp.oninput=="function"}dc=fc}else dc=!1;Dv=dc&&(!document.documentMode||9<document.documentMode)}function dp(){Oo&&(Oo.detachEvent("onpropertychange",zv),Go=Oo=null)}function zv(e){if(e.propertyName==="value"&&wu(Go)){var t=[];Av(t,Go,e,kf(e)),yv(i1,t)}}function l1(e,t,n){e==="focusin"?(dp(),Oo=t,Go=n,Oo.attachEvent("onpropertychange",zv)):e==="focusout"&&dp()}function a1(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return wu(Go)}function u1(e,t){if(e==="click")return wu(t)}function c1(e,t){if(e==="input"||e==="change")return wu(t)}function d1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Bn=typeof Object.is=="function"?Object.is:d1;function Jo(e,t){if(Bn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Vc.call(t,s)||!Bn(e[s],t[s]))return!1}return!0}function fp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hp(e,t){var n=fp(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=fp(n)}}function $v(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?$v(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Bv(){for(var e=window,t=Aa();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Aa(e.document)}return t}function _f(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function f1(e){var t=Bv(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&$v(n.ownerDocument.documentElement,n)){if(r!==null&&_f(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=hp(n,i);var o=hp(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var h1=kr&&"documentMode"in document&&11>=document.documentMode,hi=null,ud=null,Ao=null,cd=!1;function pp(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;cd||hi==null||hi!==Aa(r)||(r=hi,"selectionStart"in r&&_f(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ao&&Jo(Ao,r)||(Ao=r,r=Va(ud,"onSelect"),0<r.length&&(t=new Pf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=hi)))}function ea(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var pi={animationend:ea("Animation","AnimationEnd"),animationiteration:ea("Animation","AnimationIteration"),animationstart:ea("Animation","AnimationStart"),transitionend:ea("Transition","TransitionEnd")},hc={},Uv={};kr&&(Uv=document.createElement("div").style,"AnimationEvent"in window||(delete pi.animationend.animation,delete pi.animationiteration.animation,delete pi.animationstart.animation),"TransitionEvent"in window||delete pi.transitionend.transition);function Su(e){if(hc[e])return hc[e];if(!pi[e])return e;var t=pi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Uv)return hc[e]=t[n];return e}var Hv=Su("animationend"),Vv=Su("animationiteration"),Wv=Su("animationstart"),Qv=Su("transitionend"),Kv=new Map,mp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ds(e,t){Kv.set(e,t),Qs(t,[e])}for(var pc=0;pc<mp.length;pc++){var mc=mp[pc],p1=mc.toLowerCase(),m1=mc[0].toUpperCase()+mc.slice(1);ds(p1,"on"+m1)}ds(Hv,"onAnimationEnd");ds(Vv,"onAnimationIteration");ds(Wv,"onAnimationStart");ds("dblclick","onDoubleClick");ds("focusin","onFocus");ds("focusout","onBlur");ds(Qv,"onTransitionEnd");Vi("onMouseEnter",["mouseout","mouseover"]);Vi("onMouseLeave",["mouseout","mouseover"]);Vi("onPointerEnter",["pointerout","pointerover"]);Vi("onPointerLeave",["pointerout","pointerover"]);Qs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Po="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),g1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Po));function gp(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,pw(r,t,void 0,e),e.currentTarget=null}function Yv(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;gp(s,l,d),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;gp(s,l,d),i=u}}}if(za)throw e=id,za=!1,id=null,e}function ze(e,t){var n=t[md];n===void 0&&(n=t[md]=new Set);var r=e+"__bubble";n.has(r)||(Xv(t,e,2,!1),n.add(r))}function gc(e,t,n){var r=0;t&&(r|=4),Xv(n,e,r,t)}var ta="_reactListening"+Math.random().toString(36).slice(2);function Zo(e){if(!e[ta]){e[ta]=!0,nv.forEach(function(n){n!=="selectionchange"&&(g1.has(n)||gc(n,!1,e),gc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ta]||(t[ta]=!0,gc("selectionchange",!1,t))}}function Xv(e,t,n,r){switch(Lv(t)){case 1:var s=Pw;break;case 4:s=Tw;break;default:s=Mf}n=s.bind(null,t,n,e),s=void 0,!sd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function vc(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Ss(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}yv(function(){var d=i,f=kf(n),h=[];e:{var p=Kv.get(e);if(p!==void 0){var S=Pf,w=e;switch(e){case"keypress":if(Sa(n)===0)break e;case"keydown":case"keyup":S=Qw;break;case"focusin":w="focus",S=cc;break;case"focusout":w="blur",S=cc;break;case"beforeblur":case"afterblur":S=cc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=sp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=Iw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=Xw;break;case Hv:case Vv:case Wv:S=Aw;break;case Qv:S=Gw;break;case"scroll":S=Lw;break;case"wheel":S=Zw;break;case"copy":case"cut":case"paste":S=zw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=op}var E=(t&4)!==0,j=!E&&e==="scroll",v=E?p!==null?p+"Capture":null:p;E=[];for(var m=d,x;m!==null;){x=m;var y=x.stateNode;if(x.tag===5&&y!==null&&(x=y,v!==null&&(y=Ko(m,v),y!=null&&E.push(el(m,y,x)))),j)break;m=m.return}0<E.length&&(p=new S(p,w,null,n,f),h.push({event:p,listeners:E}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",S=e==="mouseout"||e==="pointerout",p&&n!==nd&&(w=n.relatedTarget||n.fromElement)&&(Ss(w)||w[Er]))break e;if((S||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,S?(w=n.relatedTarget||n.toElement,S=d,w=w?Ss(w):null,w!==null&&(j=Ks(w),w!==j||w.tag!==5&&w.tag!==6)&&(w=null)):(S=null,w=d),S!==w)){if(E=sp,y="onMouseLeave",v="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(E=op,y="onPointerLeave",v="onPointerEnter",m="pointer"),j=S==null?p:mi(S),x=w==null?p:mi(w),p=new E(y,m+"leave",S,n,f),p.target=j,p.relatedTarget=x,y=null,Ss(f)===d&&(E=new E(v,m+"enter",w,n,f),E.target=x,E.relatedTarget=j,y=E),j=y,S&&w)t:{for(E=S,v=w,m=0,x=E;x;x=oi(x))m++;for(x=0,y=v;y;y=oi(y))x++;for(;0<m-x;)E=oi(E),m--;for(;0<x-m;)v=oi(v),x--;for(;m--;){if(E===v||v!==null&&E===v.alternate)break t;E=oi(E),v=oi(v)}E=null}else E=null;S!==null&&vp(h,p,S,E,!1),w!==null&&j!==null&&vp(h,j,w,E,!0)}}e:{if(p=d?mi(d):window,S=p.nodeName&&p.nodeName.toLowerCase(),S==="select"||S==="input"&&p.type==="file")var k=o1;else if(up(p))if(Dv)k=c1;else{k=a1;var R=l1}else(S=p.nodeName)&&S.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(k=u1);if(k&&(k=k(e,d))){Av(h,k,n,f);break e}R&&R(e,p,d),e==="focusout"&&(R=p._wrapperState)&&R.controlled&&p.type==="number"&&Gc(p,"number",p.value)}switch(R=d?mi(d):window,e){case"focusin":(up(R)||R.contentEditable==="true")&&(hi=R,ud=d,Ao=null);break;case"focusout":Ao=ud=hi=null;break;case"mousedown":cd=!0;break;case"contextmenu":case"mouseup":case"dragend":cd=!1,pp(h,n,f);break;case"selectionchange":if(h1)break;case"keydown":case"keyup":pp(h,n,f)}var M;if(Lf)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else fi?Fv(e,n)&&(N="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(Iv&&n.locale!=="ko"&&(fi||N!=="onCompositionStart"?N==="onCompositionEnd"&&fi&&(M=_v()):(Gr=f,Rf="value"in Gr?Gr.value:Gr.textContent,fi=!0)),R=Va(d,N),0<R.length&&(N=new ip(N,e,null,n,f),h.push({event:N,listeners:R}),M?N.data=M:(M=Ov(n),M!==null&&(N.data=M)))),(M=t1?n1(e,n):r1(e,n))&&(d=Va(d,"onBeforeInput"),0<d.length&&(f=new ip("onBeforeInput","beforeinput",null,n,f),h.push({event:f,listeners:d}),f.data=M))}Yv(h,t)})}function el(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Va(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Ko(e,n),i!=null&&r.unshift(el(e,i,s)),i=Ko(e,t),i!=null&&r.push(el(e,i,s))),e=e.return}return r}function oi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function vp(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,s?(u=Ko(n,i),u!=null&&o.unshift(el(n,u,l))):s||(u=Ko(n,i),u!=null&&o.push(el(n,u,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var v1=/\r\n?/g,y1=/\u0000|\uFFFD/g;function yp(e){return(typeof e=="string"?e:""+e).replace(v1,`
`).replace(y1,"")}function na(e,t,n){if(t=yp(t),yp(e)!==t&&n)throw Error(Q(425))}function Wa(){}var dd=null,fd=null;function hd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var pd=typeof setTimeout=="function"?setTimeout:void 0,x1=typeof clearTimeout=="function"?clearTimeout:void 0,xp=typeof Promise=="function"?Promise:void 0,w1=typeof queueMicrotask=="function"?queueMicrotask:typeof xp<"u"?function(e){return xp.resolve(null).then(e).catch(S1)}:pd;function S1(e){setTimeout(function(){throw e})}function yc(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),qo(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);qo(t)}function ns(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function wp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var eo=Math.random().toString(36).slice(2),sr="__reactFiber$"+eo,tl="__reactProps$"+eo,Er="__reactContainer$"+eo,md="__reactEvents$"+eo,b1="__reactListeners$"+eo,C1="__reactHandles$"+eo;function Ss(e){var t=e[sr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Er]||n[sr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=wp(e);e!==null;){if(n=e[sr])return n;e=wp(e)}return t}e=n,n=e.parentNode}return null}function wl(e){return e=e[sr]||e[Er],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function mi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Q(33))}function bu(e){return e[tl]||null}var gd=[],gi=-1;function fs(e){return{current:e}}function $e(e){0>gi||(e.current=gd[gi],gd[gi]=null,gi--)}function Ae(e,t){gi++,gd[gi]=e.current,e.current=t}var cs={},Mt=fs(cs),Kt=fs(!1),zs=cs;function Wi(e,t){var n=e.type.contextTypes;if(!n)return cs;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Yt(e){return e=e.childContextTypes,e!=null}function Qa(){$e(Kt),$e(Mt)}function Sp(e,t,n){if(Mt.current!==cs)throw Error(Q(168));Ae(Mt,t),Ae(Kt,n)}function qv(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(Q(108,lw(e)||"Unknown",s));return Qe({},n,r)}function Ka(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||cs,zs=Mt.current,Ae(Mt,e),Ae(Kt,Kt.current),!0}function bp(e,t,n){var r=e.stateNode;if(!r)throw Error(Q(169));n?(e=qv(e,t,zs),r.__reactInternalMemoizedMergedChildContext=e,$e(Kt),$e(Mt),Ae(Mt,e)):$e(Kt),Ae(Kt,n)}var pr=null,Cu=!1,xc=!1;function Gv(e){pr===null?pr=[e]:pr.push(e)}function k1(e){Cu=!0,Gv(e)}function hs(){if(!xc&&pr!==null){xc=!0;var e=0,t=Fe;try{var n=pr;for(Fe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}pr=null,Cu=!1}catch(s){throw pr!==null&&(pr=pr.slice(e+1)),bv(Ef,hs),s}finally{Fe=t,xc=!1}}return null}var vi=[],yi=0,Ya=null,Xa=0,Cn=[],kn=0,$s=null,xr=1,wr="";function xs(e,t){vi[yi++]=Xa,vi[yi++]=Ya,Ya=e,Xa=t}function Jv(e,t,n){Cn[kn++]=xr,Cn[kn++]=wr,Cn[kn++]=$s,$s=e;var r=xr;e=wr;var s=32-zn(r)-1;r&=~(1<<s),n+=1;var i=32-zn(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,xr=1<<32-zn(t)+s|n<<s|r,wr=i+e}else xr=1<<i|n<<s|r,wr=e}function If(e){e.return!==null&&(xs(e,1),Jv(e,1,0))}function Ff(e){for(;e===Ya;)Ya=vi[--yi],vi[yi]=null,Xa=vi[--yi],vi[yi]=null;for(;e===$s;)$s=Cn[--kn],Cn[kn]=null,wr=Cn[--kn],Cn[kn]=null,xr=Cn[--kn],Cn[kn]=null}var ln=null,on=null,Ue=!1,Dn=null;function Zv(e,t){var n=Nn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Cp(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,ln=e,on=ns(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,ln=e,on=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=$s!==null?{id:xr,overflow:wr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Nn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,ln=e,on=null,!0):!1;default:return!1}}function vd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function yd(e){if(Ue){var t=on;if(t){var n=t;if(!Cp(e,t)){if(vd(e))throw Error(Q(418));t=ns(n.nextSibling);var r=ln;t&&Cp(e,t)?Zv(r,n):(e.flags=e.flags&-4097|2,Ue=!1,ln=e)}}else{if(vd(e))throw Error(Q(418));e.flags=e.flags&-4097|2,Ue=!1,ln=e}}}function kp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ln=e}function ra(e){if(e!==ln)return!1;if(!Ue)return kp(e),Ue=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!hd(e.type,e.memoizedProps)),t&&(t=on)){if(vd(e))throw ey(),Error(Q(418));for(;t;)Zv(e,t),t=ns(t.nextSibling)}if(kp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Q(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){on=ns(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}on=null}}else on=ln?ns(e.stateNode.nextSibling):null;return!0}function ey(){for(var e=on;e;)e=ns(e.nextSibling)}function Qi(){on=ln=null,Ue=!1}function Of(e){Dn===null?Dn=[e]:Dn.push(e)}var E1=Mr.ReactCurrentBatchConfig;function vo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Q(309));var r=n.stateNode}if(!r)throw Error(Q(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Q(284));if(!n._owner)throw Error(Q(290,e))}return e}function sa(e,t){throw e=Object.prototype.toString.call(t),Error(Q(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ep(e){var t=e._init;return t(e._payload)}function ty(e){function t(v,m){if(e){var x=v.deletions;x===null?(v.deletions=[m],v.flags|=16):x.push(m)}}function n(v,m){if(!e)return null;for(;m!==null;)t(v,m),m=m.sibling;return null}function r(v,m){for(v=new Map;m!==null;)m.key!==null?v.set(m.key,m):v.set(m.index,m),m=m.sibling;return v}function s(v,m){return v=os(v,m),v.index=0,v.sibling=null,v}function i(v,m,x){return v.index=x,e?(x=v.alternate,x!==null?(x=x.index,x<m?(v.flags|=2,m):x):(v.flags|=2,m)):(v.flags|=1048576,m)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,m,x,y){return m===null||m.tag!==6?(m=Nc(x,v.mode,y),m.return=v,m):(m=s(m,x),m.return=v,m)}function u(v,m,x,y){var k=x.type;return k===di?f(v,m,x.props.children,y,x.key):m!==null&&(m.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Dr&&Ep(k)===m.type)?(y=s(m,x.props),y.ref=vo(v,m,x),y.return=v,y):(y=Ma(x.type,x.key,x.props,null,v.mode,y),y.ref=vo(v,m,x),y.return=v,y)}function d(v,m,x,y){return m===null||m.tag!==4||m.stateNode.containerInfo!==x.containerInfo||m.stateNode.implementation!==x.implementation?(m=jc(x,v.mode,y),m.return=v,m):(m=s(m,x.children||[]),m.return=v,m)}function f(v,m,x,y,k){return m===null||m.tag!==7?(m=Ds(x,v.mode,y,k),m.return=v,m):(m=s(m,x),m.return=v,m)}function h(v,m,x){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Nc(""+m,v.mode,x),m.return=v,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Kl:return x=Ma(m.type,m.key,m.props,null,v.mode,x),x.ref=vo(v,null,m),x.return=v,x;case ci:return m=jc(m,v.mode,x),m.return=v,m;case Dr:var y=m._init;return h(v,y(m._payload),x)}if(Mo(m)||fo(m))return m=Ds(m,v.mode,x,null),m.return=v,m;sa(v,m)}return null}function p(v,m,x,y){var k=m!==null?m.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return k!==null?null:l(v,m,""+x,y);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Kl:return x.key===k?u(v,m,x,y):null;case ci:return x.key===k?d(v,m,x,y):null;case Dr:return k=x._init,p(v,m,k(x._payload),y)}if(Mo(x)||fo(x))return k!==null?null:f(v,m,x,y,null);sa(v,x)}return null}function S(v,m,x,y,k){if(typeof y=="string"&&y!==""||typeof y=="number")return v=v.get(x)||null,l(m,v,""+y,k);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Kl:return v=v.get(y.key===null?x:y.key)||null,u(m,v,y,k);case ci:return v=v.get(y.key===null?x:y.key)||null,d(m,v,y,k);case Dr:var R=y._init;return S(v,m,x,R(y._payload),k)}if(Mo(y)||fo(y))return v=v.get(x)||null,f(m,v,y,k,null);sa(m,y)}return null}function w(v,m,x,y){for(var k=null,R=null,M=m,N=m=0,O=null;M!==null&&N<x.length;N++){M.index>N?(O=M,M=null):O=M.sibling;var T=p(v,M,x[N],y);if(T===null){M===null&&(M=O);break}e&&M&&T.alternate===null&&t(v,M),m=i(T,m,N),R===null?k=T:R.sibling=T,R=T,M=O}if(N===x.length)return n(v,M),Ue&&xs(v,N),k;if(M===null){for(;N<x.length;N++)M=h(v,x[N],y),M!==null&&(m=i(M,m,N),R===null?k=M:R.sibling=M,R=M);return Ue&&xs(v,N),k}for(M=r(v,M);N<x.length;N++)O=S(M,v,N,x[N],y),O!==null&&(e&&O.alternate!==null&&M.delete(O.key===null?N:O.key),m=i(O,m,N),R===null?k=O:R.sibling=O,R=O);return e&&M.forEach(function(X){return t(v,X)}),Ue&&xs(v,N),k}function E(v,m,x,y){var k=fo(x);if(typeof k!="function")throw Error(Q(150));if(x=k.call(x),x==null)throw Error(Q(151));for(var R=k=null,M=m,N=m=0,O=null,T=x.next();M!==null&&!T.done;N++,T=x.next()){M.index>N?(O=M,M=null):O=M.sibling;var X=p(v,M,T.value,y);if(X===null){M===null&&(M=O);break}e&&M&&X.alternate===null&&t(v,M),m=i(X,m,N),R===null?k=X:R.sibling=X,R=X,M=O}if(T.done)return n(v,M),Ue&&xs(v,N),k;if(M===null){for(;!T.done;N++,T=x.next())T=h(v,T.value,y),T!==null&&(m=i(T,m,N),R===null?k=T:R.sibling=T,R=T);return Ue&&xs(v,N),k}for(M=r(v,M);!T.done;N++,T=x.next())T=S(M,v,N,T.value,y),T!==null&&(e&&T.alternate!==null&&M.delete(T.key===null?N:T.key),m=i(T,m,N),R===null?k=T:R.sibling=T,R=T);return e&&M.forEach(function(J){return t(v,J)}),Ue&&xs(v,N),k}function j(v,m,x,y){if(typeof x=="object"&&x!==null&&x.type===di&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Kl:e:{for(var k=x.key,R=m;R!==null;){if(R.key===k){if(k=x.type,k===di){if(R.tag===7){n(v,R.sibling),m=s(R,x.props.children),m.return=v,v=m;break e}}else if(R.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Dr&&Ep(k)===R.type){n(v,R.sibling),m=s(R,x.props),m.ref=vo(v,R,x),m.return=v,v=m;break e}n(v,R);break}else t(v,R);R=R.sibling}x.type===di?(m=Ds(x.props.children,v.mode,y,x.key),m.return=v,v=m):(y=Ma(x.type,x.key,x.props,null,v.mode,y),y.ref=vo(v,m,x),y.return=v,v=y)}return o(v);case ci:e:{for(R=x.key;m!==null;){if(m.key===R)if(m.tag===4&&m.stateNode.containerInfo===x.containerInfo&&m.stateNode.implementation===x.implementation){n(v,m.sibling),m=s(m,x.children||[]),m.return=v,v=m;break e}else{n(v,m);break}else t(v,m);m=m.sibling}m=jc(x,v.mode,y),m.return=v,v=m}return o(v);case Dr:return R=x._init,j(v,m,R(x._payload),y)}if(Mo(x))return w(v,m,x,y);if(fo(x))return E(v,m,x,y);sa(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,m!==null&&m.tag===6?(n(v,m.sibling),m=s(m,x),m.return=v,v=m):(n(v,m),m=Nc(x,v.mode,y),m.return=v,v=m),o(v)):n(v,m)}return j}var Ki=ty(!0),ny=ty(!1),qa=fs(null),Ga=null,xi=null,Af=null;function Df(){Af=xi=Ga=null}function zf(e){var t=qa.current;$e(qa),e._currentValue=t}function xd(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ni(e,t){Ga=e,Af=xi=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Qt=!0),e.firstContext=null)}function Mn(e){var t=e._currentValue;if(Af!==e)if(e={context:e,memoizedValue:t,next:null},xi===null){if(Ga===null)throw Error(Q(308));xi=e,Ga.dependencies={lanes:0,firstContext:e}}else xi=xi.next=e;return t}var bs=null;function $f(e){bs===null?bs=[e]:bs.push(e)}function ry(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,$f(t)):(n.next=s.next,s.next=n),t.interleaved=n,Nr(e,r)}function Nr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var zr=!1;function Bf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sy(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Sr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function rs(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Te&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Nr(e,n)}return s=r.interleaved,s===null?(t.next=t,$f(r)):(t.next=s.next,s.next=t),r.interleaved=t,Nr(e,n)}function ba(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Nf(e,n)}}function Np(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ja(e,t,n,r){var s=e.updateQueue;zr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=u))}if(i!==null){var h=s.baseState;o=0,f=d=u=null,l=i;do{var p=l.lane,S=l.eventTime;if((r&p)===p){f!==null&&(f=f.next={eventTime:S,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var w=e,E=l;switch(p=t,S=n,E.tag){case 1:if(w=E.payload,typeof w=="function"){h=w.call(S,h,p);break e}h=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=E.payload,p=typeof w=="function"?w.call(S,h,p):w,p==null)break e;h=Qe({},h,p);break e;case 2:zr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else S={eventTime:S,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=S,u=h):f=f.next=S,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(f===null&&(u=h),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Us|=o,e.lanes=o,e.memoizedState=h}}function jp(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Q(191,s));s.call(r)}}}var Sl={},or=fs(Sl),nl=fs(Sl),rl=fs(Sl);function Cs(e){if(e===Sl)throw Error(Q(174));return e}function Uf(e,t){switch(Ae(rl,t),Ae(nl,e),Ae(or,Sl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Zc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Zc(t,e)}$e(or),Ae(or,t)}function Yi(){$e(or),$e(nl),$e(rl)}function iy(e){Cs(rl.current);var t=Cs(or.current),n=Zc(t,e.type);t!==n&&(Ae(nl,e),Ae(or,n))}function Hf(e){nl.current===e&&($e(or),$e(nl))}var Ve=fs(0);function Za(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var wc=[];function Vf(){for(var e=0;e<wc.length;e++)wc[e]._workInProgressVersionPrimary=null;wc.length=0}var Ca=Mr.ReactCurrentDispatcher,Sc=Mr.ReactCurrentBatchConfig,Bs=0,We=null,st=null,dt=null,eu=!1,Do=!1,sl=0,N1=0;function kt(){throw Error(Q(321))}function Wf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Bn(e[n],t[n]))return!1;return!0}function Qf(e,t,n,r,s,i){if(Bs=i,We=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ca.current=e===null||e.memoizedState===null?P1:T1,e=n(r,s),Do){i=0;do{if(Do=!1,sl=0,25<=i)throw Error(Q(301));i+=1,dt=st=null,t.updateQueue=null,Ca.current=L1,e=n(r,s)}while(Do)}if(Ca.current=tu,t=st!==null&&st.next!==null,Bs=0,dt=st=We=null,eu=!1,t)throw Error(Q(300));return e}function Kf(){var e=sl!==0;return sl=0,e}function er(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?We.memoizedState=dt=e:dt=dt.next=e,dt}function Rn(){if(st===null){var e=We.alternate;e=e!==null?e.memoizedState:null}else e=st.next;var t=dt===null?We.memoizedState:dt.next;if(t!==null)dt=t,st=e;else{if(e===null)throw Error(Q(310));st=e,e={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},dt===null?We.memoizedState=dt=e:dt=dt.next=e}return dt}function il(e,t){return typeof t=="function"?t(e):t}function bc(e){var t=Rn(),n=t.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=e;var r=st,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,d=i;do{var f=d.lane;if((Bs&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=h,o=r):u=u.next=h,We.lanes|=f,Us|=f}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=l,Bn(r,t.memoizedState)||(Qt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,We.lanes|=i,Us|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Cc(e){var t=Rn(),n=t.queue;if(n===null)throw Error(Q(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);Bn(i,t.memoizedState)||(Qt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function oy(){}function ly(e,t){var n=We,r=Rn(),s=t(),i=!Bn(r.memoizedState,s);if(i&&(r.memoizedState=s,Qt=!0),r=r.queue,Yf(cy.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||dt!==null&&dt.memoizedState.tag&1){if(n.flags|=2048,ol(9,uy.bind(null,n,r,s,t),void 0,null),ft===null)throw Error(Q(349));Bs&30||ay(n,t,s)}return s}function ay(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=We.updateQueue,t===null?(t={lastEffect:null,stores:null},We.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function uy(e,t,n,r){t.value=n,t.getSnapshot=r,dy(t)&&fy(e)}function cy(e,t,n){return n(function(){dy(t)&&fy(e)})}function dy(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Bn(e,n)}catch{return!0}}function fy(e){var t=Nr(e,1);t!==null&&$n(t,e,1,-1)}function Mp(e){var t=er();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:il,lastRenderedState:e},t.queue=e,e=e.dispatch=R1.bind(null,We,e),[t.memoizedState,e]}function ol(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=We.updateQueue,t===null?(t={lastEffect:null,stores:null},We.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function hy(){return Rn().memoizedState}function ka(e,t,n,r){var s=er();We.flags|=e,s.memoizedState=ol(1|t,n,void 0,r===void 0?null:r)}function ku(e,t,n,r){var s=Rn();r=r===void 0?null:r;var i=void 0;if(st!==null){var o=st.memoizedState;if(i=o.destroy,r!==null&&Wf(r,o.deps)){s.memoizedState=ol(t,n,i,r);return}}We.flags|=e,s.memoizedState=ol(1|t,n,i,r)}function Rp(e,t){return ka(8390656,8,e,t)}function Yf(e,t){return ku(2048,8,e,t)}function py(e,t){return ku(4,2,e,t)}function my(e,t){return ku(4,4,e,t)}function gy(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function vy(e,t,n){return n=n!=null?n.concat([e]):null,ku(4,4,gy.bind(null,t,e),n)}function Xf(){}function yy(e,t){var n=Rn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Wf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function xy(e,t){var n=Rn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Wf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function wy(e,t,n){return Bs&21?(Bn(n,t)||(n=Ev(),We.lanes|=n,Us|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Qt=!0),e.memoizedState=n)}function j1(e,t){var n=Fe;Fe=n!==0&&4>n?n:4,e(!0);var r=Sc.transition;Sc.transition={};try{e(!1),t()}finally{Fe=n,Sc.transition=r}}function Sy(){return Rn().memoizedState}function M1(e,t,n){var r=is(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},by(e))Cy(t,n);else if(n=ry(e,t,n,r),n!==null){var s=Ft();$n(n,e,r,s),ky(n,t,r)}}function R1(e,t,n){var r=is(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(by(e))Cy(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Bn(l,o)){var u=t.interleaved;u===null?(s.next=s,$f(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}n=ry(e,t,s,r),n!==null&&(s=Ft(),$n(n,e,r,s),ky(n,t,r))}}function by(e){var t=e.alternate;return e===We||t!==null&&t===We}function Cy(e,t){Do=eu=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ky(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Nf(e,n)}}var tu={readContext:Mn,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},P1={readContext:Mn,useCallback:function(e,t){return er().memoizedState=[e,t===void 0?null:t],e},useContext:Mn,useEffect:Rp,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ka(4194308,4,gy.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ka(4194308,4,e,t)},useInsertionEffect:function(e,t){return ka(4,2,e,t)},useMemo:function(e,t){var n=er();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=er();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=M1.bind(null,We,e),[r.memoizedState,e]},useRef:function(e){var t=er();return e={current:e},t.memoizedState=e},useState:Mp,useDebugValue:Xf,useDeferredValue:function(e){return er().memoizedState=e},useTransition:function(){var e=Mp(!1),t=e[0];return e=j1.bind(null,e[1]),er().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=We,s=er();if(Ue){if(n===void 0)throw Error(Q(407));n=n()}else{if(n=t(),ft===null)throw Error(Q(349));Bs&30||ay(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Rp(cy.bind(null,r,i,e),[e]),r.flags|=2048,ol(9,uy.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=er(),t=ft.identifierPrefix;if(Ue){var n=wr,r=xr;n=(r&~(1<<32-zn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=sl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=N1++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},T1={readContext:Mn,useCallback:yy,useContext:Mn,useEffect:Yf,useImperativeHandle:vy,useInsertionEffect:py,useLayoutEffect:my,useMemo:xy,useReducer:bc,useRef:hy,useState:function(){return bc(il)},useDebugValue:Xf,useDeferredValue:function(e){var t=Rn();return wy(t,st.memoizedState,e)},useTransition:function(){var e=bc(il)[0],t=Rn().memoizedState;return[e,t]},useMutableSource:oy,useSyncExternalStore:ly,useId:Sy,unstable_isNewReconciler:!1},L1={readContext:Mn,useCallback:yy,useContext:Mn,useEffect:Yf,useImperativeHandle:vy,useInsertionEffect:py,useLayoutEffect:my,useMemo:xy,useReducer:Cc,useRef:hy,useState:function(){return Cc(il)},useDebugValue:Xf,useDeferredValue:function(e){var t=Rn();return st===null?t.memoizedState=e:wy(t,st.memoizedState,e)},useTransition:function(){var e=Cc(il)[0],t=Rn().memoizedState;return[e,t]},useMutableSource:oy,useSyncExternalStore:ly,useId:Sy,unstable_isNewReconciler:!1};function _n(e,t){if(e&&e.defaultProps){t=Qe({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function wd(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Qe({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Eu={isMounted:function(e){return(e=e._reactInternals)?Ks(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ft(),s=is(e),i=Sr(r,s);i.payload=t,n!=null&&(i.callback=n),t=rs(e,i,s),t!==null&&($n(t,e,s,r),ba(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ft(),s=is(e),i=Sr(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=rs(e,i,s),t!==null&&($n(t,e,s,r),ba(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ft(),r=is(e),s=Sr(n,r);s.tag=2,t!=null&&(s.callback=t),t=rs(e,s,r),t!==null&&($n(t,e,r,n),ba(t,e,r))}};function Pp(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!Jo(n,r)||!Jo(s,i):!0}function Ey(e,t,n){var r=!1,s=cs,i=t.contextType;return typeof i=="object"&&i!==null?i=Mn(i):(s=Yt(t)?zs:Mt.current,r=t.contextTypes,i=(r=r!=null)?Wi(e,s):cs),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Eu,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Tp(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Eu.enqueueReplaceState(t,t.state,null)}function Sd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Bf(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Mn(i):(i=Yt(t)?zs:Mt.current,s.context=Wi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(wd(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Eu.enqueueReplaceState(s,s.state,null),Ja(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Xi(e,t){try{var n="",r=t;do n+=ow(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function kc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function bd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var _1=typeof WeakMap=="function"?WeakMap:Map;function Ny(e,t,n){n=Sr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ru||(ru=!0,Ld=r),bd(e,t)},n}function jy(e,t,n){n=Sr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){bd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){bd(e,t),typeof r!="function"&&(ss===null?ss=new Set([this]):ss.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Lp(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new _1;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=K1.bind(null,e,t,n),t.then(e,e))}function _p(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ip(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Sr(-1,1),t.tag=2,rs(n,t,1))),n.lanes|=1),e)}var I1=Mr.ReactCurrentOwner,Qt=!1;function _t(e,t,n,r){t.child=e===null?ny(t,null,n,r):Ki(t,e.child,n,r)}function Fp(e,t,n,r,s){n=n.render;var i=t.ref;return Ni(t,s),r=Qf(e,t,n,r,i,s),n=Kf(),e!==null&&!Qt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,jr(e,t,s)):(Ue&&n&&If(t),t.flags|=1,_t(e,t,r,s),t.child)}function Op(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!rh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,My(e,t,i,r,s)):(e=Ma(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Jo,n(o,r)&&e.ref===t.ref)return jr(e,t,s)}return t.flags|=1,e=os(i,r),e.ref=t.ref,e.return=t,t.child=e}function My(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(Jo(i,r)&&e.ref===t.ref)if(Qt=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Qt=!0);else return t.lanes=e.lanes,jr(e,t,s)}return Cd(e,t,n,r,s)}function Ry(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ae(Si,sn),sn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ae(Si,sn),sn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ae(Si,sn),sn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ae(Si,sn),sn|=r;return _t(e,t,s,n),t.child}function Py(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Cd(e,t,n,r,s){var i=Yt(n)?zs:Mt.current;return i=Wi(t,i),Ni(t,s),n=Qf(e,t,n,r,i,s),r=Kf(),e!==null&&!Qt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,jr(e,t,s)):(Ue&&r&&If(t),t.flags|=1,_t(e,t,n,s),t.child)}function Ap(e,t,n,r,s){if(Yt(n)){var i=!0;Ka(t)}else i=!1;if(Ni(t,s),t.stateNode===null)Ea(e,t),Ey(t,n,r),Sd(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Mn(d):(d=Yt(n)?zs:Mt.current,d=Wi(t,d));var f=n.getDerivedStateFromProps,h=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&Tp(t,o,r,d),zr=!1;var p=t.memoizedState;o.state=p,Ja(t,r,o,s),u=t.memoizedState,l!==r||p!==u||Kt.current||zr?(typeof f=="function"&&(wd(t,n,f,r),u=t.memoizedState),(l=zr||Pp(t,n,l,r,p,u,d))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,sy(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:_n(t.type,l),o.props=d,h=t.pendingProps,p=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Mn(u):(u=Yt(n)?zs:Mt.current,u=Wi(t,u));var S=n.getDerivedStateFromProps;(f=typeof S=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||p!==u)&&Tp(t,o,r,u),zr=!1,p=t.memoizedState,o.state=p,Ja(t,r,o,s);var w=t.memoizedState;l!==h||p!==w||Kt.current||zr?(typeof S=="function"&&(wd(t,n,S,r),w=t.memoizedState),(d=zr||Pp(t,n,d,r,p,w,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,w,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,w,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=w),o.props=r,o.state=w,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return kd(e,t,n,r,i,s)}function kd(e,t,n,r,s,i){Py(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&bp(t,n,!1),jr(e,t,i);r=t.stateNode,I1.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Ki(t,e.child,null,i),t.child=Ki(t,null,l,i)):_t(e,t,l,i),t.memoizedState=r.state,s&&bp(t,n,!0),t.child}function Ty(e){var t=e.stateNode;t.pendingContext?Sp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Sp(e,t.context,!1),Uf(e,t.containerInfo)}function Dp(e,t,n,r,s){return Qi(),Of(s),t.flags|=256,_t(e,t,n,r),t.child}var Ed={dehydrated:null,treeContext:null,retryLane:0};function Nd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ly(e,t,n){var r=t.pendingProps,s=Ve.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ae(Ve,s&1),e===null)return yd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Mu(o,r,0,null),e=Ds(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Nd(n),t.memoizedState=Ed,e):qf(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return F1(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=os(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=os(l,i):(i=Ds(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?Nd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=Ed,r}return i=e.child,e=i.sibling,r=os(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function qf(e,t){return t=Mu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ia(e,t,n,r){return r!==null&&Of(r),Ki(t,e.child,null,n),e=qf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function F1(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=kc(Error(Q(422))),ia(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Mu({mode:"visible",children:r.children},s,0,null),i=Ds(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Ki(t,e.child,null,o),t.child.memoizedState=Nd(o),t.memoizedState=Ed,i);if(!(t.mode&1))return ia(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(Q(419)),r=kc(i,r,void 0),ia(e,t,o,r)}if(l=(o&e.childLanes)!==0,Qt||l){if(r=ft,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Nr(e,s),$n(r,e,s,-1))}return nh(),r=kc(Error(Q(421))),ia(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=Y1.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,on=ns(s.nextSibling),ln=t,Ue=!0,Dn=null,e!==null&&(Cn[kn++]=xr,Cn[kn++]=wr,Cn[kn++]=$s,xr=e.id,wr=e.overflow,$s=t),t=qf(t,r.children),t.flags|=4096,t)}function zp(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),xd(e.return,t,n)}function Ec(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function _y(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(_t(e,t,r.children,n),r=Ve.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&zp(e,n,t);else if(e.tag===19)zp(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ae(Ve,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Za(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Ec(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Za(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Ec(t,!0,n,null,i);break;case"together":Ec(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ea(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function jr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Us|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Q(153));if(t.child!==null){for(e=t.child,n=os(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=os(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function O1(e,t,n){switch(t.tag){case 3:Ty(t),Qi();break;case 5:iy(t);break;case 1:Yt(t.type)&&Ka(t);break;case 4:Uf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Ae(qa,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ae(Ve,Ve.current&1),t.flags|=128,null):n&t.child.childLanes?Ly(e,t,n):(Ae(Ve,Ve.current&1),e=jr(e,t,n),e!==null?e.sibling:null);Ae(Ve,Ve.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return _y(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ae(Ve,Ve.current),r)break;return null;case 22:case 23:return t.lanes=0,Ry(e,t,n)}return jr(e,t,n)}var Iy,jd,Fy,Oy;Iy=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};jd=function(){};Fy=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Cs(or.current);var i=null;switch(n){case"input":s=Xc(e,s),r=Xc(e,r),i=[];break;case"select":s=Qe({},s,{value:void 0}),r=Qe({},r,{value:void 0}),i=[];break;case"textarea":s=Jc(e,s),r=Jc(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Wa)}ed(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Wo.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Wo.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&ze("scroll",e),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Oy=function(e,t,n,r){n!==r&&(t.flags|=4)};function yo(e,t){if(!Ue)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Et(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function A1(e,t,n){var r=t.pendingProps;switch(Ff(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(t),null;case 1:return Yt(t.type)&&Qa(),Et(t),null;case 3:return r=t.stateNode,Yi(),$e(Kt),$e(Mt),Vf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(ra(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Dn!==null&&(Fd(Dn),Dn=null))),jd(e,t),Et(t),null;case 5:Hf(t);var s=Cs(rl.current);if(n=t.type,e!==null&&t.stateNode!=null)Fy(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Q(166));return Et(t),null}if(e=Cs(or.current),ra(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[sr]=t,r[tl]=i,e=(t.mode&1)!==0,n){case"dialog":ze("cancel",r),ze("close",r);break;case"iframe":case"object":case"embed":ze("load",r);break;case"video":case"audio":for(s=0;s<Po.length;s++)ze(Po[s],r);break;case"source":ze("error",r);break;case"img":case"image":case"link":ze("error",r),ze("load",r);break;case"details":ze("toggle",r);break;case"input":Yh(r,i),ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},ze("invalid",r);break;case"textarea":qh(r,i),ze("invalid",r)}ed(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&na(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&na(r.textContent,l,e),s=["children",""+l]):Wo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&ze("scroll",r)}switch(n){case"input":Yl(r),Xh(r,i,!0);break;case"textarea":Yl(r),Gh(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Wa)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=cv(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[sr]=t,e[tl]=r,Iy(e,t,!1,!1),t.stateNode=e;e:{switch(o=td(n,r),n){case"dialog":ze("cancel",e),ze("close",e),s=r;break;case"iframe":case"object":case"embed":ze("load",e),s=r;break;case"video":case"audio":for(s=0;s<Po.length;s++)ze(Po[s],e);s=r;break;case"source":ze("error",e),s=r;break;case"img":case"image":case"link":ze("error",e),ze("load",e),s=r;break;case"details":ze("toggle",e),s=r;break;case"input":Yh(e,r),s=Xc(e,r),ze("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Qe({},r,{value:void 0}),ze("invalid",e);break;case"textarea":qh(e,r),s=Jc(e,r),ze("invalid",e);break;default:s=r}ed(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?hv(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&dv(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Qo(e,u):typeof u=="number"&&Qo(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Wo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&ze("scroll",e):u!=null&&wf(e,i,u,o))}switch(n){case"input":Yl(e),Xh(e,r,!1);break;case"textarea":Yl(e),Gh(e);break;case"option":r.value!=null&&e.setAttribute("value",""+us(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?bi(e,!!r.multiple,i,!1):r.defaultValue!=null&&bi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Wa)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Et(t),null;case 6:if(e&&t.stateNode!=null)Oy(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Q(166));if(n=Cs(rl.current),Cs(or.current),ra(t)){if(r=t.stateNode,n=t.memoizedProps,r[sr]=t,(i=r.nodeValue!==n)&&(e=ln,e!==null))switch(e.tag){case 3:na(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&na(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[sr]=t,t.stateNode=r}return Et(t),null;case 13:if($e(Ve),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ue&&on!==null&&t.mode&1&&!(t.flags&128))ey(),Qi(),t.flags|=98560,i=!1;else if(i=ra(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(Q(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Q(317));i[sr]=t}else Qi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Et(t),i=!1}else Dn!==null&&(Fd(Dn),Dn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ve.current&1?ot===0&&(ot=3):nh())),t.updateQueue!==null&&(t.flags|=4),Et(t),null);case 4:return Yi(),jd(e,t),e===null&&Zo(t.stateNode.containerInfo),Et(t),null;case 10:return zf(t.type._context),Et(t),null;case 17:return Yt(t.type)&&Qa(),Et(t),null;case 19:if($e(Ve),i=t.memoizedState,i===null)return Et(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)yo(i,!1);else{if(ot!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Za(e),o!==null){for(t.flags|=128,yo(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ae(Ve,Ve.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ge()>qi&&(t.flags|=128,r=!0,yo(i,!1),t.lanes=4194304)}else{if(!r)if(e=Za(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),yo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ue)return Et(t),null}else 2*Ge()-i.renderingStartTime>qi&&n!==1073741824&&(t.flags|=128,r=!0,yo(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ge(),t.sibling=null,n=Ve.current,Ae(Ve,r?n&1|2:n&1),t):(Et(t),null);case 22:case 23:return th(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?sn&1073741824&&(Et(t),t.subtreeFlags&6&&(t.flags|=8192)):Et(t),null;case 24:return null;case 25:return null}throw Error(Q(156,t.tag))}function D1(e,t){switch(Ff(t),t.tag){case 1:return Yt(t.type)&&Qa(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Yi(),$e(Kt),$e(Mt),Vf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Hf(t),null;case 13:if($e(Ve),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Q(340));Qi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return $e(Ve),null;case 4:return Yi(),null;case 10:return zf(t.type._context),null;case 22:case 23:return th(),null;case 24:return null;default:return null}}var oa=!1,jt=!1,z1=typeof WeakSet=="function"?WeakSet:Set,ue=null;function wi(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xe(e,t,r)}else n.current=null}function Md(e,t,n){try{n()}catch(r){Xe(e,t,r)}}var $p=!1;function $1(e,t){if(dd=Ua,e=Bv(),_f(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,f=0,h=e,p=null;t:for(;;){for(var S;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(u=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(S=h.firstChild)!==null;)p=h,h=S;for(;;){if(h===e)break t;if(p===n&&++d===s&&(l=o),p===i&&++f===r&&(u=o),(S=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=S}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(fd={focusedElem:e,selectionRange:n},Ua=!1,ue=t;ue!==null;)if(t=ue,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ue=e;else for(;ue!==null;){t=ue;try{var w=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var E=w.memoizedProps,j=w.memoizedState,v=t.stateNode,m=v.getSnapshotBeforeUpdate(t.elementType===t.type?E:_n(t.type,E),j);v.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Q(163))}}catch(y){Xe(t,t.return,y)}if(e=t.sibling,e!==null){e.return=t.return,ue=e;break}ue=t.return}return w=$p,$p=!1,w}function zo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Md(t,n,i)}s=s.next}while(s!==r)}}function Nu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Rd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Ay(e){var t=e.alternate;t!==null&&(e.alternate=null,Ay(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[sr],delete t[tl],delete t[md],delete t[b1],delete t[C1])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Dy(e){return e.tag===5||e.tag===3||e.tag===4}function Bp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Dy(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Pd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Wa));else if(r!==4&&(e=e.child,e!==null))for(Pd(e,t,n),e=e.sibling;e!==null;)Pd(e,t,n),e=e.sibling}function Td(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Td(e,t,n),e=e.sibling;e!==null;)Td(e,t,n),e=e.sibling}var gt=null,An=!1;function Fr(e,t,n){for(n=n.child;n!==null;)zy(e,t,n),n=n.sibling}function zy(e,t,n){if(ir&&typeof ir.onCommitFiberUnmount=="function")try{ir.onCommitFiberUnmount(yu,n)}catch{}switch(n.tag){case 5:jt||wi(n,t);case 6:var r=gt,s=An;gt=null,Fr(e,t,n),gt=r,An=s,gt!==null&&(An?(e=gt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):gt.removeChild(n.stateNode));break;case 18:gt!==null&&(An?(e=gt,n=n.stateNode,e.nodeType===8?yc(e.parentNode,n):e.nodeType===1&&yc(e,n),qo(e)):yc(gt,n.stateNode));break;case 4:r=gt,s=An,gt=n.stateNode.containerInfo,An=!0,Fr(e,t,n),gt=r,An=s;break;case 0:case 11:case 14:case 15:if(!jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Md(n,t,o),s=s.next}while(s!==r)}Fr(e,t,n);break;case 1:if(!jt&&(wi(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Xe(n,t,l)}Fr(e,t,n);break;case 21:Fr(e,t,n);break;case 22:n.mode&1?(jt=(r=jt)||n.memoizedState!==null,Fr(e,t,n),jt=r):Fr(e,t,n);break;default:Fr(e,t,n)}}function Up(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new z1),t.forEach(function(r){var s=X1.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Tn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:gt=l.stateNode,An=!1;break e;case 3:gt=l.stateNode.containerInfo,An=!0;break e;case 4:gt=l.stateNode.containerInfo,An=!0;break e}l=l.return}if(gt===null)throw Error(Q(160));zy(i,o,s),gt=null,An=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Xe(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)$y(t,e),t=t.sibling}function $y(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Tn(t,e),Zn(e),r&4){try{zo(3,e,e.return),Nu(3,e)}catch(E){Xe(e,e.return,E)}try{zo(5,e,e.return)}catch(E){Xe(e,e.return,E)}}break;case 1:Tn(t,e),Zn(e),r&512&&n!==null&&wi(n,n.return);break;case 5:if(Tn(t,e),Zn(e),r&512&&n!==null&&wi(n,n.return),e.flags&32){var s=e.stateNode;try{Qo(s,"")}catch(E){Xe(e,e.return,E)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&av(s,i),td(l,o);var d=td(l,i);for(o=0;o<u.length;o+=2){var f=u[o],h=u[o+1];f==="style"?hv(s,h):f==="dangerouslySetInnerHTML"?dv(s,h):f==="children"?Qo(s,h):wf(s,f,h,d)}switch(l){case"input":qc(s,i);break;case"textarea":uv(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var S=i.value;S!=null?bi(s,!!i.multiple,S,!1):p!==!!i.multiple&&(i.defaultValue!=null?bi(s,!!i.multiple,i.defaultValue,!0):bi(s,!!i.multiple,i.multiple?[]:"",!1))}s[tl]=i}catch(E){Xe(e,e.return,E)}}break;case 6:if(Tn(t,e),Zn(e),r&4){if(e.stateNode===null)throw Error(Q(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(E){Xe(e,e.return,E)}}break;case 3:if(Tn(t,e),Zn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{qo(t.containerInfo)}catch(E){Xe(e,e.return,E)}break;case 4:Tn(t,e),Zn(e);break;case 13:Tn(t,e),Zn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Zf=Ge())),r&4&&Up(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(jt=(d=jt)||f,Tn(t,e),jt=d):Tn(t,e),Zn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!f&&e.mode&1)for(ue=e,f=e.child;f!==null;){for(h=ue=f;ue!==null;){switch(p=ue,S=p.child,p.tag){case 0:case 11:case 14:case 15:zo(4,p,p.return);break;case 1:wi(p,p.return);var w=p.stateNode;if(typeof w.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,w.props=t.memoizedProps,w.state=t.memoizedState,w.componentWillUnmount()}catch(E){Xe(r,n,E)}}break;case 5:wi(p,p.return);break;case 22:if(p.memoizedState!==null){Vp(h);continue}}S!==null?(S.return=p,ue=S):Vp(h)}f=f.sibling}e:for(f=null,h=e;;){if(h.tag===5){if(f===null){f=h;try{s=h.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,u=h.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=fv("display",o))}catch(E){Xe(e,e.return,E)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(E){Xe(e,e.return,E)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Tn(t,e),Zn(e),r&4&&Up(e);break;case 21:break;default:Tn(t,e),Zn(e)}}function Zn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Dy(n)){var r=n;break e}n=n.return}throw Error(Q(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Qo(s,""),r.flags&=-33);var i=Bp(e);Td(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Bp(e);Pd(e,l,o);break;default:throw Error(Q(161))}}catch(u){Xe(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function B1(e,t,n){ue=e,By(e)}function By(e,t,n){for(var r=(e.mode&1)!==0;ue!==null;){var s=ue,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||oa;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||jt;l=oa;var d=jt;if(oa=o,(jt=u)&&!d)for(ue=s;ue!==null;)o=ue,u=o.child,o.tag===22&&o.memoizedState!==null?Wp(s):u!==null?(u.return=o,ue=u):Wp(s);for(;i!==null;)ue=i,By(i),i=i.sibling;ue=s,oa=l,jt=d}Hp(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ue=i):Hp(e)}}function Hp(e){for(;ue!==null;){var t=ue;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:jt||Nu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!jt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:_n(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&jp(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}jp(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&qo(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Q(163))}jt||t.flags&512&&Rd(t)}catch(p){Xe(t,t.return,p)}}if(t===e){ue=null;break}if(n=t.sibling,n!==null){n.return=t.return,ue=n;break}ue=t.return}}function Vp(e){for(;ue!==null;){var t=ue;if(t===e){ue=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ue=n;break}ue=t.return}}function Wp(e){for(;ue!==null;){var t=ue;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Nu(4,t)}catch(u){Xe(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(u){Xe(t,s,u)}}var i=t.return;try{Rd(t)}catch(u){Xe(t,i,u)}break;case 5:var o=t.return;try{Rd(t)}catch(u){Xe(t,o,u)}}}catch(u){Xe(t,t.return,u)}if(t===e){ue=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ue=l;break}ue=t.return}}var U1=Math.ceil,nu=Mr.ReactCurrentDispatcher,Gf=Mr.ReactCurrentOwner,jn=Mr.ReactCurrentBatchConfig,Te=0,ft=null,Je=null,vt=0,sn=0,Si=fs(0),ot=0,ll=null,Us=0,ju=0,Jf=0,$o=null,Wt=null,Zf=0,qi=1/0,hr=null,ru=!1,Ld=null,ss=null,la=!1,Jr=null,su=0,Bo=0,_d=null,Na=-1,ja=0;function Ft(){return Te&6?Ge():Na!==-1?Na:Na=Ge()}function is(e){return e.mode&1?Te&2&&vt!==0?vt&-vt:E1.transition!==null?(ja===0&&(ja=Ev()),ja):(e=Fe,e!==0||(e=window.event,e=e===void 0?16:Lv(e.type)),e):1}function $n(e,t,n,r){if(50<Bo)throw Bo=0,_d=null,Error(Q(185));yl(e,n,r),(!(Te&2)||e!==ft)&&(e===ft&&(!(Te&2)&&(ju|=n),ot===4&&Br(e,vt)),Xt(e,r),n===1&&Te===0&&!(t.mode&1)&&(qi=Ge()+500,Cu&&hs()))}function Xt(e,t){var n=e.callbackNode;Ew(e,t);var r=Ba(e,e===ft?vt:0);if(r===0)n!==null&&ep(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&ep(n),t===1)e.tag===0?k1(Qp.bind(null,e)):Gv(Qp.bind(null,e)),w1(function(){!(Te&6)&&hs()}),n=null;else{switch(Nv(r)){case 1:n=Ef;break;case 4:n=Cv;break;case 16:n=$a;break;case 536870912:n=kv;break;default:n=$a}n=Xy(n,Uy.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Uy(e,t){if(Na=-1,ja=0,Te&6)throw Error(Q(327));var n=e.callbackNode;if(ji()&&e.callbackNode!==n)return null;var r=Ba(e,e===ft?vt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=iu(e,r);else{t=r;var s=Te;Te|=2;var i=Vy();(ft!==e||vt!==t)&&(hr=null,qi=Ge()+500,As(e,t));do try{W1();break}catch(l){Hy(e,l)}while(!0);Df(),nu.current=i,Te=s,Je!==null?t=0:(ft=null,vt=0,t=ot)}if(t!==0){if(t===2&&(s=od(e),s!==0&&(r=s,t=Id(e,s))),t===1)throw n=ll,As(e,0),Br(e,r),Xt(e,Ge()),n;if(t===6)Br(e,r);else{if(s=e.current.alternate,!(r&30)&&!H1(s)&&(t=iu(e,r),t===2&&(i=od(e),i!==0&&(r=i,t=Id(e,i))),t===1))throw n=ll,As(e,0),Br(e,r),Xt(e,Ge()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(Q(345));case 2:ws(e,Wt,hr);break;case 3:if(Br(e,r),(r&130023424)===r&&(t=Zf+500-Ge(),10<t)){if(Ba(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Ft(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=pd(ws.bind(null,e,Wt,hr),t);break}ws(e,Wt,hr);break;case 4:if(Br(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-zn(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*U1(r/1960))-r,10<r){e.timeoutHandle=pd(ws.bind(null,e,Wt,hr),r);break}ws(e,Wt,hr);break;case 5:ws(e,Wt,hr);break;default:throw Error(Q(329))}}}return Xt(e,Ge()),e.callbackNode===n?Uy.bind(null,e):null}function Id(e,t){var n=$o;return e.current.memoizedState.isDehydrated&&(As(e,t).flags|=256),e=iu(e,t),e!==2&&(t=Wt,Wt=n,t!==null&&Fd(t)),e}function Fd(e){Wt===null?Wt=e:Wt.push.apply(Wt,e)}function H1(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Bn(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Br(e,t){for(t&=~Jf,t&=~ju,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-zn(t),r=1<<n;e[n]=-1,t&=~r}}function Qp(e){if(Te&6)throw Error(Q(327));ji();var t=Ba(e,0);if(!(t&1))return Xt(e,Ge()),null;var n=iu(e,t);if(e.tag!==0&&n===2){var r=od(e);r!==0&&(t=r,n=Id(e,r))}if(n===1)throw n=ll,As(e,0),Br(e,t),Xt(e,Ge()),n;if(n===6)throw Error(Q(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ws(e,Wt,hr),Xt(e,Ge()),null}function eh(e,t){var n=Te;Te|=1;try{return e(t)}finally{Te=n,Te===0&&(qi=Ge()+500,Cu&&hs())}}function Hs(e){Jr!==null&&Jr.tag===0&&!(Te&6)&&ji();var t=Te;Te|=1;var n=jn.transition,r=Fe;try{if(jn.transition=null,Fe=1,e)return e()}finally{Fe=r,jn.transition=n,Te=t,!(Te&6)&&hs()}}function th(){sn=Si.current,$e(Si)}function As(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,x1(n)),Je!==null)for(n=Je.return;n!==null;){var r=n;switch(Ff(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Qa();break;case 3:Yi(),$e(Kt),$e(Mt),Vf();break;case 5:Hf(r);break;case 4:Yi();break;case 13:$e(Ve);break;case 19:$e(Ve);break;case 10:zf(r.type._context);break;case 22:case 23:th()}n=n.return}if(ft=e,Je=e=os(e.current,null),vt=sn=t,ot=0,ll=null,Jf=ju=Us=0,Wt=$o=null,bs!==null){for(t=0;t<bs.length;t++)if(n=bs[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}bs=null}return e}function Hy(e,t){do{var n=Je;try{if(Df(),Ca.current=tu,eu){for(var r=We.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}eu=!1}if(Bs=0,dt=st=We=null,Do=!1,sl=0,Gf.current=null,n===null||n.return===null){ot=1,ll=t,Je=null;break}e:{var i=e,o=n.return,l=n,u=t;if(t=vt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=l,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var S=_p(o);if(S!==null){S.flags&=-257,Ip(S,o,l,i,t),S.mode&1&&Lp(i,d,t),t=S,u=d;var w=t.updateQueue;if(w===null){var E=new Set;E.add(u),t.updateQueue=E}else w.add(u);break e}else{if(!(t&1)){Lp(i,d,t),nh();break e}u=Error(Q(426))}}else if(Ue&&l.mode&1){var j=_p(o);if(j!==null){!(j.flags&65536)&&(j.flags|=256),Ip(j,o,l,i,t),Of(Xi(u,l));break e}}i=u=Xi(u,l),ot!==4&&(ot=2),$o===null?$o=[i]:$o.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=Ny(i,u,t);Np(i,v);break e;case 1:l=u;var m=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(ss===null||!ss.has(x)))){i.flags|=65536,t&=-t,i.lanes|=t;var y=jy(i,l,t);Np(i,y);break e}}i=i.return}while(i!==null)}Qy(n)}catch(k){t=k,Je===n&&n!==null&&(Je=n=n.return);continue}break}while(!0)}function Vy(){var e=nu.current;return nu.current=tu,e===null?tu:e}function nh(){(ot===0||ot===3||ot===2)&&(ot=4),ft===null||!(Us&268435455)&&!(ju&268435455)||Br(ft,vt)}function iu(e,t){var n=Te;Te|=2;var r=Vy();(ft!==e||vt!==t)&&(hr=null,As(e,t));do try{V1();break}catch(s){Hy(e,s)}while(!0);if(Df(),Te=n,nu.current=r,Je!==null)throw Error(Q(261));return ft=null,vt=0,ot}function V1(){for(;Je!==null;)Wy(Je)}function W1(){for(;Je!==null&&!gw();)Wy(Je)}function Wy(e){var t=Yy(e.alternate,e,sn);e.memoizedProps=e.pendingProps,t===null?Qy(e):Je=t,Gf.current=null}function Qy(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=D1(n,t),n!==null){n.flags&=32767,Je=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ot=6,Je=null;return}}else if(n=A1(n,t,sn),n!==null){Je=n;return}if(t=t.sibling,t!==null){Je=t;return}Je=t=e}while(t!==null);ot===0&&(ot=5)}function ws(e,t,n){var r=Fe,s=jn.transition;try{jn.transition=null,Fe=1,Q1(e,t,n,r)}finally{jn.transition=s,Fe=r}return null}function Q1(e,t,n,r){do ji();while(Jr!==null);if(Te&6)throw Error(Q(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Q(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(Nw(e,i),e===ft&&(Je=ft=null,vt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||la||(la=!0,Xy($a,function(){return ji(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=jn.transition,jn.transition=null;var o=Fe;Fe=1;var l=Te;Te|=4,Gf.current=null,$1(e,n),$y(n,e),f1(fd),Ua=!!dd,fd=dd=null,e.current=n,B1(n),vw(),Te=l,Fe=o,jn.transition=i}else e.current=n;if(la&&(la=!1,Jr=e,su=s),i=e.pendingLanes,i===0&&(ss=null),ww(n.stateNode),Xt(e,Ge()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ru)throw ru=!1,e=Ld,Ld=null,e;return su&1&&e.tag!==0&&ji(),i=e.pendingLanes,i&1?e===_d?Bo++:(Bo=0,_d=e):Bo=0,hs(),null}function ji(){if(Jr!==null){var e=Nv(su),t=jn.transition,n=Fe;try{if(jn.transition=null,Fe=16>e?16:e,Jr===null)var r=!1;else{if(e=Jr,Jr=null,su=0,Te&6)throw Error(Q(331));var s=Te;for(Te|=4,ue=e.current;ue!==null;){var i=ue,o=i.child;if(ue.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(ue=d;ue!==null;){var f=ue;switch(f.tag){case 0:case 11:case 15:zo(8,f,i)}var h=f.child;if(h!==null)h.return=f,ue=h;else for(;ue!==null;){f=ue;var p=f.sibling,S=f.return;if(Ay(f),f===d){ue=null;break}if(p!==null){p.return=S,ue=p;break}ue=S}}}var w=i.alternate;if(w!==null){var E=w.child;if(E!==null){w.child=null;do{var j=E.sibling;E.sibling=null,E=j}while(E!==null)}}ue=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ue=o;else e:for(;ue!==null;){if(i=ue,i.flags&2048)switch(i.tag){case 0:case 11:case 15:zo(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,ue=v;break e}ue=i.return}}var m=e.current;for(ue=m;ue!==null;){o=ue;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,ue=x;else e:for(o=m;ue!==null;){if(l=ue,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Nu(9,l)}}catch(k){Xe(l,l.return,k)}if(l===o){ue=null;break e}var y=l.sibling;if(y!==null){y.return=l.return,ue=y;break e}ue=l.return}}if(Te=s,hs(),ir&&typeof ir.onPostCommitFiberRoot=="function")try{ir.onPostCommitFiberRoot(yu,e)}catch{}r=!0}return r}finally{Fe=n,jn.transition=t}}return!1}function Kp(e,t,n){t=Xi(n,t),t=Ny(e,t,1),e=rs(e,t,1),t=Ft(),e!==null&&(yl(e,1,t),Xt(e,t))}function Xe(e,t,n){if(e.tag===3)Kp(e,e,n);else for(;t!==null;){if(t.tag===3){Kp(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ss===null||!ss.has(r))){e=Xi(n,e),e=jy(t,e,1),t=rs(t,e,1),e=Ft(),t!==null&&(yl(t,1,e),Xt(t,e));break}}t=t.return}}function K1(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ft(),e.pingedLanes|=e.suspendedLanes&n,ft===e&&(vt&n)===n&&(ot===4||ot===3&&(vt&130023424)===vt&&500>Ge()-Zf?As(e,0):Jf|=n),Xt(e,t)}function Ky(e,t){t===0&&(e.mode&1?(t=Gl,Gl<<=1,!(Gl&130023424)&&(Gl=4194304)):t=1);var n=Ft();e=Nr(e,t),e!==null&&(yl(e,t,n),Xt(e,n))}function Y1(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Ky(e,n)}function X1(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Q(314))}r!==null&&r.delete(t),Ky(e,n)}var Yy;Yy=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Kt.current)Qt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Qt=!1,O1(e,t,n);Qt=!!(e.flags&131072)}else Qt=!1,Ue&&t.flags&1048576&&Jv(t,Xa,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ea(e,t),e=t.pendingProps;var s=Wi(t,Mt.current);Ni(t,n),s=Qf(null,t,r,e,s,n);var i=Kf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Yt(r)?(i=!0,Ka(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Bf(t),s.updater=Eu,t.stateNode=s,s._reactInternals=t,Sd(t,r,e,n),t=kd(null,t,r,!0,i,n)):(t.tag=0,Ue&&i&&If(t),_t(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ea(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=G1(r),e=_n(r,e),s){case 0:t=Cd(null,t,r,e,n);break e;case 1:t=Ap(null,t,r,e,n);break e;case 11:t=Fp(null,t,r,e,n);break e;case 14:t=Op(null,t,r,_n(r.type,e),n);break e}throw Error(Q(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:_n(r,s),Cd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:_n(r,s),Ap(e,t,r,s,n);case 3:e:{if(Ty(t),e===null)throw Error(Q(387));r=t.pendingProps,i=t.memoizedState,s=i.element,sy(e,t),Ja(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Xi(Error(Q(423)),t),t=Dp(e,t,r,n,s);break e}else if(r!==s){s=Xi(Error(Q(424)),t),t=Dp(e,t,r,n,s);break e}else for(on=ns(t.stateNode.containerInfo.firstChild),ln=t,Ue=!0,Dn=null,n=ny(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Qi(),r===s){t=jr(e,t,n);break e}_t(e,t,r,n)}t=t.child}return t;case 5:return iy(t),e===null&&yd(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,hd(r,s)?o=null:i!==null&&hd(r,i)&&(t.flags|=32),Py(e,t),_t(e,t,o,n),t.child;case 6:return e===null&&yd(t),null;case 13:return Ly(e,t,n);case 4:return Uf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ki(t,null,r,n):_t(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:_n(r,s),Fp(e,t,r,s,n);case 7:return _t(e,t,t.pendingProps,n),t.child;case 8:return _t(e,t,t.pendingProps.children,n),t.child;case 12:return _t(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Ae(qa,r._currentValue),r._currentValue=o,i!==null)if(Bn(i.value,o)){if(i.children===s.children&&!Kt.current){t=jr(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Sr(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),xd(i.return,n,t),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Q(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),xd(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}_t(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Ni(t,n),s=Mn(s),r=r(s),t.flags|=1,_t(e,t,r,n),t.child;case 14:return r=t.type,s=_n(r,t.pendingProps),s=_n(r.type,s),Op(e,t,r,s,n);case 15:return My(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:_n(r,s),Ea(e,t),t.tag=1,Yt(r)?(e=!0,Ka(t)):e=!1,Ni(t,n),Ey(t,r,s),Sd(t,r,s,n),kd(null,t,r,!0,e,n);case 19:return _y(e,t,n);case 22:return Ry(e,t,n)}throw Error(Q(156,t.tag))};function Xy(e,t){return bv(e,t)}function q1(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nn(e,t,n,r){return new q1(e,t,n,r)}function rh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function G1(e){if(typeof e=="function")return rh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===bf)return 11;if(e===Cf)return 14}return 2}function os(e,t){var n=e.alternate;return n===null?(n=Nn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ma(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")rh(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case di:return Ds(n.children,s,i,t);case Sf:o=8,s|=8;break;case Wc:return e=Nn(12,n,t,s|2),e.elementType=Wc,e.lanes=i,e;case Qc:return e=Nn(13,n,t,s),e.elementType=Qc,e.lanes=i,e;case Kc:return e=Nn(19,n,t,s),e.elementType=Kc,e.lanes=i,e;case iv:return Mu(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case rv:o=10;break e;case sv:o=9;break e;case bf:o=11;break e;case Cf:o=14;break e;case Dr:o=16,r=null;break e}throw Error(Q(130,e==null?e:typeof e,""))}return t=Nn(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function Ds(e,t,n,r){return e=Nn(7,e,r,t),e.lanes=n,e}function Mu(e,t,n,r){return e=Nn(22,e,r,t),e.elementType=iv,e.lanes=n,e.stateNode={isHidden:!1},e}function Nc(e,t,n){return e=Nn(6,e,null,t),e.lanes=n,e}function jc(e,t,n){return t=Nn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function J1(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=lc(0),this.expirationTimes=lc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function sh(e,t,n,r,s,i,o,l,u){return e=new J1(e,t,n,l,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Nn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bf(i),e}function Z1(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ci,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function qy(e){if(!e)return cs;e=e._reactInternals;e:{if(Ks(e)!==e||e.tag!==1)throw Error(Q(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Yt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Q(171))}if(e.tag===1){var n=e.type;if(Yt(n))return qv(e,n,t)}return t}function Gy(e,t,n,r,s,i,o,l,u){return e=sh(n,r,!0,e,s,i,o,l,u),e.context=qy(null),n=e.current,r=Ft(),s=is(n),i=Sr(r,s),i.callback=t??null,rs(n,i,s),e.current.lanes=s,yl(e,s,r),Xt(e,r),e}function Ru(e,t,n,r){var s=t.current,i=Ft(),o=is(s);return n=qy(n),t.context===null?t.context=n:t.pendingContext=n,t=Sr(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=rs(s,t,o),e!==null&&($n(e,s,o,i),ba(e,s,o)),o}function ou(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Yp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ih(e,t){Yp(e,t),(e=e.alternate)&&Yp(e,t)}function eS(){return null}var Jy=typeof reportError=="function"?reportError:function(e){console.error(e)};function oh(e){this._internalRoot=e}Pu.prototype.render=oh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Q(409));Ru(e,t,null,null)};Pu.prototype.unmount=oh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Hs(function(){Ru(null,e,null,null)}),t[Er]=null}};function Pu(e){this._internalRoot=e}Pu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Rv();e={blockedOn:null,target:e,priority:t};for(var n=0;n<$r.length&&t!==0&&t<$r[n].priority;n++);$r.splice(n,0,e),n===0&&Tv(e)}};function lh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Tu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Xp(){}function tS(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=ou(o);i.call(d)}}var o=Gy(t,r,e,0,null,!1,!1,"",Xp);return e._reactRootContainer=o,e[Er]=o.current,Zo(e.nodeType===8?e.parentNode:e),Hs(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=ou(u);l.call(d)}}var u=sh(e,0,!1,null,null,!1,!1,"",Xp);return e._reactRootContainer=u,e[Er]=u.current,Zo(e.nodeType===8?e.parentNode:e),Hs(function(){Ru(t,u,n,r)}),u}function Lu(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=ou(o);l.call(u)}}Ru(t,o,e,s)}else o=tS(n,t,e,s,r);return ou(o)}jv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Ro(t.pendingLanes);n!==0&&(Nf(t,n|1),Xt(t,Ge()),!(Te&6)&&(qi=Ge()+500,hs()))}break;case 13:Hs(function(){var r=Nr(e,1);if(r!==null){var s=Ft();$n(r,e,1,s)}}),ih(e,1)}};jf=function(e){if(e.tag===13){var t=Nr(e,134217728);if(t!==null){var n=Ft();$n(t,e,134217728,n)}ih(e,134217728)}};Mv=function(e){if(e.tag===13){var t=is(e),n=Nr(e,t);if(n!==null){var r=Ft();$n(n,e,t,r)}ih(e,t)}};Rv=function(){return Fe};Pv=function(e,t){var n=Fe;try{return Fe=e,t()}finally{Fe=n}};rd=function(e,t,n){switch(t){case"input":if(qc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=bu(r);if(!s)throw Error(Q(90));lv(r),qc(r,s)}}}break;case"textarea":uv(e,n);break;case"select":t=n.value,t!=null&&bi(e,!!n.multiple,t,!1)}};gv=eh;vv=Hs;var nS={usingClientEntryPoint:!1,Events:[wl,mi,bu,pv,mv,eh]},xo={findFiberByHostInstance:Ss,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rS={bundleType:xo.bundleType,version:xo.version,rendererPackageName:xo.rendererPackageName,rendererConfig:xo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Mr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=wv(e),e===null?null:e.stateNode},findFiberByHostInstance:xo.findFiberByHostInstance||eS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var aa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!aa.isDisabled&&aa.supportsFiber)try{yu=aa.inject(rS),ir=aa}catch{}}cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nS;cn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lh(t))throw Error(Q(200));return Z1(e,t,null,n)};cn.createRoot=function(e,t){if(!lh(e))throw Error(Q(299));var n=!1,r="",s=Jy;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=sh(e,1,!1,null,null,n,!1,r,s),e[Er]=t.current,Zo(e.nodeType===8?e.parentNode:e),new oh(t)};cn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Q(188)):(e=Object.keys(e).join(","),Error(Q(268,e)));return e=wv(t),e=e===null?null:e.stateNode,e};cn.flushSync=function(e){return Hs(e)};cn.hydrate=function(e,t,n){if(!Tu(t))throw Error(Q(200));return Lu(null,e,t,!0,n)};cn.hydrateRoot=function(e,t,n){if(!lh(e))throw Error(Q(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Jy;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Gy(t,null,e,1,n??null,s,!1,i,o),e[Er]=t.current,Zo(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Pu(t)};cn.render=function(e,t,n){if(!Tu(t))throw Error(Q(200));return Lu(null,e,t,!1,n)};cn.unmountComponentAtNode=function(e){if(!Tu(e))throw Error(Q(40));return e._reactRootContainer?(Hs(function(){Lu(null,null,e,!1,function(){e._reactRootContainer=null,e[Er]=null})}),!0):!1};cn.unstable_batchedUpdates=eh;cn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Tu(n))throw Error(Q(200));if(e==null||e._reactInternals===void 0)throw Error(Q(38));return Lu(e,t,n,!1,r)};cn.version="18.3.1-next-f1338f8080-20240426";function Zy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Zy)}catch(e){console.error(e)}}Zy(),Zg.exports=cn;var _u=Zg.exports,ex,qp=_u;ex=qp.createRoot,qp.hydrateRoot;var to=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},sS={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Ur,hf,Tg,iS=(Tg=class{constructor(){pe(this,Ur,sS);pe(this,hf,!1)}setTimeoutProvider(e){re(this,Ur,e)}setTimeout(e,t){return b(this,Ur).setTimeout(e,t)}clearTimeout(e){b(this,Ur).clearTimeout(e)}setInterval(e,t){return b(this,Ur).setInterval(e,t)}clearInterval(e){b(this,Ur).clearInterval(e)}},Ur=new WeakMap,hf=new WeakMap,Tg),ks=new iS;function oS(e){setTimeout(e,0)}var Vs=typeof window>"u"||"Deno"in globalThis;function It(){}function lS(e,t){return typeof e=="function"?e(t):e}function Od(e){return typeof e=="number"&&e>=0&&e!==1/0}function tx(e,t){return Math.max(e+(t||0)-Date.now(),0)}function ls(e,t){return typeof e=="function"?e(t):e}function bn(e,t){return typeof e=="function"?e(t):e}function Gp(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(r){if(t.queryHash!==ah(o,t.options))return!1}else if(!al(t.queryKey,o))return!1}if(n!=="all"){const u=t.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function Jp(e,t){const{exact:n,status:r,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(Ws(t.options.mutationKey)!==Ws(i))return!1}else if(!al(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function ah(e,t){return((t==null?void 0:t.queryKeyHashFn)||Ws)(e)}function Ws(e){return JSON.stringify(e,(t,n)=>Ad(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function al(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>al(e[n],t[n])):!1}var aS=Object.prototype.hasOwnProperty;function nx(e,t){if(e===t)return e;const n=Zp(e)&&Zp(t);if(!n&&!(Ad(e)&&Ad(t)))return t;const s=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),o=i.length,l=n?new Array(o):{};let u=0;for(let d=0;d<o;d++){const f=n?d:i[d],h=e[f],p=t[f];if(h===p){l[f]=h,(n?d<s:aS.call(e,f))&&u++;continue}if(h===null||p===null||typeof h!="object"||typeof p!="object"){l[f]=p;continue}const S=nx(h,p);l[f]=S,S===h&&u++}return s===o&&u===s?e:l}function lu(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function Zp(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Ad(e){if(!em(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!em(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function em(e){return Object.prototype.toString.call(e)==="[object Object]"}function uS(e){return new Promise(t=>{ks.setTimeout(t,e)})}function Dd(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?nx(e,t):t}function cS(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function dS(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var uh=Symbol();function rx(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===uh?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function sx(e,t){return typeof e=="function"?e(...t):!!e}function fS(e,t,n){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=t()),r||(r=!0,s.aborted?n():s.addEventListener("abort",n,{once:!0})),s)}),e}var Ms,Hr,Li,Lg,hS=(Lg=class extends to{constructor(){super();pe(this,Ms);pe(this,Hr);pe(this,Li);re(this,Li,t=>{if(!Vs&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){b(this,Hr)||this.setEventListener(b(this,Li))}onUnsubscribe(){var t;this.hasListeners()||((t=b(this,Hr))==null||t.call(this),re(this,Hr,void 0))}setEventListener(t){var n;re(this,Li,t),(n=b(this,Hr))==null||n.call(this),re(this,Hr,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){b(this,Ms)!==t&&(re(this,Ms,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof b(this,Ms)=="boolean"?b(this,Ms):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Ms=new WeakMap,Hr=new WeakMap,Li=new WeakMap,Lg),ch=new hS;function zd(){let e,t;const n=new Promise((s,i)=>{e=s,t=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}var pS=oS;function mS(){let e=[],t=0,n=l=>{l()},r=l=>{l()},s=pS;const i=l=>{t?e.push(l):s(()=>{n(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{r(()=>{l.forEach(u=>{n(u)})})})};return{batch:l=>{let u;t++;try{u=l()}finally{t--,t||o()}return u},batchCalls:l=>(...u)=>{i(()=>{l(...u)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var it=mS(),_i,Vr,Ii,_g,gS=(_g=class extends to{constructor(){super();pe(this,_i,!0);pe(this,Vr);pe(this,Ii);re(this,Ii,t=>{if(!Vs&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){b(this,Vr)||this.setEventListener(b(this,Ii))}onUnsubscribe(){var t;this.hasListeners()||((t=b(this,Vr))==null||t.call(this),re(this,Vr,void 0))}setEventListener(t){var n;re(this,Ii,t),(n=b(this,Vr))==null||n.call(this),re(this,Vr,t(this.setOnline.bind(this)))}setOnline(t){b(this,_i)!==t&&(re(this,_i,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return b(this,_i)}},_i=new WeakMap,Vr=new WeakMap,Ii=new WeakMap,_g),au=new gS;function vS(e){return Math.min(1e3*2**e,3e4)}function ix(e){return(e??"online")==="online"?au.isOnline():!0}var $d=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function ox(e){let t=!1,n=0,r;const s=zd(),i=()=>s.status!=="pending",o=E=>{var j;if(!i()){const v=new $d(E);p(v),(j=e.onCancel)==null||j.call(e,v)}},l=()=>{t=!0},u=()=>{t=!1},d=()=>ch.isFocused()&&(e.networkMode==="always"||au.isOnline())&&e.canRun(),f=()=>ix(e.networkMode)&&e.canRun(),h=E=>{i()||(r==null||r(),s.resolve(E))},p=E=>{i()||(r==null||r(),s.reject(E))},S=()=>new Promise(E=>{var j;r=v=>{(i()||d())&&E(v)},(j=e.onPause)==null||j.call(e)}).then(()=>{var E;r=void 0,i()||(E=e.onContinue)==null||E.call(e)}),w=()=>{if(i())return;let E;const j=n===0?e.initialPromise:void 0;try{E=j??e.fn()}catch(v){E=Promise.reject(v)}Promise.resolve(E).then(h).catch(v=>{var R;if(i())return;const m=e.retry??(Vs?0:3),x=e.retryDelay??vS,y=typeof x=="function"?x(n,v):x,k=m===!0||typeof m=="number"&&n<m||typeof m=="function"&&m(n,v);if(t||!k){p(v);return}n++,(R=e.onFail)==null||R.call(e,n,v),uS(y).then(()=>d()?void 0:S()).then(()=>{t?p(v):w()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:l,continueRetry:u,canStart:f,start:()=>(f()?w():S().then(w),s)}}var Rs,Ig,lx=(Ig=class{constructor(){pe(this,Rs)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Od(this.gcTime)&&re(this,Rs,ks.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Vs?1/0:5*60*1e3))}clearGcTimeout(){b(this,Rs)&&(ks.clearTimeout(b(this,Rs)),re(this,Rs,void 0))}},Rs=new WeakMap,Ig),Ps,Fi,Sn,Ts,ct,fl,Ls,Fn,fr,Fg,yS=(Fg=class extends lx{constructor(t){super();pe(this,Fn);pe(this,Ps);pe(this,Fi);pe(this,Sn);pe(this,Ts);pe(this,ct);pe(this,fl);pe(this,Ls);re(this,Ls,!1),re(this,fl,t.defaultOptions),this.setOptions(t.options),this.observers=[],re(this,Ts,t.client),re(this,Sn,b(this,Ts).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,re(this,Ps,nm(this.options)),this.state=t.state??b(this,Ps),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=b(this,ct))==null?void 0:t.promise}setOptions(t){if(this.options={...b(this,fl),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=nm(this.options);n.data!==void 0&&(this.setState(tm(n.data,n.dataUpdatedAt)),re(this,Ps,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&b(this,Sn).remove(this)}setData(t,n){const r=Dd(this.state.data,t,this.options);return Ce(this,Fn,fr).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){Ce(this,Fn,fr).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=b(this,ct))==null?void 0:r.promise;return(s=b(this,ct))==null||s.cancel(t),n?n.then(It).catch(It):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(b(this,Ps))}isActive(){return this.observers.some(t=>bn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===uh||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ls(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!tx(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=b(this,ct))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=b(this,ct))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),b(this,Sn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(b(this,ct)&&(b(this,Ls)?b(this,ct).cancel({revert:!0}):b(this,ct).cancelRetry()),this.scheduleGc()),b(this,Sn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ce(this,Fn,fr).call(this,{type:"invalidate"})}async fetch(t,n){var u,d,f,h,p,S,w,E,j,v,m,x;if(this.state.fetchStatus!=="idle"&&((u=b(this,ct))==null?void 0:u.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(b(this,ct))return b(this,ct).continueRetry(),b(this,ct).promise}if(t&&this.setOptions(t),!this.options.queryFn){const y=this.observers.find(k=>k.options.queryFn);y&&this.setOptions(y.options)}const r=new AbortController,s=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(re(this,Ls,!0),r.signal)})},i=()=>{const y=rx(this.options,n),R=(()=>{const M={client:b(this,Ts),queryKey:this.queryKey,meta:this.meta};return s(M),M})();return re(this,Ls,!1),this.options.persister?this.options.persister(y,R,this):y(R)},l=(()=>{const y={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:b(this,Ts),state:this.state,fetchFn:i};return s(y),y})();(d=this.options.behavior)==null||d.onFetch(l,this),re(this,Fi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&Ce(this,Fn,fr).call(this,{type:"fetch",meta:(h=l.fetchOptions)==null?void 0:h.meta}),re(this,ct,ox({initialPromise:n==null?void 0:n.initialPromise,fn:l.fetchFn,onCancel:y=>{y instanceof $d&&y.revert&&this.setState({...b(this,Fi),fetchStatus:"idle"}),r.abort()},onFail:(y,k)=>{Ce(this,Fn,fr).call(this,{type:"failed",failureCount:y,error:k})},onPause:()=>{Ce(this,Fn,fr).call(this,{type:"pause"})},onContinue:()=>{Ce(this,Fn,fr).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const y=await b(this,ct).start();if(y===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(y),(S=(p=b(this,Sn).config).onSuccess)==null||S.call(p,y,this),(E=(w=b(this,Sn).config).onSettled)==null||E.call(w,y,this.state.error,this),y}catch(y){if(y instanceof $d){if(y.silent)return b(this,ct).promise;if(y.revert){if(this.state.data===void 0)throw y;return this.state.data}}throw Ce(this,Fn,fr).call(this,{type:"error",error:y}),(v=(j=b(this,Sn).config).onError)==null||v.call(j,y,this),(x=(m=b(this,Sn).config).onSettled)==null||x.call(m,this.state.data,y,this),y}finally{this.scheduleGc()}}},Ps=new WeakMap,Fi=new WeakMap,Sn=new WeakMap,Ts=new WeakMap,ct=new WeakMap,fl=new WeakMap,Ls=new WeakMap,Fn=new WeakSet,fr=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...ax(r.data,this.options),fetchMeta:t.meta??null};case"success":const s={...r,...tm(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return re(this,Fi,t.manual?s:void 0),s;case"error":const i=t.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),it.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),b(this,Sn).notify({query:this,type:"updated",action:t})})},Fg);function ax(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ix(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function tm(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function nm(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Ht,Me,hl,Tt,_s,Oi,mr,Wr,pl,Ai,Di,Is,Fs,Qr,zi,_e,To,Bd,Ud,Hd,Vd,Wd,Qd,Kd,ux,Og,xS=(Og=class extends to{constructor(t,n){super();pe(this,_e);pe(this,Ht);pe(this,Me);pe(this,hl);pe(this,Tt);pe(this,_s);pe(this,Oi);pe(this,mr);pe(this,Wr);pe(this,pl);pe(this,Ai);pe(this,Di);pe(this,Is);pe(this,Fs);pe(this,Qr);pe(this,zi,new Set);this.options=n,re(this,Ht,t),re(this,Wr,null),re(this,mr,zd()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(b(this,Me).addObserver(this),rm(b(this,Me),this.options)?Ce(this,_e,To).call(this):this.updateResult(),Ce(this,_e,Vd).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Yd(b(this,Me),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Yd(b(this,Me),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ce(this,_e,Wd).call(this),Ce(this,_e,Qd).call(this),b(this,Me).removeObserver(this)}setOptions(t){const n=this.options,r=b(this,Me);if(this.options=b(this,Ht).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof bn(this.options.enabled,b(this,Me))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ce(this,_e,Kd).call(this),b(this,Me).setOptions(this.options),n._defaulted&&!lu(this.options,n)&&b(this,Ht).getQueryCache().notify({type:"observerOptionsUpdated",query:b(this,Me),observer:this});const s=this.hasListeners();s&&sm(b(this,Me),r,this.options,n)&&Ce(this,_e,To).call(this),this.updateResult(),s&&(b(this,Me)!==r||bn(this.options.enabled,b(this,Me))!==bn(n.enabled,b(this,Me))||ls(this.options.staleTime,b(this,Me))!==ls(n.staleTime,b(this,Me)))&&Ce(this,_e,Bd).call(this);const i=Ce(this,_e,Ud).call(this);s&&(b(this,Me)!==r||bn(this.options.enabled,b(this,Me))!==bn(n.enabled,b(this,Me))||i!==b(this,Qr))&&Ce(this,_e,Hd).call(this,i)}getOptimisticResult(t){const n=b(this,Ht).getQueryCache().build(b(this,Ht),t),r=this.createResult(n,t);return SS(this,r)&&(re(this,Tt,r),re(this,Oi,this.options),re(this,_s,b(this,Me).state)),r}getCurrentResult(){return b(this,Tt)}trackResult(t,n){return new Proxy(t,{get:(r,s)=>(this.trackProp(s),n==null||n(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&b(this,mr).status==="pending"&&b(this,mr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(t){b(this,zi).add(t)}getCurrentQuery(){return b(this,Me)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=b(this,Ht).defaultQueryOptions(t),r=b(this,Ht).getQueryCache().build(b(this,Ht),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return Ce(this,_e,To).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),b(this,Tt)))}createResult(t,n){var O;const r=b(this,Me),s=this.options,i=b(this,Tt),o=b(this,_s),l=b(this,Oi),d=t!==r?t.state:b(this,hl),{state:f}=t;let h={...f},p=!1,S;if(n._optimisticResults){const T=this.hasListeners(),X=!T&&rm(t,n),J=T&&sm(t,r,n,s);(X||J)&&(h={...h,...ax(f.data,t.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:w,errorUpdatedAt:E,status:j}=h;S=h.data;let v=!1;if(n.placeholderData!==void 0&&S===void 0&&j==="pending"){let T;i!=null&&i.isPlaceholderData&&n.placeholderData===(l==null?void 0:l.placeholderData)?(T=i.data,v=!0):T=typeof n.placeholderData=="function"?n.placeholderData((O=b(this,Di))==null?void 0:O.state.data,b(this,Di)):n.placeholderData,T!==void 0&&(j="success",S=Dd(i==null?void 0:i.data,T,n),p=!0)}if(n.select&&S!==void 0&&!v)if(i&&S===(o==null?void 0:o.data)&&n.select===b(this,pl))S=b(this,Ai);else try{re(this,pl,n.select),S=n.select(S),S=Dd(i==null?void 0:i.data,S,n),re(this,Ai,S),re(this,Wr,null)}catch(T){re(this,Wr,T)}b(this,Wr)&&(w=b(this,Wr),S=b(this,Ai),E=Date.now(),j="error");const m=h.fetchStatus==="fetching",x=j==="pending",y=j==="error",k=x&&m,R=S!==void 0,N={status:j,fetchStatus:h.fetchStatus,isPending:x,isSuccess:j==="success",isError:y,isInitialLoading:k,isLoading:k,data:S,dataUpdatedAt:h.dataUpdatedAt,error:w,errorUpdatedAt:E,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>d.dataUpdateCount||h.errorUpdateCount>d.errorUpdateCount,isFetching:m,isRefetching:m&&!x,isLoadingError:y&&!R,isPaused:h.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:y&&R,isStale:dh(t,n),refetch:this.refetch,promise:b(this,mr),isEnabled:bn(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const T=z=>{N.status==="error"?z.reject(N.error):N.data!==void 0&&z.resolve(N.data)},X=()=>{const z=re(this,mr,N.promise=zd());T(z)},J=b(this,mr);switch(J.status){case"pending":t.queryHash===r.queryHash&&T(J);break;case"fulfilled":(N.status==="error"||N.data!==J.value)&&X();break;case"rejected":(N.status!=="error"||N.error!==J.reason)&&X();break}}return N}updateResult(){const t=b(this,Tt),n=this.createResult(b(this,Me),this.options);if(re(this,_s,b(this,Me).state),re(this,Oi,this.options),b(this,_s).data!==void 0&&re(this,Di,b(this,Me)),lu(n,t))return;re(this,Tt,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!b(this,zi).size)return!0;const o=new Set(i??b(this,zi));return this.options.throwOnError&&o.add("error"),Object.keys(b(this,Tt)).some(l=>{const u=l;return b(this,Tt)[u]!==t[u]&&o.has(u)})};Ce(this,_e,ux).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ce(this,_e,Vd).call(this)}},Ht=new WeakMap,Me=new WeakMap,hl=new WeakMap,Tt=new WeakMap,_s=new WeakMap,Oi=new WeakMap,mr=new WeakMap,Wr=new WeakMap,pl=new WeakMap,Ai=new WeakMap,Di=new WeakMap,Is=new WeakMap,Fs=new WeakMap,Qr=new WeakMap,zi=new WeakMap,_e=new WeakSet,To=function(t){Ce(this,_e,Kd).call(this);let n=b(this,Me).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(It)),n},Bd=function(){Ce(this,_e,Wd).call(this);const t=ls(this.options.staleTime,b(this,Me));if(Vs||b(this,Tt).isStale||!Od(t))return;const r=tx(b(this,Tt).dataUpdatedAt,t)+1;re(this,Is,ks.setTimeout(()=>{b(this,Tt).isStale||this.updateResult()},r))},Ud=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(b(this,Me)):this.options.refetchInterval)??!1},Hd=function(t){Ce(this,_e,Qd).call(this),re(this,Qr,t),!(Vs||bn(this.options.enabled,b(this,Me))===!1||!Od(b(this,Qr))||b(this,Qr)===0)&&re(this,Fs,ks.setInterval(()=>{(this.options.refetchIntervalInBackground||ch.isFocused())&&Ce(this,_e,To).call(this)},b(this,Qr)))},Vd=function(){Ce(this,_e,Bd).call(this),Ce(this,_e,Hd).call(this,Ce(this,_e,Ud).call(this))},Wd=function(){b(this,Is)&&(ks.clearTimeout(b(this,Is)),re(this,Is,void 0))},Qd=function(){b(this,Fs)&&(ks.clearInterval(b(this,Fs)),re(this,Fs,void 0))},Kd=function(){const t=b(this,Ht).getQueryCache().build(b(this,Ht),this.options);if(t===b(this,Me))return;const n=b(this,Me);re(this,Me,t),re(this,hl,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},ux=function(t){it.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(b(this,Tt))}),b(this,Ht).getQueryCache().notify({query:b(this,Me),type:"observerResultsUpdated"})})},Og);function wS(e,t){return bn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function rm(e,t){return wS(e,t)||e.state.data!==void 0&&Yd(e,t,t.refetchOnMount)}function Yd(e,t,n){if(bn(t.enabled,e)!==!1&&ls(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&dh(e,t)}return!1}function sm(e,t,n,r){return(e!==t||bn(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&dh(e,n)}function dh(e,t){return bn(t.enabled,e)!==!1&&e.isStaleByTime(ls(t.staleTime,e))}function SS(e,t){return!lu(e.getCurrentResult(),t)}function im(e){return{onFetch:(t,n)=>{var f,h,p,S,w;const r=t.options,s=(p=(h=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:h.fetchMore)==null?void 0:p.direction,i=((S=t.state.data)==null?void 0:S.pages)||[],o=((w=t.state.data)==null?void 0:w.pageParams)||[];let l={pages:[],pageParams:[]},u=0;const d=async()=>{let E=!1;const j=x=>{fS(x,()=>t.signal,()=>E=!0)},v=rx(t.options,t.fetchOptions),m=async(x,y,k)=>{if(E)return Promise.reject();if(y==null&&x.pages.length)return Promise.resolve(x);const M=(()=>{const X={client:t.client,queryKey:t.queryKey,pageParam:y,direction:k?"backward":"forward",meta:t.options.meta};return j(X),X})(),N=await v(M),{maxPages:O}=t.options,T=k?dS:cS;return{pages:T(x.pages,N,O),pageParams:T(x.pageParams,y,O)}};if(s&&i.length){const x=s==="backward",y=x?bS:om,k={pages:i,pageParams:o},R=y(r,k);l=await m(k,R,x)}else{const x=e??i.length;do{const y=u===0?o[0]??r.initialPageParam:om(r,l);if(u>0&&y==null)break;l=await m(l,y),u++}while(u<x)}return l};t.options.persister?t.fetchFn=()=>{var E,j;return(j=(E=t.options).persister)==null?void 0:j.call(E,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=d}}}function om(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function bS(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var ml,tr,Lt,Os,nr,Ar,Ag,CS=(Ag=class extends lx{constructor(t){super();pe(this,nr);pe(this,ml);pe(this,tr);pe(this,Lt);pe(this,Os);re(this,ml,t.client),this.mutationId=t.mutationId,re(this,Lt,t.mutationCache),re(this,tr,[]),this.state=t.state||cx(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){b(this,tr).includes(t)||(b(this,tr).push(t),this.clearGcTimeout(),b(this,Lt).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){re(this,tr,b(this,tr).filter(n=>n!==t)),this.scheduleGc(),b(this,Lt).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){b(this,tr).length||(this.state.status==="pending"?this.scheduleGc():b(this,Lt).remove(this))}continue(){var t;return((t=b(this,Os))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,u,d,f,h,p,S,w,E,j,v,m,x,y,k,R,M,N,O;const n=()=>{Ce(this,nr,Ar).call(this,{type:"continue"})},r={client:b(this,ml),meta:this.options.meta,mutationKey:this.options.mutationKey};re(this,Os,ox({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(T,X)=>{Ce(this,nr,Ar).call(this,{type:"failed",failureCount:T,error:X})},onPause:()=>{Ce(this,nr,Ar).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>b(this,Lt).canRun(this)}));const s=this.state.status==="pending",i=!b(this,Os).canStart();try{if(s)n();else{Ce(this,nr,Ar).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(o=b(this,Lt).config).onMutate)==null?void 0:l.call(o,t,this,r));const X=await((d=(u=this.options).onMutate)==null?void 0:d.call(u,t,r));X!==this.state.context&&Ce(this,nr,Ar).call(this,{type:"pending",context:X,variables:t,isPaused:i})}const T=await b(this,Os).start();return await((h=(f=b(this,Lt).config).onSuccess)==null?void 0:h.call(f,T,t,this.state.context,this,r)),await((S=(p=this.options).onSuccess)==null?void 0:S.call(p,T,t,this.state.context,r)),await((E=(w=b(this,Lt).config).onSettled)==null?void 0:E.call(w,T,null,this.state.variables,this.state.context,this,r)),await((v=(j=this.options).onSettled)==null?void 0:v.call(j,T,null,t,this.state.context,r)),Ce(this,nr,Ar).call(this,{type:"success",data:T}),T}catch(T){try{await((x=(m=b(this,Lt).config).onError)==null?void 0:x.call(m,T,t,this.state.context,this,r))}catch(X){Promise.reject(X)}try{await((k=(y=this.options).onError)==null?void 0:k.call(y,T,t,this.state.context,r))}catch(X){Promise.reject(X)}try{await((M=(R=b(this,Lt).config).onSettled)==null?void 0:M.call(R,void 0,T,this.state.variables,this.state.context,this,r))}catch(X){Promise.reject(X)}try{await((O=(N=this.options).onSettled)==null?void 0:O.call(N,void 0,T,t,this.state.context,r))}catch(X){Promise.reject(X)}throw Ce(this,nr,Ar).call(this,{type:"error",error:T}),T}finally{b(this,Lt).runNext(this)}}},ml=new WeakMap,tr=new WeakMap,Lt=new WeakMap,Os=new WeakMap,nr=new WeakSet,Ar=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),it.batch(()=>{b(this,tr).forEach(r=>{r.onMutationUpdate(t)}),b(this,Lt).notify({mutation:this,type:"updated",action:t})})},Ag);function cx(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var gr,On,gl,Dg,kS=(Dg=class extends to{constructor(t={}){super();pe(this,gr);pe(this,On);pe(this,gl);this.config=t,re(this,gr,new Set),re(this,On,new Map),re(this,gl,0)}build(t,n,r){const s=new CS({client:t,mutationCache:this,mutationId:++Wl(this,gl)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){b(this,gr).add(t);const n=ua(t);if(typeof n=="string"){const r=b(this,On).get(n);r?r.push(t):b(this,On).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(b(this,gr).delete(t)){const n=ua(t);if(typeof n=="string"){const r=b(this,On).get(n);if(r)if(r.length>1){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}else r[0]===t&&b(this,On).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=ua(t);if(typeof n=="string"){const r=b(this,On).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var r;const n=ua(t);if(typeof n=="string"){const s=(r=b(this,On).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){it.batch(()=>{b(this,gr).forEach(t=>{this.notify({type:"removed",mutation:t})}),b(this,gr).clear(),b(this,On).clear()})}getAll(){return Array.from(b(this,gr))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Jp(n,r))}findAll(t={}){return this.getAll().filter(n=>Jp(t,n))}notify(t){it.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return it.batch(()=>Promise.all(t.map(n=>n.continue().catch(It))))}},gr=new WeakMap,On=new WeakMap,gl=new WeakMap,Dg);function ua(e){var t;return(t=e.options.scope)==null?void 0:t.id}var vr,Kr,Vt,yr,Cr,Ra,Xd,zg,ES=(zg=class extends to{constructor(n,r){super();pe(this,Cr);pe(this,vr);pe(this,Kr);pe(this,Vt);pe(this,yr);re(this,vr,n),this.setOptions(r),this.bindMethods(),Ce(this,Cr,Ra).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var s;const r=this.options;this.options=b(this,vr).defaultMutationOptions(n),lu(this.options,r)||b(this,vr).getMutationCache().notify({type:"observerOptionsUpdated",mutation:b(this,Vt),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Ws(r.mutationKey)!==Ws(this.options.mutationKey)?this.reset():((s=b(this,Vt))==null?void 0:s.state.status)==="pending"&&b(this,Vt).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=b(this,Vt))==null||n.removeObserver(this)}onMutationUpdate(n){Ce(this,Cr,Ra).call(this),Ce(this,Cr,Xd).call(this,n)}getCurrentResult(){return b(this,Kr)}reset(){var n;(n=b(this,Vt))==null||n.removeObserver(this),re(this,Vt,void 0),Ce(this,Cr,Ra).call(this),Ce(this,Cr,Xd).call(this)}mutate(n,r){var s;return re(this,yr,r),(s=b(this,Vt))==null||s.removeObserver(this),re(this,Vt,b(this,vr).getMutationCache().build(b(this,vr),this.options)),b(this,Vt).addObserver(this),b(this,Vt).execute(n)}},vr=new WeakMap,Kr=new WeakMap,Vt=new WeakMap,yr=new WeakMap,Cr=new WeakSet,Ra=function(){var r;const n=((r=b(this,Vt))==null?void 0:r.state)??cx();re(this,Kr,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Xd=function(n){it.batch(()=>{var r,s,i,o,l,u,d,f;if(b(this,yr)&&this.hasListeners()){const h=b(this,Kr).variables,p=b(this,Kr).context,S={client:b(this,vr),meta:this.options.meta,mutationKey:this.options.mutationKey};if((n==null?void 0:n.type)==="success"){try{(s=(r=b(this,yr)).onSuccess)==null||s.call(r,n.data,h,p,S)}catch(w){Promise.reject(w)}try{(o=(i=b(this,yr)).onSettled)==null||o.call(i,n.data,null,h,p,S)}catch(w){Promise.reject(w)}}else if((n==null?void 0:n.type)==="error"){try{(u=(l=b(this,yr)).onError)==null||u.call(l,n.error,h,p,S)}catch(w){Promise.reject(w)}try{(f=(d=b(this,yr)).onSettled)==null||f.call(d,void 0,n.error,h,p,S)}catch(w){Promise.reject(w)}}}this.listeners.forEach(h=>{h(b(this,Kr))})})},zg),rr,$g,NS=($g=class extends to{constructor(t={}){super();pe(this,rr);this.config=t,re(this,rr,new Map)}build(t,n,r){const s=n.queryKey,i=n.queryHash??ah(s,n);let o=this.get(i);return o||(o=new yS({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){b(this,rr).has(t.queryHash)||(b(this,rr).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=b(this,rr).get(t.queryHash);n&&(t.destroy(),n===t&&b(this,rr).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){it.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return b(this,rr).get(t)}getAll(){return[...b(this,rr).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Gp(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>Gp(t,r)):n}notify(t){it.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){it.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){it.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},rr=new WeakMap,$g),Ye,Yr,Xr,$i,Bi,qr,Ui,Hi,Bg,jS=(Bg=class{constructor(e={}){pe(this,Ye);pe(this,Yr);pe(this,Xr);pe(this,$i);pe(this,Bi);pe(this,qr);pe(this,Ui);pe(this,Hi);re(this,Ye,e.queryCache||new NS),re(this,Yr,e.mutationCache||new kS),re(this,Xr,e.defaultOptions||{}),re(this,$i,new Map),re(this,Bi,new Map),re(this,qr,0)}mount(){Wl(this,qr)._++,b(this,qr)===1&&(re(this,Ui,ch.subscribe(async e=>{e&&(await this.resumePausedMutations(),b(this,Ye).onFocus())})),re(this,Hi,au.subscribe(async e=>{e&&(await this.resumePausedMutations(),b(this,Ye).onOnline())})))}unmount(){var e,t;Wl(this,qr)._--,b(this,qr)===0&&((e=b(this,Ui))==null||e.call(this),re(this,Ui,void 0),(t=b(this,Hi))==null||t.call(this),re(this,Hi,void 0))}isFetching(e){return b(this,Ye).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return b(this,Yr).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=b(this,Ye).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=b(this,Ye).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(ls(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return b(this,Ye).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=b(this,Ye).get(r.queryHash),i=s==null?void 0:s.state.data,o=lS(t,i);if(o!==void 0)return b(this,Ye).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return it.batch(()=>b(this,Ye).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=b(this,Ye).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=b(this,Ye);it.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=b(this,Ye);return it.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=it.batch(()=>b(this,Ye).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(It).catch(It)}invalidateQueries(e,t={}){return it.batch(()=>(b(this,Ye).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=it.batch(()=>b(this,Ye).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(It)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(It)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=b(this,Ye).build(this,t);return n.isStaleByTime(ls(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(It).catch(It)}fetchInfiniteQuery(e){return e.behavior=im(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(It).catch(It)}ensureInfiniteQueryData(e){return e.behavior=im(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return au.isOnline()?b(this,Yr).resumePausedMutations():Promise.resolve()}getQueryCache(){return b(this,Ye)}getMutationCache(){return b(this,Yr)}getDefaultOptions(){return b(this,Xr)}setDefaultOptions(e){re(this,Xr,e)}setQueryDefaults(e,t){b(this,$i).set(Ws(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...b(this,$i).values()],n={};return t.forEach(r=>{al(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){b(this,Bi).set(Ws(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...b(this,Bi).values()],n={};return t.forEach(r=>{al(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...b(this,Xr).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=ah(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===uh&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...b(this,Xr).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){b(this,Ye).clear(),b(this,Yr).clear()}},Ye=new WeakMap,Yr=new WeakMap,Xr=new WeakMap,$i=new WeakMap,Bi=new WeakMap,qr=new WeakMap,Ui=new WeakMap,Hi=new WeakMap,Bg),dx=c.createContext(void 0),Ys=e=>{const t=c.useContext(dx);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},MS=({client:e,children:t})=>(c.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(dx.Provider,{value:e,children:t})),fx=c.createContext(!1),RS=()=>c.useContext(fx);fx.Provider;function PS(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var TS=c.createContext(PS()),LS=()=>c.useContext(TS),_S=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},IS=e=>{c.useEffect(()=>{e.clearReset()},[e])},FS=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||sx(n,[e.error,r])),OS=e=>{if(e.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},AS=(e,t)=>e.isLoading&&e.isFetching&&!t,DS=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,lm=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function zS(e,t,n){var h,p,S,w,E;const r=RS(),s=LS(),i=Ys(),o=i.defaultQueryOptions(e);(p=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||p.call(h,o),o._optimisticResults=r?"isRestoring":"optimistic",OS(o),_S(o,s),IS(s);const l=!i.getQueryCache().get(o.queryHash),[u]=c.useState(()=>new t(i,o)),d=u.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(c.useSyncExternalStore(c.useCallback(j=>{const v=f?u.subscribe(it.batchCalls(j)):It;return u.updateResult(),v},[u,f]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),c.useEffect(()=>{u.setOptions(o)},[o,u]),DS(o,d))throw lm(o,u,s);if(FS({result:d,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((w=(S=i.getDefaultOptions().queries)==null?void 0:S._experimental_afterQuery)==null||w.call(S,o,d),o.experimental_prefetchInRender&&!Vs&&AS(d,r)){const j=l?lm(o,u,s):(E=i.getQueryCache().get(o.queryHash))==null?void 0:E.promise;j==null||j.catch(It).finally(()=>{u.updateResult()})}return o.notifyOnChangeProps?d:u.trackResult(d)}function Iu(e,t){return zS(e,xS)}function $S(e,t){const n=Ys(),[r]=c.useState(()=>new ES(n,e));c.useEffect(()=>{r.setOptions(e)},[r,e]);const s=c.useSyncExternalStore(c.useCallback(o=>r.subscribe(it.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=c.useCallback((o,l)=>{r.mutate(o,l).catch(It)},[r]);if(s.error&&sx(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}const hx=8,BS=6;function am(e,t,n){return n<t?t:Math.min(n,Math.max(t,e))}function px({x:e,y:t,menuWidth:n,menuHeight:r,viewport:s,margin:i=hx}){const o=i,l=i,u=s.width-Math.max(0,n)-i,d=s.height-Math.max(0,r)-i;return{x:am(e,o,u),y:am(t,l,d)}}function US({anchorRect:e,menuSize:t,viewport:n,align:r="left",margin:s=hx,sideOffset:i=BS}){const o=r==="right"?e.right-t.width:e.left,l=e.bottom+i,u=e.top-t.height-i,d=l+t.height+s<=n.height,f=u>=s;return px({x:o,y:!d&&f?u:l,menuWidth:t.width,menuHeight:t.height,viewport:n,margin:s})}function mx(){return typeof window>"u"?{width:1024,height:768}:{width:window.innerWidth,height:window.innerHeight}}function um(e){return e.length>0&&"options"in e[0]}function cm(){return{x:0,y:0,ready:!1}}function fh({value:e,onChange:t,options:n,placeholder:r="Select...",trigger:s,triggerClassName:i="",panelClassName:o="",align:l="left",width:u="auto",showChevron:d=!0,title:f,disabled:h=!1,"aria-label":p}){var z,ae;const[S,w]=c.useState(!1),E=c.useRef(null),j=c.useRef(null),v=c.useRef(null),[m,x]=c.useState(cm),k=c.useCallback(()=>{const K=A=>{const _=A.find(P=>P.value===e);return _?_.label:null};if(um(n))for(const A of n){const _=K(A.options);if(_)return _}else{const A=K(n);if(A)return A}return r},[e,n,r])(),R=((z=E.current)==null?void 0:z.getBoundingClientRect().width)??((ae=j.current)==null?void 0:ae.offsetWidth)??0,M=u==="trigger"?R:u==="auto"?void 0:u,N=c.useCallback(()=>{if(!S)return;const K=E.current,A=v.current;if(!K||!A)return;const _=K.getBoundingClientRect(),P=A.getBoundingClientRect(),D=M??P.width??180,H=P.height||A.scrollHeight||1,te=US({anchorRect:_,menuSize:{width:D,height:H},viewport:mx(),align:l});x(se=>se.x===te.x&&se.y===te.y&&se.ready?se:{x:te.x,y:te.y,ready:!0})},[l,M,S]);c.useLayoutEffect(()=>{if(!S){x(cm());return}N()},[S,N,n,e]),c.useEffect(()=>{if(!S)return;const K=P=>{var H,te;const D=P.target;(H=E.current)!=null&&H.contains(D)||(te=v.current)!=null&&te.contains(D)||w(!1)},A=P=>{var D;P.key==="Escape"&&(w(!1),(D=j.current)==null||D.focus())},_=()=>N();return window.addEventListener("click",K),window.addEventListener("keydown",A),window.addEventListener("resize",_),window.addEventListener("scroll",_,!0),()=>{window.removeEventListener("click",K),window.removeEventListener("keydown",A),window.removeEventListener("resize",_),window.removeEventListener("scroll",_,!0)}},[S,N]);const O=K=>{var A;t(K),w(!1),(A=j.current)==null||A.focus()},T=K=>K.map(A=>a.jsxs("button",{className:"dropdown-item","data-active":A.value===e,disabled:A.disabled,onClick:()=>!A.disabled&&O(A.value),role:"menuitem",children:[A.icon&&a.jsx("span",{className:"shrink-0",children:A.icon}),a.jsx("span",{className:"flex-1 truncate",children:A.label}),A.value===e&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0 text-accent",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})]},A.value)),X=c.useMemo(()=>({position:"fixed",left:m.x,top:m.y,visibility:m.ready?"visible":"hidden",...M?{width:M,minWidth:M}:{}}),[M,m]),J=S?a.jsx("div",{ref:v,className:`dropdown-panel ${o}`,style:X,role:"listbox","aria-label":p,children:um(n)?n.map((K,A)=>a.jsxs("div",{children:[K.label&&a.jsx("div",{className:"dropdown-label",children:K.label}),T(K.options),A<n.length-1&&a.jsx("div",{className:"dropdown-divider"})]},K.label||A)):T(n)}):null;return a.jsxs("div",{ref:E,className:"relative",children:[s?a.jsx("div",{onClick:()=>!h&&w(K=>!K),children:s}):a.jsxs("button",{ref:j,type:"button",className:`dropdown-trigger ${i}`,onClick:()=>w(K=>!K),disabled:h,title:f,"aria-label":p,"aria-haspopup":"listbox","aria-expanded":S,children:[a.jsx("span",{className:"truncate",children:k}),d&&a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`shrink-0 opacity-60 transition-transform ${S?"rotate-180":""}`,children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),J&&typeof document<"u"?_u.createPortal(J,document.body):J]})}const HS={offline:"sync-dot-offline",unstable:"sync-dot-unstable",recent:"sync-dot-recent",editing:"sync-dot-editing",live:"sync-dot-live"};function VS({state:e,presence:t,syncLabel:n,connectionLabel:r,lastEditedLabel:s,hasEdits:i,localTypingActive:o,recentTouches:l,isNarrow:u}){const[d,f]=c.useState(!1),[h,p]=c.useState(null),S=c.useRef(null),w=c.useRef(null),E=c.useRef(null),j=t?`${t.viewing} viewing  ${t.editing} editing`:"- viewing  - editing",v=t?String(t.viewing):"-",m=c.useCallback(()=>{E.current&&(window.clearTimeout(E.current),E.current=null)},[]),x=c.useCallback((k,R)=>{var M;R&&((M=navigator.clipboard)==null||M.writeText(R).then(()=>{p(k),m(),E.current=window.setTimeout(()=>{p(N=>N===k?null:N)},1e3)}).catch(()=>{}))},[m]),y=c.useCallback(()=>{f(!1),window.requestAnimationFrame(()=>{var k;return(k=w.current)==null?void 0:k.focus()})},[]);return c.useEffect(()=>{if(!d)return;const k=M=>{!S.current||S.current.contains(M.target)||y()},R=M=>{M.key==="Escape"&&y()};return window.addEventListener("mousedown",k),window.addEventListener("keydown",R),()=>{window.removeEventListener("mousedown",k),window.removeEventListener("keydown",R)}},[d,y]),c.useEffect(()=>()=>{m()},[m]),a.jsxs("div",{ref:S,className:"sync-indicator",children:[a.jsxs("button",{ref:w,type:"button",className:"sync-indicator-button",onClick:()=>d?y():f(!0),"aria-haspopup":"dialog","aria-expanded":d,"aria-label":"Sync status",title:j,children:[a.jsx("span",{className:`sync-indicator-dot ${HS[e]}`,"aria-hidden":"true"}),!u&&a.jsx("span",{className:"sync-indicator-count tabular-nums",children:v}),!u&&o&&a.jsx("span",{className:"sync-indicator-local",children:"typing"})]}),d&&a.jsxs("div",{role:"dialog","aria-label":"Sync status",className:"sync-indicator-card select-text",children:[a.jsx("div",{className:"sync-indicator-line sync-indicator-primary",children:n}),a.jsx("div",{className:"sync-indicator-line",children:r}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:j}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:i?`Last edited: ${s}`:"No edits yet."}),o&&a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:"Local typing in progress (saved on blur)."}),a.jsxs("div",{className:"sync-indicator-section",children:[a.jsx("div",{className:"sync-indicator-section-title",children:"Recently touched files"}),l.length>0?a.jsx("div",{className:"sync-indicator-list",children:l.map(k=>a.jsxs("div",{className:"sync-indicator-item",children:[a.jsx("button",{type:"button",className:"sync-indicator-item-name",title:`Copy filename: ${k.label}`,onClick:()=>x(k.path,k.label),children:k.label}),a.jsx("span",{className:"sync-indicator-item-time tabular-nums",children:h===k.path?"Copied":k.timeLabel})]},k.path))}):a.jsx("div",{className:"sync-indicator-empty",children:"No recent touches."})]})]})]})}const as={phoneMax:480,mobileMax:767,narrowMax:900,tabletMax:1024,mediumMax:1180},Pa={phone:`(max-width: ${as.phoneMax}px)`,narrow:`(max-width: ${as.narrowMax}px)`,toolbarCompact:`(max-width: ${as.mediumMax}px)`},dm=200,fm=240,WS=320,QS=360,KS=420;function hm(e,t,n){return Math.min(Math.max(e,t),n)}function YS(e){return e<=as.tabletMax?WS:e<=as.mediumMax?QS:KS}function XS(e){return e<=as.tabletMax?360:e<=as.mediumMax?420:520}function qS({viewportWidth:e,leftOpen:t,rightOpen:n,leftWidth:r,rightWidth:s}){const i=YS(e);let o=t?hm(r,dm,i):0,l=n?hm(s,fm,i):0;const u=Math.max(0,e-XS(e));if(o+l>u){let d=o+l-u;if(l>0){const f=Math.max(0,l-fm),h=Math.min(f,d);l-=h,d-=h}if(d>0&&o>0){const f=Math.max(0,o-dm),h=Math.min(f,d);o-=h,d-=h}d>0&&l>0&&(l=Math.max(0,u-o)),o+l>u&&(o=Math.max(0,u-l))}return{leftWidth:Number(o.toFixed(2)),rightWidth:Number(l.toFixed(2))}}function Ta(e,t=!1){const[n,r]=c.useState(t);return c.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;const s=window.matchMedia(e),i=s,o=()=>r(s.matches);if(o(),typeof s.addEventListener=="function")return s.addEventListener("change",o),()=>s.removeEventListener("change",o);if(typeof i.addListener=="function"&&typeof i.removeListener=="function")return i.addListener(o),()=>{var l;return(l=i.removeListener)==null?void 0:l.call(i,o)}},[e]),n}function gx({isRandom:e,dir:t}){return e?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),a.jsx("path",{d:"M21 3v5h-5"})]}):t==="desc"?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 5v14"}),a.jsx("path",{d:"M19 12l-7 7-7-7"})]}):a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 19V5"}),a.jsx("path",{d:"M5 12l7-7 7 7"})]})}function GS({viewerActive:e,filtersOpen:t,filtersRef:n,totalFilterCount:r,filterCount:s,starFilterList:i,starCounts:o,onToggleFilters:l,onOpenFilters:u,onToggleStar:d,onClearFilters:f,onClearStars:h}){return a.jsxs("div",{ref:n,className:`toolbar-filter relative ${e?"opacity-40 pointer-events-none":""}`,children:[a.jsxs("button",{className:`btn ${r>0?"btn-active":""}`,onClick:l,"aria-haspopup":"dialog","aria-expanded":t,title:"Filters","aria-disabled":e,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),a.jsx("span",{className:"toolbar-filters-label",children:"Filters"}),r>0&&a.jsx("span",{className:"toolbar-filters-count px-1.5 py-0.5 text-[11px] rounded-full bg-accent-strong text-text",children:r})]}),t&&a.jsxs("div",{role:"dialog","aria-label":"Filters",className:"dropdown-panel w-[240px]",style:{top:"38px",left:0},children:[a.jsx("div",{className:"dropdown-label",children:"Rating"}),a.jsxs("div",{className:"px-1",children:[[5,4,3,2,1].map(p=>{const S=i.includes(p),w=(o==null?void 0:o[String(p)])??0;return a.jsxs("button",{onClick:()=>d==null?void 0:d(p),className:`dropdown-item justify-between ${S?"bg-accent-muted":""}`,children:[a.jsxs("span",{className:S?"text-star-active":"text-text",children:["".repeat(p),"".repeat(5-p)]}),a.jsx("span",{className:"text-xs text-muted",children:w})]},p)}),a.jsxs("button",{onClick:()=>d==null?void 0:d(0),className:`dropdown-item justify-between ${i.includes(0)?"bg-accent-muted":""}`,children:[a.jsx("span",{className:"text-text",children:"Unrated"}),a.jsx("span",{className:"text-xs text-muted",children:(o==null?void 0:o["0"])??0})]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("div",{className:"dropdown-label",children:"Metrics"}),a.jsxs("button",{className:"dropdown-item",onClick:()=>{l(),u==null||u()},children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]}),a.jsx("span",{children:"Open Metrics Panel"}),(s||0)>0&&a.jsxs("span",{className:"ml-auto text-xs text-muted",children:[s," active"]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("button",{className:"dropdown-item text-muted hover:text-text",onClick:()=>{f?f():h==null||h()},disabled:r===0,children:"Clear all filters"})]})]})}function JS({viewMode:e,currentSort:t,sortOnlyOptions:n,sortDisabled:r,sortControlsDisabled:s,sortDir:i,isRandom:o,showSelectModeToggle:l,multiSelectMode:u,selectModeLabel:d,uploadBusy:f,uploadDisabled:h,onViewMode:p,onSortChange:S,onToggleSortDir:w,onToggleMultiSelectMode:E,onUploadClick:j}){return a.jsx("div",{className:"mobile-drawer",children:a.jsxs("div",{className:"mobile-drawer-row",children:[a.jsxs("div",{className:"mobile-pill-group",children:[a.jsx("button",{className:`mobile-pill ${e==="grid"?"is-active":""}`,onClick:()=>p==null?void 0:p("grid"),"aria-pressed":e==="grid",children:"Grid"}),a.jsx("button",{className:`mobile-pill ${e==="adaptive"?"is-active":""}`,onClick:()=>p==null?void 0:p("adaptive"),"aria-pressed":e==="adaptive",children:"Masonry"})]}),a.jsx(fh,{value:t,onChange:v=>S==null?void 0:S(v),options:n,"aria-label":"Sort",triggerClassName:"mobile-pill mobile-pill-dropdown",panelClassName:"mobile-drawer-panel",disabled:r}),a.jsx("button",{className:`mobile-pill mobile-pill-icon ${s?"opacity-50 cursor-not-allowed":""}`,onClick:w,title:r?"Sorting disabled":o?"Shuffle":`Sort ${i==="desc"?"descending":"ascending"}`,"aria-label":o?"Shuffle":"Toggle sort direction","aria-disabled":s,disabled:s,children:a.jsx(gx,{isRandom:o,dir:i})}),l&&a.jsx("button",{className:`mobile-pill ${u?"is-active":""}`,onClick:()=>E==null?void 0:E(),"aria-pressed":u,title:u?"Exit select mode":"Enter select mode",children:d}),j&&a.jsx("button",{className:`mobile-pill ${h||f?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!h&&!f&&j(),disabled:h||f,children:f?"Uploading":"Upload"})]})})}function ZS({rootRef:e,onSearch:t,viewerActive:n,onBack:r,zoomPercent:s,onZoomPercentChange:i,currentLabel:o,itemCount:l,totalCount:u,sortSpec:d,metricKeys:f,onSortChange:h,sortDisabled:p=!1,filterCount:S,onOpenFilters:w,starFilters:E,onToggleStar:j,onClearStars:v,onClearFilters:m,starCounts:x,viewMode:y,onViewMode:k,gridItemSize:R,onGridItemSize:M,leftOpen:N,rightOpen:O,onToggleLeft:T,onToggleRight:X,onPrevImage:J,onNextImage:z,canPrevImage:ae,canNextImage:K,searchDisabled:A=!1,searchPlaceholder:_,onUploadClick:P,uploadBusy:D=!1,uploadDisabled:H=!1,multiSelectMode:te=!1,selectedCount:se=0,onToggleMultiSelectMode:I,syncIndicator:U}){const[Y,Z]=c.useState(!1),[q,ne]=c.useState(!1),fe=c.useRef(null),Ee=c.useRef(null),xe=Ta(Pa.narrow),De=Ta(Pa.phone),be=Ta(Pa.toolbarCompact);c.useEffect(()=>{if(!Y)return;const W=me=>{fe.current&&!fe.current.contains(me.target)&&Z(!1)};return window.addEventListener("click",W),()=>window.removeEventListener("click",W)},[Y]),c.useEffect(()=>{if(A){ne(!1);return}if(!xe||n){ne(!1);return}if(!q)return;const W=window.requestAnimationFrame(()=>{var me;return(me=Ee.current)==null?void 0:me.focus()});return()=>window.cancelAnimationFrame(W)},[xe,q,n,A]);const Ie=d??{kind:"builtin",key:"added",dir:"desc"},lt=Ie.dir,xt=Ie.kind==="builtin"&&Ie.key==="random",fn=n||p,Un=f!=null&&f.length?f.map(W=>({value:`metric:${W}`,label:W,disabled:p})):[],qt=[{value:"builtin:added",label:"Date added",disabled:p},{value:"builtin:name",label:"Filename",disabled:p},{value:"builtin:random",label:"Random",disabled:p},...Un],Ze=[{label:"Layout",options:[{value:"layout:grid",label:"Grid"},{value:"layout:masonry",label:"Masonry"}]},{label:"Sort by",options:qt}],Gt=Ie.kind==="metric"?`metric:${Ie.key}`:`builtin:${Ie.key}`,Dt=[{label:"Sort by",options:qt}],hn=xe&&!n,pn=!(!!n&&be),et=!!n&&!De,ht=hn&&!!I,Jt=te?se>0?`Done (${se})`:"Done":"Select",zt=W=>{if(W.startsWith("layout:")){const me=W==="layout:masonry"?"adaptive":"grid";k==null||k(me)}else{if(p)return;h==null||h(pm(W,Ie))}},Hn=()=>{!h||p||h(xt?Ie:{...Ie,dir:lt==="desc"?"asc":"desc"})},Zt=E??[],mn=Zt.length,ar=tb(S,mn),$=eb(l,u),ee=o||"Root";return a.jsxs("div",{ref:e,className:`toolbar-shell ${n?"toolbar-shell-viewer":""} ${De?"toolbar-shell-phone":""} ${be?"toolbar-shell-compact":""} fixed top-0 left-0 right-0 h-12 grid grid-cols-[minmax(0,1fr)_minmax(0,1fr)_auto] items-center px-3 gap-3 bg-panel border-b border-border z-[var(--z-toolbar)] col-span-full row-start-1 select-none`,children:[a.jsxs("div",{className:"toolbar-left flex items-center gap-4 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope flex items-center gap-3 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope-text flex flex-col min-w-0 leading-tight",children:[a.jsx("span",{className:"toolbar-scope-label text-[10px] uppercase tracking-widest text-muted",children:"Scope"}),a.jsx("span",{className:"text-sm font-medium text-text truncate",title:ee,children:ee})]}),$&&a.jsx("span",{className:"toolbar-count text-xs text-muted whitespace-nowrap tabular-nums",children:$})]}),n&&a.jsxs("button",{className:"toolbar-back-btn btn btn-sm",onClick:r,title:"Back to grid",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]}),pn&&a.jsxs("div",{className:"toolbar-sort flex items-center gap-2",children:[a.jsxs("div",{className:`toolbar-sort-controls flex items-center gap-2 ${n?"opacity-40 pointer-events-none":""}`,children:[a.jsx(fh,{value:Gt,onChange:zt,options:Ze,title:"Sort and layout options","aria-label":"Sort and layout",triggerClassName:"min-w-[110px]"}),a.jsx("button",{className:"toolbar-sort-dir btn btn-icon",onClick:Hn,title:p?"Sorting disabled":xt?"Shuffle":`Sort ${lt==="desc"?"descending":"ascending"}`,"aria-label":xt?"Shuffle":"Toggle sort direction","aria-disabled":fn,disabled:fn,children:a.jsx(gx,{isRandom:xt,dir:lt})})]}),a.jsx(GS,{viewerActive:!!n,filtersOpen:Y,filtersRef:fe,totalFilterCount:ar,filterCount:S,starFilterList:Zt,starCounts:x,onToggleFilters:()=>Z(W=>!W),onOpenFilters:w,onToggleStar:j,onClearFilters:m,onClearStars:v})]})]}),a.jsx("div",{className:"toolbar-center flex items-center gap-3 justify-center min-w-0",children:n?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"range",min:5,max:800,step:1,value:Math.round(Math.max(5,Math.min(800,s??100))),onChange:W=>i==null?void 0:i(Number(W.target.value)),className:"zoom-slider","aria-label":"Zoom level"}),a.jsxs("span",{className:"text-xs text-muted min-w-[42px] text-right",children:[Math.round(s??100),"%"]})]}):M&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-muted",children:"Size"}),a.jsx("input",{type:"range",min:80,max:500,step:10,value:R??220,onChange:W=>M(Number(W.target.value)),className:"w-28 h-1.5 bg-border rounded-full appearance-none cursor-pointer hover:bg-hover transition-colors [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-text [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-text [&::-moz-range-thumb]:border-0","aria-label":"Thumbnail size"})]})}),a.jsxs("div",{className:"toolbar-right flex items-center gap-2 justify-end",children:[et&&a.jsxs("div",{className:"toolbar-nav flex items-center gap-1 mr-1",children:[a.jsx("button",{className:`btn btn-icon ${ae?"":"opacity-40 cursor-not-allowed"}`,title:"Previous image (A / )",onClick:()=>ae&&(J==null?void 0:J()),"aria-label":"Previous image","aria-disabled":!ae,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("button",{className:`btn btn-icon ${K?"":"opacity-40 cursor-not-allowed"}`,title:"Next image (D / )",onClick:()=>K&&(z==null?void 0:z()),"aria-label":"Next image","aria-disabled":!K,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 6l6 6-6 6"})})})]}),a.jsxs("div",{className:"toolbar-panels flex items-center gap-1",children:[a.jsx("button",{className:`btn btn-icon ${N?"":"opacity-50"}`,title:N?"Hide left panel (Ctrl+B)":"Show left panel (Ctrl+B)",onClick:T,"aria-pressed":N,"aria-label":"Toggle left panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"11",y:"5",width:"10",height:"14",rx:"1.5"})]})}),a.jsx("button",{className:`btn btn-icon ${O?"":"opacity-50"}`,title:O?"Hide right panel (Ctrl+Alt+B)":"Show right panel (Ctrl+Alt+B)",onClick:X,"aria-pressed":O,"aria-label":"Toggle right panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"15",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"3",y:"5",width:"10",height:"14",rx:"1.5"})]})})]}),!n&&P&&a.jsxs("button",{className:`btn ${H?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!H&&P(),"aria-label":"Upload images",title:D?"Uploading":"Upload images","aria-disabled":H||D,disabled:H||D,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M12 16V5"}),a.jsx("path",{d:"M7 10l5-5 5 5"}),a.jsx("path",{d:"M4 19h16"})]}),a.jsx("span",{children:D?"Uploading":"Upload"})]}),U&&a.jsx(VS,{...U,isNarrow:xe||be}),!n&&xe&&a.jsx("button",{className:`btn btn-icon ${q?"btn-active":""} ${A?"opacity-50 cursor-not-allowed":""}`,"aria-label":q?"Close search":"Open search",title:A?"Search disabled":q?"Close search":"Search",onClick:()=>!A&&ne(W=>!W),disabled:A,children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"11",cy:"11",r:"7"}),a.jsx("path",{d:"M21 21l-4.35-4.35"})]})}),!n&&!xe?a.jsx("div",{className:"toolbar-search toolbar-search-desktop w-[240px]",children:a.jsx("input",{ref:Ee,"aria-label":"Search filename, tags, notes",placeholder:A?_??"Search disabled":"Search...",onChange:W=>t(W.target.value),className:"toolbar-search-input input w-full focus:w-full transition-all duration-200 select-text",disabled:A})}):null]}),!n&&xe&&q&&!A&&a.jsx("div",{className:"toolbar-search-row",children:a.jsx("input",{ref:Ee,"aria-label":"Search filename, tags, notes",placeholder:_??"Search...",onChange:W=>t(W.target.value),className:"toolbar-search-input-mobile input input-lg w-full select-text"})}),hn&&a.jsx(JS,{viewMode:y,currentSort:Gt,sortOnlyOptions:Dt,sortDisabled:p,sortControlsDisabled:fn,sortDir:lt,isRandom:xt,showSelectModeToggle:ht,multiSelectMode:te,selectModeLabel:Jt,uploadBusy:D,uploadDisabled:H,onViewMode:k,onSortChange:W=>h==null?void 0:h(pm(W,Ie)),onToggleSortDir:Hn,onToggleMultiSelectMode:I,onUploadClick:P})]})}function eb(e,t){if(typeof e!="number")return null;const n=e.toLocaleString();if(typeof t!="number")return`${n} items`;const r=t.toLocaleString();return t===e?`${n} items`:`${n} / ${r} items`}function tb(e,t){return typeof e=="number"?e:t>0?1:0}function pm(e,t){if(e.startsWith("metric:")){const n=e.slice(7);return n?{kind:"metric",key:n,dir:t.dir}:t}if(e.startsWith("builtin:")){const n=e.slice(8);if(n==="name"||n==="added"||n==="random")return{kind:"builtin",key:n,dir:t.dir}}return t}class an extends Error{constructor(n,r,s,i){super(r);rt(this,"status");rt(this,"url");rt(this,"body");this.name="FetchError",this.status=n,this.url=s,this.body=i}}function nb(e){const t=e.trim();return t.startsWith("{")||t.startsWith("[")}function vx(e,t,n){if(t&&typeof t=="object"){const r=t,s=typeof r.error=="string"?r.error:null,i=typeof r.message=="string"?r.message:null;if(s&&i)return`${s}: ${i}`;if(s)return s;if(i)return i}return typeof t=="string"&&t?t:`HTTP ${e} for ${n}`}function mt(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{let u=null;const d=await l.text().catch(()=>"");if(d)if((l.headers.get("content-type")||"").includes("application/json")||nb(d))try{u=JSON.parse(d)}catch{u=d}else u=d;if(!l.ok)throw new an(l.status,vx(l.status,u,e),e,u);return u}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}function wo(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{if(!l.ok){const u=await l.text().catch(()=>""),d=u||null;throw new an(l.status,vx(l.status,d,e),e,d)}return l.blob()}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}class yx{constructor(t){rt(this,"store",new Map);rt(this,"inflight",new Map);rt(this,"totalBytes",0);this.maxBytes=t}getMaxBytes(){return this.maxBytes}getTotalBytes(){return this.totalBytes}getSize(){return this.store.size}has(t){return this.store.has(t)}isInflight(t){return this.inflight.has(t)}get(t){const n=this.store.get(t);if(n)return this.store.delete(t),this.store.set(t,n),n.blob}evictIfNeeded(t){for(;this.totalBytes+t>this.maxBytes&&this.store.size>0;){const n=this.store.keys().next().value;if(n==null)break;const r=this.store.get(n);r&&(this.totalBytes-=r.size),this.store.delete(n)}}set(t,n){const r=n.size||0;if(!(r>this.maxBytes)){if(this.store.has(t)){const s=this.store.get(t);this.totalBytes-=s.size,this.store.delete(t)}this.evictIfNeeded(r),this.store.set(t,{blob:n,size:r}),this.totalBytes+=r}}async getOrFetch(t,n){const r=this.get(t);if(r)return r;const s=this.inflight.get(t);if(s)return s.promise;const i=n(),o=typeof i=="object"&&"promise"in i,l=o?i.promise:i,u=o?i.abort:void 0,d=l.then(f=>(this.set(t,f),f)).finally(()=>{this.inflight.delete(t)});return this.inflight.set(t,{promise:d,abort:u}),d}prefetch(t,n){if(this.store.has(t)||this.inflight.has(t))return;const r=n(),s=typeof r=="object"&&"promise"in r,i=s?r.promise:r,o=s?r.abort:void 0,l=i.then(u=>(this.set(t,u),u)).catch(()=>new Blob).finally(()=>{this.inflight.delete(t)});this.inflight.set(t,{promise:l,abort:o})}cancelPrefetch(t){const n=this.inflight.get(t);if(n!=null&&n.abort)try{n.abort()}catch{}this.inflight.delete(t)}clear(){for(const[t,n]of this.inflight)if(n.abort)try{n.abort()}catch{}this.inflight.clear(),this.store.clear(),this.totalBytes=0}evictPrefix(t){const n=(()=>{const s=t?`/${t.replace(/^\/+/,"")}`:"/";return s==="/"?"/":s.replace(/\/+$/,"")})(),r=s=>{const i=s.startsWith("/")?s.replace(/\/+$/,""):`/${s.replace(/\/+$/,"")}`;return n==="/"?!0:i===n||i.startsWith(`${n}/`)};for(const[s,i]of Array.from(this.store.entries()))r(s)&&(this.totalBytes-=i.size,this.store.delete(s));for(const[s,i]of Array.from(this.inflight.entries()))if(r(s)){if(i.abort)try{i.abort()}catch{}this.inflight.delete(s)}this.totalBytes<0&&(this.totalBytes=0)}}const ui=new yx(60*1024*1024),qd=new yx(20*1024*1024),Mc={};function rb(){const e=Mc==null?void 0:Mc.VITE_API_BASE,t=typeof window<"u",n=t?window.location.origin:"http://localhost",r=t?window.location.hostname:"localhost",s=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\]|.+\.localhost)$/i.test(r);if(!e)return"";let i;try{i=new URL(e,n)}catch{return""}const o=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\])$/i.test(i.hostname);return s?i.origin:o?"":i.origin}const He=rb();const sb=40*1024*1024;function ib(e){return e==="viewer"||e==="compare"}function mm(e){return`${He}/thumb?path=${encodeURIComponent(e)}`}function gm(e){return`${He}/file?path=${encodeURIComponent(e)}`}const Rc="lenslet.client_id",vm="lenslet.client_id.session",xx="lenslet.last_event_id",ob=1e3,lb=3e4,ab=5;let Gd=null,La=null,ym=0,Mi=null,Ri=0,Fu=!0,uu=!1;function wx(){return typeof window<"u"&&typeof EventSource<"u"}function xm(e,t){if(!e)return null;try{return e.getItem(t)}catch{return null}}function wm(e,t,n){if(e)try{e.setItem(t,n)}catch{}}function ub(e,t){if(e)try{e.removeItem(t)}catch{}}function cb(){if(typeof navigator>"u")return"server";const e=navigator.userAgent||"",t=navigator.language||"",n=navigator.platform||"",r=typeof Intl<"u"&&Intl.DateTimeFormat().resolvedOptions().timeZone||"",s=typeof screen<"u"?`${screen.width}x${screen.height}x${screen.colorDepth}`:"";return[e,t,n,r,s].join("|")}function db(e){let t=2166136261;for(let n=0;n<e.length;n+=1)t^=e.charCodeAt(n),t=t*16777619>>>0;return t.toString(16).padStart(8,"0")}function Sm(){return typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`client_${Math.random().toString(36).slice(2,10)}_${Date.now()}`}function So(e){return Gd=e,e}function cu(e){if(typeof window>"u")return null;try{return e==="local"?window.localStorage:window.sessionStorage}catch{return null}}function Gi(){if(Gd)return Gd;const e=cu("local"),t=cu("session"),n=xm(t,vm);if(n)return So(n);const r=xm(e,Rc);if(t){const i=Sm();return wm(t,vm,i),r&&ub(e,Rc),So(i)}if(r)return So(r);if(e){const i=Sm();return wm(e,Rc,i),So(i)}const s=`fp_${db(cb())}_${Math.random().toString(36).slice(2,8)}`;return So(s)}function ul(e="lenslet"){ym+=1;const t=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`nonce_${Math.random().toString(36).slice(2,10)}_${Date.now()}_${ym}`;return`${e}:${Gi()}:${t}`}function fb(){if(La!=null)return La;if(typeof window>"u")return null;const e=cu("local");if(!e)return null;try{const t=e.getItem(xx);if(!t)return null;const n=Number(t);return!Number.isFinite(n)||n<=0?null:(La=n,n)}catch{return null}}function hb(e){if(!Number.isFinite(e)||e<=0||(La=e,typeof window>"u"))return;const t=cu("local");if(t)try{t.setItem(xx,String(e))}catch{}}function pb(){if(typeof window>"u")return`${He}/events`;const e=new URL(`${He}/events`,window.location.origin),t=fb();return t!=null&&Number.isFinite(t)&&e.searchParams.set("last_event_id",String(t)),e.toString()}function mb(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}let In=null,Sx="idle";const Jd=new Set,Zd=new Set,ef=new Set;function Pi(e){Sx=e;for(const t of Zd)t(e)}function hh(e){if(uu!==e){uu=e;for(const t of ef)t(e)}}function ph(){Mi!=null&&(window.clearTimeout(Mi),Mi=null)}function gb(){Ri=0,ph()}function vb(){if(!Fu||Mi!=null)return;Ri+=1;const e=Math.min(ob*Math.pow(2,Ri-1),lb);Ri>=ab?(Pi("offline"),hh(!0)):Pi("reconnecting"),Mi=window.setTimeout(()=>{Mi=null,bx()},e)}function bx(){if(!Fu||!wx()||(In&&In.readyState===EventSource.CLOSED&&(In.close(),In=null),In))return;Ri>0?Pi("reconnecting"):Pi("connecting");const e=new EventSource(pb());In=e;const t=n=>r=>{const s=mb(r.data);if(!s)return;const i=r.lastEventId?Number(r.lastEventId):null,o=i!=null&&Number.isFinite(i)?i:null;o!=null&&hb(o);for(const l of Jd)l({type:n,id:o,data:s})};e.addEventListener("item-updated",t("item-updated")),e.addEventListener("metrics-updated",t("metrics-updated")),e.addEventListener("presence",t("presence")),e.onopen=()=>{gb(),hh(!1),Pi("live")},e.onerror=()=>{In===e&&(e.close(),In=null,vb())}}function yb(){Fu=!0,wx()&&(ph(),bx())}function xb(){Fu=!1,ph(),Ri=0,In&&(In.close(),In=null),hh(!1),Pi("offline")}function wb(e){return Jd.add(e),()=>{Jd.delete(e)}}function Sb(e){return Zd.add(e),e(Sx),()=>{Zd.delete(e)}}function bb(e){return ef.add(e),e(uu),()=>{ef.delete(e)}}function Cb(){return uu}function kb(e,t){const n=JSON.stringify(t),r=`${He}${e}`;if(typeof navigator<"u"&&typeof navigator.sendBeacon=="function")try{if(navigator.sendBeacon(r,new Blob([n],{type:"application/json"})))return!0}catch{}if(typeof fetch!="function")return!1;try{return fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0}),!0}catch{return!1}}function Eb(e,t,n){return kb("/presence/leave",{gallery_id:e,lease_id:t,client_id:n??Gi()})}function ca(e){return e??Gi()}function da(e,t){return mt(`${He}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).promise}function Nb(e,t){const n=new URLSearchParams({path:e});return(t==null?void 0:t.page)!=null&&n.set("page",String(t.page)),(t==null?void 0:t.pageSize)!=null&&n.set("page_size",String(t.pageSize)),t!=null&&t.recursive&&n.set("recursive","1"),t!=null&&t.legacyRecursive&&n.set("legacy_recursive","1"),n.toString()}const Se={getFolder:(e,t)=>mt(`${He}/folders?${Nb(e,t)}`).promise,search:(e,t)=>{const n=new URLSearchParams;return e&&n.set("q",e),t&&n.set("path",t),mt(`${He}/search?${n}`).promise},getEmbeddings:()=>mt(`${He}/embeddings`).promise,searchEmbeddings:e=>mt(`${He}/embeddings/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,refreshFolder:e=>{const t=new URLSearchParams({path:e});return mt(`${He}/refresh?${t}`,{method:"POST"}).promise},getSidecar:e=>mt(`${He}/item?path=${encodeURIComponent(e)}`).promise,patchSidecar:(e,t,n)=>{const s={"Content-Type":"application/json","Idempotency-Key":(n==null?void 0:n.idempotencyKey)??ul("patch"),"x-client-id":Gi(),"x-updated-by":"web"};return(n==null?void 0:n.ifMatch)!=null&&(s["If-Match"]=String(n.ifMatch)),mt(`${He}/item?path=${encodeURIComponent(e)}`,{method:"PATCH",headers:s,body:JSON.stringify(t)}).promise},getMetadata:e=>mt(`${He}/metadata?path=${encodeURIComponent(e)}`).promise,putSidecar:(e,t)=>mt(`${He}/item?path=${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json","x-client-id":Gi(),"x-updated-by":"web"},body:JSON.stringify(t)}).promise,getHealth:()=>mt(`${He}/health`).promise,joinPresence:(e,t,n)=>da("/presence/join",{gallery_id:e,client_id:ca(n),lease_id:t}),movePresence:(e,t,n,r)=>da("/presence/move",{from_gallery_id:e,to_gallery_id:t,client_id:ca(r),lease_id:n}),leavePresence:(e,t,n)=>da("/presence/leave",{gallery_id:e,client_id:ca(n),lease_id:t}),postPresence:(e,t,n)=>da("/presence",{gallery_id:e,client_id:ca(n),lease_id:t}),getThumb:e=>qd.getOrFetch(e,()=>wo(mm(e))),prefetchThumb:e=>{qd.prefetch(e,()=>wo(mm(e)))},getFile:e=>ui.getOrFetch(e,()=>wo(gm(e))),exportComparison:e=>wo(`${He}/export-comparison`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,prefetchFile:async(e,t)=>{if(ib(t)&&!(ui.has(e)||ui.isInflight(e)))try{const n=await wo(gm(e),{headers:{"x-lenslet-prefetch":t}}).promise;n.size<=sb&&ui.set(e,n)}catch{}},cancelPrefetch:e=>{ui.cancelPrefetch(e)},uploadFile:async(e,t)=>{const n=new FormData;return n.append("dest",e),n.append("file",t),mt(`${He}/file`,{method:"POST",body:n,timeoutMs:6e4}).promise},moveFile:async(e,t)=>{const n=new FormData;return n.append("src",e),n.append("dest",t),mt(`${He}/move`,{method:"POST",body:n}).promise},deleteFiles:async e=>mt(`${He}/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paths:e})}).promise,exportIntent:async e=>{const t=new FormData;return t.append("path",e),mt(`${He}/export-intent`,{method:"POST",body:t}).promise},getViews:()=>mt(`${He}/views`).promise,saveViews:e=>mt(`${He}/views`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise};class jb{constructor(t=400){rt(this,"cache",new Map);rt(this,"maxSize");this.maxSize=t,typeof window<"u"&&window.addEventListener("beforeunload",()=>this.clear(),{once:!0})}get(t){const n=this.cache.get(t);return n&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){for(this.cache.has(t)&&this.cache.delete(t);this.cache.size>=this.maxSize;){const r=this.cache.keys().next().value;if(r===void 0)break;const s=this.cache.get(r);if(this.cache.delete(r),s)try{URL.revokeObjectURL(s)}catch{}}this.cache.set(t,n)}clear(){for(const t of this.cache.values())try{URL.revokeObjectURL(t)}catch{}this.cache.clear()}}const Pc=new jb(400);function Mb({path:e,name:t,onClick:n,selected:r,highlighted:s,highlightKey:i,displayW:o,displayH:l,ioRoot:u,isScrolling:d,priority:f}){const h=c.useRef(null),[p,S]=c.useState(()=>Pc.get(e)??null),[w,E]=c.useState(!1),[j,v]=c.useState(()=>!!p);c.useEffect(()=>{const x=h.current;if(!x)return;const y=new IntersectionObserver(k=>{for(const R of k)R.target===x&&E(R.isIntersecting||R.intersectionRatio>0)},{root:u??null,rootMargin:"200px 0px",threshold:.01});return y.observe(x),()=>{y.unobserve(x),y.disconnect()}},[u]),c.useEffect(()=>{if(p||!(w&&!d||f))return;let x=!0;return Se.getThumb(e).then(y=>{if(!x)return;const k=URL.createObjectURL(y);Pc.set(e,k),S(k)}).catch(()=>{}),()=>{x=!1}},[e,p,w,d,f]),c.useEffect(()=>{var y;if(!p){v(!1);return}const x=(y=h.current)==null?void 0:y.querySelector("img");x&&x.complete&&x.naturalWidth>0?v(!0):v(!1)},[p]),c.useEffect(()=>{S(Pc.get(e)??null)},[e]);const m=["absolute inset-0 relative bg-hover border border-border rounded-lg overflow-hidden select-none",r?"outline-2 outline-accent":"",s?"thumb-updated-ring":"","hover:outline hover:outline-1 hover:outline-accent"].filter(Boolean).join(" ");return a.jsx("div",{ref:h,"data-highlight-key":i??void 0,className:m,onClick:n,children:p?a.jsx("img",{className:`w-full h-full object-cover block pointer-events-none select-none opacity-0 transition-opacity duration-[160ms] ${j?"opacity-100":""}`,src:p,alt:t,loading:"lazy",decoding:"async",onLoad:()=>v(!0),width:o?Math.round(o):void 0,height:l?Math.round(l):void 0}):null})}function li(e,t,n){let r=n.initialDeps??[],s,i=!0;function o(){var l,u,d;let f;n.key&&((l=n.debug)!=null&&l.call(n))&&(f=Date.now());const h=e();if(!(h.length!==r.length||h.some((w,E)=>r[E]!==w)))return s;r=h;let S;if(n.key&&((u=n.debug)!=null&&u.call(n))&&(S=Date.now()),s=t(...h),n.key&&((d=n.debug)!=null&&d.call(n))){const w=Math.round((Date.now()-f)*100)/100,E=Math.round((Date.now()-S)*100)/100,j=E/16,v=(m,x)=>{for(m=String(m);m.length<x;)m=" "+m;return m};console.info(`%c ${v(E,5)} /${v(w,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*j,120))}deg 100% 31%);`,n==null?void 0:n.key)}return n!=null&&n.onChange&&!(i&&n.skipInitialOnChange)&&n.onChange(s),i=!1,s}return o.updateDeps=l=>{r=l},o}function bm(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const Rb=(e,t)=>Math.abs(e-t)<1.01,Pb=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},Cm=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},Tb=e=>e,Lb=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},_b=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=o=>{const{width:l,height:u}=o;t({width:Math.round(l),height:Math.round(u)})};if(s(Cm(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(o=>{const l=()=>{const u=o[0];if(u!=null&&u.borderBoxSize){const d=u.borderBoxSize[0];if(d){s({width:d.inlineSize,height:d.blockSize});return}}s(Cm(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},km={passive:!0},Em=typeof window>"u"?!0:"onscrollend"in window,Ib=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&Em?()=>{}:Pb(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),o=f=>()=>{const{horizontal:h,isRtl:p}=e.options;s=h?n.scrollLeft*(p&&-1||1):n.scrollTop,i(),t(s,f)},l=o(!0),u=o(!1);u(),n.addEventListener("scroll",l,km);const d=e.options.useScrollendEvent&&Em;return d&&n.addEventListener("scrollend",u,km),()=>{n.removeEventListener("scroll",l),d&&n.removeEventListener("scrollend",u)}},Fb=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},Ob=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const o=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class Ab{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Tb,rangeExtractor:Lb,onChange:()=>{},measureElement:Fb,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=li(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let o=r-1;o>=0;o--){const l=n[o];if(s.has(l.lane))continue;const u=i.get(l.lane);if(u==null||l.end>u.end?i.set(l.lane,l):l.end<u.end&&s.set(l.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=li(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(n,r,s,i,o,l)=>(this.prevLanes!==void 0&&this.prevLanes!==l&&(this.lanesChangedFlag=!0),this.prevLanes=l,this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=li(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l},u)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>n)for(const p of this.laneAssignments.keys())p>=n&&this.laneAssignments.delete(p);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(p=>{this.itemSizeCache.set(p.key,p.size)}));const d=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===n&&(this.lanesSettling=!1);const f=this.measurementsCache.slice(0,d),h=new Array(l).fill(void 0);for(let p=0;p<d;p++){const S=f[p];S&&(h[S.lane]=p)}for(let p=d;p<n;p++){const S=i(p),w=this.laneAssignments.get(p);let E,j;if(w!==void 0&&this.options.lanes>1){E=w;const y=h[E],k=y!==void 0?f[y]:void 0;j=k?k.end+this.options.gap:r+s}else{const y=this.options.lanes===1?f[p-1]:this.getFurthestMeasurement(f,p);j=y?y.end+this.options.gap:r+s,E=y?y.lane:p%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(p,E)}const v=u.get(S),m=typeof v=="number"?v:this.options.estimateSize(p),x=j+m;f[p]={index:p,start:j,size:m,end:x,key:S,lane:E},h[E]=p}return this.measurementsCache=f,f},{key:!1,debug:()=>this.options.debug}),this.calculateRange=li(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?Db({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=li(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,o)=>i===null||o===null?[]:n({startIndex:i,endIndex:o,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==n&&(l&&this.observer.unobserve(l),this.observer.observe(n),this.elementsCache.set(o,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,o=r-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,o,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=li(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,o=n.length;i<o;i++){const l=n[i],u=r[l];s.push(u)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return bm(r[Cx(0,r.length-1,s=>bm(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),o=this.getScrollOffset();r==="auto"&&(r=n>=o+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),o=this.getScrollOffset();if(r==="auto")if(s.end>=o+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=o+this.options.scrollPaddingStart)r="start";else return[o,r];const l=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),n=Math.max(0,Math.min(n,this.options.count-1));let i=0;const o=10,l=d=>{if(!this.targetWindow)return;const f=this.getOffsetForIndex(n,d);if(!f){console.warn("Failed to get offset for index:",n);return}const[h,p]=f;this._scrollToOffset(h,{adjustments:void 0,behavior:s}),this.targetWindow.requestAnimationFrame(()=>{const S=this.getScrollOffset(),w=this.getOffsetForIndex(n,p);if(!w){console.warn("Failed to get offset for index:",n);return}Rb(w[0],S)||u(p)})},u=d=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(d)):console.warn(`Failed to scroll to index ${n} after ${o} attempts.`))};l(r)},this.scrollBy=(n,{behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=r.length-1;for(;o>=0&&i.some(l=>l===null);){const l=r[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}s=Math.max(...i.filter(l=>l!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(t)}}const Cx=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function Db({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=u=>e[u].start;if(e.length<=r)return{startIndex:0,endIndex:s};let o=Cx(0,s,i,n),l=o;if(r===1)for(;l<s&&e[l].end<n+t;)l++;else if(r>1){const u=Array(r).fill(0);for(;l<s&&u.some(f=>f<n+t);){const f=e[l];u[f.lane]=f.end,l++}const d=Array(r).fill(n+t);for(;o>=0&&d.some(f=>f>=n);){const f=e[o];d[f.lane]=f.start,o--}o=Math.max(0,o-o%r),l=Math.min(s,l+(r-1-l%r))}return{startIndex:o,endIndex:l}}const Nm=typeof document<"u"?c.useLayoutEffect:c.useEffect;function zb(e){const t=c.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var o;i?_u.flushSync(t):t(),(o=e.onChange)==null||o.call(e,s,i)}},[r]=c.useState(()=>new Ab(n));return r.setOptions(n),Nm(()=>r._didMount(),[]),Nm(()=>r._willUpdate()),r}function $b(e){return zb({observeElementRect:_b,observeElementOffset:Ib,scrollToFn:Ob,...e})}function Bb({containerW:e,gap:t,targetCell:n,aspect:r,captionH:s}){const i=Math.max(1,Math.floor((e+t)/(n+t))),o=(e-t*(i-1))/i,l=o*r.h/r.w,u=l+s+t;return{columns:i,cellW:o,mediaH:l,rowH:u}}const Ub=1.333;function Hb({items:e,containerWidth:t,targetHeight:n,gap:r,captionH:s}){if(t<=0)return[];const i=[];let o=[],l=0;const u=(d,f)=>({index:i.length,height:f+s+r,imageH:f,items:d.map(h=>({item:h.item,displayW:h.aspect*f,displayH:f,originalIndex:h.originalIndex}))});for(let d=0;d<e.length;d++){const f=e[d],h=f.w>0&&f.h>0?f.w/f.h:Ub;o.push({item:f,aspect:h,originalIndex:d}),l+=h;const p=(o.length-1)*r;if(l*n+p>=t){const w=(t-p)/l;i.push(u(o,w)),o=[],l=0}}return o.length>0&&i.push(u(o,n)),i}function Vb(e,t,n){return{mode:"adaptive",rows:Hb({items:t,containerWidth:e,targetHeight:n.targetCell,gap:n.gap,captionH:n.captionH})}}function Wb(e,t,n){const{columns:r,cellW:s,mediaH:i,rowH:o}=Bb({containerW:e,gap:n.gap,targetCell:n.targetCell,aspect:n.aspect,captionH:n.captionH}),l=Math.ceil(t.length/Math.max(1,r));return{mode:"grid",columns:r,cellW:s,mediaH:i,rowH:o,rowCount:l}}function Qb(e,t,n){const[r,s]=c.useState(0);c.useLayoutEffect(()=>{const u=e.current;if(!u)return;const d=()=>{const h=getComputedStyle(u),p=u.clientWidth-parseFloat(h.paddingLeft)-parseFloat(h.paddingRight);s(p)},f=new ResizeObserver(d);return f.observe(u),d(),()=>f.disconnect()},[]);const i=c.useMemo(()=>n.viewMode==="adaptive"?Vb(r,t,n):Wb(r,t,n),[r,t,n.viewMode,n.gap,n.targetCell,n.aspect.w,n.aspect.h,n.captionH]),o=$b({count:i.mode==="adaptive"?i.rows.length:i.rowCount,getScrollElement:()=>e.current,estimateSize:u=>i.mode==="adaptive"?i.rows[u].height:i.rowH,overscan:8}),l=o.getVirtualItems();return c.useEffect(()=>{o.measure()},[i,o]),{width:r,layout:i,rowVirtualizer:o,virtualRows:l}}function Kb(e,t,n,r){if(!e.length)return null;const s=n?e.findIndex(l=>l.path===n):0,i=Math.max(1,t);let o=s;if(r.key==="ArrowRight"||r.key==="d")o=Math.min(e.length-1,s+1);else if(r.key==="ArrowLeft"||r.key==="a")o=Math.max(0,s-1);else if(r.key==="ArrowDown"||r.key==="s")o=Math.min(e.length-1,s+i);else if(r.key==="ArrowUp"||r.key==="w")o=Math.max(0,s-i);else return r.key==="Enter"&&n?"open":null;return o}function Yb(e,t,n){const r=[];for(const s of e){if(t.mode==="adaptive"){const l=t.rows[s.index];if(!l)continue;for(const u of l.items)r.push(u.item.path);continue}const i=s.index*t.columns,o=n.slice(i,i+t.columns);for(const l of o)r.push(l.path)}return Array.from(new Set(r))}const Xb=500,qb=450,Gb=600,Jb=8;function Zb(e){return Math.max(qb,Math.min(Gb,e))}class eC{constructor(t){rt(this,"delayMs");rt(this,"moveTolerancePx");rt(this,"onLongPress");rt(this,"onCancel");rt(this,"timerId",null);rt(this,"activePointerId",null);rt(this,"startX",0);rt(this,"startY",0);rt(this,"lastEvent",null);rt(this,"fired",!1);this.delayMs=Zb(t.delayMs??Xb),this.moveTolerancePx=Math.max(0,t.moveTolerancePx??Jb),this.onLongPress=t.onLongPress,this.onCancel=t.onCancel}pointerDown(t){return(t.pointerType??"mouse")==="mouse"?!1:t.isPrimary===!1?(this.cancel("multitouch"),!1):this.activePointerId!=null&&this.activePointerId!==t.pointerId?(this.cancel("multitouch"),!1):(this.activePointerId=t.pointerId,this.startX=t.clientX,this.startY=t.clientY,this.lastEvent=t,this.fired=!1,this.clearTimer(),this.timerId=setTimeout(()=>{this.activePointerId==null||this.fired||this.lastEvent==null||(this.fired=!0,this.clearTimer(),this.onLongPress(this.lastEvent))},this.delayMs),!0)}pointerMove(t){if(!this.matchesPointer(t.pointerId)||this.fired)return;this.lastEvent=t;const n=t.clientX-this.startX,r=t.clientY-this.startY;Math.hypot(n,r)>this.moveTolerancePx&&this.cancel("movement")}pointerUp(t){if(!(t!=null&&!this.matchesPointer(t))){if(!this.fired){this.cancel("pointerup");return}this.reset()}}pointerCancel(t){t!=null&&!this.matchesPointer(t)||this.cancel("pointercancel")}cancelFromScroll(){this.cancel("scroll")}destroy(){this.cancel("cleanup")}matchesPointer(t){return this.activePointerId!=null&&this.activePointerId===t}clearTimer(){this.timerId!=null&&(clearTimeout(this.timerId),this.timerId=null)}reset(){this.clearTimer(),this.activePointerId=null,this.lastEvent=null,this.fired=!1}cancel(t){var r;const n=this.timerId!=null&&!this.fired&&t!=="cleanup";this.reset(),n&&((r=this.onCancel)==null||r.call(this,t))}}function tC(e){return e==="touch"||e==="pen"}function nC(e){return e.multiSelectMode||e.isShift||e.isToggle||!tC(e.pointerType)?!1:e.selectedPaths.length===1&&e.selectedPaths[0]===e.path}function jm(e,t){return e.includes(t)?e.filter(n=>n!==t):[...e,t]}const dr=12,rC=44,sC={w:4,h:3},iC=350,oC=120;function lC(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Mm(e){return{pointerId:e.pointerId,pointerType:e.pointerType,clientX:e.clientX,clientY:e.clientY,isPrimary:e.isPrimary}}function aC(e,t){var s,i;let n=0,r=e.length-1;for(;n<=r;){const o=n+r>>1,l=e[o],u=((s=l.items[0])==null?void 0:s.originalIndex)??-1,d=((i=l.items[l.items.length-1])==null?void 0:i.originalIndex)??-1;if(t>=u&&t<=d)return o;t<u?r=o-1:n=o+1}return 0}function uC(e,t){const n=(t??"").trim();if(!n)return e;const r=e.toLowerCase().indexOf(n.toLowerCase());if(r===-1)return e;const s=e.slice(0,r),i=e.slice(r,r+n.length),o=e.slice(r+n.length);return a.jsxs(a.Fragment,{children:[s,a.jsx("mark",{className:"bg-accent/20 text-inherit rounded px-0.5",children:i}),o]})}function cC({items:e,selected:t,restoreToSelectionToken:n,multiSelectMode:r=!1,onSelectionChange:s,onOpenViewer:i,onContextMenuItem:o,onOpenItemActions:l,highlight:u,recentlyUpdated:d,onVisiblePathsChange:f,suppressSelectionHighlight:h=!1,viewMode:p="grid",targetCellSize:S=220,scrollRef:w,hideScrollbar:E=!1}){const[j,v]=c.useState(null),[m,x]=c.useState(null),[y,k]=c.useState(!1),[R,M]=c.useState(null),[N,O]=c.useState(null),T=c.useRef(null),X=c.useRef(null),J=c.useRef(null),z=w??J,ae=c.useRef(null),K=c.useRef(new Set),A=c.useRef(null),_=c.useRef(null),P=c.useRef(null),D=c.useRef(null),H=c.useRef({path:null,pointerType:null}),te=S,{width:se,layout:I,rowVirtualizer:U,virtualRows:Y}=Qb(z,e,{gap:dr,targetCell:te,aspect:sC,captionH:rC,viewMode:p}),Z=c.useMemo(()=>{const $=new Map;for(let ee=0;ee<e.length;ee++)$.set(e[ee].path,ee);return $},[e]),q=c.useMemo(()=>{if(I.mode!=="adaptive")return null;const $=new Map;return I.rows.forEach((ee,W)=>{let me=0;ee.items.forEach((ye,ge)=>{const ce=me+ye.displayW/2;$.set(ye.item.path,{row:W,center:ce,order:ge}),me+=ye.displayW+dr})}),$},[I]);c.useEffect(()=>{if(!t.length)return;const $=t[0];R!==$&&M($)},[t,R]);const ne=c.useMemo(()=>{if(I.mode!=="adaptive")return null;let $=0;return I.rows.map(ee=>{const W=$;return $+=ee.height,{start:W,height:ee.height}})},[I]),fe=c.useRef(null),Ee=($,ee)=>{try{if(fe.current!=null){try{cancelAnimationFrame(fe.current)}catch{}fe.current=null}const W=$.scrollTop,me=ee-W;if(Math.abs(me)<1){$.scrollTop=ee;return}const ye=140,ge=performance.now(),ce=we=>1-Math.pow(1-we,3),Re=we=>{const wt=Math.min(1,(we-ge)/ye),Oe=ce(wt);$.scrollTop=W+me*Oe,wt<1?fe.current=requestAnimationFrame(Re):fe.current=null};fe.current=requestAnimationFrame(Re)}catch{$.scrollTop=ee}},[xe,De]=c.useState(!1);c.useEffect(()=>{const $=z.current;if(!$)return;let ee=0;const W=()=>{var me;(me=A.current)==null||me.cancelFromScroll(),De(!0),window.clearTimeout(ee),ee=window.setTimeout(()=>De(!1),oC)};return $.addEventListener("scroll",W,{passive:!0}),()=>$.removeEventListener("scroll",W)},[]),c.useEffect(()=>{const $=new eC({onLongPress:ee=>{const W=_.current;if(!W||!l)return;const me=P.current??{x:ee.clientX,y:ee.clientY};l(W,me),D.current={path:W,untilMs:Date.now()+700}}});return A.current=$,()=>{$.destroy(),A.current===$&&(A.current=null)}},[l]);const be=()=>{X.current!=null&&(window.clearTimeout(X.current),X.current=null)},Ie=()=>{if(be(),k(!1),v(null),T.current){try{URL.revokeObjectURL(T.current)}catch{}T.current=null}x(null)},lt=$=>{xe||(be(),v($),k(!1),X.current=window.setTimeout(async()=>{X.current=null;try{const ee=await Se.getFile($),W=URL.createObjectURL(ee);if(T.current)try{URL.revokeObjectURL(T.current)}catch{}T.current=W,x(W),k(!0)}catch{}},iC))},xt=I.mode==="grid"?I.columns:Math.max(1,Math.floor(se/(te+dr))),fn=($,ee)=>{if(I.mode!=="adaptive")return null;const W=I.rows[$];if(!W)return null;let me=0,ye=null;for(const ge of W.items){const ce=me+ge.displayW/2,Re=Math.abs(ce-ee);(!ye||Re<ye.dist)&&(ye={path:ge.item.path,dist:Re}),me+=ge.displayW+dr}return ye?ye.path:null},Un=($,ee)=>{var Oe,Ne,St,gn;if(!e.length)return null;const W=$??e[0].path;if(I.mode!=="adaptive"){const at=Kb(e,xt,W,ee);return at==="open"||at==null?at:((Oe=e[at])==null?void 0:Oe.path)??null}const me=q==null?void 0:q.get(W);if(!me)return W;const ye=Z.get(W)??0,ge=ee.key;if(ge==="Enter")return"open";if(ge==="ArrowRight"||ge==="d")return((Ne=e[Math.min(e.length-1,ye+1)])==null?void 0:Ne.path)??W;if(ge==="ArrowLeft"||ge==="a")return((St=e[Math.max(0,ye-1)])==null?void 0:St.path)??W;const ce=ge==="ArrowDown"||ge==="s"?1:ge==="ArrowUp"||ge==="w"?-1:0;if(ce===0)return null;const Re=me.row+ce;if(Re<0||Re>=(((gn=I.rows)==null?void 0:gn.length)??0))return W;const we=me.center;return fn(Re,we)??W},qt=$=>{var ee;try{(ee=document.getElementById(`cell-${encodeURIComponent($)}`))==null||ee.focus()}catch{}},Ze=c.useCallback($=>{try{Se.prefetchThumb($)}catch{}},[]),Gt=c.useCallback(($,ee)=>{l==null||l($,ee)},[l]),Dt=()=>{_.current=null,P.current=null},hn=($,ee)=>{var W;ee.target.closest("[data-grid-action]")||(H.current={path:$,pointerType:ee.pointerType},!r&&(_.current=$,P.current={x:ee.clientX,y:ee.clientY},(W=A.current)==null||W.pointerDown(Mm(ee))))},Pn=$=>{var ee;r||(P.current={x:$.clientX,y:$.clientY},(ee=A.current)==null||ee.pointerMove(Mm($)))},pn=$=>{var ee;r||((ee=A.current)==null||ee.pointerUp($.pointerId),Dt())},et=$=>{var ee;r||((ee=A.current)==null||ee.pointerCancel($.pointerId),Dt())},ht=($,ee)=>{const W=D.current;if(W&&W.path===$&&W.untilMs>Date.now()){D.current=null,qt($);return}W&&W.untilMs<=Date.now()&&(D.current=null),M($),O($);const me=!!ee.shiftKey,ye=!!(ee.ctrlKey||ee.metaKey);if(r)s(jm(t,$)),ae.current=$;else if(nC({pointerType:H.current.path===$?H.current.pointerType:null,multiSelectMode:r,isShift:me,isToggle:ye,selectedPaths:t,path:$}))s([$]),ae.current=$,i($);else if(me){const ge=ae.current??R??t[0]??$,ce=Z.get(ge)??e.findIndex(we=>we.path===ge),Re=Z.get($)??e.findIndex(we=>we.path===$);if(ce!==-1&&Re!==-1){const we=Math.min(ce,Re),wt=Math.max(ce,Re),Oe=e.slice(we,wt+1).map(Ne=>Ne.path);if(ye){const Ne=new Set(t);for(const St of Oe)Ne.add(St);s(Array.from(Ne))}else s(Oe)}else s([$])}else ye?(s(jm(t,$)),ae.current=$):(s([$]),ae.current=$);xe||Ze($),qt($)},Jt=($,ee)=>{var W,me;try{const ye=zt.has($)&&t.length>0?t:[$];(W=ee.dataTransfer)==null||W.setData("application/x-lenslet-paths",JSON.stringify(ye)),ee.dataTransfer&&(ee.dataTransfer.effectAllowed="copyMove");try{document.body.classList.add("drag-active")}catch{}const ce=ee.currentTarget.querySelector(".cell-content img"),Re=document.createElement("div");Re.className="drag-ghost";const we=document.createElement("img");we.draggable=!1,we.alt="drag",ce&&ce.src&&(we.src=ce.src),Re.appendChild(we),document.body.appendChild(Re);const wt=Re.getBoundingClientRect().width||150;(me=ee.dataTransfer)==null||me.setDragImage(Re,Math.round(wt/2),0);const Oe=()=>{try{Re.remove()}catch{}try{document.body.classList.remove("drag-active")}catch{}window.removeEventListener("dragend",Oe),window.removeEventListener("pointerup",Oe),document.removeEventListener("visibilitychange",Oe)};window.addEventListener("dragend",Oe),window.addEventListener("pointerup",Oe),document.addEventListener("visibilitychange",Oe)}catch{}};c.useEffect(()=>{const $=z.current;if(!$)return;const ee=W=>{var Oe,Ne,St;const me=Un(N,W);if(me==null)return;if(W.preventDefault(),me==="open"){N&&i(N);return}const ye=e.find(gn=>gn.path===me);if(!ye)return;O(ye.path),M(ye.path),s([ye.path]),ae.current=ye.path;const ge=I.mode==="grid"?Math.floor((Z.get(ye.path)??0)/Math.max(1,I.columns)):((Oe=q==null?void 0:q.get(ye.path))==null?void 0:Oe.row)??0,ce=$.scrollTop,Re=ce+$.clientHeight,we=I.mode==="adaptive"?((Ne=ne==null?void 0:ne[ge])==null?void 0:Ne.start)??0:ge*I.rowH,wt=I.mode==="adaptive"?we+(((St=ne==null?void 0:ne[ge])==null?void 0:St.height)??0):we+I.rowH;(we<ce||wt>Re)&&Ee($,we),qt(ye.path)};return $.addEventListener("keydown",ee),()=>{$.removeEventListener("keydown",ee)}},[e,N,xt,i,I,q,ne,Z]),c.useLayoutEffect(()=>{var ge;const $=z.current;if(!$||!n||t.length===0)return;const ee=t[0],W=Z.get(ee);if(W==null||W<0)return;const me=I.mode==="grid"?Math.floor(W/Math.max(1,I.columns)):aC(I.rows,W),ye=I.mode==="adaptive"?((ge=ne==null?void 0:ne[me])==null?void 0:ge.start)??0:me*I.rowH;try{$.scrollTop=ye}catch{}},[n,I,ne]);const zt=c.useMemo(()=>new Set(t),[t]),Hn=!!(j&&m&&y),Zt=c.useMemo(()=>Yb(Y,I,e),[e,I,Y]);c.useEffect(()=>{if(!(xe||Zt.length===0))for(const $ of Zt)Ze($)},[xe,Zt,Ze]),c.useEffect(()=>{var $;($=z.current)==null||$.focus()},[]),c.useEffect(()=>{var $;if(h){try{($=z.current)==null||$.blur()}catch{}O(null)}},[h]);const mn=c.useMemo(()=>{const $=new Set;for(const ee of Y){if(I.mode==="adaptive"){const ye=I.rows[ee.index];if(!ye)continue;for(const ge of ye.items)$.add(ge.item.path);continue}const W=ee.index*I.columns,me=Math.min(e.length,W+I.columns);for(let ye=W;ye<me;ye+=1){const ge=e[ye];ge&&$.add(ge.path)}}return $},[e,I,Y]);c.useEffect(()=>{f&&(lC(K.current,mn)||(K.current=mn,f(mn)))},[f,mn]);const ar=N?`cell-${encodeURIComponent(N)}`:void 0;return a.jsx("div",{role:"grid","aria-label":"Gallery",className:`relative h-full overflow-auto p-3 outline-none ${E?"scrollbar-hidden pr-4":"scrollbar-thin"} ${Hn?"cursor-zoom-in":""}`,ref:z,tabIndex:0,"aria-activedescendant":ar,onMouseDown:()=>{var $;return($=z.current)==null?void 0:$.focus()},style:{"--gap":`${dr}px`},children:a.jsxs("div",{className:"relative w-full",style:{height:U.getTotalSize()},children:[Y.map($=>{var ge;let ee=[],W={},me="";if(I.mode==="adaptive"){const ce=I.rows[$.index];if(!ce)return null;ee=ce.items,W={height:ce.height,transform:`translate3d(0, ${$.start}px, 0)`,display:"flex",gap:dr,paddingBottom:dr},me="absolute top-0 left-0 right-0 w-full will-change-transform"}else{const ce=$.index*I.columns;ee=e.slice(ce,ce+I.columns).map(we=>({item:we,displayW:I.cellW,displayH:I.mediaH})),W={transform:`translate3d(0, ${$.start}px, 0)`,gridTemplateColumns:`repeat(${I.columns}, minmax(0, 1fr))`,gap:dr,paddingBottom:dr},me="absolute top-0 left-0 right-0 w-full grid will-change-transform"}const ye=$.index===((ge=Y[0])==null?void 0:ge.index);return a.jsx("div",{className:me,role:"row",style:W,children:ee.map(({item:ce,displayW:Re,displayH:we})=>{const wt=!h&&(R===ce.path||zt.has(ce.path)),Oe=(d==null?void 0:d.get(ce.path))??null,Ne=Oe!=null,St=I.mode==="adaptive"?{width:Re}:{},gn=I.mode==="adaptive"?{height:we}:{},at=I.mode==="adaptive"?"relative rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group shrink-0":"relative aspect-[4/3] rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group";return a.jsxs("div",{id:`cell-${encodeURIComponent(ce.path)}`,className:`relative min-w-0 ${wt?"outline outline-2 outline-accent outline-offset-2 rounded-[10px]":""}`,role:"gridcell","aria-selected":wt,tabIndex:N===ce.path?0:-1,onFocus:()=>O(ce.path),draggable:!0,style:St,onDragStart:Pe=>Jt(ce.path,Pe),onPointerDown:Pe=>hn(ce.path,Pe),onPointerMove:Pn,onPointerUp:pn,onPointerCancel:et,onContextMenu:Pe=>{Pe.preventDefault(),Pe.stopPropagation(),o==null||o(Pe,ce.path)},children:[a.jsxs("div",{className:at,style:gn,onDoubleClick:()=>{r||i(ce.path)},onMouseLeave:Ie,children:[a.jsx("button",{type:"button",className:"grid-item-action-btn touch-manipulation","data-grid-action":"1","aria-label":`Open actions for ${ce.name}`,"aria-haspopup":"menu",onPointerDown:Pe=>Pe.stopPropagation(),onClick:Pe=>{Pe.stopPropagation();const Vn=Pe.currentTarget.getBoundingClientRect();Gt(ce.path,{x:Vn.right-4,y:Vn.bottom-4})},children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})}),a.jsx("div",{className:"cell-content absolute inset-0",children:a.jsx(Mb,{path:ce.path,name:ce.name,selected:wt,highlighted:Ne,highlightKey:Oe,displayW:Re,displayH:we,ioRoot:z.current,isScrolling:xe,priority:ye,onClick:Pe=>ht(ce.path,Pe)})}),a.jsx("div",{className:"absolute right-0 bottom-0 w-7 h-7 cursor-zoom-in",onMouseEnter:()=>lt(ce.path),onMouseLeave:Ie,children:a.jsx("div",{className:"grid-item-preview-corner absolute right-0 bottom-0 h-[18px] w-[18px] flex items-center justify-center text-text select-none",style:{clipPath:'path("M0 9C0 4.02944 4.02944 0 9 0H18V18H0V9Z")',background:"linear-gradient(135deg, rgba(18,18,18,0.9) 0%, rgba(34,34,34,0.9) 60%, rgba(22,22,22,0.9) 100%)",borderTop:"1px solid rgba(255,255,255,0.08)",borderLeft:"1px solid rgba(255,255,255,0.08)",boxShadow:"0 1px 2px rgba(0,0,0,0.45)",backdropFilter:"blur(1px)"},children:a.jsxs("svg",{width:"11",height:"11",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round",className:"text-[#d9dce2]","aria-hidden":"true",style:{transform:"translate(0px,0px)"},children:[a.jsx("circle",{cx:"11",cy:"11",r:"5.4"}),a.jsx("path",{d:"M15.5 15.5 L19 19"})]})})})]}),a.jsxs("div",{className:"flex flex-col items-center text-center gap-0 mt-1 px-0.5 text-white/90",children:[a.jsx("div",{className:"text-sm leading-[18px] thumb-filename line-clamp-2 break-words hyphens-auto text-center",title:ce.name,children:uC(ce.name,u)}),a.jsxs("div",{className:"text-[11px] leading-[15px] opacity-70",children:[ce.w,"  ",ce.h]})]})]},ce.path)})},$.key)}),j&&m&&y&&_u.createPortal(a.jsx("div",{className:"toolbar-offset fixed inset-0 z-[999] flex items-center justify-center pointer-events-none bg-black/20 opacity-100",children:a.jsx("img",{src:m,alt:"preview",className:"max-w-[80vw] max-h-[80vh] object-contain opacity-[0.98]"})}),document.body)]},`${p}-${xt}`)})}const dC=48,fC=[.1,.24,.5,.74,.9];function hC({items:e,metricKey:t,scrollRef:n,sortDir:r}){const{orderedValues:s,numericValues:i}=c.useMemo(()=>{var T;const N=[],O=[];for(const X of e){const J=(T=X.metrics)==null?void 0:T[t],z=J==null||Number.isNaN(J)?null:J;N.push(z),z!=null&&O.push(z)}return{orderedValues:N,numericValues:O}},[e,t]),o=c.useMemo(()=>pC(i,dC),[i]),l=c.useMemo(()=>mC(i,fC),[i]),[u,d]=c.useState(0),[f,h]=c.useState(null),[p,S]=c.useState(!1),w=c.useRef(null);if(c.useEffect(()=>{const N=n.current;if(!N)return;const O=()=>{const T=Math.max(1,N.scrollHeight-N.clientHeight),X=Es(T>0?N.scrollTop/T:0);d(X)};return O(),N.addEventListener("scroll",O,{passive:!0}),window.addEventListener("resize",O),()=>{N.removeEventListener("scroll",O),window.removeEventListener("resize",O)}},[n,e.length]),c.useEffect(()=>{h(null)},[t,e.length]),!o)return null;const E={min:o.min,max:o.max},j=f!=null?Pm(f):null,v=Pm(u),m=r==="desc",x=c.useMemo(()=>f==null?null:yC(s,f),[s,f]);function y(N){h(Es(N))}function k(){h(null)}function R(N){const O=n.current;if(!O)return;const T=Math.max(0,O.scrollHeight-O.clientHeight);O.scrollTop=Es(N)*T}function M(N){var T;const O=(T=w.current)==null?void 0:T.getBoundingClientRect();return O?Es((N.clientY-O.top)/O.height):null}return a.jsxs("div",{className:"absolute right-0 top-3 bottom-3 w-[14px] flex items-stretch pointer-events-auto",children:[a.jsxs("svg",{ref:w,viewBox:"0 0 10 100",preserveAspectRatio:"none",className:"w-full h-full rounded bg-surface-inset border border-border/60 cursor-ns-resize",onPointerDown:N=>{var T;N.preventDefault();const O=M(N);O!=null&&(S(!0),y(O),R(O),(T=w.current)==null||T.setPointerCapture(N.pointerId))},onPointerMove:N=>{const O=M(N);if(O==null){p||k();return}y(O),p&&R(O)},onPointerUp:N=>{var O;S(!1),(O=w.current)==null||O.releasePointerCapture(N.pointerId)},onPointerLeave:()=>{p||k()},children:[gC(o.bins,"var(--border-strong)",{flip:m}),vC(l,E,{flip:m,color:"var(--muted)"}),Rm(v,{color:"var(--highlight)",strokeWidth:.8}),j!=null&&Rm(j,{color:"var(--text-secondary)",strokeWidth:.6,dashed:!0})]}),x!=null&&f!=null&&a.jsx("div",{className:"pointer-events-none absolute right-full mr-2 px-1.5 py-0.5 rounded border border-border bg-surface text-[10px] text-text shadow",style:{top:`calc(${(f*100).toFixed(2)}% - 8px)`},children:wC(x)})]})}function pC(e,t){if(!e.length)return null;const n=Math.min(...e);let r=Math.max(...e);n===r&&(r=n+1);const s=new Array(t).fill(0),i=t/(r-n);for(const o of e){const l=Math.max(0,Math.min(t-1,Math.floor((o-n)*i)));s[l]+=1}return{bins:s,min:n,max:r}}function mC(e,t){if(!e.length)return[];const n=[...e].sort((s,i)=>s-i),r=n.length-1;return t.map(s=>{const i=r*s,o=Math.floor(i),l=Math.ceil(i);if(o===l)return n[o];const u=i-o;return n[o]+(n[l]-n[o])*u})}function gC(e,t,n){const r=Math.max(1,...e),s=100/e.length,i=(n==null?void 0:n.flip)??!1;return e.map((o,l)=>{const u=Math.max(.8,o/r*10),d=(i?e.length-1-l:l)*s;return a.jsx("rect",{x:10-u,y:d,width:u,height:Math.max(.2,s-.2),fill:t,opacity:.9},`sb-${l}`)})}function vC(e,t,n){const r=(n==null?void 0:n.flip)??!1,s=n==null?void 0:n.color;return e.map((i,o)=>{const l=xC(i,t,r),u=o===2;return a.jsx("line",{x1:0,y1:l,x2:10,y2:l,stroke:s,strokeWidth:u?.8:.5,opacity:u?.9:.6,vectorEffect:"non-scaling-stroke"},`qt-${o}-${i}`)})}function Rm(e,t){return a.jsx("line",{x1:0,y1:e,x2:10,y2:e,stroke:t.color,strokeWidth:t.strokeWidth??.6,strokeDasharray:t.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}function yC(e,t){if(!e.length)return null;const n=Math.round(Es(t)*(e.length-1)),r=e[n];if(r!=null)return r;for(let s=1;s<e.length;s++){const i=n-s;if(i>=0&&e[i]!=null)return e[i];const o=n+s;if(o<e.length&&e[o]!=null)return e[o]}return null}function xC(e,t,n){const r=t.max-t.min;if(r===0)return 0;const s=Es((e-t.min)/r);return(n?1-s:s)*100}function Pm(e){return Es(e)*100}function Es(e){return e<0?0:e>1?1:e}function wC(e){if(e==null||Number.isNaN(e))return"-";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function Ns(e,t){const[n,r]=c.useState(null),s=c.useRef(null);return c.useEffect(()=>{if(!e){if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}r(null);return}let i=!0;return e().then(o=>{if(!i)return;const l=URL.createObjectURL(o);if(s.current)try{URL.revokeObjectURL(s.current)}catch{}s.current=l,r(l)}).catch(()=>{}),()=>{i=!1}},t),c.useEffect(()=>()=>{if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}},[]),n}const SC=1.2,bC=.05,CC=8;function Tc(e){return Number(Math.min(CC,Math.max(bC,e)).toFixed(4))}function Tm(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Lm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function kC(e,t){try{e.setPointerCapture(t)}catch{}}function EC(e,t){try{e.releasePointerCapture(t)}catch{}}function NC(){const[e,t]=c.useState(1),[n,r]=c.useState(0),[s,i]=c.useState(0),[o,l]=c.useState(1),[u,d]=c.useState(!1),[f,h]=c.useState(!1),[p,S]=c.useState(!1),w=c.useRef(null),E=c.useRef(null),j=c.useRef(1),v=c.useRef(0),m=c.useRef(0),x=c.useRef(new Map),y=c.useRef(null),k=c.useRef(null),R=(_,P)=>{v.current=_,m.current=P,r(_),i(P)},M=_=>{const P=Tc(_);j.current=P,t(P)},N=(_,P)=>{y.current={pointerId:_,startX:P.x,startY:P.y,startTx:v.current,startTy:m.current},k.current=null,h(!0)},O=()=>{const _=Array.from(x.current.entries());if(_.length<2)return;const[P,D]=_,[H,te]=P,[se,I]=D,U=Tm(te,I);!Number.isFinite(U)||U<=2||(k.current={pointerIds:[H,se],startDistance:U,startCenter:Lm(te,I),startScale:j.current,startTx:v.current,startTy:m.current},y.current=null,h(!0))},T=()=>{const _=w.current,P=E.current;if(!_||!P||!P.naturalWidth||!P.naturalHeight)return;const D=_.getBoundingClientRect(),H=D.width/P.naturalWidth,te=D.height/P.naturalHeight,se=Math.min(1,Math.min(H,te));l(se);const I=P.naturalWidth*se,U=P.naturalHeight*se;R((D.width-I)/2,(D.height-U)/2),M(1)};c.useEffect(()=>{const _=w.current;if(!_)return;const P=new ResizeObserver(()=>{try{requestAnimationFrame(()=>T())}catch{T()}});return P.observe(_),()=>P.disconnect()},[]),c.useEffect(()=>{j.current=e,v.current=n,m.current=s},[e,n,s]),c.useEffect(()=>()=>{x.current.clear(),y.current=null,k.current=null},[]);const X=_=>{_.preventDefault();const P=_.deltaY>0?-1:1,D=w.current;if(!D)return;const H=D.getBoundingClientRect(),te=_.clientX-H.left,se=_.clientY-H.top,I=j.current,U=Tc(I*Math.pow(SC,P));if(U===I)return;const Y=U/I,Z=te-Y*(te-v.current),q=se-Y*(se-m.current);M(U),R(Z,q)},J=_=>{if((_.pointerType??"mouse")==="mouse"&&_.button!==0)return;const D=x.current,H=E.current;if(!H||D.size===0&&_.target!==H)return;const te=_.currentTarget,se=te.getBoundingClientRect();if(!(_.clientX<se.left||_.clientX>se.right||_.clientY<se.top||_.clientY>se.bottom)){if(_.preventDefault(),_.stopPropagation(),D.set(_.pointerId,{x:_.clientX,y:_.clientY}),kC(te,_.pointerId),D.size>=2){O();return}N(_.pointerId,{x:_.clientX,y:_.clientY})}},z=_=>{const P=x.current;if(!P.has(_.pointerId))return;P.set(_.pointerId,{x:_.clientX,y:_.clientY});const D=k.current;if(D){const I=P.get(D.pointerIds[0]),U=P.get(D.pointerIds[1]);if(I&&U){const Y=Tm(I,U);if(Y>2){const Z=Lm(I,U),q=Tc(D.startScale*(Y/D.startDistance)),ne=q/D.startScale,fe=Z.x-ne*(D.startCenter.x-D.startTx),Ee=Z.y-ne*(D.startCenter.y-D.startTy);M(q),R(fe,Ee)}}return}const H=y.current;if(!H||H.pointerId!==_.pointerId)return;const te=_.clientX-H.startX,se=_.clientY-H.startY;R(H.startTx+te,H.startTy+se)},ae=(_,P)=>{const D=x.current;if(!D.has(_))return;if(D.delete(_),EC(P,_),D.size===0){y.current=null,k.current=null,h(!1);return}if(D.size>=2){O();return}const[H,te]=D.entries().next().value;N(H,te)};return{scale:e,setScale:t,tx:n,setTx:r,ty:s,setTy:i,base:o,setBase:l,ready:u,setReady:d,dragging:f,setDragging:h,visible:p,setVisible:S,containerRef:w,imgRef:E,fitAndCenter:T,handleWheel:X,handlePointerDown:J,handlePointerMove:z,handlePointerUp:_=>{ae(_.pointerId,_.currentTarget)},handlePointerCancel:_=>{ae(_.pointerId,_.currentTarget)}}}function jC({path:e,onClose:t,onNavigate:n,canPrev:r=!1,canNext:s=!1,onZoomChange:i,requestedZoomPercent:o,onZoomRequestConsumed:l}){const{scale:u,setScale:d,tx:f,setTx:h,ty:p,setTy:S,base:w,ready:E,setReady:j,dragging:v,visible:m,setVisible:x,containerRef:y,imgRef:k,fitAndCenter:R,handleWheel:M,handlePointerDown:N,handlePointerMove:O,handlePointerUp:T,handlePointerCancel:X}=NC(),J=Ns(()=>Se.getFile(e),[e]),z=Ns(()=>Se.getThumb(e),[e]),ae=c.useCallback(()=>{x(!1),window.setTimeout(t,110)},[t,x]);return c.useEffect(()=>{requestAnimationFrame(()=>{var K;x(!0),(K=y.current)==null||K.focus()})},[e]),c.useEffect(()=>{const K=A=>{A.key==="Escape"?ae():(A.key==="ArrowRight"||A.key==="d")&&n?n(1):(A.key==="ArrowLeft"||A.key==="a")&&n&&n(-1)};return window.addEventListener("keydown",K),()=>window.removeEventListener("keydown",K)},[ae,n]),c.useEffect(()=>{j(!1)},[J]),c.useEffect(()=>{i&&i(w*u*100)},[w,u,i]),c.useEffect(()=>{if(o==null)return;const K=y.current;if(!K){l&&l();return}const A=Math.max(.05,Math.min(8,o/100/Math.max(1e-6,w))),_=K.getBoundingClientRect(),P=_.width/2,D=_.height/2;d(H=>{const te=A/H;return h(se=>P-te*(P-se)),S(se=>D-te*(D-se)),Number(A.toFixed(4))}),l&&l()},[o,w,l]),a.jsxs("div",{ref:y,role:"dialog","aria-modal":!0,"aria-label":"Image viewer",tabIndex:-1,className:`toolbar-offset touch-none absolute inset-0 left-[var(--left)] right-[var(--right)] flex items-start justify-start bg-panel z-viewer overflow-hidden transition-opacity duration-[110ms] ease-out cursor-grab focus:outline-none focus-visible:outline-none ${v?"cursor-grabbing select-none":""} ${m?"opacity-100":"opacity-0"}`,style:{outline:"none"},onClick:ae,onWheel:M,onPointerDown:N,onPointerMove:O,onPointerUp:T,onPointerCancel:X,onKeyDown:K=>{K.key==="Tab"&&K.preventDefault()},children:[a.jsxs("button",{"aria-label":"Close",onClick:K=>{K.stopPropagation(),ae()},className:"btn btn-sm absolute top-3 right-3 z-10",title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]}),z&&a.jsx("img",{src:z,alt:"thumb",className:"absolute top-0 left-0 max-w-none max-h-none object-contain pointer-events-none transition-opacity duration-[110ms] ease-out",draggable:!1,onDragStart:K=>K.preventDefault(),style:{transform:`translate(${f}px, ${p}px) scale(${w})`,transformOrigin:"0 0",opacity:E?0:.5,filter:"blur(0.25px)"}}),J&&a.jsx("img",{ref:k,src:J,alt:"viewer",className:"max-w-none max-h-none object-contain transition-opacity duration-[110ms] ease-out will-change-transform select-none",draggable:!1,onDragStart:K=>{K.preventDefault()},onLoad:K=>{R(),d(1);try{requestAnimationFrame(()=>j(!0))}catch{j(!0)}},onClick:K=>K.stopPropagation(),style:{transform:`translate(${f}px, ${p}px) scale(${w*u})`,transformOrigin:"0 0",opacity:E?.99:0,WebkitUserDrag:"none"}}),n&&a.jsxs("div",{className:"viewer-mobile-nav",onClick:K=>K.stopPropagation(),children:[a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${r?"":"is-disabled"}`,onClick:()=>r&&n(-1),"aria-label":"Previous image","aria-disabled":!r,disabled:!r,children:"Prev"}),a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${s?"":"is-disabled"}`,onClick:()=>s&&n(1),"aria-label":"Next image","aria-disabled":!s,disabled:!s,children:"Next"})]})]})}function mh(e){return!e||!(e instanceof HTMLElement)?!1:e.closest('input, textarea, [contenteditable="true"]')!==null}const MC=1.2,RC=.05,PC=8;function Lc(e){return Number(Math.min(PC,Math.max(RC,e)).toFixed(4))}function _m(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Im(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function TC(e,t){try{e.setPointerCapture(t)}catch{}}function LC(e,t){try{e.releasePointerCapture(t)}catch{}}function _C(){const[e,t]=c.useState(1),[n,r]=c.useState(0),[s,i]=c.useState(0),[o,l]=c.useState(0),[u,d]=c.useState(0),[f,h]=c.useState(1),[p,S]=c.useState(1),[w,E]=c.useState(!1),j=c.useRef(null),v=c.useRef(null),m=c.useRef(null),x=c.useRef(1),y=c.useRef(0),k=c.useRef(0),R=c.useRef(0),M=c.useRef(0),N=c.useRef(new Map),O=c.useRef(null),T=c.useRef(null),X=c.useCallback(I=>{y.current=I.txA,k.current=I.tyA,R.current=I.txB,M.current=I.tyB,r(I.txA),i(I.tyA),l(I.txB),d(I.tyB)},[]),J=c.useCallback(I=>{const U=Lc(I);x.current=U,t(U)},[]),z=c.useCallback((I,U)=>{O.current={pointerId:I,startX:U.x,startY:U.y,startTxA:y.current,startTyA:k.current,startTxB:R.current,startTyB:M.current},T.current=null,E(!0)},[]),ae=c.useCallback(()=>{const I=Array.from(N.current.entries());if(I.length<2)return;const[U,Y]=I,[Z,q]=U,[ne,fe]=Y,Ee=_m(q,fe);!Number.isFinite(Ee)||Ee<=2||(T.current={pointerIds:[Z,ne],startDistance:Ee,startCenter:Im(q,fe),startScale:x.current,startTxA:y.current,startTyA:k.current,startTxB:R.current,startTyB:M.current},O.current=null,E(!0))},[]),K=c.useCallback((I,U)=>{const Y=N.current;if(!Y.has(I))return;if(Y.delete(I),LC(U,I),Y.size===0){O.current=null,T.current=null,E(!1);return}if(Y.size>=2){ae();return}const[Z,q]=Y.entries().next().value;z(Z,q)},[z,ae]),A=c.useCallback(()=>{const I=j.current;if(!I)return;const U=I.getBoundingClientRect(),Y=ne=>{if(!ne||!ne.naturalWidth||!ne.naturalHeight)return;const fe=U.width/ne.naturalWidth,Ee=U.height/ne.naturalHeight,xe=Math.min(1,Math.min(fe,Ee)),De=ne.naturalWidth*xe,be=ne.naturalHeight*xe;return{base:xe,tx:(U.width-De)/2,ty:(U.height-be)/2}},Z=Y(v.current);Z&&(h(Z.base),y.current=Z.tx,k.current=Z.ty,r(Z.tx),i(Z.ty));const q=Y(m.current);q&&(S(q.base),R.current=q.tx,M.current=q.ty,l(q.tx),d(q.ty))},[]);c.useEffect(()=>{const I=j.current;if(!I)return;const U=new ResizeObserver(()=>{try{requestAnimationFrame(()=>A())}catch{A()}});return U.observe(I),()=>U.disconnect()},[A]);const _=c.useCallback(()=>{J(1),A()},[A,J]);c.useEffect(()=>{x.current=e,y.current=n,k.current=s,R.current=o,M.current=u},[e,n,s,o,u]),c.useEffect(()=>()=>{N.current.clear(),O.current=null,T.current=null},[]);const P=c.useCallback(I=>{I.preventDefault();const U=I.deltaY>0?-1:1,Y=j.current;if(!Y)return;const Z=Y.getBoundingClientRect(),q=I.clientX-Z.left,ne=I.clientY-Z.top,fe=x.current,Ee=Lc(fe*Math.pow(MC,U));if(Ee===fe)return;const xe=Ee/fe;J(Ee),X({txA:q-xe*(q-y.current),tyA:ne-xe*(ne-k.current),txB:q-xe*(q-R.current),tyB:ne-xe*(ne-M.current)})},[X,J]),D=c.useCallback(I=>{if((I.pointerType??"mouse")==="mouse"&&I.button!==0)return;const Y=I.currentTarget;if(I.preventDefault(),N.current.set(I.pointerId,{x:I.clientX,y:I.clientY}),TC(Y,I.pointerId),N.current.size>=2){ae();return}z(I.pointerId,{x:I.clientX,y:I.clientY})},[z,ae]),H=c.useCallback(I=>{const U=N.current;if(!U.has(I.pointerId))return;U.set(I.pointerId,{x:I.clientX,y:I.clientY});const Y=T.current;if(Y){const fe=U.get(Y.pointerIds[0]),Ee=U.get(Y.pointerIds[1]);if(fe&&Ee){const xe=_m(fe,Ee);if(xe>2){const De=Im(fe,Ee),be=Lc(Y.startScale*(xe/Y.startDistance)),Ie=be/Y.startScale;J(be),X({txA:De.x-Ie*(Y.startCenter.x-Y.startTxA),tyA:De.y-Ie*(Y.startCenter.y-Y.startTyA),txB:De.x-Ie*(Y.startCenter.x-Y.startTxB),tyB:De.y-Ie*(Y.startCenter.y-Y.startTyB)})}}return}const Z=O.current;if(!Z||Z.pointerId!==I.pointerId)return;const q=I.clientX-Z.startX,ne=I.clientY-Z.startY;X({txA:Z.startTxA+q,tyA:Z.startTyA+ne,txB:Z.startTxB+q,tyB:Z.startTyB+ne})},[X,J]),te=c.useCallback(I=>{K(I.pointerId,I.currentTarget)},[K]),se=c.useCallback(I=>{K(I.pointerId,I.currentTarget)},[K]);return{scale:e,baseA:f,baseB:p,txA:n,tyA:s,txB:o,tyB:u,dragging:w,containerRef:j,imgARef:v,imgBRef:m,fitAndCenter:A,resetView:_,handleWheel:P,handlePointerDown:D,handlePointerMove:H,handlePointerUp:te,handlePointerCancel:se}}function IC({aItem:e,bItem:t,index:n,total:r,canPrev:s,canNext:i,onNavigate:o,onClose:l}){const u=c.useRef(null),[d,f]=c.useState(50),[h,p]=c.useState(!1),[S,w]=c.useState(!1),{scale:E,baseA:j,baseB:v,txA:m,tyA:x,txB:y,tyB:k,dragging:R,containerRef:M,imgARef:N,imgBRef:O,fitAndCenter:T,resetView:X,handleWheel:J,handlePointerDown:z,handlePointerMove:ae,handlePointerUp:K,handlePointerCancel:A}=_C(),_=(e==null?void 0:e.path)??null,P=(t==null?void 0:t.path)??null,D=(e==null?void 0:e.name)??_??"Select an image",H=(t==null?void 0:t.name)??P??"Select another image";c.useEffect(()=>{requestAnimationFrame(()=>{var ne;return(ne=u.current)==null?void 0:ne.focus()})},[_,P]),c.useEffect(()=>{X(),p(!1),w(!1)},[_,P,X]),c.useEffect(()=>{const ne=fe=>{if(!mh(fe.target)){if(fe.key==="Escape"){fe.preventDefault(),l();return}if((fe.key==="ArrowRight"||fe.key==="d")&&i){fe.preventDefault(),o(1);return}(fe.key==="ArrowLeft"||fe.key==="a")&&s&&(fe.preventDefault(),o(-1))}};return window.addEventListener("keydown",ne),()=>window.removeEventListener("keydown",ne)},[l,o,s,i]);const te=Ns(_?()=>Se.getFile(_):null,[_]),se=Ns(P?()=>Se.getFile(P):null,[P]),I=Ns(_?()=>Se.getThumb(_):null,[_]),U=Ns(P?()=>Se.getThumb(P):null,[P]),Y=c.useCallback(ne=>Math.min(95,Math.max(5,ne)),[]),Z=c.useCallback(ne=>{const fe=ne.target;fe!=null&&fe.closest(".compare-label")||fe!=null&&fe.closest(".compare-divider-hit")||z(ne)},[z]),q=c.useCallback(ne=>{const fe=M.current;if(!fe)return;ne.preventDefault(),ne.stopPropagation();const Ee=fe.getBoundingClientRect(),xe=ne.currentTarget;xe.setPointerCapture(ne.pointerId);const De=Ie=>{const lt=(Ie.clientX-Ee.left)/Ee.width*100;f(Y(lt))},be=Ie=>{try{xe.releasePointerCapture(Ie.pointerId)}catch{}window.removeEventListener("pointermove",De),window.removeEventListener("pointerup",be),window.removeEventListener("pointercancel",be)};window.addEventListener("pointermove",De),window.addEventListener("pointerup",be),window.addEventListener("pointercancel",be)},[Y]);return a.jsxs("div",{ref:u,role:"dialog","aria-modal":!0,"aria-label":"Compare images",tabIndex:-1,className:"toolbar-offset absolute inset-0 left-[var(--left)] right-[var(--right)] bg-panel z-viewer flex flex-col overflow-hidden focus:outline-none",onKeyDown:ne=>{ne.key==="Tab"&&ne.preventDefault()},children:[a.jsxs("div",{className:"compare-header flex items-center gap-3 px-3 py-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Compare"}),a.jsx("div",{className:"text-xs text-muted",children:r>=2?`${n+1}-${Math.min(n+2,r)} of ${r}`:"Select 2 images"}),a.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(-1),disabled:!s,title:"Previous (Left Arrow or A)",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Prev"]}),a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(1),disabled:!i,title:"Next (Right Arrow or D)",children:["Next",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"btn btn-sm",onClick:l,title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]})]})]}),a.jsx("div",{className:"flex-1 min-h-0 p-3 bg-panel",children:a.jsx("div",{ref:M,className:`compare-stage ${R?"is-dragging":""}`,onWheel:J,onPointerDown:Z,onPointerMove:ae,onPointerUp:K,onPointerCancel:A,children:!e||!t?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-sm text-muted",children:"Select 2 images to compare."}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"compare-label left-3",children:[a.jsx("span",{className:"compare-label-tag",children:"A"}),a.jsx("span",{className:"truncate",title:e.path,children:D})]}),a.jsxs("div",{className:"compare-label right-3",children:[a.jsx("span",{className:"compare-label-tag",children:"B"}),a.jsx("span",{className:"truncate",title:t.path,children:H})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 ${100-d}% 0 0)`},children:[I&&a.jsx("img",{src:I,alt:"thumb A",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:ne=>ne.preventDefault(),style:{transform:`translate(${m}px, ${x}px) scale(${j})`,transformOrigin:"0 0",opacity:h?0:.5}}),te&&a.jsx("img",{ref:N,src:te,alt:"compare A",className:"compare-image",draggable:!1,onDragStart:ne=>ne.preventDefault(),onLoad:()=>{T();try{requestAnimationFrame(()=>p(!0))}catch{p(!0)}},style:{transform:`translate(${m}px, ${x}px) scale(${j*E})`,transformOrigin:"0 0",opacity:h?.99:0}})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 0 0 ${d}%)`},children:[U&&a.jsx("img",{src:U,alt:"thumb B",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:ne=>ne.preventDefault(),style:{transform:`translate(${y}px, ${k}px) scale(${v})`,transformOrigin:"0 0",opacity:S?0:.5}}),se&&a.jsx("img",{ref:O,src:se,alt:"compare B",className:"compare-image",draggable:!1,onDragStart:ne=>ne.preventDefault(),onLoad:()=>{T();try{requestAnimationFrame(()=>w(!0))}catch{w(!0)}},style:{transform:`translate(${y}px, ${k}px) scale(${v*E})`,transformOrigin:"0 0",opacity:S?.99:0}})]}),a.jsxs("div",{className:"compare-divider-hit",style:{left:`${d}%`},onPointerDown:q,children:[a.jsx("div",{className:"compare-divider-line"}),a.jsx("div",{className:"compare-divider-handle"})]})]})})})]})}function Ou(){const[e,t]=c.useState(Cb());return c.useEffect(()=>bb(t),[]),e}const cl=e=>["item",e],FC={v:1,tags:[],notes:"",version:1,updated_at:"",updated_by:"web"},Ln=new Map,_a=new Map,tf=new Map,gh=new Map;let Fm=0;const lr=new Map,Lo=new Map,OC=12e3,nf=new Set,rf=new Set;let vh={state:"idle"},dl=null,sf=0;function fa(e){vh=e;for(const t of nf)t(e)}function br(){const e=lr.size>0,t=Ln.size+_a.size+sf;if(e){fa({state:"error",message:"Conflict detected"});return}if(dl){fa({state:"error",message:dl});return}if(t>0){fa({state:"syncing"});return}fa({state:"idle"})}function yh(){let e=null;for(const t of tf.values())e=e==null?t:Math.min(e,t);for(const t of gh.values())e=e==null?t:Math.min(e,t);return e}function du(){const e=yh();for(const t of rf)t(e)}function fu(e){dl=e,br()}function kx(){dl&&(dl=null,br())}function Om(e){sf=Math.max(0,sf+e),br()}function AC(){Fm+=1;const e=Fm;return gh.set(e,Date.now()),du(),e}function DC(e){e!=null&&gh.delete(e)&&du()}function Au(e){const t=Lo.get(e);if(!t||!t.size)return;const n=lr.get(e)??null;for(const r of t)r(n)}function Am(e){return lr.get(e)??null}function Du(e){lr.delete(e)&&(Au(e),br())}function zC(e,t){lr.set(e,t),Au(e),br()}function $C(e,t){const n=Lo.get(e)??new Set;return n.add(t),Lo.set(e,n),t(lr.get(e)??null),()=>{const r=Lo.get(e);r&&(r.delete(t),r.size||Lo.delete(e))}}function BC(e){const[t,n]=c.useState(()=>e?Am(e):null);return c.useEffect(()=>{if(!e){n(null);return}return n(Am(e)),$C(e,n)},[e]),t}function UC(e){return nf.add(e),e(vh),()=>{nf.delete(e)}}function HC(){const[e,t]=c.useState(vh);return c.useEffect(()=>UC(t),[]),e}function VC(e){return rf.add(e),e(yh()),()=>{rf.delete(e)}}function WC(){const[e,t]=c.useState(()=>yh()),[n,r]=c.useState(()=>e==null?null:Date.now()-e);return c.useEffect(()=>VC(t),[]),c.useEffect(()=>{if(e==null){r(null);return}r(Date.now()-e);const s=window.setInterval(()=>{r(Date.now()-e)},1e3);return()=>window.clearInterval(s)},[e]),n}function of(e){const t={};return Object.prototype.hasOwnProperty.call(e,"star")&&(t.set_star=e.star??null),Object.prototype.hasOwnProperty.call(e,"notes")&&(t.set_notes=e.notes??""),Object.prototype.hasOwnProperty.call(e,"tags")&&(t.set_tags=Array.isArray(e.tags)?e.tags:[]),t}function lf(e){var t,n;return e.set_star!==void 0||e.set_notes!==void 0||e.set_tags!==void 0||(((t=e.add_tags)==null?void 0:t.length)??0)>0||(((n=e.remove_tags)==null?void 0:n.length)??0)>0}function bo(e){const t=[],n=new Set;for(const r of e??[]){if(typeof r!="string")continue;const s=r.trim();!s||n.has(s)||(n.add(s),t.push(s))}return t}function QC(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function KC(e,t){if(e.set_star!==void 0&&(t.star??null)!==e.set_star||e.set_notes!==void 0&&(t.notes??"")!==(e.set_notes??""))return!1;if(e.set_tags!==void 0){const r=bo(e.set_tags),s=bo(t.tags);return QC(r,s)}const n=bo(t.tags);for(const r of bo(e.add_tags))if(!n.includes(r))return!1;for(const r of bo(e.remove_tags))if(n.includes(r))return!1;return!0}function Ex(e,t,n){if(n instanceof an&&n.status===409){const r=n.body;if(r!=null&&r.current)return zC(e,{path:e,current:r.current,pending:t,receivedAt:new Date().toISOString()}),!0}return!1}function YC(e,t){const n=lr.get(e);if(n){if(KC(n.pending,t)){Du(e);return}lr.set(e,{...n,current:t}),Au(e),br()}}function XC(e){const t=Ou();return Iu({queryKey:cl(e),queryFn:()=>Se.getSidecar(e),enabled:!!e,staleTime:3e4,gcTime:5*6e4,retry:2,refetchInterval:t?OC:!1,refetchIntervalInBackground:t})}function qC(e){const t=Ys();return $S({mutationFn:async({patch:n,baseVersion:r,idempotencyKey:s})=>{const i=of(n);if(!lf(i))return t.getQueryData(cl(e))??FC;const o={...i,base_version:r};try{return await Se.patchSidecar(e,o,{idempotencyKey:s??ul("patch"),ifMatch:r})}catch(l){throw Ex(e,i,l),l}},retry:(n,r)=>r instanceof an&&r.status===409?!1:n<2,retryDelay:n=>Math.min(1e3*Math.pow(2,n),4e3),onMutate:()=>(kx(),Om(1),{inflightId:AC()}),onSuccess:n=>{Du(e),t.setQueryData(cl(e),n)},onError:n=>{n instanceof an&&n.status===409||(n instanceof an?fu(n.message):fu("Failed to save"))},onSettled:(n,r,s,i)=>{Om(-1),DC(i==null?void 0:i.inflightId)}})}const GC=6;async function Dm(e,t){if(!e.length)return;let n=0;const r=[],s=async()=>{for(;n<e.length;){const o=n++,l=e[o];try{await Nx(l,t)}catch(u){r.push({path:l,error:u}),console.error(`[bulkUpdateSidecars] Failed for ${l}:`,u)}}},i=Array.from({length:Math.min(GC,e.length)},()=>s());if(await Promise.all(i),r.length===e.length)throw new Error(`All ${e.length} sidecar updates failed`)}async function Nx(e,t){const n=Ln.get(e)||{};Ln.set(e,{...n,...t}),kx(),br();const r=_a.get(e);if(r)return r;tf.set(e,Date.now()),du();const s=(async()=>{try{for(;Ln.has(e);){const i=Ln.get(e);if(!i)break;const o=of(i);if(!lf(o)){Ln.get(e)===i&&Ln.delete(e);continue}let l=1;try{l=(await Se.getSidecar(e)).version??1}catch{l=1}const u={...o,base_version:l};try{await Se.patchSidecar(e,u,{idempotencyKey:ul("patch"),ifMatch:l}),Du(e),Ln.get(e)===i&&Ln.delete(e)}catch(d){if(Ex(e,o,d)){const h=Ln.get(e);if(h&&h!==i){const p=of(h);if(lf(p)){const S=lr.get(e);S&&(lr.set(e,{...S,pending:p}),Au(e))}}Ln.delete(e)}else d instanceof an?fu(d.message):fu("Failed to save");throw d}}}finally{_a.delete(e),tf.delete(e),du(),br()}})();return _a.set(e,s),br(),s}function _c(e){const t=["B","KB","MB","GB","TB"];let n=0,r=e;for(;r>=1024&&n<t.length-1;)r/=1024,n+=1;return`${r.toFixed(1)} ${t[n]}`}function Ic(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function JC(e,t=28){if(e.length<=t)return e;const n=Math.max(4,Math.floor((t-1)/2));return`${e.slice(0,n)}${e.slice(-n)}`}const ZC=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"});function ek(e){const t=e.trim();return!t||/[zZ]|[+-]\d{2}:?\d{2}$/.test(t)?t:`${t.includes("T")?t:t.replace(" ","T")}Z`}function jx(e){if(!e)return null;const t=Date.parse(ek(e));return Number.isFinite(t)?t:null}function tk(e,t=Date.now()){const n=Math.max(0,t-e),r=Math.max(1,Math.floor(n/1e3));if(r<60)return`${r} second${r===1?"":"s"} ago`;const s=Math.floor(r/60);if(s<60)return`${s} minute${s===1?"":"s"} ago`;const i=Math.floor(s/60);return`${i} hour${i===1?"":"s"} ago`}function nk(e){return ZC.format(new Date(e))}function rk(e,t){const n=sk(e)||"view",r=new Set(t.map(i=>i.id));if(!r.has(n))return n;let s=2;for(;r.has(`${n}-${s}`);)s+=1;return`${n}-${s}`}function sk(e){return e.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function Fc(e){const t=e.filter(s=>s>0).sort((s,i)=>i-s),n=e.includes(0),r=[...t.map(s=>String(s))];return n&&r.push("None"),r.join(", ")}function ik(e,t){return e&&t?`${e} to ${t}`:e?`from ${e}`:t?`to ${t}`:""}function ok(e){if(e==="/"||e==="")return"Root";const t=e.split("/").filter(Boolean);return t.length?t.length<=2?`/${t.join("/")}`:`.../${t.slice(-2).join("/")}`:"Root"}function lk(e,t){return`${zm(e)}${zm(t)}`}function zm(e){const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function ak(e){const t=e.toLowerCase();return t.endsWith(".png")?"image/png":t.endsWith(".webp")?"image/webp":"image/jpeg"}function uk(e,t){const n=e.split("/").pop()??e;return{path:e,name:n,type:ak(e),w:0,h:0,size:0,hasThumb:!0,hasMeta:!1,star:t??null}}function Uo(e,t){const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}const $m=2,Bm=120,Um=!0;function ck(e){return e.replace(/[\u0000-\u001f\u007f]/g,"").trim()}function dk(e){const n=e.replace(/\r\n?/g,`
`).replace(/\n+$/g,"");return n?n.split(`
`):[]}function fk(e){const{pathA:t,pathB:n,labelsText:r,embedMetadata:s,reverseOrder:i}=e;if(!t||!n)return{ok:!1,message:"Comparison export requires both A and B image paths."};const o=dk(r);if(o.length>$m)return{ok:!1,message:`Enter at most ${$m} label lines (line 1 = A, line 2 = B).`};const l=o.map(h=>ck(h));if(l.some(h=>h.length>Bm))return{ok:!1,message:`Each label must be at most ${Bm} characters.`};const d=l.some(h=>h.length>0)?l:void 0,f={v:1,paths:[t,n],embed_metadata:s,reverse_order:i};return d&&(f.labels=d),{ok:!0,payload:f}}function Co(e){return String(e).padStart(2,"0")}function hk(e,t=new Date){const n=t.getUTCFullYear(),r=Co(t.getUTCMonth()+1),s=Co(t.getUTCDate()),i=Co(t.getUTCHours()),o=Co(t.getUTCMinutes()),l=Co(t.getUTCSeconds());return`comparison${e?"_reverse":""}_${n}${r}${s}_${i}${o}${l}.png`}function Ti(e){if(Array.isArray(e))return e.map(Ti);if(e&&typeof e=="object")return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,Ti(n)]));if(typeof e=="string"){const t=e.trim();if(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]")||t.startsWith('"')&&t.endsWith('"'))try{const r=JSON.parse(t);return Ti(r)}catch{return e}}return e}function ko(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function pk(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function Hm(e){return e.split(",").map(t=>t.trim()).filter(Boolean)}const ha=2;function Ho(e,t,n){if(e===null)return'<span style="color:var(--json-literal)">null</span>';if(e===void 0)return'<span style="color:var(--json-fallback)">undefined</span>';if(typeof e=="string")return`<span style="color:var(--json-string)">${ko(JSON.stringify(e))}</span>`;if(typeof e=="number")return`<span style="color:var(--json-number)">${ko(String(e))}</span>`;if(typeof e=="boolean")return`<span style="color:var(--json-literal)">${e?"true":"false"}</span>`;if(Array.isArray(e)){if(e.length===0)return"[]";const r=" ".repeat(n),s=" ".repeat(n+ha);let i=`[
`;return e.forEach((o,l)=>{const u=Ho(o,[...t,l],n+ha);i+=`${s}${u}${l<e.length-1?",":""}
`}),i+=`${r}]`,i}if(zu(e)){const r=Object.keys(e);if(!r.length)return"{}";const s=" ".repeat(n),i=" ".repeat(n+ha);let o=`{
`;return r.forEach((l,u)=>{const d=ko(JSON.stringify([...t,l])),f=ko(JSON.stringify(l)),h=`<span class="ui-json-key" data-json-path='${d}' style="color:var(--json-key)">${f}</span>`,p=Ho(e[l],[...t,l],n+ha);o+=`${i}${h}: ${p}${u<r.length-1?",":""}
`}),o+=`${s}}`,o}return`<span style="color:var(--json-fallback)">${ko(String(e))}</span>`}function Oc(e,t){if(!e)return null;const n=Ti(e);if(!t&&zu(n)&&"pil_info"in n){const r={};for(const[s,i]of Object.entries(n))r[s]=s==="pil_info"?"Hidden (toggle Show PIL info to expand)":i;return r}return n}function hu(e){return e==null?String(e):typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):Array.isArray(e)?`[${e.map(hu).join(",")}]`:typeof e=="object"?`{${Object.entries(e).sort(([n],[r])=>n.localeCompare(r)).map(([n,r])=>`${n}:${hu(r)}`).join(",")}}`:String(e)}function pa(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return String(e);try{return JSON.stringify(e,null,1)}catch{return String(e)}}function zu(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function Mx(e){return e==="pil_info"||e.startsWith("pil_info.")||e.startsWith("pil_info[")}function af(e,t){if(typeof t=="number")return e?`${e}[${t}]`:`[${t}]`;const n=/^[A-Za-z0-9_$-]+$/.test(t);return e?n?`${e}.${t}`:`${e}["${t}"]`:n?t:`["${t}"]`}function Ac(e){let t="";for(const n of e)t=af(t,n);return t||"(root)"}function Dc(e,t){let n=e;for(const r of t){if(typeof r=="number"){if(!Array.isArray(n))return;n=n[r];continue}if(!zu(n))return;n=n[r]}return n}function Vm(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e;try{return JSON.stringify(e,null,1)}catch{return String(e)}}function pu(e,t,n,r,s){if(s.skipPilInfo&&Mx(t))return;const i=t||"(root)";if(r>=s.maxDepth){n.set(i,e);return}if(Array.isArray(e)){if(!e.length){n.set(i,[]);return}if(e.length>s.maxArray){n.set(i,e);return}e.forEach((o,l)=>pu(o,af(t,l),n,r+1,s));return}if(zu(e)){const o=Object.keys(e).sort((l,u)=>l.localeCompare(u));if(!o.length){n.set(t||"(root)",{});return}for(const l of o)s.skipPilInfo&&!t&&l==="pil_info"||pu(e[l],af(t,l),n,r+1,s);return}n.set(i,e)}const mk=["overview","compare","basics","metadata","notes"],Wm="lenslet.inspector.sections",Qm="lenslet.inspector.metricsExpanded",zc=12,Km=120,gk=8,vk=80,yk={overview:!0,compare:!0,metadata:!0,basics:!0,notes:!0};function Eo({title:e,open:t,onToggle:n,actions:r,children:s,contentClassName:i}){const[o,l]=c.useState(t),[u,d]=c.useState(t?"open":"closed");return c.useEffect(()=>{if(t){l(!0);const h=window.requestAnimationFrame(()=>d("open"));return()=>window.cancelAnimationFrame(h)}d("closing");const f=window.setTimeout(()=>{l(!1),d("closed")},140);return()=>window.clearTimeout(f)},[t]),a.jsxs("div",{className:"border-b border-border/60",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[a.jsxs("button",{type:"button",onClick:n,"aria-expanded":t,className:"flex items-center gap-2 inspector-section-title hover:text-text transition-colors",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`transition-transform ${t?"rotate-90":""}`,"aria-hidden":"true",children:a.jsx("path",{d:"m9 18 6-6-6-6"})}),a.jsx("span",{children:e})]}),r]}),o&&a.jsx("div",{className:"inspector-section-body","data-state":u,"aria-hidden":!t,children:a.jsx("div",{className:i??"px-3 pb-3",children:s})})]})}function xk({path:e,selectedPaths:t=[],items:n=[],compareActive:r=!1,compareA:s=null,compareB:i=null,onResize:o,onStarChanged:l,sortSpec:u,onFindSimilar:d,embeddingsAvailable:f=!1,embeddingsLoading:h=!1,onLocalTypingChange:p}){const S=!!e,{data:w,isLoading:E}=XC(e??""),j=qC(e??""),v=Ys(),[m,x]=c.useState(yk),y=c.useCallback(F=>{x(oe=>({...oe,[F]:!oe[F]}))},[]),[k,R]=c.useState(!1),M=t.length>1,N=!!d&&f&&!M,O=d?f?M?"Select a single image to search.":null:h?"Loading embeddings...":"No embeddings detected.":null,[T,X]=c.useState(""),[J,z]=c.useState(""),[ae,K]=c.useState(null),[A,_]=c.useState(null),[P,D]=c.useState("idle"),[H,te]=c.useState(!1),[se,I]=c.useState(null),U=c.useRef(null),[Y,Z]=c.useState(!1),[q,ne]=c.useState("idle"),[fe,Ee]=c.useState(null),[xe,De]=c.useState(null),[be,Ie]=c.useState(null),[lt,xt]=c.useState(!1),[fn,Un]=c.useState(!1),[qt,Ze]=c.useState(!1),[Gt,Dt]=c.useState(null),[hn,Pn]=c.useState(null),[pn,et]=c.useState(null),ht=c.useRef(null),Jt=c.useRef(0),[zt,Hn]=c.useState(""),[Zt,mn]=c.useState(Um),[ar,$]=c.useState(null),[ee,W]=c.useState(null),[me,ye]=c.useState(null),[ge,ce]=c.useState({}),Re=c.useRef(!1),we=c.useCallback(F=>{Re.current!==F&&(Re.current=F,p==null||p(F))},[p]),Oe=c.useMemo(()=>{var oe;return((oe=n.find(le=>le.path===e))==null?void 0:oe.star)??null},[n,e])??(w==null?void 0:w.star)??null,Ne=BC(M?null:e),St={tags:!!(Ne!=null&&Ne.pending.set_tags),notes:(Ne==null?void 0:Ne.pending.set_notes)!==void 0,star:(Ne==null?void 0:Ne.pending.set_star)!==void 0},gn=c.useMemo(()=>{const F=new Set(t);return n.filter(oe=>F.has(oe.path))},[n,t]),at=c.useMemo(()=>gn.reduce((F,oe)=>F+(oe.size||0),0),[gn]);c.useEffect(()=>{w&&(X((w.tags||[]).join(", ")),z(w.notes||"")),K(null),_(null),D("idle"),te(!1),I(null),U.current&&(window.clearTimeout(U.current),U.current=null),Z(!1),we(!1)},[w==null?void 0:w.updated_at,we,e]),c.useEffect(()=>()=>{U.current&&(window.clearTimeout(U.current),U.current=null),ht.current&&(window.clearTimeout(ht.current),ht.current=null),we(!1)},[we]);const Pe=c.useCallback(F=>{if(M&&t.length){Dm(t,F);return}if(!e)return;const oe=(w==null?void 0:w.version)??1;j.mutate({patch:F,baseVersion:oe,idempotencyKey:ul("patch")})},[M,t,e,w==null?void 0:w.version,j]),Vn=c.useCallback(F=>{z(F),we(!0)},[we]),$u=c.useCallback(()=>{Pe({notes:J}),we(!1)},[Pe,J,we]),bl=c.useCallback(F=>{X(F),we(!0)},[we]),vn=c.useCallback(()=>{Pe({tags:Hm(T)}),we(!1)},[Pe,we,T]),Cl=c.useCallback(()=>{if(!Ne||!e)return;const F={};Ne.pending.set_tags!==void 0&&(F.tags=Hm(T)),Ne.pending.set_notes!==void 0&&(F.notes=J),Ne.pending.set_star!==void 0&&(F.star=Oe??null);const oe=Ne.current.version??1;j.mutate({patch:F,baseVersion:oe,idempotencyKey:ul("patch")})},[Ne,e,T,J,Oe,j]),kl=c.useCallback(()=>{if(!Ne||!e)return;const F=Ne.current;X((F.tags||[]).join(", ")),z(F.notes||""),v.setQueryData(cl(e),F),Du(e),l==null||l([e],F.star??null)},[Ne,e,v,l]);c.useEffect(()=>{if(!e)return;const F=oe=>{if(mh(oe.target))return;const le=oe.key;if(!/^[0-5]$/.test(le))return;oe.preventDefault();const he=le==="0"?null:Number(le);if(M&&t.length){Pe({star:he}),l==null||l(t,he);return}Pe({star:he}),l==null||l([e],he)};return window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[e,M,t,Pe,l]);const no=Ns(e?()=>Se.getThumb(e):null,[e]),en=e?e.split("/").pop()||e:"",El=c.useMemo(()=>{var oe;if(en.includes("."))return en.slice(en.lastIndexOf(".")+1).toUpperCase();const F=n.find(le=>le.path===e);return(oe=F==null?void 0:F.type)!=null&&oe.includes("/")?F.type.split("/")[1].toUpperCase():""},[en,n,e]),pt=c.useMemo(()=>n.find(F=>F.path===e),[n,e]),Xs=c.useMemo(()=>e?(pt==null?void 0:pt.source)??e:"",[pt,e]),tn=(s==null?void 0:s.path)??null,Rt=(i==null?void 0:i.path)??null,Wn=r&&!!tn&&!!Rt,qs=(s==null?void 0:s.name)??tn??"A",Nl=(i==null?void 0:i.name)??Rt??"B",Bu=c.useCallback(async()=>{if(e){D("loading"),_(null);try{const F=await Se.getMetadata(e);K(F.meta),D("loaded")}catch(F){const oe=F instanceof Error?F.message:"Failed to load metadata";K(null),_(oe),D("error")}}},[e]),Gs=c.useCallback(async(F,oe)=>{const le=Jt.current+1;Jt.current=le,ne("loading"),Ee(null);try{const[he,Le]=await Promise.all([Se.getMetadata(F),Se.getMetadata(oe)]);if(Jt.current!==le)return;De(he.meta),Ie(Le.meta),ne("loaded")}catch(he){if(Jt.current!==le)return;const Le=he instanceof Error?he.message:"Failed to load metadata";De(null),Ie(null),Ee(Le),ne("error")}},[]);c.useEffect(()=>{if(!Wn||!tn||!Rt){Jt.current+=1,ne("idle"),Ee(null),De(null),Ie(null),Un(!1),Ze(!1),Dt(null),Pn(null),et(null),Hn(""),mn(Um),$(null),W(null);return}xt(!1),Un(!1),Ze(!1),Dt(null),Pn(null),et(null),$(null),W(null),Gs(tn,Rt)},[Wn,tn,Rt,Gs]);const Js=c.useMemo(()=>{if(!ae)return"";try{return JSON.stringify(ae,null,1)}catch{return""}},[ae]),yn=c.useMemo(()=>Oc(ae,Y),[ae,Y]),ro=c.useMemo(()=>{if(!xe)return"";try{return JSON.stringify(xe,null,1)}catch{return""}},[xe]),Uu=c.useMemo(()=>{if(!be)return"";try{return JSON.stringify(be,null,1)}catch{return""}},[be]),ps=c.useMemo(()=>Oc(xe,fn),[xe,fn]),Be=c.useMemo(()=>Oc(be,qt),[be,qt]),jl=c.useCallback(()=>{var F;Js&&((F=navigator.clipboard)==null||F.writeText(Js).then(()=>{te(!0),setTimeout(()=>te(!1),1200)}).catch(oe=>{const le=oe instanceof Error?oe.message:"Copy failed";_(le)}))},[Js]),so=c.useMemo(()=>yn?Ho(yn,[],0):"",[yn]),Qn=c.useMemo(()=>ps?Ho(ps,[],0):"",[ps]),ur=c.useMemo(()=>Be?Ho(Be,[],0):"",[Be]),$t=c.useCallback(F=>{I(F),U.current&&window.clearTimeout(U.current),U.current=window.setTimeout(()=>{I(null),U.current=null},900)},[]),Kn=c.useCallback((F,oe)=>{var he;const le=Vm(oe);(he=navigator.clipboard)==null||he.writeText(le).then(()=>{$t(F)}).catch(()=>{})},[$t]),io=c.useCallback((F,oe)=>{F==="A"?Pn(oe):et(oe),ht.current&&window.clearTimeout(ht.current),ht.current=window.setTimeout(()=>{Pn(null),et(null),ht.current=null},900)},[]),ms=c.useCallback((F,oe,le)=>{var Le;const he=Vm(le);(Le=navigator.clipboard)==null||Le.writeText(he).then(()=>{io(F,oe)}).catch(()=>{})},[io]),Zs=c.useCallback(F=>{if(!yn)return;const oe=F.target;if(!oe)return;const le=oe.closest("[data-json-path]");if(!le)return;const he=le.getAttribute("data-json-path");if(!he)return;let Le;try{Le=JSON.parse(he)}catch{return}const ut=Dc(yn,Le);Kn(Ac(Le),ut)},[yn,Kn]),Rr=c.useCallback(F=>{if(!ps)return;const oe=F.target;if(!oe)return;const le=oe.closest("[data-json-path]");if(!le)return;const he=le.getAttribute("data-json-path");if(!he)return;let Le;try{Le=JSON.parse(he)}catch{return}const ut=Dc(ps,Le);ms("A",Ac(Le),ut)},[ps,ms]),Ml=c.useCallback(F=>{if(!Be)return;const oe=F.target;if(!oe)return;const le=oe.closest("[data-json-path]");if(!le)return;const he=le.getAttribute("data-json-path");if(!he)return;let Le;try{Le=JSON.parse(he)}catch{return}const ut=Dc(Be,Le);ms("B",Ac(Le),ut)},[Be,ms]),Rl=c.useCallback(F=>{var le;const oe=F==="A"?ro:Uu;oe&&((le=navigator.clipboard)==null||le.writeText(oe).then(()=>{Dt(F),setTimeout(()=>Dt(he=>he===F?null:he),1200)}).catch(()=>{}))},[ro,Uu]);let oo=yn?"":"PNG metadata not loaded yet.";P==="loading"?oo="Loading metadata":P==="error"&&A&&(oo=A);let ei="Metadata not loaded yet.";q==="loading"?ei="Loading metadata":q==="error"&&fe&&(ei=fe);const Yn=P==="loading",Xn=P==="loaded"&&!!Js,Bt=Xn?"h-48":"h-24";let ti="Load meta";Yn?ti="Loading":Xn&&(ti=H?"Copied":"Copy");const xn=Xn?jl:Bu,Ke=!!ae&&typeof ae=="object"&&!Array.isArray(ae)&&"pil_info"in ae,gs=!!xe&&typeof xe=="object"&&!Array.isArray(xe)&&"pil_info"in xe,lo=!!be&&typeof be=="object"&&!Array.isArray(be)&&"pil_info"in be,wn=M?null:a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[Xn&&Ke&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:()=>Z(F=>!F),disabled:!Xn,children:Y?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[78px]",onClick:xn,disabled:!e||Yn,children:ti})]}),Pl=c.useCallback(()=>{!tn||!Rt||Gs(tn,Rt)},[tn,Rt,Gs]),cr=ar!==null,Tl=c.useCallback(async F=>{if(!tn||!Rt){W("Comparison export requires two selected images.");return}if(cr)return;const oe=fk({pathA:tn,pathB:Rt,labelsText:zt,embedMetadata:Zt,reverseOrder:F});if(!oe.ok){W(oe.message);return}$(F?"reverse":"normal"),W(null);try{const le=await Se.exportComparison(oe.payload);Uo(le,hk(F))}catch(le){const he=le instanceof Error?le.message:"Failed to export comparison.";W(he)}finally{$(null)}},[tn,Rt,cr,Zt,zt]),qn=c.useMemo(()=>{if(!xe||!be)return null;const F=Ti(xe),oe=Ti(be),le=new Map,he=new Map,Le={maxDepth:gk,maxArray:vk,skipPilInfo:!lt};pu(F,"",le,0,Le),pu(oe,"",he,0,Le);const ut=new Set([...le.keys(),...he.keys()]),Gn=[];let vs=0,ni=0,tt=0;const nn=Array.from(ut).sort((bt,_r)=>bt.localeCompare(_r)),ri=!lt;for(const bt of nn){if(ri&&Mx(bt))continue;const _r=le.has(bt),ys=he.has(bt);if(!_r&&ys){ni+=1,Gn.push({key:bt,kind:"onlyB",aText:"",bText:pa(he.get(bt))});continue}if(_r&&!ys){vs+=1,Gn.push({key:bt,kind:"onlyA",aText:pa(le.get(bt)),bText:""});continue}const ao=le.get(bt),uo=he.get(bt),co=hu(ao),Vu=hu(uo);co!==Vu&&(tt+=1,Gn.push({key:bt,kind:"different",aText:pa(ao),bText:pa(uo)}))}const Lr=Math.max(0,Gn.length-Km);return{entries:Lr?Gn.slice(0,Km):Gn,onlyA:vs,onlyB:ni,different:tt,truncatedCount:Lr}},[xe,be,lt]);c.useEffect(()=>{try{const F=localStorage.getItem(Wm);if(!F)return;const oe=JSON.parse(F);if(!oe||typeof oe!="object")return;const le={};for(const he of mk)typeof oe[he]=="boolean"&&(le[he]=oe[he]);Object.keys(le).length>0&&x(he=>({...he,...le}))}catch{}},[]),c.useEffect(()=>{try{localStorage.setItem(Wm,JSON.stringify(m))}catch{}},[m]),c.useEffect(()=>{try{const F=localStorage.getItem(Qm);F==="1"||F==="true"?R(!0):(F==="0"||F==="false")&&R(!1)}catch{}},[]),c.useEffect(()=>{try{localStorage.setItem(Qm,k?"1":"0")}catch{}},[k]);const Pr=c.useCallback((F,oe)=>{var le;oe&&((le=navigator.clipboard)==null||le.writeText(oe).then(()=>{ye(F),setTimeout(()=>ye(he=>he===F?null:he),1e3)}).catch(()=>{}))},[]),Tr=c.useCallback((F,oe)=>{if(oe&&!ge[F]){const le=oe.offsetHeight;le&&ce(he=>he[F]?he:{...he,[F]:le})}},[ge]),Ll="toolbar-offset sidebar-resize-handle absolute bottom-0 left-0";return S?a.jsxs("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:[!M&&a.jsx("div",{className:"p-3 border-b border-border flex justify-center",children:a.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-border w-[220px] h-[160px] bg-panel select-none",children:[no&&a.jsx("img",{src:no,alt:"thumb",className:"block w-full h-full object-contain"}),!!El&&a.jsx("div",{className:"absolute top-1.5 left-1.5 bg-surface border border-border text-text text-xs px-1.5 py-0.5 rounded-md select-none",children:El})]})}),a.jsxs(Eo,{title:M?"Selection":"Item",open:m.overview,onToggle:()=>y("overview"),contentClassName:"px-3 pb-3 space-y-2",actions:d&&a.jsx("button",{type:"button",className:"btn btn-sm",onClick:d,disabled:!N,title:O??"Find similar",children:"Find similar"}),children:[M?a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Selected"}),a.jsxs("div",{className:"inspector-field-value",children:[t.length," files"]})]}),a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Total size"}),a.jsx("div",{className:"inspector-field-value",children:_c(at)})]})]}):a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Filename"}),a.jsx("div",{className:"inspector-field-value break-all",title:en,children:en})]}),O&&a.jsx("div",{className:"text-[11px] text-muted",children:O})]}),r&&Wn&&a.jsx(Eo,{title:"Compare Metadata",open:m.compare,onToggle:()=>y("compare"),actions:a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:Pl,disabled:q==="loading",children:q==="loading"?"Loading":"Reload"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:()=>xt(F=>!F),disabled:q!=="loaded",children:lt?"Hide PIL info":"Include PIL info"})]}),children:a.jsxs("div",{className:"space-y-2 text-[11px]",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] text-muted",children:[a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"A"}),a.jsx("div",{className:"text-text break-all",title:qs,children:qs})]}),a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"B"}),a.jsx("div",{className:"text-text break-all",title:Nl,children:Nl})]})]}),q==="loading"&&a.jsx("div",{className:"text-muted",children:"Loading metadata"}),q==="error"&&fe&&a.jsx("div",{className:"text-danger break-words",children:fe}),q==="loaded"&&qn&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-muted",children:[a.jsxs("span",{children:[qn.different," different  ",qn.onlyA," only A  ",qn.onlyB," only B"]}),a.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:"Deep paths"})]}),qn.entries.length===0?a.jsx("div",{className:"text-muted",children:"No differences found."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2 text-[10px] uppercase tracking-wide text-muted",children:[a.jsx("div",{children:"Path"}),a.jsx("div",{children:"A"}),a.jsx("div",{children:"B"})]}),qn.entries.map(F=>a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2",children:[a.jsx("div",{className:"text-[11px] text-muted font-mono break-all",children:F.key}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:F.aText}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:F.bText})]},F.key)),qn.truncatedCount>0&&a.jsxs("div",{className:"text-muted text-[11px]",children:["+",qn.truncatedCount," more differences not shown."]})]})]}),a.jsxs("div",{className:"grid gap-3 pt-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Metadata A"}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[gs&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:()=>Un(F=>!F),disabled:q!=="loaded",children:fn?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:()=>Rl("A"),disabled:q!=="loaded",children:Gt==="A"?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[hn&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value: ",hn]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",onClick:Rr,children:q==="loaded"&&Qn?a.jsx("code",{className:"block whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:Qn}}):ei})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Metadata B"}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[lo&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:()=>Ze(F=>!F),disabled:q!=="loaded",children:qt?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:()=>Rl("B"),disabled:q!=="loaded",children:Gt==="B"?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[pn&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value: ",pn]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",onClick:Ml,children:q==="loaded"&&ur?a.jsx("code",{className:"block whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:ur}}):ei})]})]})]}),a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Export Comparison"}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full h-20 scrollbar-thin",placeholder:`Label for A
Label for B`,value:zt,onChange:F=>{Hn(F.target.value),W(null)},disabled:cr,"aria-label":"Comparison export labels"}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-[11px] text-muted",children:[a.jsx("input",{type:"checkbox",checked:Zt,onChange:F=>mn(F.target.checked),disabled:cr}),a.jsx("span",{children:"Embed metadata"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>{Tl(!1)},disabled:!Wn||cr,children:ar==="normal"?"Exporting":"Export comparison"}),a.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",onClick:()=>{Tl(!0)},disabled:!Wn||cr,children:ar==="reverse"?"Exporting":"Export (reverse order)"})]}),ee&&a.jsx("div",{className:"text-danger break-words",children:ee})]})]})}),a.jsxs(Eo,{title:"Basics",open:m.basics,onToggle:()=>y("basics"),children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs mb-1",role:"radiogroup","aria-label":"Star rating",children:[a.jsx("span",{className:"ui-kv-label w-16 shrink-0",children:M?"Rating (all)":"Rating"}),a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(F=>{const oe=(Oe??0)>=F;return a.jsx("button",{className:`w-6 h-6 flex items-center justify-center rounded-lg border border-border/60 bg-transparent text-[13px] ${oe?"text-star-active":"text-star-inactive"} hover:border-border hover:text-star-hover transition-colors`,onClick:()=>{const le=Oe===F&&!M?null:F;M&&t.length?(l==null||l(t,le),Dm(t,{star:le})):e&&(l==null||l([e],le),Nx(e,{star:le}))},title:`${F} star${F>1?"s":""} (key ${F})`,"aria-label":`${F} star${F>1?"s":""}`,"aria-pressed":Oe===F,children:oe?"":""},F)})})]}),!M&&Ne&&St.star&&a.jsxs("div",{className:"ui-banner ui-banner-danger mt-2 text-[11px] flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Rating conflict."}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:Cl,children:"Apply again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:kl,children:"Keep theirs"})]})]}),!M&&pt&&a.jsxs("div",{className:"text-[12px] space-y-1.5 leading-relaxed",children:[a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>Pr("dimensions",`${pt.w}${pt.h}`),children:"Dimensions"}),a.jsx("span",{className:"ui-kv-value inline-block text-right min-w-[80px]",ref:F=>Tr("dimensions",F),style:ge.dimensions?{minHeight:ge.dimensions}:void 0,children:me==="dimensions"?"Copied":`${pt.w}${pt.h}`})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>Pr("size",_c(pt.size)),children:"Size"}),a.jsx("span",{className:"ui-kv-value inline-block text-right min-w-[80px]",ref:F=>Tr("size",F),style:ge.size?{minHeight:ge.size}:void 0,children:me==="size"?"Copied":_c(pt.size)})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>Pr("type",pt.type),children:"Type"}),a.jsx("span",{className:"ui-kv-value break-all text-right inline-block min-w-[80px]",ref:F=>Tr("type",F),style:ge.type?{minHeight:ge.type}:void 0,children:me==="type"?"Copied":pt.type})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>Xs&&Pr("source",Xs),children:"Source"}),a.jsx("span",{className:"ui-kv-value inspector-value-clamp break-words text-right max-w-[70%] inline-block min-w-[80px]",ref:F=>Tr("source",F),style:ge.source?{minHeight:ge.source}:void 0,title:Xs,children:me==="source"?"Copied":Xs})]}),(()=>{const F=pt.metrics||null;if(!F)return null;const oe=Object.entries(F).filter(([,tt])=>tt!=null);if(!oe.length)return null;const le=(u==null?void 0:u.kind)==="metric"?u.key:null,he=[...oe].sort(([tt],[nn])=>tt.localeCompare(nn));let Le=he;if(le){const tt=he.findIndex(([nn])=>nn===le);tt>0&&(Le=[he[tt],...he.slice(0,tt),...he.slice(tt+1)])}const ut=Le.length>zc,vs=k||!ut?Le:Le.slice(0,zc),ni=Le.length-zc;return a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"ui-subsection-title mb-1",children:"Metrics"}),a.jsxs("div",{className:"space-y-1",children:[vs.map(([tt,nn])=>{const ri=le===tt;return a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:`w-24 shrink-0 ${ri?"text-accent font-medium":"ui-kv-label"}`,children:tt}),a.jsx("span",{className:`ui-kv-value text-right ${ri?"text-accent font-medium":""}`,children:pk(nn)})]},tt)}),ut&&a.jsx("button",{type:"button",className:"text-[11px] text-muted underline underline-offset-2 hover:text-text",onClick:()=>R(tt=>!tt),"aria-expanded":k,children:k?"Show less":`+${ni} more`})]})]})})()]})]}),!M&&a.jsxs(Eo,{title:"Metadata",open:m.metadata,onToggle:()=>y("metadata"),actions:wn,children:[a.jsxs("div",{className:"relative",children:[se&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value: ",se]}),a.jsx("pre",{className:`ui-code-block ui-code-block-resizable ${Bt} overflow-auto whitespace-pre-wrap`,onClick:Zs,children:Xn?a.jsx("code",{className:"block whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:so}}):oo})]}),A&&a.jsx("div",{className:"text-[11px] text-danger mt-1 break-words",children:A})]}),a.jsxs(Eo,{title:"Notes & Tags",open:m.notes,onToggle:()=>y("notes"),contentClassName:"px-3 pb-3 space-y-2",children:[!M&&Ne&&(St.tags||St.notes)&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Conflicting edits detected."}),a.jsx("div",{className:"text-[11px] text-muted mt-0.5",children:"Your changes were not saved because this item was updated elsewhere."}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:Cl,children:"Apply my changes again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:kl,children:"Keep theirs"})]})]}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full scrollbar-thin",placeholder:"Add notes",value:J,onChange:F=>Vn(F.target.value),onBlur:$u,"aria-label":M?"Notes for selected items":"Notes"}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:M?"Tags (apply to all, comma-separated)":"Tags (comma-separated)"}),a.jsx("input",{className:"ui-input inspector-input w-full",placeholder:"tag1, tag2",value:T,onChange:F=>bl(F.target.value),onBlur:vn,"aria-label":M?"Tags for selected items":"Tags"})]})]}),a.jsx("div",{className:Ll,onPointerDown:o})]}):a.jsx("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:a.jsx("div",{className:Ll,onPointerDown:o})})}function wk({open:e,embeddings:t,rejected:n=[],selectedPath:r,embeddingsLoading:s=!1,embeddingsError:i,onClose:o,onSearch:l}){const[u,d]=c.useState(""),[f,h]=c.useState("path"),[p,S]=c.useState(""),[w,E]=c.useState(""),[j,v]=c.useState("50"),[m,x]=c.useState(""),[y,k]=c.useState(null),[R,M]=c.useState(!1),N=c.useRef(null),O=c.useRef(null),T=c.useMemo(()=>t.find(A=>A.name===u)??t[0]??null,[t,u]);c.useEffect(()=>{e&&(k(null),t.length>0&&!t.some(A=>A.name===u)&&d(t[0].name),r?(h("path"),S(r)):(h("vector"),S("")))},[e,t,u,r]),c.useEffect(()=>{if(!e)return;const A=f==="vector"?O.current:N.current,_=window.requestAnimationFrame(()=>A==null?void 0:A.focus());return()=>window.cancelAnimationFrame(_)},[e,f]);const X=c.useCallback(async()=>{if(k(null),!t.length){k("No embeddings available for similarity search.");return}if(!T){k("Select an embedding to search.");return}const A=p.trim(),_=w.trim(),P=Number(j);if(!Number.isFinite(P)||P<=0){k("Top K must be a positive number.");return}const D=Math.min(1e3,Math.max(1,Math.floor(P))),H=m.trim()===""?null:Number(m);if(H!=null&&!Number.isFinite(H)){k("Min score must be a valid number.");return}if(f==="path"&&!A){k("Select an image path for the query.");return}if(f==="vector"&&!_){k("Paste a base64 vector for the query.");return}const te={embedding:T.name,query_path:f==="path"?A:null,query_vector_b64:f==="vector"?_:null,top_k:D,min_score:H};M(!0);try{await l(te),o()}catch(se){se instanceof an||se instanceof Error?k(se.message):k("Failed to run similarity search.")}finally{M(!1)}},[t.length,T,p,w,j,m,f,l,o]);c.useEffect(()=>{if(!e)return;const A=_=>{if(_.key==="Escape"){_.preventDefault(),o();return}(_.ctrlKey||_.metaKey)&&_.key==="Enter"&&(_.preventDefault(),X())};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[e,o,X]);const J=c.useCallback(()=>{var A;r&&(h("path"),S(r),(A=N.current)==null||A.focus())},[r]);if(!e)return null;const z=t.map(A=>({value:A.name,label:A.name})),ae=n.length>0,K=n.slice(0,3);return a.jsx("div",{className:"fixed inset-0 z-[var(--z-overlay)] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",onClick:A=>{A.target===A.currentTarget&&o()},children:a.jsxs("div",{className:"w-full max-w-2xl rounded-lg border border-border bg-panel shadow-[0_20px_50px_rgba(0,0,0,0.55)]",onClick:A=>A.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Find similar",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Find similar"}),a.jsx("div",{className:"text-xs text-muted",children:"Search with embeddings"})]}),a.jsx("button",{className:"btn btn-sm",onClick:o,"aria-label":"Close",children:"Close"})]}),a.jsxs("div",{className:"px-4 py-4 space-y-4",children:[i&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:i}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Embedding"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(fh,{value:(T==null?void 0:T.name)??"",onChange:d,options:z,placeholder:s?"Loading embeddings...":"Select embedding",disabled:!t.length,triggerClassName:"min-w-[180px]"}),T&&a.jsxs("span",{className:"text-xs text-muted",children:[T.dimension," dims, ",T.metric,", ",T.dtype]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Query mode"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:`btn btn-sm ${f==="path"?"btn-active":""}`,onClick:()=>h("path"),"aria-pressed":f==="path",children:"Selected image"}),a.jsx("button",{type:"button",className:`btn btn-sm ${f==="vector"?"btn-active":""}`,onClick:()=>h("vector"),"aria-pressed":f==="vector",children:"Vector input"})]})]}),f==="path"?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Image path"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{ref:N,type:"text",className:"input w-full",value:p,onChange:A=>S(A.target.value),placeholder:r?"Selected image path":"Select an image first"}),a.jsx("button",{type:"button",className:"btn btn-sm",onClick:J,disabled:!r,title:r?"Use selected image":"Select an image first",children:"Use selected"})]})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Vector (base64 float32)"}),a.jsx("textarea",{ref:O,className:"ui-textarea w-full font-mono text-[11px]",rows:5,value:w,onChange:A=>E(A.target.value),placeholder:"Paste base64-encoded float32 vector"}),a.jsx("div",{className:"text-[11px] text-muted",children:"Base64 of little-endian float32. Length must match embedding dimension."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Top K"}),a.jsx("input",{type:"number",min:1,max:1e3,step:1,className:"input ui-number w-full",value:j,onChange:A=>v(A.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Min score"}),a.jsx("input",{type:"number",step:.01,className:"input ui-number w-full",value:m,onChange:A=>x(A.target.value),placeholder:"Optional"})]})]}),ae&&a.jsxs("div",{className:"ui-banner text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Skipped columns"}),a.jsxs("div",{className:"mt-1 space-y-1 text-muted",children:[K.map(A=>a.jsxs("div",{children:[A.name,": ",A.reason]},A.name)),n.length>K.length&&a.jsxs("div",{children:["+",n.length-K.length," more"]})]})]}),y&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:y})]}),a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-border",children:[a.jsx("div",{className:"text-xs text-muted",children:T?`Metric: ${T.metric}`:"Metric: cosine"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:o,disabled:R,children:"Cancel"}),a.jsx("button",{className:"btn btn-sm btn-active",onClick:X,disabled:R||!t.length,children:R?"Searching...":"Find similar"})]})]})]})})}const Rx=1,Ia=200,Sk=5*6e4,bk=6e4,Px=(e,t)=>t!=null&&t.recursive?["folder",e,"recursive",t.page??Rx,t.pageSize??Ia]:["folder",e];function Tx(e){return e[0]!=="folder"||e[2]!=="recursive"||typeof e[1]!="string"||typeof e[3]!="number"||typeof e[4]!="number"?null:e}function Ck(e){return Tx(e)!==null}function kk(e,t,n=!0){if(!Ck(e))return!0;const r=Tx(e);if(r==null)return!1;const[,s,,i]=r;return i!==Rx?!1:!!(s===t||n&&s==="/")}function Ek(e,t,n=!0){return!Array.isArray(e)||e[0]!=="folder"?!1:!kk(e,t,n)}const Nk=15e3;function jk(e,t){return Se.getFolder(e,t)}function uf(e,t=!1,n){const r=Ou(),s={recursive:t,page:n==null?void 0:n.page,pageSize:n==null?void 0:n.pageSize,legacyRecursive:n==null?void 0:n.legacyRecursive},i=!!s.recursive;return Iu({queryKey:Px(e,s),queryFn:()=>jk(e,s),enabled:(n==null?void 0:n.enabled)??!0,staleTime:1e4,gcTime:i?bk:Sk,retry:2,retryDelay:o=>Math.min(1e3*Math.pow(2,o),5e3),refetchOnWindowFocus:!1,refetchInterval:r?Nk:!1,refetchIntervalInBackground:r})}const Mk=(e,t)=>["search",e,t],Rk=2e4;function Pk(e,t){const n=Ou();return Iu({enabled:!!e.trim(),queryKey:Mk(e,t),queryFn:()=>Se.search(e,t),staleTime:3e3,gcTime:6e4,placeholderData:r=>r,retry:1,refetchInterval:n?Rk:!1,refetchIntervalInBackground:n})}const Tk=()=>["embeddings"];function Lk(){return Iu({queryKey:Tk(),queryFn:Se.getEmbeddings,staleTime:6e4,gcTime:5*6e4,retry:1,refetchOnWindowFocus:!1})}const _k=/^[\/@a-zA-Z0-9._\-\/]{1,512}$/,Ik=[".jpg",".jpeg",".png",".webp"];function Nt(e){try{const t=decodeURI(e||""),r=(t.startsWith("/")?t:`/${t}`).replace(/\/{2,}/g,"/"),s=r.length>1?r.replace(/\/$/,""):r;return _k.test(s)?s:"/"}catch{return"/"}}function Ym(){return(window.location.hash||"").replace(/^#/,"")}function Xm(e){const t=Nt(e),n=`#${encodeURI(t)}`;window.location.hash!==n&&(window.location.hash=n)}function ma(e){const t=Nt(e),n=`#${encodeURI(t)}`;if(window.location.hash!==n){const r=`${window.location.pathname}${window.location.search}${n}`;window.history.replaceState(window.history.state,"",r)}}function Fk(e){const n=Nt(e).toLowerCase();return Ik.some(r=>n.endsWith(r))}function Lx(e,t){const n=e.replace(/\/+$/,""),r=t.replace(/^\/+/,""),s=[n,r].filter(Boolean).join("/");return s.startsWith("/")?s:`/${s}`}function qm(e){const n=Nt(e).split("/").filter(Boolean);return n.length<=1?"/":"/"+n.slice(0,-1).join("/")}function xh(e){return Nt(e).split("/").filter(Boolean).pop()||""}function Ok(e){return e.endsWith("/_trash_")}const Ak=new Set([0,1,2,3,4,5]),wh=new Set(["<","<=",">",">="]),Dk=/^\d{4}-\d{2}-\d{2}$/;function zk(e,t){return!t||!t.and.length?e:e.filter(n=>$k(n,t.and))}function $k(e,t){for(const n of t)if(!Bk(e,n))return!1;return!0}function Bk(e,t){var n,r,s,i,o,l,u;if("stars"in t){const d=t.stars;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsIn"in t){const d=t.starsIn.values;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsNotIn"in t){const d=t.starsNotIn.values;if(!d||!d.length)return!0;const f=e.star??0;return!d.includes(f)}if("nameContains"in t){const d=(n=t.nameContains.value)==null?void 0:n.trim();return d?(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("nameNotContains"in t){const d=(r=t.nameNotContains.value)==null?void 0:r.trim();return d?!(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("commentsContains"in t){const d=(s=t.commentsContains.value)==null?void 0:s.trim();if(!d)return!0;const f=e.comments??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("commentsNotContains"in t){const d=(i=t.commentsNotContains.value)==null?void 0:i.trim();if(!d)return!0;const f=e.comments??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("urlContains"in t){const d=(o=t.urlContains.value)==null?void 0:o.trim();if(!d)return!0;const f=e.source??e.url??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("urlNotContains"in t){const d=(l=t.urlNotContains.value)==null?void 0:l.trim();if(!d)return!0;const f=e.source??e.url??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("dateRange"in t){const{from:d,to:f}=t.dateRange;if(!d&&!f)return!0;if(!e.addedAt)return!1;const h=Date.parse(e.addedAt);if(Number.isNaN(h))return!1;const p=Zm(d,!1),S=Zm(f,!0);return!(p!=null&&h<p||S!=null&&h>S)}if("widthCompare"in t){const{op:d,value:f}=t.widthCompare;if(!Number.isFinite(f))return!0;const h=e.w;return!Number.isFinite(h)||h<=0?!1:eg(h,d,f)}if("heightCompare"in t){const{op:d,value:f}=t.heightCompare;if(!Number.isFinite(f))return!0;const h=e.h;return!Number.isFinite(h)||h<=0?!1:eg(h,d,f)}if("metricRange"in t){const{key:d,min:f,max:h}=t.metricRange,p=(u=e.metrics)==null?void 0:u[d];return!(p==null||p<f||p>h)}return!0}function cf(e){if(!e||typeof e!="object")return null;const t=e.and;if(!Array.isArray(t))return null;const n=[];for(const r of t){const s=nE(r);s&&n.push(s)}return{and:n}}function Gm(e){var r;const t=e.and.find(s=>"stars"in s),n=e.and.find(s=>"starsIn"in s);return(r=n==null?void 0:n.starsIn)!=null&&r.values?n.starsIn.values:(t==null?void 0:t.stars)??[]}function $c(e,t){return _x(e,t)}function Uk(e){var n;const t=e.and.find(r=>"starsIn"in r);return((n=t==null?void 0:t.starsIn)==null?void 0:n.values)??[]}function _x(e,t){const n=Vo(t),r=e.and.filter(s=>!("starsIn"in s)&&!("stars"in s));return n.length?{and:[{starsIn:{values:n}},...r]}:{and:r}}function Hk(e){var n;const t=e.and.find(r=>"starsNotIn"in r);return((n=t==null?void 0:t.starsNotIn)==null?void 0:n.values)??[]}function Ix(e,t){const n=Vo(t),r=e.and.filter(s=>!("starsNotIn"in s));return n.length?{and:[{starsNotIn:{values:n}},...r]}:{and:r}}function Vk(e){var n;const t=e.and.find(r=>"nameContains"in r);return((n=t==null?void 0:t.nameContains)==null?void 0:n.value)??null}function Fx(e,t){const n=En(t),r=e.and.filter(s=>!("nameContains"in s));return n?{and:[{nameContains:{value:n}},...r]}:{and:r}}function Wk(e){var n;const t=e.and.find(r=>"nameNotContains"in r);return((n=t==null?void 0:t.nameNotContains)==null?void 0:n.value)??null}function Ox(e,t){const n=En(t),r=e.and.filter(s=>!("nameNotContains"in s));return n?{and:[{nameNotContains:{value:n}},...r]}:{and:r}}function Qk(e){var n;const t=e.and.find(r=>"commentsContains"in r);return((n=t==null?void 0:t.commentsContains)==null?void 0:n.value)??null}function Ax(e,t){const n=En(t),r=e.and.filter(s=>!("commentsContains"in s));return n?{and:[{commentsContains:{value:n}},...r]}:{and:r}}function Kk(e){var n;const t=e.and.find(r=>"commentsNotContains"in r);return((n=t==null?void 0:t.commentsNotContains)==null?void 0:n.value)??null}function Dx(e,t){const n=En(t),r=e.and.filter(s=>!("commentsNotContains"in s));return n?{and:[{commentsNotContains:{value:n}},...r]}:{and:r}}function Yk(e){var n;const t=e.and.find(r=>"urlContains"in r);return((n=t==null?void 0:t.urlContains)==null?void 0:n.value)??null}function zx(e,t){const n=En(t),r=e.and.filter(s=>!("urlContains"in s));return n?{and:[{urlContains:{value:n}},...r]}:{and:r}}function Xk(e){var n;const t=e.and.find(r=>"urlNotContains"in r);return((n=t==null?void 0:t.urlNotContains)==null?void 0:n.value)??null}function $x(e,t){const n=En(t),r=e.and.filter(s=>!("urlNotContains"in s));return n?{and:[{urlNotContains:{value:n}},...r]}:{and:r}}function qk(e){const t=e.and.find(n=>"dateRange"in n);return(t==null?void 0:t.dateRange)??null}function df(e,t){const n=mu((t==null?void 0:t.from)??null),r=mu((t==null?void 0:t.to)??null),s=e.and.filter(i=>!("dateRange"in i));return!n&&!r?{and:s}:{and:[{dateRange:{...n?{from:n}:{},...r?{to:r}:{}}},...s]}}function Gk(e){const t=e.and.find(n=>"widthCompare"in n);return(t==null?void 0:t.widthCompare)??null}function Fa(e,t){const n=e.and.filter(r=>!("widthCompare"in r));return!t||!Number.isFinite(t.value)||!wh.has(t.op)?{and:n}:{and:[{widthCompare:{op:t.op,value:t.value}},...n]}}function Jk(e){const t=e.and.find(n=>"heightCompare"in n);return(t==null?void 0:t.heightCompare)??null}function Oa(e,t){const n=e.and.filter(r=>!("heightCompare"in r));return!t||!Number.isFinite(t.value)||!wh.has(t.op)?{and:n}:{and:[{heightCompare:{op:t.op,value:t.value}},...n]}}function Zk(e,t){const n=e.and.find(r=>"metricRange"in r&&r.metricRange.key===t);return(n==null?void 0:n.metricRange)??null}function eE(e,t,n){const r=e.and.filter(s=>!("metricRange"in s&&s.metricRange.key===t));return n?{and:[{metricRange:{key:t,min:n.min,max:n.max}},...r]}:{and:r}}function tE(e){const t=cf(e);return t?t.and.length:0}function nE(e){var t,n,r,s,i,o,l,u;if(!e||typeof e!="object")return null;if("stars"in e){const d=Vo(e.stars);return d.length?{starsIn:{values:d}}:null}if("starsIn"in e){const d=Vo((t=e.starsIn)==null?void 0:t.values);return d.length?{starsIn:{values:d}}:null}if("starsNotIn"in e){const d=Vo((n=e.starsNotIn)==null?void 0:n.values);return d.length?{starsNotIn:{values:d}}:null}if("nameContains"in e){const d=En((r=e.nameContains)==null?void 0:r.value);return d?{nameContains:{value:d}}:null}if("nameNotContains"in e){const d=En((s=e.nameNotContains)==null?void 0:s.value);return d?{nameNotContains:{value:d}}:null}if("commentsContains"in e){const d=En((i=e.commentsContains)==null?void 0:i.value);return d?{commentsContains:{value:d}}:null}if("commentsNotContains"in e){const d=En((o=e.commentsNotContains)==null?void 0:o.value);return d?{commentsNotContains:{value:d}}:null}if("urlContains"in e){const d=En((l=e.urlContains)==null?void 0:l.value);return d?{urlContains:{value:d}}:null}if("urlNotContains"in e){const d=En((u=e.urlNotContains)==null?void 0:u.value);return d?{urlNotContains:{value:d}}:null}if("dateRange"in e){const d=e.dateRange,f=mu((d==null?void 0:d.from)??null),h=mu((d==null?void 0:d.to)??null);return!f&&!h?null:{dateRange:{...f?{from:f}:{},...h?{to:h}:{}}}}if("widthCompare"in e){const d=e.widthCompare,f=Jm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{widthCompare:f}:null}if("heightCompare"in e){const d=e.heightCompare,f=Jm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{heightCompare:f}:null}if("metricRange"in e){const d=e.metricRange;if(!d||typeof d!="object")return null;const f=typeof d.key=="string"?d.key:"",h=ff(d.min),p=ff(d.max);return!f||h==null||p==null||h>p?null:{metricRange:{key:f,min:h,max:p}}}return null}function Vo(e){if(!Array.isArray(e))return[];const t=[],n=new Set;for(const r of e){const s=typeof r=="number"?r:typeof r=="string"?Number(r):NaN;!Number.isInteger(s)||!Ak.has(s)||n.has(s)||(n.add(s),t.push(s))}return t}function En(e){if(typeof e!="string")return null;const t=e.trim();return t||null}function mu(e){if(typeof e!="string")return null;const t=e.trim();if(!t)return null;const n=Date.parse(t);return Number.isNaN(n)?null:t}function Jm(e,t){if(typeof e!="string"||!wh.has(e))return null;const n=ff(t);return n==null?null:{op:e,value:n}}function Zm(e,t){if(!e)return null;const n=e.trim();if(!n)return null;const r=Date.parse(n);return Number.isNaN(r)?null:t&&Dk.test(n)?r+24*60*60*1e3-1:r}function eg(e,t,n){switch(t){case"<":return e<n;case"<=":return e<=n;case">":return e>n;case">=":return e>=n;default:return!0}}function ff(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null}function tg(e){return e.addedAt?Date.parse(e.addedAt):0}function gu(e,t){return e.name.localeCompare(t.name)}function rE(e,t){const n=tg(e),r=tg(t);return n===r?gu(e,t):n-r}function sE(e){return(t,n)=>{var i,o;const r=(i=t.metrics)==null?void 0:i[e],s=(o=n.metrics)==null?void 0:o[e];return r==null&&s==null?gu(t,n):r==null?1:s==null?-1:r===s?gu(t,n):r-s}}function ng(e,t){return zk(e,t)}function iE(e){let t=e>>>0;return()=>{t+=1831565813;let n=Math.imul(t^t>>>15,1|t);return n^=n+Math.imul(n^n>>>7,61|n),((n^n>>>14)>>>0)/4294967296}}function oE(e,t){const n=iE(t||1),r=[...e];for(let s=r.length-1;s>0;s-=1){const i=Math.floor(n()*(s+1));[r[s],r[i]]=[r[i],r[s]]}return r}function lE(e,t,n){if(t.kind==="builtin"&&t.key==="random"){const i=n??Date.now();return oE(e,i)}let r=rE;t.kind==="metric"?r=sE(t.key):t.key==="name"&&(r=gu);const s=[...e].sort(r);return t.dir==="desc"?s.reverse():s}const rg="leftW.folders",sg="leftW.metrics",aE="leftW",ig="rightW",og=200,lg=240,ag=200;function uE(e){return(e.pointerType??"mouse")==="mouse"&&e.button!==0}function cE(e,t){try{e.setPointerCapture(t)}catch{}}function dE(e,t){try{e.releasePointerCapture(t)}catch{}}function fE(e,t){const[n,r]=c.useState(240),[s,i]=c.useState(320),[o,l]=c.useState(240),u=t==="metrics"?s:n,d=c.useRef(u),f=c.useRef(o);c.useEffect(()=>{d.current=u},[u]),c.useEffect(()=>{f.current=o},[o]),c.useEffect(()=>{try{const w=window.localStorage,E=Number(w.getItem(rg)??w.getItem(aE));Number.isFinite(E)&&E>0&&r(E);const j=Number(w.getItem(sg));Number.isFinite(j)&&j>0&&i(j);const v=Number(w.getItem(ig));Number.isFinite(v)&&v>0&&l(v)}catch{}},[]);const h=(w,E,j)=>{if(uE(w))return;w.preventDefault();const v=w.currentTarget,m=w.pointerId;cE(v,m);const x=R=>{R.pointerId===m&&E(R)};function y(){window.removeEventListener("pointermove",x),window.removeEventListener("pointerup",k),window.removeEventListener("pointercancel",k),dE(v,m)}function k(R){R.pointerId===m&&(y(),j())}window.addEventListener("pointermove",x),window.addEventListener("pointerup",k),window.addEventListener("pointercancel",k)};return{leftW:u,rightW:o,onResizeLeft:w=>{const E=e.current;if(!E)return;const j=E.getBoundingClientRect(),v=t==="metrics"?sg:rg;let m=d.current;h(w,x=>{const y=x.clientX-j.left,k=Math.max(og,j.width-f.current-ag),R=Math.min(Math.max(y,og),k);m=R,t==="metrics"?i(R):r(R)},()=>{try{window.localStorage.setItem(v,String(m))}catch{}})},onResizeRight:w=>{const E=e.current;if(!E)return;const j=E.getBoundingClientRect();let v=f.current;h(w,m=>{const x=m.clientX-j.left,y=j.width-x,k=Math.max(lg,j.width-d.current-ag),R=Math.min(Math.max(y,lg),k);v=R,f.current=R,l(R)},()=>{try{window.localStorage.setItem(ig,String(v))}catch{}})}}}function hE(e,t=250){const[n,r]=Vh.useState(e);return Vh.useEffect(()=>{const s=window.setTimeout(()=>r(e),Math.max(0,t));return()=>window.clearTimeout(s)},[e,t]),n}const Bx="application/x-lenslet-paths",pE='[role="treeitem"].drop-target';function ug(e){var n;return Array.from(((n=e.dataTransfer)==null?void 0:n.types)||[]).includes(Bx)}function mE(e){document.querySelectorAll(pE).forEach(t=>{t!==e&&t.classList.remove("drop-target")})}function cg(e){mE(e),e.classList.add("drop-target")}function dg(e){return e.startsWith("/")?e:`/${e}`}function gE({path:e,isLeaf:t}){const n=Ys(),r=c.useCallback(l=>{ug(l)&&(l.preventDefault(),t&&cg(l.currentTarget))},[t]),s=c.useCallback(l=>{!t||!ug(l)||(l.preventDefault(),cg(l.currentTarget))},[t]),i=c.useCallback(l=>{const u=l.currentTarget,d=document.elementFromPoint(l.clientX,l.clientY);d&&u.contains(d)||u.classList.remove("drop-target")},[]),o=c.useCallback(async l=>{const u=l.dataTransfer;if(!u)return;l.preventDefault(),l.currentTarget.classList.remove("drop-target");const d=u.getData(Bx),h=(d?JSON.parse(d):[]).filter(Boolean);if(!h.length)return;let p=h[0].split("/").slice(0,-1).join("/")||"/";p=dg(p);const S=dg(e);try{for(const w of h)await Se.moveFile(w,S);n.invalidateQueries({queryKey:["folder",p]}),n.invalidateQueries({queryKey:["folder",S]}),n.setQueryData(["folder",p],w=>!w||!Array.isArray(w.items)?w:{...w,items:w.items.filter(E=>!h.includes(E.path))})}catch{}},[e,n]);return{onDragOver:r,onDragEnter:s,onDragLeave:i,onDrop:o}}const vE='[role="tree"] [role="treeitem"]';function yE(){return Array.from(document.querySelectorAll(vE))}function xE(e,t){var i;const n=yE(),r=n.findIndex(o=>o===e);if(r===-1)return;let s=r;t==="ArrowDown"?s=Math.min(n.length-1,r+1):t==="ArrowUp"?s=Math.max(0,r-1):t==="Home"?s=0:t==="End"&&(s=n.length-1),(i=n[s])==null||i.focus()}function wE({path:e,isLeaf:t,isExpanded:n,setExpanded:r,onOpen:s}){return c.useCallback(i=>{if(i.key==="Enter"){i.preventDefault(),s(e);return}if(i.key==="ArrowRight"){!t&&!n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.add(e),l}));return}if(i.key==="ArrowLeft"){!t&&n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.delete(e),l}));return}(i.key==="ArrowDown"||i.key==="ArrowUp"||i.key==="Home"||i.key==="End")&&(i.preventDefault(),xE(i.currentTarget,i.key))},[e,t,n,r,s])}const fg=64,SE=120;function bE(e){const t=e.split("/").filter(Boolean),n=["/"];let r="";for(const s of t)r=r?`${r}/${s}`:`/${s}`,n.push(r);return n}function CE({current:e,roots:t,data:n,onOpen:r,onPullRefresh:s,onResize:i,onContextMenu:o,onOpenActions:l,countVersion:u,className:d,showResizeHandle:f=!0}){const[h,p]=c.useState(new Set(["/"])),S=c.useRef(new Map),w=c.useRef(new Map),[E,j]=c.useState(!1),[v,m]=c.useState(0),x=c.useRef(null),y=c.useRef(!1),k=Ys(),R=c.useCallback(()=>{m(0),x.current=null,y.current=!1},[]),M=c.useCallback(async _=>{const P=Nt(_||"/"),D=S.current,H=w.current,te=D.get(P);if(te!==void 0)return te;const se=k.getQueryData(Px(P,{recursive:!0}));if(se){const Y=se.totalItems??se.items.length;return D.set(P,Y),Y}const I=H.get(P);if(I)return I;const U=(async()=>{try{const Y=await Se.getFolder(P,{recursive:!0}),Z=Y.totalItems??Y.items.length;return D.set(P,Z),Z}finally{H.delete(P)}})();return H.set(P,U),U},[k]);c.useEffect(()=>{S.current.clear(),w.current.clear()},[u]),c.useEffect(()=>{const _=bE(e);p(P=>{const D=new Set(P);for(const H of _)D.add(H);return D})},[e]);const N=c.useCallback(async()=>{if(!(!s||E)){j(!0);try{await s()}catch(_){console.error("Failed to refresh folders:",_)}finally{j(!1),m(0)}}},[s,E]),O=c.useCallback(_=>{!s||E||_.touches.length===1&&(_.currentTarget.scrollTop>0||(x.current=_.touches[0].clientY,y.current=!1))},[s,E]),T=c.useCallback(_=>{if(!s||E||_.touches.length!==1)return;const P=x.current;if(P==null)return;if(_.currentTarget.scrollTop>0){R();return}const D=_.touches[0].clientY-P;if(D<=0){y.current&&m(0);return}!y.current&&D<8||(y.current=!0,_.preventDefault(),m(Math.min(SE,D*.55)))},[E,s,R]),X=c.useCallback(()=>{if(!s||E){R();return}const _=y.current&&v>=fg;if(x.current=null,y.current=!1,_){N();return}m(0)},[N,E,s,v,R]),J=d??"h-full overflow-auto bg-panel scrollbar-thin",z=s?`${J} overscroll-y-contain`:J,ae=!!s&&(E||v>0),K=v>=fg,A=E?28:Math.min(44,v);return a.jsxs("div",{className:z,onTouchStart:s?O:void 0,onTouchMove:s?T:void 0,onTouchEnd:s?X:void 0,onTouchCancel:s?X:void 0,children:[ae&&a.jsx("div",{className:"flex items-end justify-center text-[11px] text-muted select-none transition-[height,opacity] duration-150",style:{height:A,opacity:E||v>8?1:.65},"aria-live":"polite",children:E?"Refreshing":K?"Release to refresh":"Pull to refresh"}),a.jsx("div",{className:"p-1",role:"tree","aria-label":"Folders",children:t.map(_=>a.jsx(Ux,{path:_.path,label:_.label,depth:0,current:e,expanded:h,setExpanded:p,onOpen:r,onContextMenu:o,onOpenActions:l,initial:n,getSubtreeCount:M,countVersion:u},_.path))}),f&&a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 left-[calc(var(--left)-6px)]",onPointerDown:i})]})}function Ux({path:e,label:t,depth:n,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:u,initial:d,getSubtreeCount:f,countVersion:h}){var J;const p=s.has(e),S=r===e,w=e==="/"||p||S,{data:E}=uf(e,!1,{enabled:w}),j=d&&e===d.path?d:E,m=!!j?j.dirs.length===0:!1,[x,y]=c.useState(j?j.items.length:null),k=wE({path:e,isLeaf:m,isExpanded:p,setExpanded:i,onOpen:o}),{onDragOver:R,onDragEnter:M,onDragLeave:N,onDrop:O}=gE({path:e,isLeaf:m}),T=z=>{z.stopPropagation(),!m&&i(ae=>{const K=new Set(ae);return K.has(e)?K.delete(e):K.add(e),K})},X=z=>{if(z.stopPropagation(),!u)return;const ae=z.currentTarget.getBoundingClientRect();u(e,{x:ae.right-4,y:ae.bottom-4})};return c.useEffect(()=>{let z=!1;if(!j){y(null);return}if(y(j.items.length),!!(p&&(n>0||S)))return f(e).then(K=>{z||y(K)}).catch(K=>{z||console.warn(`Failed to compute subtree count for ${e}:`,K)}),()=>{z=!0}},[j,e,f,h,p,n,S]),a.jsxs("div",{children:[a.jsxs("div",{className:`tree-row flex items-center gap-1.5 py-1 px-2 rounded-md cursor-pointer min-h-[40px] outline-none transition-colors duration-75 ${S?"bg-accent/20 text-accent font-medium":"hover:bg-white/5 text-text"}`,role:"treeitem","aria-level":n+1,"aria-expanded":m?void 0:p,"aria-selected":S,tabIndex:S?0:-1,style:{paddingLeft:8+n*14},onClick:()=>o(e),onContextMenu:z=>{z.preventDefault(),z.stopPropagation(),l==null||l(z,e)},onKeyDown:k,onDragOver:R,onDragEnter:M,onDragLeave:N,onDrop:O,children:[a.jsx("button",{type:"button",className:"tree-expand-btn touch-manipulation",onClick:T,"aria-label":m?`No subfolders in ${t}`:`${p?"Collapse":"Expand"} ${t}`,"aria-expanded":m?void 0:p,disabled:m,children:m?"":p?"":""}),a.jsx("span",{className:"flex-1 overflow-hidden truncate text-sm",title:t,children:JC(t,28)}),x!==null&&a.jsx("span",{className:"text-[10px] opacity-50 bg-white/5 border border-white/5 rounded px-1.5 min-w-[24px] text-center",children:x}),u&&a.jsx("button",{type:"button",className:"tree-row-action-btn touch-manipulation","aria-label":`Open actions for ${t}`,"aria-haspopup":"menu",onPointerDown:z=>z.stopPropagation(),onClick:X,children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]}),p&&((J=j==null?void 0:j.dirs)==null?void 0:J.map(z=>a.jsx(Ux,{path:Lx(e,z.name),label:z.name,depth:n+1,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:u,getSubtreeCount:f,countVersion:h},z.name)))]})}const js=40,kE=12,hg=[5,4,3,2,1],pg=["<","<=",">",">="];function EE({items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l,onChangeFilters:u}){const d=r&&r.length?a.jsx(NE,{selectedItems:r,metricKeys:n}):null,f=a.jsx(jE,{filters:o,onChangeFilters:u});return n.length?a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[d,a.jsx(ME,{items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}),f]}):a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[d,f,a.jsx("div",{className:"p-4 text-sm text-muted",children:"No metrics found in this dataset."})]})}function NE({selectedItems:e,metricKeys:t}){const n=c.useMemo(()=>{if(!e.length)return null;const u=new Map;for(const h of e){const p=h.metrics;if(p)for(const[S,w]of Object.entries(p)){if(w==null||Number.isNaN(w))continue;const E=u.get(S);E?E.push(w):u.set(S,[w])}}return u.size?{entries:(t.length?t.filter(h=>u.has(h)):Array.from(u.keys()).sort()).map(h=>{const p=u.get(h)??[],S=Math.min(...p),w=Math.max(...p),E=p.reduce((j,v)=>j+v,0)/Math.max(1,p.length);return{key:h,value:p[0],min:S,max:w,avg:E,count:p.length}}),totalItems:e.length}:null},[e,t]);if(!n)return null;const{entries:r,totalItems:s}=n,i=r.slice(0,kE),o=r.length-i.length,l=s>1;return a.jsxs("div",{className:"ui-card",children:[a.jsxs("div",{className:"ui-card-header",children:[a.jsx("div",{className:"ui-section-title",children:"Selected metrics"}),a.jsxs("div",{className:"text-[11px] text-muted",children:[s," item",s===1?"":"s"]})]}),a.jsxs("div",{className:"space-y-1 text-[12px]",children:[i.map(u=>a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-muted w-28 shrink-0 truncate",title:u.key,children:u.key}),a.jsxs("span",{className:"font-mono text-text text-right tabular-nums",children:[l?`${rn(u.min)}  ${rn(u.max)}`:rn(u.value),l&&a.jsxs("span",{className:"text-[11px] text-muted ml-2",children:["avg ",rn(u.avg),u.count!==s?`  ${u.count}/${s}`:""]})]})]},u.key)),o>0&&a.jsxs("div",{className:"text-[11px] text-muted",children:["+",o," more"]})]})]})}function jE({filters:e,onChangeFilters:t}){const n=c.useMemo(()=>Uk(e),[e]),r=c.useMemo(()=>Hk(e),[e]),s=c.useMemo(()=>Vk(e)??"",[e]),i=c.useMemo(()=>Wk(e)??"",[e]),o=c.useMemo(()=>Qk(e)??"",[e]),l=c.useMemo(()=>Kk(e)??"",[e]),u=c.useMemo(()=>Yk(e)??"",[e]),d=c.useMemo(()=>Xk(e)??"",[e]),f=c.useMemo(()=>qk(e)??{},[e]),h=c.useMemo(()=>Sg(f.from),[f.from]),p=c.useMemo(()=>Sg(f.to),[f.to]),S=c.useMemo(()=>Gk(e),[e]),w=c.useMemo(()=>Jk(e),[e]),[E,j]=c.useState((S==null?void 0:S.op)??">="),[v,m]=c.useState((w==null?void 0:w.op)??">=");c.useEffect(()=>{S!=null&&S.op&&j(S.op)},[S==null?void 0:S.op]),c.useEffect(()=>{w!=null&&w.op&&m(w.op)},[w==null?void 0:w.op]);const x=(y,k)=>{const R=new Set(n),M=new Set(r);y==="include"?R.has(k)?R.delete(k):(R.add(k),M.delete(k)):M.has(k)?M.delete(k):(M.add(k),R.delete(k));let N=_x(e,Array.from(R));N=Ix(N,Array.from(M)),t(N)};return a.jsxs("div",{className:"ui-card",children:[a.jsx("div",{className:"ui-section-title mb-3",children:"Attributes"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Rating"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Include"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[hg.map(y=>{const k=n.includes(y);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${k?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>x("include",y),"aria-pressed":k,title:`Include ${y} star${y>1?"s":""}`,children:[y,""]},`stars-in-${y}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${n.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>x("include",0),"aria-pressed":n.includes(0),title:"Include unrated",children:"None"})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Exclude"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[hg.map(y=>{const k=r.includes(y);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${k?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>x("exclude",y),"aria-pressed":k,title:`Exclude ${y} star${y>1?"s":""}`,children:[y,""]},`stars-out-${y}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${r.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>x("exclude",0),"aria-pressed":r.includes(0),title:"Exclude unrated",children:"None"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Filename"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:s,placeholder:"e.g. draft",onChange:y=>t(Fx(e,y.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:i,placeholder:"e.g. v1",onChange:y=>t(Ox(e,y.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Comments"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:o,placeholder:"e.g. hero",onChange:y=>t(Ax(e,y.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:l,placeholder:"e.g. todo",onChange:y=>t(Dx(e,y.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"URL"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:u,placeholder:"e.g. s3://bucket",onChange:y=>t(zx(e,y.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:d,placeholder:"e.g. http://",onChange:y=>t($x(e,y.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Date Added"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"From"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:h,onChange:y=>t(df(e,{from:y.target.value||null,to:f.to??null}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"To"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:p,onChange:y=>t(df(e,{from:f.from??null,to:y.target.value||null}))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Dimensions"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Width"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:E,onChange:y=>{const k=y.target.value;j(k),S&&t(Fa(e,{op:k,value:S.value}))},children:pg.map(y=>a.jsx("option",{value:y,children:y},`w-${y}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:S?String(S.value):"",min:0,placeholder:"px",onChange:y=>{const k=y.target.value;if(!k){t(Fa(e,null));return}const R=Number(k);Number.isFinite(R)&&t(Fa(e,{op:E,value:R}))}})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Height"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:v,onChange:y=>{const k=y.target.value;m(k),w&&t(Oa(e,{op:k,value:w.value}))},children:pg.map(y=>a.jsx("option",{value:y,children:y},`h-${y}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:w?String(w.value):"",min:0,placeholder:"px",onChange:y=>{const k=y.target.value;if(!k){t(Oa(e,null));return}const R=Number(k);Number.isFinite(R)&&t(Oa(e,{op:v,value:R}))}})]})]})]})]})]})]})}function ME({items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}){const[u,d]=c.useState(!1),f=s&&n.includes(s)?s:n[0];return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("label",{className:"ui-label",children:"Metric"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-[11px]",onClick:()=>d(h=>!h),"aria-pressed":u,children:u?"Show one":"Show all"})]}),u?a.jsx("div",{className:"ui-input ui-input-readonly w-full flex items-center text-xs",children:"All metrics"}):a.jsx("select",{className:"ui-select w-full",value:f,onChange:h=>i(h.target.value),children:n.map(h=>a.jsx("option",{value:h,children:h},h))})]}),u?a.jsx("div",{className:"space-y-3",children:n.map(h=>a.jsx(mg,{metricKey:h,items:e,filteredItems:t,selectedItems:r,filters:o,onChangeRange:l,showTitle:!0},h))}):f?a.jsx(mg,{metricKey:f,items:e,filteredItems:t,selectedItems:r,filters:o,onChangeRange:l}):a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]})}function mg({items:e,filteredItems:t,metricKey:n,selectedItems:r,filters:s,onChangeRange:i,showTitle:o=!1}){const l=c.useMemo(()=>gg(e,n),[e,n]),u=c.useMemo(()=>Bc(l,js),[l]),d=c.useMemo(()=>gg(t,n),[t,n]),f=c.useMemo(()=>u?Bc(d,js,u):null,[d,u]),h=Zk(s,n),[p,S]=c.useState(null),[w,E]=c.useState(!1),j=c.useRef(null),v=c.useRef(null),m=c.useRef(!1),x=c.useRef(null),[y,k]=c.useState(null),[R,M]=c.useState(""),[N,O]=c.useState(""),[T,X]=c.useState(null),J=p??h,z=u?{min:u.min,max:u.max}:null,ae=c.useMemo(()=>{var Y;if(!(r!=null&&r.length))return[];const U=[];for(const Z of r){const q=(Y=Z.metrics)==null?void 0:Y[n];q==null||Number.isNaN(q)||U.push(q)}return U},[r,n]),K=ae.length===1?ae[0]:null,A=c.useMemo(()=>!u||ae.length<2?null:Bc(ae,js,u),[ae,u]);c.useEffect(()=>{if(!h||!z){T!=="min"&&M(h?Or(h.min):""),T!=="max"&&O(h?Or(h.max):"");return}if(T!=="min"){const U=ai(h.min,z.min)?"":Or(h.min);M(U)}if(T!=="max"){const U=ai(h.max,z.max)?"":Or(h.max);O(U)}},[h,z,T]),c.useEffect(()=>{k(null)},[n,z==null?void 0:z.min,z==null?void 0:z.max]);const _=U=>{var q;if(!z)return null;const Y=(q=x.current)==null?void 0:q.getBoundingClientRect();if(!Y)return null;const Z=Sh((U.clientX-Y.left)/Y.width);return z.min+(z.max-z.min)*Z},P=(U,Y)=>{if(!z)return;const Z=j.current??U,q=yg(Z,U);S(q),Y&&i(n,q)},D=U=>{var Z;if(!z)return;U.preventDefault();const Y=_(U);Y!=null&&(E(!0),S(null),j.current=Y,v.current=U.clientX,m.current=!1,k(Y),(Z=x.current)==null||Z.setPointerCapture(U.pointerId))},H=U=>{const Y=_(U);if(Y==null){w||k(null);return}if(k(Y),w){const Z=v.current;if(!m.current&&Z!=null){if(Math.abs(U.clientX-Z)<4)return;m.current=!0}m.current&&P(Y,!1)}},te=U=>{var Z;if(!w)return;E(!1),(Z=x.current)==null||Z.releasePointerCapture(U.pointerId);const Y=_(U);m.current&&Y!=null?(k(Y),P(Y,!0)):h&&i(n,null),j.current=null,v.current=null,m.current=!1,setTimeout(()=>S(null),0)},se=(U,Y)=>{if(!z)return;const Z=xg(U),q=xg(Y);if(!Z.valid||!q.valid){Z.valid||M(h?Or(h.min):""),q.valid||O(h?Or(h.max):"");return}if(Z.value==null&&q.value==null){i(n,null);return}const ne=Z.value??z.min,fe=q.value??z.max,Ee=wg(ne,z.min,z.max),xe=wg(fe,z.min,z.max),De=yg(Ee,xe);if(ai(De.min,z.min)&&ai(De.max,z.max)){i(n,null);return}i(n,De)};if(!u||!z)return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:n}),a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]});const I=ae.length;return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:n}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mb-2 tabular-nums",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{children:["Population: ",u.count]}),a.jsxs("span",{children:["Filtered: ",(f==null?void 0:f.count)??0]}),I>1&&a.jsxs("span",{className:"text-text",children:["Selected: ",I]})]}),K!=null&&a.jsxs("span",{className:"text-text",children:["Selected: ",rn(K)]})]}),a.jsxs("svg",{ref:x,viewBox:`0 0 ${js} 100`,preserveAspectRatio:"none",className:"w-full h-28 cursor-crosshair rounded-md bg-surface-inset",onPointerDown:D,onPointerMove:H,onPointerUp:te,onPointerLeave:()=>k(null),children:[Uc(u.bins,"#2e3a4b"),f&&Uc(f.bins,"#3a8fff"),A&&Uc(A.bins,"#f59e0b",{opacity:.55}),J&&RE(J,z),K!=null&&vg(K,z,{color:"var(--highlight)",strokeWidth:.7}),y!=null&&vg(y,z,{color:"rgba(255,255,255,0.75)",strokeWidth:.5,dashed:!0})]}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mt-2 tabular-nums",children:[a.jsx("span",{children:rn(z==null?void 0:z.min)}),a.jsxs("div",{className:"flex flex-col items-center text-center leading-tight",children:[J?a.jsx("span",{className:"text-text",children:ai(J.min,z.min)?` ${rn(J.max)}`:ai(J.max,z.max)?` ${rn(J.min)}`:`${rn(J.min)}  ${rn(J.max)}`}):y!=null?a.jsxs("span",{className:"text-text",children:["Cursor: ",rn(y)]}):a.jsx("span",{children:"Drag to filter"}),J&&y!=null&&a.jsxs("span",{className:"text-[11px] text-muted",children:["Cursor: ",rn(y)]})]}),a.jsx("span",{children:rn(z==null?void 0:z.max)})]}),a.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2 mt-3 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Min"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:R,placeholder:Or(z.min),onFocus:()=>X("min"),onBlur:()=>{X(null),se(R,N)},onChange:U=>M(U.target.value),onKeyDown:U=>{U.key==="Enter"&&U.currentTarget.blur()}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Max"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:N,placeholder:Or(z.max),onFocus:()=>X("max"),onBlur:()=>{X(null),se(R,N)},onChange:U=>O(U.target.value),onKeyDown:U=>{U.key==="Enter"&&U.currentTarget.blur()}})]}),a.jsx("button",{className:"btn btn-xs btn-ghost text-muted hover:text-text",onClick:()=>i(n,null),children:"Clear"})]})]})}function Bc(e,t,n){if(!e.length)return null;const r=n?n.min:Math.min(...e);let s=n?n.max:Math.max(...e);r===s&&(s=r+1);const i=new Array(t).fill(0),o=t/(s-r);for(const l of e){const u=Math.max(0,Math.min(t-1,Math.floor((l-r)*o)));i[u]+=1}return{bins:i,min:r,max:s,count:e.length}}function gg(e,t){var r;const n=[];for(const s of e){const i=(r=s.metrics)==null?void 0:r[t];i==null||Number.isNaN(i)||n.push(i)}return n}function Uc(e,t,n){const r=Math.max(1,...e),s=(n==null?void 0:n.opacity)??.9;return e.map((i,o)=>{const l=i/r*100;return a.jsx("rect",{x:o+.05,y:100-l,width:.9,height:l,fill:t,opacity:s},`${t}-${o}`)})}function RE(e,t){const n=(e.min-t.min)/(t.max-t.min),r=(e.max-t.min)/(t.max-t.min),s=js*Sh(Math.min(n,r)),i=js*Math.abs(r-n);return a.jsx("rect",{x:s,y:0,width:Math.max(.5,i),height:100,fill:"rgba(255,255,255,0.08)",stroke:"rgba(255,255,255,0.4)",strokeWidth:.4})}function vg(e,t,n){const r=Sh((e-t.min)/(t.max-t.min)),s=js*r;return a.jsx("line",{x1:s,y1:0,x2:s,y2:100,stroke:n.color,strokeWidth:n.strokeWidth??.5,strokeDasharray:n.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}function yg(e,t){return e<t?{min:e,max:t}:{min:t,max:e}}function Sh(e){return e<0?0:e>1?1:e}function rn(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function Or(e){if(!Number.isFinite(e))return"";const t=e.toString();return t.includes("e")?e.toFixed(6):t}function xg(e){const t=e.trim();if(!t)return{value:null,valid:!0};const n=Number(t);return Number.isFinite(n)?{value:n,valid:!0}:{value:null,valid:!1}}function wg(e,t,n){return e<t?t:e>n?n:e}function ai(e,t){const n=Math.max(1,Math.abs(e),Math.abs(t));return Math.abs(e-t)<=1e-6*n}function Sg(e){return e?e.length>=10?e.slice(0,10):e:""}const PE=[{label:"Root",path:"/"}],TE="w-11 h-11 rounded-md border border-border flex items-center justify-center transition-colors",LE="bg-accent-muted text-accent",_E="bg-surface text-text hover:bg-surface-hover";function ga(e){return`${TE} ${e?LE:_E}`}function IE({leftTool:e,onToolChange:t,compareEnabled:n,compareActive:r,onOpenCompare:s,views:i,activeViewId:o,onActivateView:l,onSaveView:u,current:d,data:f,onOpenFolder:h,onOpenFolderActions:p,onPullRefreshFolders:S,onContextMenu:w,countVersion:E,items:j,filteredItems:v,metricKeys:m,selectedItems:x,selectedMetric:y,onSelectMetric:k,filters:R,onChangeRange:M,onChangeFilters:N,onResize:O}){const T=ga(e==="folders"),X=ga(e==="metrics"),J=ga(r),z=`${ga(!1)} cursor-pointer`;return a.jsxs("div",{className:"app-left-panel col-start-1 row-start-2 relative border-r border-border bg-panel overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-y-0 left-0 w-12 border-r border-border flex flex-col items-center gap-2 py-3 bg-surface-overlay",children:[a.jsx("button",{className:T,title:"Folders","aria-label":"Folders","aria-pressed":e==="folders",onClick:()=>t("folders"),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M3 7.5h6l2-2h10a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2z"})})}),a.jsx("button",{className:X,title:"Metrics / Filters","aria-label":"Metrics and Filters","aria-pressed":e==="metrics",onClick:()=>t("metrics"),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]})}),a.jsx("div",{className:"w-6 h-px bg-border/70 my-1"}),a.jsx("button",{className:`${J} ${n?"":"opacity-40 cursor-not-allowed"}`,title:n?"Compare selected images":"Compare (select 2+)","aria-label":"Compare selected images","aria-pressed":r,"aria-disabled":!n,disabled:!n,onClick:()=>{n&&s()},children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("rect",{x:"3",y:"4",width:"8",height:"16",rx:"1"}),a.jsx("rect",{x:"13",y:"4",width:"8",height:"16",rx:"1"})]})}),a.jsx("div",{className:"flex-1"}),a.jsx("a",{className:z,href:"https://github.com/trojblue/lenslet",title:"Lenslet on GitHub","aria-label":"Lenslet on GitHub",target:"_blank",rel:"noreferrer",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:a.jsx("path",{d:"M12 .5C5.73.5.5 5.74.5 12.02c0 5.1 3.29 9.42 7.86 10.95.58.11.79-.25.79-.56v-2.17c-3.2.7-3.88-1.55-3.88-1.55-.53-1.35-1.29-1.71-1.29-1.71-1.05-.72.08-.71.08-.71 1.16.08 1.78 1.2 1.78 1.2 1.03 1.77 2.71 1.26 3.37.96.1-.75.4-1.26.73-1.55-2.55-.29-5.23-1.29-5.23-5.74 0-1.27.45-2.31 1.19-3.13-.12-.29-.52-1.46.11-3.05 0 0 .97-.31 3.18 1.19.92-.26 1.91-.39 2.89-.39.98 0 1.97.13 2.89.39 2.2-1.5 3.18-1.19 3.18-1.19.63 1.59.23 2.76.11 3.05.74.82 1.19 1.86 1.19 3.13 0 4.46-2.69 5.45-5.25 5.73.41.36.78 1.07.78 2.16v3.2c0 .31.21.67.8.56 4.56-1.53 7.85-5.85 7.85-10.95C23.5 5.74 18.27.5 12 .5z"})})})]}),a.jsx("div",{className:"ml-12 h-full",children:e==="folders"?a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-2 py-2 border-b border-border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Smart Folders"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:u,title:"Save current view as Smart Folder",children:"+ New"})]}),i.length?a.jsx("div",{className:"flex flex-col gap-1",children:i.map(ae=>{const K=ae.id===o;return a.jsx("button",{className:`text-left px-2 py-2 rounded-md text-sm ${K?"bg-accent-muted text-accent":"hover:bg-hover text-text"}`,onClick:()=>l(ae),children:ae.name},ae.id)})}):a.jsx("div",{className:"text-xs text-muted px-1 py-1.5",children:"No saved Smart Folders yet."})]}),a.jsx(CE,{current:d,roots:PE,data:f,onOpen:h,onPullRefresh:S,onContextMenu:w,onOpenActions:p,countVersion:E,className:"flex-1 min-h-0 overflow-auto scrollbar-thin",showResizeHandle:!1})]}):a.jsx(EE,{items:j,filteredItems:v,metricKeys:m,selectedItems:x,selectedMetric:y,onSelectMetric:k,filters:R,onChangeRange:M,onChangeFilters:N})}),a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 right-0",onPointerDown:O})]})}function FE({persistenceEnabled:e,offViewSummary:t,onRevealOffView:n,canRevealOffView:r=!1,onClearOffView:s,browserZoomPercent:i}){const l=!!(t!=null&&t.names.length)&&t?` (${t.names.join(", ")}${t.extra?` +${t.extra}`:""})`:"",u=r&&n!=null,d=typeof i=="number"?i:null,f=d!==null&&Math.abs(d-100)>=2;return!e||f||!!t?a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-col gap-2",children:[!e&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Not persisted."})," Workspace is read-only; edits stay in memory until restart."]}),f&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Browser zoom ",Math.round(d),"%."]})," For best results, set it to 100% so UI elements stay in correct proportions."]}),t&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex items-center justify-between gap-3",children:[a.jsxs("span",{children:["Updates outside current view: ",t.count," item",t.count===1?"":"s",l]}),a.jsxs("div",{className:"flex items-center gap-2",children:[u&&a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>n==null?void 0:n(),"aria-label":"Reveal off-view updates",children:"Reveal"}),a.jsx("button",{className:"text-muted hover:text-text transition-colors text-base leading-none",onClick:s,"aria-label":"Clear off-view updates",children:""})]})]})]})}):null}const OE=6e3,AE=1e4,DE=24*60*6e4,zE=3e4,$E=350,BE=1400,UE=2048,HE=6,VE=10;function Hx(e){const t=new Map;for(const n of e)t.set(n.path,n.name);return t}function Vx(e,t){return t.get(e)??e.split("/").pop()??e}function bg(e,t){const n=e.filter(r=>!t.has(r.path));return n.length===e.length?e:n}function Cg(e,t,n,r,s){const i=e.filter(l=>l.path!==t);return[{path:t,ts:n,kind:r},...i].slice(0,s)}function WE(e,t){if(!e.length)return null;const n=Hx(t),r=new Set,s=[];for(const o of e)r.has(o.path)||(r.add(o.path),s.push(o.path));const i=s.slice(0,2).map(o=>Vx(o,n));return{count:s.length,names:i,extra:Math.max(0,s.length-i.length)}}function QE(e,t,n,r){if(!e.length)return[];const s=Hx(t);return e.map(i=>({path:i.path,label:Vx(i.path,s),timeLabel:r(i.ts,n)}))}function KE(e){const[t,n]=c.useState([]),[r,s]=c.useState([]),[i,o]=c.useState(new Map),l=c.useRef(new Map),u=c.useRef(new Set),d=c.useRef(new Set),f=c.useRef(new Set);c.useEffect(()=>()=>{for(const j of l.current.values())window.clearTimeout(j);l.current.clear(),u.current.clear()},[]),c.useEffect(()=>{d.current=new Set(e),n(j=>bg(j,f.current))},[e]);const h=c.useCallback((j,v)=>{if(v!=null){if(u.current.has(v))return;if(u.current.add(v),u.current.size>UE){const R=u.current.values().next().value;R!=null&&u.current.delete(R)}}const m=v!=null?`event:${v}`:`event:${j}:${Date.now()}`;o(R=>{if(R.get(j)===m)return R;const M=new Map(R);return M.set(j,m),M});const x=l.current,y=x.get(j);y!=null&&window.clearTimeout(y);const k=window.setTimeout(()=>{o(R=>{if(R.get(j)!==m)return R;const M=new Map(R);return M.delete(j),M}),x.delete(j)},BE);x.set(j,k)},[]),p=c.useCallback(j=>{f.current=j,n(v=>bg(v,j))},[]),S=c.useCallback((j,v,m)=>{const x=Date.now();d.current.has(j)&&f.current.has(j)||n(k=>Cg(k,j,x,v,HE)),h(j,m)},[h]),w=c.useCallback((j,v,m)=>{const x=Date.now(),y=jx(m)??x;s(k=>Cg(k,j,y,v,VE))},[]),E=c.useCallback(()=>{n([])},[]);return{offViewActivity:t,recentTouches:r,highlightedPaths:i,onVisiblePathsChange:p,markRecentActivity:S,markRecentTouch:w,clearOffViewActivity:E}}function YE(e){return e.isOffline?"offline":e.isUnstable?"unstable":e.recentEditActive?"recent":Number.isFinite(e.editingCount)&&e.editingCount>0?"editing":"live"}function Wx(e){if(!e.length)return e;const t=new Set,n=[];for(const r of e)t.has(r.path)||(t.add(r.path),n.push(r));return n}function Qx(e){return{...e,items:Wx(e.items)}}function XE(e,t){const n=e.pageCount??1,r=e.pageSize??t,s=(e.page??1)+1;return n<=1||s>n?null:{startPage:s,endPage:n,pageSize:r}}function qE(e,t){if(e.path!==t.path)return Qx(t);const n=Wx([...e.items,...t.items]);return{...e,generatedAt:t.generatedAt??e.generatedAt,dirs:e.dirs.length?e.dirs:t.dirs,items:n,page:t.page??e.page,pageSize:t.pageSize??e.pageSize,pageCount:t.pageCount??e.pageCount,totalItems:t.totalItems??e.totalItems}}async function GE(e,t){const n=t.shouldContinue??(()=>!0);let r=Qx(e);t.onUpdate(r);const s=XE(e,t.defaultPageSize);if(s)for(let i=s.startPage;i<=s.endPage;i+=1){let o;try{o=await t.fetchPage(i,s.pageSize)}catch{return}if(!n())return;r=qE(r,o),t.onUpdate(r)}}const Kx=[-2,-1,1,2],Yx=[-2,-1,0,1,2,3];Kx.length;Yx.length;function JE(e,t,n){return Math.min(Math.max(e,t),n)}function Xx(e,t,n){const r=new Set,s=[];for(const i of n){const o=t+i;if(o<0||o>=e.length)continue;const l=e[o];!l||r.has(l)||(r.add(l),s.push(l))}return s}function ZE(e,t){if(!t)return[];const n=e.indexOf(t);return n<0?[]:Xx(e,n,Kx)}function eN(e,t){if(e.length<2)return[];const n=Math.max(0,e.length-2),r=JE(t,0,n);return Xx(e,r,Yx)}function tN({paths:e,defaultDestination:t,destinations:n,loadingDestinations:r,onClose:s,onSubmit:i}){const[o,l]=c.useState(()=>Nt(t||"/")),[u,d]=c.useState(!1);c.useEffect(()=>{l(Nt(t||"/"))},[t,e]);const f=Nt(o||"/"),h=e.length>0&&!u,p=e.slice(0,3).map(j=>xh(j)||j),S=Math.max(0,e.length-p.length),w=n.filter(j=>j!==f).slice(0,8),E=async j=>{if(j.preventDefault(),!!h){d(!0);try{await i(e,f)}finally{d(!1)}}};return a.jsx("div",{className:"toolbar-offset fixed inset-0 z-overlay bg-black/45 backdrop-blur-[1px] flex items-center justify-center p-3",children:a.jsxs("div",{className:"w-full max-w-[560px] rounded-xl border border-border bg-panel shadow-[0_20px_60px_rgba(0,0,0,0.55)]",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Move to folder"}),a.jsxs("div",{className:"text-xs text-muted",children:[e.length," item(s) selected"]})]}),a.jsx("button",{type:"button",className:"btn btn-icon",onClick:s,"aria-label":"Close move dialog",disabled:u,children:""})]}),a.jsxs("form",{className:"px-4 py-3 flex flex-col gap-3",onSubmit:E,children:[a.jsxs("div",{className:"text-xs text-muted",children:[p.join(", "),S>0?` and ${S} more`:""]}),a.jsxs("label",{className:"text-xs text-muted flex flex-col gap-1.5",children:["Destination folder",a.jsx("input",{value:o,onChange:j=>l(j.target.value),className:"input w-full",list:"move-destination-list",placeholder:"/",autoFocus:!0,disabled:u})]}),a.jsx("datalist",{id:"move-destination-list",children:n.map(j=>a.jsx("option",{value:j},j))}),a.jsx("div",{className:"text-[11px] text-muted",children:r?"Loading folder list":`${n.length.toLocaleString()} destination(s) loaded`}),w.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5",children:w.map(j=>a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>l(j),disabled:u,children:j},j))}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-border",children:[a.jsx("button",{type:"button",className:"btn",onClick:s,disabled:u,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-active",disabled:!h,children:u?"Moving":"Move"})]})]})]})})}function nN(e){return JSON.stringify(e,null,2)}function rN(e){const t=s=>'"'+s.replaceAll('"','""')+'"',n="path,folder,name,star,type,size,width,height,tags,notes",r=e.map(s=>{const i=(s.tags||[]).join(" "),o=s.notes||"";return[s.path,s.folder,s.name,String(s.star??""),s.type??"",s.size??"",s.width??"",s.height??"",i,o].map(l=>t(String(l))).join(",")});return[n,...r].join(`
`)}function sN(e){return e.map(t=>{const n=t.path.split("/").filter(Boolean);n.pop();const r=n.length?`/${n.join("/")}`:"/";return{path:t.path,folder:r,name:t.name,star:t.star??null,type:t.type,size:t.size,width:t.w,height:t.h}})}function iN({x:e,y:t,items:n}){const r=c.useRef(null),[s,i]=c.useState({x:e,y:t}),[o,l]=c.useState(!1),u=c.useCallback((f,h)=>{h.stopPropagation(),f.disabled||f.onClick()},[]),d=c.useCallback(()=>{const f=r.current,h=mx(),p=f==null?void 0:f.getBoundingClientRect(),S=(p==null?void 0:p.width)??180,w=(p==null?void 0:p.height)??Math.max(40,n.length*36),E=px({x:e,y:t,menuWidth:S,menuHeight:w,viewport:h});i(j=>j.x===E.x&&j.y===E.y?j:E),l(!0)},[n.length,e,t]);return c.useLayoutEffect(()=>{d()},[d]),c.useEffect(()=>(window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}),[d]),a.jsx("div",{ref:r,className:"dropdown-panel fixed",role:"menu",style:{left:s.x,top:s.y,minWidth:180,visibility:o?"visible":"hidden"},onClick:f=>f.stopPropagation(),children:n.map((f,h)=>a.jsxs("button",{className:`dropdown-item w-full ${f.danger?"text-danger hover:text-danger":""}`,role:"menuitem","aria-disabled":f.disabled,disabled:f.disabled,onClick:p=>u(f,p),children:[f.icon&&a.jsx("span",{className:"shrink-0",children:f.icon}),a.jsx("span",{children:f.label})]},h))})}function kg(e){return e==="csv"?"text/csv;charset=utf-8":"application/json;charset=utf-8"}function Eg(e,t){const n=sN(e);return t==="csv"?rN(n):nN(n)}function Ng(){return new Date().toISOString().replace(/[:.]/g,"-")}function oN({ctx:e,current:t,items:n,setCtx:r,onRefetch:s,onOpenMoveDialog:i,onRefreshFolder:o}){const l=Ok(t),[u,d]=c.useState(!1),[f,h]=c.useState(null),p=e.kind==="grid"?e.payload.paths:[],S=c.useMemo(()=>new Map(n.map(M=>[M.path,M])),[n]),w=()=>{r(null)},E=async()=>{const M=e.kind==="tree"?e.payload.path:"/";d(!0);try{await o(M)}catch(N){console.error("Failed to refresh folder:",N)}finally{d(!1),w()}},j=M=>async()=>{h(M);const N=e.kind==="tree"?e.payload.path:t;try{const O=await Se.getFolder(N,{recursive:!0,legacyRecursive:!0}),T=Eg(O.items,M),X=kg(M),J=N==="/"?"root":(N.replace(/^\/+/,"")||"root").replace(/\//g,"_");Uo(new Blob([T],{type:X}),`metadata_${J}_${Ng()}.${M}`)}catch(O){console.error("Failed to export folder:",O),alert("Failed to export folder. See console for details.")}finally{h(null),w()}},v=M=>async()=>{h(M);try{const N=new Set(p),O=n.filter(J=>N.has(J.path)),T=Eg(O,M),X=kg(M);Uo(new Blob([T],{type:X}),`metadata_selection_${Ng()}.${M}`)}finally{h(null),w()}},m=async()=>{var M;if(p.length){w();for(const N of p)try{const O=await Se.getFile(N),T=((M=S.get(N))==null?void 0:M.name)||xh(N)||"image";Uo(O,T)}catch(O){console.error(`Failed to download ${N}:`,O)}}},x=async()=>{if(!l){for(const M of p)try{await Se.moveFile(M,"/_trash_")}catch(N){console.error(`Failed to trash ${M}:`,N)}s(),w()}},y=async()=>{if(confirm(`Delete ${p.length} file(s) permanently? This cannot be undone.`)){try{await Se.deleteFiles(p)}catch(M){console.error("Failed to delete files:",M)}s(),w()}},k=async()=>{for(const M of p)try{const O=(await Se.getSidecar(M)).original_position,T=O&&O.split("/").slice(0,-1).join("/")||"/";await Se.moveFile(M,T)}catch(N){console.error(`Failed to recover ${M}:`,N)}s(),w()},R=e.kind==="tree"?[{label:u?"Refreshing":"Refresh",disabled:u,onClick:E},{label:f==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!f||u,onClick:j("csv")},{label:f==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!f||u,onClick:j("json")}]:lN({selectedPaths:p,inTrash:l,exporting:f,onDownloadSelection:m,onMoveSelection:i,onMoveToTrash:x,onPermanentDelete:y,onRecover:k,onExportCsv:v("csv"),onExportJson:v("json")});return a.jsx(iN,{x:e.x,y:e.y,items:R})}function lN({selectedPaths:e,inTrash:t,exporting:n,onDownloadSelection:r,onMoveSelection:s,onMoveToTrash:i,onPermanentDelete:o,onRecover:l,onExportCsv:u,onExportJson:d}){const f=[];return e.length&&f.push({label:e.length>1?`Download (${e.length})`:"Download",onClick:r}),e.length&&f.push({label:"Move to",disabled:t,onClick:()=>{t||s(e)}}),f.push({label:"Move to trash",disabled:t,onClick:i}),t&&(f.push({label:"Permanent delete",danger:!0,onClick:o}),f.push({label:"Recover",onClick:l})),e.length&&(f.push({label:n==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!n,onClick:u}),f.push({label:n==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!n,onClick:d})),f}const qe={sortKey:"sortKey",sortDir:"sortDir",sortSpec:"sortSpec",starFilters:"starFilters",filterAst:"filterAst",selectedMetric:"selectedMetric",viewMode:"viewMode",gridItemSize:"gridItemSize",leftOpen:"leftOpen",rightOpen:"rightOpen"},aN=600;function uN(e){switch(e){case"live":return"Live";case"reconnecting":return"Reconnecting";case"offline":return"Offline";case"connecting":case"idle":default:return"Connecting"}}function jg(e){if(!(e instanceof an))return null;const t=e.body;if(!t||typeof t!="object")return null;const n=t.error;return typeof n=="string"?n:null}function Mg(e,t){for(const n of e)Se.prefetchFile(n,t),Se.prefetchThumb(n)}function Rg(e,t){return t-e<DE?tk(e,t):nk(e)}function cN(e,t){return e?t instanceof an||t instanceof Error?t.message:"Failed to load embeddings.":null}function dN(e,t,n,r){return e||t?n:r}function fN(e,t,n,r,s,i){return e?n:t||i==="/"?r:s}function hN(e){if(!(e instanceof an))return!1;if(e.status===403||e.status===405)return!0;const t=String(e.message||"").toLowerCase();return t.includes("read-only")||t.includes("no-write")||t.includes("write")}function No(e,t){return hN(e)?"This workspace is read-only. Upload and move actions are disabled.":e instanceof an||e instanceof Error&&e.message?e.message:t}function Hc(e){return Array.from(new Set(e.filter(Boolean)))}function Pg(e,t){return t.length?t.length===1?t[0]:`${e} failed for ${t.length} item(s). ${t[0]}`:""}function pN(){var Oh,Ah,Dh;const[e,t]=c.useState("/"),[n,r]=c.useState(""),[s,i]=c.useState([]),[o,l]=c.useState(!1),[u,d]=c.useState(null),[f,h]=c.useState(null),[p,S]=c.useState(!1),[w,E]=c.useState(0),[j,v]=c.useState(0),[m,x]=c.useState(null),[y,k]=c.useState(100),[R,M]=c.useState(null),[N,O]=c.useState(()=>({filters:{and:[]},sort:{kind:"builtin",key:"added",dir:"desc"},selectedMetric:void 0})),[T,X]=c.useState(()=>Date.now()),[J,z]=c.useState("adaptive"),[ae,K]=c.useState(220),[A,_]=c.useState(!1),[P,D]=c.useState(!0),[H,te]=c.useState(!0),[se,I]=c.useState(()=>typeof window>"u"?1440:window.innerWidth),U=Ta(Pa.narrow),[Y,Z]=c.useState("folders"),[q,ne]=c.useState([]),[fe,Ee]=c.useState(null),[xe,De]=c.useState(0),[be,Ie]=c.useState({}),lt=c.useRef(null),xt=c.useRef(null),fn=c.useRef(null),Un=c.useRef(null),qt=c.useRef(null),Ze=c.useRef(!1),Gt=c.useRef(!1),Dt=c.useRef(null),hn=c.useRef(null),Pn=c.useRef(Gi()),pn=c.useRef(null),et=c.useRef(null),ht=c.useRef(null),Jt=c.useRef(!1),zt=c.useRef(null),Hn=c.useRef("idle"),{leftW:Zt,rightW:mn,onResizeLeft:ar,onResizeRight:$}=fE(lt,Y),[ee,W]=c.useState(!1),[me,ye]=c.useState(!1),[ge,ce]=c.useState(null),[Re,we]=c.useState(null),[wt,Oe]=c.useState(["/"]),[Ne,St]=c.useState(!1),[gn,at]=c.useState(null),Pe=Ys(),Vn=HC(),$u=Ou(),bl=WC(),[vn,Cl]=c.useState("idle"),[kl,no]=c.useState({}),[en,El]=c.useState(null),[pt,Xs]=c.useState(null),[tn,Rt]=c.useState(!1),[Wn,qs]=c.useState(()=>Date.now()),[Nl,Bu]=c.useState(!0),[Gs,Js]=c.useState(!1);c.useEffect(()=>{const g=L=>{const B=Nt(L),V=Fk(B)?B:null,ie=V?qm(B):B;V?(h(V),i([V])):(h(null),Ze.current=!1),t(ve=>ve===ie?ve:(v(G=>G+1),ie))};g(Ym());const C=()=>g(Ym());return window.addEventListener("hashchange",C),()=>window.removeEventListener("hashchange",C)},[]),c.useEffect(()=>{if(pt==null){Rt(!1);return}Rt(!0);const g=window.setTimeout(()=>Rt(!1),OE);return()=>window.clearTimeout(g)},[pt]),c.useEffect(()=>{if(en==null)return;qs(Date.now());const g=window.setInterval(()=>qs(Date.now()),1e4);return()=>window.clearInterval(g)},[en]);const{data:yn,refetch:ro,isLoading:Uu,isError:ps}=uf(e,!0,{page:1,pageSize:Ia}),[Be,jl]=c.useState(),so=c.useRef(0),Qn=c.useCallback(()=>ro(),[ro]),{data:ur}=uf("/",!0,{enabled:!1,page:1,pageSize:Ia});c.useEffect(()=>{Pe.removeQueries({predicate:({queryKey:g})=>Ek(g,e,!0)})},[e,Pe]),c.useEffect(()=>{so.current+=1,jl(void 0),ce(null)},[e]),c.useEffect(()=>{if(!yn)return;const g=++so.current;let C=!1;return GE(yn,{defaultPageSize:Ia,fetchPage:(L,B)=>Se.getFolder(yn.path,{recursive:!0,page:L,pageSize:B}),onUpdate:jl,shouldContinue:()=>!C&&so.current===g}),()=>{C=!0}},[yn]);const $t=u!==null,Kn=!$t&&n.trim().length>0,io=hE(n,250),ms=c.useMemo(()=>io.trim().replace(/\s+/g," "),[io]),Zs=Pk(Kn?ms:"",e),Rr=Lk(),Ml=((Oh=Rr.data)==null?void 0:Oh.embeddings)??[],Rl=((Ah=Rr.data)==null?void 0:Ah.rejected)??[],oo=Ml.length>0,ei=cN(Rr.isError,Rr.error),Yn=c.useMemo(()=>Nt(e||"/"),[e]),Xn=c.useMemo(()=>Gm(N.filters),[N.filters]),Bt=c.useMemo(()=>{var C;return(Kn?((C=Zs.data)==null?void 0:C.items)??[]:(Be==null?void 0:Be.items)??[]).map(L=>({...L,star:be[L.path]!==void 0?be[L.path]:L.star}))},[Kn,Zs.data,Be,be]),ti=c.useMemo(()=>{var L;const g=new Map;for(const B of Bt)g.set(B.path,B);const C=((L=Zs.data)==null?void 0:L.items)??[];for(const B of C){if(g.has(B.path))continue;const V=be[B.path]!==void 0?be[B.path]:B.star;g.set(B.path,{...B,star:V})}return g},[Bt,Zs.data,be]),xn=c.useMemo(()=>u?u.items.map(g=>{const C=ti.get(g.path);return C||uk(g.path,be[g.path])}):[],[u,ti,be]),Ke=c.useMemo(()=>{if(u)return ng(xn,N.filters);const g=ng(Bt,N.filters);return lE(g,N.sort,T)},[u,xn,Bt,N.filters,N.sort,T]),gs=u?xn.length:Bt.length,lo=Ke.length,wn=c.useMemo(()=>Ke.map(g=>g.path),[Ke]),{offViewActivity:Pl,recentTouches:cr,highlightedPaths:Tl,onVisiblePathsChange:qn,markRecentActivity:Pr,markRecentTouch:Tr,clearOffViewActivity:Ll}=KE(wn),F=c.useMemo(()=>new Set(s),[s]),oe=c.useMemo(()=>{if(!s.length)return[];const g=u?xn:Bt,C=new Map(g.map(B=>[B.path,B])),L=new Map(Ke.map(B=>[B.path,B]));return s.map(B=>C.get(B)??L.get(B)).filter(B=>!!B)},[s,u,xn,Bt,Ke]),le=c.useMemo(()=>Ke.filter(g=>F.has(g.path)),[Ke,F]),he=c.useMemo(()=>le.map(g=>g.path),[le]),Le=Math.max(0,le.length-2),ut=Math.min(w,Le),Gn=le[ut]??null,vs=le[ut+1]??null,ni=ut>0,tt=ut<le.length-2,nn=le.length>=2,ri=u?xn:Bt,Lr=u?null:N.sort.kind==="metric"?N.sort.key:null,Hu=c.useMemo(()=>Lr?Ke.some(g=>{var L;const C=(L=g.metrics)==null?void 0:L[Lr];return C!=null&&!Number.isNaN(C)}):!1,[Ke,Lr]);c.useEffect(()=>{E(g=>g>Le?Le:g)},[Le]);const bt=c.useCallback(g=>{const C=Date.now(),B=jx(g)??C,V=B>C?C:B;El(ie=>ie==null?V:ie>V?ie:V),Xs(C),qs(C)},[]),_r=c.useCallback(g=>{const C=Object.prototype.hasOwnProperty.call(g,"star"),L=g.metrics!==void 0,B=g.comments!==void 0;if(!C&&!L&&!B)return;const V=ve=>{if(ve.path!==g.path)return ve;let G=ve;return C&&ve.star!==g.star&&(G={...G,star:g.star??null}),L&&(G={...G,metrics:g.metrics??null}),B&&ve.comments!==g.comments&&(G={...G,comments:g.comments??""}),G},ie=ve=>{if(!ve)return ve;let G=!1;const de=ve.items.map(je=>{const Ut=V(je);return Ut!==je&&(G=!0),Ut});return G?{...ve,items:de}:ve};Pe.setQueriesData({predicate:({queryKey:ve})=>Array.isArray(ve)&&ve[0]==="folder"},ie),Pe.setQueriesData({predicate:({queryKey:ve})=>Array.isArray(ve)&&ve[0]==="search"},ie)},[Pe]),ys=c.useCallback(()=>{De(g=>g+1)},[]),ao=c.useCallback(g=>{const C=Nt(g||"/");return C===""?"/":C},[]),uo=c.useCallback(g=>{const C=L=>g==="/"?!0:L===g||L.startsWith(`${g}/`);Pe.invalidateQueries({predicate:({queryKey:L})=>{if(!Array.isArray(L)||L[0]!=="folder")return!1;const B=typeof L[1]=="string"?L[1]:"";return C(B)}})},[Pe]),co=c.useCallback(async g=>{const C=ao(g);await Se.refreshFolder(C),uo(C),ys(),(e===C||e.startsWith(C==="/"?"/":`${C}/`))&&await Qn(),qd.evictPrefix(C),ui.evictPrefix(C)},[e,ys,uo,ao,Qn]),Vu=c.useCallback(async()=>{try{await co(e)}catch(g){console.error("Failed to refresh folder:",g)}},[e,co]),si=c.useCallback(g=>{g.length&&no(C=>{let L=!1;const B={...C};for(const V of g){const ie=C[V.gallery_id];ie&&ie.viewing===V.viewing&&ie.editing===V.editing||(B[V.gallery_id]=V,L=!0)}return L?B:C})},[]),_l=c.useCallback(()=>{zt.current!=null&&(window.clearTimeout(zt.current),zt.current=null)},[]),Il=c.useCallback(g=>{g&&no(C=>{if(!(g in C))return C;const L={...C};return delete L[g],L})},[]),Wu=c.useCallback(g=>{pn.current=g.lease_id,et.current=g.gallery_id,si([g])},[si]),Jn=c.useCallback(async(g,C=!1)=>{const L=Pn.current,B=C?void 0:pn.current??void 0,V=ie=>Se.joinPresence(g,ie,L);try{Wu(await V(B));return}catch(ie){if(!C&&jg(ie)==="invalid_lease"){Wu(await V(void 0));return}throw ie}},[Wu]),bh=c.useCallback(async(g,C)=>{if(g===C){await Jn(C);return}const L=pn.current;if(!L){await Jn(C,!0);return}try{const B=await Se.movePresence(g,C,L,Pn.current);et.current=B.to_scope.gallery_id,si([B.from_scope,B.to_scope]);return}catch(B){const V=jg(B);if(V==="invalid_lease"){await Jn(C,!0);return}if(V==="scope_mismatch"){await Jn(C);return}throw B}},[si,Jn]),Ch=c.useCallback(async g=>{const C=et.current;if(!C){await Jn(g,!0);return}if(C===g){await Jn(g);return}await bh(C,g)},[Jn,bh]),Fl=c.useCallback(async()=>{if(Jt.current)return;const g=ht.current;if(g){ht.current=null,Jt.current=!0;try{await Ch(g)}catch{}finally{Jt.current=!1;const C=ht.current;C&&C!==et.current&&Fl()}}},[Ch]),ii=c.useCallback((g,C=!1)=>{if(ht.current=g,_l(),C||et.current==null){Fl();return}zt.current=window.setTimeout(()=>{zt.current=null,Fl()},$E)},[_l,Fl]),kh=c.useCallback(()=>{et.current=null,pn.current=null,ht.current=null,_l()},[_l]),Ol=c.useCallback(g=>{const C=et.current,L=pn.current;!C||!L||(Eb(C,L,Pn.current),g&&Il(C),kh())},[Il,kh]);c.useEffect(()=>{yb();const g=wb(L=>{if(L.type==="presence"){const ie=L.data;if(!(ie!=null&&ie.gallery_id))return;si([ie]);return}const B=L.data;if(!(B!=null&&B.path))return;const V=B.path;if(L.type==="item-updated"){const ie=L.data,ve={v:1,tags:ie.tags??[],notes:ie.notes??"",star:ie.star??null,version:ie.version??1,updated_at:ie.updated_at??"",updated_by:ie.updated_by??"server"};Pe.setQueryData(cl(V),ve),_r({path:V,star:ie.star??null,metrics:ie.metrics,comments:ie.notes??""}),YC(V,ve),Pr(V,"item-updated",L.id),Tr(V,"item-updated",ie.updated_at),bt(ie.updated_at),Ie(G=>{if(G[V]===void 0)return G;const de={...G};return delete de[V],de})}else if(L.type==="metrics-updated"){const ie=L.data;_r({path:V,metrics:ie.metrics}),Pr(V,"metrics-updated",L.id),Tr(V,"metrics-updated",ie.updated_at),bt(ie.updated_at)}}),C=Sb(Cl);return()=>{g(),C(),xb()}},[si,Pr,Tr,Pe,_r,bt]),c.useEffect(()=>{const g=et.current;g!==Yn&&ii(Yn,g==null)},[Yn,ii]),c.useEffect(()=>{const g=window.setInterval(()=>{const C=et.current;C&&Jn(C)},zE);return()=>{window.clearInterval(g)}},[Jn]),c.useEffect(()=>{const g=Hn.current;if(Hn.current=vn,vn==="live"&&g!=="live"){ii(Yn,!0);return}(vn==="reconnecting"||vn==="offline")&&Il(et.current)},[Il,vn,Yn,ii]),c.useEffect(()=>{const g=()=>Ol(!0),C=()=>Ol(!0),L=()=>{ii(Yn,!0)};return window.addEventListener("pagehide",g),window.addEventListener("beforeunload",C),window.addEventListener("pageshow",L),()=>{window.removeEventListener("pagehide",g),window.removeEventListener("beforeunload",C),window.removeEventListener("pageshow",L),Ol(!1)}},[Yn,ii,Ol]),c.useEffect(()=>{let g=!1;return Se.getHealth().then(C=>{var B;if(g)return;const L=((B=C==null?void 0:C.labels)==null?void 0:B.enabled)??!0;Bu(L)}).catch(()=>{}),()=>{g=!0}},[]);const qx=c.useMemo(()=>{const g=u?xn:Bt,C={0:0,1:0,2:0,3:0,4:0,5:0};for(const L of g){const B=be[L.path]??L.star??0;C[String(B)]=(C[String(B)]||0)+1}return C},[u,xn,Bt,be]),Ir=c.useMemo(()=>{const g=new Set;let C=0;const L=u?xn:Bt;for(const B of L){const V=B.metrics;if(V)for(const ie of Object.keys(V))g.add(ie);if(C+=1,C>=250&&g.size>0)break}return Array.from(g).sort()},[u,xn,Bt]);c.useEffect(()=>{$t||Ir.length&&O(g=>{const C=g.selectedMetric&&Ir.includes(g.selectedMetric)?g.selectedMetric:Ir[0];return C===g.selectedMetric?g:{...g,selectedMetric:C}})},[Ir,$t]),c.useEffect(()=>{$t||N.sort.kind==="metric"&&(Ir.includes(N.sort.key)||O(g=>({...g,sort:{kind:"builtin",key:"added",dir:g.sort.dir}})))},[Ir,N.sort,$t]);const Al=c.useMemo(()=>tE(N.filters),[N.filters]),Dl=(Be==null?void 0:Be.totalItems)??(Be==null?void 0:Be.items.length)??gs,Gx=e==="/"?Dl:(ur==null?void 0:ur.totalItems)??(ur==null?void 0:ur.items.length)??Dl,Qu=$t||Kn||Al>0,zl=kl[e],Jx=Vn.state==="syncing"?"Syncing":Vn.state==="error"?Vn.message?`Not saved  ${Vn.message}`:"Not saved  retry":"All changes saved",Zx=uN(vn),Ku=en!=null,e0=c.useMemo(()=>!Ku||en==null?"No edits yet.":Rg(en,Wn),[Ku,en,Wn]),t0=(zl==null?void 0:zl.editing)??0,n0=bl!=null&&bl>AE,r0=vn==="offline"||vn==="connecting"||vn==="idle",s0=vn==="reconnecting"||$u||Vn.state==="error"||n0,i0=YE({isOffline:r0,isUnstable:s0,recentEditActive:tn,editingCount:t0}),o0=c.useMemo(()=>WE(Pl,Ke),[Pl,Ke]),l0=c.useMemo(()=>QE(cr,Ke,Wn,Rg),[Ke,Wn,cr]),a0=dN($t,Qu,lo,Dl),u0=fN($t,Qu,gs,Dl,Gx,e),Eh=c.useMemo(()=>{if(!u)return null;if(u.queryPath){const g=u.queryPath.split("/").filter(Boolean);return g.length?g[g.length-1]:u.queryPath}return u.queryVector?"Vector query":null},[u]),Nh=c.useMemo(()=>u?Al>0?`${lo} of ${gs}`:`${gs}`:null,[u,Al,lo,gs]),Pt=c.useCallback(g=>{O(C=>({...C,filters:g(C.filters)}))},[]),c0=c.useCallback(g=>{O(C=>({...C,filters:g}))},[]),$l=c.useCallback(()=>{Pt(g=>$c(g,[]))},[Pt]),jh=c.useCallback(()=>{O(g=>({...g,filters:{and:[]}}))},[]),Yu=c.useCallback(()=>{d(null);const g=hn.current;hn.current=null,g&&g.length?(i(g),v(C=>C+1)):i([])},[]),d0=c.useCallback(()=>{u&&Yu(),r(""),O(g=>({...g,filters:{and:[]}}))},[Yu,u]),f0=c.useCallback(async g=>{!u&&hn.current===null&&(hn.current=s);const C=await Se.searchEmbeddings(g);if(d({embedding:C.embedding,queryPath:g.query_path??null,queryVector:g.query_vector_b64??null,topK:g.top_k??50,minScore:g.min_score??null,items:C.items,createdAt:Date.now()}),C.items.length){const L=g.query_path&&C.items.some(B=>B.path===g.query_path)?g.query_path:C.items[0].path;i([L]),v(B=>B+1)}else i([])},[u,s]),Xu=c.useCallback((g,C)=>{Pt(L=>eE(L,g,C))},[Pt]),Mh=c.useMemo(()=>{var C,L,B,V,ie,ve;const g=[];for(const G of N.filters.and)if("stars"in G){const de=G.stars||[];if(!de.length)continue;g.push({id:"stars",label:`Rating in: ${Fc(de)}`,onRemove:()=>$l()})}else if("starsIn"in G){const de=G.starsIn.values||[];if(!de.length)continue;g.push({id:"stars-in",label:`Rating in: ${Fc(de)}`,onRemove:()=>$l()})}else if("starsNotIn"in G){const de=G.starsNotIn.values||[];if(!de.length)continue;g.push({id:"stars-not-in",label:`Rating not in: ${Fc(de)}`,onRemove:()=>Pt(je=>Ix(je,[]))})}else if("nameContains"in G){const de=(C=G.nameContains.value)==null?void 0:C.trim();if(!de)continue;g.push({id:"name-contains",label:`Filename contains: ${de}`,onRemove:()=>Pt(je=>Fx(je,""))})}else if("nameNotContains"in G){const de=(L=G.nameNotContains.value)==null?void 0:L.trim();if(!de)continue;g.push({id:"name-not-contains",label:`Filename not: ${de}`,onRemove:()=>Pt(je=>Ox(je,""))})}else if("commentsContains"in G){const de=(B=G.commentsContains.value)==null?void 0:B.trim();if(!de)continue;g.push({id:"comments-contains",label:`Comments contain: ${de}`,onRemove:()=>Pt(je=>Ax(je,""))})}else if("commentsNotContains"in G){const de=(V=G.commentsNotContains.value)==null?void 0:V.trim();if(!de)continue;g.push({id:"comments-not-contains",label:`Comments not: ${de}`,onRemove:()=>Pt(je=>Dx(je,""))})}else if("urlContains"in G){const de=(ie=G.urlContains.value)==null?void 0:ie.trim();if(!de)continue;g.push({id:"url-contains",label:`URL contains: ${de}`,onRemove:()=>Pt(je=>zx(je,""))})}else if("urlNotContains"in G){const de=(ve=G.urlNotContains.value)==null?void 0:ve.trim();if(!de)continue;g.push({id:"url-not-contains",label:`URL not: ${de}`,onRemove:()=>Pt(je=>$x(je,""))})}else if("dateRange"in G){const{from:de,to:je}=G.dateRange;if(!de&&!je)continue;g.push({id:"date-range",label:`Date: ${ik(de,je)}`,onRemove:()=>Pt(Ut=>df(Ut,null))})}else if("widthCompare"in G){const{op:de,value:je}=G.widthCompare;g.push({id:"width-compare",label:`Width ${de} ${je}`,onRemove:()=>Pt(Ut=>Fa(Ut,null))})}else if("heightCompare"in G){const{op:de,value:je}=G.heightCompare;g.push({id:"height-compare",label:`Height ${de} ${je}`,onRemove:()=>Pt(Ut=>Oa(Ut,null))})}else if("metricRange"in G){const{key:de,min:je,max:Ut}=G.metricRange;g.push({id:`metric:${de}`,label:`${de}: ${lk(je,Ut)}`,onRemove:()=>Xu(de,null)})}return g},[N.filters,$l,Xu,Pt]),h0=c.useCallback(g=>{const C=new Set(Xn);C.has(g)?C.delete(g):C.add(g),O(L=>({...L,filters:$c(L.filters,Array.from(C))}))},[Xn]),p0=c.useCallback(()=>{D(!0),Z("metrics")},[]),m0=c.useCallback(g=>{O(C=>({...C,sort:g})),g.kind==="builtin"&&g.key==="random"&&X(Date.now())},[]),Rh=c.useCallback(g=>{if(g==="/"||g==="")return"Lenslet | Root";const C=g.split("/").filter(Boolean);if(!C.length)return"Lenslet";const L=C.slice(-2).join("/");return`Lenslet | ${C.length>2?`.../${L}`:`/${L}`}`},[]),g0=c.useMemo(()=>ok(e),[e]);c.useEffect(()=>{document.title=Rh(e)},[e,Rh]),c.useEffect(()=>{let g=!0;return Se.getViews().then(C=>{g&&ne(C.views||[])}).catch(()=>{g&&ne([])}),()=>{g=!1}},[]),c.useEffect(()=>{Kn&&(i([]),f&&(h(null),Ze.current=!1,ma(e)))},[Kn,f,e]),c.useEffect(()=>{const g=lt.current,C=Un.current;if(!g||!C)return;const L=()=>{const B=Math.max(48,Math.round(C.getBoundingClientRect().height));g.style.setProperty("--toolbar-h",`${B}px`)};if(L(),"ResizeObserver"in window){const B=new ResizeObserver(L);return B.observe(C),()=>B.disconnect()}return window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[]),c.useEffect(()=>{try{const g=localStorage.getItem(qe.sortKey),C=localStorage.getItem(qe.sortDir),L=localStorage.getItem(qe.sortSpec),B=localStorage.getItem(qe.starFilters),V=localStorage.getItem(qe.filterAst),ie=localStorage.getItem(qe.selectedMetric),ve=localStorage.getItem(qe.viewMode),G=localStorage.getItem(qe.gridItemSize),de=localStorage.getItem(qe.leftOpen),je=localStorage.getItem(qe.rightOpen),zh=(Ct=>{if(!Ct)return null;const nt=Ic(Ct);return!nt||typeof nt!="object"?null:nt.kind==="builtin"&&(nt.key==="name"||nt.key==="added"||nt.key==="random")&&(nt.dir==="asc"||nt.dir==="desc")||nt.kind==="metric"&&typeof nt.key=="string"&&nt.key.length>0&&(nt.dir==="asc"||nt.dir==="desc")?nt:null})(L)??{kind:"builtin",key:g==="name"||g==="added"||g==="random"?g:"added",dir:C==="asc"||C==="desc"?C:"desc"};zh.key==="random"&&X(Date.now());let ec=(Ct=>{if(!Ct)return null;const nt=Ic(Ct);return cf(nt)})(V)??{and:[]};if(B){const Ct=Ic(B);if(Array.isArray(Ct)){const nt=Ct.filter(R0=>[0,1,2,3,4,5].includes(R0));ec=$c(ec,nt)}}if(O(Ct=>({...Ct,sort:zh,filters:ec,selectedMetric:ie||Ct.selectedMetric})),(ve==="grid"||ve==="adaptive")&&z(ve),G){const Ct=Number(G);!isNaN(Ct)&&Ct>=80&&Ct<=500&&K(Ct)}(de==="0"||de==="false")&&D(!1),(je==="0"||je==="false")&&te(!1)}catch{}},[]),c.useEffect(()=>{U&&(D(!1),te(!1))},[U]),c.useEffect(()=>{if(typeof window>"u")return;const g=[1,1.25,1.5,1.75,2,3,4],C=V=>g.reduce((ie,ve)=>Math.abs(ve-V)<Math.abs(ie-V)?ve:ie,g[0]),L=()=>{var Ut;const V=window.devicePixelRatio||1,ie=C(V),ve=((Ut=window.visualViewport)==null?void 0:Ut.scale)??1,G=V*ve/ie;if(!Number.isFinite(G)){M(null);return}const de=Math.round(G*100),je=Math.min(500,Math.max(25,de));M(je)};L(),window.addEventListener("resize",L),window.addEventListener("orientationchange",L);const B=window.visualViewport;return B&&B.addEventListener("resize",L),()=>{window.removeEventListener("resize",L),window.removeEventListener("orientationchange",L),B&&B.removeEventListener("resize",L)}},[]),c.useEffect(()=>{try{localStorage.setItem(qe.sortKey,N.sort.kind==="builtin"?N.sort.key:"added"),localStorage.setItem(qe.sortDir,N.sort.dir),localStorage.setItem(qe.sortSpec,JSON.stringify(N.sort));const g=Gm(N.filters);localStorage.setItem(qe.starFilters,JSON.stringify(g)),localStorage.setItem(qe.filterAst,JSON.stringify(N.filters)),N.selectedMetric?localStorage.setItem(qe.selectedMetric,N.selectedMetric):localStorage.removeItem(qe.selectedMetric),localStorage.setItem(qe.viewMode,J),localStorage.setItem(qe.gridItemSize,String(ae)),localStorage.setItem(qe.leftOpen,P?"1":"0"),localStorage.setItem(qe.rightOpen,H?"1":"0")}catch{}},[N,J,ae,P,H]),c.useEffect(()=>{if(typeof window>"u")return;const g=()=>I(window.innerWidth);return g(),window.addEventListener("resize",g),window.addEventListener("orientationchange",g),()=>{window.removeEventListener("resize",g),window.removeEventListener("orientationchange",g)}},[]);const Bl=se<=as.mobileMax;c.useEffect(()=>{Bl||A&&_(!1)},[Bl,A]),c.useEffect(()=>{const g=xt.current;if(!g)return;const C=B=>Math.min(500,Math.max(80,B)),L=B=>{B.ctrlKey&&(f||p||(B.preventDefault(),K(V=>C(V+(B.deltaY<0?20:-20)))))};return g.addEventListener("wheel",L,{passive:!1}),()=>g.removeEventListener("wheel",L)},[f,p]),c.useEffect(()=>{if(f||p)return;const g=xt.current;if(!g)return;const C=G=>Math.min(500,Math.max(80,G));let L=null;const B=G=>{if(G.length<2)return 0;const[de,je]=[G[0],G[1]];return Math.hypot(de.clientX-je.clientX,de.clientY-je.clientY)},V=G=>{if(G.touches.length!==2)return;const de=B(G.touches);de&&(L={dist:de,size:ae})},ie=G=>{if(!L||G.touches.length!==2)return;const de=B(G.touches);if(!de)return;G.preventDefault();const je=C(L.size*(de/L.dist));K(je)},ve=()=>{L=null};return g.addEventListener("touchstart",V,{passive:!0}),g.addEventListener("touchmove",ie,{passive:!1}),g.addEventListener("touchend",ve),g.addEventListener("touchcancel",ve),()=>{g.removeEventListener("touchstart",V),g.removeEventListener("touchmove",ie),g.removeEventListener("touchend",ve),g.removeEventListener("touchcancel",ve)}},[f,p,ae]),c.useEffect(()=>{Mg(ZE(wn,f),"viewer")},[f,wn]),c.useEffect(()=>{p&&Mg(eN(he,ut),"compare")},[p,he,ut]);const Ul=c.useCallback(g=>{h(null),Ze.current=!1;const C=Nt(g);t(C),Xm(C)},[]),qu=c.useCallback(g=>{const C=Hc(s);return C.includes(g)?C:[g]},[s]),v0=c.useCallback((g,C)=>{const L=qu(g);i(L),at({x:C.x,y:C.y,kind:"grid",payload:{paths:L}})},[qu]),y0=c.useCallback((g,C)=>{at({x:C.x,y:C.y,kind:"tree",payload:{path:g}})},[]),Ph=c.useCallback(async()=>{const g=["/"],C=new Set,L=new Set(["/"]);for(;g.length>0&&C.size<aN;){const B=g.shift()??"/",V=Nt(B);if(C.has(V))continue;C.add(V);let ie=null;try{ie=await Se.getFolder(V)}catch{ie=null}if(ie)for(const ve of ie.dirs??[]){const G=Nt(Lx(V,ve.name));L.has(G)||(L.add(G),g.push(G))}}return Array.from(L).sort((B,V)=>B==="/"?-1:V==="/"?1:B.localeCompare(V))},[]);c.useEffect(()=>{if(!Re)return;let g=!1;return St(!0),Ph().then(C=>{g||Oe(C)}).catch(C=>{g||ce(No(C,"Failed to load destination folders."))}).finally(()=>{g||St(!1)}),()=>{g=!0}},[Ph,Re]);const x0=c.useCallback(async(g,C)=>{const L=Hc(g);if(!L.length)return!1;const B=Nt(C||"/");ce(null);const V=[],ie=[];for(const G of L)try{await Se.moveFile(G,B)}catch(de){V.push(`${xh(G)||G}: ${No(de,"Move failed.")}`),ie.push(G)}try{await Pe.invalidateQueries({predicate:({queryKey:G})=>Array.isArray(G)&&G[0]==="folder"}),ys(),await Qn()}catch(G){V.push(No(G,"Move completed, but refresh failed."))}if(V.length)return ce(Pg("Move",V)),i(ie),!1;we(null),at(null);const ve=new Set(L);return i(G=>G.filter(de=>!ve.has(de))),!0},[ys,Pe,Qn]),w0=c.useCallback(g=>{const C=Hc(g);C.length&&(ce(null),we({paths:C}),at(null))},[]),Hl=c.useCallback(async g=>{var B;if(!g.length)return;if(!((((B=Be==null?void 0:Be.dirs)==null?void 0:B.length)??0)===0)){ce("Uploads are only allowed into folders without subdirectories.");return}ye(!0),ce(null);const L=[];try{for(const V of g)try{await Se.uploadFile(e,V)}catch(ie){L.push(`${V.name}: ${No(ie,"Upload failed.")}`)}try{await Qn()}catch(V){L.push(No(V,"Upload completed, but refresh failed."))}}finally{ye(!1)}if(L.length){ce(Pg("Upload",L));return}ce(null)},[e,(Dh=Be==null?void 0:Be.dirs)==null?void 0:Dh.length,Qn]),S0=c.useCallback(()=>{var g;me||(g=qt.current)==null||g.click()},[me]),b0=c.useCallback(async g=>{const C=Array.from(g.target.files??[]);g.target.value="",C.length&&await Hl(C)},[Hl]),C0=c.useCallback(async()=>{const g=window.prompt("Save Smart Folder as:","New Smart Folder");if(!g)return;const C=rk(g,q),L={id:C,name:g,pool:{kind:"folder",path:e},view:JSON.parse(JSON.stringify(N))},B=[...q.filter(V=>V.id!==C),L];ne(B),Ee(C);try{await Se.saveViews({version:1,views:B})}catch(V){if(V instanceof an&&V.status===403){const ie=new Blob([JSON.stringify({version:1,views:B},null,2)],{type:"application/json"});Uo(ie,`lenslet-smart-folder-${C}.json`),alert("No-write mode: exported Smart Folder JSON instead of saving.");return}console.error("Failed to save Smart Folder:",V)}},[e,N,q]);c.useEffect(()=>{if(!fe)return;const g=q.find(B=>B.id===fe);if(!g){Ee(null);return}const C=g.pool.path===e,L=JSON.stringify(g.view)===JSON.stringify(N);(!C||!L)&&Ee(null)},[fe,q,e,N]);const Vl=c.useCallback(g=>{if(!g)return;const C=document.getElementById(`cell-${encodeURIComponent(g)}`);C==null||C.focus()},[]),k0=c.useCallback(g=>{h(g),Ze.current=!0,Xm(g)},[]),Th=c.useCallback(()=>{h(null),Ze.current?(Ze.current=!1,window.history.back()):ma(e),Vl(Dt.current)},[Vl]),E0=c.useCallback(()=>{p||!nn||(s[0]&&(Dt.current=s[0]),E(0),S(!0),f&&(h(null),Ze.current&&(Ze.current=!1),ma(e)),Gt.current||(window.history.pushState({compare:!0},"",window.location.href),Gt.current=!0))},[p,nn,s,f,e]),Gu=c.useCallback(()=>{S(!1),Gt.current&&(Gt.current=!1,window.history.back()),Vl(Dt.current??s[0])},[Vl,s]),N0=c.useCallback(g=>{le.length<2||E(C=>{const L=Math.max(0,le.length-2);return Math.min(L,Math.max(0,C+g))})},[le.length]);c.useEffect(()=>{p&&(nn||Gu())},[p,nn,Gu]),c.useEffect(()=>{const g=()=>{f&&(Ze.current=!1,h(null)),p&&(Gt.current=!1,S(!1))};return window.addEventListener("popstate",g),()=>window.removeEventListener("popstate",g)},[f,p]),c.useEffect(()=>{const g=lt.current;if(!g)return;const C=V=>{V.dataTransfer&&Array.from(V.dataTransfer.types).includes("Files")&&(V.preventDefault(),W(!0))},L=V=>{const ie=V.relatedTarget;ie&&g.contains(ie)||W(!1)},B=async V=>{var ve;V.preventDefault(),W(!1);const ie=Array.from(((ve=V.dataTransfer)==null?void 0:ve.files)??[]);ie.length&&await Hl(ie)};return g.addEventListener("dragover",C),g.addEventListener("dragleave",L),g.addEventListener("drop",B),()=>{g.removeEventListener("dragover",C),g.removeEventListener("dragleave",L),g.removeEventListener("drop",B)}},[Hl]),c.useEffect(()=>{const g=()=>at(null),C=L=>{L.key==="Escape"&&at(null)};return window.addEventListener("click",g),window.addEventListener("keydown",C),()=>{window.removeEventListener("click",g),window.removeEventListener("keydown",C)}},[]),c.useEffect(()=>{const g=C=>{if(!mh(C.target)){if((C.ctrlKey||C.metaKey)&&C.key.toLowerCase()==="b"){C.preventDefault(),C.altKey?te(L=>!L):D(L=>!L);return}if(!(f||p)){if(C.key==="Backspace"||C.key==="Delete")C.preventDefault(),Ul(qm(e));else if((C.ctrlKey||C.metaKey)&&C.key.toLowerCase()==="a")C.preventDefault(),i(Ke.map(L=>L.path));else if(C.key==="Escape"){if(s.length){C.preventDefault(),i([]);return}A&&(C.preventDefault(),_(!1))}else if(C.key==="/"){C.preventDefault();const L=document.querySelector(".toolbar-right .input");L==null||L.focus()}}}};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[e,Ke,s,f,p,Ul,A]);const Lh=c.useMemo(()=>qS({viewportWidth:se,leftOpen:P,rightOpen:H,leftWidth:Zt,rightWidth:mn}),[se,P,H,Zt,mn]),j0=P?`${Lh.leftWidth}px`:"0px",M0=H?`${Lh.rightWidth}px`:"0px",_h=f??s[0]??null,Ju=_h?wn.indexOf(_h):-1,Ih=Ju>0,Fh=Ju>=0&&Ju<wn.length-1,Zu=c.useCallback(g=>{if(!wn.length)return;const C=f??s[0];if(!C)return;const L=wn.indexOf(C);if(L===-1)return;const B=Math.min(wn.length-1,Math.max(0,L+g)),V=wn[B];!V||V===C||(f&&(h(V),ma(V)),i([V]))},[wn,f,s]);return a.jsxs("div",{className:"app-shell grid h-full grid-cols-[var(--left)_1fr_var(--right)]",ref:lt,style:{"--left":j0,"--right":M0},children:[a.jsx(ZS,{rootRef:Un,onSearch:r,viewerActive:!!f,onBack:Th,zoomPercent:f?y:void 0,onZoomPercentChange:g=>x(g),currentLabel:g0,itemCount:a0,totalCount:u0,sortSpec:N.sort,metricKeys:Ir,onSortChange:m0,sortDisabled:$t,filterCount:Al,onOpenFilters:p0,starFilters:Xn,onToggleStar:h0,onClearStars:$l,onClearFilters:jh,starCounts:qx,viewMode:J,onViewMode:z,gridItemSize:ae,onGridItemSize:K,leftOpen:P,rightOpen:H,onToggleLeft:()=>D(g=>!g),onToggleRight:()=>te(g=>!g),onPrevImage:()=>Zu(-1),onNextImage:()=>Zu(1),canPrevImage:Ih,canNextImage:Fh,searchDisabled:$t,searchPlaceholder:$t?"Exit similarity to search":void 0,onUploadClick:S0,uploadBusy:me,uploadDisabled:p,multiSelectMode:A,selectedCount:s.length,onToggleMultiSelectMode:Bl?()=>_(g=>!g):void 0,syncIndicator:{state:i0,presence:zl,syncLabel:Jx,connectionLabel:Zx,lastEditedLabel:e0,hasEdits:Ku,localTypingActive:Gs,recentTouches:l0}}),a.jsx("input",{ref:qt,type:"file",multiple:!0,accept:"image/*",className:"sr-only",onChange:b0}),P&&a.jsx(IE,{leftTool:Y,onToolChange:Z,compareEnabled:nn,compareActive:p,onOpenCompare:E0,views:q,activeViewId:fe,onActivateView:g=>{var L;Ee(g.id);const C=cf((L=g.view)==null?void 0:L.filters)??{and:[]};O({...g.view,filters:C}),Ul(g.pool.path)},onSaveView:C0,current:e,data:Be,onOpenFolder:g=>{Ee(null),Ul(g)},onOpenFolderActions:y0,onPullRefreshFolders:Vu,onContextMenu:(g,C)=>{g.preventDefault(),at({x:g.clientX,y:g.clientY,kind:"tree",payload:{path:C}})},countVersion:xe,items:ri,filteredItems:Ke,metricKeys:Ir,selectedItems:oe,selectedMetric:N.selectedMetric,onSelectMetric:g=>O(C=>({...C,selectedMetric:g})),filters:N.filters,onChangeRange:Xu,onChangeFilters:c0,onResize:ar}),a.jsxs("div",{className:"grid-shell col-start-2 row-start-2 relative overflow-hidden flex flex-col",ref:xt,children:[a.jsx("div",{"aria-live":"polite",className:"sr-only",children:s.length?`${s.length} selected`:""}),a.jsx(FE,{persistenceEnabled:Nl,offViewSummary:o0,canRevealOffView:Qu,onRevealOffView:d0,onClearOffView:Ll,browserZoomPercent:R}),ge&&a.jsx("div",{className:"border-b border-border bg-panel px-3 py-2",children:a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",children:ge})}),u&&a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"font-semibold",children:"Similarity mode"}),a.jsxs("span",{className:"text-muted",children:["Embedding: ",u.embedding]}),Eh&&a.jsxs("span",{className:"text-muted",children:["Query: ",Eh]}),Nh&&a.jsxs("span",{className:"text-muted",children:["Results: ",Nh]}),a.jsxs("span",{className:"text-muted",children:["Top K: ",u.topK]}),u.minScore!=null&&a.jsxs("span",{className:"text-muted",children:["Min score: ",u.minScore]})]}),a.jsx("button",{className:"btn btn-sm",onClick:Yu,children:"Exit similarity"})]})}),Mh.length>0&&a.jsx("div",{className:"sticky top-0 z-10 px-3 py-2 bg-panel border-b border-border",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Filters"}),Mh.map(g=>a.jsxs("span",{className:"filter-chip",children:[a.jsx("span",{className:"truncate max-w-[240px]",title:g.label,children:g.label}),a.jsx("button",{className:"filter-chip-remove","aria-label":`Clear filter ${g.label}`,onClick:g.onRemove,children:""})]},g.id)),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:jh,children:"Clear all"})]})}),!1,a.jsxs("div",{className:"flex-1 min-h-0 relative",children:[a.jsx(cC,{items:Ke,selected:s,restoreToSelectionToken:j,multiSelectMode:Bl&&A,onSelectionChange:i,onOpenViewer:g=>{try{Dt.current=g}catch{}k0(g),i([g])},highlight:Kn?ms:"",recentlyUpdated:Tl,onVisiblePathsChange:qn,suppressSelectionHighlight:!!f||p,viewMode:J,targetCellSize:ae,onContextMenuItem:(g,C)=>{g.preventDefault();const L=qu(C);i(L),at({x:g.clientX,y:g.clientY,kind:"grid",payload:{paths:L}})},onOpenItemActions:v0,scrollRef:fn,hideScrollbar:Hu}),Hu&&Lr&&a.jsx(hC,{items:Ke,metricKey:Lr,scrollRef:fn,sortDir:N.sort.dir})]})]}),H&&a.jsx(xk,{path:s[0]??null,selectedPaths:s,items:Ke,compareActive:p,compareA:Gn,compareB:vs,sortSpec:N.sort,onResize:$,onStarChanged:(g,C)=>{Ie(L=>{const B={...L};for(const V of g)B[V]=C;return B})},onFindSimilar:()=>l(!0),embeddingsAvailable:oo,embeddingsLoading:Rr.isLoading,onLocalTypingChange:Js}),a.jsx(wk,{open:o,embeddings:Ml,rejected:Rl,selectedPath:s[0]??null,embeddingsLoading:Rr.isLoading,embeddingsError:ei,onClose:()=>l(!1),onSearch:f0}),f&&a.jsx(jC,{path:f,onClose:Th,onZoomChange:g=>k(Math.round(g)),requestedZoomPercent:m,onZoomRequestConsumed:()=>x(null),canPrev:Ih,canNext:Fh,onNavigate:Zu}),p&&a.jsx(IC,{aItem:Gn,bItem:vs,index:ut,total:le.length,canPrev:ni,canNext:tt,onNavigate:N0,onClose:Gu}),Re&&a.jsx(tN,{paths:Re.paths,defaultDestination:e,destinations:wt,loadingDestinations:Ne,onClose:()=>we(null),onSubmit:x0}),ee&&a.jsx("div",{className:"toolbar-offset fixed inset-0 left-[var(--left)] right-[var(--right)] bg-accent/10 border-2 border-dashed border-accent text-text flex items-center justify-center text-lg z-overlay pointer-events-none",children:"Drop images to upload"}),gn&&a.jsx(oN,{ctx:gn,current:e,items:Ke,setCtx:at,onRefetch:Qn,onOpenMoveDialog:w0,onRefreshFolder:co})]})}const mN=new jS({defaultOptions:{queries:{staleTime:1e4,gcTime:5*6e4,retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),1e4),refetchOnWindowFocus:!1,refetchOnReconnect:"always"},mutations:{retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),5e3)}}});function gN(){return a.jsx(MS,{client:mN,children:a.jsx(pN,{})})}ex(document.getElementById("root")).render(a.jsx(gN,{}));
