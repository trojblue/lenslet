var G0=Object.defineProperty;var Ah=e=>{throw TypeError(e)};var Y0=(e,t,n)=>t in e?G0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var lt=(e,t,n)=>Y0(e,typeof t!="symbol"?t+"":t,n),Hu=(e,t,n)=>t.has(e)||Ah("Cannot "+n);var k=(e,t,n)=>(Hu(e,t,"read from private field"),n?n.call(e):t.get(e)),ue=(e,t,n)=>t.has(e)?Ah("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Z=(e,t,n,r)=>(Hu(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),xe=(e,t,n)=>(Hu(e,t,"access private method"),n);var vl=(e,t,n,r)=>({set _(s){Z(e,t,s,n)},get _(){return k(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function X0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Og={exports:{}},Za={},Dg={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jo=Symbol.for("react.element"),J0=Symbol.for("react.portal"),Z0=Symbol.for("react.fragment"),ew=Symbol.for("react.strict_mode"),tw=Symbol.for("react.profiler"),nw=Symbol.for("react.provider"),rw=Symbol.for("react.context"),sw=Symbol.for("react.forward_ref"),iw=Symbol.for("react.suspense"),ow=Symbol.for("react.memo"),lw=Symbol.for("react.lazy"),Fh=Symbol.iterator;function aw(e){return e===null||typeof e!="object"?null:(e=Fh&&e[Fh]||e["@@iterator"],typeof e=="function"?e:null)}var zg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$g=Object.assign,Bg={};function Fi(e,t,n){this.props=e,this.context=t,this.refs=Bg,this.updater=n||zg}Fi.prototype.isReactComponent={};Fi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Fi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Ug(){}Ug.prototype=Fi.prototype;function af(e,t,n){this.props=e,this.context=t,this.refs=Bg,this.updater=n||zg}var uf=af.prototype=new Ug;uf.constructor=af;$g(uf,Fi.prototype);uf.isPureReactComponent=!0;var Oh=Array.isArray,Vg=Object.prototype.hasOwnProperty,cf={current:null},Wg={key:!0,ref:!0,__self:!0,__source:!0};function Hg(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Vg.call(t,r)&&!Wg.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Jo,type:e,key:i,ref:o,props:s,_owner:cf.current}}function uw(e,t){return{$$typeof:Jo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function df(e){return typeof e=="object"&&e!==null&&e.$$typeof===Jo}function cw(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Dh=/\/+/g;function Qu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?cw(""+e.key):t.toString(36)}function Yl(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Jo:case J0:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+Qu(o,0):r,Oh(s)?(n="",e!=null&&(n=e.replace(Dh,"$&/")+"/"),Yl(s,t,n,"",function(d){return d})):s!=null&&(df(s)&&(s=uw(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Dh,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",Oh(e))for(var l=0;l<e.length;l++){i=e[l];var c=r+Qu(i,l);o+=Yl(i,t,n,c,s)}else if(c=aw(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=r+Qu(i,l++),o+=Yl(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function xl(e,t,n){if(e==null)return e;var r=[],s=0;return Yl(e,r,"","",function(i){return t.call(n,i,s++)}),r}function dw(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var zt={current:null},Xl={transition:null},fw={ReactCurrentDispatcher:zt,ReactCurrentBatchConfig:Xl,ReactCurrentOwner:cf};function Qg(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:xl,forEach:function(e,t,n){xl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return xl(e,function(){t++}),t},toArray:function(e){return xl(e,function(t){return t})||[]},only:function(e){if(!df(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ke.Component=Fi;ke.Fragment=Z0;ke.Profiler=tw;ke.PureComponent=af;ke.StrictMode=ew;ke.Suspense=iw;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fw;ke.act=Qg;ke.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=$g({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=cf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Vg.call(t,c)&&!Wg.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Jo,type:e.type,key:s,ref:i,props:r,_owner:o}};ke.createContext=function(e){return e={$$typeof:rw,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:nw,_context:e},e.Consumer=e};ke.createElement=Hg;ke.createFactory=function(e){var t=Hg.bind(null,e);return t.type=e,t};ke.createRef=function(){return{current:null}};ke.forwardRef=function(e){return{$$typeof:sw,render:e}};ke.isValidElement=df;ke.lazy=function(e){return{$$typeof:lw,_payload:{_status:-1,_result:e},_init:dw}};ke.memo=function(e,t){return{$$typeof:ow,type:e,compare:t===void 0?null:t}};ke.startTransition=function(e){var t=Xl.transition;Xl.transition={};try{e()}finally{Xl.transition=t}};ke.unstable_act=Qg;ke.useCallback=function(e,t){return zt.current.useCallback(e,t)};ke.useContext=function(e){return zt.current.useContext(e)};ke.useDebugValue=function(){};ke.useDeferredValue=function(e){return zt.current.useDeferredValue(e)};ke.useEffect=function(e,t){return zt.current.useEffect(e,t)};ke.useId=function(){return zt.current.useId()};ke.useImperativeHandle=function(e,t,n){return zt.current.useImperativeHandle(e,t,n)};ke.useInsertionEffect=function(e,t){return zt.current.useInsertionEffect(e,t)};ke.useLayoutEffect=function(e,t){return zt.current.useLayoutEffect(e,t)};ke.useMemo=function(e,t){return zt.current.useMemo(e,t)};ke.useReducer=function(e,t,n){return zt.current.useReducer(e,t,n)};ke.useRef=function(e){return zt.current.useRef(e)};ke.useState=function(e){return zt.current.useState(e)};ke.useSyncExternalStore=function(e,t,n){return zt.current.useSyncExternalStore(e,t,n)};ke.useTransition=function(){return zt.current.useTransition()};ke.version="18.3.1";Dg.exports=ke;var u=Dg.exports;const Jr=X0(u);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hw=u,pw=Symbol.for("react.element"),mw=Symbol.for("react.fragment"),gw=Object.prototype.hasOwnProperty,yw=hw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vw={key:!0,ref:!0,__self:!0,__source:!0};function Kg(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)gw.call(t,r)&&!vw.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:pw,type:e,key:i,ref:o,props:s,_owner:yw.current}}Za.Fragment=mw;Za.jsx=Kg;Za.jsxs=Kg;Og.exports=Za;var a=Og.exports,qg={exports:{}},un={},Gg={exports:{}},Yg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,A){var O=P.length;P.push(A);e:for(;0<O;){var K=O-1>>>1,U=P[K];if(0<s(U,A))P[K]=A,P[O]=U,O=K;else break e}}function n(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var A=P[0],O=P.pop();if(O!==A){P[0]=O;e:for(var K=0,U=P.length,_=U>>>1;K<_;){var G=2*(K+1)-1,V=P[G],J=G+1,se=P[J];if(0>s(V,O))J<U&&0>s(se,V)?(P[K]=se,P[J]=O,K=J):(P[K]=V,P[G]=O,K=G);else if(J<U&&0>s(se,O))P[K]=se,P[J]=O,K=J;else break e}}return A}function s(P,A){var O=P.sortIndex-A.sortIndex;return O!==0?O:P.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],f=1,p=null,h=3,w=!1,x=!1,b=!1,S=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(P){for(var A=n(d);A!==null;){if(A.callback===null)r(d);else if(A.startTime<=P)r(d),A.sortIndex=A.expirationTime,t(c,A);else break;A=n(d)}}function g(P){if(b=!1,v(P),!x)if(n(c)!==null)x=!0,L(C);else{var A=n(d);A!==null&&R(g,A.startTime-P)}}function C(P,A){x=!1,b&&(b=!1,y(M),M=-1),w=!0;var O=h;try{for(v(A),p=n(c);p!==null&&(!(p.expirationTime>A)||P&&!B());){var K=p.callback;if(typeof K=="function"){p.callback=null,h=p.priorityLevel;var U=K(p.expirationTime<=A);A=e.unstable_now(),typeof U=="function"?p.callback=U:p===n(c)&&r(c),v(A)}else r(c);p=n(c)}if(p!==null)var _=!0;else{var G=n(d);G!==null&&R(g,G.startTime-A),_=!1}return _}finally{p=null,h=O,w=!1}}var E=!1,T=null,M=-1,I=5,j=-1;function B(){return!(e.unstable_now()-j<I)}function F(){if(T!==null){var P=e.unstable_now();j=P;var A=!0;try{A=T(!0,P)}finally{A?Q():(E=!1,T=null)}}else E=!1}var Q;if(typeof m=="function")Q=function(){m(F)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,z=ee.port2;ee.port1.onmessage=F,Q=function(){z.postMessage(null)}}else Q=function(){S(F,0)};function L(P){T=P,E||(E=!0,Q())}function R(P,A){M=S(function(){P(e.unstable_now())},A)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){x||w||(x=!0,L(C))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(P){switch(h){case 1:case 2:case 3:var A=3;break;default:A=h}var O=h;h=A;try{return P()}finally{h=O}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,A){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var O=h;h=P;try{return A()}finally{h=O}},e.unstable_scheduleCallback=function(P,A,O){var K=e.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?K+O:K):O=K,P){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=O+U,P={id:f++,callback:A,priorityLevel:P,startTime:O,expirationTime:U,sortIndex:-1},O>K?(P.sortIndex=O,t(d,P),n(c)===null&&P===n(d)&&(b?(y(M),M=-1):b=!0,R(g,O-K))):(P.sortIndex=U,t(c,P),x||w||(x=!0,L(C))),P},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(P){var A=h;return function(){var O=h;h=A;try{return P.apply(this,arguments)}finally{h=O}}}})(Yg);Gg.exports=Yg;var xw=Gg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ww=u,an=xw;function W(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Xg=new Set,No={};function _s(e,t){ji(e,t),ji(e+"Capture",t)}function ji(e,t){for(No[e]=t,e=0;e<t.length;e++)Xg.add(t[e])}var mr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_c=Object.prototype.hasOwnProperty,bw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zh={},$h={};function Sw(e){return _c.call($h,e)?!0:_c.call(zh,e)?!1:bw.test(e)?$h[e]=!0:(zh[e]=!0,!1)}function Cw(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function kw(e,t,n,r){if(t===null||typeof t>"u"||Cw(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function $t(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){bt[e]=new $t(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];bt[t]=new $t(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){bt[e]=new $t(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){bt[e]=new $t(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){bt[e]=new $t(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){bt[e]=new $t(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){bt[e]=new $t(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){bt[e]=new $t(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){bt[e]=new $t(e,5,!1,e.toLowerCase(),null,!1,!1)});var ff=/[\-:]([a-z])/g;function hf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ff,hf);bt[t]=new $t(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ff,hf);bt[t]=new $t(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ff,hf);bt[t]=new $t(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){bt[e]=new $t(e,1,!1,e.toLowerCase(),null,!1,!1)});bt.xlinkHref=new $t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){bt[e]=new $t(e,1,!1,e.toLowerCase(),null,!0,!0)});function pf(e,t,n,r){var s=bt.hasOwnProperty(t)?bt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(kw(t,n,s,r)&&(n=null),r||s===null?Sw(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var xr=ww.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,wl=Symbol.for("react.element"),Gs=Symbol.for("react.portal"),Ys=Symbol.for("react.fragment"),mf=Symbol.for("react.strict_mode"),Ac=Symbol.for("react.profiler"),Jg=Symbol.for("react.provider"),Zg=Symbol.for("react.context"),gf=Symbol.for("react.forward_ref"),Fc=Symbol.for("react.suspense"),Oc=Symbol.for("react.suspense_list"),yf=Symbol.for("react.memo"),Nr=Symbol.for("react.lazy"),ey=Symbol.for("react.offscreen"),Bh=Symbol.iterator;function qi(e){return e===null||typeof e!="object"?null:(e=Bh&&e[Bh]||e["@@iterator"],typeof e=="function"?e:null)}var qe=Object.assign,Ku;function lo(e){if(Ku===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ku=t&&t[1]||""}return`
`+Ku+e}var qu=!1;function Gu(e,t){if(!e||qu)return"";qu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{qu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?lo(e):""}function Ew(e){switch(e.tag){case 5:return lo(e.type);case 16:return lo("Lazy");case 13:return lo("Suspense");case 19:return lo("SuspenseList");case 0:case 2:case 15:return e=Gu(e.type,!1),e;case 11:return e=Gu(e.type.render,!1),e;case 1:return e=Gu(e.type,!0),e;default:return""}}function Dc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ys:return"Fragment";case Gs:return"Portal";case Ac:return"Profiler";case mf:return"StrictMode";case Fc:return"Suspense";case Oc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Zg:return(e.displayName||"Context")+".Consumer";case Jg:return(e._context.displayName||"Context")+".Provider";case gf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case yf:return t=e.displayName||null,t!==null?t:Dc(e.type)||"Memo";case Nr:t=e._payload,e=e._init;try{return Dc(e(t))}catch{}}return null}function Nw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dc(t);case 8:return t===mf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Zr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ty(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Mw(e){var t=ty(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function bl(e){e._valueTracker||(e._valueTracker=Mw(e))}function ny(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ty(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ga(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function zc(e,t){var n=t.checked;return qe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Uh(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Zr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function ry(e,t){t=t.checked,t!=null&&pf(e,"checked",t,!1)}function $c(e,t){ry(e,t);var n=Zr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Bc(e,t.type,n):t.hasOwnProperty("defaultValue")&&Bc(e,t.type,Zr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Vh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Bc(e,t,n){(t!=="number"||ga(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ao=Array.isArray;function li(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Zr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Uc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(W(91));return qe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Wh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(W(92));if(ao(n)){if(1<n.length)throw Error(W(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Zr(n)}}function sy(e,t){var n=Zr(t.value),r=Zr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Hh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function iy(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?iy(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Sl,oy=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Sl=Sl||document.createElement("div"),Sl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Sl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Mo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var po={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jw=["Webkit","ms","Moz","O"];Object.keys(po).forEach(function(e){jw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),po[t]=po[e]})});function ly(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||po.hasOwnProperty(e)&&po[e]?(""+t).trim():t+"px"}function ay(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ly(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var Rw=qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wc(e,t){if(t){if(Rw[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(W(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(W(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(W(61))}if(t.style!=null&&typeof t.style!="object")throw Error(W(62))}}function Hc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qc=null;function vf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Kc=null,ai=null,ui=null;function Qh(e){if(e=tl(e)){if(typeof Kc!="function")throw Error(W(280));var t=e.stateNode;t&&(t=su(t),Kc(e.stateNode,e.type,t))}}function uy(e){ai?ui?ui.push(e):ui=[e]:ai=e}function cy(){if(ai){var e=ai,t=ui;if(ui=ai=null,Qh(e),t)for(e=0;e<t.length;e++)Qh(t[e])}}function dy(e,t){return e(t)}function fy(){}var Yu=!1;function hy(e,t,n){if(Yu)return e(t,n);Yu=!0;try{return dy(e,t,n)}finally{Yu=!1,(ai!==null||ui!==null)&&(fy(),cy())}}function jo(e,t){var n=e.stateNode;if(n===null)return null;var r=su(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(W(231,t,typeof n));return n}var qc=!1;if(mr)try{var Gi={};Object.defineProperty(Gi,"passive",{get:function(){qc=!0}}),window.addEventListener("test",Gi,Gi),window.removeEventListener("test",Gi,Gi)}catch{qc=!1}function Pw(e,t,n,r,s,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(f){this.onError(f)}}var mo=!1,ya=null,va=!1,Gc=null,Tw={onError:function(e){mo=!0,ya=e}};function Iw(e,t,n,r,s,i,o,l,c){mo=!1,ya=null,Pw.apply(Tw,arguments)}function Lw(e,t,n,r,s,i,o,l,c){if(Iw.apply(this,arguments),mo){if(mo){var d=ya;mo=!1,ya=null}else throw Error(W(198));va||(va=!0,Gc=d)}}function As(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function py(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Kh(e){if(As(e)!==e)throw Error(W(188))}function _w(e){var t=e.alternate;if(!t){if(t=As(e),t===null)throw Error(W(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Kh(s),e;if(i===r)return Kh(s),t;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?e:t}function my(e){return e=_w(e),e!==null?gy(e):null}function gy(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=gy(e);if(t!==null)return t;e=e.sibling}return null}var yy=an.unstable_scheduleCallback,qh=an.unstable_cancelCallback,Aw=an.unstable_shouldYield,Fw=an.unstable_requestPaint,nt=an.unstable_now,Ow=an.unstable_getCurrentPriorityLevel,xf=an.unstable_ImmediatePriority,vy=an.unstable_UserBlockingPriority,xa=an.unstable_NormalPriority,Dw=an.unstable_LowPriority,xy=an.unstable_IdlePriority,eu=null,Yn=null;function zw(e){if(Yn&&typeof Yn.onCommitFiberRoot=="function")try{Yn.onCommitFiberRoot(eu,e,void 0,(e.current.flags&128)===128)}catch{}}var _n=Math.clz32?Math.clz32:Uw,$w=Math.log,Bw=Math.LN2;function Uw(e){return e>>>=0,e===0?32:31-($w(e)/Bw|0)|0}var Cl=64,kl=4194304;function uo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function wa(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=uo(l):(i&=o,i!==0&&(r=uo(i)))}else o=n&~s,o!==0?r=uo(o):i!==0&&(r=uo(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-_n(t),s=1<<n,r|=e[n],t&=~s;return r}function Vw(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ww(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-_n(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=Vw(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Yc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function wy(){var e=Cl;return Cl<<=1,!(Cl&4194240)&&(Cl=64),e}function Xu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Zo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-_n(t),e[t]=n}function Hw(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-_n(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function wf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-_n(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Ae=0;function by(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Sy,bf,Cy,ky,Ey,Xc=!1,El=[],Br=null,Ur=null,Vr=null,Ro=new Map,Po=new Map,jr=[],Qw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gh(e,t){switch(e){case"focusin":case"focusout":Br=null;break;case"dragenter":case"dragleave":Ur=null;break;case"mouseover":case"mouseout":Vr=null;break;case"pointerover":case"pointerout":Ro.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Po.delete(t.pointerId)}}function Yi(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=tl(t),t!==null&&bf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Kw(e,t,n,r,s){switch(t){case"focusin":return Br=Yi(Br,e,t,n,r,s),!0;case"dragenter":return Ur=Yi(Ur,e,t,n,r,s),!0;case"mouseover":return Vr=Yi(Vr,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return Ro.set(i,Yi(Ro.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Po.set(i,Yi(Po.get(i)||null,e,t,n,r,s)),!0}return!1}function Ny(e){var t=as(e.target);if(t!==null){var n=As(t);if(n!==null){if(t=n.tag,t===13){if(t=py(n),t!==null){e.blockedOn=t,Ey(e.priority,function(){Cy(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Jl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Qc=r,n.target.dispatchEvent(r),Qc=null}else return t=tl(n),t!==null&&bf(t),e.blockedOn=n,!1;t.shift()}return!0}function Yh(e,t,n){Jl(e)&&n.delete(t)}function qw(){Xc=!1,Br!==null&&Jl(Br)&&(Br=null),Ur!==null&&Jl(Ur)&&(Ur=null),Vr!==null&&Jl(Vr)&&(Vr=null),Ro.forEach(Yh),Po.forEach(Yh)}function Xi(e,t){e.blockedOn===t&&(e.blockedOn=null,Xc||(Xc=!0,an.unstable_scheduleCallback(an.unstable_NormalPriority,qw)))}function To(e){function t(s){return Xi(s,e)}if(0<El.length){Xi(El[0],e);for(var n=1;n<El.length;n++){var r=El[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Br!==null&&Xi(Br,e),Ur!==null&&Xi(Ur,e),Vr!==null&&Xi(Vr,e),Ro.forEach(t),Po.forEach(t),n=0;n<jr.length;n++)r=jr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<jr.length&&(n=jr[0],n.blockedOn===null);)Ny(n),n.blockedOn===null&&jr.shift()}var ci=xr.ReactCurrentBatchConfig,ba=!0;function Gw(e,t,n,r){var s=Ae,i=ci.transition;ci.transition=null;try{Ae=1,Sf(e,t,n,r)}finally{Ae=s,ci.transition=i}}function Yw(e,t,n,r){var s=Ae,i=ci.transition;ci.transition=null;try{Ae=4,Sf(e,t,n,r)}finally{Ae=s,ci.transition=i}}function Sf(e,t,n,r){if(ba){var s=Jc(e,t,n,r);if(s===null)lc(e,t,r,Sa,n),Gh(e,r);else if(Kw(s,e,t,n,r))r.stopPropagation();else if(Gh(e,r),t&4&&-1<Qw.indexOf(e)){for(;s!==null;){var i=tl(s);if(i!==null&&Sy(i),i=Jc(e,t,n,r),i===null&&lc(e,t,r,Sa,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else lc(e,t,r,null,n)}}var Sa=null;function Jc(e,t,n,r){if(Sa=null,e=vf(r),e=as(e),e!==null)if(t=As(e),t===null)e=null;else if(n=t.tag,n===13){if(e=py(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Sa=e,null}function My(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ow()){case xf:return 1;case vy:return 4;case xa:case Dw:return 16;case xy:return 536870912;default:return 16}default:return 16}}var zr=null,Cf=null,Zl=null;function jy(){if(Zl)return Zl;var e,t=Cf,n=t.length,r,s="value"in zr?zr.value:zr.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return Zl=s.slice(e,1<r?1-r:void 0)}function ea(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Nl(){return!0}function Xh(){return!1}function cn(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Nl:Xh,this.isPropagationStopped=Xh,this}return qe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Nl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Nl)},persist:function(){},isPersistent:Nl}),t}var Oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kf=cn(Oi),el=qe({},Oi,{view:0,detail:0}),Xw=cn(el),Ju,Zu,Ji,tu=qe({},el,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ef,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ji&&(Ji&&e.type==="mousemove"?(Ju=e.screenX-Ji.screenX,Zu=e.screenY-Ji.screenY):Zu=Ju=0,Ji=e),Ju)},movementY:function(e){return"movementY"in e?e.movementY:Zu}}),Jh=cn(tu),Jw=qe({},tu,{dataTransfer:0}),Zw=cn(Jw),e1=qe({},el,{relatedTarget:0}),ec=cn(e1),t1=qe({},Oi,{animationName:0,elapsedTime:0,pseudoElement:0}),n1=cn(t1),r1=qe({},Oi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),s1=cn(r1),i1=qe({},Oi,{data:0}),Zh=cn(i1),o1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},l1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},a1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function u1(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=a1[e])?!!t[e]:!1}function Ef(){return u1}var c1=qe({},el,{key:function(e){if(e.key){var t=o1[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ea(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?l1[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ef,charCode:function(e){return e.type==="keypress"?ea(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ea(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),d1=cn(c1),f1=qe({},tu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ep=cn(f1),h1=qe({},el,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ef}),p1=cn(h1),m1=qe({},Oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),g1=cn(m1),y1=qe({},tu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),v1=cn(y1),x1=[9,13,27,32],Nf=mr&&"CompositionEvent"in window,go=null;mr&&"documentMode"in document&&(go=document.documentMode);var w1=mr&&"TextEvent"in window&&!go,Ry=mr&&(!Nf||go&&8<go&&11>=go),tp=" ",np=!1;function Py(e,t){switch(e){case"keyup":return x1.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ty(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Xs=!1;function b1(e,t){switch(e){case"compositionend":return Ty(t);case"keypress":return t.which!==32?null:(np=!0,tp);case"textInput":return e=t.data,e===tp&&np?null:e;default:return null}}function S1(e,t){if(Xs)return e==="compositionend"||!Nf&&Py(e,t)?(e=jy(),Zl=Cf=zr=null,Xs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ry&&t.locale!=="ko"?null:t.data;default:return null}}var C1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!C1[e.type]:t==="textarea"}function Iy(e,t,n,r){uy(r),t=Ca(t,"onChange"),0<t.length&&(n=new kf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var yo=null,Io=null;function k1(e){Vy(e,0)}function nu(e){var t=ei(e);if(ny(t))return e}function E1(e,t){if(e==="change")return t}var Ly=!1;if(mr){var tc;if(mr){var nc="oninput"in document;if(!nc){var sp=document.createElement("div");sp.setAttribute("oninput","return;"),nc=typeof sp.oninput=="function"}tc=nc}else tc=!1;Ly=tc&&(!document.documentMode||9<document.documentMode)}function ip(){yo&&(yo.detachEvent("onpropertychange",_y),Io=yo=null)}function _y(e){if(e.propertyName==="value"&&nu(Io)){var t=[];Iy(t,Io,e,vf(e)),hy(k1,t)}}function N1(e,t,n){e==="focusin"?(ip(),yo=t,Io=n,yo.attachEvent("onpropertychange",_y)):e==="focusout"&&ip()}function M1(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return nu(Io)}function j1(e,t){if(e==="click")return nu(t)}function R1(e,t){if(e==="input"||e==="change")return nu(t)}function P1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var On=typeof Object.is=="function"?Object.is:P1;function Lo(e,t){if(On(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!_c.call(t,s)||!On(e[s],t[s]))return!1}return!0}function op(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lp(e,t){var n=op(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=op(n)}}function Ay(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ay(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Fy(){for(var e=window,t=ga();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ga(e.document)}return t}function Mf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function T1(e){var t=Fy(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Ay(n.ownerDocument.documentElement,n)){if(r!==null&&Mf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=lp(n,i);var o=lp(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var I1=mr&&"documentMode"in document&&11>=document.documentMode,Js=null,Zc=null,vo=null,ed=!1;function ap(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ed||Js==null||Js!==ga(r)||(r=Js,"selectionStart"in r&&Mf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),vo&&Lo(vo,r)||(vo=r,r=Ca(Zc,"onSelect"),0<r.length&&(t=new kf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Js)))}function Ml(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Zs={animationend:Ml("Animation","AnimationEnd"),animationiteration:Ml("Animation","AnimationIteration"),animationstart:Ml("Animation","AnimationStart"),transitionend:Ml("Transition","TransitionEnd")},rc={},Oy={};mr&&(Oy=document.createElement("div").style,"AnimationEvent"in window||(delete Zs.animationend.animation,delete Zs.animationiteration.animation,delete Zs.animationstart.animation),"TransitionEvent"in window||delete Zs.transitionend.transition);function ru(e){if(rc[e])return rc[e];if(!Zs[e])return e;var t=Zs[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Oy)return rc[e]=t[n];return e}var Dy=ru("animationend"),zy=ru("animationiteration"),$y=ru("animationstart"),By=ru("transitionend"),Uy=new Map,up="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ts(e,t){Uy.set(e,t),_s(t,[e])}for(var sc=0;sc<up.length;sc++){var ic=up[sc],L1=ic.toLowerCase(),_1=ic[0].toUpperCase()+ic.slice(1);ts(L1,"on"+_1)}ts(Dy,"onAnimationEnd");ts(zy,"onAnimationIteration");ts($y,"onAnimationStart");ts("dblclick","onDoubleClick");ts("focusin","onFocus");ts("focusout","onBlur");ts(By,"onTransitionEnd");ji("onMouseEnter",["mouseout","mouseover"]);ji("onMouseLeave",["mouseout","mouseover"]);ji("onPointerEnter",["pointerout","pointerover"]);ji("onPointerLeave",["pointerout","pointerover"]);_s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_s("onBeforeInput",["compositionend","keypress","textInput","paste"]);_s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var co="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),A1=new Set("cancel close invalid load scroll toggle".split(" ").concat(co));function cp(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Lw(r,t,void 0,e),e.currentTarget=null}function Vy(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;cp(s,l,d),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;cp(s,l,d),i=c}}}if(va)throw e=Gc,va=!1,Gc=null,e}function $e(e,t){var n=t[id];n===void 0&&(n=t[id]=new Set);var r=e+"__bubble";n.has(r)||(Wy(t,e,2,!1),n.add(r))}function oc(e,t,n){var r=0;t&&(r|=4),Wy(n,e,r,t)}var jl="_reactListening"+Math.random().toString(36).slice(2);function _o(e){if(!e[jl]){e[jl]=!0,Xg.forEach(function(n){n!=="selectionchange"&&(A1.has(n)||oc(n,!1,e),oc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[jl]||(t[jl]=!0,oc("selectionchange",!1,t))}}function Wy(e,t,n,r){switch(My(t)){case 1:var s=Gw;break;case 4:s=Yw;break;default:s=Sf}n=s.bind(null,t,n,e),s=void 0,!qc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function lc(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=as(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}hy(function(){var d=i,f=vf(n),p=[];e:{var h=Uy.get(e);if(h!==void 0){var w=kf,x=e;switch(e){case"keypress":if(ea(n)===0)break e;case"keydown":case"keyup":w=d1;break;case"focusin":x="focus",w=ec;break;case"focusout":x="blur",w=ec;break;case"beforeblur":case"afterblur":w=ec;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Jh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=Zw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=p1;break;case Dy:case zy:case $y:w=n1;break;case By:w=g1;break;case"scroll":w=Xw;break;case"wheel":w=v1;break;case"copy":case"cut":case"paste":w=s1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=ep}var b=(t&4)!==0,S=!b&&e==="scroll",y=b?h!==null?h+"Capture":null:h;b=[];for(var m=d,v;m!==null;){v=m;var g=v.stateNode;if(v.tag===5&&g!==null&&(v=g,y!==null&&(g=jo(m,y),g!=null&&b.push(Ao(m,g,v)))),S)break;m=m.return}0<b.length&&(h=new w(h,x,null,n,f),p.push({event:h,listeners:b}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",h&&n!==Qc&&(x=n.relatedTarget||n.fromElement)&&(as(x)||x[gr]))break e;if((w||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,w?(x=n.relatedTarget||n.toElement,w=d,x=x?as(x):null,x!==null&&(S=As(x),x!==S||x.tag!==5&&x.tag!==6)&&(x=null)):(w=null,x=d),w!==x)){if(b=Jh,g="onMouseLeave",y="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(b=ep,g="onPointerLeave",y="onPointerEnter",m="pointer"),S=w==null?h:ei(w),v=x==null?h:ei(x),h=new b(g,m+"leave",w,n,f),h.target=S,h.relatedTarget=v,g=null,as(f)===d&&(b=new b(y,m+"enter",x,n,f),b.target=v,b.relatedTarget=S,g=b),S=g,w&&x)t:{for(b=w,y=x,m=0,v=b;v;v=Vs(v))m++;for(v=0,g=y;g;g=Vs(g))v++;for(;0<m-v;)b=Vs(b),m--;for(;0<v-m;)y=Vs(y),v--;for(;m--;){if(b===y||y!==null&&b===y.alternate)break t;b=Vs(b),y=Vs(y)}b=null}else b=null;w!==null&&dp(p,h,w,b,!1),x!==null&&S!==null&&dp(p,S,x,b,!0)}}e:{if(h=d?ei(d):window,w=h.nodeName&&h.nodeName.toLowerCase(),w==="select"||w==="input"&&h.type==="file")var C=E1;else if(rp(h))if(Ly)C=R1;else{C=M1;var E=N1}else(w=h.nodeName)&&w.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=j1);if(C&&(C=C(e,d))){Iy(p,C,n,f);break e}E&&E(e,h,d),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&Bc(h,"number",h.value)}switch(E=d?ei(d):window,e){case"focusin":(rp(E)||E.contentEditable==="true")&&(Js=E,Zc=d,vo=null);break;case"focusout":vo=Zc=Js=null;break;case"mousedown":ed=!0;break;case"contextmenu":case"mouseup":case"dragend":ed=!1,ap(p,n,f);break;case"selectionchange":if(I1)break;case"keydown":case"keyup":ap(p,n,f)}var T;if(Nf)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Xs?Py(e,n)&&(M="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(Ry&&n.locale!=="ko"&&(Xs||M!=="onCompositionStart"?M==="onCompositionEnd"&&Xs&&(T=jy()):(zr=f,Cf="value"in zr?zr.value:zr.textContent,Xs=!0)),E=Ca(d,M),0<E.length&&(M=new Zh(M,e,null,n,f),p.push({event:M,listeners:E}),T?M.data=T:(T=Ty(n),T!==null&&(M.data=T)))),(T=w1?b1(e,n):S1(e,n))&&(d=Ca(d,"onBeforeInput"),0<d.length&&(f=new Zh("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=T))}Vy(p,t)})}function Ao(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ca(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=jo(e,n),i!=null&&r.unshift(Ao(e,i,s)),i=jo(e,t),i!=null&&r.push(Ao(e,i,s))),e=e.return}return r}function Vs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function dp(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,s?(c=jo(n,i),c!=null&&o.unshift(Ao(n,c,l))):s||(c=jo(n,i),c!=null&&o.push(Ao(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var F1=/\r\n?/g,O1=/\u0000|\uFFFD/g;function fp(e){return(typeof e=="string"?e:""+e).replace(F1,`
`).replace(O1,"")}function Rl(e,t,n){if(t=fp(t),fp(e)!==t&&n)throw Error(W(425))}function ka(){}var td=null,nd=null;function rd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var sd=typeof setTimeout=="function"?setTimeout:void 0,D1=typeof clearTimeout=="function"?clearTimeout:void 0,hp=typeof Promise=="function"?Promise:void 0,z1=typeof queueMicrotask=="function"?queueMicrotask:typeof hp<"u"?function(e){return hp.resolve(null).then(e).catch($1)}:sd;function $1(e){setTimeout(function(){throw e})}function ac(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),To(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);To(t)}function Wr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function pp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Di=Math.random().toString(36).slice(2),Gn="__reactFiber$"+Di,Fo="__reactProps$"+Di,gr="__reactContainer$"+Di,id="__reactEvents$"+Di,B1="__reactListeners$"+Di,U1="__reactHandles$"+Di;function as(e){var t=e[Gn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[gr]||n[Gn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=pp(e);e!==null;){if(n=e[Gn])return n;e=pp(e)}return t}e=n,n=e.parentNode}return null}function tl(e){return e=e[Gn]||e[gr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ei(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(W(33))}function su(e){return e[Fo]||null}var od=[],ti=-1;function ns(e){return{current:e}}function Be(e){0>ti||(e.current=od[ti],od[ti]=null,ti--)}function De(e,t){ti++,od[ti]=e.current,e.current=t}var es={},Pt=ns(es),Jt=ns(!1),Ms=es;function Ri(e,t){var n=e.type.contextTypes;if(!n)return es;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Zt(e){return e=e.childContextTypes,e!=null}function Ea(){Be(Jt),Be(Pt)}function mp(e,t,n){if(Pt.current!==es)throw Error(W(168));De(Pt,t),De(Jt,n)}function Hy(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(W(108,Nw(e)||"Unknown",s));return qe({},n,r)}function Na(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||es,Ms=Pt.current,De(Pt,e),De(Jt,Jt.current),!0}function gp(e,t,n){var r=e.stateNode;if(!r)throw Error(W(169));n?(e=Hy(e,t,Ms),r.__reactInternalMemoizedMergedChildContext=e,Be(Jt),Be(Pt),De(Pt,e)):Be(Jt),De(Jt,n)}var ir=null,iu=!1,uc=!1;function Qy(e){ir===null?ir=[e]:ir.push(e)}function V1(e){iu=!0,Qy(e)}function rs(){if(!uc&&ir!==null){uc=!0;var e=0,t=Ae;try{var n=ir;for(Ae=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}ir=null,iu=!1}catch(s){throw ir!==null&&(ir=ir.slice(e+1)),yy(xf,rs),s}finally{Ae=t,uc=!1}}return null}var ni=[],ri=0,Ma=null,ja=0,gn=[],yn=0,js=null,cr=1,dr="";function is(e,t){ni[ri++]=ja,ni[ri++]=Ma,Ma=e,ja=t}function Ky(e,t,n){gn[yn++]=cr,gn[yn++]=dr,gn[yn++]=js,js=e;var r=cr;e=dr;var s=32-_n(r)-1;r&=~(1<<s),n+=1;var i=32-_n(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,cr=1<<32-_n(t)+s|n<<s|r,dr=i+e}else cr=1<<i|n<<s|r,dr=e}function jf(e){e.return!==null&&(is(e,1),Ky(e,1,0))}function Rf(e){for(;e===Ma;)Ma=ni[--ri],ni[ri]=null,ja=ni[--ri],ni[ri]=null;for(;e===js;)js=gn[--yn],gn[yn]=null,dr=gn[--yn],gn[yn]=null,cr=gn[--yn],gn[yn]=null}var on=null,sn=null,We=!1,Ln=null;function qy(e,t){var n=xn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function yp(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,on=e,sn=Wr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,on=e,sn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=js!==null?{id:cr,overflow:dr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=xn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,on=e,sn=null,!0):!1;default:return!1}}function ld(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ad(e){if(We){var t=sn;if(t){var n=t;if(!yp(e,t)){if(ld(e))throw Error(W(418));t=Wr(n.nextSibling);var r=on;t&&yp(e,t)?qy(r,n):(e.flags=e.flags&-4097|2,We=!1,on=e)}}else{if(ld(e))throw Error(W(418));e.flags=e.flags&-4097|2,We=!1,on=e}}}function vp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;on=e}function Pl(e){if(e!==on)return!1;if(!We)return vp(e),We=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!rd(e.type,e.memoizedProps)),t&&(t=sn)){if(ld(e))throw Gy(),Error(W(418));for(;t;)qy(e,t),t=Wr(t.nextSibling)}if(vp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(W(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){sn=Wr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}sn=null}}else sn=on?Wr(e.stateNode.nextSibling):null;return!0}function Gy(){for(var e=sn;e;)e=Wr(e.nextSibling)}function Pi(){sn=on=null,We=!1}function Pf(e){Ln===null?Ln=[e]:Ln.push(e)}var W1=xr.ReactCurrentBatchConfig;function Zi(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,e))}return e}function Tl(e,t){throw e=Object.prototype.toString.call(t),Error(W(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function xp(e){var t=e._init;return t(e._payload)}function Yy(e){function t(y,m){if(e){var v=y.deletions;v===null?(y.deletions=[m],y.flags|=16):v.push(m)}}function n(y,m){if(!e)return null;for(;m!==null;)t(y,m),m=m.sibling;return null}function r(y,m){for(y=new Map;m!==null;)m.key!==null?y.set(m.key,m):y.set(m.index,m),m=m.sibling;return y}function s(y,m){return y=qr(y,m),y.index=0,y.sibling=null,y}function i(y,m,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<m?(y.flags|=2,m):v):(y.flags|=2,m)):(y.flags|=1048576,m)}function o(y){return e&&y.alternate===null&&(y.flags|=2),y}function l(y,m,v,g){return m===null||m.tag!==6?(m=gc(v,y.mode,g),m.return=y,m):(m=s(m,v),m.return=y,m)}function c(y,m,v,g){var C=v.type;return C===Ys?f(y,m,v.props.children,g,v.key):m!==null&&(m.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Nr&&xp(C)===m.type)?(g=s(m,v.props),g.ref=Zi(y,m,v),g.return=y,g):(g=la(v.type,v.key,v.props,null,y.mode,g),g.ref=Zi(y,m,v),g.return=y,g)}function d(y,m,v,g){return m===null||m.tag!==4||m.stateNode.containerInfo!==v.containerInfo||m.stateNode.implementation!==v.implementation?(m=yc(v,y.mode,g),m.return=y,m):(m=s(m,v.children||[]),m.return=y,m)}function f(y,m,v,g,C){return m===null||m.tag!==7?(m=Ns(v,y.mode,g,C),m.return=y,m):(m=s(m,v),m.return=y,m)}function p(y,m,v){if(typeof m=="string"&&m!==""||typeof m=="number")return m=gc(""+m,y.mode,v),m.return=y,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case wl:return v=la(m.type,m.key,m.props,null,y.mode,v),v.ref=Zi(y,null,m),v.return=y,v;case Gs:return m=yc(m,y.mode,v),m.return=y,m;case Nr:var g=m._init;return p(y,g(m._payload),v)}if(ao(m)||qi(m))return m=Ns(m,y.mode,v,null),m.return=y,m;Tl(y,m)}return null}function h(y,m,v,g){var C=m!==null?m.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return C!==null?null:l(y,m,""+v,g);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case wl:return v.key===C?c(y,m,v,g):null;case Gs:return v.key===C?d(y,m,v,g):null;case Nr:return C=v._init,h(y,m,C(v._payload),g)}if(ao(v)||qi(v))return C!==null?null:f(y,m,v,g,null);Tl(y,v)}return null}function w(y,m,v,g,C){if(typeof g=="string"&&g!==""||typeof g=="number")return y=y.get(v)||null,l(m,y,""+g,C);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case wl:return y=y.get(g.key===null?v:g.key)||null,c(m,y,g,C);case Gs:return y=y.get(g.key===null?v:g.key)||null,d(m,y,g,C);case Nr:var E=g._init;return w(y,m,v,E(g._payload),C)}if(ao(g)||qi(g))return y=y.get(v)||null,f(m,y,g,C,null);Tl(m,g)}return null}function x(y,m,v,g){for(var C=null,E=null,T=m,M=m=0,I=null;T!==null&&M<v.length;M++){T.index>M?(I=T,T=null):I=T.sibling;var j=h(y,T,v[M],g);if(j===null){T===null&&(T=I);break}e&&T&&j.alternate===null&&t(y,T),m=i(j,m,M),E===null?C=j:E.sibling=j,E=j,T=I}if(M===v.length)return n(y,T),We&&is(y,M),C;if(T===null){for(;M<v.length;M++)T=p(y,v[M],g),T!==null&&(m=i(T,m,M),E===null?C=T:E.sibling=T,E=T);return We&&is(y,M),C}for(T=r(y,T);M<v.length;M++)I=w(T,y,M,v[M],g),I!==null&&(e&&I.alternate!==null&&T.delete(I.key===null?M:I.key),m=i(I,m,M),E===null?C=I:E.sibling=I,E=I);return e&&T.forEach(function(B){return t(y,B)}),We&&is(y,M),C}function b(y,m,v,g){var C=qi(v);if(typeof C!="function")throw Error(W(150));if(v=C.call(v),v==null)throw Error(W(151));for(var E=C=null,T=m,M=m=0,I=null,j=v.next();T!==null&&!j.done;M++,j=v.next()){T.index>M?(I=T,T=null):I=T.sibling;var B=h(y,T,j.value,g);if(B===null){T===null&&(T=I);break}e&&T&&B.alternate===null&&t(y,T),m=i(B,m,M),E===null?C=B:E.sibling=B,E=B,T=I}if(j.done)return n(y,T),We&&is(y,M),C;if(T===null){for(;!j.done;M++,j=v.next())j=p(y,j.value,g),j!==null&&(m=i(j,m,M),E===null?C=j:E.sibling=j,E=j);return We&&is(y,M),C}for(T=r(y,T);!j.done;M++,j=v.next())j=w(T,y,M,j.value,g),j!==null&&(e&&j.alternate!==null&&T.delete(j.key===null?M:j.key),m=i(j,m,M),E===null?C=j:E.sibling=j,E=j);return e&&T.forEach(function(F){return t(y,F)}),We&&is(y,M),C}function S(y,m,v,g){if(typeof v=="object"&&v!==null&&v.type===Ys&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case wl:e:{for(var C=v.key,E=m;E!==null;){if(E.key===C){if(C=v.type,C===Ys){if(E.tag===7){n(y,E.sibling),m=s(E,v.props.children),m.return=y,y=m;break e}}else if(E.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Nr&&xp(C)===E.type){n(y,E.sibling),m=s(E,v.props),m.ref=Zi(y,E,v),m.return=y,y=m;break e}n(y,E);break}else t(y,E);E=E.sibling}v.type===Ys?(m=Ns(v.props.children,y.mode,g,v.key),m.return=y,y=m):(g=la(v.type,v.key,v.props,null,y.mode,g),g.ref=Zi(y,m,v),g.return=y,y=g)}return o(y);case Gs:e:{for(E=v.key;m!==null;){if(m.key===E)if(m.tag===4&&m.stateNode.containerInfo===v.containerInfo&&m.stateNode.implementation===v.implementation){n(y,m.sibling),m=s(m,v.children||[]),m.return=y,y=m;break e}else{n(y,m);break}else t(y,m);m=m.sibling}m=yc(v,y.mode,g),m.return=y,y=m}return o(y);case Nr:return E=v._init,S(y,m,E(v._payload),g)}if(ao(v))return x(y,m,v,g);if(qi(v))return b(y,m,v,g);Tl(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,m!==null&&m.tag===6?(n(y,m.sibling),m=s(m,v),m.return=y,y=m):(n(y,m),m=gc(v,y.mode,g),m.return=y,y=m),o(y)):n(y,m)}return S}var Ti=Yy(!0),Xy=Yy(!1),Ra=ns(null),Pa=null,si=null,Tf=null;function If(){Tf=si=Pa=null}function Lf(e){var t=Ra.current;Be(Ra),e._currentValue=t}function ud(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function di(e,t){Pa=e,Tf=si=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Xt=!0),e.firstContext=null)}function bn(e){var t=e._currentValue;if(Tf!==e)if(e={context:e,memoizedValue:t,next:null},si===null){if(Pa===null)throw Error(W(308));si=e,Pa.dependencies={lanes:0,firstContext:e}}else si=si.next=e;return t}var us=null;function _f(e){us===null?us=[e]:us.push(e)}function Jy(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,_f(t)):(n.next=s.next,s.next=n),t.interleaved=n,yr(e,r)}function yr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Mr=!1;function Af(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zy(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Hr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Pe&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,yr(e,n)}return s=r.interleaved,s===null?(t.next=t,_f(r)):(t.next=s.next,s.next=t),r.interleaved=t,yr(e,n)}function ta(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,wf(e,n)}}function wp(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ta(e,t,n,r){var s=e.updateQueue;Mr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=c))}if(i!==null){var p=s.baseState;o=0,f=d=c=null,l=i;do{var h=l.lane,w=l.eventTime;if((r&h)===h){f!==null&&(f=f.next={eventTime:w,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,b=l;switch(h=t,w=n,b.tag){case 1:if(x=b.payload,typeof x=="function"){p=x.call(w,p,h);break e}p=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=b.payload,h=typeof x=="function"?x.call(w,p,h):x,h==null)break e;p=qe({},p,h);break e;case 2:Mr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else w={eventTime:w,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=w,c=p):f=f.next=w,o|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(f===null&&(c=p),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Ps|=o,e.lanes=o,e.memoizedState=p}}function bp(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var nl={},Xn=ns(nl),Oo=ns(nl),Do=ns(nl);function cs(e){if(e===nl)throw Error(W(174));return e}function Ff(e,t){switch(De(Do,t),De(Oo,e),De(Xn,nl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Vc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Vc(t,e)}Be(Xn),De(Xn,t)}function Ii(){Be(Xn),Be(Oo),Be(Do)}function ev(e){cs(Do.current);var t=cs(Xn.current),n=Vc(t,e.type);t!==n&&(De(Oo,e),De(Xn,n))}function Of(e){Oo.current===e&&(Be(Xn),Be(Oo))}var Qe=ns(0);function Ia(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var cc=[];function Df(){for(var e=0;e<cc.length;e++)cc[e]._workInProgressVersionPrimary=null;cc.length=0}var na=xr.ReactCurrentDispatcher,dc=xr.ReactCurrentBatchConfig,Rs=0,Ke=null,at=null,pt=null,La=!1,xo=!1,zo=0,H1=0;function Nt(){throw Error(W(321))}function zf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!On(e[n],t[n]))return!1;return!0}function $f(e,t,n,r,s,i){if(Rs=i,Ke=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,na.current=e===null||e.memoizedState===null?G1:Y1,e=n(r,s),xo){i=0;do{if(xo=!1,zo=0,25<=i)throw Error(W(301));i+=1,pt=at=null,t.updateQueue=null,na.current=X1,e=n(r,s)}while(xo)}if(na.current=_a,t=at!==null&&at.next!==null,Rs=0,pt=at=Ke=null,La=!1,t)throw Error(W(300));return e}function Bf(){var e=zo!==0;return zo=0,e}function Hn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?Ke.memoizedState=pt=e:pt=pt.next=e,pt}function Sn(){if(at===null){var e=Ke.alternate;e=e!==null?e.memoizedState:null}else e=at.next;var t=pt===null?Ke.memoizedState:pt.next;if(t!==null)pt=t,at=e;else{if(e===null)throw Error(W(310));at=e,e={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},pt===null?Ke.memoizedState=pt=e:pt=pt.next=e}return pt}function $o(e,t){return typeof t=="function"?t(e):t}function fc(e){var t=Sn(),n=t.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=e;var r=at,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,d=i;do{var f=d.lane;if((Rs&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,Ke.lanes|=f,Ps|=f}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=l,On(r,t.memoizedState)||(Xt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Ke.lanes|=i,Ps|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function hc(e){var t=Sn(),n=t.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);On(i,t.memoizedState)||(Xt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function tv(){}function nv(e,t){var n=Ke,r=Sn(),s=t(),i=!On(r.memoizedState,s);if(i&&(r.memoizedState=s,Xt=!0),r=r.queue,Uf(iv.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||pt!==null&&pt.memoizedState.tag&1){if(n.flags|=2048,Bo(9,sv.bind(null,n,r,s,t),void 0,null),mt===null)throw Error(W(349));Rs&30||rv(n,t,s)}return s}function rv(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ke.updateQueue,t===null?(t={lastEffect:null,stores:null},Ke.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function sv(e,t,n,r){t.value=n,t.getSnapshot=r,ov(t)&&lv(e)}function iv(e,t,n){return n(function(){ov(t)&&lv(e)})}function ov(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!On(e,n)}catch{return!0}}function lv(e){var t=yr(e,1);t!==null&&An(t,e,1,-1)}function Sp(e){var t=Hn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$o,lastRenderedState:e},t.queue=e,e=e.dispatch=q1.bind(null,Ke,e),[t.memoizedState,e]}function Bo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ke.updateQueue,t===null?(t={lastEffect:null,stores:null},Ke.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function av(){return Sn().memoizedState}function ra(e,t,n,r){var s=Hn();Ke.flags|=e,s.memoizedState=Bo(1|t,n,void 0,r===void 0?null:r)}function ou(e,t,n,r){var s=Sn();r=r===void 0?null:r;var i=void 0;if(at!==null){var o=at.memoizedState;if(i=o.destroy,r!==null&&zf(r,o.deps)){s.memoizedState=Bo(t,n,i,r);return}}Ke.flags|=e,s.memoizedState=Bo(1|t,n,i,r)}function Cp(e,t){return ra(8390656,8,e,t)}function Uf(e,t){return ou(2048,8,e,t)}function uv(e,t){return ou(4,2,e,t)}function cv(e,t){return ou(4,4,e,t)}function dv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function fv(e,t,n){return n=n!=null?n.concat([e]):null,ou(4,4,dv.bind(null,t,e),n)}function Vf(){}function hv(e,t){var n=Sn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&zf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function pv(e,t){var n=Sn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&zf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function mv(e,t,n){return Rs&21?(On(n,t)||(n=wy(),Ke.lanes|=n,Ps|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Xt=!0),e.memoizedState=n)}function Q1(e,t){var n=Ae;Ae=n!==0&&4>n?n:4,e(!0);var r=dc.transition;dc.transition={};try{e(!1),t()}finally{Ae=n,dc.transition=r}}function gv(){return Sn().memoizedState}function K1(e,t,n){var r=Kr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},yv(e))vv(t,n);else if(n=Jy(e,t,n,r),n!==null){var s=Dt();An(n,e,r,s),xv(n,t,r)}}function q1(e,t,n){var r=Kr(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(yv(e))vv(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,On(l,o)){var c=t.interleaved;c===null?(s.next=s,_f(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Jy(e,t,s,r),n!==null&&(s=Dt(),An(n,e,r,s),xv(n,t,r))}}function yv(e){var t=e.alternate;return e===Ke||t!==null&&t===Ke}function vv(e,t){xo=La=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function xv(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,wf(e,n)}}var _a={readContext:bn,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useInsertionEffect:Nt,useLayoutEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useMutableSource:Nt,useSyncExternalStore:Nt,useId:Nt,unstable_isNewReconciler:!1},G1={readContext:bn,useCallback:function(e,t){return Hn().memoizedState=[e,t===void 0?null:t],e},useContext:bn,useEffect:Cp,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ra(4194308,4,dv.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ra(4194308,4,e,t)},useInsertionEffect:function(e,t){return ra(4,2,e,t)},useMemo:function(e,t){var n=Hn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Hn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=K1.bind(null,Ke,e),[r.memoizedState,e]},useRef:function(e){var t=Hn();return e={current:e},t.memoizedState=e},useState:Sp,useDebugValue:Vf,useDeferredValue:function(e){return Hn().memoizedState=e},useTransition:function(){var e=Sp(!1),t=e[0];return e=Q1.bind(null,e[1]),Hn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ke,s=Hn();if(We){if(n===void 0)throw Error(W(407));n=n()}else{if(n=t(),mt===null)throw Error(W(349));Rs&30||rv(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Cp(iv.bind(null,r,i,e),[e]),r.flags|=2048,Bo(9,sv.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Hn(),t=mt.identifierPrefix;if(We){var n=dr,r=cr;n=(r&~(1<<32-_n(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=zo++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=H1++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Y1={readContext:bn,useCallback:hv,useContext:bn,useEffect:Uf,useImperativeHandle:fv,useInsertionEffect:uv,useLayoutEffect:cv,useMemo:pv,useReducer:fc,useRef:av,useState:function(){return fc($o)},useDebugValue:Vf,useDeferredValue:function(e){var t=Sn();return mv(t,at.memoizedState,e)},useTransition:function(){var e=fc($o)[0],t=Sn().memoizedState;return[e,t]},useMutableSource:tv,useSyncExternalStore:nv,useId:gv,unstable_isNewReconciler:!1},X1={readContext:bn,useCallback:hv,useContext:bn,useEffect:Uf,useImperativeHandle:fv,useInsertionEffect:uv,useLayoutEffect:cv,useMemo:pv,useReducer:hc,useRef:av,useState:function(){return hc($o)},useDebugValue:Vf,useDeferredValue:function(e){var t=Sn();return at===null?t.memoizedState=e:mv(t,at.memoizedState,e)},useTransition:function(){var e=hc($o)[0],t=Sn().memoizedState;return[e,t]},useMutableSource:tv,useSyncExternalStore:nv,useId:gv,unstable_isNewReconciler:!1};function jn(e,t){if(e&&e.defaultProps){t=qe({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function cd(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:qe({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var lu={isMounted:function(e){return(e=e._reactInternals)?As(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Dt(),s=Kr(e),i=fr(r,s);i.payload=t,n!=null&&(i.callback=n),t=Hr(e,i,s),t!==null&&(An(t,e,s,r),ta(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Dt(),s=Kr(e),i=fr(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Hr(e,i,s),t!==null&&(An(t,e,s,r),ta(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Dt(),r=Kr(e),s=fr(n,r);s.tag=2,t!=null&&(s.callback=t),t=Hr(e,s,r),t!==null&&(An(t,e,r,n),ta(t,e,r))}};function kp(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!Lo(n,r)||!Lo(s,i):!0}function wv(e,t,n){var r=!1,s=es,i=t.contextType;return typeof i=="object"&&i!==null?i=bn(i):(s=Zt(t)?Ms:Pt.current,r=t.contextTypes,i=(r=r!=null)?Ri(e,s):es),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=lu,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Ep(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&lu.enqueueReplaceState(t,t.state,null)}function dd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Af(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=bn(i):(i=Zt(t)?Ms:Pt.current,s.context=Ri(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(cd(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&lu.enqueueReplaceState(s,s.state,null),Ta(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Li(e,t){try{var n="",r=t;do n+=Ew(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function pc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function fd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var J1=typeof WeakMap=="function"?WeakMap:Map;function bv(e,t,n){n=fr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Fa||(Fa=!0,Sd=r),fd(e,t)},n}function Sv(e,t,n){n=fr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){fd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){fd(e,t),typeof r!="function"&&(Qr===null?Qr=new Set([this]):Qr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Np(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new J1;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=fb.bind(null,e,t,n),t.then(e,e))}function Mp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function jp(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=fr(-1,1),t.tag=2,Hr(n,t,1))),n.lanes|=1),e)}var Z1=xr.ReactCurrentOwner,Xt=!1;function Ft(e,t,n,r){t.child=e===null?Xy(t,null,n,r):Ti(t,e.child,n,r)}function Rp(e,t,n,r,s){n=n.render;var i=t.ref;return di(t,s),r=$f(e,t,n,r,i,s),n=Bf(),e!==null&&!Xt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,vr(e,t,s)):(We&&n&&jf(t),t.flags|=1,Ft(e,t,r,s),t.child)}function Pp(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!Xf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,Cv(e,t,i,r,s)):(e=la(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Lo,n(o,r)&&e.ref===t.ref)return vr(e,t,s)}return t.flags|=1,e=qr(i,r),e.ref=t.ref,e.return=t,t.child=e}function Cv(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(Lo(i,r)&&e.ref===t.ref)if(Xt=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Xt=!0);else return t.lanes=e.lanes,vr(e,t,s)}return hd(e,t,n,r,s)}function kv(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(oi,rn),rn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,De(oi,rn),rn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,De(oi,rn),rn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,De(oi,rn),rn|=r;return Ft(e,t,s,n),t.child}function Ev(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function hd(e,t,n,r,s){var i=Zt(n)?Ms:Pt.current;return i=Ri(t,i),di(t,s),n=$f(e,t,n,r,i,s),r=Bf(),e!==null&&!Xt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,vr(e,t,s)):(We&&r&&jf(t),t.flags|=1,Ft(e,t,n,s),t.child)}function Tp(e,t,n,r,s){if(Zt(n)){var i=!0;Na(t)}else i=!1;if(di(t,s),t.stateNode===null)sa(e,t),wv(t,n,r),dd(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=bn(d):(d=Zt(n)?Ms:Pt.current,d=Ri(t,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&Ep(t,o,r,d),Mr=!1;var h=t.memoizedState;o.state=h,Ta(t,r,o,s),c=t.memoizedState,l!==r||h!==c||Jt.current||Mr?(typeof f=="function"&&(cd(t,n,f,r),c=t.memoizedState),(l=Mr||kp(t,n,l,r,h,c,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Zy(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:jn(t.type,l),o.props=d,p=t.pendingProps,h=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=bn(c):(c=Zt(n)?Ms:Pt.current,c=Ri(t,c));var w=n.getDerivedStateFromProps;(f=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||h!==c)&&Ep(t,o,r,c),Mr=!1,h=t.memoizedState,o.state=h,Ta(t,r,o,s);var x=t.memoizedState;l!==p||h!==x||Jt.current||Mr?(typeof w=="function"&&(cd(t,n,w,r),x=t.memoizedState),(d=Mr||kp(t,n,d,r,h,x,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=x),o.props=r,o.state=x,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return pd(e,t,n,r,i,s)}function pd(e,t,n,r,s,i){Ev(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&gp(t,n,!1),vr(e,t,i);r=t.stateNode,Z1.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Ti(t,e.child,null,i),t.child=Ti(t,null,l,i)):Ft(e,t,l,i),t.memoizedState=r.state,s&&gp(t,n,!0),t.child}function Nv(e){var t=e.stateNode;t.pendingContext?mp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&mp(e,t.context,!1),Ff(e,t.containerInfo)}function Ip(e,t,n,r,s){return Pi(),Pf(s),t.flags|=256,Ft(e,t,n,r),t.child}var md={dehydrated:null,treeContext:null,retryLane:0};function gd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Mv(e,t,n){var r=t.pendingProps,s=Qe.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),De(Qe,s&1),e===null)return ad(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=cu(o,r,0,null),e=Ns(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=gd(n),t.memoizedState=md,e):Wf(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return eb(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=qr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=qr(l,i):(i=Ns(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?gd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=md,r}return i=e.child,e=i.sibling,r=qr(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Wf(e,t){return t=cu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Il(e,t,n,r){return r!==null&&Pf(r),Ti(t,e.child,null,n),e=Wf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function eb(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=pc(Error(W(422))),Il(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=cu({mode:"visible",children:r.children},s,0,null),i=Ns(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Ti(t,e.child,null,o),t.child.memoizedState=gd(o),t.memoizedState=md,i);if(!(t.mode&1))return Il(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(W(419)),r=pc(i,r,void 0),Il(e,t,o,r)}if(l=(o&e.childLanes)!==0,Xt||l){if(r=mt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,yr(e,s),An(r,e,s,-1))}return Yf(),r=pc(Error(W(421))),Il(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=hb.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,sn=Wr(s.nextSibling),on=t,We=!0,Ln=null,e!==null&&(gn[yn++]=cr,gn[yn++]=dr,gn[yn++]=js,cr=e.id,dr=e.overflow,js=t),t=Wf(t,r.children),t.flags|=4096,t)}function Lp(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ud(e.return,t,n)}function mc(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function jv(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(Ft(e,t,r.children,n),r=Qe.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Lp(e,n,t);else if(e.tag===19)Lp(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(De(Qe,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Ia(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),mc(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Ia(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}mc(t,!0,n,null,i);break;case"together":mc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function sa(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function vr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ps|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(W(153));if(t.child!==null){for(e=t.child,n=qr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=qr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function tb(e,t,n){switch(t.tag){case 3:Nv(t),Pi();break;case 5:ev(t);break;case 1:Zt(t.type)&&Na(t);break;case 4:Ff(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;De(Ra,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(De(Qe,Qe.current&1),t.flags|=128,null):n&t.child.childLanes?Mv(e,t,n):(De(Qe,Qe.current&1),e=vr(e,t,n),e!==null?e.sibling:null);De(Qe,Qe.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return jv(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),De(Qe,Qe.current),r)break;return null;case 22:case 23:return t.lanes=0,kv(e,t,n)}return vr(e,t,n)}var Rv,yd,Pv,Tv;Rv=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};yd=function(){};Pv=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,cs(Xn.current);var i=null;switch(n){case"input":s=zc(e,s),r=zc(e,r),i=[];break;case"select":s=qe({},s,{value:void 0}),r=qe({},r,{value:void 0}),i=[];break;case"textarea":s=Uc(e,s),r=Uc(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ka)}Wc(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(No.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(No.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&$e("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Tv=function(e,t,n,r){n!==r&&(t.flags|=4)};function eo(e,t){if(!We)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Mt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function nb(e,t,n){var r=t.pendingProps;switch(Rf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Mt(t),null;case 1:return Zt(t.type)&&Ea(),Mt(t),null;case 3:return r=t.stateNode,Ii(),Be(Jt),Be(Pt),Df(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Pl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ln!==null&&(Ed(Ln),Ln=null))),yd(e,t),Mt(t),null;case 5:Of(t);var s=cs(Do.current);if(n=t.type,e!==null&&t.stateNode!=null)Pv(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(W(166));return Mt(t),null}if(e=cs(Xn.current),Pl(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Gn]=t,r[Fo]=i,e=(t.mode&1)!==0,n){case"dialog":$e("cancel",r),$e("close",r);break;case"iframe":case"object":case"embed":$e("load",r);break;case"video":case"audio":for(s=0;s<co.length;s++)$e(co[s],r);break;case"source":$e("error",r);break;case"img":case"image":case"link":$e("error",r),$e("load",r);break;case"details":$e("toggle",r);break;case"input":Uh(r,i),$e("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},$e("invalid",r);break;case"textarea":Wh(r,i),$e("invalid",r)}Wc(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Rl(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Rl(r.textContent,l,e),s=["children",""+l]):No.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&$e("scroll",r)}switch(n){case"input":bl(r),Vh(r,i,!0);break;case"textarea":bl(r),Hh(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ka)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=iy(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Gn]=t,e[Fo]=r,Rv(e,t,!1,!1),t.stateNode=e;e:{switch(o=Hc(n,r),n){case"dialog":$e("cancel",e),$e("close",e),s=r;break;case"iframe":case"object":case"embed":$e("load",e),s=r;break;case"video":case"audio":for(s=0;s<co.length;s++)$e(co[s],e);s=r;break;case"source":$e("error",e),s=r;break;case"img":case"image":case"link":$e("error",e),$e("load",e),s=r;break;case"details":$e("toggle",e),s=r;break;case"input":Uh(e,r),s=zc(e,r),$e("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=qe({},r,{value:void 0}),$e("invalid",e);break;case"textarea":Wh(e,r),s=Uc(e,r),$e("invalid",e);break;default:s=r}Wc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?ay(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&oy(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Mo(e,c):typeof c=="number"&&Mo(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(No.hasOwnProperty(i)?c!=null&&i==="onScroll"&&$e("scroll",e):c!=null&&pf(e,i,c,o))}switch(n){case"input":bl(e),Vh(e,r,!1);break;case"textarea":bl(e),Hh(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Zr(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?li(e,!!r.multiple,i,!1):r.defaultValue!=null&&li(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=ka)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Mt(t),null;case 6:if(e&&t.stateNode!=null)Tv(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(W(166));if(n=cs(Do.current),cs(Xn.current),Pl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Gn]=t,(i=r.nodeValue!==n)&&(e=on,e!==null))switch(e.tag){case 3:Rl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Rl(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Gn]=t,t.stateNode=r}return Mt(t),null;case 13:if(Be(Qe),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(We&&sn!==null&&t.mode&1&&!(t.flags&128))Gy(),Pi(),t.flags|=98560,i=!1;else if(i=Pl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(W(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Gn]=t}else Pi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Mt(t),i=!1}else Ln!==null&&(Ed(Ln),Ln=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Qe.current&1?ct===0&&(ct=3):Yf())),t.updateQueue!==null&&(t.flags|=4),Mt(t),null);case 4:return Ii(),yd(e,t),e===null&&_o(t.stateNode.containerInfo),Mt(t),null;case 10:return Lf(t.type._context),Mt(t),null;case 17:return Zt(t.type)&&Ea(),Mt(t),null;case 19:if(Be(Qe),i=t.memoizedState,i===null)return Mt(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)eo(i,!1);else{if(ct!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Ia(e),o!==null){for(t.flags|=128,eo(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return De(Qe,Qe.current&1|2),t.child}e=e.sibling}i.tail!==null&&nt()>_i&&(t.flags|=128,r=!0,eo(i,!1),t.lanes=4194304)}else{if(!r)if(e=Ia(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),eo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!We)return Mt(t),null}else 2*nt()-i.renderingStartTime>_i&&n!==1073741824&&(t.flags|=128,r=!0,eo(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=nt(),t.sibling=null,n=Qe.current,De(Qe,r?n&1|2:n&1),t):(Mt(t),null);case 22:case 23:return Gf(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?rn&1073741824&&(Mt(t),t.subtreeFlags&6&&(t.flags|=8192)):Mt(t),null;case 24:return null;case 25:return null}throw Error(W(156,t.tag))}function rb(e,t){switch(Rf(t),t.tag){case 1:return Zt(t.type)&&Ea(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ii(),Be(Jt),Be(Pt),Df(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Of(t),null;case 13:if(Be(Qe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(W(340));Pi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Be(Qe),null;case 4:return Ii(),null;case 10:return Lf(t.type._context),null;case 22:case 23:return Gf(),null;case 24:return null;default:return null}}var Ll=!1,jt=!1,sb=typeof WeakSet=="function"?WeakSet:Set,ne=null;function ii(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ze(e,t,r)}else n.current=null}function vd(e,t,n){try{n()}catch(r){Ze(e,t,r)}}var _p=!1;function ib(e,t){if(td=ba,e=Fy(),Mf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,f=0,p=e,h=null;t:for(;;){for(var w;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(w=p.firstChild)!==null;)h=p,p=w;for(;;){if(p===e)break t;if(h===n&&++d===s&&(l=o),h===i&&++f===r&&(c=o),(w=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=w}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nd={focusedElem:e,selectionRange:n},ba=!1,ne=t;ne!==null;)if(t=ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ne=e;else for(;ne!==null;){t=ne;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var b=x.memoizedProps,S=x.memoizedState,y=t.stateNode,m=y.getSnapshotBeforeUpdate(t.elementType===t.type?b:jn(t.type,b),S);y.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(g){Ze(t,t.return,g)}if(e=t.sibling,e!==null){e.return=t.return,ne=e;break}ne=t.return}return x=_p,_p=!1,x}function wo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&vd(t,n,i)}s=s.next}while(s!==r)}}function au(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function xd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Iv(e){var t=e.alternate;t!==null&&(e.alternate=null,Iv(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gn],delete t[Fo],delete t[id],delete t[B1],delete t[U1])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Lv(e){return e.tag===5||e.tag===3||e.tag===4}function Ap(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Lv(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ka));else if(r!==4&&(e=e.child,e!==null))for(wd(e,t,n),e=e.sibling;e!==null;)wd(e,t,n),e=e.sibling}function bd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(bd(e,t,n),e=e.sibling;e!==null;)bd(e,t,n),e=e.sibling}var xt=null,In=!1;function Cr(e,t,n){for(n=n.child;n!==null;)_v(e,t,n),n=n.sibling}function _v(e,t,n){if(Yn&&typeof Yn.onCommitFiberUnmount=="function")try{Yn.onCommitFiberUnmount(eu,n)}catch{}switch(n.tag){case 5:jt||ii(n,t);case 6:var r=xt,s=In;xt=null,Cr(e,t,n),xt=r,In=s,xt!==null&&(In?(e=xt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):xt.removeChild(n.stateNode));break;case 18:xt!==null&&(In?(e=xt,n=n.stateNode,e.nodeType===8?ac(e.parentNode,n):e.nodeType===1&&ac(e,n),To(e)):ac(xt,n.stateNode));break;case 4:r=xt,s=In,xt=n.stateNode.containerInfo,In=!0,Cr(e,t,n),xt=r,In=s;break;case 0:case 11:case 14:case 15:if(!jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&vd(n,t,o),s=s.next}while(s!==r)}Cr(e,t,n);break;case 1:if(!jt&&(ii(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ze(n,t,l)}Cr(e,t,n);break;case 21:Cr(e,t,n);break;case 22:n.mode&1?(jt=(r=jt)||n.memoizedState!==null,Cr(e,t,n),jt=r):Cr(e,t,n);break;default:Cr(e,t,n)}}function Fp(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new sb),t.forEach(function(r){var s=pb.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Nn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:xt=l.stateNode,In=!1;break e;case 3:xt=l.stateNode.containerInfo,In=!0;break e;case 4:xt=l.stateNode.containerInfo,In=!0;break e}l=l.return}if(xt===null)throw Error(W(160));_v(i,o,s),xt=null,In=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Ze(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Av(t,e),t=t.sibling}function Av(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Nn(t,e),Wn(e),r&4){try{wo(3,e,e.return),au(3,e)}catch(b){Ze(e,e.return,b)}try{wo(5,e,e.return)}catch(b){Ze(e,e.return,b)}}break;case 1:Nn(t,e),Wn(e),r&512&&n!==null&&ii(n,n.return);break;case 5:if(Nn(t,e),Wn(e),r&512&&n!==null&&ii(n,n.return),e.flags&32){var s=e.stateNode;try{Mo(s,"")}catch(b){Ze(e,e.return,b)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&ry(s,i),Hc(l,o);var d=Hc(l,i);for(o=0;o<c.length;o+=2){var f=c[o],p=c[o+1];f==="style"?ay(s,p):f==="dangerouslySetInnerHTML"?oy(s,p):f==="children"?Mo(s,p):pf(s,f,p,d)}switch(l){case"input":$c(s,i);break;case"textarea":sy(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?li(s,!!i.multiple,w,!1):h!==!!i.multiple&&(i.defaultValue!=null?li(s,!!i.multiple,i.defaultValue,!0):li(s,!!i.multiple,i.multiple?[]:"",!1))}s[Fo]=i}catch(b){Ze(e,e.return,b)}}break;case 6:if(Nn(t,e),Wn(e),r&4){if(e.stateNode===null)throw Error(W(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(b){Ze(e,e.return,b)}}break;case 3:if(Nn(t,e),Wn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{To(t.containerInfo)}catch(b){Ze(e,e.return,b)}break;case 4:Nn(t,e),Wn(e);break;case 13:Nn(t,e),Wn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Kf=nt())),r&4&&Fp(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(jt=(d=jt)||f,Nn(t,e),jt=d):Nn(t,e),Wn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!f&&e.mode&1)for(ne=e,f=e.child;f!==null;){for(p=ne=f;ne!==null;){switch(h=ne,w=h.child,h.tag){case 0:case 11:case 14:case 15:wo(4,h,h.return);break;case 1:ii(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(b){Ze(r,n,b)}}break;case 5:ii(h,h.return);break;case 22:if(h.memoizedState!==null){Dp(p);continue}}w!==null?(w.return=h,ne=w):Dp(p)}f=f.sibling}e:for(f=null,p=e;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=ly("display",o))}catch(b){Ze(e,e.return,b)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(b){Ze(e,e.return,b)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Nn(t,e),Wn(e),r&4&&Fp(e);break;case 21:break;default:Nn(t,e),Wn(e)}}function Wn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Lv(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Mo(s,""),r.flags&=-33);var i=Ap(e);bd(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Ap(e);wd(e,l,o);break;default:throw Error(W(161))}}catch(c){Ze(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ob(e,t,n){ne=e,Fv(e)}function Fv(e,t,n){for(var r=(e.mode&1)!==0;ne!==null;){var s=ne,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Ll;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||jt;l=Ll;var d=jt;if(Ll=o,(jt=c)&&!d)for(ne=s;ne!==null;)o=ne,c=o.child,o.tag===22&&o.memoizedState!==null?zp(s):c!==null?(c.return=o,ne=c):zp(s);for(;i!==null;)ne=i,Fv(i),i=i.sibling;ne=s,Ll=l,jt=d}Op(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ne=i):Op(e)}}function Op(e){for(;ne!==null;){var t=ne;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:jt||au(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!jt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:jn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&bp(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}bp(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&To(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}jt||t.flags&512&&xd(t)}catch(h){Ze(t,t.return,h)}}if(t===e){ne=null;break}if(n=t.sibling,n!==null){n.return=t.return,ne=n;break}ne=t.return}}function Dp(e){for(;ne!==null;){var t=ne;if(t===e){ne=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ne=n;break}ne=t.return}}function zp(e){for(;ne!==null;){var t=ne;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{au(4,t)}catch(c){Ze(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){Ze(t,s,c)}}var i=t.return;try{xd(t)}catch(c){Ze(t,i,c)}break;case 5:var o=t.return;try{xd(t)}catch(c){Ze(t,o,c)}}}catch(c){Ze(t,t.return,c)}if(t===e){ne=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ne=l;break}ne=t.return}}var lb=Math.ceil,Aa=xr.ReactCurrentDispatcher,Hf=xr.ReactCurrentOwner,wn=xr.ReactCurrentBatchConfig,Pe=0,mt=null,st=null,wt=0,rn=0,oi=ns(0),ct=0,Uo=null,Ps=0,uu=0,Qf=0,bo=null,Yt=null,Kf=0,_i=1/0,sr=null,Fa=!1,Sd=null,Qr=null,_l=!1,$r=null,Oa=0,So=0,Cd=null,ia=-1,oa=0;function Dt(){return Pe&6?nt():ia!==-1?ia:ia=nt()}function Kr(e){return e.mode&1?Pe&2&&wt!==0?wt&-wt:W1.transition!==null?(oa===0&&(oa=wy()),oa):(e=Ae,e!==0||(e=window.event,e=e===void 0?16:My(e.type)),e):1}function An(e,t,n,r){if(50<So)throw So=0,Cd=null,Error(W(185));Zo(e,n,r),(!(Pe&2)||e!==mt)&&(e===mt&&(!(Pe&2)&&(uu|=n),ct===4&&Rr(e,wt)),en(e,r),n===1&&Pe===0&&!(t.mode&1)&&(_i=nt()+500,iu&&rs()))}function en(e,t){var n=e.callbackNode;Ww(e,t);var r=wa(e,e===mt?wt:0);if(r===0)n!==null&&qh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&qh(n),t===1)e.tag===0?V1($p.bind(null,e)):Qy($p.bind(null,e)),z1(function(){!(Pe&6)&&rs()}),n=null;else{switch(by(r)){case 1:n=xf;break;case 4:n=vy;break;case 16:n=xa;break;case 536870912:n=xy;break;default:n=xa}n=Wv(n,Ov.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Ov(e,t){if(ia=-1,oa=0,Pe&6)throw Error(W(327));var n=e.callbackNode;if(fi()&&e.callbackNode!==n)return null;var r=wa(e,e===mt?wt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Da(e,r);else{t=r;var s=Pe;Pe|=2;var i=zv();(mt!==e||wt!==t)&&(sr=null,_i=nt()+500,Es(e,t));do try{cb();break}catch(l){Dv(e,l)}while(!0);If(),Aa.current=i,Pe=s,st!==null?t=0:(mt=null,wt=0,t=ct)}if(t!==0){if(t===2&&(s=Yc(e),s!==0&&(r=s,t=kd(e,s))),t===1)throw n=Uo,Es(e,0),Rr(e,r),en(e,nt()),n;if(t===6)Rr(e,r);else{if(s=e.current.alternate,!(r&30)&&!ab(s)&&(t=Da(e,r),t===2&&(i=Yc(e),i!==0&&(r=i,t=kd(e,i))),t===1))throw n=Uo,Es(e,0),Rr(e,r),en(e,nt()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(W(345));case 2:os(e,Yt,sr);break;case 3:if(Rr(e,r),(r&130023424)===r&&(t=Kf+500-nt(),10<t)){if(wa(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Dt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=sd(os.bind(null,e,Yt,sr),t);break}os(e,Yt,sr);break;case 4:if(Rr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-_n(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=nt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*lb(r/1960))-r,10<r){e.timeoutHandle=sd(os.bind(null,e,Yt,sr),r);break}os(e,Yt,sr);break;case 5:os(e,Yt,sr);break;default:throw Error(W(329))}}}return en(e,nt()),e.callbackNode===n?Ov.bind(null,e):null}function kd(e,t){var n=bo;return e.current.memoizedState.isDehydrated&&(Es(e,t).flags|=256),e=Da(e,t),e!==2&&(t=Yt,Yt=n,t!==null&&Ed(t)),e}function Ed(e){Yt===null?Yt=e:Yt.push.apply(Yt,e)}function ab(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!On(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Rr(e,t){for(t&=~Qf,t&=~uu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-_n(t),r=1<<n;e[n]=-1,t&=~r}}function $p(e){if(Pe&6)throw Error(W(327));fi();var t=wa(e,0);if(!(t&1))return en(e,nt()),null;var n=Da(e,t);if(e.tag!==0&&n===2){var r=Yc(e);r!==0&&(t=r,n=kd(e,r))}if(n===1)throw n=Uo,Es(e,0),Rr(e,t),en(e,nt()),n;if(n===6)throw Error(W(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,os(e,Yt,sr),en(e,nt()),null}function qf(e,t){var n=Pe;Pe|=1;try{return e(t)}finally{Pe=n,Pe===0&&(_i=nt()+500,iu&&rs())}}function Ts(e){$r!==null&&$r.tag===0&&!(Pe&6)&&fi();var t=Pe;Pe|=1;var n=wn.transition,r=Ae;try{if(wn.transition=null,Ae=1,e)return e()}finally{Ae=r,wn.transition=n,Pe=t,!(Pe&6)&&rs()}}function Gf(){rn=oi.current,Be(oi)}function Es(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,D1(n)),st!==null)for(n=st.return;n!==null;){var r=n;switch(Rf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ea();break;case 3:Ii(),Be(Jt),Be(Pt),Df();break;case 5:Of(r);break;case 4:Ii();break;case 13:Be(Qe);break;case 19:Be(Qe);break;case 10:Lf(r.type._context);break;case 22:case 23:Gf()}n=n.return}if(mt=e,st=e=qr(e.current,null),wt=rn=t,ct=0,Uo=null,Qf=uu=Ps=0,Yt=bo=null,us!==null){for(t=0;t<us.length;t++)if(n=us[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}us=null}return e}function Dv(e,t){do{var n=st;try{if(If(),na.current=_a,La){for(var r=Ke.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}La=!1}if(Rs=0,pt=at=Ke=null,xo=!1,zo=0,Hf.current=null,n===null||n.return===null){ct=1,Uo=t,st=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=wt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var w=Mp(o);if(w!==null){w.flags&=-257,jp(w,o,l,i,t),w.mode&1&&Np(i,d,t),t=w,c=d;var x=t.updateQueue;if(x===null){var b=new Set;b.add(c),t.updateQueue=b}else x.add(c);break e}else{if(!(t&1)){Np(i,d,t),Yf();break e}c=Error(W(426))}}else if(We&&l.mode&1){var S=Mp(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),jp(S,o,l,i,t),Pf(Li(c,l));break e}}i=c=Li(c,l),ct!==4&&(ct=2),bo===null?bo=[i]:bo.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var y=bv(i,c,t);wp(i,y);break e;case 1:l=c;var m=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Qr===null||!Qr.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var g=Sv(i,l,t);wp(i,g);break e}}i=i.return}while(i!==null)}Bv(n)}catch(C){t=C,st===n&&n!==null&&(st=n=n.return);continue}break}while(!0)}function zv(){var e=Aa.current;return Aa.current=_a,e===null?_a:e}function Yf(){(ct===0||ct===3||ct===2)&&(ct=4),mt===null||!(Ps&268435455)&&!(uu&268435455)||Rr(mt,wt)}function Da(e,t){var n=Pe;Pe|=2;var r=zv();(mt!==e||wt!==t)&&(sr=null,Es(e,t));do try{ub();break}catch(s){Dv(e,s)}while(!0);if(If(),Pe=n,Aa.current=r,st!==null)throw Error(W(261));return mt=null,wt=0,ct}function ub(){for(;st!==null;)$v(st)}function cb(){for(;st!==null&&!Aw();)$v(st)}function $v(e){var t=Vv(e.alternate,e,rn);e.memoizedProps=e.pendingProps,t===null?Bv(e):st=t,Hf.current=null}function Bv(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=rb(n,t),n!==null){n.flags&=32767,st=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ct=6,st=null;return}}else if(n=nb(n,t,rn),n!==null){st=n;return}if(t=t.sibling,t!==null){st=t;return}st=t=e}while(t!==null);ct===0&&(ct=5)}function os(e,t,n){var r=Ae,s=wn.transition;try{wn.transition=null,Ae=1,db(e,t,n,r)}finally{wn.transition=s,Ae=r}return null}function db(e,t,n,r){do fi();while($r!==null);if(Pe&6)throw Error(W(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(W(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(Hw(e,i),e===mt&&(st=mt=null,wt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_l||(_l=!0,Wv(xa,function(){return fi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=wn.transition,wn.transition=null;var o=Ae;Ae=1;var l=Pe;Pe|=4,Hf.current=null,ib(e,n),Av(n,e),T1(nd),ba=!!td,nd=td=null,e.current=n,ob(n),Fw(),Pe=l,Ae=o,wn.transition=i}else e.current=n;if(_l&&(_l=!1,$r=e,Oa=s),i=e.pendingLanes,i===0&&(Qr=null),zw(n.stateNode),en(e,nt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Fa)throw Fa=!1,e=Sd,Sd=null,e;return Oa&1&&e.tag!==0&&fi(),i=e.pendingLanes,i&1?e===Cd?So++:(So=0,Cd=e):So=0,rs(),null}function fi(){if($r!==null){var e=by(Oa),t=wn.transition,n=Ae;try{if(wn.transition=null,Ae=16>e?16:e,$r===null)var r=!1;else{if(e=$r,$r=null,Oa=0,Pe&6)throw Error(W(331));var s=Pe;for(Pe|=4,ne=e.current;ne!==null;){var i=ne,o=i.child;if(ne.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(ne=d;ne!==null;){var f=ne;switch(f.tag){case 0:case 11:case 15:wo(8,f,i)}var p=f.child;if(p!==null)p.return=f,ne=p;else for(;ne!==null;){f=ne;var h=f.sibling,w=f.return;if(Iv(f),f===d){ne=null;break}if(h!==null){h.return=w,ne=h;break}ne=w}}}var x=i.alternate;if(x!==null){var b=x.child;if(b!==null){x.child=null;do{var S=b.sibling;b.sibling=null,b=S}while(b!==null)}}ne=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ne=o;else e:for(;ne!==null;){if(i=ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:wo(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,ne=y;break e}ne=i.return}}var m=e.current;for(ne=m;ne!==null;){o=ne;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,ne=v;else e:for(o=m;ne!==null;){if(l=ne,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:au(9,l)}}catch(C){Ze(l,l.return,C)}if(l===o){ne=null;break e}var g=l.sibling;if(g!==null){g.return=l.return,ne=g;break e}ne=l.return}}if(Pe=s,rs(),Yn&&typeof Yn.onPostCommitFiberRoot=="function")try{Yn.onPostCommitFiberRoot(eu,e)}catch{}r=!0}return r}finally{Ae=n,wn.transition=t}}return!1}function Bp(e,t,n){t=Li(n,t),t=bv(e,t,1),e=Hr(e,t,1),t=Dt(),e!==null&&(Zo(e,1,t),en(e,t))}function Ze(e,t,n){if(e.tag===3)Bp(e,e,n);else for(;t!==null;){if(t.tag===3){Bp(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Qr===null||!Qr.has(r))){e=Li(n,e),e=Sv(t,e,1),t=Hr(t,e,1),e=Dt(),t!==null&&(Zo(t,1,e),en(t,e));break}}t=t.return}}function fb(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Dt(),e.pingedLanes|=e.suspendedLanes&n,mt===e&&(wt&n)===n&&(ct===4||ct===3&&(wt&130023424)===wt&&500>nt()-Kf?Es(e,0):Qf|=n),en(e,t)}function Uv(e,t){t===0&&(e.mode&1?(t=kl,kl<<=1,!(kl&130023424)&&(kl=4194304)):t=1);var n=Dt();e=yr(e,t),e!==null&&(Zo(e,t,n),en(e,n))}function hb(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Uv(e,n)}function pb(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(t),Uv(e,n)}var Vv;Vv=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Jt.current)Xt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Xt=!1,tb(e,t,n);Xt=!!(e.flags&131072)}else Xt=!1,We&&t.flags&1048576&&Ky(t,ja,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;sa(e,t),e=t.pendingProps;var s=Ri(t,Pt.current);di(t,n),s=$f(null,t,r,e,s,n);var i=Bf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Zt(r)?(i=!0,Na(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Af(t),s.updater=lu,t.stateNode=s,s._reactInternals=t,dd(t,r,e,n),t=pd(null,t,r,!0,i,n)):(t.tag=0,We&&i&&jf(t),Ft(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(sa(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=gb(r),e=jn(r,e),s){case 0:t=hd(null,t,r,e,n);break e;case 1:t=Tp(null,t,r,e,n);break e;case 11:t=Rp(null,t,r,e,n);break e;case 14:t=Pp(null,t,r,jn(r.type,e),n);break e}throw Error(W(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:jn(r,s),hd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:jn(r,s),Tp(e,t,r,s,n);case 3:e:{if(Nv(t),e===null)throw Error(W(387));r=t.pendingProps,i=t.memoizedState,s=i.element,Zy(e,t),Ta(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Li(Error(W(423)),t),t=Ip(e,t,r,n,s);break e}else if(r!==s){s=Li(Error(W(424)),t),t=Ip(e,t,r,n,s);break e}else for(sn=Wr(t.stateNode.containerInfo.firstChild),on=t,We=!0,Ln=null,n=Xy(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Pi(),r===s){t=vr(e,t,n);break e}Ft(e,t,r,n)}t=t.child}return t;case 5:return ev(t),e===null&&ad(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,rd(r,s)?o=null:i!==null&&rd(r,i)&&(t.flags|=32),Ev(e,t),Ft(e,t,o,n),t.child;case 6:return e===null&&ad(t),null;case 13:return Mv(e,t,n);case 4:return Ff(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ti(t,null,r,n):Ft(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:jn(r,s),Rp(e,t,r,s,n);case 7:return Ft(e,t,t.pendingProps,n),t.child;case 8:return Ft(e,t,t.pendingProps.children,n),t.child;case 12:return Ft(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,De(Ra,r._currentValue),r._currentValue=o,i!==null)if(On(i.value,o)){if(i.children===s.children&&!Jt.current){t=vr(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=fr(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),ud(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ud(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ft(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,di(t,n),s=bn(s),r=r(s),t.flags|=1,Ft(e,t,r,n),t.child;case 14:return r=t.type,s=jn(r,t.pendingProps),s=jn(r.type,s),Pp(e,t,r,s,n);case 15:return Cv(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:jn(r,s),sa(e,t),t.tag=1,Zt(r)?(e=!0,Na(t)):e=!1,di(t,n),wv(t,r,s),dd(t,r,s,n),pd(null,t,r,!0,e,n);case 19:return jv(e,t,n);case 22:return kv(e,t,n)}throw Error(W(156,t.tag))};function Wv(e,t){return yy(e,t)}function mb(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(e,t,n,r){return new mb(e,t,n,r)}function Xf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function gb(e){if(typeof e=="function")return Xf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===gf)return 11;if(e===yf)return 14}return 2}function qr(e,t){var n=e.alternate;return n===null?(n=xn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function la(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")Xf(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ys:return Ns(n.children,s,i,t);case mf:o=8,s|=8;break;case Ac:return e=xn(12,n,t,s|2),e.elementType=Ac,e.lanes=i,e;case Fc:return e=xn(13,n,t,s),e.elementType=Fc,e.lanes=i,e;case Oc:return e=xn(19,n,t,s),e.elementType=Oc,e.lanes=i,e;case ey:return cu(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Jg:o=10;break e;case Zg:o=9;break e;case gf:o=11;break e;case yf:o=14;break e;case Nr:o=16,r=null;break e}throw Error(W(130,e==null?e:typeof e,""))}return t=xn(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function Ns(e,t,n,r){return e=xn(7,e,r,t),e.lanes=n,e}function cu(e,t,n,r){return e=xn(22,e,r,t),e.elementType=ey,e.lanes=n,e.stateNode={isHidden:!1},e}function gc(e,t,n){return e=xn(6,e,null,t),e.lanes=n,e}function yc(e,t,n){return t=xn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function yb(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xu(0),this.expirationTimes=Xu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Jf(e,t,n,r,s,i,o,l,c){return e=new yb(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=xn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Af(i),e}function vb(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gs,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Hv(e){if(!e)return es;e=e._reactInternals;e:{if(As(e)!==e||e.tag!==1)throw Error(W(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Zt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(W(171))}if(e.tag===1){var n=e.type;if(Zt(n))return Hy(e,n,t)}return t}function Qv(e,t,n,r,s,i,o,l,c){return e=Jf(n,r,!0,e,s,i,o,l,c),e.context=Hv(null),n=e.current,r=Dt(),s=Kr(n),i=fr(r,s),i.callback=t??null,Hr(n,i,s),e.current.lanes=s,Zo(e,s,r),en(e,r),e}function du(e,t,n,r){var s=t.current,i=Dt(),o=Kr(s);return n=Hv(n),t.context===null?t.context=n:t.pendingContext=n,t=fr(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Hr(s,t,o),e!==null&&(An(e,s,o,i),ta(e,s,o)),o}function za(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Up(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Zf(e,t){Up(e,t),(e=e.alternate)&&Up(e,t)}function xb(){return null}var Kv=typeof reportError=="function"?reportError:function(e){console.error(e)};function eh(e){this._internalRoot=e}fu.prototype.render=eh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(W(409));du(e,t,null,null)};fu.prototype.unmount=eh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ts(function(){du(null,e,null,null)}),t[gr]=null}};function fu(e){this._internalRoot=e}fu.prototype.unstable_scheduleHydration=function(e){if(e){var t=ky();e={blockedOn:null,target:e,priority:t};for(var n=0;n<jr.length&&t!==0&&t<jr[n].priority;n++);jr.splice(n,0,e),n===0&&Ny(e)}};function th(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function hu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Vp(){}function wb(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=za(o);i.call(d)}}var o=Qv(t,r,e,0,null,!1,!1,"",Vp);return e._reactRootContainer=o,e[gr]=o.current,_o(e.nodeType===8?e.parentNode:e),Ts(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=za(c);l.call(d)}}var c=Jf(e,0,!1,null,null,!1,!1,"",Vp);return e._reactRootContainer=c,e[gr]=c.current,_o(e.nodeType===8?e.parentNode:e),Ts(function(){du(t,c,n,r)}),c}function pu(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=za(o);l.call(c)}}du(t,o,e,s)}else o=wb(n,t,e,s,r);return za(o)}Sy=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=uo(t.pendingLanes);n!==0&&(wf(t,n|1),en(t,nt()),!(Pe&6)&&(_i=nt()+500,rs()))}break;case 13:Ts(function(){var r=yr(e,1);if(r!==null){var s=Dt();An(r,e,1,s)}}),Zf(e,1)}};bf=function(e){if(e.tag===13){var t=yr(e,134217728);if(t!==null){var n=Dt();An(t,e,134217728,n)}Zf(e,134217728)}};Cy=function(e){if(e.tag===13){var t=Kr(e),n=yr(e,t);if(n!==null){var r=Dt();An(n,e,t,r)}Zf(e,t)}};ky=function(){return Ae};Ey=function(e,t){var n=Ae;try{return Ae=e,t()}finally{Ae=n}};Kc=function(e,t,n){switch(t){case"input":if($c(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=su(r);if(!s)throw Error(W(90));ny(r),$c(r,s)}}}break;case"textarea":sy(e,n);break;case"select":t=n.value,t!=null&&li(e,!!n.multiple,t,!1)}};dy=qf;fy=Ts;var bb={usingClientEntryPoint:!1,Events:[tl,ei,su,uy,cy,qf]},to={findFiberByHostInstance:as,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Sb={bundleType:to.bundleType,version:to.version,rendererPackageName:to.rendererPackageName,rendererConfig:to.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=my(e),e===null?null:e.stateNode},findFiberByHostInstance:to.findFiberByHostInstance||xb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Al.isDisabled&&Al.supportsFiber)try{eu=Al.inject(Sb),Yn=Al}catch{}}un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bb;un.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!th(t))throw Error(W(200));return vb(e,t,null,n)};un.createRoot=function(e,t){if(!th(e))throw Error(W(299));var n=!1,r="",s=Kv;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Jf(e,1,!1,null,null,n,!1,r,s),e[gr]=t.current,_o(e.nodeType===8?e.parentNode:e),new eh(t)};un.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(W(188)):(e=Object.keys(e).join(","),Error(W(268,e)));return e=my(t),e=e===null?null:e.stateNode,e};un.flushSync=function(e){return Ts(e)};un.hydrate=function(e,t,n){if(!hu(t))throw Error(W(200));return pu(null,e,t,!0,n)};un.hydrateRoot=function(e,t,n){if(!th(e))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Kv;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Qv(t,null,e,1,n??null,s,!1,i,o),e[gr]=t.current,_o(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new fu(t)};un.render=function(e,t,n){if(!hu(t))throw Error(W(200));return pu(null,e,t,!1,n)};un.unmountComponentAtNode=function(e){if(!hu(e))throw Error(W(40));return e._reactRootContainer?(Ts(function(){pu(null,null,e,!1,function(){e._reactRootContainer=null,e[gr]=null})}),!0):!1};un.unstable_batchedUpdates=qf;un.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!hu(n))throw Error(W(200));if(e==null||e._reactInternals===void 0)throw Error(W(38));return pu(e,t,n,!1,r)};un.version="18.3.1-next-f1338f8080-20240426";function qv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qv)}catch(e){console.error(e)}}qv(),qg.exports=un;var mu=qg.exports,Gv,Wp=mu;Gv=Wp.createRoot,Wp.hydrateRoot;var zi=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Cb={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Pr,lf,Ng,kb=(Ng=class{constructor(){ue(this,Pr,Cb);ue(this,lf,!1)}setTimeoutProvider(e){Z(this,Pr,e)}setTimeout(e,t){return k(this,Pr).setTimeout(e,t)}clearTimeout(e){k(this,Pr).clearTimeout(e)}setInterval(e,t){return k(this,Pr).setInterval(e,t)}clearInterval(e){k(this,Pr).clearInterval(e)}},Pr=new WeakMap,lf=new WeakMap,Ng),ds=new kb;function Eb(e){setTimeout(e,0)}var Is=typeof window>"u"||"Deno"in globalThis;function Ot(){}function Nb(e,t){return typeof e=="function"?e(t):e}function Nd(e){return typeof e=="number"&&e>=0&&e!==1/0}function Yv(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Gr(e,t){return typeof e=="function"?e(t):e}function mn(e,t){return typeof e=="function"?e(t):e}function Hp(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(r){if(t.queryHash!==nh(o,t.options))return!1}else if(!Vo(t.queryKey,o))return!1}if(n!=="all"){const c=t.isActive();if(n==="active"&&!c||n==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function Qp(e,t){const{exact:n,status:r,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(Ls(t.options.mutationKey)!==Ls(i))return!1}else if(!Vo(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function nh(e,t){return((t==null?void 0:t.queryKeyHashFn)||Ls)(e)}function Ls(e){return JSON.stringify(e,(t,n)=>Md(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function Vo(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Vo(e[n],t[n])):!1}var Mb=Object.prototype.hasOwnProperty;function Xv(e,t){if(e===t)return e;const n=Kp(e)&&Kp(t);if(!n&&!(Md(e)&&Md(t)))return t;const s=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),o=i.length,l=n?new Array(o):{};let c=0;for(let d=0;d<o;d++){const f=n?d:i[d],p=e[f],h=t[f];if(p===h){l[f]=p,(n?d<s:Mb.call(e,f))&&c++;continue}if(p===null||h===null||typeof p!="object"||typeof h!="object"){l[f]=h;continue}const w=Xv(p,h);l[f]=w,w===p&&c++}return s===o&&c===s?e:l}function $a(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function Kp(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Md(e){if(!qp(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!qp(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function qp(e){return Object.prototype.toString.call(e)==="[object Object]"}function jb(e){return new Promise(t=>{ds.setTimeout(t,e)})}function jd(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?Xv(e,t):t}function Rb(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function Pb(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var rh=Symbol();function Jv(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===rh?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Zv(e,t){return typeof e=="function"?e(...t):!!e}function Tb(e,t,n){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=t()),r||(r=!0,s.aborted?n():s.addEventListener("abort",n,{once:!0})),s)}),e}var gs,Tr,gi,Mg,Ib=(Mg=class extends zi{constructor(){super();ue(this,gs);ue(this,Tr);ue(this,gi);Z(this,gi,t=>{if(!Is&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){k(this,Tr)||this.setEventListener(k(this,gi))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,Tr))==null||t.call(this),Z(this,Tr,void 0))}setEventListener(t){var n;Z(this,gi,t),(n=k(this,Tr))==null||n.call(this),Z(this,Tr,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){k(this,gs)!==t&&(Z(this,gs,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof k(this,gs)=="boolean"?k(this,gs):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},gs=new WeakMap,Tr=new WeakMap,gi=new WeakMap,Mg),sh=new Ib;function Rd(){let e,t;const n=new Promise((s,i)=>{e=s,t=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}var Lb=Eb;function _b(){let e=[],t=0,n=l=>{l()},r=l=>{l()},s=Lb;const i=l=>{t?e.push(l):s(()=>{n(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{r(()=>{l.forEach(c=>{n(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var ut=_b(),yi,Ir,vi,jg,Ab=(jg=class extends zi{constructor(){super();ue(this,yi,!0);ue(this,Ir);ue(this,vi);Z(this,vi,t=>{if(!Is&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){k(this,Ir)||this.setEventListener(k(this,vi))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,Ir))==null||t.call(this),Z(this,Ir,void 0))}setEventListener(t){var n;Z(this,vi,t),(n=k(this,Ir))==null||n.call(this),Z(this,Ir,t(this.setOnline.bind(this)))}setOnline(t){k(this,yi)!==t&&(Z(this,yi,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return k(this,yi)}},yi=new WeakMap,Ir=new WeakMap,vi=new WeakMap,jg),Ba=new Ab;function Fb(e){return Math.min(1e3*2**e,3e4)}function ex(e){return(e??"online")==="online"?Ba.isOnline():!0}var Pd=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function tx(e){let t=!1,n=0,r;const s=Rd(),i=()=>s.status!=="pending",o=b=>{var S;if(!i()){const y=new Pd(b);h(y),(S=e.onCancel)==null||S.call(e,y)}},l=()=>{t=!0},c=()=>{t=!1},d=()=>sh.isFocused()&&(e.networkMode==="always"||Ba.isOnline())&&e.canRun(),f=()=>ex(e.networkMode)&&e.canRun(),p=b=>{i()||(r==null||r(),s.resolve(b))},h=b=>{i()||(r==null||r(),s.reject(b))},w=()=>new Promise(b=>{var S;r=y=>{(i()||d())&&b(y)},(S=e.onPause)==null||S.call(e)}).then(()=>{var b;r=void 0,i()||(b=e.onContinue)==null||b.call(e)}),x=()=>{if(i())return;let b;const S=n===0?e.initialPromise:void 0;try{b=S??e.fn()}catch(y){b=Promise.reject(y)}Promise.resolve(b).then(p).catch(y=>{var E;if(i())return;const m=e.retry??(Is?0:3),v=e.retryDelay??Fb,g=typeof v=="function"?v(n,y):v,C=m===!0||typeof m=="number"&&n<m||typeof m=="function"&&m(n,y);if(t||!C){h(y);return}n++,(E=e.onFail)==null||E.call(e,n,y),jb(g).then(()=>d()?void 0:w()).then(()=>{t?h(y):x()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:l,continueRetry:c,canStart:f,start:()=>(f()?x():w().then(x),s)}}var ys,Rg,nx=(Rg=class{constructor(){ue(this,ys)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Nd(this.gcTime)&&Z(this,ys,ds.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Is?1/0:5*60*1e3))}clearGcTimeout(){k(this,ys)&&(ds.clearTimeout(k(this,ys)),Z(this,ys,void 0))}},ys=new WeakMap,Rg),vs,xi,pn,xs,ht,Ko,ws,Pn,rr,Pg,Ob=(Pg=class extends nx{constructor(t){super();ue(this,Pn);ue(this,vs);ue(this,xi);ue(this,pn);ue(this,xs);ue(this,ht);ue(this,Ko);ue(this,ws);Z(this,ws,!1),Z(this,Ko,t.defaultOptions),this.setOptions(t.options),this.observers=[],Z(this,xs,t.client),Z(this,pn,k(this,xs).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Z(this,vs,Yp(this.options)),this.state=t.state??k(this,vs),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=k(this,ht))==null?void 0:t.promise}setOptions(t){if(this.options={...k(this,Ko),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Yp(this.options);n.data!==void 0&&(this.setState(Gp(n.data,n.dataUpdatedAt)),Z(this,vs,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&k(this,pn).remove(this)}setData(t,n){const r=jd(this.state.data,t,this.options);return xe(this,Pn,rr).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){xe(this,Pn,rr).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=k(this,ht))==null?void 0:r.promise;return(s=k(this,ht))==null||s.cancel(t),n?n.then(Ot).catch(Ot):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(k(this,vs))}isActive(){return this.observers.some(t=>mn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===rh||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Gr(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Yv(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,ht))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,ht))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),k(this,pn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(k(this,ht)&&(k(this,ws)?k(this,ht).cancel({revert:!0}):k(this,ht).cancelRetry()),this.scheduleGc()),k(this,pn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||xe(this,Pn,rr).call(this,{type:"invalidate"})}async fetch(t,n){var c,d,f,p,h,w,x,b,S,y,m,v;if(this.state.fetchStatus!=="idle"&&((c=k(this,ht))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(k(this,ht))return k(this,ht).continueRetry(),k(this,ht).promise}if(t&&this.setOptions(t),!this.options.queryFn){const g=this.observers.find(C=>C.options.queryFn);g&&this.setOptions(g.options)}const r=new AbortController,s=g=>{Object.defineProperty(g,"signal",{enumerable:!0,get:()=>(Z(this,ws,!0),r.signal)})},i=()=>{const g=Jv(this.options,n),E=(()=>{const T={client:k(this,xs),queryKey:this.queryKey,meta:this.meta};return s(T),T})();return Z(this,ws,!1),this.options.persister?this.options.persister(g,E,this):g(E)},l=(()=>{const g={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:k(this,xs),state:this.state,fetchFn:i};return s(g),g})();(d=this.options.behavior)==null||d.onFetch(l,this),Z(this,xi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&xe(this,Pn,rr).call(this,{type:"fetch",meta:(p=l.fetchOptions)==null?void 0:p.meta}),Z(this,ht,tx({initialPromise:n==null?void 0:n.initialPromise,fn:l.fetchFn,onCancel:g=>{g instanceof Pd&&g.revert&&this.setState({...k(this,xi),fetchStatus:"idle"}),r.abort()},onFail:(g,C)=>{xe(this,Pn,rr).call(this,{type:"failed",failureCount:g,error:C})},onPause:()=>{xe(this,Pn,rr).call(this,{type:"pause"})},onContinue:()=>{xe(this,Pn,rr).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const g=await k(this,ht).start();if(g===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(g),(w=(h=k(this,pn).config).onSuccess)==null||w.call(h,g,this),(b=(x=k(this,pn).config).onSettled)==null||b.call(x,g,this.state.error,this),g}catch(g){if(g instanceof Pd){if(g.silent)return k(this,ht).promise;if(g.revert){if(this.state.data===void 0)throw g;return this.state.data}}throw xe(this,Pn,rr).call(this,{type:"error",error:g}),(y=(S=k(this,pn).config).onError)==null||y.call(S,g,this),(v=(m=k(this,pn).config).onSettled)==null||v.call(m,this.state.data,g,this),g}finally{this.scheduleGc()}}},vs=new WeakMap,xi=new WeakMap,pn=new WeakMap,xs=new WeakMap,ht=new WeakMap,Ko=new WeakMap,ws=new WeakMap,Pn=new WeakSet,rr=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...rx(r.data,this.options),fetchMeta:t.meta??null};case"success":const s={...r,...Gp(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Z(this,xi,t.manual?s:void 0),s;case"error":const i=t.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),ut.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),k(this,pn).notify({query:this,type:"updated",action:t})})},Pg);function rx(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ex(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Gp(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Yp(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var qt,Me,qo,_t,bs,wi,or,Lr,Go,bi,Si,Ss,Cs,_r,Ci,_e,fo,Td,Id,Ld,_d,Ad,Fd,Od,sx,Tg,Db=(Tg=class extends zi{constructor(t,n){super();ue(this,_e);ue(this,qt);ue(this,Me);ue(this,qo);ue(this,_t);ue(this,bs);ue(this,wi);ue(this,or);ue(this,Lr);ue(this,Go);ue(this,bi);ue(this,Si);ue(this,Ss);ue(this,Cs);ue(this,_r);ue(this,Ci,new Set);this.options=n,Z(this,qt,t),Z(this,Lr,null),Z(this,or,Rd()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(k(this,Me).addObserver(this),Xp(k(this,Me),this.options)?xe(this,_e,fo).call(this):this.updateResult(),xe(this,_e,_d).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Dd(k(this,Me),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Dd(k(this,Me),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,xe(this,_e,Ad).call(this),xe(this,_e,Fd).call(this),k(this,Me).removeObserver(this)}setOptions(t){const n=this.options,r=k(this,Me);if(this.options=k(this,qt).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof mn(this.options.enabled,k(this,Me))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");xe(this,_e,Od).call(this),k(this,Me).setOptions(this.options),n._defaulted&&!$a(this.options,n)&&k(this,qt).getQueryCache().notify({type:"observerOptionsUpdated",query:k(this,Me),observer:this});const s=this.hasListeners();s&&Jp(k(this,Me),r,this.options,n)&&xe(this,_e,fo).call(this),this.updateResult(),s&&(k(this,Me)!==r||mn(this.options.enabled,k(this,Me))!==mn(n.enabled,k(this,Me))||Gr(this.options.staleTime,k(this,Me))!==Gr(n.staleTime,k(this,Me)))&&xe(this,_e,Td).call(this);const i=xe(this,_e,Id).call(this);s&&(k(this,Me)!==r||mn(this.options.enabled,k(this,Me))!==mn(n.enabled,k(this,Me))||i!==k(this,_r))&&xe(this,_e,Ld).call(this,i)}getOptimisticResult(t){const n=k(this,qt).getQueryCache().build(k(this,qt),t),r=this.createResult(n,t);return $b(this,r)&&(Z(this,_t,r),Z(this,wi,this.options),Z(this,bs,k(this,Me).state)),r}getCurrentResult(){return k(this,_t)}trackResult(t,n){return new Proxy(t,{get:(r,s)=>(this.trackProp(s),n==null||n(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&k(this,or).status==="pending"&&k(this,or).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(t){k(this,Ci).add(t)}getCurrentQuery(){return k(this,Me)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=k(this,qt).defaultQueryOptions(t),r=k(this,qt).getQueryCache().build(k(this,qt),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return xe(this,_e,fo).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),k(this,_t)))}createResult(t,n){var I;const r=k(this,Me),s=this.options,i=k(this,_t),o=k(this,bs),l=k(this,wi),d=t!==r?t.state:k(this,qo),{state:f}=t;let p={...f},h=!1,w;if(n._optimisticResults){const j=this.hasListeners(),B=!j&&Xp(t,n),F=j&&Jp(t,r,n,s);(B||F)&&(p={...p,...rx(f.data,t.options)}),n._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:x,errorUpdatedAt:b,status:S}=p;w=p.data;let y=!1;if(n.placeholderData!==void 0&&w===void 0&&S==="pending"){let j;i!=null&&i.isPlaceholderData&&n.placeholderData===(l==null?void 0:l.placeholderData)?(j=i.data,y=!0):j=typeof n.placeholderData=="function"?n.placeholderData((I=k(this,Si))==null?void 0:I.state.data,k(this,Si)):n.placeholderData,j!==void 0&&(S="success",w=jd(i==null?void 0:i.data,j,n),h=!0)}if(n.select&&w!==void 0&&!y)if(i&&w===(o==null?void 0:o.data)&&n.select===k(this,Go))w=k(this,bi);else try{Z(this,Go,n.select),w=n.select(w),w=jd(i==null?void 0:i.data,w,n),Z(this,bi,w),Z(this,Lr,null)}catch(j){Z(this,Lr,j)}k(this,Lr)&&(x=k(this,Lr),w=k(this,bi),b=Date.now(),S="error");const m=p.fetchStatus==="fetching",v=S==="pending",g=S==="error",C=v&&m,E=w!==void 0,M={status:S,fetchStatus:p.fetchStatus,isPending:v,isSuccess:S==="success",isError:g,isInitialLoading:C,isLoading:C,data:w,dataUpdatedAt:p.dataUpdatedAt,error:x,errorUpdatedAt:b,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:m,isRefetching:m&&!v,isLoadingError:g&&!E,isPaused:p.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:g&&E,isStale:ih(t,n),refetch:this.refetch,promise:k(this,or),isEnabled:mn(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const j=Q=>{M.status==="error"?Q.reject(M.error):M.data!==void 0&&Q.resolve(M.data)},B=()=>{const Q=Z(this,or,M.promise=Rd());j(Q)},F=k(this,or);switch(F.status){case"pending":t.queryHash===r.queryHash&&j(F);break;case"fulfilled":(M.status==="error"||M.data!==F.value)&&B();break;case"rejected":(M.status!=="error"||M.error!==F.reason)&&B();break}}return M}updateResult(){const t=k(this,_t),n=this.createResult(k(this,Me),this.options);if(Z(this,bs,k(this,Me).state),Z(this,wi,this.options),k(this,bs).data!==void 0&&Z(this,Si,k(this,Me)),$a(n,t))return;Z(this,_t,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!k(this,Ci).size)return!0;const o=new Set(i??k(this,Ci));return this.options.throwOnError&&o.add("error"),Object.keys(k(this,_t)).some(l=>{const c=l;return k(this,_t)[c]!==t[c]&&o.has(c)})};xe(this,_e,sx).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&xe(this,_e,_d).call(this)}},qt=new WeakMap,Me=new WeakMap,qo=new WeakMap,_t=new WeakMap,bs=new WeakMap,wi=new WeakMap,or=new WeakMap,Lr=new WeakMap,Go=new WeakMap,bi=new WeakMap,Si=new WeakMap,Ss=new WeakMap,Cs=new WeakMap,_r=new WeakMap,Ci=new WeakMap,_e=new WeakSet,fo=function(t){xe(this,_e,Od).call(this);let n=k(this,Me).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Ot)),n},Td=function(){xe(this,_e,Ad).call(this);const t=Gr(this.options.staleTime,k(this,Me));if(Is||k(this,_t).isStale||!Nd(t))return;const r=Yv(k(this,_t).dataUpdatedAt,t)+1;Z(this,Ss,ds.setTimeout(()=>{k(this,_t).isStale||this.updateResult()},r))},Id=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(k(this,Me)):this.options.refetchInterval)??!1},Ld=function(t){xe(this,_e,Fd).call(this),Z(this,_r,t),!(Is||mn(this.options.enabled,k(this,Me))===!1||!Nd(k(this,_r))||k(this,_r)===0)&&Z(this,Cs,ds.setInterval(()=>{(this.options.refetchIntervalInBackground||sh.isFocused())&&xe(this,_e,fo).call(this)},k(this,_r)))},_d=function(){xe(this,_e,Td).call(this),xe(this,_e,Ld).call(this,xe(this,_e,Id).call(this))},Ad=function(){k(this,Ss)&&(ds.clearTimeout(k(this,Ss)),Z(this,Ss,void 0))},Fd=function(){k(this,Cs)&&(ds.clearInterval(k(this,Cs)),Z(this,Cs,void 0))},Od=function(){const t=k(this,qt).getQueryCache().build(k(this,qt),this.options);if(t===k(this,Me))return;const n=k(this,Me);Z(this,Me,t),Z(this,qo,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},sx=function(t){ut.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(k(this,_t))}),k(this,qt).getQueryCache().notify({query:k(this,Me),type:"observerResultsUpdated"})})},Tg);function zb(e,t){return mn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Xp(e,t){return zb(e,t)||e.state.data!==void 0&&Dd(e,t,t.refetchOnMount)}function Dd(e,t,n){if(mn(t.enabled,e)!==!1&&Gr(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&ih(e,t)}return!1}function Jp(e,t,n,r){return(e!==t||mn(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&ih(e,n)}function ih(e,t){return mn(t.enabled,e)!==!1&&e.isStaleByTime(Gr(t.staleTime,e))}function $b(e,t){return!$a(e.getCurrentResult(),t)}function Zp(e){return{onFetch:(t,n)=>{var f,p,h,w,x;const r=t.options,s=(h=(p=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:p.fetchMore)==null?void 0:h.direction,i=((w=t.state.data)==null?void 0:w.pages)||[],o=((x=t.state.data)==null?void 0:x.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let b=!1;const S=v=>{Tb(v,()=>t.signal,()=>b=!0)},y=Jv(t.options,t.fetchOptions),m=async(v,g,C)=>{if(b)return Promise.reject();if(g==null&&v.pages.length)return Promise.resolve(v);const T=(()=>{const B={client:t.client,queryKey:t.queryKey,pageParam:g,direction:C?"backward":"forward",meta:t.options.meta};return S(B),B})(),M=await y(T),{maxPages:I}=t.options,j=C?Pb:Rb;return{pages:j(v.pages,M,I),pageParams:j(v.pageParams,g,I)}};if(s&&i.length){const v=s==="backward",g=v?Bb:em,C={pages:i,pageParams:o},E=g(r,C);l=await m(C,E,v)}else{const v=e??i.length;do{const g=c===0?o[0]??r.initialPageParam:em(r,l);if(c>0&&g==null)break;l=await m(l,g),c++}while(c<v)}return l};t.options.persister?t.fetchFn=()=>{var b,S;return(S=(b=t.options).persister)==null?void 0:S.call(b,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=d}}}function em(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function Bb(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var Yo,Qn,At,ks,Kn,Er,Ig,Ub=(Ig=class extends nx{constructor(t){super();ue(this,Kn);ue(this,Yo);ue(this,Qn);ue(this,At);ue(this,ks);Z(this,Yo,t.client),this.mutationId=t.mutationId,Z(this,At,t.mutationCache),Z(this,Qn,[]),this.state=t.state||ix(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){k(this,Qn).includes(t)||(k(this,Qn).push(t),this.clearGcTimeout(),k(this,At).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Z(this,Qn,k(this,Qn).filter(n=>n!==t)),this.scheduleGc(),k(this,At).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){k(this,Qn).length||(this.state.status==="pending"?this.scheduleGc():k(this,At).remove(this))}continue(){var t;return((t=k(this,ks))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,c,d,f,p,h,w,x,b,S,y,m,v,g,C,E,T,M,I;const n=()=>{xe(this,Kn,Er).call(this,{type:"continue"})},r={client:k(this,Yo),meta:this.options.meta,mutationKey:this.options.mutationKey};Z(this,ks,tx({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(j,B)=>{xe(this,Kn,Er).call(this,{type:"failed",failureCount:j,error:B})},onPause:()=>{xe(this,Kn,Er).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>k(this,At).canRun(this)}));const s=this.state.status==="pending",i=!k(this,ks).canStart();try{if(s)n();else{xe(this,Kn,Er).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(o=k(this,At).config).onMutate)==null?void 0:l.call(o,t,this,r));const B=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t,r));B!==this.state.context&&xe(this,Kn,Er).call(this,{type:"pending",context:B,variables:t,isPaused:i})}const j=await k(this,ks).start();return await((p=(f=k(this,At).config).onSuccess)==null?void 0:p.call(f,j,t,this.state.context,this,r)),await((w=(h=this.options).onSuccess)==null?void 0:w.call(h,j,t,this.state.context,r)),await((b=(x=k(this,At).config).onSettled)==null?void 0:b.call(x,j,null,this.state.variables,this.state.context,this,r)),await((y=(S=this.options).onSettled)==null?void 0:y.call(S,j,null,t,this.state.context,r)),xe(this,Kn,Er).call(this,{type:"success",data:j}),j}catch(j){try{await((v=(m=k(this,At).config).onError)==null?void 0:v.call(m,j,t,this.state.context,this,r))}catch(B){Promise.reject(B)}try{await((C=(g=this.options).onError)==null?void 0:C.call(g,j,t,this.state.context,r))}catch(B){Promise.reject(B)}try{await((T=(E=k(this,At).config).onSettled)==null?void 0:T.call(E,void 0,j,this.state.variables,this.state.context,this,r))}catch(B){Promise.reject(B)}try{await((I=(M=this.options).onSettled)==null?void 0:I.call(M,void 0,j,t,this.state.context,r))}catch(B){Promise.reject(B)}throw xe(this,Kn,Er).call(this,{type:"error",error:j}),j}finally{k(this,At).runNext(this)}}},Yo=new WeakMap,Qn=new WeakMap,At=new WeakMap,ks=new WeakMap,Kn=new WeakSet,Er=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),ut.batch(()=>{k(this,Qn).forEach(r=>{r.onMutationUpdate(t)}),k(this,At).notify({mutation:this,type:"updated",action:t})})},Ig);function ix(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var lr,Tn,Xo,Lg,Vb=(Lg=class extends zi{constructor(t={}){super();ue(this,lr);ue(this,Tn);ue(this,Xo);this.config=t,Z(this,lr,new Set),Z(this,Tn,new Map),Z(this,Xo,0)}build(t,n,r){const s=new Ub({client:t,mutationCache:this,mutationId:++vl(this,Xo)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){k(this,lr).add(t);const n=Fl(t);if(typeof n=="string"){const r=k(this,Tn).get(n);r?r.push(t):k(this,Tn).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(k(this,lr).delete(t)){const n=Fl(t);if(typeof n=="string"){const r=k(this,Tn).get(n);if(r)if(r.length>1){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}else r[0]===t&&k(this,Tn).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Fl(t);if(typeof n=="string"){const r=k(this,Tn).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var r;const n=Fl(t);if(typeof n=="string"){const s=(r=k(this,Tn).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){ut.batch(()=>{k(this,lr).forEach(t=>{this.notify({type:"removed",mutation:t})}),k(this,lr).clear(),k(this,Tn).clear()})}getAll(){return Array.from(k(this,lr))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Qp(n,r))}findAll(t={}){return this.getAll().filter(n=>Qp(t,n))}notify(t){ut.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return ut.batch(()=>Promise.all(t.map(n=>n.continue().catch(Ot))))}},lr=new WeakMap,Tn=new WeakMap,Xo=new WeakMap,Lg);function Fl(e){var t;return(t=e.options.scope)==null?void 0:t.id}var ar,Ar,Gt,ur,pr,aa,zd,_g,Wb=(_g=class extends zi{constructor(n,r){super();ue(this,pr);ue(this,ar);ue(this,Ar);ue(this,Gt);ue(this,ur);Z(this,ar,n),this.setOptions(r),this.bindMethods(),xe(this,pr,aa).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var s;const r=this.options;this.options=k(this,ar).defaultMutationOptions(n),$a(this.options,r)||k(this,ar).getMutationCache().notify({type:"observerOptionsUpdated",mutation:k(this,Gt),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Ls(r.mutationKey)!==Ls(this.options.mutationKey)?this.reset():((s=k(this,Gt))==null?void 0:s.state.status)==="pending"&&k(this,Gt).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=k(this,Gt))==null||n.removeObserver(this)}onMutationUpdate(n){xe(this,pr,aa).call(this),xe(this,pr,zd).call(this,n)}getCurrentResult(){return k(this,Ar)}reset(){var n;(n=k(this,Gt))==null||n.removeObserver(this),Z(this,Gt,void 0),xe(this,pr,aa).call(this),xe(this,pr,zd).call(this)}mutate(n,r){var s;return Z(this,ur,r),(s=k(this,Gt))==null||s.removeObserver(this),Z(this,Gt,k(this,ar).getMutationCache().build(k(this,ar),this.options)),k(this,Gt).addObserver(this),k(this,Gt).execute(n)}},ar=new WeakMap,Ar=new WeakMap,Gt=new WeakMap,ur=new WeakMap,pr=new WeakSet,aa=function(){var r;const n=((r=k(this,Gt))==null?void 0:r.state)??ix();Z(this,Ar,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},zd=function(n){ut.batch(()=>{var r,s,i,o,l,c,d,f;if(k(this,ur)&&this.hasListeners()){const p=k(this,Ar).variables,h=k(this,Ar).context,w={client:k(this,ar),meta:this.options.meta,mutationKey:this.options.mutationKey};if((n==null?void 0:n.type)==="success"){try{(s=(r=k(this,ur)).onSuccess)==null||s.call(r,n.data,p,h,w)}catch(x){Promise.reject(x)}try{(o=(i=k(this,ur)).onSettled)==null||o.call(i,n.data,null,p,h,w)}catch(x){Promise.reject(x)}}else if((n==null?void 0:n.type)==="error"){try{(c=(l=k(this,ur)).onError)==null||c.call(l,n.error,p,h,w)}catch(x){Promise.reject(x)}try{(f=(d=k(this,ur)).onSettled)==null||f.call(d,void 0,n.error,p,h,w)}catch(x){Promise.reject(x)}}}this.listeners.forEach(p=>{p(k(this,Ar))})})},_g),qn,Ag,Hb=(Ag=class extends zi{constructor(t={}){super();ue(this,qn);this.config=t,Z(this,qn,new Map)}build(t,n,r){const s=n.queryKey,i=n.queryHash??nh(s,n);let o=this.get(i);return o||(o=new Ob({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){k(this,qn).has(t.queryHash)||(k(this,qn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=k(this,qn).get(t.queryHash);n&&(t.destroy(),n===t&&k(this,qn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ut.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return k(this,qn).get(t)}getAll(){return[...k(this,qn).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Hp(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>Hp(t,r)):n}notify(t){ut.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){ut.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ut.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},qn=new WeakMap,Ag),Je,Fr,Or,ki,Ei,Dr,Ni,Mi,Fg,Qb=(Fg=class{constructor(e={}){ue(this,Je);ue(this,Fr);ue(this,Or);ue(this,ki);ue(this,Ei);ue(this,Dr);ue(this,Ni);ue(this,Mi);Z(this,Je,e.queryCache||new Hb),Z(this,Fr,e.mutationCache||new Vb),Z(this,Or,e.defaultOptions||{}),Z(this,ki,new Map),Z(this,Ei,new Map),Z(this,Dr,0)}mount(){vl(this,Dr)._++,k(this,Dr)===1&&(Z(this,Ni,sh.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,Je).onFocus())})),Z(this,Mi,Ba.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,Je).onOnline())})))}unmount(){var e,t;vl(this,Dr)._--,k(this,Dr)===0&&((e=k(this,Ni))==null||e.call(this),Z(this,Ni,void 0),(t=k(this,Mi))==null||t.call(this),Z(this,Mi,void 0))}isFetching(e){return k(this,Je).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return k(this,Fr).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,Je).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=k(this,Je).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Gr(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return k(this,Je).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=k(this,Je).get(r.queryHash),i=s==null?void 0:s.state.data,o=Nb(t,i);if(o!==void 0)return k(this,Je).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return ut.batch(()=>k(this,Je).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,Je).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=k(this,Je);ut.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=k(this,Je);return ut.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=ut.batch(()=>k(this,Je).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(Ot).catch(Ot)}invalidateQueries(e,t={}){return ut.batch(()=>(k(this,Je).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=ut.batch(()=>k(this,Je).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(Ot)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Ot)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=k(this,Je).build(this,t);return n.isStaleByTime(Gr(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ot).catch(Ot)}fetchInfiniteQuery(e){return e.behavior=Zp(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ot).catch(Ot)}ensureInfiniteQueryData(e){return e.behavior=Zp(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Ba.isOnline()?k(this,Fr).resumePausedMutations():Promise.resolve()}getQueryCache(){return k(this,Je)}getMutationCache(){return k(this,Fr)}getDefaultOptions(){return k(this,Or)}setDefaultOptions(e){Z(this,Or,e)}setQueryDefaults(e,t){k(this,ki).set(Ls(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...k(this,ki).values()],n={};return t.forEach(r=>{Vo(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){k(this,Ei).set(Ls(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...k(this,Ei).values()],n={};return t.forEach(r=>{Vo(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...k(this,Or).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=nh(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===rh&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...k(this,Or).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){k(this,Je).clear(),k(this,Fr).clear()}},Je=new WeakMap,Fr=new WeakMap,Or=new WeakMap,ki=new WeakMap,Ei=new WeakMap,Dr=new WeakMap,Ni=new WeakMap,Mi=new WeakMap,Fg),ox=u.createContext(void 0),wr=e=>{const t=u.useContext(ox);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Kb=({client:e,children:t})=>(u.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(ox.Provider,{value:e,children:t})),lx=u.createContext(!1),qb=()=>u.useContext(lx);lx.Provider;function Gb(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Yb=u.createContext(Gb()),Xb=()=>u.useContext(Yb),Jb=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Zb=e=>{u.useEffect(()=>{e.clearReset()},[e])},eS=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||Zv(n,[e.error,r])),tS=e=>{if(e.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},nS=(e,t)=>e.isLoading&&e.isFetching&&!t,rS=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,tm=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function sS(e,t,n){var p,h,w,x,b;const r=qb(),s=Xb(),i=wr(),o=i.defaultQueryOptions(e);(h=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||h.call(p,o),o._optimisticResults=r?"isRestoring":"optimistic",tS(o),Jb(o,s),Zb(s);const l=!i.getQueryCache().get(o.queryHash),[c]=u.useState(()=>new t(i,o)),d=c.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(u.useSyncExternalStore(u.useCallback(S=>{const y=f?c.subscribe(ut.batchCalls(S)):Ot;return c.updateResult(),y},[c,f]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),u.useEffect(()=>{c.setOptions(o)},[o,c]),rS(o,d))throw tm(o,c,s);if(eS({result:d,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((x=(w=i.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||x.call(w,o,d),o.experimental_prefetchInRender&&!Is&&nS(d,r)){const S=l?tm(o,c,s):(b=i.getQueryCache().get(o.queryHash))==null?void 0:b.promise;S==null||S.catch(Ot).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?d:c.trackResult(d)}function rl(e,t){return sS(e,Db)}function iS(e,t){const n=wr(),[r]=u.useState(()=>new Wb(n,e));u.useEffect(()=>{r.setOptions(e)},[r,e]);const s=u.useSyncExternalStore(u.useCallback(o=>r.subscribe(ut.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=u.useCallback((o,l)=>{r.mutate(o,l).catch(Ot)},[r]);if(s.error&&Zv(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}const ax=8,oS=6;function nm(e,t,n){return n<t?t:Math.min(n,Math.max(t,e))}function ux({x:e,y:t,menuWidth:n,menuHeight:r,viewport:s,margin:i=ax}){const o=i,l=i,c=s.width-Math.max(0,n)-i,d=s.height-Math.max(0,r)-i;return{x:nm(e,o,c),y:nm(t,l,d)}}function lS({anchorRect:e,menuSize:t,viewport:n,align:r="left",margin:s=ax,sideOffset:i=oS}){const o=r==="right"?e.right-t.width:e.left,l=e.bottom+i,c=e.top-t.height-i,d=l+t.height+s<=n.height,f=c>=s;return ux({x:o,y:!d&&f?c:l,menuWidth:t.width,menuHeight:t.height,viewport:n,margin:s})}function cx(){return typeof window>"u"?{width:1024,height:768}:{width:window.innerWidth,height:window.innerHeight}}function rm(e){return e.length>0&&"options"in e[0]}function sm(){return{x:0,y:0,ready:!1}}function oh({value:e,onChange:t,options:n,placeholder:r="Select...",trigger:s,triggerClassName:i="",panelClassName:o="",align:l="left",width:c="auto",showChevron:d=!0,title:f,disabled:p=!1,"aria-label":h}){var Q,ee;const[w,x]=u.useState(!1),b=u.useRef(null),S=u.useRef(null),y=u.useRef(null),[m,v]=u.useState(sm),C=u.useCallback(()=>{const z=L=>{const R=L.find(P=>P.value===e);return R?R.label:null};if(rm(n))for(const L of n){const R=z(L.options);if(R)return R}else{const L=z(n);if(L)return L}return r},[e,n,r])(),E=((Q=b.current)==null?void 0:Q.getBoundingClientRect().width)??((ee=S.current)==null?void 0:ee.offsetWidth)??0,T=c==="trigger"?E:c==="auto"?void 0:c,M=u.useCallback(()=>{if(!w)return;const z=b.current,L=y.current;if(!z||!L)return;const R=z.getBoundingClientRect(),P=L.getBoundingClientRect(),A=T??P.width??180,O=P.height||L.scrollHeight||1,K=lS({anchorRect:R,menuSize:{width:A,height:O},viewport:cx(),align:l});v(U=>U.x===K.x&&U.y===K.y&&U.ready?U:{x:K.x,y:K.y,ready:!0})},[l,T,w]);u.useLayoutEffect(()=>{if(!w){v(sm());return}M()},[w,M,n,e]),u.useEffect(()=>{if(!w)return;const z=P=>{var O,K;const A=P.target;(O=b.current)!=null&&O.contains(A)||(K=y.current)!=null&&K.contains(A)||x(!1)},L=P=>{var A;P.key==="Escape"&&(x(!1),(A=S.current)==null||A.focus())},R=()=>M();return window.addEventListener("click",z),window.addEventListener("keydown",L),window.addEventListener("resize",R),window.addEventListener("scroll",R,!0),()=>{window.removeEventListener("click",z),window.removeEventListener("keydown",L),window.removeEventListener("resize",R),window.removeEventListener("scroll",R,!0)}},[w,M]);const I=z=>{var L;t(z),x(!1),(L=S.current)==null||L.focus()},j=z=>z.map(L=>a.jsxs("button",{className:"dropdown-item","data-active":L.value===e,disabled:L.disabled,onClick:()=>!L.disabled&&I(L.value),role:"menuitem",children:[L.icon&&a.jsx("span",{className:"shrink-0",children:L.icon}),a.jsx("span",{className:"flex-1 truncate",children:L.label}),L.value===e&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0 text-accent",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})]},L.value)),B=u.useMemo(()=>({position:"fixed",left:m.x,top:m.y,visibility:m.ready?"visible":"hidden",...T?{width:T,minWidth:T}:{}}),[T,m]),F=w?a.jsx("div",{ref:y,className:`dropdown-panel ${o}`,style:B,role:"listbox","aria-label":h,children:rm(n)?n.map((z,L)=>a.jsxs("div",{children:[z.label&&a.jsx("div",{className:"dropdown-label",children:z.label}),j(z.options),L<n.length-1&&a.jsx("div",{className:"dropdown-divider"})]},z.label||L)):j(n)}):null;return a.jsxs("div",{ref:b,className:"relative",children:[s?a.jsx("div",{onClick:()=>!p&&x(z=>!z),children:s}):a.jsxs("button",{ref:S,type:"button",className:`dropdown-trigger ${i}`,onClick:()=>x(z=>!z),disabled:p,title:f,"aria-label":h,"aria-haspopup":"listbox","aria-expanded":w,children:[a.jsx("span",{className:"truncate",children:C}),d&&a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`shrink-0 opacity-60 transition-transform ${w?"rotate-180":""}`,children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),F&&typeof document<"u"?mu.createPortal(F,document.body):F]})}const aS={offline:"sync-dot-offline",unstable:"sync-dot-unstable",recent:"sync-dot-recent",editing:"sync-dot-editing",live:"sync-dot-live"};function uS({state:e,presence:t,syncLabel:n,connectionLabel:r,lastEditedLabel:s,hasEdits:i,localTypingActive:o,recentTouches:l,isNarrow:c}){const[d,f]=u.useState(!1),[p,h]=u.useState(null),w=u.useRef(null),x=u.useRef(null),b=u.useRef(null),S=t?`${t.viewing} viewing  ${t.editing} editing`:"- viewing  - editing",y=t?String(t.viewing):"-",m=u.useCallback(()=>{b.current&&(window.clearTimeout(b.current),b.current=null)},[]),v=u.useCallback((C,E)=>{var T;E&&((T=navigator.clipboard)==null||T.writeText(E).then(()=>{h(C),m(),b.current=window.setTimeout(()=>{h(M=>M===C?null:M)},1e3)}).catch(()=>{}))},[m]),g=u.useCallback(()=>{f(!1),window.requestAnimationFrame(()=>{var C;return(C=x.current)==null?void 0:C.focus()})},[]);return u.useEffect(()=>{if(!d)return;const C=T=>{!w.current||w.current.contains(T.target)||g()},E=T=>{T.key==="Escape"&&g()};return window.addEventListener("mousedown",C),window.addEventListener("keydown",E),()=>{window.removeEventListener("mousedown",C),window.removeEventListener("keydown",E)}},[d,g]),u.useEffect(()=>()=>{m()},[m]),a.jsxs("div",{ref:w,className:"sync-indicator",children:[a.jsxs("button",{ref:x,type:"button",className:"sync-indicator-button",onClick:()=>d?g():f(!0),"aria-haspopup":"dialog","aria-expanded":d,"aria-label":"Sync status",title:S,children:[a.jsx("span",{className:`sync-indicator-dot ${aS[e]}`,"aria-hidden":"true"}),!c&&a.jsx("span",{className:"sync-indicator-count tabular-nums",children:y}),!c&&o&&a.jsx("span",{className:"sync-indicator-local",children:"typing"})]}),d&&a.jsxs("div",{role:"dialog","aria-label":"Sync status",className:"sync-indicator-card select-text",children:[a.jsx("div",{className:"sync-indicator-line sync-indicator-primary",children:n}),a.jsx("div",{className:"sync-indicator-line",children:r}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:S}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:i?`Last edited: ${s}`:"No edits yet."}),o&&a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:"Local typing in progress (saved on blur)."}),a.jsxs("div",{className:"sync-indicator-section",children:[a.jsx("div",{className:"sync-indicator-section-title",children:"Recently touched files"}),l.length>0?a.jsx("div",{className:"sync-indicator-list",children:l.map(C=>a.jsxs("div",{className:"sync-indicator-item",children:[a.jsx("button",{type:"button",className:"sync-indicator-item-name",title:`Copy filename: ${C.label}`,onClick:()=>v(C.path,C.label),children:C.label}),a.jsx("span",{className:"sync-indicator-item-time tabular-nums",children:p===C.path?"Copied":C.timeLabel})]},C.path))}):a.jsx("div",{className:"sync-indicator-empty",children:"No recent touches."})]})]})]})}const Yr={phoneMax:480,mobileMax:767,narrowMax:900,tabletMax:1024,mediumMax:1180},ua={phone:`(max-width: ${Yr.phoneMax}px)`,narrow:`(max-width: ${Yr.narrowMax}px)`,toolbarCompact:`(max-width: ${Yr.mediumMax}px)`},im=200,om=240,cS=320,dS=360,fS=420;function lm(e,t,n){return Math.min(Math.max(e,t),n)}function hS(e){return e<=Yr.tabletMax?cS:e<=Yr.mediumMax?dS:fS}function pS(e){return e<=Yr.tabletMax?360:e<=Yr.mediumMax?420:520}function mS({viewportWidth:e,leftOpen:t,rightOpen:n,leftWidth:r,rightWidth:s}){const i=hS(e);let o=t?lm(r,im,i):0,l=n?lm(s,om,i):0;const c=Math.max(0,e-pS(e));if(o+l>c){let d=o+l-c;if(l>0){const f=Math.max(0,l-om),p=Math.min(f,d);l-=p,d-=p}if(d>0&&o>0){const f=Math.max(0,o-im),p=Math.min(f,d);o-=p,d-=p}d>0&&l>0&&(l=Math.max(0,c-o)),o+l>c&&(o=Math.max(0,c-l))}return{leftWidth:Number(o.toFixed(2)),rightWidth:Number(l.toFixed(2))}}function ca(e,t=!1){const[n,r]=u.useState(t);return u.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;const s=window.matchMedia(e),i=s,o=()=>r(s.matches);if(o(),typeof s.addEventListener=="function")return s.addEventListener("change",o),()=>s.removeEventListener("change",o);if(typeof i.addListener=="function"&&typeof i.removeListener=="function")return i.addListener(o),()=>{var l;return(l=i.removeListener)==null?void 0:l.call(i,o)}},[e]),n}function dx({isRandom:e,dir:t}){return e?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),a.jsx("path",{d:"M21 3v5h-5"})]}):t==="desc"?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 5v14"}),a.jsx("path",{d:"M19 12l-7 7-7-7"})]}):a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 19V5"}),a.jsx("path",{d:"M5 12l7-7 7 7"})]})}function gS({viewerActive:e,filtersOpen:t,filtersRef:n,totalFilterCount:r,filterCount:s,starFilterList:i,starCounts:o,onToggleFilters:l,onOpenFilters:c,onToggleStar:d,onClearFilters:f,onClearStars:p}){return a.jsxs("div",{ref:n,className:`toolbar-filter relative ${e?"opacity-40 pointer-events-none":""}`,children:[a.jsxs("button",{className:`btn ${r>0?"btn-active":""}`,onClick:l,"aria-haspopup":"dialog","aria-expanded":t,title:"Filters","aria-disabled":e,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),a.jsx("span",{className:"toolbar-filters-label",children:"Filters"}),r>0&&a.jsx("span",{className:"toolbar-filters-count px-1.5 py-0.5 text-[11px] rounded-full bg-accent-strong text-text",children:r})]}),t&&a.jsxs("div",{role:"dialog","aria-label":"Filters",className:"dropdown-panel w-[240px]",style:{top:"38px",left:0},children:[a.jsx("div",{className:"dropdown-label",children:"Rating"}),a.jsxs("div",{className:"px-1",children:[[5,4,3,2,1].map(h=>{const w=i.includes(h),x=(o==null?void 0:o[String(h)])??0;return a.jsxs("button",{onClick:()=>d==null?void 0:d(h),className:`dropdown-item justify-between ${w?"bg-accent-muted":""}`,children:[a.jsxs("span",{className:w?"text-star-active":"text-text",children:["".repeat(h),"".repeat(5-h)]}),a.jsx("span",{className:"text-xs text-muted",children:x})]},h)}),a.jsxs("button",{onClick:()=>d==null?void 0:d(0),className:`dropdown-item justify-between ${i.includes(0)?"bg-accent-muted":""}`,children:[a.jsx("span",{className:"text-text",children:"Unrated"}),a.jsx("span",{className:"text-xs text-muted",children:(o==null?void 0:o["0"])??0})]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("div",{className:"dropdown-label",children:"Metrics"}),a.jsxs("button",{className:"dropdown-item",onClick:()=>{l(),c==null||c()},children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]}),a.jsx("span",{children:"Open Metrics Panel"}),(s||0)>0&&a.jsxs("span",{className:"ml-auto text-xs text-muted",children:[s," active"]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("button",{className:"dropdown-item text-muted hover:text-text",onClick:()=>{f?f():p==null||p()},disabled:r===0,children:"Clear all filters"})]})]})}function yS({viewMode:e,currentSort:t,sortOnlyOptions:n,sortDisabled:r,sortControlsDisabled:s,sortDir:i,isRandom:o,showSelectModeToggle:l,multiSelectMode:c,selectModeLabel:d,uploadBusy:f,uploadDisabled:p,onViewMode:h,onSortChange:w,onToggleSortDir:x,onToggleMultiSelectMode:b,onUploadClick:S}){return a.jsx("div",{className:"mobile-drawer",children:a.jsxs("div",{className:"mobile-drawer-row",children:[a.jsxs("div",{className:"mobile-pill-group",children:[a.jsx("button",{className:`mobile-pill ${e==="grid"?"is-active":""}`,onClick:()=>h==null?void 0:h("grid"),"aria-pressed":e==="grid",children:"Grid"}),a.jsx("button",{className:`mobile-pill ${e==="adaptive"?"is-active":""}`,onClick:()=>h==null?void 0:h("adaptive"),"aria-pressed":e==="adaptive",children:"Masonry"})]}),a.jsx(oh,{value:t,onChange:y=>w==null?void 0:w(y),options:n,"aria-label":"Sort",triggerClassName:"mobile-pill mobile-pill-dropdown",panelClassName:"mobile-drawer-panel",disabled:r}),a.jsx("button",{className:`mobile-pill mobile-pill-icon ${s?"opacity-50 cursor-not-allowed":""}`,onClick:x,title:r?"Sorting disabled":o?"Shuffle":`Sort ${i==="desc"?"descending":"ascending"}`,"aria-label":o?"Shuffle":"Toggle sort direction","aria-disabled":s,disabled:s,children:a.jsx(dx,{isRandom:o,dir:i})}),l&&a.jsx("button",{className:`mobile-pill ${c?"is-active":""}`,onClick:()=>b==null?void 0:b(),"aria-pressed":c,title:c?"Exit select mode":"Enter select mode",children:d}),S&&a.jsx("button",{className:`mobile-pill ${p||f?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!p&&!f&&S(),disabled:p||f,children:f?"Uploading":"Upload"})]})})}function vS({rootRef:e,onSearch:t,viewerActive:n,onBack:r,zoomPercent:s,onZoomPercentChange:i,currentLabel:o,itemCount:l,totalCount:c,sortSpec:d,metricKeys:f,onSortChange:p,sortDisabled:h=!1,filterCount:w,onOpenFilters:x,starFilters:b,onToggleStar:S,onClearStars:y,onClearFilters:m,starCounts:v,viewMode:g,onViewMode:C,gridItemSize:E,onGridItemSize:T,leftOpen:M,rightOpen:I,onToggleLeft:j,onToggleRight:B,onPrevImage:F,onNextImage:Q,canPrevImage:ee,canNextImage:z,searchDisabled:L=!1,searchPlaceholder:R,onUploadClick:P,uploadBusy:A=!1,uploadDisabled:O=!1,multiSelectMode:K=!1,selectedCount:U=0,onToggleMultiSelectMode:_,syncIndicator:G}){const[V,J]=u.useState(!1),[se,Y]=u.useState(!1),q=u.useRef(null),H=u.useRef(null),fe=ca(ua.narrow),Te=ca(ua.phone),we=ca(ua.toolbarCompact);u.useEffect(()=>{if(!V)return;const Ce=rt=>{q.current&&!q.current.contains(rt.target)&&J(!1)};return window.addEventListener("click",Ce),()=>window.removeEventListener("click",Ce)},[V]),u.useEffect(()=>{if(L){Y(!1);return}if(!fe||n){Y(!1);return}if(!se)return;const Ce=window.requestAnimationFrame(()=>{var rt;return(rt=H.current)==null?void 0:rt.focus()});return()=>window.cancelAnimationFrame(Ce)},[fe,se,n,L]);const he=d??{kind:"builtin",key:"added",dir:"desc"},ze=he.dir,Ue=he.kind==="builtin"&&he.key==="random",Tt=n||h,Bt=f!=null&&f.length?f.map(Ce=>({value:`metric:${Ce}`,label:Ce,disabled:h})):[],Ut=[{value:"builtin:added",label:"Date added",disabled:h},{value:"builtin:name",label:"Filename",disabled:h},{value:"builtin:random",label:"Random",disabled:h},...Bt],Dn=[{label:"Layout",options:[{value:"layout:grid",label:"Grid"},{value:"layout:masonry",label:"Masonry"}]},{label:"Sort by",options:Ut}],tn=he.kind==="metric"?`metric:${he.key}`:`builtin:${he.key}`,Cn=[{label:"Sort by",options:Ut}],Vt=fe&&!n,oe=!(!!n&&we),ge=!!n&&!Te,Ie=Vt&&!!_,Se=K?U>0?`Done (${U})`:"Done":"Select",ce=Ce=>{if(Ce.startsWith("layout:")){const rt=Ce==="layout:masonry"?"adaptive":"grid";C==null||C(rt)}else{if(h)return;p==null||p(am(Ce,he))}},Fe=()=>{!p||h||p(Ue?he:{...he,dir:ze==="desc"?"asc":"desc"})},Ge=b??[],et=Ge.length,kn=wS(w,et),gt=xS(l,c),zn=o||"Root";return a.jsxs("div",{ref:e,className:`toolbar-shell ${n?"toolbar-shell-viewer":""} ${Te?"toolbar-shell-phone":""} ${we?"toolbar-shell-compact":""} fixed top-0 left-0 right-0 h-12 grid grid-cols-[minmax(0,1fr)_minmax(0,1fr)_auto] items-center px-3 gap-3 bg-panel border-b border-border z-[var(--z-toolbar)] col-span-full row-start-1 select-none`,children:[a.jsxs("div",{className:"toolbar-left flex items-center gap-4 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope flex items-center gap-3 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope-text flex flex-col min-w-0 leading-tight",children:[a.jsx("span",{className:"toolbar-scope-label text-[10px] uppercase tracking-widest text-muted",children:"Scope"}),a.jsx("span",{className:"text-sm font-medium text-text truncate",title:zn,children:zn})]}),gt&&a.jsx("span",{className:"toolbar-count text-xs text-muted whitespace-nowrap tabular-nums",children:gt})]}),n&&a.jsxs("button",{className:"toolbar-back-btn btn btn-sm",onClick:r,title:"Back to grid",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]}),oe&&a.jsxs("div",{className:"toolbar-sort flex items-center gap-2",children:[a.jsxs("div",{className:`toolbar-sort-controls flex items-center gap-2 ${n?"opacity-40 pointer-events-none":""}`,children:[a.jsx(oh,{value:tn,onChange:ce,options:Dn,title:"Sort and layout options","aria-label":"Sort and layout",triggerClassName:"min-w-[110px]"}),a.jsx("button",{className:"toolbar-sort-dir btn btn-icon",onClick:Fe,title:h?"Sorting disabled":Ue?"Shuffle":`Sort ${ze==="desc"?"descending":"ascending"}`,"aria-label":Ue?"Shuffle":"Toggle sort direction","aria-disabled":Tt,disabled:Tt,children:a.jsx(dx,{isRandom:Ue,dir:ze})})]}),a.jsx(gS,{viewerActive:!!n,filtersOpen:V,filtersRef:q,totalFilterCount:kn,filterCount:w,starFilterList:Ge,starCounts:v,onToggleFilters:()=>J(Ce=>!Ce),onOpenFilters:x,onToggleStar:S,onClearFilters:m,onClearStars:y})]})]}),a.jsx("div",{className:"toolbar-center flex items-center gap-3 justify-center min-w-0",children:n?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"range",min:5,max:800,step:1,value:Math.round(Math.max(5,Math.min(800,s??100))),onChange:Ce=>i==null?void 0:i(Number(Ce.target.value)),className:"zoom-slider","aria-label":"Zoom level"}),a.jsxs("span",{className:"text-xs text-muted min-w-[42px] text-right",children:[Math.round(s??100),"%"]})]}):T&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-muted",children:"Size"}),a.jsx("input",{type:"range",min:80,max:500,step:10,value:E??220,onChange:Ce=>T(Number(Ce.target.value)),className:"w-28 h-1.5 bg-border rounded-full appearance-none cursor-pointer hover:bg-hover transition-colors [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-text [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-text [&::-moz-range-thumb]:border-0","aria-label":"Thumbnail size"})]})}),a.jsxs("div",{className:"toolbar-right flex items-center gap-2 justify-end",children:[ge&&a.jsxs("div",{className:"toolbar-nav flex items-center gap-1 mr-1",children:[a.jsx("button",{className:`btn btn-icon ${ee?"":"opacity-40 cursor-not-allowed"}`,title:"Previous image (A / )",onClick:()=>ee&&(F==null?void 0:F()),"aria-label":"Previous image","aria-disabled":!ee,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("button",{className:`btn btn-icon ${z?"":"opacity-40 cursor-not-allowed"}`,title:"Next image (D / )",onClick:()=>z&&(Q==null?void 0:Q()),"aria-label":"Next image","aria-disabled":!z,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 6l6 6-6 6"})})})]}),a.jsxs("div",{className:"toolbar-panels flex items-center gap-1",children:[a.jsx("button",{className:`btn btn-icon ${M?"":"opacity-50"}`,title:M?"Hide left panel (Ctrl+B)":"Show left panel (Ctrl+B)",onClick:j,"aria-pressed":M,"aria-label":"Toggle left panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"11",y:"5",width:"10",height:"14",rx:"1.5"})]})}),a.jsx("button",{className:`btn btn-icon ${I?"":"opacity-50"}`,title:I?"Hide right panel (Ctrl+Alt+B)":"Show right panel (Ctrl+Alt+B)",onClick:B,"aria-pressed":I,"aria-label":"Toggle right panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"15",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"3",y:"5",width:"10",height:"14",rx:"1.5"})]})})]}),!n&&P&&a.jsxs("button",{className:`btn ${O?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!O&&P(),"aria-label":"Upload images",title:A?"Uploading":"Upload images","aria-disabled":O||A,disabled:O||A,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M12 16V5"}),a.jsx("path",{d:"M7 10l5-5 5 5"}),a.jsx("path",{d:"M4 19h16"})]}),a.jsx("span",{children:A?"Uploading":"Upload"})]}),G&&a.jsx(uS,{...G,isNarrow:fe||we}),!n&&fe&&a.jsx("button",{className:`btn btn-icon ${se?"btn-active":""} ${L?"opacity-50 cursor-not-allowed":""}`,"aria-label":se?"Close search":"Open search",title:L?"Search disabled":se?"Close search":"Search",onClick:()=>!L&&Y(Ce=>!Ce),disabled:L,children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"11",cy:"11",r:"7"}),a.jsx("path",{d:"M21 21l-4.35-4.35"})]})}),!n&&!fe?a.jsx("div",{className:"toolbar-search toolbar-search-desktop w-[240px]",children:a.jsx("input",{ref:H,"aria-label":"Search filename, tags, notes",placeholder:L?R??"Search disabled":"Search...",onChange:Ce=>t(Ce.target.value),className:"toolbar-search-input input w-full focus:w-full transition-all duration-200 select-text",disabled:L})}):null]}),!n&&fe&&se&&!L&&a.jsx("div",{className:"toolbar-search-row",children:a.jsx("input",{ref:H,"aria-label":"Search filename, tags, notes",placeholder:R??"Search...",onChange:Ce=>t(Ce.target.value),className:"toolbar-search-input-mobile input input-lg w-full select-text"})}),Vt&&a.jsx(yS,{viewMode:g,currentSort:tn,sortOnlyOptions:Cn,sortDisabled:h,sortControlsDisabled:Tt,sortDir:ze,isRandom:Ue,showSelectModeToggle:Ie,multiSelectMode:K,selectModeLabel:Se,uploadBusy:A,uploadDisabled:O,onViewMode:C,onSortChange:Ce=>p==null?void 0:p(am(Ce,he)),onToggleSortDir:Fe,onToggleMultiSelectMode:_,onUploadClick:P})]})}function xS(e,t){if(typeof e!="number")return null;const n=e.toLocaleString();if(typeof t!="number")return`${n} items`;const r=t.toLocaleString();return t===e?`${n} items`:`${n} / ${r} items`}function wS(e,t){return typeof e=="number"?e:t>0?1:0}function am(e,t){if(e.startsWith("metric:")){const n=e.slice(7);return n?{kind:"metric",key:n,dir:t.dir}:t}if(e.startsWith("builtin:")){const n=e.slice(8);if(n==="name"||n==="added"||n==="random")return{kind:"builtin",key:n,dir:t.dir}}return t}class ln extends Error{constructor(n,r,s,i){super(r);lt(this,"status");lt(this,"url");lt(this,"body");this.name="FetchError",this.status=n,this.url=s,this.body=i}}function bS(e){const t=e.trim();return t.startsWith("{")||t.startsWith("[")}function fx(e,t,n){if(t&&typeof t=="object"){const r=t,s=typeof r.error=="string"?r.error:null,i=typeof r.message=="string"?r.message:null;if(s&&i)return`${s}: ${i}`;if(s)return s;if(i)return i}return typeof t=="string"&&t?t:`HTTP ${e} for ${n}`}function ft(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{let c=null;const d=await l.text().catch(()=>"");if(d)if((l.headers.get("content-type")||"").includes("application/json")||bS(d))try{c=JSON.parse(d)}catch{c=d}else c=d;if(!l.ok)throw new ln(l.status,fx(l.status,c,e),e,c);return c}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}function no(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{if(!l.ok){const c=await l.text().catch(()=>""),d=c||null;throw new ln(l.status,fx(l.status,d,e),e,d)}return l.blob()}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}class hx{constructor(t){lt(this,"store",new Map);lt(this,"inflight",new Map);lt(this,"totalBytes",0);this.maxBytes=t}getMaxBytes(){return this.maxBytes}getTotalBytes(){return this.totalBytes}getSize(){return this.store.size}has(t){return this.store.has(t)}isInflight(t){return this.inflight.has(t)}get(t){const n=this.store.get(t);if(n)return this.store.delete(t),this.store.set(t,n),n.blob}evictIfNeeded(t){for(;this.totalBytes+t>this.maxBytes&&this.store.size>0;){const n=this.store.keys().next().value;if(n==null)break;const r=this.store.get(n);r&&(this.totalBytes-=r.size),this.store.delete(n)}}set(t,n){const r=n.size||0;if(!(r>this.maxBytes)){if(this.store.has(t)){const s=this.store.get(t);this.totalBytes-=s.size,this.store.delete(t)}this.evictIfNeeded(r),this.store.set(t,{blob:n,size:r}),this.totalBytes+=r}}async getOrFetch(t,n){const r=this.get(t);if(r)return r;const s=this.inflight.get(t);if(s)return s.promise;const i=n(),o=typeof i=="object"&&"promise"in i,l=o?i.promise:i,c=o?i.abort:void 0,d=l.then(f=>(this.set(t,f),f)).finally(()=>{this.inflight.delete(t)});return this.inflight.set(t,{promise:d,abort:c}),d}prefetch(t,n){if(this.store.has(t)||this.inflight.has(t))return;const r=n(),s=typeof r=="object"&&"promise"in r,i=s?r.promise:r,o=s?r.abort:void 0,l=i.then(c=>(this.set(t,c),c)).catch(()=>new Blob).finally(()=>{this.inflight.delete(t)});this.inflight.set(t,{promise:l,abort:o})}cancelPrefetch(t){const n=this.inflight.get(t);if(n!=null&&n.abort)try{n.abort()}catch{}this.inflight.delete(t)}clear(){for(const[t,n]of this.inflight)if(n.abort)try{n.abort()}catch{}this.inflight.clear(),this.store.clear(),this.totalBytes=0}evictPrefix(t){const n=(()=>{const s=t?`/${t.replace(/^\/+/,"")}`:"/";return s==="/"?"/":s.replace(/\/+$/,"")})(),r=s=>{const i=s.startsWith("/")?s.replace(/\/+$/,""):`/${s.replace(/\/+$/,"")}`;return n==="/"?!0:i===n||i.startsWith(`${n}/`)};for(const[s,i]of Array.from(this.store.entries()))r(s)&&(this.totalBytes-=i.size,this.store.delete(s));for(const[s,i]of Array.from(this.inflight.entries()))if(r(s)){if(i.abort)try{i.abort()}catch{}this.inflight.delete(s)}this.totalBytes<0&&(this.totalBytes=0)}}const qs=new hx(60*1024*1024),$d=new hx(20*1024*1024),Xr={browseStart:e=>`lenslet:browse:load:start:${e}`,browseComplete:e=>`lenslet:browse:load:complete:${e}`,firstGrid:e=>`lenslet:browse:first-grid:${e}`,firstGridLatency:e=>`lenslet:browse:first-grid-latency:${e}`,firstThumb:e=>`lenslet:browse:first-thumb:${e}`,firstThumbLatency:e=>`lenslet:browse:first-thumb-latency:${e}`},He={activeRequestId:null,activeLoadStartedAtMs:null,firstGridItemLatencyMs:null,firstGridItemPath:null,firstThumbnailLatencyMs:null,firstThumbnailPath:null,requestBudget:null};function lh(){return typeof performance<"u"&&typeof performance.now=="function"?performance.now():Date.now()}function gu(e){if(!(typeof performance>"u"||typeof performance.mark!="function"))try{performance.mark(e)}catch{}}function px(e,t,n){if(!(typeof performance>"u"||typeof performance.measure!="function"))try{performance.measure(e,t,n)}catch{}}function $i(){typeof window>"u"||(window.__lensletBrowseHotpath=mx())}function mx(){return{firstGridItemLatencyMs:He.firstGridItemLatencyMs,firstGridItemPath:He.firstGridItemPath,firstThumbnailLatencyMs:He.firstThumbnailLatencyMs,firstThumbnailPath:He.firstThumbnailPath,requestBudget:He.requestBudget?{...He.requestBudget}:null}}function SS(e){He.requestBudget={...e},$i()}function CS(e){He.activeRequestId=e.requestId,He.activeLoadStartedAtMs=lh(),He.firstGridItemLatencyMs=null,He.firstGridItemPath=null,He.firstThumbnailLatencyMs=null,He.firstThumbnailPath=null,gu(Xr.browseStart(e.requestId)),$i()}function kS(e){He.activeRequestId===e&&(gu(Xr.browseComplete(e)),$i())}function ES(e){const t=He.activeRequestId,n=He.activeLoadStartedAtMs;if(t==null||n==null||He.firstGridItemLatencyMs!=null)return;const r=Math.max(0,lh()-n);He.firstGridItemLatencyMs=Math.round(r),He.firstGridItemPath=e;const s=Xr.firstGrid(t);gu(s),px(Xr.firstGridLatency(t),Xr.browseStart(t),s),$i()}function um(e){const t=He.activeRequestId,n=He.activeLoadStartedAtMs;if(t==null||n==null||He.firstThumbnailLatencyMs!=null)return;const r=Math.max(0,lh()-n);He.firstThumbnailLatencyMs=Math.round(r),He.firstThumbnailPath=e;const s=Xr.firstThumb(t);gu(s),px(Xr.firstThumbLatency(t),Xr.browseStart(t),s),$i()}$i();const NS=["folders","thumb","file"],vc={folders:2,thumb:6,file:3};let cm=1;const Lt={folders:{limit:vc.folders,inflight:new Map,queued:[],peakInflight:0},thumb:{limit:vc.thumb,inflight:new Map,queued:[],peakInflight:0},file:{limit:vc.file,inflight:new Map,queued:[],peakInflight:0}};function Ua(){if(typeof DOMException<"u")return new DOMException("request aborted","AbortError");const e=new Error("request aborted");return e.name="AbortError",e}function MS(){return{limits:{folders:Lt.folders.limit,thumb:Lt.thumb.limit,file:Lt.file.limit},inflight:{folders:Lt.folders.inflight.size,thumb:Lt.thumb.inflight.size,file:Lt.file.inflight.size},queued:{folders:Lt.folders.queued.length,thumb:Lt.thumb.queued.length,file:Lt.file.queued.length},peakInflight:{folders:Lt.folders.peakInflight,thumb:Lt.thumb.peakInflight,file:Lt.file.peakInflight},updatedAtMs:Date.now()}}function ls(){SS(MS())}function dm(e){const t=Lt[e];for(;t.inflight.size<t.limit&&t.queued.length>0;){const n=t.queued.shift();if(!n)break;n.start()}}function Ws(e,t){const n=Lt[e],r=cm;cm+=1;let s=!1,i=!1,o=null;return{promise:new Promise((d,f)=>{const p=()=>{i&&(i=!1,n.inflight.delete(r),dm(e),ls())},h=()=>{if(s||i)return;i=!0;let w;try{w=t()}catch(x){s=!0,p(),f(x);return}o={abort:w.abort,reject:f},n.inflight.set(r,o),n.peakInflight=Math.max(n.peakInflight,n.inflight.size),ls(),w.promise.then(x=>{s||(s=!0,p(),d(x))},x=>{s||(s=!0,p(),f(x))})};if(n.inflight.size<n.limit){h();return}n.queued.push({id:r,start:h,reject:f}),ls()}),abort:()=>{if(s)return;if(s=!0,i){if(n.inflight.delete(r),o!=null&&o.abort)try{o.abort()}catch{}o==null||o.reject(Ua()),dm(e),ls();return}const d=n.queued.findIndex(f=>f.id===r);if(d>=0){const[f]=n.queued.splice(d,1);f.reject(Ua()),ls()}}}}function jS(e=NS){for(const t of e){const n=Lt[t];for(const s of Array.from(n.inflight.values())){if(s.abort)try{s.abort()}catch{}s.reject(Ua())}n.inflight.clear();const r=n.queued.splice(0,n.queued.length);for(const s of r)s.reject(Ua())}ls()}ls();const xc={};function RS(){const e=xc==null?void 0:xc.VITE_API_BASE,t=typeof window<"u",n=t?window.location.origin:"http://localhost",r=t?window.location.hostname:"localhost",s=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\]|.+\.localhost)$/i.test(r);if(!e)return"";let i;try{i=new URL(e,n)}catch{return""}const o=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\])$/i.test(i.hostname);return s?i.origin:o?"":i.origin}const Ve=RS();const PS=40*1024*1024;function TS(e){return e==="viewer"||e==="compare"}function fm(e){return`${Ve}/thumb?path=${encodeURIComponent(e)}`}function hm(e){return`${Ve}/file?path=${encodeURIComponent(e)}`}const wc="lenslet.client_id",pm="lenslet.client_id.session",gx="lenslet.last_event_id",IS=1e3,LS=3e4,_S=5;let Bd=null,da=null,mm=0,hi=null,pi=0,yu=!0,Va=!1;function yx(){return typeof window<"u"&&typeof EventSource<"u"}function gm(e,t){if(!e)return null;try{return e.getItem(t)}catch{return null}}function ym(e,t,n){if(e)try{e.setItem(t,n)}catch{}}function AS(e,t){if(e)try{e.removeItem(t)}catch{}}function FS(){if(typeof navigator>"u")return"server";const e=navigator.userAgent||"",t=navigator.language||"",n=navigator.platform||"",r=typeof Intl<"u"&&Intl.DateTimeFormat().resolvedOptions().timeZone||"",s=typeof screen<"u"?`${screen.width}x${screen.height}x${screen.colorDepth}`:"";return[e,t,n,r,s].join("|")}function OS(e){let t=2166136261;for(let n=0;n<e.length;n+=1)t^=e.charCodeAt(n),t=t*16777619>>>0;return t.toString(16).padStart(8,"0")}function vm(){return typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`client_${Math.random().toString(36).slice(2,10)}_${Date.now()}`}function ro(e){return Bd=e,e}function Wa(e){if(typeof window>"u")return null;try{return e==="local"?window.localStorage:window.sessionStorage}catch{return null}}function Ai(){if(Bd)return Bd;const e=Wa("local"),t=Wa("session"),n=gm(t,pm);if(n)return ro(n);const r=gm(e,wc);if(t){const i=vm();return ym(t,pm,i),r&&AS(e,wc),ro(i)}if(r)return ro(r);if(e){const i=vm();return ym(e,wc,i),ro(i)}const s=`fp_${OS(FS())}_${Math.random().toString(36).slice(2,8)}`;return ro(s)}function vu(e="lenslet"){mm+=1;const t=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`nonce_${Math.random().toString(36).slice(2,10)}_${Date.now()}_${mm}`;return`${e}:${Ai()}:${t}`}function DS(){if(da!=null)return da;if(typeof window>"u")return null;const e=Wa("local");if(!e)return null;try{const t=e.getItem(gx);if(!t)return null;const n=Number(t);return!Number.isFinite(n)||n<=0?null:(da=n,n)}catch{return null}}function zS(e){if(!Number.isFinite(e)||e<=0||(da=e,typeof window>"u"))return;const t=Wa("local");if(t)try{t.setItem(gx,String(e))}catch{}}function $S(){if(typeof window>"u")return`${Ve}/events`;const e=new URL(`${Ve}/events`,window.location.origin),t=DS();return t!=null&&Number.isFinite(t)&&e.searchParams.set("last_event_id",String(t)),e.toString()}function BS(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}let Rn=null,vx="idle";const Ud=new Set,Vd=new Set,Wd=new Set;function mi(e){vx=e;for(const t of Vd)t(e)}function ah(e){if(Va!==e){Va=e;for(const t of Wd)t(e)}}function uh(){hi!=null&&(window.clearTimeout(hi),hi=null)}function US(){pi=0,uh()}function VS(){if(!yu||hi!=null)return;pi+=1;const e=Math.min(IS*Math.pow(2,pi-1),LS);pi>=_S?(mi("offline"),ah(!0)):mi("reconnecting"),hi=window.setTimeout(()=>{hi=null,xx()},e)}function xx(){if(!yu||!yx()||(Rn&&Rn.readyState===EventSource.CLOSED&&(Rn.close(),Rn=null),Rn))return;pi>0?mi("reconnecting"):mi("connecting");const e=new EventSource($S());Rn=e;const t=n=>r=>{const s=BS(r.data);if(!s)return;const i=r.lastEventId?Number(r.lastEventId):null,o=i!=null&&Number.isFinite(i)?i:null;o!=null&&zS(o);for(const l of Ud)l({type:n,id:o,data:s})};e.addEventListener("item-updated",t("item-updated")),e.addEventListener("metrics-updated",t("metrics-updated")),e.addEventListener("presence",t("presence")),e.onopen=()=>{US(),ah(!1),mi("live")},e.onerror=()=>{Rn===e&&(e.close(),Rn=null,VS())}}function WS(){yu=!0,yx()&&(uh(),xx())}function HS(){yu=!1,uh(),pi=0,Rn&&(Rn.close(),Rn=null),ah(!1),mi("offline")}function QS(e){return Ud.add(e),()=>{Ud.delete(e)}}function KS(e){return Vd.add(e),e(vx),()=>{Vd.delete(e)}}function qS(e){return Wd.add(e),e(Va),()=>{Wd.delete(e)}}function GS(){return Va}function YS(e){jS(e)}function XS(e,t){const n=JSON.stringify(t),r=`${Ve}${e}`;if(typeof navigator<"u"&&typeof navigator.sendBeacon=="function")try{if(navigator.sendBeacon(r,new Blob([n],{type:"application/json"})))return!0}catch{}if(typeof fetch!="function")return!1;try{return fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0}),!0}catch{return!1}}function JS(e,t,n){return XS("/presence/leave",{gallery_id:e,lease_id:t,client_id:n??Ai()})}function Ol(e){return e??Ai()}function Dl(e,t){return ft(`${Ve}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).promise}function xm(e,t){const n=new URLSearchParams({path:e});return t!=null&&t.recursive&&n.set("recursive","1"),t!=null&&t.countOnly&&n.set("count_only","1"),n.toString()}const pe={getFolder:(e,t)=>Ws("folders",()=>ft(`${Ve}/folders?${xm(e,t)}`)).promise,getFolderCount:e=>Ws("folders",()=>ft(`${Ve}/folders?${xm(e,{recursive:!0,countOnly:!0})}`)).promise,search:(e,t)=>{const n=new URLSearchParams;return e&&n.set("q",e),t&&n.set("path",t),ft(`${Ve}/search?${n}`).promise},getEmbeddings:()=>ft(`${Ve}/embeddings`).promise,searchEmbeddings:e=>ft(`${Ve}/embeddings/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,refreshFolder:e=>{const t=new URLSearchParams({path:e});return ft(`${Ve}/refresh?${t}`,{method:"POST"}).promise},getSidecar:e=>ft(`${Ve}/item?path=${encodeURIComponent(e)}`).promise,patchSidecar:(e,t,n)=>{const s={"Content-Type":"application/json","Idempotency-Key":(n==null?void 0:n.idempotencyKey)??vu("patch"),"x-client-id":Ai(),"x-updated-by":"web"};return(n==null?void 0:n.ifMatch)!=null&&(s["If-Match"]=String(n.ifMatch)),ft(`${Ve}/item?path=${encodeURIComponent(e)}`,{method:"PATCH",headers:s,body:JSON.stringify(t)}).promise},getMetadata:e=>ft(`${Ve}/metadata?path=${encodeURIComponent(e)}`).promise,putSidecar:(e,t)=>ft(`${Ve}/item?path=${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json","x-client-id":Ai(),"x-updated-by":"web"},body:JSON.stringify(t)}).promise,getHealth:()=>ft(`${Ve}/health`).promise,joinPresence:(e,t,n)=>Dl("/presence/join",{gallery_id:e,client_id:Ol(n),lease_id:t}),movePresence:(e,t,n,r)=>Dl("/presence/move",{from_gallery_id:e,to_gallery_id:t,client_id:Ol(r),lease_id:n}),leavePresence:(e,t,n)=>Dl("/presence/leave",{gallery_id:e,client_id:Ol(n),lease_id:t}),postPresence:(e,t,n)=>Dl("/presence",{gallery_id:e,client_id:Ol(n),lease_id:t}),getThumb:e=>$d.getOrFetch(e,()=>Ws("thumb",()=>no(fm(e)))),prefetchThumb:e=>{$d.prefetch(e,()=>Ws("thumb",()=>no(fm(e))))},getFile:e=>qs.getOrFetch(e,()=>Ws("file",()=>no(hm(e)))),exportComparison:e=>no(`${Ve}/export-comparison`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,prefetchFile:async(e,t)=>{if(TS(t)&&!(qs.has(e)||qs.isInflight(e)))try{const n=await Ws("file",()=>no(hm(e),{headers:{"x-lenslet-prefetch":t}})).promise;n.size<=PS&&qs.set(e,n)}catch{}},cancelPrefetch:e=>{qs.cancelPrefetch(e)},uploadFile:async(e,t)=>{const n=new FormData;return n.append("dest",e),n.append("file",t),ft(`${Ve}/file`,{method:"POST",body:n,timeoutMs:6e4}).promise},moveFile:async(e,t)=>{const n=new FormData;return n.append("src",e),n.append("dest",t),ft(`${Ve}/move`,{method:"POST",body:n}).promise},deleteFiles:async e=>ft(`${Ve}/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paths:e})}).promise,exportIntent:async e=>{const t=new FormData;return t.append("path",e),ft(`${Ve}/export-intent`,{method:"POST",body:t}).promise},getViews:()=>ft(`${Ve}/views`).promise,saveViews:e=>ft(`${Ve}/views`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise};class ZS{constructor(t=400){lt(this,"cache",new Map);lt(this,"maxSize");this.maxSize=t,typeof window<"u"&&window.addEventListener("beforeunload",()=>this.clear(),{once:!0})}get(t){const n=this.cache.get(t);return n&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){for(this.cache.has(t)&&this.cache.delete(t);this.cache.size>=this.maxSize;){const r=this.cache.keys().next().value;if(r===void 0)break;const s=this.cache.get(r);if(this.cache.delete(r),s)try{URL.revokeObjectURL(s)}catch{}}this.cache.set(t,n)}clear(){for(const t of this.cache.values())try{URL.revokeObjectURL(t)}catch{}this.cache.clear()}}const bc=new ZS(400);function eC({path:e,name:t,onClick:n,selected:r,highlighted:s,highlightKey:i,displayW:o,displayH:l,ioRoot:c,isScrolling:d,priority:f}){const p=u.useRef(null),[h,w]=u.useState(()=>bc.get(e)??null),[x,b]=u.useState(!1),[S,y]=u.useState(()=>!!h);u.useEffect(()=>{const v=p.current;if(!v)return;const g=new IntersectionObserver(C=>{for(const E of C)E.target===v&&b(E.isIntersecting||E.intersectionRatio>0)},{root:c??null,rootMargin:"200px 0px",threshold:.01});return g.observe(v),()=>{g.unobserve(v),g.disconnect()}},[c]),u.useEffect(()=>{if(h||!(x&&!d||f))return;let v=!0;return pe.getThumb(e).then(g=>{if(!v)return;const C=URL.createObjectURL(g);bc.set(e,C),w(C)}).catch(()=>{}),()=>{v=!1}},[e,h,x,d,f]),u.useEffect(()=>{var g;if(!h){y(!1);return}const v=(g=p.current)==null?void 0:g.querySelector("img");v&&v.complete&&v.naturalWidth>0?(y(!0),um(e)):y(!1)},[h]),u.useEffect(()=>{w(bc.get(e)??null)},[e]);const m=["absolute inset-0 relative bg-hover border border-border rounded-lg overflow-hidden select-none",r?"outline-2 outline-accent":"",s?"thumb-updated-ring":"","hover:outline hover:outline-1 hover:outline-accent"].filter(Boolean).join(" ");return a.jsx("div",{ref:p,"data-highlight-key":i??void 0,className:m,onClick:n,children:h?a.jsx("img",{className:`w-full h-full object-cover block pointer-events-none select-none opacity-0 transition-opacity duration-[160ms] ${S?"opacity-100":""}`,src:h,alt:t,loading:"lazy",decoding:"async",onLoad:()=>{y(!0),um(e)},width:o?Math.round(o):void 0,height:l?Math.round(l):void 0}):null})}function Hs(e,t,n){let r=n.initialDeps??[],s,i=!0;function o(){var l,c,d;let f;n.key&&((l=n.debug)!=null&&l.call(n))&&(f=Date.now());const p=e();if(!(p.length!==r.length||p.some((x,b)=>r[b]!==x)))return s;r=p;let w;if(n.key&&((c=n.debug)!=null&&c.call(n))&&(w=Date.now()),s=t(...p),n.key&&((d=n.debug)!=null&&d.call(n))){const x=Math.round((Date.now()-f)*100)/100,b=Math.round((Date.now()-w)*100)/100,S=b/16,y=(m,v)=>{for(m=String(m);m.length<v;)m=" "+m;return m};console.info(`%c ${y(b,5)} /${y(x,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*S,120))}deg 100% 31%);`,n==null?void 0:n.key)}return n!=null&&n.onChange&&!(i&&n.skipInitialOnChange)&&n.onChange(s),i=!1,s}return o.updateDeps=l=>{r=l},o}function wm(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const tC=(e,t)=>Math.abs(e-t)<1.01,nC=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},bm=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},rC=e=>e,sC=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},iC=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=o=>{const{width:l,height:c}=o;t({width:Math.round(l),height:Math.round(c)})};if(s(bm(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(o=>{const l=()=>{const c=o[0];if(c!=null&&c.borderBoxSize){const d=c.borderBoxSize[0];if(d){s({width:d.inlineSize,height:d.blockSize});return}}s(bm(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},Sm={passive:!0},Cm=typeof window>"u"?!0:"onscrollend"in window,oC=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&Cm?()=>{}:nC(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),o=f=>()=>{const{horizontal:p,isRtl:h}=e.options;s=p?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,f)},l=o(!0),c=o(!1);c(),n.addEventListener("scroll",l,Sm);const d=e.options.useScrollendEvent&&Cm;return d&&n.addEventListener("scrollend",c,Sm),()=>{n.removeEventListener("scroll",l),d&&n.removeEventListener("scrollend",c)}},lC=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},aC=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const o=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class uC{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:rC,rangeExtractor:sC,onChange:()=>{},measureElement:lC,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=Hs(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let o=r-1;o>=0;o--){const l=n[o];if(s.has(l.lane))continue;const c=i.get(l.lane);if(c==null||l.end>c.end?i.set(l.lane,l):l.end<c.end&&s.set(l.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=Hs(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(n,r,s,i,o,l)=>(this.prevLanes!==void 0&&this.prevLanes!==l&&(this.lanesChangedFlag=!0),this.prevLanes=l,this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=Hs(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l},c)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>n)for(const h of this.laneAssignments.keys())h>=n&&this.laneAssignments.delete(h);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(h=>{this.itemSizeCache.set(h.key,h.size)}));const d=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===n&&(this.lanesSettling=!1);const f=this.measurementsCache.slice(0,d),p=new Array(l).fill(void 0);for(let h=0;h<d;h++){const w=f[h];w&&(p[w.lane]=h)}for(let h=d;h<n;h++){const w=i(h),x=this.laneAssignments.get(h);let b,S;if(x!==void 0&&this.options.lanes>1){b=x;const g=p[b],C=g!==void 0?f[g]:void 0;S=C?C.end+this.options.gap:r+s}else{const g=this.options.lanes===1?f[h-1]:this.getFurthestMeasurement(f,h);S=g?g.end+this.options.gap:r+s,b=g?g.lane:h%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(h,b)}const y=c.get(w),m=typeof y=="number"?y:this.options.estimateSize(h),v=S+m;f[h]={index:h,start:S,size:m,end:v,key:w,lane:b},p[b]=h}return this.measurementsCache=f,f},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Hs(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?cC({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=Hs(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,o)=>i===null||o===null?[]:n({startIndex:i,endIndex:o,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==n&&(l&&this.observer.unobserve(l),this.observer.observe(n),this.elementsCache.set(o,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,o=r-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,o,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=Hs(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,o=n.length;i<o;i++){const l=n[i],c=r[l];s.push(c)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return wm(r[wx(0,r.length-1,s=>wm(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),o=this.getScrollOffset();r==="auto"&&(r=n>=o+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),o=this.getScrollOffset();if(r==="auto")if(s.end>=o+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=o+this.options.scrollPaddingStart)r="start";else return[o,r];const l=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),n=Math.max(0,Math.min(n,this.options.count-1));let i=0;const o=10,l=d=>{if(!this.targetWindow)return;const f=this.getOffsetForIndex(n,d);if(!f){console.warn("Failed to get offset for index:",n);return}const[p,h]=f;this._scrollToOffset(p,{adjustments:void 0,behavior:s}),this.targetWindow.requestAnimationFrame(()=>{const w=this.getScrollOffset(),x=this.getOffsetForIndex(n,h);if(!x){console.warn("Failed to get offset for index:",n);return}tC(x[0],w)||c(h)})},c=d=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(d)):console.warn(`Failed to scroll to index ${n} after ${o} attempts.`))};l(r)},this.scrollBy=(n,{behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=r.length-1;for(;o>=0&&i.some(l=>l===null);){const l=r[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}s=Math.max(...i.filter(l=>l!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(t)}}const wx=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function cC({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=c=>e[c].start;if(e.length<=r)return{startIndex:0,endIndex:s};let o=wx(0,s,i,n),l=o;if(r===1)for(;l<s&&e[l].end<n+t;)l++;else if(r>1){const c=Array(r).fill(0);for(;l<s&&c.some(f=>f<n+t);){const f=e[l];c[f.lane]=f.end,l++}const d=Array(r).fill(n+t);for(;o>=0&&d.some(f=>f>=n);){const f=e[o];d[f.lane]=f.start,o--}o=Math.max(0,o-o%r),l=Math.min(s,l+(r-1-l%r))}return{startIndex:o,endIndex:l}}const km=typeof document<"u"?u.useLayoutEffect:u.useEffect;function dC(e){const t=u.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var o;i?mu.flushSync(t):t(),(o=e.onChange)==null||o.call(e,s,i)}},[r]=u.useState(()=>new uC(n));return r.setOptions(n),km(()=>r._didMount(),[]),km(()=>r._willUpdate()),r}function fC(e){return dC({observeElementRect:iC,observeElementOffset:oC,scrollToFn:aC,...e})}function hC({containerW:e,gap:t,targetCell:n,aspect:r,captionH:s}){const i=Math.max(1,Math.floor((e+t)/(n+t))),o=(e-t*(i-1))/i,l=o*r.h/r.w,c=l+s+t;return{columns:i,cellW:o,mediaH:l,rowH:c}}const pC=1.333;function mC({items:e,containerWidth:t,targetHeight:n,gap:r,captionH:s}){if(t<=0)return[];const i=[];let o=[],l=0;const c=(d,f)=>({index:i.length,height:f+s+r,imageH:f,items:d.map(p=>({item:p.item,displayW:p.aspect*f,displayH:f,originalIndex:p.originalIndex}))});for(let d=0;d<e.length;d++){const f=e[d],p=f.w>0&&f.h>0?f.w/f.h:pC;o.push({item:f,aspect:p,originalIndex:d}),l+=p;const h=(o.length-1)*r;if(l*n+h>=t){const x=(t-h)/l;i.push(c(o,x)),o=[],l=0}}return o.length>0&&i.push(c(o,n)),i}function gC(e,t,n){return{mode:"adaptive",rows:mC({items:t,containerWidth:e,targetHeight:n.targetCell,gap:n.gap,captionH:n.captionH})}}function yC(e,t,n){const{columns:r,cellW:s,mediaH:i,rowH:o}=hC({containerW:e,gap:n.gap,targetCell:n.targetCell,aspect:n.aspect,captionH:n.captionH}),l=Math.ceil(t.length/Math.max(1,r));return{mode:"grid",columns:r,cellW:s,mediaH:i,rowH:o,rowCount:l}}function vC(e,t,n){const[r,s]=u.useState(0);u.useLayoutEffect(()=>{const c=e.current;if(!c)return;const d=()=>{const p=getComputedStyle(c),h=c.clientWidth-parseFloat(p.paddingLeft)-parseFloat(p.paddingRight);s(h)},f=new ResizeObserver(d);return f.observe(c),d(),()=>f.disconnect()},[]);const i=u.useMemo(()=>n.viewMode==="adaptive"?gC(r,t,n):yC(r,t,n),[r,t,n.viewMode,n.gap,n.targetCell,n.aspect.w,n.aspect.h,n.captionH]),o=fC({count:i.mode==="adaptive"?i.rows.length:i.rowCount,getScrollElement:()=>e.current,estimateSize:c=>i.mode==="adaptive"?i.rows[c].height:i.rowH,overscan:8}),l=o.getVirtualItems();return u.useEffect(()=>{o.measure()},[i,o]),{width:r,layout:i,rowVirtualizer:o,virtualRows:l}}function xC(e,t,n,r){if(!e.length)return null;const s=n?e.findIndex(l=>l.path===n):0,i=Math.max(1,t);let o=s;if(r.key==="ArrowRight"||r.key==="d")o=Math.min(e.length-1,s+1);else if(r.key==="ArrowLeft"||r.key==="a")o=Math.max(0,s-1);else if(r.key==="ArrowDown"||r.key==="s")o=Math.min(e.length-1,s+i);else if(r.key==="ArrowUp"||r.key==="w")o=Math.max(0,s-i);else return r.key==="Enter"&&n?"open":null;return o}function wC(e,t,n){if(e.length===0)return[];const r=Array.from(new Set(e.map(d=>d.index))).sort((d,f)=>d-f),s=r[0],i=r[r.length-1],o=t.mode==="adaptive"?Math.max(0,t.rows.length-1):Math.max(0,Math.ceil(n.length/Math.max(1,t.columns))-1),l=[s-1,i+1].filter(d=>d>=0&&d<=o);if(l.length===0)return[];const c=[];for(const d of l){if(t.mode==="adaptive"){const h=t.rows[d];if(!h)continue;for(const w of h.items)c.push(w.item.path);continue}const f=d*t.columns,p=n.slice(f,f+t.columns);for(const h of p)c.push(h.path)}return Array.from(new Set(c))}function bC(e,t){var s,i;let n=0,r=e.length-1;for(;n<=r;){const o=n+r>>1,l=e[o],c=((s=l.items[0])==null?void 0:s.originalIndex)??-1,d=((i=l.items[l.items.length-1])==null?void 0:i.originalIndex)??-1;if(t>=c&&t<=d)return o;t<c?r=o-1:n=o+1}return 0}function SC(e,t,n){const r=new Set;for(const s of n){if(t.mode==="adaptive"){const l=t.rows[s.index];if(!l)continue;for(const c of l.items)r.add(c.item.path);continue}const i=s.index*t.columns,o=Math.min(e.length,i+t.columns);for(let l=i;l<o;l+=1){const c=e[l];c&&r.add(c.path)}}return r}function CC(e,t,n,r){var o,l,c;const s=kC(n,r);if(!s)return null;if(t.mode==="adaptive")return((l=(o=t.rows[s.index])==null?void 0:o.items[0])==null?void 0:l.item.path)??null;const i=s.index*t.columns;return((c=e[i])==null?void 0:c.path)??null}function kC(e,t){if(e.length===0)return null;const n=Math.max(0,t);for(const r of e){const s=r.start??0;if((r.end??s+(r.size??0))>n)return r}return e[0]}function EC({selectionToken:e,appliedSelectionToken:t,selectedPath:n,topAnchorToken:r,appliedTopAnchorToken:s,topAnchorPath:i,hasPath:o}){const l=e??0;if(l>0&&l!==t&&n&&o(n))return{source:"selection",path:n,token:l};const c=r??0;return c>0&&c!==s&&i&&o(i)?{source:"top-anchor",path:i,token:c}:null}function NC({path:e,pathToIndex:t,layout:n,adaptiveRowMeta:r}){var o;const s=t.get(e);if(s==null||s<0)return null;const i=n.mode==="grid"?Math.floor(s/Math.max(1,n.columns)):bC(n.rows,s);return n.mode==="grid"?i*n.rowH:((o=r==null?void 0:r[i])==null?void 0:o.start)??0}const MC=500,jC=450,RC=600,PC=8;function TC(e){return Math.max(jC,Math.min(RC,e))}class IC{constructor(t){lt(this,"delayMs");lt(this,"moveTolerancePx");lt(this,"onLongPress");lt(this,"onCancel");lt(this,"timerId",null);lt(this,"activePointerId",null);lt(this,"startX",0);lt(this,"startY",0);lt(this,"lastEvent",null);lt(this,"fired",!1);this.delayMs=TC(t.delayMs??MC),this.moveTolerancePx=Math.max(0,t.moveTolerancePx??PC),this.onLongPress=t.onLongPress,this.onCancel=t.onCancel}pointerDown(t){return(t.pointerType??"mouse")==="mouse"?!1:t.isPrimary===!1?(this.cancel("multitouch"),!1):this.activePointerId!=null&&this.activePointerId!==t.pointerId?(this.cancel("multitouch"),!1):(this.activePointerId=t.pointerId,this.startX=t.clientX,this.startY=t.clientY,this.lastEvent=t,this.fired=!1,this.clearTimer(),this.timerId=setTimeout(()=>{this.activePointerId==null||this.fired||this.lastEvent==null||(this.fired=!0,this.clearTimer(),this.onLongPress(this.lastEvent))},this.delayMs),!0)}pointerMove(t){if(!this.matchesPointer(t.pointerId)||this.fired)return;this.lastEvent=t;const n=t.clientX-this.startX,r=t.clientY-this.startY;Math.hypot(n,r)>this.moveTolerancePx&&this.cancel("movement")}pointerUp(t){if(!(t!=null&&!this.matchesPointer(t))){if(!this.fired){this.cancel("pointerup");return}this.reset()}}pointerCancel(t){t!=null&&!this.matchesPointer(t)||this.cancel("pointercancel")}cancelFromScroll(){this.cancel("scroll")}destroy(){this.cancel("cleanup")}matchesPointer(t){return this.activePointerId!=null&&this.activePointerId===t}clearTimer(){this.timerId!=null&&(clearTimeout(this.timerId),this.timerId=null)}reset(){this.clearTimer(),this.activePointerId=null,this.lastEvent=null,this.fired=!1}cancel(t){var r;const n=this.timerId!=null&&!this.fired&&t!=="cleanup";this.reset(),n&&((r=this.onCancel)==null||r.call(this,t))}}function LC(e){return e==="touch"||e==="pen"}function _C(e){return e.multiSelectMode||e.isShift||e.isToggle||!LC(e.pointerType)?!1:e.selectedPaths.length===1&&e.selectedPaths[0]===e.path}function Em(e,t){return e.includes(t)?e.filter(n=>n!==t):[...e,t]}const nr=12,AC=44,FC={w:4,h:3},OC=350,DC=120;function zC(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Nm(e){return{pointerId:e.pointerId,pointerType:e.pointerType,clientX:e.clientX,clientY:e.clientY,isPrimary:e.isPrimary}}function $C(e,t){const n=(t??"").trim();if(!n)return e;const r=e.toLowerCase().indexOf(n.toLowerCase());if(r===-1)return e;const s=e.slice(0,r),i=e.slice(r,r+n.length),o=e.slice(r+n.length);return a.jsxs(a.Fragment,{children:[s,a.jsx("mark",{className:"bg-accent/20 text-inherit rounded px-0.5",children:i}),o]})}function BC({items:e,selected:t,restoreToSelectionToken:n,restoreToTopAnchorToken:r,restoreToTopAnchorPath:s,multiSelectMode:i=!1,onSelectionChange:o,onOpenViewer:l,onContextMenuItem:c,onOpenItemActions:d,highlight:f,recentlyUpdated:p,onVisiblePathsChange:h,onTopAnchorPathChange:w,suppressSelectionHighlight:x=!1,viewMode:b="grid",targetCellSize:S=220,scrollRef:y,hideScrollbar:m=!1,isLoading:v=!1}){const[g,C]=u.useState(null),[E,T]=u.useState(null),[M,I]=u.useState(!1),[j,B]=u.useState(null),[F,Q]=u.useState(null),ee=u.useRef(null),z=u.useRef(null),L=u.useRef(null),R=y??L,P=u.useRef(null),A=u.useRef(0),O=u.useRef(0),K=u.useRef(new Set),U=u.useRef(null),_=u.useRef(null),G=u.useRef(null),V=u.useRef(null),J=u.useRef(null),se=u.useRef({path:null,pointerType:null}),Y=S,{width:q,layout:H,rowVirtualizer:fe,virtualRows:Te}=vC(R,e,{gap:nr,targetCell:Y,aspect:FC,captionH:AC,viewMode:b}),we=u.useMemo(()=>{const D=new Map;for(let X=0;X<e.length;X++)D.set(e[X].path,X);return D},[e]),he=u.useMemo(()=>{if(H.mode!=="adaptive")return null;const D=new Map;return H.rows.forEach((X,ae)=>{let ye=0;X.items.forEach((be,Ee)=>{const ie=ye+be.displayW/2;D.set(be.item.path,{row:ae,center:ie,order:Ee}),ye+=be.displayW+nr})}),D},[H]);u.useEffect(()=>{if(!t.length)return;const D=t[0];j!==D&&B(D)},[t,j]);const ze=u.useMemo(()=>{if(H.mode!=="adaptive")return null;let D=0;return H.rows.map(X=>{const ae=D;return D+=X.height,{start:ae,height:X.height}})},[H]),Ue=u.useRef(null),Tt=(D,X)=>{try{if(Ue.current!=null){try{cancelAnimationFrame(Ue.current)}catch{}Ue.current=null}const ae=D.scrollTop,ye=X-ae;if(Math.abs(ye)<1){D.scrollTop=X;return}const be=140,Ee=performance.now(),ie=me=>1-Math.pow(1-me,3),Ne=me=>{const it=Math.min(1,(me-Ee)/be),Oe=ie(it);D.scrollTop=ae+ye*Oe,it<1?Ue.current=requestAnimationFrame(Ne):Ue.current=null};Ue.current=requestAnimationFrame(Ne)}catch{D.scrollTop=X}},[Bt,Ut]=u.useState(!1);u.useEffect(()=>{const D=R.current;if(!D)return;let X=0;const ae=()=>{var ye;(ye=_.current)==null||ye.cancelFromScroll(),Ut(!0),window.clearTimeout(X),X=window.setTimeout(()=>Ut(!1),DC)};return D.addEventListener("scroll",ae,{passive:!0}),()=>D.removeEventListener("scroll",ae)},[]),u.useEffect(()=>{const D=new IC({onLongPress:X=>{const ae=G.current;if(!ae||!d)return;const ye=V.current??{x:X.clientX,y:X.clientY};d(ae,ye),J.current={path:ae,untilMs:Date.now()+700}}});return _.current=D,()=>{D.destroy(),_.current===D&&(_.current=null)}},[d]);const Dn=()=>{z.current!=null&&(window.clearTimeout(z.current),z.current=null)},tn=()=>{if(Dn(),I(!1),C(null),ee.current){try{URL.revokeObjectURL(ee.current)}catch{}ee.current=null}T(null)},Cn=D=>{Bt||(Dn(),C(D),I(!1),z.current=window.setTimeout(async()=>{z.current=null;try{const X=await pe.getFile(D),ae=URL.createObjectURL(X);if(ee.current)try{URL.revokeObjectURL(ee.current)}catch{}ee.current=ae,T(ae),I(!0)}catch{}},OC))},Vt=H.mode==="grid"?H.columns:Math.max(1,Math.floor(q/(Y+nr))),le=(D,X)=>{if(H.mode!=="adaptive")return null;const ae=H.rows[D];if(!ae)return null;let ye=0,be=null;for(const Ee of ae.items){const ie=ye+Ee.displayW/2,Ne=Math.abs(ie-X);(!be||Ne<be.dist)&&(be={path:Ee.item.path,dist:Ne}),ye+=Ee.displayW+nr}return be?be.path:null},oe=(D,X)=>{var Oe,yt,Ht,En;if(!e.length)return null;const ae=D??e[0].path;if(H.mode!=="adaptive"){const fn=xC(e,Vt,ae,X);return fn==="open"||fn==null?fn:((Oe=e[fn])==null?void 0:Oe.path)??null}const ye=he==null?void 0:he.get(ae);if(!ye)return ae;const be=we.get(ae)??0,Ee=X.key;if(Ee==="Enter")return"open";if(Ee==="ArrowRight"||Ee==="d")return((yt=e[Math.min(e.length-1,be+1)])==null?void 0:yt.path)??ae;if(Ee==="ArrowLeft"||Ee==="a")return((Ht=e[Math.max(0,be-1)])==null?void 0:Ht.path)??ae;const ie=Ee==="ArrowDown"||Ee==="s"?1:Ee==="ArrowUp"||Ee==="w"?-1:0;if(ie===0)return null;const Ne=ye.row+ie;if(Ne<0||Ne>=(((En=H.rows)==null?void 0:En.length)??0))return ae;const me=ye.center;return le(Ne,me)??ae},ge=D=>{var X;try{(X=document.getElementById(`cell-${encodeURIComponent(D)}`))==null||X.focus()}catch{}},Ie=u.useCallback(D=>{try{pe.prefetchThumb(D)}catch{}},[]),Se=u.useCallback((D,X)=>{d==null||d(D,X)},[d]),ce=()=>{G.current=null,V.current=null},Fe=(D,X)=>{var ae;X.target.closest("[data-grid-action]")||(se.current={path:D,pointerType:X.pointerType},!i&&(G.current=D,V.current={x:X.clientX,y:X.clientY},(ae=_.current)==null||ae.pointerDown(Nm(X))))},Ge=D=>{var X;i||(V.current={x:D.clientX,y:D.clientY},(X=_.current)==null||X.pointerMove(Nm(D)))},et=D=>{var X;i||((X=_.current)==null||X.pointerUp(D.pointerId),ce())},kn=D=>{var X;i||((X=_.current)==null||X.pointerCancel(D.pointerId),ce())},gt=(D,X)=>{const ae=J.current;if(ae&&ae.path===D&&ae.untilMs>Date.now()){J.current=null,ge(D);return}ae&&ae.untilMs<=Date.now()&&(J.current=null),B(D),Q(D);const ye=!!X.shiftKey,be=!!(X.ctrlKey||X.metaKey);if(i)o(Em(t,D)),P.current=D;else if(_C({pointerType:se.current.path===D?se.current.pointerType:null,multiSelectMode:i,isShift:ye,isToggle:be,selectedPaths:t,path:D}))o([D]),P.current=D,l(D);else if(ye){const Ee=P.current??j??t[0]??D,ie=we.get(Ee)??e.findIndex(me=>me.path===Ee),Ne=we.get(D)??e.findIndex(me=>me.path===D);if(ie!==-1&&Ne!==-1){const me=Math.min(ie,Ne),it=Math.max(ie,Ne),Oe=e.slice(me,it+1).map(yt=>yt.path);if(be){const yt=new Set(t);for(const Ht of Oe)yt.add(Ht);o(Array.from(yt))}else o(Oe)}else o([D])}else be?(o(Em(t,D)),P.current=D):(o([D]),P.current=D);Bt||Ie(D),ge(D)},zn=(D,X)=>{var ae,ye;try{const be=Ce.has(D)&&t.length>0?t:[D];(ae=X.dataTransfer)==null||ae.setData("application/x-lenslet-paths",JSON.stringify(be)),X.dataTransfer&&(X.dataTransfer.effectAllowed="copyMove");try{document.body.classList.add("drag-active")}catch{}const ie=X.currentTarget.querySelector(".cell-content img"),Ne=document.createElement("div");Ne.className="drag-ghost";const me=document.createElement("img");me.draggable=!1,me.alt="drag",ie&&ie.src&&(me.src=ie.src),Ne.appendChild(me),document.body.appendChild(Ne);const it=Ne.getBoundingClientRect().width||150;(ye=X.dataTransfer)==null||ye.setDragImage(Ne,Math.round(it/2),0);const Oe=()=>{try{Ne.remove()}catch{}try{document.body.classList.remove("drag-active")}catch{}window.removeEventListener("dragend",Oe),window.removeEventListener("pointerup",Oe),document.removeEventListener("visibilitychange",Oe)};window.addEventListener("dragend",Oe),window.addEventListener("pointerup",Oe),document.addEventListener("visibilitychange",Oe)}catch{}};u.useEffect(()=>{const D=R.current;if(!D)return;const X=ae=>{var Oe,yt,Ht;const ye=oe(F,ae);if(ye==null)return;if(ae.preventDefault(),ye==="open"){F&&l(F);return}const be=e.find(En=>En.path===ye);if(!be)return;Q(be.path),B(be.path),o([be.path]),P.current=be.path;const Ee=H.mode==="grid"?Math.floor((we.get(be.path)??0)/Math.max(1,H.columns)):((Oe=he==null?void 0:he.get(be.path))==null?void 0:Oe.row)??0,ie=D.scrollTop,Ne=ie+D.clientHeight,me=H.mode==="adaptive"?((yt=ze==null?void 0:ze[Ee])==null?void 0:yt.start)??0:Ee*H.rowH,it=H.mode==="adaptive"?me+(((Ht=ze==null?void 0:ze[Ee])==null?void 0:Ht.height)??0):me+H.rowH;(me<ie||it>Ne)&&Tt(D,me),ge(be.path)};return D.addEventListener("keydown",X),()=>{D.removeEventListener("keydown",X)}},[e,F,Vt,l,H,he,ze,we]),u.useLayoutEffect(()=>{const D=R.current;if(!D)return;const X=EC({selectionToken:n,appliedSelectionToken:A.current,selectedPath:t[0]??null,topAnchorToken:r,appliedTopAnchorToken:O.current,topAnchorPath:s??null,hasPath:ye=>we.has(ye)});if(!X)return;const ae=NC({path:X.path,pathToIndex:we,layout:H,adaptiveRowMeta:ze});if(ae!=null){try{D.scrollTop=ae}catch{}if(X.source==="selection"){A.current=X.token;return}O.current=X.token}},[n,r,s,t,we,H,ze]);const Ce=u.useMemo(()=>new Set(t),[t]),rt=!!(g&&E&&M),dn=u.useMemo(()=>wC(Te,H,e),[e,H,Te]);u.useEffect(()=>{if(!(Bt||dn.length===0))for(const D of dn)Ie(D)},[Bt,dn,Ie]),u.useEffect(()=>{var D;(D=R.current)==null||D.focus()},[]),u.useEffect(()=>{var D;if(x){try{(D=R.current)==null||D.blur()}catch{}Q(null)}},[x]);const $n=u.useMemo(()=>SC(e,H,Te),[e,H,Te]),Wt=u.useMemo(()=>{var D;return CC(e,H,Te,((D=R.current)==null?void 0:D.scrollTop)??0)},[e,H,Te,R]);u.useEffect(()=>{h&&(zC(K.current,$n)||(K.current=$n,h($n)))},[h,$n]),u.useEffect(()=>{w&&U.current!==Wt&&(U.current=Wt,w(Wt))},[w,Wt]);const Bi=F?`cell-${encodeURIComponent(F)}`:void 0;return u.useEffect(()=>{if(!e.length||mx().firstGridItemLatencyMs!=null)return;const D=R.current;if(!D)return;const X=D.querySelector('[role="gridcell"][id^="cell-"]');if(!X)return;const ae=D.getBoundingClientRect(),ye=X.getBoundingClientRect();if(!(ye.bottom>=ae.top&&ye.top<=ae.bottom))return;const Ee=X.id.startsWith("cell-")?X.id.slice(5):"";let ie=e[0].path;if(Ee)try{ie=decodeURIComponent(Ee)}catch{ie=e[0].path}ES(ie)},[e,R]),a.jsxs("div",{role:"grid","aria-label":"Gallery",className:`relative h-full overflow-auto p-3 outline-none ${m?"scrollbar-hidden pr-4":"scrollbar-thin"} ${rt?"cursor-zoom-in":""}`,ref:R,tabIndex:0,"aria-activedescendant":Bi,"aria-busy":v||void 0,onMouseDown:()=>{var D;return(D=R.current)==null?void 0:D.focus()},style:{"--gap":`${nr}px`},children:[a.jsxs("div",{className:"relative w-full",style:{height:fe.getTotalSize()},children:[Te.map(D=>{var Ee;let X=[],ae={},ye="";if(H.mode==="adaptive"){const ie=H.rows[D.index];if(!ie)return null;X=ie.items,ae={height:ie.height,transform:`translate3d(0, ${D.start}px, 0)`,display:"flex",gap:nr,paddingBottom:nr},ye="absolute top-0 left-0 right-0 w-full will-change-transform"}else{const ie=D.index*H.columns;X=e.slice(ie,ie+H.columns).map(me=>({item:me,displayW:H.cellW,displayH:H.mediaH})),ae={transform:`translate3d(0, ${D.start}px, 0)`,gridTemplateColumns:`repeat(${H.columns}, minmax(0, 1fr))`,gap:nr,paddingBottom:nr},ye="absolute top-0 left-0 right-0 w-full grid will-change-transform"}const be=D.index===((Ee=Te[0])==null?void 0:Ee.index);return a.jsx("div",{className:ye,role:"row",style:ae,children:X.map(({item:ie,displayW:Ne,displayH:me})=>{const it=!x&&(j===ie.path||Ce.has(ie.path)),Oe=(p==null?void 0:p.get(ie.path))??null,yt=Oe!=null,Ht=H.mode==="adaptive"?{width:Ne}:{},En=H.mode==="adaptive"?{height:me}:{},fn=H.mode==="adaptive"?"relative rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group shrink-0":"relative aspect-[4/3] rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group";return a.jsxs("div",{id:`cell-${encodeURIComponent(ie.path)}`,className:`relative min-w-0 ${it?"outline outline-2 outline-accent outline-offset-2 rounded-[10px]":""}`,role:"gridcell","aria-selected":it,tabIndex:F===ie.path?0:-1,onFocus:()=>Q(ie.path),draggable:!0,style:Ht,onDragStart:Ye=>zn(ie.path,Ye),onPointerDown:Ye=>Fe(ie.path,Ye),onPointerMove:Ge,onPointerUp:et,onPointerCancel:kn,onContextMenu:Ye=>{Ye.preventDefault(),Ye.stopPropagation(),c==null||c(Ye,ie.path)},children:[a.jsxs("div",{className:fn,style:En,onDoubleClick:()=>{i||l(ie.path)},onMouseLeave:tn,children:[a.jsx("button",{type:"button",className:"grid-item-action-btn touch-manipulation","data-grid-action":"1","aria-label":`Open actions for ${ie.name}`,"aria-haspopup":"menu",onPointerDown:Ye=>Ye.stopPropagation(),onClick:Ye=>{Ye.stopPropagation();const Bn=Ye.currentTarget.getBoundingClientRect();Se(ie.path,{x:Bn.right-4,y:Bn.bottom-4})},children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})}),a.jsx("div",{className:"cell-content absolute inset-0",children:a.jsx(eC,{path:ie.path,name:ie.name,selected:it,highlighted:yt,highlightKey:Oe,displayW:Ne,displayH:me,ioRoot:R.current,isScrolling:Bt,priority:be,onClick:Ye=>gt(ie.path,Ye)})}),a.jsx("div",{className:"absolute right-0 bottom-0 w-7 h-7 cursor-zoom-in",onMouseEnter:()=>Cn(ie.path),onMouseLeave:tn,children:a.jsx("div",{className:"grid-item-preview-corner absolute right-0 bottom-0 h-[18px] w-[18px] flex items-center justify-center text-text select-none",style:{clipPath:'path("M0 9C0 4.02944 4.02944 0 9 0H18V18H0V9Z")',background:"linear-gradient(135deg, rgba(18,18,18,0.9) 0%, rgba(34,34,34,0.9) 60%, rgba(22,22,22,0.9) 100%)",borderTop:"1px solid rgba(255,255,255,0.08)",borderLeft:"1px solid rgba(255,255,255,0.08)",boxShadow:"0 1px 2px rgba(0,0,0,0.45)",backdropFilter:"blur(1px)"},children:a.jsxs("svg",{width:"11",height:"11",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round",className:"text-[#d9dce2]","aria-hidden":"true",style:{transform:"translate(0px,0px)"},children:[a.jsx("circle",{cx:"11",cy:"11",r:"5.4"}),a.jsx("path",{d:"M15.5 15.5 L19 19"})]})})})]}),a.jsxs("div",{className:"flex flex-col items-center text-center gap-0 mt-1 px-0.5 text-white/90",children:[a.jsx("div",{className:"text-sm leading-[18px] thumb-filename line-clamp-2 break-words hyphens-auto text-center",title:ie.name,children:$C(ie.name,f)}),a.jsxs("div",{className:"text-[11px] leading-[15px] opacity-70",children:[ie.w,"  ",ie.h]})]})]},ie.path)})},D.key)}),g&&E&&M&&mu.createPortal(a.jsx("div",{className:"toolbar-offset fixed inset-0 z-[999] flex items-center justify-center pointer-events-none bg-black/20 opacity-100",children:a.jsx("img",{src:E,alt:"preview",className:"max-w-[80vw] max-h-[80vh] object-contain opacity-[0.98]"})}),document.body)]},`${b}-${Vt}`),v&&e.length===0&&a.jsx("div",{className:"pointer-events-none absolute inset-3 z-20 flex items-center justify-center",children:a.jsxs("div",{className:"w-full max-w-[580px] rounded-lg border border-border bg-panel/95 px-4 py-3 shadow-lg",children:[a.jsx("div",{className:"flex items-center justify-between gap-3 text-xs text-text",children:a.jsx("span",{className:"font-semibold",children:"Loading gallery"})}),a.jsx("div",{className:"mt-2 text-[11px] text-muted",children:"Preparing gallery"})]})})]})}const UC=48,VC=[.1,.24,.5,.74,.9];function WC({items:e,metricKey:t,scrollRef:n,sortDir:r}){const{orderedValues:s,numericValues:i}=u.useMemo(()=>{var j;const M=[],I=[];for(const B of e){const F=(j=B.metrics)==null?void 0:j[t],Q=F==null||Number.isNaN(F)?null:F;M.push(Q),Q!=null&&I.push(Q)}return{orderedValues:M,numericValues:I}},[e,t]),o=u.useMemo(()=>HC(i,UC),[i]),l=u.useMemo(()=>QC(i,VC),[i]),[c,d]=u.useState(0),[f,p]=u.useState(null),[h,w]=u.useState(!1),x=u.useRef(null);if(u.useEffect(()=>{const M=n.current;if(!M)return;const I=()=>{const j=Math.max(1,M.scrollHeight-M.clientHeight),B=fs(j>0?M.scrollTop/j:0);d(B)};return I(),M.addEventListener("scroll",I,{passive:!0}),window.addEventListener("resize",I),()=>{M.removeEventListener("scroll",I),window.removeEventListener("resize",I)}},[n,e.length]),u.useEffect(()=>{p(null)},[t,e.length]),!o)return null;const b={min:o.min,max:o.max},S=f!=null?jm(f):null,y=jm(c),m=r==="desc",v=u.useMemo(()=>f==null?null:GC(s,f),[s,f]);function g(M){p(fs(M))}function C(){p(null)}function E(M){const I=n.current;if(!I)return;const j=Math.max(0,I.scrollHeight-I.clientHeight);I.scrollTop=fs(M)*j}function T(M){var j;const I=(j=x.current)==null?void 0:j.getBoundingClientRect();return I?fs((M.clientY-I.top)/I.height):null}return a.jsxs("div",{className:"absolute right-0 top-3 bottom-3 w-[14px] flex items-stretch pointer-events-auto",children:[a.jsxs("svg",{ref:x,viewBox:"0 0 10 100",preserveAspectRatio:"none",className:"w-full h-full rounded bg-surface-inset border border-border/60 cursor-ns-resize",onPointerDown:M=>{var j;M.preventDefault();const I=T(M);I!=null&&(w(!0),g(I),E(I),(j=x.current)==null||j.setPointerCapture(M.pointerId))},onPointerMove:M=>{const I=T(M);if(I==null){h||C();return}g(I),h&&E(I)},onPointerUp:M=>{var I;w(!1),(I=x.current)==null||I.releasePointerCapture(M.pointerId)},onPointerLeave:()=>{h||C()},children:[KC(o.bins,"var(--border-strong)",{flip:m}),qC(l,b,{flip:m,color:"var(--muted)"}),Mm(y,{color:"var(--highlight)",strokeWidth:.8}),S!=null&&Mm(S,{color:"var(--text-secondary)",strokeWidth:.6,dashed:!0})]}),v!=null&&f!=null&&a.jsx("div",{className:"pointer-events-none absolute right-full mr-2 px-1.5 py-0.5 rounded border border-border bg-surface text-[10px] text-text shadow",style:{top:`calc(${(f*100).toFixed(2)}% - 8px)`},children:XC(v)})]})}function HC(e,t){if(!e.length)return null;const n=Math.min(...e);let r=Math.max(...e);n===r&&(r=n+1);const s=new Array(t).fill(0),i=t/(r-n);for(const o of e){const l=Math.max(0,Math.min(t-1,Math.floor((o-n)*i)));s[l]+=1}return{bins:s,min:n,max:r}}function QC(e,t){if(!e.length)return[];const n=[...e].sort((s,i)=>s-i),r=n.length-1;return t.map(s=>{const i=r*s,o=Math.floor(i),l=Math.ceil(i);if(o===l)return n[o];const c=i-o;return n[o]+(n[l]-n[o])*c})}function KC(e,t,n){const r=Math.max(1,...e),s=100/e.length,i=(n==null?void 0:n.flip)??!1;return e.map((o,l)=>{const c=Math.max(.8,o/r*10),d=(i?e.length-1-l:l)*s;return a.jsx("rect",{x:10-c,y:d,width:c,height:Math.max(.2,s-.2),fill:t,opacity:.9},`sb-${l}`)})}function qC(e,t,n){const r=(n==null?void 0:n.flip)??!1,s=n==null?void 0:n.color;return e.map((i,o)=>{const l=YC(i,t,r),c=o===2;return a.jsx("line",{x1:0,y1:l,x2:10,y2:l,stroke:s,strokeWidth:c?.8:.5,opacity:c?.9:.6,vectorEffect:"non-scaling-stroke"},`qt-${o}-${i}`)})}function Mm(e,t){return a.jsx("line",{x1:0,y1:e,x2:10,y2:e,stroke:t.color,strokeWidth:t.strokeWidth??.6,strokeDasharray:t.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}function GC(e,t){if(!e.length)return null;const n=Math.round(fs(t)*(e.length-1)),r=e[n];if(r!=null)return r;for(let s=1;s<e.length;s++){const i=n-s;if(i>=0&&e[i]!=null)return e[i];const o=n+s;if(o<e.length&&e[o]!=null)return e[o]}return null}function YC(e,t,n){const r=t.max-t.min;if(r===0)return 0;const s=fs((e-t.min)/r);return(n?1-s:s)*100}function jm(e){return fs(e)*100}function fs(e){return e<0?0:e>1?1:e}function XC(e){if(e==null||Number.isNaN(e))return"-";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function hs(e,t){const[n,r]=u.useState(null),s=u.useRef(null);return u.useEffect(()=>{if(!e){if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}r(null);return}let i=!0;return e().then(o=>{if(!i)return;const l=URL.createObjectURL(o);if(s.current)try{URL.revokeObjectURL(s.current)}catch{}s.current=l,r(l)}).catch(()=>{}),()=>{i=!1}},t),u.useEffect(()=>()=>{if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}},[]),n}const JC=1.2,ZC=.05,ek=8;function Sc(e){return Number(Math.min(ek,Math.max(ZC,e)).toFixed(4))}function Rm(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Pm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function tk(e,t){try{e.setPointerCapture(t)}catch{}}function nk(e,t){try{e.releasePointerCapture(t)}catch{}}function rk(){const[e,t]=u.useState(1),[n,r]=u.useState(0),[s,i]=u.useState(0),[o,l]=u.useState(1),[c,d]=u.useState(!1),[f,p]=u.useState(!1),[h,w]=u.useState(!1),x=u.useRef(null),b=u.useRef(null),S=u.useRef(1),y=u.useRef(0),m=u.useRef(0),v=u.useRef(new Map),g=u.useRef(null),C=u.useRef(null),E=(R,P)=>{y.current=R,m.current=P,r(R),i(P)},T=R=>{const P=Sc(R);S.current=P,t(P)},M=(R,P)=>{g.current={pointerId:R,startX:P.x,startY:P.y,startTx:y.current,startTy:m.current},C.current=null,p(!0)},I=()=>{const R=Array.from(v.current.entries());if(R.length<2)return;const[P,A]=R,[O,K]=P,[U,_]=A,G=Rm(K,_);!Number.isFinite(G)||G<=2||(C.current={pointerIds:[O,U],startDistance:G,startCenter:Pm(K,_),startScale:S.current,startTx:y.current,startTy:m.current},g.current=null,p(!0))},j=()=>{const R=x.current,P=b.current;if(!R||!P||!P.naturalWidth||!P.naturalHeight)return;const A=R.getBoundingClientRect(),O=A.width/P.naturalWidth,K=A.height/P.naturalHeight,U=Math.min(1,Math.min(O,K));l(U);const _=P.naturalWidth*U,G=P.naturalHeight*U;E((A.width-_)/2,(A.height-G)/2),T(1)};u.useEffect(()=>{const R=x.current;if(!R)return;const P=new ResizeObserver(()=>{try{requestAnimationFrame(()=>j())}catch{j()}});return P.observe(R),()=>P.disconnect()},[]),u.useEffect(()=>{S.current=e,y.current=n,m.current=s},[e,n,s]),u.useEffect(()=>()=>{v.current.clear(),g.current=null,C.current=null},[]);const B=R=>{R.preventDefault();const P=R.deltaY>0?-1:1,A=x.current;if(!A)return;const O=A.getBoundingClientRect(),K=R.clientX-O.left,U=R.clientY-O.top,_=S.current,G=Sc(_*Math.pow(JC,P));if(G===_)return;const V=G/_,J=K-V*(K-y.current),se=U-V*(U-m.current);T(G),E(J,se)},F=R=>{if((R.pointerType??"mouse")==="mouse"&&R.button!==0)return;const A=v.current,O=b.current;if(!O||A.size===0&&R.target!==O)return;const K=R.currentTarget,U=K.getBoundingClientRect();if(!(R.clientX<U.left||R.clientX>U.right||R.clientY<U.top||R.clientY>U.bottom)){if(R.preventDefault(),R.stopPropagation(),A.set(R.pointerId,{x:R.clientX,y:R.clientY}),tk(K,R.pointerId),A.size>=2){I();return}M(R.pointerId,{x:R.clientX,y:R.clientY})}},Q=R=>{const P=v.current;if(!P.has(R.pointerId))return;P.set(R.pointerId,{x:R.clientX,y:R.clientY});const A=C.current;if(A){const _=P.get(A.pointerIds[0]),G=P.get(A.pointerIds[1]);if(_&&G){const V=Rm(_,G);if(V>2){const J=Pm(_,G),se=Sc(A.startScale*(V/A.startDistance)),Y=se/A.startScale,q=J.x-Y*(A.startCenter.x-A.startTx),H=J.y-Y*(A.startCenter.y-A.startTy);T(se),E(q,H)}}return}const O=g.current;if(!O||O.pointerId!==R.pointerId)return;const K=R.clientX-O.startX,U=R.clientY-O.startY;E(O.startTx+K,O.startTy+U)},ee=(R,P)=>{const A=v.current;if(!A.has(R))return;if(A.delete(R),nk(P,R),A.size===0){g.current=null,C.current=null,p(!1);return}if(A.size>=2){I();return}const[O,K]=A.entries().next().value;M(O,K)};return{scale:e,setScale:t,tx:n,setTx:r,ty:s,setTy:i,base:o,setBase:l,ready:c,setReady:d,dragging:f,setDragging:p,visible:h,setVisible:w,containerRef:x,imgRef:b,fitAndCenter:j,handleWheel:B,handlePointerDown:F,handlePointerMove:Q,handlePointerUp:R=>{ee(R.pointerId,R.currentTarget)},handlePointerCancel:R=>{ee(R.pointerId,R.currentTarget)}}}function sk({path:e,onClose:t,onNavigate:n,canPrev:r=!1,canNext:s=!1,onZoomChange:i,requestedZoomPercent:o,onZoomRequestConsumed:l}){const{scale:c,setScale:d,tx:f,setTx:p,ty:h,setTy:w,base:x,ready:b,setReady:S,dragging:y,visible:m,setVisible:v,containerRef:g,imgRef:C,fitAndCenter:E,handleWheel:T,handlePointerDown:M,handlePointerMove:I,handlePointerUp:j,handlePointerCancel:B}=rk(),F=hs(()=>pe.getFile(e),[e]),Q=hs(()=>pe.getThumb(e),[e]),ee=u.useCallback(()=>{v(!1),window.setTimeout(t,110)},[t,v]);return u.useEffect(()=>{requestAnimationFrame(()=>{var z;v(!0),(z=g.current)==null||z.focus()})},[e]),u.useEffect(()=>{const z=L=>{L.key==="Escape"?ee():(L.key==="ArrowRight"||L.key==="d")&&n?n(1):(L.key==="ArrowLeft"||L.key==="a")&&n&&n(-1)};return window.addEventListener("keydown",z),()=>window.removeEventListener("keydown",z)},[ee,n]),u.useEffect(()=>{S(!1)},[F]),u.useEffect(()=>{i&&i(x*c*100)},[x,c,i]),u.useEffect(()=>{if(o==null)return;const z=g.current;if(!z){l&&l();return}const L=Math.max(.05,Math.min(8,o/100/Math.max(1e-6,x))),R=z.getBoundingClientRect(),P=R.width/2,A=R.height/2;d(O=>{const K=L/O;return p(U=>P-K*(P-U)),w(U=>A-K*(A-U)),Number(L.toFixed(4))}),l&&l()},[o,x,l]),a.jsxs("div",{ref:g,role:"dialog","aria-modal":!0,"aria-label":"Image viewer",tabIndex:-1,className:`toolbar-offset touch-none absolute inset-0 left-[var(--left)] right-[var(--right)] flex items-start justify-start bg-panel z-viewer overflow-hidden transition-opacity duration-[110ms] ease-out cursor-grab focus:outline-none focus-visible:outline-none ${y?"cursor-grabbing select-none":""} ${m?"opacity-100":"opacity-0"}`,style:{outline:"none"},onClick:ee,onWheel:T,onPointerDown:M,onPointerMove:I,onPointerUp:j,onPointerCancel:B,onKeyDown:z=>{z.key==="Tab"&&z.preventDefault()},children:[a.jsxs("button",{"aria-label":"Close",onClick:z=>{z.stopPropagation(),ee()},className:"btn btn-sm absolute top-3 right-3 z-10",title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]}),Q&&a.jsx("img",{src:Q,alt:"thumb",className:"absolute top-0 left-0 max-w-none max-h-none object-contain pointer-events-none transition-opacity duration-[110ms] ease-out",draggable:!1,onDragStart:z=>z.preventDefault(),style:{transform:`translate(${f}px, ${h}px) scale(${x})`,transformOrigin:"0 0",opacity:b?0:.5,filter:"blur(0.25px)"}}),F&&a.jsx("img",{ref:C,src:F,alt:"viewer",className:"max-w-none max-h-none object-contain transition-opacity duration-[110ms] ease-out will-change-transform select-none",draggable:!1,onDragStart:z=>{z.preventDefault()},onLoad:z=>{E(),d(1);try{requestAnimationFrame(()=>S(!0))}catch{S(!0)}},onClick:z=>z.stopPropagation(),style:{transform:`translate(${f}px, ${h}px) scale(${x*c})`,transformOrigin:"0 0",opacity:b?.99:0,WebkitUserDrag:"none"}}),n&&a.jsxs("div",{className:"viewer-mobile-nav",onClick:z=>z.stopPropagation(),children:[a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${r?"":"is-disabled"}`,onClick:()=>r&&n(-1),"aria-label":"Previous image","aria-disabled":!r,disabled:!r,children:"Prev"}),a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${s?"":"is-disabled"}`,onClick:()=>s&&n(1),"aria-label":"Next image","aria-disabled":!s,disabled:!s,children:"Next"})]})]})}function ch(e){return!e||!(e instanceof HTMLElement)?!1:e.closest('input, textarea, [contenteditable="true"]')!==null}const ik=1.2,ok=.05,lk=8;function Cc(e){return Number(Math.min(lk,Math.max(ok,e)).toFixed(4))}function Tm(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Im(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function ak(e,t){try{e.setPointerCapture(t)}catch{}}function uk(e,t){try{e.releasePointerCapture(t)}catch{}}function ck(){const[e,t]=u.useState(1),[n,r]=u.useState(0),[s,i]=u.useState(0),[o,l]=u.useState(0),[c,d]=u.useState(0),[f,p]=u.useState(1),[h,w]=u.useState(1),[x,b]=u.useState(!1),S=u.useRef(null),y=u.useRef(null),m=u.useRef(null),v=u.useRef(1),g=u.useRef(0),C=u.useRef(0),E=u.useRef(0),T=u.useRef(0),M=u.useRef(new Map),I=u.useRef(null),j=u.useRef(null),B=u.useCallback(_=>{g.current=_.txA,C.current=_.tyA,E.current=_.txB,T.current=_.tyB,r(_.txA),i(_.tyA),l(_.txB),d(_.tyB)},[]),F=u.useCallback(_=>{const G=Cc(_);v.current=G,t(G)},[]),Q=u.useCallback((_,G)=>{I.current={pointerId:_,startX:G.x,startY:G.y,startTxA:g.current,startTyA:C.current,startTxB:E.current,startTyB:T.current},j.current=null,b(!0)},[]),ee=u.useCallback(()=>{const _=Array.from(M.current.entries());if(_.length<2)return;const[G,V]=_,[J,se]=G,[Y,q]=V,H=Tm(se,q);!Number.isFinite(H)||H<=2||(j.current={pointerIds:[J,Y],startDistance:H,startCenter:Im(se,q),startScale:v.current,startTxA:g.current,startTyA:C.current,startTxB:E.current,startTyB:T.current},I.current=null,b(!0))},[]),z=u.useCallback((_,G)=>{const V=M.current;if(!V.has(_))return;if(V.delete(_),uk(G,_),V.size===0){I.current=null,j.current=null,b(!1);return}if(V.size>=2){ee();return}const[J,se]=V.entries().next().value;Q(J,se)},[Q,ee]),L=u.useCallback(()=>{const _=S.current;if(!_)return;const G=_.getBoundingClientRect(),V=Y=>{if(!Y||!Y.naturalWidth||!Y.naturalHeight)return;const q=G.width/Y.naturalWidth,H=G.height/Y.naturalHeight,fe=Math.min(1,Math.min(q,H)),Te=Y.naturalWidth*fe,we=Y.naturalHeight*fe;return{base:fe,tx:(G.width-Te)/2,ty:(G.height-we)/2}},J=V(y.current);J&&(p(J.base),g.current=J.tx,C.current=J.ty,r(J.tx),i(J.ty));const se=V(m.current);se&&(w(se.base),E.current=se.tx,T.current=se.ty,l(se.tx),d(se.ty))},[]);u.useEffect(()=>{const _=S.current;if(!_)return;const G=new ResizeObserver(()=>{try{requestAnimationFrame(()=>L())}catch{L()}});return G.observe(_),()=>G.disconnect()},[L]);const R=u.useCallback(()=>{F(1),L()},[L,F]);u.useEffect(()=>{v.current=e,g.current=n,C.current=s,E.current=o,T.current=c},[e,n,s,o,c]),u.useEffect(()=>()=>{M.current.clear(),I.current=null,j.current=null},[]);const P=u.useCallback(_=>{_.preventDefault();const G=_.deltaY>0?-1:1,V=S.current;if(!V)return;const J=V.getBoundingClientRect(),se=_.clientX-J.left,Y=_.clientY-J.top,q=v.current,H=Cc(q*Math.pow(ik,G));if(H===q)return;const fe=H/q;F(H),B({txA:se-fe*(se-g.current),tyA:Y-fe*(Y-C.current),txB:se-fe*(se-E.current),tyB:Y-fe*(Y-T.current)})},[B,F]),A=u.useCallback(_=>{if((_.pointerType??"mouse")==="mouse"&&_.button!==0)return;const V=_.currentTarget;if(_.preventDefault(),M.current.set(_.pointerId,{x:_.clientX,y:_.clientY}),ak(V,_.pointerId),M.current.size>=2){ee();return}Q(_.pointerId,{x:_.clientX,y:_.clientY})},[Q,ee]),O=u.useCallback(_=>{const G=M.current;if(!G.has(_.pointerId))return;G.set(_.pointerId,{x:_.clientX,y:_.clientY});const V=j.current;if(V){const q=G.get(V.pointerIds[0]),H=G.get(V.pointerIds[1]);if(q&&H){const fe=Tm(q,H);if(fe>2){const Te=Im(q,H),we=Cc(V.startScale*(fe/V.startDistance)),he=we/V.startScale;F(we),B({txA:Te.x-he*(V.startCenter.x-V.startTxA),tyA:Te.y-he*(V.startCenter.y-V.startTyA),txB:Te.x-he*(V.startCenter.x-V.startTxB),tyB:Te.y-he*(V.startCenter.y-V.startTyB)})}}return}const J=I.current;if(!J||J.pointerId!==_.pointerId)return;const se=_.clientX-J.startX,Y=_.clientY-J.startY;B({txA:J.startTxA+se,tyA:J.startTyA+Y,txB:J.startTxB+se,tyB:J.startTyB+Y})},[B,F]),K=u.useCallback(_=>{z(_.pointerId,_.currentTarget)},[z]),U=u.useCallback(_=>{z(_.pointerId,_.currentTarget)},[z]);return{scale:e,baseA:f,baseB:h,txA:n,tyA:s,txB:o,tyB:c,dragging:x,containerRef:S,imgARef:y,imgBRef:m,fitAndCenter:L,resetView:R,handleWheel:P,handlePointerDown:A,handlePointerMove:O,handlePointerUp:K,handlePointerCancel:U}}function dk({aItem:e,bItem:t,index:n,total:r,canPrev:s,canNext:i,onNavigate:o,onClose:l}){const c=u.useRef(null),[d,f]=u.useState(50),[p,h]=u.useState(!1),[w,x]=u.useState(!1),{scale:b,baseA:S,baseB:y,txA:m,tyA:v,txB:g,tyB:C,dragging:E,containerRef:T,imgARef:M,imgBRef:I,fitAndCenter:j,resetView:B,handleWheel:F,handlePointerDown:Q,handlePointerMove:ee,handlePointerUp:z,handlePointerCancel:L}=ck(),R=(e==null?void 0:e.path)??null,P=(t==null?void 0:t.path)??null,A=(e==null?void 0:e.name)??R??"Select an image",O=(t==null?void 0:t.name)??P??"Select another image";u.useEffect(()=>{requestAnimationFrame(()=>{var Y;return(Y=c.current)==null?void 0:Y.focus()})},[R,P]),u.useEffect(()=>{B(),h(!1),x(!1)},[R,P,B]),u.useEffect(()=>{const Y=q=>{if(!ch(q.target)){if(q.key==="Escape"){q.preventDefault(),l();return}if((q.key==="ArrowRight"||q.key==="d")&&i){q.preventDefault(),o(1);return}(q.key==="ArrowLeft"||q.key==="a")&&s&&(q.preventDefault(),o(-1))}};return window.addEventListener("keydown",Y),()=>window.removeEventListener("keydown",Y)},[l,o,s,i]);const K=hs(R?()=>pe.getFile(R):null,[R]),U=hs(P?()=>pe.getFile(P):null,[P]),_=hs(R?()=>pe.getThumb(R):null,[R]),G=hs(P?()=>pe.getThumb(P):null,[P]),V=u.useCallback(Y=>Math.min(95,Math.max(5,Y)),[]),J=u.useCallback(Y=>{const q=Y.target;q!=null&&q.closest(".compare-label")||q!=null&&q.closest(".compare-divider-hit")||Q(Y)},[Q]),se=u.useCallback(Y=>{const q=T.current;if(!q)return;Y.preventDefault(),Y.stopPropagation();const H=q.getBoundingClientRect(),fe=Y.currentTarget;fe.setPointerCapture(Y.pointerId);const Te=he=>{const ze=(he.clientX-H.left)/H.width*100;f(V(ze))},we=he=>{try{fe.releasePointerCapture(he.pointerId)}catch{}window.removeEventListener("pointermove",Te),window.removeEventListener("pointerup",we),window.removeEventListener("pointercancel",we)};window.addEventListener("pointermove",Te),window.addEventListener("pointerup",we),window.addEventListener("pointercancel",we)},[V]);return a.jsxs("div",{ref:c,role:"dialog","aria-modal":!0,"aria-label":"Compare images",tabIndex:-1,className:"toolbar-offset absolute inset-0 left-[var(--left)] right-[var(--right)] bg-panel z-viewer flex flex-col overflow-hidden focus:outline-none",onKeyDown:Y=>{Y.key==="Tab"&&Y.preventDefault()},children:[a.jsxs("div",{className:"compare-header flex items-center gap-3 px-3 py-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Compare"}),a.jsx("div",{className:"text-xs text-muted",children:r>=2?`${n+1}-${Math.min(n+2,r)} of ${r}`:"Select 2 images"}),a.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(-1),disabled:!s,title:"Previous (Left Arrow or A)",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Prev"]}),a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(1),disabled:!i,title:"Next (Right Arrow or D)",children:["Next",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"btn btn-sm",onClick:l,title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]})]})]}),a.jsx("div",{className:"flex-1 min-h-0 p-3 bg-panel",children:a.jsx("div",{ref:T,className:`compare-stage ${E?"is-dragging":""}`,onWheel:F,onPointerDown:J,onPointerMove:ee,onPointerUp:z,onPointerCancel:L,children:!e||!t?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-sm text-muted",children:"Select 2 images to compare."}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"compare-label left-3",children:[a.jsx("span",{className:"compare-label-tag",children:"A"}),a.jsx("span",{className:"truncate",title:e.path,children:A})]}),a.jsxs("div",{className:"compare-label right-3",children:[a.jsx("span",{className:"compare-label-tag",children:"B"}),a.jsx("span",{className:"truncate",title:t.path,children:O})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 ${100-d}% 0 0)`},children:[_&&a.jsx("img",{src:_,alt:"thumb A",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:Y=>Y.preventDefault(),style:{transform:`translate(${m}px, ${v}px) scale(${S})`,transformOrigin:"0 0",opacity:p?0:.5}}),K&&a.jsx("img",{ref:M,src:K,alt:"compare A",className:"compare-image",draggable:!1,onDragStart:Y=>Y.preventDefault(),onLoad:()=>{j();try{requestAnimationFrame(()=>h(!0))}catch{h(!0)}},style:{transform:`translate(${m}px, ${v}px) scale(${S*b})`,transformOrigin:"0 0",opacity:p?.99:0}})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 0 0 ${d}%)`},children:[G&&a.jsx("img",{src:G,alt:"thumb B",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:Y=>Y.preventDefault(),style:{transform:`translate(${g}px, ${C}px) scale(${y})`,transformOrigin:"0 0",opacity:w?0:.5}}),U&&a.jsx("img",{ref:I,src:U,alt:"compare B",className:"compare-image",draggable:!1,onDragStart:Y=>Y.preventDefault(),onLoad:()=>{j();try{requestAnimationFrame(()=>x(!0))}catch{x(!0)}},style:{transform:`translate(${g}px, ${C}px) scale(${y*b})`,transformOrigin:"0 0",opacity:w?.99:0}})]}),a.jsxs("div",{className:"compare-divider-hit",style:{left:`${d}%`},onPointerDown:se,children:[a.jsx("div",{className:"compare-divider-line"}),a.jsx("div",{className:"compare-divider-handle"})]})]})})})]})}function sl(){const[e,t]=u.useState(GS());return u.useEffect(()=>qS(t),[]),e}const Wo=e=>["item",e],fk={v:1,tags:[],notes:"",version:1,updated_at:"",updated_by:"web"},Mn=new Map,fa=new Map,Hd=new Map,dh=new Map;let Lm=0;const Jn=new Map,ho=new Map,hk=12e3,Qd=new Set,Kd=new Set;let fh={state:"idle"},Ho=null,qd=0;function zl(e){fh=e;for(const t of Qd)t(e)}function hr(){const e=Jn.size>0,t=Mn.size+fa.size+qd;if(e){zl({state:"error",message:"Conflict detected"});return}if(Ho){zl({state:"error",message:Ho});return}if(t>0){zl({state:"syncing"});return}zl({state:"idle"})}function hh(){let e=null;for(const t of Hd.values())e=e==null?t:Math.min(e,t);for(const t of dh.values())e=e==null?t:Math.min(e,t);return e}function Ha(){const e=hh();for(const t of Kd)t(e)}function Qa(e){Ho=e,hr()}function bx(){Ho&&(Ho=null,hr())}function _m(e){qd=Math.max(0,qd+e),hr()}function pk(){Lm+=1;const e=Lm;return dh.set(e,Date.now()),Ha(),e}function mk(e){e!=null&&dh.delete(e)&&Ha()}function xu(e){const t=ho.get(e);if(!t||!t.size)return;const n=Jn.get(e)??null;for(const r of t)r(n)}function Am(e){return Jn.get(e)??null}function wu(e){Jn.delete(e)&&(xu(e),hr())}function gk(e,t){Jn.set(e,t),xu(e),hr()}function yk(e,t){const n=ho.get(e)??new Set;return n.add(t),ho.set(e,n),t(Jn.get(e)??null),()=>{const r=ho.get(e);r&&(r.delete(t),r.size||ho.delete(e))}}function vk(e){const[t,n]=u.useState(()=>e?Am(e):null);return u.useEffect(()=>{if(!e){n(null);return}return n(Am(e)),yk(e,n)},[e]),t}function xk(e){return Qd.add(e),e(fh),()=>{Qd.delete(e)}}function wk(){const[e,t]=u.useState(fh);return u.useEffect(()=>xk(t),[]),e}function bk(e){return Kd.add(e),e(hh()),()=>{Kd.delete(e)}}function Sk(){const[e,t]=u.useState(()=>hh()),[n,r]=u.useState(()=>e==null?null:Date.now()-e);return u.useEffect(()=>bk(t),[]),u.useEffect(()=>{if(e==null){r(null);return}r(Date.now()-e);const s=window.setInterval(()=>{r(Date.now()-e)},1e3);return()=>window.clearInterval(s)},[e]),n}function Gd(e){const t={};return Object.prototype.hasOwnProperty.call(e,"star")&&(t.set_star=e.star??null),Object.prototype.hasOwnProperty.call(e,"notes")&&(t.set_notes=e.notes??""),Object.prototype.hasOwnProperty.call(e,"tags")&&(t.set_tags=Array.isArray(e.tags)?e.tags:[]),t}function Yd(e){var t,n;return e.set_star!==void 0||e.set_notes!==void 0||e.set_tags!==void 0||(((t=e.add_tags)==null?void 0:t.length)??0)>0||(((n=e.remove_tags)==null?void 0:n.length)??0)>0}function so(e){const t=[],n=new Set;for(const r of e??[]){if(typeof r!="string")continue;const s=r.trim();!s||n.has(s)||(n.add(s),t.push(s))}return t}function Ck(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function kk(e,t){if(e.set_star!==void 0&&(t.star??null)!==e.set_star||e.set_notes!==void 0&&(t.notes??"")!==(e.set_notes??""))return!1;if(e.set_tags!==void 0){const r=so(e.set_tags),s=so(t.tags);return Ck(r,s)}const n=so(t.tags);for(const r of so(e.add_tags))if(!n.includes(r))return!1;for(const r of so(e.remove_tags))if(n.includes(r))return!1;return!0}function Sx(e,t,n){if(n instanceof ln&&n.status===409){const r=n.body;if(r!=null&&r.current)return gk(e,{path:e,current:r.current,pending:t,receivedAt:new Date().toISOString()}),!0}return!1}function Ek(e,t){const n=Jn.get(e);if(n){if(kk(n.pending,t)){wu(e);return}Jn.set(e,{...n,current:t}),xu(e),hr()}}function Nk(e){const t=sl();return rl({queryKey:Wo(e),queryFn:()=>pe.getSidecar(e),enabled:!!e,staleTime:3e4,gcTime:5*6e4,retry:2,refetchInterval:t?hk:!1,refetchIntervalInBackground:t})}function Mk(e){const t=wr();return iS({mutationFn:async({patch:n,baseVersion:r,idempotencyKey:s})=>{const i=Gd(n);if(!Yd(i))return t.getQueryData(Wo(e))??fk;const o={...i,base_version:r};try{return await pe.patchSidecar(e,o,{idempotencyKey:s??vu("patch"),ifMatch:r})}catch(l){throw Sx(e,i,l),l}},retry:(n,r)=>r instanceof ln&&r.status===409?!1:n<2,retryDelay:n=>Math.min(1e3*Math.pow(2,n),4e3),onMutate:()=>(bx(),_m(1),{inflightId:pk()}),onSuccess:n=>{wu(e),t.setQueryData(Wo(e),n)},onError:n=>{n instanceof ln&&n.status===409||(n instanceof ln?Qa(n.message):Qa("Failed to save"))},onSettled:(n,r,s,i)=>{_m(-1),mk(i==null?void 0:i.inflightId)}})}const jk=6;async function Cx(e,t){if(!e.length)return;let n=0;const r=[],s=async()=>{for(;n<e.length;){const o=n++,l=e[o];try{await kx(l,t)}catch(c){r.push({path:l,error:c}),console.error(`[bulkUpdateSidecars] Failed for ${l}:`,c)}}},i=Array.from({length:Math.min(jk,e.length)},()=>s());if(await Promise.all(i),r.length===e.length)throw new Error(`All ${e.length} sidecar updates failed`)}async function kx(e,t){const n=Mn.get(e)||{};Mn.set(e,{...n,...t}),bx(),hr();const r=fa.get(e);if(r)return r;Hd.set(e,Date.now()),Ha();const s=(async()=>{try{for(;Mn.has(e);){const i=Mn.get(e);if(!i)break;const o=Gd(i);if(!Yd(o)){Mn.get(e)===i&&Mn.delete(e);continue}let l=1;try{l=(await pe.getSidecar(e)).version??1}catch{l=1}const c={...o,base_version:l};try{await pe.patchSidecar(e,c,{idempotencyKey:vu("patch"),ifMatch:l}),wu(e),Mn.get(e)===i&&Mn.delete(e)}catch(d){if(Sx(e,o,d)){const p=Mn.get(e);if(p&&p!==i){const h=Gd(p);if(Yd(h)){const w=Jn.get(e);w&&(Jn.set(e,{...w,pending:h}),xu(e))}}Mn.delete(e)}else d instanceof ln?Qa(d.message):Qa("Failed to save");throw d}}}finally{fa.delete(e),Hd.delete(e),Ha(),hr()}})();return fa.set(e,s),hr(),s}function il(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function Ex(e){return e==="pil_info"||e.startsWith("pil_info.")||e.startsWith("pil_info[")}function Xd(e,t){if(typeof t=="number")return e?`${e}[${t}]`:`[${t}]`;const n=/^[A-Za-z0-9_$-]+$/.test(t);return e?n?`${e}.${t}`:`${e}["${t}"]`:n?t:`["${t}"]`}function Ka(e){return e==null?String(e):typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):Array.isArray(e)?`[${e.map(Ka).join(",")}]`:typeof e=="object"?`{${Object.entries(e).sort(([n],[r])=>n.localeCompare(r)).map(([n,r])=>`${n}:${Ka(r)}`).join(",")}}`:String(e)}function $l(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return String(e);try{return JSON.stringify(e,null,1)}catch{return String(e)}}function qa(e,t,n,r,s){if(s.skipPilInfo&&Ex(t))return;const i=t||"(root)";if(r>=s.maxDepth){n.set(i,e);return}if(Array.isArray(e)){if(!e.length){n.set(i,[]);return}if(e.length>s.maxArray){n.set(i,e);return}e.forEach((o,l)=>qa(o,Xd(t,l),n,r+1,s));return}if(il(e)){const o=Object.keys(e).sort((l,c)=>l.localeCompare(c));if(!o.length){n.set(t||"(root)",{});return}for(const l of o)s.skipPilInfo&&!t&&l==="pil_info"||qa(e[l],Xd(t,l),n,r+1,s);return}n.set(i,e)}function ha(e){if(Array.isArray(e))return e.map(ha);if(e&&typeof e=="object")return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,ha(n)]));if(typeof e=="string"){const t=e.trim();if(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]")||t.startsWith('"')&&t.endsWith('"'))try{const r=JSON.parse(t);return ha(r)}catch{return e}}return e}function kc(e){return e?ha(e):null}function Ec(e,t){if(!e)return null;if(!t&&il(e)&&"pil_info"in e){const n={};for(const[r,s]of Object.entries(e))n[r]=r==="pil_info"?"Hidden (toggle Show PIL info to expand)":s;return n}return e}function Co(e,t=[]){return e===null?{kind:"null",text:"null"}:e===void 0?{kind:"undefined",text:"undefined"}:typeof e=="string"?{kind:"string",text:JSON.stringify(e)}:typeof e=="number"?{kind:"number",text:String(e)}:typeof e=="boolean"?{kind:"boolean",text:e?"true":"false"}:Array.isArray(e)?{kind:"array",items:e.map((n,r)=>Co(n,[...t,r]))}:il(e)?{kind:"object",entries:Object.keys(e).map(n=>{const r=[...t,n];return{key:n,path:r,value:Co(e[n],r)}})}:{kind:"fallback",text:String(e)}}function Rk(e){let t="";for(const n of e)t=Xd(t,n);return t||"(root)"}function Pk(e,t){let n=e;for(const r of t){if(typeof r=="number"){if(!Array.isArray(n))return;n=n[r];continue}if(!il(n))return;n=n[r]}return n}function Tk(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e;try{return JSON.stringify(e,null,1)}catch{return String(e)}}function Nc(e,t){const n=Pk(e,t);return{pathLabel:Rk(t),copyText:Tk(n)}}function Mc(e){return!!e&&il(e)&&"pil_info"in e}function Ik(e,t,n){if(e==null||t==null)return null;const r=new Map,s=new Map,i={maxDepth:n.maxDepth,maxArray:n.maxArray,skipPilInfo:!n.includePilInfo};qa(e,"",r,0,i),qa(t,"",s,0,i);const o=new Set([...r.keys(),...s.keys()]),l=[];let c=0,d=0,f=0;const p=Array.from(o).sort((b,S)=>b.localeCompare(S)),h=!n.includePilInfo;for(const b of p){if(h&&Ex(b))continue;const S=r.has(b),y=s.has(b);if(!S&&y){d+=1,l.push({key:b,kind:"onlyB",aText:"",bText:$l(s.get(b))});continue}if(S&&!y){c+=1,l.push({key:b,kind:"onlyA",aText:$l(r.get(b)),bText:""});continue}const m=r.get(b),v=s.get(b),g=Ka(m),C=Ka(v);g!==C&&(f+=1,l.push({key:b,kind:"different",aText:$l(m),bText:$l(v)}))}const w=Math.max(0,l.length-n.limit);return{entries:w?l.slice(0,n.limit):l,onlyA:c,onlyB:d,different:f,truncatedCount:w}}function Jd(e){const t=["B","KB","MB","GB","TB"];let n=0,r=e;for(;r>=1024&&n<t.length-1;)r/=1024,n+=1;return`${r.toFixed(1)} ${t[n]}`}function Nx(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function jc(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function Lk(e,t=28){if(e.length<=t)return e;const n=Math.max(4,Math.floor((t-1)/2));return`${e.slice(0,n)}${e.slice(-n)}`}const _k=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"});function Ak(e){const t=e.trim();return!t||/[zZ]|[+-]\d{2}:?\d{2}$/.test(t)?t:`${t.includes("T")?t:t.replace(" ","T")}Z`}function Mx(e){if(!e)return null;const t=Date.parse(Ak(e));return Number.isFinite(t)?t:null}function Fk(e,t=Date.now()){const n=Math.max(0,t-e),r=Math.max(1,Math.floor(n/1e3));if(r<60)return`${r} second${r===1?"":"s"} ago`;const s=Math.floor(r/60);if(s<60)return`${s} minute${s===1?"":"s"} ago`;const i=Math.floor(s/60);return`${i} hour${i===1?"":"s"} ago`}function Ok(e){return _k.format(new Date(e))}function ol({title:e,open:t,onToggle:n,actions:r,children:s,contentClassName:i}){const[o,l]=u.useState(t),[c,d]=u.useState(t?"open":"closed");return u.useEffect(()=>{if(t){l(!0);const p=window.requestAnimationFrame(()=>d("open"));return()=>window.cancelAnimationFrame(p)}d("closing");const f=window.setTimeout(()=>{l(!1),d("closed")},140);return()=>window.clearTimeout(f)},[t]),a.jsxs("div",{className:"border-b border-border/60",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[a.jsxs("button",{type:"button",onClick:n,"aria-expanded":t,className:"flex items-center gap-2 inspector-section-title hover:text-text transition-colors",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`transition-transform ${t?"rotate-90":""}`,"aria-hidden":"true",children:a.jsx("path",{d:"m9 18 6-6-6-6"})}),a.jsx("span",{children:e})]}),r]}),o&&a.jsx("div",{className:"inspector-section-body","data-state":c,"aria-hidden":!t,children:a.jsx("div",{className:i??"px-3 pb-3",children:s})})]})}function Bl({copied:e,value:t,className:n="",title:r}){return a.jsxs("span",{className:`ui-kv-value relative inline-block text-right min-w-[80px] ${n}`.trim(),title:r,children:[a.jsx("span",{className:e?"invisible block":"block",children:t}),e&&a.jsx("span",{className:"absolute inset-0 text-right",children:"Copied"})]})}function Dk({open:e,onToggle:t,multi:n,star:r,onSelectStar:s,hasStarConflict:i,onApplyConflict:o,onKeepTheirs:l,currentItem:c,sourceValue:d,sortSpec:f,copiedField:p,onCopyInfo:h,metricsExpanded:w,onToggleMetricsExpanded:x,metricsPreviewLimit:b}){return a.jsxs(ol,{title:"Basics",open:e,onToggle:t,children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs mb-1",role:"radiogroup","aria-label":"Star rating",children:[a.jsx("span",{className:"ui-kv-label w-16 shrink-0",children:n?"Rating (all)":"Rating"}),a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(S=>{const y=(r??0)>=S;return a.jsx("button",{className:`w-6 h-6 flex items-center justify-center rounded-lg border border-border/60 bg-transparent text-[13px] ${y?"text-star-active":"text-star-inactive"} hover:border-border hover:text-star-hover transition-colors`,onClick:()=>{s(r===S&&!n?null:S)},title:`${S} star${S>1?"s":""} (key ${S})`,"aria-label":`${S} star${S>1?"s":""}`,"aria-pressed":r===S,children:y?"":""},S)})})]}),i&&a.jsxs("div",{className:"ui-banner ui-banner-danger mt-2 text-[11px] flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Rating conflict."}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:o,children:"Apply again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:l,children:"Keep theirs"})]})]}),!n&&c&&a.jsxs("div",{className:"text-[12px] space-y-1.5 leading-relaxed",children:[a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("dimensions",`${c.w}${c.h}`),children:"Dimensions"}),a.jsx(Bl,{copied:p==="dimensions",value:`${c.w}${c.h}`})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("size",Jd(c.size)),children:"Size"}),a.jsx(Bl,{copied:p==="size",value:Jd(c.size)})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("type",c.type),children:"Type"}),a.jsx(Bl,{copied:p==="type",value:c.type,className:"break-all"})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>d&&h("source",d),children:"Source"}),a.jsx(Bl,{copied:p==="source",value:d,className:"inspector-value-clamp break-words max-w-[70%]",title:d})]}),(()=>{const S=c.metrics||null;if(!S)return null;const y=Object.entries(S).filter(([,I])=>I!=null);if(!y.length)return null;const m=(f==null?void 0:f.kind)==="metric"?f.key:null,v=[...y].sort(([I],[j])=>I.localeCompare(j));let g=v;if(m){const I=v.findIndex(([j])=>j===m);I>0&&(g=[v[I],...v.slice(0,I),...v.slice(I+1)])}const C=g.length>b,T=w||!C?g:g.slice(0,b),M=g.length-b;return a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"ui-subsection-title mb-1",children:"Metrics"}),a.jsxs("div",{className:"space-y-1",children:[T.map(([I,j])=>{const B=m===I;return a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:`w-24 shrink-0 ${B?"text-accent font-medium":"ui-kv-label"}`,children:I}),a.jsx("span",{className:`ui-kv-value text-right ${B?"text-accent font-medium":""}`,children:Nx(j)})]},I)}),C&&a.jsx("button",{type:"button",className:"text-[11px] text-muted underline underline-offset-2 hover:text-text",onClick:x,"aria-expanded":w,children:w?"Show less":`+${M} more`})]})]})})()]})]})}const Ul=2,zk={color:"var(--json-string)"},$k={color:"var(--json-number)"},Bk={color:"var(--json-literal)"},Uk={color:"var(--json-fallback)"},Vk={color:"var(--json-key)"};function Zd(e,t,n){switch(e.kind){case"null":case"boolean":return a.jsx("span",{style:Bk,children:e.text});case"undefined":case"fallback":return a.jsx("span",{style:Uk,children:e.text});case"string":return a.jsx("span",{style:zk,children:e.text});case"number":return a.jsx("span",{style:$k,children:e.text});case"array":return e.items.length===0?"[]":a.jsxs(a.Fragment,{children:[`[
`,e.items.map((r,s)=>a.jsxs(Jr.Fragment,{children:[" ".repeat(t+Ul),Zd(r,t+Ul,n),s<e.items.length-1?",":"",`
`]},s))," ".repeat(t),"]"]});case"object":return e.entries.length===0?"{}":a.jsxs(a.Fragment,{children:[`{
`,e.entries.map((r,s)=>a.jsxs(Jr.Fragment,{children:[" ".repeat(t+Ul),a.jsx("span",{className:"ui-json-key",style:Vk,onClick:n?i=>{i.stopPropagation(),n(r.path)}:void 0,children:JSON.stringify(r.key)}),": ",Zd(r.value,t+Ul,n),s<e.entries.length-1?",":"",`
`]},JSON.stringify(r.path)))," ".repeat(t),"}"]})}}function jx({node:e,onPathClick:t}){return a.jsx("code",{className:"block whitespace-pre-wrap",children:Zd(e,0,t)})}const Rx=Jr.memo(function({compareDiff:t}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-muted",children:[a.jsxs("span",{children:[t.different," ","different"," ",""," ",t.onlyA," ","only A"," ",""," ",t.onlyB," ","only B"]}),a.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:"Deep paths"})]}),t.entries.length===0?a.jsx("div",{className:"text-muted",children:"No differences found."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2 text-[10px] uppercase tracking-wide text-muted",children:[a.jsx("div",{children:"Path"}),a.jsx("div",{children:"A"}),a.jsx("div",{children:"B"})]}),t.entries.map(n=>a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2",children:[a.jsx("div",{className:"text-[11px] text-muted font-mono break-all",children:n.key}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.aText}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.bText})]},n.key)),t.truncatedCount>0&&a.jsxs("div",{className:"text-muted text-[11px]",children:["+",t.truncatedCount," ","more differences not shown."]})]})]})});Rx.displayName="CompareDiffTable";const ef=Jr.memo(function({side:t,compareMetaLoaded:n,hasPilInfo:r,showPilInfo:s,onToggleShowPilInfo:i,copied:o,onCopy:l,copiedPath:c,displayNode:d,compareMetaContent:f,onMetaPathCopy:p}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:["Metadata"," ",t]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[r&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:i,disabled:!n,children:s?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:l,disabled:!n,children:o?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[c&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",c]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",children:n&&d?a.jsx(jx,{node:d,onPathClick:p}):f})]})]})});ef.displayName="CompareMetadataPane";function Wk({open:e,onToggle:t,compareMetaState:n,compareMetaError:r,compareLabelA:s,compareLabelB:i,compareIncludePilInfo:o,onToggleCompareIncludePilInfo:l,onReload:c,compareDiff:d,compareHasPilInfoA:f,compareHasPilInfoB:p,compareShowPilInfoA:h,compareShowPilInfoB:w,onToggleCompareShowPilInfoA:x,onToggleCompareShowPilInfoB:b,compareMetaCopied:S,onCopyCompareMetadata:y,compareValueCopiedPathA:m,compareValueCopiedPathB:v,compareDisplayNodeA:g,compareDisplayNodeB:C,compareMetaContent:E,onCompareMetaPathCopyA:T,onCompareMetaPathCopyB:M}){const I=n==="loaded";return a.jsx(ol,{title:"Compare Metadata",open:e,onToggle:t,actions:a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:c,disabled:n==="loading",children:n==="loading"?"Loading":"Reload"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:l,disabled:!I,children:o?"Hide PIL info":"Include PIL info"})]}),children:a.jsxs("div",{className:"space-y-2 text-[11px]",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] text-muted",children:[a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"A"}),a.jsx("div",{className:"text-text break-all",title:s,children:s})]}),a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"B"}),a.jsx("div",{className:"text-text break-all",title:i,children:i})]})]}),n==="loading"&&a.jsx("div",{className:"text-muted",children:"Loading metadata"}),n==="error"&&r&&a.jsx("div",{className:"text-danger break-words",children:r}),I&&d&&a.jsx(Rx,{compareDiff:d}),a.jsxs("div",{className:"grid gap-3 pt-2",children:[a.jsx(ef,{side:"A",compareMetaLoaded:I,hasPilInfo:f,showPilInfo:h,onToggleShowPilInfo:x,copied:S==="A",onCopy:()=>y("A"),copiedPath:m,displayNode:g,compareMetaContent:E,onMetaPathCopy:T}),a.jsx(ef,{side:"B",compareMetaLoaded:I,hasPilInfo:p,showPilInfo:w,onToggleShowPilInfo:b,copied:S==="B",onCopy:()=>y("B"),copiedPath:v,displayNode:C,compareMetaContent:E,onMetaPathCopy:M})]})]})})}const Px=Jr.memo(Wk);Px.displayName="CompareMetadataSection";function Hk({open:e,onToggle:t,metadataLoading:n,metadataActionLabel:r,onMetadataAction:s,metadataActionDisabled:i,hasPilInfo:o,showPilInfo:l,onToggleShowPilInfo:c,metaValueCopiedPath:d,metaHeightClass:f,metaLoaded:p,metaDisplayNode:h,metaContent:w,metaError:x,onMetaPathCopy:b}){const S=a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[p&&o&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:c,disabled:!p,children:l?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[78px]",onClick:s,disabled:i||n,children:r})]});return a.jsxs(ol,{title:"Metadata",open:e,onToggle:t,actions:S,children:[a.jsxs("div",{className:"relative",children:[d&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",d]}),a.jsx("pre",{className:`ui-code-block ui-code-block-resizable ${f} overflow-auto whitespace-pre-wrap`,children:p&&h?a.jsx(jx,{node:h,onPathClick:b}):w})]}),x&&a.jsx("div",{className:"text-[11px] text-danger mt-1 break-words",children:x})]})}const Tx=Jr.memo(Hk);Tx.displayName="MetadataSection";function Qk({open:e,onToggle:t,multi:n,showConflictBanner:r,onApplyConflict:s,onKeepTheirs:i,notes:o,onNotesChange:l,onNotesBlur:c,tags:d,onTagsChange:f,onTagsBlur:p}){return a.jsxs(ol,{title:"Notes & Tags",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",children:[r&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Conflicting edits detected."}),a.jsx("div",{className:"text-[11px] text-muted mt-0.5",children:"Your changes were not saved because this item was updated elsewhere."}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:s,children:"Apply my changes again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:i,children:"Keep theirs"})]})]}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full scrollbar-thin",placeholder:"Add notes",value:o,onChange:h=>l(h.target.value),onBlur:c,"aria-label":n?"Notes for selected items":"Notes"}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:n?"Tags (apply to all, comma-separated)":"Tags (comma-separated)"}),a.jsx("input",{className:"ui-input inspector-input w-full",placeholder:"tag1, tag2",value:d,onChange:h=>f(h.target.value),onBlur:p,"aria-label":n?"Tags for selected items":"Tags"})]})]})}function Kk(e){return e===2?null:e>2?`Side-by-side view supports exactly 2 selections (selected ${e}).`:"Select exactly 2 images to open side-by-side view."}function qk({selectedCount:e,compareActive:t,onOpenCompare:n}){const r=Kk(e),s=!n||t||r!==null,i=t?"Side-by-side viewer is already open.":r??"Open side by side to compare selected images.";return a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Selection Actions"}),a.jsx("div",{className:"flex flex-wrap items-center gap-2",children:a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>n==null?void 0:n(),disabled:s,children:"Side by side view"})}),a.jsx("div",{className:"text-[11px] text-muted",children:i})]})}const Fm=2,Ix=12,Om=120,Dm=!0,Qo="Comparison export (v1) requires exactly 2 selected images.",Gk=`Comparison export (v2) requires between 2 and ${Ix} selected images.`,Lx="Comparison export for more than 2 selections is unavailable on this server.";function _x(e,t){return`Comparison export (v2) supports up to ${e} selections (selected ${t}).`}function Yk(e){return e.replace(/[\u0000-\u001f\u007f]/g,"").trim()}function Xk(e){const n=e.replace(/\r\n?/g,`
`).replace(/\n+$/g,"");return n?n.split(`
`):[]}function Jk(e){if(e.length!==0)return e.length===1?[e[0]]:[e[0],e[1]]}function Zk(e){return e.map(t=>t.trim()).filter(t=>t.length>0)}function Ax(e,t){const{maxLines:n,tooManyLinesMessage:r}=t,s=Xk(e);if(s.length>n)return{ok:!1,message:r};const i=s.map(l=>Yk(l));return i.some(l=>l.length>Om)?{ok:!1,message:`Each label must be at most ${Om} characters.`}:i.some(l=>l.length>0)?{ok:!0,labels:i}:{ok:!0,labels:void 0}}function eE(e){const{pathA:t,pathB:n,labelsText:r,embedMetadata:s,reverseOrder:i}=e;if(!t||!n)return{ok:!1,message:Qo};const o=Ax(r,{maxLines:Fm,tooManyLinesMessage:`Enter at most ${Fm} label lines (line 1 = A, line 2 = B).`});if(!o.ok)return o;const l={v:1,paths:[t,n],embed_metadata:s,reverse_order:i};return o.labels&&(l.labels=Jk(o.labels)),{ok:!0,payload:l}}function tE(e){const{paths:t,labelsText:n,embedMetadata:r,reverseOrder:s}=e,i=Zk(t);if(i.length!==t.length||i.length<2||i.length>Ix)return{ok:!1,message:Gk};const o=Ax(n,{maxLines:i.length,tooManyLinesMessage:`Enter at most ${i.length} label lines (one per selected image).`});if(!o.ok)return o;const l={v:2,paths:i,embed_metadata:r,reverse_order:s};return o.labels&&(l.labels=o.labels),{ok:!0,payload:l}}function io(e){return String(e).padStart(2,"0")}function nE(e,t=new Date){const n=t.getUTCFullYear(),r=io(t.getUTCMonth()+1),s=io(t.getUTCDate()),i=io(t.getUTCHours()),o=io(t.getUTCMinutes()),l=io(t.getUTCSeconds());return`comparison${e?"_reverse":""}_${n}${r}${s}_${i}${o}${l}.png`}function rE({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r}){return e<2?`Comparison export requires at least 2 selections (selected ${e}).`:e===2?t?null:Qo:!n||r===null?Lx:e>r?_x(r,e):null}function sE({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r,compareExportLabelsText:s,onCompareExportLabelsTextChange:i,compareExportEmbedMetadata:o,onCompareExportEmbedMetadataChange:l,compareExportBusy:c,compareExportMode:d,onComparisonExport:f,compareExportError:p}){const h=rE({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r}),w=c||h!==null,x=e>2?`Label for image 1
Label for image 2
...`:`Label for A
Label for B`;return a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Selection Export"}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full h-20 scrollbar-thin",placeholder:x,value:s,onChange:b=>i(b.target.value),disabled:w,"aria-label":"Selection export labels"}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-[11px] text-muted",children:[a.jsx("input",{type:"checkbox",checked:o,onChange:b=>l(b.target.checked),disabled:w}),a.jsx("span",{children:"Embed metadata"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>f(!1),disabled:w,children:d==="normal"?"Exporting":"Export comparison"}),a.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",onClick:()=>f(!0),disabled:w,children:d==="reverse"?"Exporting":"Export (reverse order)"})]}),h&&a.jsx("div",{className:"text-[11px] text-muted",children:h}),p&&a.jsx("div",{className:"text-danger break-words",children:p})]})}const iE=[{id:"selectionActions",isVisible:()=>!0,render:({selectionActionsProps:e})=>a.jsx(qk,{...e})},{id:"selectionExport",isVisible:({compareActive:e})=>!e,render:({selectionExportProps:e})=>a.jsx(sE,{...e})}];function oE({open:e,onToggle:t,multi:n,selectedCount:r,totalSize:s,filename:i,compareActive:o,compareReady:l,onOpenCompare:c,compareExportSupportsV2:d,compareExportMaxPathsV2:f,compareExportLabelsText:p,onCompareExportLabelsTextChange:h,compareExportEmbedMetadata:w,onCompareExportEmbedMetadataChange:x,compareExportBusy:b,compareExportMode:S,onComparisonExport:y,compareExportError:m,onFindSimilar:v,canFindSimilar:g,findSimilarDisabledReason:C}){const E={compareActive:o,selectionActionsProps:{selectedCount:r,compareActive:o,onOpenCompare:c},selectionExportProps:{selectedCount:r,compareReady:l,compareExportSupportsV2:d,compareExportMaxPathsV2:f,compareExportLabelsText:p,onCompareExportLabelsTextChange:h,compareExportEmbedMetadata:w,onCompareExportEmbedMetadataChange:x,compareExportBusy:b,compareExportMode:S,onComparisonExport:y,compareExportError:m}};return a.jsxs(ol,{title:n?"Selection":"Item",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",actions:v&&a.jsx("button",{type:"button",className:"btn btn-sm",onClick:v,disabled:!g,title:C??"Find similar",children:"Find similar"}),children:[n?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Selected"}),a.jsxs("div",{className:"inspector-field-value",children:[r," files"]})]}),a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Total size"}),a.jsx("div",{className:"inspector-field-value",children:Jd(s)})]})]}),iE.filter(T=>T.isVisible(E)).map(T=>a.jsx(u.Fragment,{children:T.render(E)},T.id))]}):a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Filename"}),a.jsx("div",{className:"inspector-field-value break-all",title:i,children:i})]}),C&&a.jsx("div",{className:"text-[11px] text-muted",children:C})]})}const lE=[{id:"overview",isVisible:()=>!0,render:({overviewProps:e})=>a.jsx(oE,{...e})},{id:"compareMetadata",isVisible:({compareActive:e,compareReady:t})=>e&&t,render:({compareMetadataProps:e})=>a.jsx(Px,{...e})},{id:"basics",isVisible:()=>!0,render:({basicsProps:e})=>a.jsx(Dk,{...e})},{id:"metadata",isVisible:({multi:e})=>!e,render:({metadataProps:e})=>a.jsx(Tx,{...e})},{id:"notes",isVisible:()=>!0,render:({notesProps:e})=>a.jsx(Qk,{...e})}];function aE(e,t){const n=uE(e)||"view",r=new Set(t.map(i=>i.id));if(!r.has(n))return n;let s=2;for(;r.has(`${n}-${s}`);)s+=1;return`${n}-${s}`}function uE(e){return e.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function Rc(e){const t=e.filter(s=>s>0).sort((s,i)=>i-s),n=e.includes(0),r=[...t.map(s=>String(s))];return n&&r.push("None"),r.join(", ")}function cE(e,t){return e&&t?`${e} to ${t}`:e?`from ${e}`:t?`to ${t}`:""}function dE(e){if(e==="/"||e==="")return"Root";const t=e.split("/").filter(Boolean);return t.length?t.length<=2?`/${t.join("/")}`:`.../${t.slice(-2).join("/")}`:"Root"}function fE(e,t,n,r){return!n||r?t:e==="/"||e===""?e||"/":n===e||n.startsWith(`${e}/`)?e:t}function hE(e,t){return`${zm(e)}${zm(t)}`}function zm(e){const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function pE(e){const t=e.toLowerCase();return t.endsWith(".png")?"image/png":t.endsWith(".webp")?"image/webp":"image/jpeg"}function mE(e,t){const n=e.split("/").pop()??e;return{path:e,name:n,type:pE(e),w:0,h:0,size:0,hasThumb:!0,hasMeta:!1,star:t??null}}function ko(e,t){const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}function gE({selectedPaths:e,comparePathA:t,comparePathB:n}){if(e.length!==2)return null;if(t&&n)return[t,n];const[r,s]=e;return!r||!s?null:[r,s]}function yE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s,labelsText:i,embedMetadata:o,reverseOrder:l}){const c=e.length;if(c<2)return{ok:!1,message:Qo};if(c===2){const d=gE({selectedPaths:e,comparePathA:t,comparePathB:n});if(!d)return{ok:!1,message:Qo};const[f,p]=d;return eE({pathA:f,pathB:p,labelsText:i,embedMetadata:o,reverseOrder:l})}return r?s!==null&&c>s?{ok:!1,message:_x(s,c)}:tE({paths:e,labelsText:i,embedMetadata:o,reverseOrder:l}):{ok:!1,message:Lx}}function vE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s}){const[i,o]=u.useState(""),[l,c]=u.useState(Dm),[d,f]=u.useState(null),[p,h]=u.useState(null),w=d!==null;u.useEffect(()=>{if(e.length<2){o(""),c(Dm),f(null),h(null);return}f(null),h(null)},[t,n,e]);const x=u.useCallback(y=>{o(y),h(null)},[]),b=u.useCallback(y=>{c(y)},[]),S=u.useCallback(async y=>{if(w)return;if(e.length<2){h(Qo);return}const v=yE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s,labelsText:i,embedMetadata:l,reverseOrder:y});if(!v.ok){h(v.message);return}f(y?"reverse":"normal"),h(null);try{const g=await pe.exportComparison(v.payload);ko(g,nE(y))}catch(g){const C=g instanceof Error?g.message:"Failed to export comparison.";h(C)}finally{f(null)}},[w,l,i,s,r,t,n,e]);return{compareExportLabelsText:i,compareExportEmbedMetadata:l,compareExportMode:d,compareExportError:p,compareExportBusy:w,handleCompareExportLabelsTextChange:x,handleCompareExportEmbedMetadataChange:b,runComparisonExport:S}}function $m(e,t){return e?`${e}::${t??""}`:null}function Bm(e,t,n){return!e||!t||!n?null:`${t}::${n}`}function Ga({activeRequestId:e,responseRequestId:t,activeContextKey:n,responseContextKey:r}){return e===t&&n===r}function xE({compareReady:e,comparePathA:t,comparePathB:n}){const[r,s]=u.useState("idle"),[i,o]=u.useState(null),[l,c]=u.useState(null),[d,f]=u.useState(null),[p,h]=u.useState(!1),[w,x]=u.useState(!1),[b,S]=u.useState(!1),y=Bm(e,t,n),m=u.useRef(0),v=u.useRef(y);v.current=y;const g=u.useCallback(async(E,T,M)=>{const I=m.current+1;m.current=I,s("loading"),o(null);try{const[j,B]=await Promise.all([pe.getMetadata(E),pe.getMetadata(T)]);if(!Ga({activeRequestId:m.current,responseRequestId:I,activeContextKey:v.current,responseContextKey:M}))return;c(j.meta),f(B.meta),s("loaded")}catch(j){if(!Ga({activeRequestId:m.current,responseRequestId:I,activeContextKey:v.current,responseContextKey:M}))return;const B=j instanceof Error?j.message:"Failed to load metadata";c(null),f(null),o(B),s("error")}},[]);u.useEffect(()=>{if(m.current+=1,!y||!t||!n){s("idle"),o(null),c(null),f(null),x(!1),S(!1);return}h(!1),x(!1),S(!1),g(t,n,y)},[y,t,n,g]);const C=u.useCallback(()=>{const E=Bm(e,t,n);!E||!t||!n||g(t,n,E)},[e,t,n,g]);return{compareMetaState:r,compareMetaError:i,compareMetaA:l,compareMetaB:d,compareIncludePilInfo:p,compareShowPilInfoA:w,compareShowPilInfoB:b,setCompareIncludePilInfo:h,setCompareShowPilInfoA:x,setCompareShowPilInfoB:S,reloadCompareMetadata:C}}function wE({path:e,sidecarUpdatedAt:t}){const[n,r]=u.useState(null),[s,i]=u.useState(null),[o,l]=u.useState("idle"),[c,d]=u.useState(!1),f=$m(e,t),p=u.useRef(0),h=u.useRef(f);h.current=f,u.useEffect(()=>{p.current+=1,r(null),i(null),l("idle"),d(!1)},[f]);const w=u.useCallback(async()=>{const x=$m(e,t);if(!x||!e)return;const b=p.current+1;p.current=b,l("loading"),i(null);try{const S=await pe.getMetadata(e);if(!Ga({activeRequestId:p.current,responseRequestId:b,activeContextKey:h.current,responseContextKey:x}))return;r(S.meta),l("loaded")}catch(S){if(!Ga({activeRequestId:p.current,responseRequestId:b,activeContextKey:h.current,responseContextKey:x}))return;const y=S instanceof Error?S.message:"Failed to load metadata";r(null),i(y),l("error")}},[e,t]);return{metaRaw:n,metaError:s,metaState:o,showPilInfo:c,setMetaError:i,setShowPilInfo:d,fetchMetadata:w}}function bE({path:e,sidecarUpdatedAt:t,selectedPaths:n,compareReady:r,comparePathA:s,comparePathB:i,compareExportSupportsV2:o,compareExportMaxPathsV2:l}){const c=wE({path:e,sidecarUpdatedAt:t}),d=xE({compareReady:r,comparePathA:s,comparePathB:i}),f=vE({selectedPaths:n,comparePathA:s,comparePathB:i,compareExportSupportsV2:o,compareExportMaxPathsV2:l});return{metaRaw:c.metaRaw,metaError:c.metaError,metaState:c.metaState,showPilInfo:c.showPilInfo,setMetaError:c.setMetaError,compareMetaState:d.compareMetaState,compareMetaError:d.compareMetaError,compareMetaA:d.compareMetaA,compareMetaB:d.compareMetaB,compareIncludePilInfo:d.compareIncludePilInfo,compareShowPilInfoA:d.compareShowPilInfoA,compareShowPilInfoB:d.compareShowPilInfoB,compareExportLabelsText:f.compareExportLabelsText,compareExportEmbedMetadata:f.compareExportEmbedMetadata,compareExportMode:f.compareExportMode,compareExportError:f.compareExportError,compareExportBusy:f.compareExportBusy,setShowPilInfo:c.setShowPilInfo,setCompareIncludePilInfo:d.setCompareIncludePilInfo,setCompareShowPilInfoA:d.setCompareShowPilInfoA,setCompareShowPilInfoB:d.setCompareShowPilInfoB,fetchMetadata:c.fetchMetadata,reloadCompareMetadata:d.reloadCompareMetadata,handleCompareExportLabelsTextChange:f.handleCompareExportLabelsTextChange,handleCompareExportEmbedMetadataChange:f.handleCompareExportEmbedMetadataChange,runComparisonExport:f.runComparisonExport}}function Vl(e){return{notes:(e==null?void 0:e.notes)??"",tags:((e==null?void 0:e.tags)??[]).join(", ")}}function Ya(e){return e.split(",").map(t=>t.trim()).filter(Boolean)}function SE(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function CE(e,t){return e!==t}function kE(e,t){return!SE(Ya(e),Ya(t))}function EE({path:e,selectedPaths:t,multi:n,sidecar:r,conflict:s,star:i,queryClient:o,mutateSidecar:l,onStarChanged:c,onLocalTypingChange:d}){const[f,p]=u.useState(""),[h,w]=u.useState(""),x=u.useRef(!1),b=u.useRef(!1),S=u.useRef(!1),y=u.useRef(Vl(void 0)),m=u.useCallback(F=>{x.current!==F&&(x.current=F,d==null||d(F))},[d]),v=u.useCallback(F=>{y.current=F,b.current=!1,S.current=!1,p(F.tags),w(F.notes),m(!1)},[m]);u.useEffect(()=>{if(!e){v(Vl(void 0));return}v(Vl(r))},[e,v,r==null?void 0:r.updated_at,r==null?void 0:r.version]),u.useEffect(()=>()=>{m(!1)},[m]);const g=u.useCallback(F=>{if(n&&t.length){Cx(t,F);return}e&&l(F,(r==null?void 0:r.version)??1)},[n,l,e,t,r==null?void 0:r.version]),C=u.useMemo(()=>({tags:!!(s!=null&&s.pending.set_tags),notes:(s==null?void 0:s.pending.set_notes)!==void 0,star:(s==null?void 0:s.pending.set_star)!==void 0}),[s]),E=u.useCallback(F=>{w(F),b.current=!0,m(!0)},[m]),T=u.useCallback(()=>{const F=b.current;b.current=!1,F&&CE(h,y.current.notes)&&(g({notes:h}),y.current={...y.current,notes:h}),m(!1)},[g,h,m]),M=u.useCallback(F=>{p(F),S.current=!0,m(!0)},[m]),I=u.useCallback(()=>{const F=S.current;S.current=!1,F&&kE(f,y.current.tags)&&(g({tags:Ya(f)}),y.current={...y.current,tags:f}),m(!1)},[g,m,f]),j=u.useCallback(()=>{if(!s||!e)return;const F={};s.pending.set_tags!==void 0&&(F.tags=Ya(f)),s.pending.set_notes!==void 0&&(F.notes=h),s.pending.set_star!==void 0&&(F.star=i??null),l(F,s.current.version??1)},[s,l,h,e,i,f]),B=u.useCallback(()=>{if(!s||!e)return;const F=s.current,Q=Vl(F);y.current=Q,b.current=!1,S.current=!1,p(Q.tags),w(Q.notes),m(!1),o.setQueryData(Wo(e),F),wu(e),c==null||c([e],F.star??null)},[s,m,c,e,o]);return{tags:f,notes:h,conflictFields:C,commitSidecar:g,applyConflict:j,keepTheirs:B,handleNotesChange:E,handleNotesBlur:T,handleTagsChange:M,handleTagsBlur:I}}const NE=["overview","compare","basics","metadata","notes"],Um="lenslet.inspector.sections",Vm="lenslet.inspector.metricsExpanded",ME={overview:!0,compare:!0,metadata:!0,basics:!0,notes:!0};function Kt(e){e.current!==null&&(window.clearTimeout(e.current),e.current=null)}function jE({path:e,sidecarUpdatedAt:t,compareReady:n,comparePathA:r,comparePathB:s}){const[i,o]=u.useState(ME),[l,c]=u.useState(!1),[d,f]=u.useState(null),[p,h]=u.useState(!1),[w,x]=u.useState(null),[b,S]=u.useState(null),[y,m]=u.useState(null),[v,g]=u.useState(null),C=u.useRef(null),E=u.useRef(null),T=u.useRef(null),M=u.useRef(null),I=u.useRef(null),j=u.useCallback(U=>{o(_=>({..._,[U]:!_[U]}))},[]),B=u.useCallback(()=>j("overview"),[j]),F=u.useCallback(()=>j("compare"),[j]),Q=u.useCallback(()=>j("basics"),[j]),ee=u.useCallback(()=>j("metadata"),[j]),z=u.useCallback(()=>j("notes"),[j]),L=u.useCallback(()=>{c(U=>!U)},[]),R=u.useCallback(U=>{f(U),Kt(C),C.current=window.setTimeout(()=>{f(_=>_===U?null:_),C.current=null},1e3)},[]),P=u.useCallback(()=>{h(!0),Kt(E),E.current=window.setTimeout(()=>{h(!1),E.current=null},1200)},[]),A=u.useCallback(U=>{x(U),Kt(T),T.current=window.setTimeout(()=>{x(null),T.current=null},900)},[]),O=u.useCallback(U=>{S(U),Kt(M),M.current=window.setTimeout(()=>{S(_=>_===U?null:_),M.current=null},1200)},[]),K=u.useCallback((U,_)=>{U==="A"?m(_):g(_),Kt(I),I.current=window.setTimeout(()=>{m(null),g(null),I.current=null},900)},[]);return u.useEffect(()=>{try{const U=localStorage.getItem(Um);if(!U)return;const _=JSON.parse(U);if(!_||typeof _!="object")return;const G={};for(const V of NE)typeof _[V]=="boolean"&&(G[V]=_[V]);Object.keys(G).length>0&&o(V=>({...V,...G}))}catch{}},[]),u.useEffect(()=>{try{localStorage.setItem(Um,JSON.stringify(i))}catch{}},[i]),u.useEffect(()=>{try{const U=localStorage.getItem(Vm);U==="1"||U==="true"?c(!0):(U==="0"||U==="false")&&c(!1)}catch{}},[]),u.useEffect(()=>{try{localStorage.setItem(Vm,l?"1":"0")}catch{}},[l]),u.useEffect(()=>{h(!1),x(null),Kt(E),Kt(T)},[e,t]),u.useEffect(()=>{S(null),m(null),g(null),Kt(M),Kt(I)},[r,s,n]),u.useEffect(()=>()=>{Kt(C),Kt(E),Kt(T),Kt(M),Kt(I)},[]),{openSections:i,toggleOverviewSection:B,toggleCompareSection:F,toggleBasicsSection:Q,toggleMetadataSection:ee,toggleNotesSection:z,metricsExpanded:l,toggleMetricsExpanded:L,copiedField:d,markInfoCopied:R,metaCopied:p,markMetadataCopied:P,metaValueCopiedPath:w,markMetadataValueCopied:A,compareMetaCopied:b,markCompareMetadataCopied:O,compareValueCopiedPathA:y,compareValueCopiedPathB:v,markCompareMetadataValueCopied:K}}const RE=12,PE=120,TE=8,IE=80;function LE({path:e,selectedPaths:t=[],items:n=[],compareActive:r=!1,compareA:s=null,compareB:i=null,onOpenCompare:o,onResize:l,onStarChanged:c,sortSpec:d,onFindSimilar:f,embeddingsAvailable:p=!1,embeddingsLoading:h=!1,compareExportSupportsV2:w=!1,compareExportMaxPathsV2:x=null,onLocalTypingChange:b}){const S=!!e,{data:y}=Nk(e??""),m=Mk(e??""),v=wr(),g=t.length>1,C=!!f&&p&&!g,E=f?p?g?"Select a single image to search.":null:h?"Loading embeddings...":"No embeddings detected.":null,M=u.useMemo(()=>{var ve;return((ve=n.find(Xe=>Xe.path===e))==null?void 0:ve.star)??null},[n,e])??(y==null?void 0:y.star)??null,I=vk(g?null:e),j=(s==null?void 0:s.path)??null,B=(i==null?void 0:i.path)??null,F=t.length===2&&!!t[0]&&!!t[1],ee=r&&(!!j&&!!B),{openSections:z,toggleOverviewSection:L,toggleCompareSection:R,toggleBasicsSection:P,toggleMetadataSection:A,toggleNotesSection:O,metricsExpanded:K,toggleMetricsExpanded:U,copiedField:_,markInfoCopied:G,metaCopied:V,markMetadataCopied:J,metaValueCopiedPath:se,markMetadataValueCopied:Y,compareMetaCopied:q,markCompareMetadataCopied:H,compareValueCopiedPathA:fe,compareValueCopiedPathB:Te,markCompareMetadataValueCopied:we}=jE({path:e,sidecarUpdatedAt:y==null?void 0:y.updated_at,comparePathA:j,comparePathB:B,compareReady:ee}),he=ee&&r&&z.compare,ze=!g&&z.metadata,Ue=(s==null?void 0:s.name)??j??"A",Tt=(i==null?void 0:i.name)??B??"B",Bt=u.useCallback((te,ve)=>{m.mutate({patch:te,baseVersion:ve,idempotencyKey:vu("patch")})},[m]),{tags:Ut,notes:Dn,conflictFields:tn,commitSidecar:Cn,applyConflict:Vt,keepTheirs:le,handleNotesChange:oe,handleNotesBlur:ge,handleTagsChange:Ie,handleTagsBlur:Se}=EE({path:e,selectedPaths:t,multi:g,sidecar:y,conflict:I,star:M,queryClient:v,mutateSidecar:Bt,onStarChanged:c,onLocalTypingChange:b}),{metaRaw:ce,metaError:Fe,metaState:Ge,showPilInfo:et,setMetaError:kn,compareMetaState:gt,compareMetaError:zn,compareMetaA:Ce,compareMetaB:rt,compareIncludePilInfo:dn,compareShowPilInfoA:$n,compareShowPilInfoB:Wt,compareExportLabelsText:Bi,compareExportEmbedMetadata:D,compareExportMode:X,compareExportError:ae,compareExportBusy:ye,setShowPilInfo:be,setCompareIncludePilInfo:Ee,setCompareShowPilInfoA:ie,setCompareShowPilInfoB:Ne,fetchMetadata:me,reloadCompareMetadata:it,handleCompareExportLabelsTextChange:Oe,handleCompareExportEmbedMetadataChange:yt,runComparisonExport:Ht}=bE({path:e,sidecarUpdatedAt:y==null?void 0:y.updated_at,selectedPaths:t,compareReady:ee,comparePathA:j,comparePathB:B,compareExportSupportsV2:w,compareExportMaxPathsV2:x}),En=u.useMemo(()=>{const te=new Set(t);return n.filter(ve=>te.has(ve.path))},[n,t]),fn=u.useMemo(()=>En.reduce((te,ve)=>te+(ve.size||0),0),[En]);u.useEffect(()=>{if(!e)return;const te=ve=>{if(ch(ve.target))return;const Xe=ve.key;if(!/^[0-5]$/.test(Xe))return;ve.preventDefault();const tr=Xe==="0"?null:Number(Xe);if(g&&t.length){Cn({star:tr}),c==null||c(t,tr);return}Cn({star:tr}),c==null||c([e],tr)};return window.addEventListener("keydown",te),()=>window.removeEventListener("keydown",te)},[e,g,t,Cn,c]);const Ye=hs(e?()=>pe.getThumb(e):null,[e]),Bn=e?e.split("/").pop()||e:"",Ui=u.useMemo(()=>{var ve;if(Bn.includes("."))return Bn.slice(Bn.lastIndexOf(".")+1).toUpperCase();const te=n.find(Xe=>Xe.path===e);return(ve=te==null?void 0:te.type)!=null&&ve.includes("/")?te.type.split("/")[1].toUpperCase():""},[Bn,n,e]),vt=u.useMemo(()=>n.find(te=>te.path===e),[n,e]),St=u.useMemo(()=>e?(vt==null?void 0:vt.source)??e:"",[vt,e]),Ct=u.useMemo(()=>{if(!ce)return"";try{return JSON.stringify(ce,null,1)}catch{return""}},[ce]),Qt=u.useMemo(()=>kc(ce),[ce]),Fs=u.useMemo(()=>kc(Ce),[Ce]),Un=u.useMemo(()=>kc(rt),[rt]),Zn=u.useMemo(()=>Ec(Qt,et),[Qt,et]),ll=u.useMemo(()=>{if(!Ce)return"";try{return JSON.stringify(Ce,null,1)}catch{return""}},[Ce]),Vi=u.useMemo(()=>{if(!rt)return"";try{return JSON.stringify(rt,null,1)}catch{return""}},[rt]),Vn=u.useMemo(()=>Ec(Fs,$n),[Fs,$n]),er=u.useMemo(()=>Ec(Un,Wt),[Un,Wt]),al=u.useCallback(()=>{var te;Ct&&((te=navigator.clipboard)==null||te.writeText(Ct).then(()=>{J()}).catch(ve=>{const Xe=ve instanceof Error?ve.message:"Copy failed";kn(Xe)}))},[J,Ct,kn]),Su=u.useMemo(()=>!ze||!Zn?null:Co(Zn),[ze,Zn]),Cu=u.useMemo(()=>!he||!Vn?null:Co(Vn),[he,Vn]),ku=u.useMemo(()=>!he||!er?null:Co(er),[he,er]),Wi=u.useCallback((te,ve)=>{var Xe;(Xe=navigator.clipboard)==null||Xe.writeText(ve).then(()=>{Y(te)}).catch(()=>{})},[Y]),ss=u.useCallback((te,ve,Xe)=>{var tr;(tr=navigator.clipboard)==null||tr.writeText(Xe).then(()=>{we(te,ve)}).catch(()=>{})},[we]),Eu=u.useCallback(te=>{if(!Zn)return;const ve=Nc(Zn,te);Wi(ve.pathLabel,ve.copyText)},[Zn,Wi]),Nu=u.useCallback(te=>{if(!Vn)return;const ve=Nc(Vn,te);ss("A",ve.pathLabel,ve.copyText)},[Vn,ss]),Mu=u.useCallback(te=>{if(!er)return;const ve=Nc(er,te);ss("B",ve.pathLabel,ve.copyText)},[er,ss]),ul=u.useCallback(te=>{var Xe;const ve=te==="A"?ll:Vi;ve&&((Xe=navigator.clipboard)==null||Xe.writeText(ve).then(()=>{H(te)}).catch(()=>{}))},[ll,Vi,H]);let Os=Zn?"":"PNG metadata not loaded yet.";Ge==="loading"?Os="Loading metadata":Ge==="error"&&Fe&&(Os=Fe);let Hi="Metadata not loaded yet.";gt==="loading"?Hi="Loading metadata":gt==="error"&&zn&&(Hi=zn);const cl=Ge==="loading",br=Ge==="loaded"&&!!Ct,dl=br?"h-48":"h-24";let Ds="Load meta";cl?Ds="Loading":br&&(Ds=V?"Copied":"Copy");const ju=br?al:me,fl=Mc(ce),hl=Mc(Ce),Ru=Mc(rt),zs=u.useMemo(()=>he?Ik(Fs,Un,{includePilInfo:dn,limit:PE,maxDepth:TE,maxArray:IE}):null,[he,Fs,Un,dn]),pl=u.useCallback((te,ve)=>{var Xe;ve&&((Xe=navigator.clipboard)==null||Xe.writeText(ve).then(()=>{G(te)}).catch(()=>{}))},[G]),Pu=u.useCallback(te=>{if(g&&t.length){c==null||c(t,te),Cx(t,{star:te});return}e&&(c==null||c([e],te),kx(e,{star:te}))},[g,c,e,t]),$s=u.useCallback(()=>{be(te=>!te)},[be]),Tu=u.useCallback(()=>{Ee(te=>!te)},[Ee]),Iu=u.useCallback(()=>{ie(te=>!te)},[ie]),Lu=u.useCallback(()=>{Ne(te=>!te)},[Ne]),_u=u.useCallback(te=>{Ht(te)},[Ht]),Au=!g&&!!I&&(tn.tags||tn.notes),Fu=!g&&!!I&&tn.star,ml="toolbar-offset sidebar-resize-handle sidebar-resize-handle-right absolute bottom-0";if(!S)return a.jsx("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:a.jsx("div",{className:ml,onPointerDown:l})});const Qi={multi:g,compareActive:r,compareReady:ee,overviewProps:{open:z.overview,onToggle:L,multi:g,selectedCount:t.length,totalSize:fn,filename:Bn,compareActive:r,compareReady:F,onOpenCompare:o,compareExportSupportsV2:w,compareExportMaxPathsV2:x,compareExportLabelsText:Bi,onCompareExportLabelsTextChange:Oe,compareExportEmbedMetadata:D,onCompareExportEmbedMetadataChange:yt,compareExportBusy:ye,compareExportMode:X,onComparisonExport:_u,compareExportError:ae,onFindSimilar:f,canFindSimilar:C,findSimilarDisabledReason:E},compareMetadataProps:{open:z.compare,onToggle:R,compareMetaState:gt,compareMetaError:zn,compareLabelA:Ue,compareLabelB:Tt,compareIncludePilInfo:dn,onToggleCompareIncludePilInfo:Tu,onReload:it,compareDiff:zs,compareHasPilInfoA:hl,compareHasPilInfoB:Ru,compareShowPilInfoA:$n,compareShowPilInfoB:Wt,onToggleCompareShowPilInfoA:Iu,onToggleCompareShowPilInfoB:Lu,compareMetaCopied:q,onCopyCompareMetadata:ul,compareValueCopiedPathA:fe,compareValueCopiedPathB:Te,compareDisplayNodeA:Cu,compareDisplayNodeB:ku,compareMetaContent:Hi,onCompareMetaPathCopyA:Nu,onCompareMetaPathCopyB:Mu},basicsProps:{open:z.basics,onToggle:P,multi:g,star:M,onSelectStar:Pu,hasStarConflict:Fu,onApplyConflict:Vt,onKeepTheirs:le,currentItem:vt??null,sourceValue:St,sortSpec:d,copiedField:_,onCopyInfo:pl,metricsExpanded:K,onToggleMetricsExpanded:U,metricsPreviewLimit:RE},metadataProps:{open:z.metadata,onToggle:A,metadataLoading:cl,metadataActionLabel:Ds,onMetadataAction:ju,metadataActionDisabled:!e,hasPilInfo:fl,showPilInfo:et,onToggleShowPilInfo:$s,metaValueCopiedPath:se,metaHeightClass:dl,metaLoaded:br,metaDisplayNode:Su,metaContent:Os,metaError:Fe,onMetaPathCopy:Eu},notesProps:{open:z.notes,onToggle:O,multi:g,showConflictBanner:Au,onApplyConflict:Vt,onKeepTheirs:le,notes:Dn,onNotesChange:oe,onNotesBlur:ge,tags:Ut,onTagsChange:Ie,onTagsBlur:Se}};return a.jsxs("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:[!g&&a.jsx("div",{className:"p-3 border-b border-border flex justify-center",children:a.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-border w-[220px] h-[160px] bg-panel select-none",children:[Ye&&a.jsx("img",{src:Ye,alt:"thumb",className:"block w-full h-full object-contain"}),!!Ui&&a.jsx("div",{className:"absolute top-1.5 left-1.5 bg-surface border border-border text-text text-xs px-1.5 py-0.5 rounded-md select-none",children:Ui})]})}),lE.filter(te=>te.isVisible(Qi)).map(te=>a.jsx(u.Fragment,{children:te.render(Qi)},te.id)),a.jsx("div",{className:ml,onPointerDown:l})]})}function _E({open:e,embeddings:t,rejected:n=[],selectedPath:r,embeddingsLoading:s=!1,embeddingsError:i,onClose:o,onSearch:l}){const[c,d]=u.useState(""),[f,p]=u.useState("path"),[h,w]=u.useState(""),[x,b]=u.useState(""),[S,y]=u.useState("50"),[m,v]=u.useState(""),[g,C]=u.useState(null),[E,T]=u.useState(!1),M=u.useRef(null),I=u.useRef(null),j=u.useMemo(()=>t.find(L=>L.name===c)??t[0]??null,[t,c]);u.useEffect(()=>{e&&(C(null),t.length>0&&!t.some(L=>L.name===c)&&d(t[0].name),r?(p("path"),w(r)):(p("vector"),w("")))},[e,t,c,r]),u.useEffect(()=>{if(!e)return;const L=f==="vector"?I.current:M.current,R=window.requestAnimationFrame(()=>L==null?void 0:L.focus());return()=>window.cancelAnimationFrame(R)},[e,f]);const B=u.useCallback(async()=>{if(C(null),!t.length){C("No embeddings available for similarity search.");return}if(!j){C("Select an embedding to search.");return}const L=h.trim(),R=x.trim(),P=Number(S);if(!Number.isFinite(P)||P<=0){C("Top K must be a positive number.");return}const A=Math.min(1e3,Math.max(1,Math.floor(P))),O=m.trim()===""?null:Number(m);if(O!=null&&!Number.isFinite(O)){C("Min score must be a valid number.");return}if(f==="path"&&!L){C("Select an image path for the query.");return}if(f==="vector"&&!R){C("Paste a base64 vector for the query.");return}const K={embedding:j.name,query_path:f==="path"?L:null,query_vector_b64:f==="vector"?R:null,top_k:A,min_score:O};T(!0);try{await l(K),o()}catch(U){U instanceof ln||U instanceof Error?C(U.message):C("Failed to run similarity search.")}finally{T(!1)}},[t.length,j,h,x,S,m,f,l,o]);u.useEffect(()=>{if(!e)return;const L=R=>{if(R.key==="Escape"){R.preventDefault(),o();return}(R.ctrlKey||R.metaKey)&&R.key==="Enter"&&(R.preventDefault(),B())};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[e,o,B]);const F=u.useCallback(()=>{var L;r&&(p("path"),w(r),(L=M.current)==null||L.focus())},[r]);if(!e)return null;const Q=t.map(L=>({value:L.name,label:L.name})),ee=n.length>0,z=n.slice(0,3);return a.jsx("div",{className:"fixed inset-0 z-[var(--z-overlay)] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",onClick:L=>{L.target===L.currentTarget&&o()},children:a.jsxs("div",{className:"w-full max-w-2xl rounded-lg border border-border bg-panel shadow-[0_20px_50px_rgba(0,0,0,0.55)]",onClick:L=>L.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Find similar",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Find similar"}),a.jsx("div",{className:"text-xs text-muted",children:"Search with embeddings"})]}),a.jsx("button",{className:"btn btn-sm",onClick:o,"aria-label":"Close",children:"Close"})]}),a.jsxs("div",{className:"px-4 py-4 space-y-4",children:[i&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:i}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Embedding"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(oh,{value:(j==null?void 0:j.name)??"",onChange:d,options:Q,placeholder:s?"Loading embeddings...":"Select embedding",disabled:!t.length,triggerClassName:"min-w-[180px]"}),j&&a.jsxs("span",{className:"text-xs text-muted",children:[j.dimension," dims, ",j.metric,", ",j.dtype]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Query mode"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:`btn btn-sm ${f==="path"?"btn-active":""}`,onClick:()=>p("path"),"aria-pressed":f==="path",children:"Selected image"}),a.jsx("button",{type:"button",className:`btn btn-sm ${f==="vector"?"btn-active":""}`,onClick:()=>p("vector"),"aria-pressed":f==="vector",children:"Vector input"})]})]}),f==="path"?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Image path"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{ref:M,type:"text",className:"input w-full",value:h,onChange:L=>w(L.target.value),placeholder:r?"Selected image path":"Select an image first"}),a.jsx("button",{type:"button",className:"btn btn-sm",onClick:F,disabled:!r,title:r?"Use selected image":"Select an image first",children:"Use selected"})]})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Vector (base64 float32)"}),a.jsx("textarea",{ref:I,className:"ui-textarea w-full font-mono text-[11px]",rows:5,value:x,onChange:L=>b(L.target.value),placeholder:"Paste base64-encoded float32 vector"}),a.jsx("div",{className:"text-[11px] text-muted",children:"Base64 of little-endian float32. Length must match embedding dimension."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Top K"}),a.jsx("input",{type:"number",min:1,max:1e3,step:1,className:"input ui-number w-full",value:S,onChange:L=>y(L.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Min score"}),a.jsx("input",{type:"number",step:.01,className:"input ui-number w-full",value:m,onChange:L=>v(L.target.value),placeholder:"Optional"})]})]}),ee&&a.jsxs("div",{className:"ui-banner text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Skipped columns"}),a.jsxs("div",{className:"mt-1 space-y-1 text-muted",children:[z.map(L=>a.jsxs("div",{children:[L.name,": ",L.reason]},L.name)),n.length>z.length&&a.jsxs("div",{children:["+",n.length-z.length," more"]})]})]}),g&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:g})]}),a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-border",children:[a.jsx("div",{className:"text-xs text-muted",children:j?`Metric: ${j.metric}`:"Metric: cosine"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:o,disabled:E,children:"Cancel"}),a.jsx("button",{className:"btn btn-sm btn-active",onClick:B,disabled:E||!t.length,children:E?"Searching...":"Find similar"})]})]})]})})}const AE=/^[\/@a-zA-Z0-9._\-\/]{1,512}$/,FE=[".jpg",".jpeg",".png",".webp"];function Rt(e){try{const t=decodeURI(e||""),r=(t.startsWith("/")?t:`/${t}`).replace(/\/{2,}/g,"/"),s=r.length>1?r.replace(/\/$/,""):r;return AE.test(s)?s:"/"}catch{return"/"}}function Wm(){return(window.location.hash||"").replace(/^#/,"")}function Fx(e){const t=Rt(e),n=`#${encodeURI(t)}`;window.location.hash!==n&&(window.location.hash=n)}function Wl(e){const t=Rt(e),n=`#${encodeURI(t)}`;if(window.location.hash!==n){const r=`${window.location.pathname}${window.location.search}${n}`;window.history.replaceState(window.history.state,"",r)}}function OE(e){const n=Rt(e).toLowerCase();return FE.some(r=>n.endsWith(r))}function Ox(e,t){const n=e.replace(/\/+$/,""),r=t.replace(/^\/+/,""),s=[n,r].filter(Boolean).join("/");return s.startsWith("/")?s:`/${s}`}function Hm(e){const n=Rt(e).split("/").filter(Boolean);return n.length<=1?"/":"/"+n.slice(0,-1).join("/")}function ph(e){return Rt(e).split("/").filter(Boolean).pop()||""}function DE(e){return e.endsWith("/_trash_")}const zE=new Set([0,1,2,3,4,5]),mh=new Set(["<","<=",">",">="]),$E=/^\d{4}-\d{2}-\d{2}$/;function BE(e,t){return!t||!t.and.length?e:e.filter(n=>UE(n,t.and))}function UE(e,t){for(const n of t)if(!VE(e,n))return!1;return!0}function VE(e,t){var n,r,s,i,o,l,c;if("stars"in t){const d=t.stars;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsIn"in t){const d=t.starsIn.values;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsNotIn"in t){const d=t.starsNotIn.values;if(!d||!d.length)return!0;const f=e.star??0;return!d.includes(f)}if("nameContains"in t){const d=(n=t.nameContains.value)==null?void 0:n.trim();return d?(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("nameNotContains"in t){const d=(r=t.nameNotContains.value)==null?void 0:r.trim();return d?!(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("commentsContains"in t){const d=(s=t.commentsContains.value)==null?void 0:s.trim();if(!d)return!0;const f=e.comments??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("commentsNotContains"in t){const d=(i=t.commentsNotContains.value)==null?void 0:i.trim();if(!d)return!0;const f=e.comments??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("urlContains"in t){const d=(o=t.urlContains.value)==null?void 0:o.trim();if(!d)return!0;const f=e.source??e.url??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("urlNotContains"in t){const d=(l=t.urlNotContains.value)==null?void 0:l.trim();if(!d)return!0;const f=e.source??e.url??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("dateRange"in t){const{from:d,to:f}=t.dateRange;if(!d&&!f)return!0;if(!e.addedAt)return!1;const p=Date.parse(e.addedAt);if(Number.isNaN(p))return!1;const h=qm(d,!1),w=qm(f,!0);return!(h!=null&&p<h||w!=null&&p>w)}if("widthCompare"in t){const{op:d,value:f}=t.widthCompare;if(!Number.isFinite(f))return!0;const p=e.w;return!Number.isFinite(p)||p<=0?!1:Gm(p,d,f)}if("heightCompare"in t){const{op:d,value:f}=t.heightCompare;if(!Number.isFinite(f))return!0;const p=e.h;return!Number.isFinite(p)||p<=0?!1:Gm(p,d,f)}if("metricRange"in t){const{key:d,min:f,max:p}=t.metricRange,h=(c=e.metrics)==null?void 0:c[d];return!(h==null||h<f||h>p)}return!0}function tf(e){if(!e||typeof e!="object")return null;const t=e.and;if(!Array.isArray(t))return null;const n=[];for(const r of t){const s=sN(r);s&&n.push(s)}return{and:n}}function Qm(e){var r;const t=e.and.find(s=>"stars"in s),n=e.and.find(s=>"starsIn"in s);return(r=n==null?void 0:n.starsIn)!=null&&r.values?n.starsIn.values:(t==null?void 0:t.stars)??[]}function Pc(e,t){return Dx(e,t)}function WE(e){var n;const t=e.and.find(r=>"starsIn"in r);return((n=t==null?void 0:t.starsIn)==null?void 0:n.values)??[]}function Dx(e,t){const n=Eo(t),r=e.and.filter(s=>!("starsIn"in s)&&!("stars"in s));return n.length?{and:[{starsIn:{values:n}},...r]}:{and:r}}function HE(e){var n;const t=e.and.find(r=>"starsNotIn"in r);return((n=t==null?void 0:t.starsNotIn)==null?void 0:n.values)??[]}function zx(e,t){const n=Eo(t),r=e.and.filter(s=>!("starsNotIn"in s));return n.length?{and:[{starsNotIn:{values:n}},...r]}:{and:r}}function QE(e){var n;const t=e.and.find(r=>"nameContains"in r);return((n=t==null?void 0:t.nameContains)==null?void 0:n.value)??null}function $x(e,t){const n=vn(t),r=e.and.filter(s=>!("nameContains"in s));return n?{and:[{nameContains:{value:n}},...r]}:{and:r}}function KE(e){var n;const t=e.and.find(r=>"nameNotContains"in r);return((n=t==null?void 0:t.nameNotContains)==null?void 0:n.value)??null}function Bx(e,t){const n=vn(t),r=e.and.filter(s=>!("nameNotContains"in s));return n?{and:[{nameNotContains:{value:n}},...r]}:{and:r}}function qE(e){var n;const t=e.and.find(r=>"commentsContains"in r);return((n=t==null?void 0:t.commentsContains)==null?void 0:n.value)??null}function Ux(e,t){const n=vn(t),r=e.and.filter(s=>!("commentsContains"in s));return n?{and:[{commentsContains:{value:n}},...r]}:{and:r}}function GE(e){var n;const t=e.and.find(r=>"commentsNotContains"in r);return((n=t==null?void 0:t.commentsNotContains)==null?void 0:n.value)??null}function Vx(e,t){const n=vn(t),r=e.and.filter(s=>!("commentsNotContains"in s));return n?{and:[{commentsNotContains:{value:n}},...r]}:{and:r}}function YE(e){var n;const t=e.and.find(r=>"urlContains"in r);return((n=t==null?void 0:t.urlContains)==null?void 0:n.value)??null}function Wx(e,t){const n=vn(t),r=e.and.filter(s=>!("urlContains"in s));return n?{and:[{urlContains:{value:n}},...r]}:{and:r}}function XE(e){var n;const t=e.and.find(r=>"urlNotContains"in r);return((n=t==null?void 0:t.urlNotContains)==null?void 0:n.value)??null}function Hx(e,t){const n=vn(t),r=e.and.filter(s=>!("urlNotContains"in s));return n?{and:[{urlNotContains:{value:n}},...r]}:{and:r}}function JE(e){const t=e.and.find(n=>"dateRange"in n);return(t==null?void 0:t.dateRange)??null}function nf(e,t){const n=Xa((t==null?void 0:t.from)??null),r=Xa((t==null?void 0:t.to)??null),s=e.and.filter(i=>!("dateRange"in i));return!n&&!r?{and:s}:{and:[{dateRange:{...n?{from:n}:{},...r?{to:r}:{}}},...s]}}function ZE(e){const t=e.and.find(n=>"widthCompare"in n);return(t==null?void 0:t.widthCompare)??null}function pa(e,t){const n=e.and.filter(r=>!("widthCompare"in r));return!t||!Number.isFinite(t.value)||!mh.has(t.op)?{and:n}:{and:[{widthCompare:{op:t.op,value:t.value}},...n]}}function eN(e){const t=e.and.find(n=>"heightCompare"in n);return(t==null?void 0:t.heightCompare)??null}function ma(e,t){const n=e.and.filter(r=>!("heightCompare"in r));return!t||!Number.isFinite(t.value)||!mh.has(t.op)?{and:n}:{and:[{heightCompare:{op:t.op,value:t.value}},...n]}}function tN(e,t){const n=e.and.find(r=>"metricRange"in r&&r.metricRange.key===t);return(n==null?void 0:n.metricRange)??null}function nN(e,t,n){const r=e.and.filter(s=>!("metricRange"in s&&s.metricRange.key===t));return n?{and:[{metricRange:{key:t,min:n.min,max:n.max}},...r]}:{and:r}}function rN(e){const t=tf(e);return t?t.and.length:0}function sN(e){var t,n,r,s,i,o,l,c;if(!e||typeof e!="object")return null;if("stars"in e){const d=Eo(e.stars);return d.length?{starsIn:{values:d}}:null}if("starsIn"in e){const d=Eo((t=e.starsIn)==null?void 0:t.values);return d.length?{starsIn:{values:d}}:null}if("starsNotIn"in e){const d=Eo((n=e.starsNotIn)==null?void 0:n.values);return d.length?{starsNotIn:{values:d}}:null}if("nameContains"in e){const d=vn((r=e.nameContains)==null?void 0:r.value);return d?{nameContains:{value:d}}:null}if("nameNotContains"in e){const d=vn((s=e.nameNotContains)==null?void 0:s.value);return d?{nameNotContains:{value:d}}:null}if("commentsContains"in e){const d=vn((i=e.commentsContains)==null?void 0:i.value);return d?{commentsContains:{value:d}}:null}if("commentsNotContains"in e){const d=vn((o=e.commentsNotContains)==null?void 0:o.value);return d?{commentsNotContains:{value:d}}:null}if("urlContains"in e){const d=vn((l=e.urlContains)==null?void 0:l.value);return d?{urlContains:{value:d}}:null}if("urlNotContains"in e){const d=vn((c=e.urlNotContains)==null?void 0:c.value);return d?{urlNotContains:{value:d}}:null}if("dateRange"in e){const d=e.dateRange,f=Xa((d==null?void 0:d.from)??null),p=Xa((d==null?void 0:d.to)??null);return!f&&!p?null:{dateRange:{...f?{from:f}:{},...p?{to:p}:{}}}}if("widthCompare"in e){const d=e.widthCompare,f=Km(d==null?void 0:d.op,d==null?void 0:d.value);return f?{widthCompare:f}:null}if("heightCompare"in e){const d=e.heightCompare,f=Km(d==null?void 0:d.op,d==null?void 0:d.value);return f?{heightCompare:f}:null}if("metricRange"in e){const d=e.metricRange;if(!d||typeof d!="object")return null;const f=typeof d.key=="string"?d.key:"",p=rf(d.min),h=rf(d.max);return!f||p==null||h==null||p>h?null:{metricRange:{key:f,min:p,max:h}}}return null}function Eo(e){if(!Array.isArray(e))return[];const t=[],n=new Set;for(const r of e){const s=typeof r=="number"?r:typeof r=="string"?Number(r):NaN;!Number.isInteger(s)||!zE.has(s)||n.has(s)||(n.add(s),t.push(s))}return t}function vn(e){if(typeof e!="string")return null;const t=e.trim();return t||null}function Xa(e){if(typeof e!="string")return null;const t=e.trim();if(!t)return null;const n=Date.parse(t);return Number.isNaN(n)?null:t}function Km(e,t){if(typeof e!="string"||!mh.has(e))return null;const n=rf(t);return n==null?null:{op:e,value:n}}function qm(e,t){if(!e)return null;const n=e.trim();if(!n)return null;const r=Date.parse(n);return Number.isNaN(r)?null:t&&$E.test(n)?r+24*60*60*1e3-1:r}function Gm(e,t,n){switch(t){case"<":return e<n;case"<=":return e<=n;case">":return e>n;case">=":return e>=n;default:return!0}}function rf(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null}const ps={leftFolders:"leftW.folders",leftMetrics:"leftW.metrics",leftLegacy:"leftW",right:"rightW"},Ym=200,Xm=240,Qx=200;function iN(e){return Number.isFinite(e)&&e>0}function Hl(e){const t=Number(e);return iN(t)?t:null}function Kx(e,t,n){return Math.min(Math.max(e,t),n)}function oN(e){return e==="metrics"?ps.leftMetrics:ps.leftFolders}function lN(e){const t=Hl(e.getItem(ps.leftFolders))??Hl(e.getItem(ps.leftLegacy)),n=Hl(e.getItem(ps.leftMetrics)),r=Hl(e.getItem(ps.right));return{leftFoldersW:t,leftMetricsW:n,rightW:r}}function Jm(e,t,n){e.setItem(t,String(n))}function aN({clientX:e,appLeft:t,appWidth:n,rightWidth:r}){const s=e-t,i=Math.max(Ym,n-r-Qx);return Kx(s,Ym,i)}function uN({clientX:e,appLeft:t,appWidth:n,leftWidth:r}){const s=e-t,i=n-s,o=Math.max(Xm,n-r-Qx);return Kx(i,Xm,o)}function cN(e){return(e.pointerType??"mouse")==="mouse"&&e.button!==0}function dN(e,t){try{e.setPointerCapture(t)}catch{}}function fN(e,t){try{e.releasePointerCapture(t)}catch{}}function hN(e,t){const[n,r]=u.useState(240),[s,i]=u.useState(320),[o,l]=u.useState(240),c=t==="metrics"?s:n,d=u.useRef(c),f=u.useRef(o);u.useEffect(()=>{d.current=c},[c]),u.useEffect(()=>{f.current=o},[o]),u.useEffect(()=>{try{const x=lN(window.localStorage);x.leftFoldersW!==null&&r(x.leftFoldersW),x.leftMetricsW!==null&&i(x.leftMetricsW),x.rightW!==null&&l(x.rightW)}catch{}},[]);const p=(x,b,S)=>{if(cN(x))return;x.preventDefault();const y=x.currentTarget,m=x.pointerId;dN(y,m);const v=E=>{E.pointerId===m&&b(E)};function g(){window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",C),window.removeEventListener("pointercancel",C),fN(y,m)}function C(E){E.pointerId===m&&(g(),S())}window.addEventListener("pointermove",v),window.addEventListener("pointerup",C),window.addEventListener("pointercancel",C)};return{leftW:c,rightW:o,onResizeLeft:x=>{const b=e.current;if(!b)return;const S=b.getBoundingClientRect(),y=oN(t);let m=d.current;p(x,v=>{const g=aN({clientX:v.clientX,appLeft:S.left,appWidth:S.width,rightWidth:f.current});m=g,t==="metrics"?i(g):r(g)},()=>{try{Jm(window.localStorage,y,m)}catch{}})},onResizeRight:x=>{const b=e.current;if(!b)return;const S=b.getBoundingClientRect();let y=f.current;p(x,m=>{const v=uN({clientX:m.clientX,appLeft:S.left,appWidth:S.width,leftWidth:d.current});y=v,f.current=v,l(v)},()=>{try{Jm(window.localStorage,ps.right,y)}catch{}})}}}const qx=5*6e4,pN=6e4,Gx=(e,t)=>t!=null&&t.recursive?["folder",e,"recursive"]:["folder",e];function Yx(e){return e[0]!=="folder"||e[2]!=="recursive"||typeof e[1]!="string"?null:e}function mN(e){return Yx(e)!==null}function gN(e,t,n=!0){if(!mN(e))return!0;const r=Yx(e);if(r==null)return!1;const[,s]=r;return!!(s===t||n&&s==="/")}function yN(e,t,n=!0){return!Array.isArray(e)||e[0]!=="folder"?!1:!gN(e,t,n)}const Xx=15e3;function vN(e,t){return pe.getFolder(e,t)}function Jx(e,t=!1,n){const r=sl(),s={recursive:t},i=!!s.recursive;return rl({queryKey:Gx(e,s),queryFn:()=>vN(e,s),enabled:(n==null?void 0:n.enabled)??!0,staleTime:1e4,gcTime:i?pN:qx,retry:2,retryDelay:o=>Math.min(1e3*Math.pow(2,o),5e3),refetchOnWindowFocus:!1,refetchInterval:r?Xx:!1,refetchIntervalInBackground:r})}function xN(e,t){const n=sl();return rl({queryKey:["folder-count",e],queryFn:()=>pe.getFolderCount(e),enabled:(t==null?void 0:t.enabled)??!0,staleTime:1e4,gcTime:qx,retry:2,retryDelay:r=>Math.min(1e3*Math.pow(2,r),5e3),refetchOnWindowFocus:!1,refetchInterval:n?Xx:!1,refetchIntervalInBackground:n})}const Zx="application/x-lenslet-paths",wN='[role="treeitem"].drop-target';function Zm(e){var n;return Array.from(((n=e.dataTransfer)==null?void 0:n.types)||[]).includes(Zx)}function bN(e){document.querySelectorAll(wN).forEach(t=>{t!==e&&t.classList.remove("drop-target")})}function eg(e){bN(e),e.classList.add("drop-target")}function tg(e){return e.startsWith("/")?e:`/${e}`}function SN({path:e,isLeaf:t}){const n=wr(),r=u.useCallback(l=>{Zm(l)&&(l.preventDefault(),t&&eg(l.currentTarget))},[t]),s=u.useCallback(l=>{!t||!Zm(l)||(l.preventDefault(),eg(l.currentTarget))},[t]),i=u.useCallback(l=>{const c=l.currentTarget,d=document.elementFromPoint(l.clientX,l.clientY);d&&c.contains(d)||c.classList.remove("drop-target")},[]),o=u.useCallback(async l=>{const c=l.dataTransfer;if(!c)return;l.preventDefault(),l.currentTarget.classList.remove("drop-target");const d=c.getData(Zx),p=(d?JSON.parse(d):[]).filter(Boolean);if(!p.length)return;let h=p[0].split("/").slice(0,-1).join("/")||"/";h=tg(h);const w=tg(e);try{for(const x of p)await pe.moveFile(x,w);n.invalidateQueries({queryKey:["folder",h]}),n.invalidateQueries({queryKey:["folder",w]}),n.setQueryData(["folder",h],x=>!x||!Array.isArray(x.items)?x:{...x,items:x.items.filter(b=>!p.includes(b.path))})}catch{}},[e,n]);return{onDragOver:r,onDragEnter:s,onDragLeave:i,onDrop:o}}const CN='[role="tree"] [role="treeitem"]';function kN(){return Array.from(document.querySelectorAll(CN))}function EN(e,t){var i;const n=kN(),r=n.findIndex(o=>o===e);if(r===-1)return;let s=r;t==="ArrowDown"?s=Math.min(n.length-1,r+1):t==="ArrowUp"?s=Math.max(0,r-1):t==="Home"?s=0:t==="End"&&(s=n.length-1),(i=n[s])==null||i.focus()}function NN({path:e,isLeaf:t,isExpanded:n,setExpanded:r,onOpen:s}){return u.useCallback(i=>{if(i.key==="Enter"){i.preventDefault(),s(e);return}if(i.key==="ArrowRight"){!t&&!n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.add(e),l}));return}if(i.key==="ArrowLeft"){!t&&n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.delete(e),l}));return}(i.key==="ArrowDown"||i.key==="ArrowUp"||i.key==="Home"||i.key==="End")&&(i.preventDefault(),EN(i.currentTarget,i.key))},[e,t,n,r,s])}const ng=64,MN=120;function jN(e){const t=e.split("/").filter(Boolean),n=["/"];let r="";for(const s of t)r=r?`${r}/${s}`:`/${s}`,n.push(r);return n}function RN({current:e,roots:t,data:n,onOpen:r,onPullRefresh:s,onResize:i,onContextMenu:o,onOpenActions:l,countVersion:c,className:d,showResizeHandle:f=!0}){const[p,h]=u.useState(new Set(["/"])),w=u.useRef(new Map),x=u.useRef(new Map),[b,S]=u.useState(!1),[y,m]=u.useState(0),v=u.useRef(null),g=u.useRef(!1),C=wr(),E=u.useCallback(()=>{m(0),v.current=null,g.current=!1},[]),T=u.useCallback(async R=>{const P=Rt(R||"/"),A=w.current,O=x.current,K=A.get(P);if(K!==void 0)return K;const U=Gx(P,{recursive:!0}),_=C.getQueryData(U);if(_){const J=_.totalItems??_.items.length;return A.set(P,J),J}const G=O.get(P);if(G)return G;const V=(async()=>{try{const J=C.getQueryState(U);if((J==null?void 0:J.fetchStatus)==="fetching"){const q=await C.fetchQuery({queryKey:U,queryFn:()=>pe.getFolder(P,{recursive:!0})}),H=q.totalItems??q.items.length;return A.set(P,H),H}const se=await pe.getFolderCount(P),Y=se.totalItems??se.items.length;return A.set(P,Y),Y}finally{O.delete(P)}})();return O.set(P,V),V},[C]);u.useEffect(()=>{w.current.clear(),x.current.clear()},[c]),u.useEffect(()=>{const R=jN(e);h(P=>{const A=new Set(P);for(const O of R)A.add(O);return A})},[e]);const M=u.useCallback(async()=>{if(!(!s||b)){S(!0);try{await s()}catch(R){console.error("Failed to refresh folders:",R)}finally{S(!1),m(0)}}},[s,b]),I=u.useCallback(R=>{!s||b||R.touches.length===1&&(R.currentTarget.scrollTop>0||(v.current=R.touches[0].clientY,g.current=!1))},[s,b]),j=u.useCallback(R=>{if(!s||b||R.touches.length!==1)return;const P=v.current;if(P==null)return;if(R.currentTarget.scrollTop>0){E();return}const A=R.touches[0].clientY-P;if(A<=0){g.current&&m(0);return}!g.current&&A<8||(g.current=!0,R.preventDefault(),m(Math.min(MN,A*.55)))},[b,s,E]),B=u.useCallback(()=>{if(!s||b){E();return}const R=g.current&&y>=ng;if(v.current=null,g.current=!1,R){M();return}m(0)},[M,b,s,y,E]),F=d??"h-full overflow-auto bg-panel scrollbar-thin",Q=s?`${F} overscroll-y-contain`:F,ee=!!s&&(b||y>0),z=y>=ng,L=b?28:Math.min(44,y);return a.jsxs("div",{className:Q,onTouchStart:s?I:void 0,onTouchMove:s?j:void 0,onTouchEnd:s?B:void 0,onTouchCancel:s?B:void 0,children:[ee&&a.jsx("div",{className:"flex items-end justify-center text-[11px] text-muted select-none transition-[height,opacity] duration-150",style:{height:L,opacity:b||y>8?1:.65},"aria-live":"polite",children:b?"Refreshing":z?"Release to refresh":"Pull to refresh"}),a.jsx("div",{className:"p-1",role:"tree","aria-label":"Folders",children:t.map(R=>a.jsx(e0,{path:R.path,label:R.label,depth:0,current:e,expanded:p,setExpanded:h,onOpen:r,onContextMenu:o,onOpenActions:l,initial:n,getSubtreeCount:T,countVersion:c},R.path))}),f&&a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 left-[calc(var(--left)-6px)]",onPointerDown:i})]})}function e0({path:e,label:t,depth:n,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:c,initial:d,getSubtreeCount:f,countVersion:p}){var F;const h=s.has(e),w=r===e,x=e==="/"||h||w,{data:b}=Jx(e,!1,{enabled:x}),S=d&&e===d.path?d:b,m=!!S?S.dirs.length===0:!1,[v,g]=u.useState(S?S.items.length:null),C=NN({path:e,isLeaf:m,isExpanded:h,setExpanded:i,onOpen:o}),{onDragOver:E,onDragEnter:T,onDragLeave:M,onDrop:I}=SN({path:e,isLeaf:m}),j=Q=>{Q.stopPropagation(),!m&&i(ee=>{const z=new Set(ee);return z.has(e)?z.delete(e):z.add(e),z})},B=Q=>{if(Q.stopPropagation(),!c)return;const ee=Q.currentTarget.getBoundingClientRect();c(e,{x:ee.right-4,y:ee.bottom-4})};return u.useEffect(()=>{let Q=!1;if(!S){g(null);return}if(g(S.items.length),!!(h&&(n>0||w)))return f(e).then(z=>{Q||g(z)}).catch(z=>{Q||console.warn(`Failed to compute subtree count for ${e}:`,z)}),()=>{Q=!0}},[S,e,f,p,h,n,w]),a.jsxs("div",{children:[a.jsxs("div",{className:`tree-row flex items-center gap-1.5 py-1 px-2 rounded-md cursor-pointer min-h-[40px] outline-none transition-colors duration-75 ${w?"bg-accent/20 text-accent font-medium":"hover:bg-white/5 text-text"}`,role:"treeitem","aria-level":n+1,"aria-expanded":m?void 0:h,"aria-selected":w,tabIndex:w?0:-1,style:{paddingLeft:8+n*14},onClick:()=>o(e),onContextMenu:Q=>{Q.preventDefault(),Q.stopPropagation(),l==null||l(Q,e)},onKeyDown:C,onDragOver:E,onDragEnter:T,onDragLeave:M,onDrop:I,children:[a.jsx("button",{type:"button",className:"tree-expand-btn touch-manipulation",onClick:j,"aria-label":m?`No subfolders in ${t}`:`${h?"Collapse":"Expand"} ${t}`,"aria-expanded":m?void 0:h,disabled:m,children:m?"":h?"":""}),a.jsx("span",{className:"flex-1 overflow-hidden truncate text-sm",title:t,children:Lk(t,28)}),v!==null&&a.jsx("span",{className:"text-[10px] opacity-50 bg-white/5 border border-white/5 rounded px-1.5 min-w-[24px] text-center",children:v}),c&&a.jsx("button",{type:"button",className:"tree-row-action-btn touch-manipulation","aria-label":`Open actions for ${t}`,"aria-haspopup":"menu",onPointerDown:Q=>Q.stopPropagation(),onClick:B,children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]}),h&&((F=S==null?void 0:S.dirs)==null?void 0:F.map(Q=>a.jsx(e0,{path:Ox(e,Q.name),label:Q.name,depth:n+1,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:c,getSubtreeCount:f,countVersion:p},Q.name)))]})}const rg=[5,4,3,2,1],sg=["<","<=",">",">="];function PN({filters:e,onChangeFilters:t}){const n=u.useMemo(()=>WE(e),[e]),r=u.useMemo(()=>HE(e),[e]),s=u.useMemo(()=>QE(e)??"",[e]),i=u.useMemo(()=>KE(e)??"",[e]),o=u.useMemo(()=>qE(e)??"",[e]),l=u.useMemo(()=>GE(e)??"",[e]),c=u.useMemo(()=>YE(e)??"",[e]),d=u.useMemo(()=>XE(e)??"",[e]),f=u.useMemo(()=>JE(e)??{},[e]),p=u.useMemo(()=>ig(f.from),[f.from]),h=u.useMemo(()=>ig(f.to),[f.to]),w=u.useMemo(()=>ZE(e),[e]),x=u.useMemo(()=>eN(e),[e]),[b,S]=u.useState((w==null?void 0:w.op)??">="),[y,m]=u.useState((x==null?void 0:x.op)??">=");u.useEffect(()=>{w!=null&&w.op&&S(w.op)},[w==null?void 0:w.op]),u.useEffect(()=>{x!=null&&x.op&&m(x.op)},[x==null?void 0:x.op]);const v=(g,C)=>{const E=new Set(n),T=new Set(r);g==="include"?E.has(C)?E.delete(C):(E.add(C),T.delete(C)):T.has(C)?T.delete(C):(T.add(C),E.delete(C));let M=Dx(e,Array.from(E));M=zx(M,Array.from(T)),t(M)};return a.jsxs("div",{className:"ui-card",children:[a.jsx("div",{className:"ui-section-title mb-3",children:"Attributes"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Rating"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Include"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[rg.map(g=>{const C=n.includes(g);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${C?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("include",g),"aria-pressed":C,title:`Include ${g} star${g>1?"s":""}`,children:[g,""]},`stars-in-${g}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${n.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("include",0),"aria-pressed":n.includes(0),title:"Include unrated",children:"None"})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Exclude"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[rg.map(g=>{const C=r.includes(g);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${C?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("exclude",g),"aria-pressed":C,title:`Exclude ${g} star${g>1?"s":""}`,children:[g,""]},`stars-out-${g}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${r.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("exclude",0),"aria-pressed":r.includes(0),title:"Exclude unrated",children:"None"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Filename"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:s,placeholder:"e.g. draft",onChange:g=>t($x(e,g.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:i,placeholder:"e.g. v1",onChange:g=>t(Bx(e,g.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Comments"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:o,placeholder:"e.g. hero",onChange:g=>t(Ux(e,g.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:l,placeholder:"e.g. todo",onChange:g=>t(Vx(e,g.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"URL"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:c,placeholder:"e.g. s3://bucket",onChange:g=>t(Wx(e,g.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:d,placeholder:"e.g. http://",onChange:g=>t(Hx(e,g.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Date Added"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"From"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:p,onChange:g=>t(nf(e,{from:g.target.value||null,to:f.to??null}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"To"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:h,onChange:g=>t(nf(e,{from:f.from??null,to:g.target.value||null}))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Dimensions"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Width"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:b,onChange:g=>{const C=g.target.value;S(C),w&&t(pa(e,{op:C,value:w.value}))},children:sg.map(g=>a.jsx("option",{value:g,children:g},`w-${g}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:w?String(w.value):"",min:0,placeholder:"px",onChange:g=>{const C=g.target.value;if(!C){t(pa(e,null));return}const E=Number(C);Number.isFinite(E)&&t(pa(e,{op:b,value:E}))}})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Height"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:y,onChange:g=>{const C=g.target.value;m(C),x&&t(ma(e,{op:C,value:x.value}))},children:sg.map(g=>a.jsx("option",{value:g,children:g},`h-${g}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:x?String(x.value):"",min:0,placeholder:"px",onChange:g=>{const C=g.target.value;if(!C){t(ma(e,null));return}const E=Number(C);Number.isFinite(E)&&t(ma(e,{op:y,value:E}))}})]})]})]})]})]})]})}function ig(e){return e?e.length>=10?e.slice(0,10):e:""}const TN=[];function sf(e,t){if(t!=null&&t.length)return IN(e,t);const n=new Map;for(const r of e){const s=r.metrics;if(s)for(const[i,o]of Object.entries(s)){if(o==null||Number.isNaN(o))continue;const l=n.get(i);l?l.push(o):n.set(i,[o])}}return n}function IN(e,t){const n=t.map(s=>({key:s,values:[]}));for(const s of e){const i=s.metrics;if(i)for(const o of n){const l=i[o.key];l==null||Number.isNaN(l)||o.values.push(l)}}const r=new Map;for(const s of n)s.values.length&&r.set(s.key,s.values);return r}function Qs(e,t){return e.get(t)??TN}function Tc(e,t,n){if(!e.length)return null;const r=n?n.min:Math.min(...e);let s=n?n.max:Math.max(...e);r===s&&(s=r+1);const i=new Array(t).fill(0),o=t/(s-r);for(const l of e){const c=Math.max(0,Math.min(t-1,Math.floor((l-r)*o)));i[c]+=1}return{bins:i,min:r,max:s,count:e.length}}function t0(e,t){return e<t?{min:e,max:t}:{min:t,max:e}}function nn(e){return Nx(e)}function kr(e){if(!Number.isFinite(e))return"";const t=e.toString();return t.includes("e")?e.toFixed(6):t}function og(e){const t=e.trim();if(!t)return{value:null,valid:!0};const n=Number(t);return Number.isFinite(n)?{value:n,valid:!0}:{value:null,valid:!1}}function lg(e,t,n){return e<t?t:e>n?n:e}function gh(e){return e<0?0:e>1?1:e}function Ks(e,t){const n=Math.max(1,Math.abs(e),Math.abs(t));return Math.abs(e-t)<=1e-6*n}function LN(e,t,n){const r=gh((e-t.left)/t.width);return n.min+(n.max-n.min)*r}function _N(e,t,n=4){return e==null?!1:Math.abs(t-e)>=n}function n0(e,t){return t0(e??t,t)}function AN(e,t,n,r){return e&&t!=null?{commitRange:n0(n,t),shouldClear:!1}:{commitRange:null,shouldClear:r!=null}}function FN({metricKey:e,domain:t,activeRange:n,onChangeRange:r}){const[s,i]=u.useState(null),[o,l]=u.useState(!1),c=u.useRef(null),d=u.useRef(null),f=u.useRef(!1),p=u.useRef(null),[h,w]=u.useState(null),x=s??n;u.useEffect(()=>{w(null)},[e,t==null?void 0:t.min,t==null?void 0:t.max]);const b=v=>{var C;if(!t)return null;const g=(C=p.current)==null?void 0:C.getBoundingClientRect();return g?LN(v,{left:g.left,width:g.width},t):null};return{svgRef:p,hoverValue:h,displayRange:x,onPointerDown:v=>{var C;if(!t)return;v.preventDefault();const g=b(v.clientX);g!=null&&(l(!0),i(null),c.current=g,d.current=v.clientX,f.current=!1,w(g),(C=p.current)==null||C.setPointerCapture(v.pointerId))},onPointerMove:v=>{const g=b(v.clientX);if(g==null){o||w(null);return}w(g),o&&(!f.current&&!_N(d.current,v.clientX)||(f.current=!0,i(n0(c.current,g))))},onPointerUp:v=>{var E;if(!o)return;l(!1),(E=p.current)==null||E.releasePointerCapture(v.pointerId);const g=b(v.clientX),C=AN(f.current,g,c.current,n);C.commitRange?(w(g),r(C.commitRange)):C.shouldClear&&r(null),c.current=null,d.current=null,f.current=!1,setTimeout(()=>i(null),0)},onPointerLeave:()=>w(null)}}const ms=40;function ag({metricKey:e,populationValues:t,filteredValues:n,selectedValues:r=[],filters:s,onChangeRange:i,showTitle:o=!1}){const l=u.useMemo(()=>Tc(t,ms),[t]),c=u.useMemo(()=>l?Tc(n,ms,l):null,[n,l]),d=tN(s,e),f=l?{min:l.min,max:l.max}:null,{svgRef:p,hoverValue:h,displayRange:w,onPointerDown:x,onPointerMove:b,onPointerUp:S,onPointerLeave:y}=FN({metricKey:e,domain:f,activeRange:d,onChangeRange:F=>i(e,F)}),[m,v]=u.useState(""),[g,C]=u.useState(""),[E,T]=u.useState(null),M=r.length===1?r[0]:null,I=u.useMemo(()=>!l||r.length<2?null:Tc(r,ms,l),[r,l]);u.useEffect(()=>{if(!d||!f){E!=="min"&&v(d?kr(d.min):""),E!=="max"&&C(d?kr(d.max):"");return}if(E!=="min"){const F=Ks(d.min,f.min)?"":kr(d.min);v(F)}if(E!=="max"){const F=Ks(d.max,f.max)?"":kr(d.max);C(F)}},[d,f,E]);const j=(F,Q)=>{if(!f)return;const ee=og(F),z=og(Q);if(!ee.valid||!z.valid){ee.valid||v(d?kr(d.min):""),z.valid||C(d?kr(d.max):"");return}if(ee.value==null&&z.value==null){i(e,null);return}const L=ee.value??f.min,R=z.value??f.max,P=lg(L,f.min,f.max),A=lg(R,f.min,f.max),O=t0(P,A);if(Ks(O.min,f.min)&&Ks(O.max,f.max)){i(e,null);return}i(e,O)};if(!l||!f)return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]});const B=r.length;return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mb-2 tabular-nums",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{children:["Population: ",l.count]}),a.jsxs("span",{children:["Filtered: ",(c==null?void 0:c.count)??0]}),B>1&&a.jsxs("span",{className:"text-text",children:["Selected: ",B]})]}),M!=null&&a.jsxs("span",{className:"text-text",children:["Selected: ",nn(M)]})]}),a.jsxs("svg",{ref:p,viewBox:`0 0 ${ms} 100`,preserveAspectRatio:"none",className:"w-full h-28 cursor-crosshair rounded-md bg-surface-inset",onPointerDown:x,onPointerMove:b,onPointerUp:S,onPointerLeave:y,children:[Ic(l.bins,"#2e3a4b"),c&&Ic(c.bins,"#3a8fff"),I&&Ic(I.bins,"#f59e0b",{opacity:.55}),w&&ON(w,f),M!=null&&ug(M,f,{color:"var(--highlight)",strokeWidth:.7}),h!=null&&ug(h,f,{color:"rgba(255,255,255,0.75)",strokeWidth:.5,dashed:!0})]}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mt-2 tabular-nums",children:[a.jsx("span",{children:nn(f.min)}),a.jsxs("div",{className:"flex flex-col items-center text-center leading-tight",children:[w?a.jsx("span",{className:"text-text",children:Ks(w.min,f.min)?` ${nn(w.max)}`:Ks(w.max,f.max)?` ${nn(w.min)}`:`${nn(w.min)}  ${nn(w.max)}`}):h!=null?a.jsxs("span",{className:"text-text",children:["Cursor: ",nn(h)]}):a.jsx("span",{children:"Drag to filter"}),w&&h!=null&&a.jsxs("span",{className:"text-[11px] text-muted",children:["Cursor: ",nn(h)]})]}),a.jsx("span",{children:nn(f.max)})]}),a.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2 mt-3 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Min"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:m,placeholder:kr(f.min),onFocus:()=>T("min"),onBlur:()=>{T(null),j(m,g)},onChange:F=>v(F.target.value),onKeyDown:F=>{F.key==="Enter"&&F.currentTarget.blur()}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Max"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:g,placeholder:kr(f.max),onFocus:()=>T("max"),onBlur:()=>{T(null),j(m,g)},onChange:F=>C(F.target.value),onKeyDown:F=>{F.key==="Enter"&&F.currentTarget.blur()}})]}),a.jsx("button",{className:"btn btn-xs btn-ghost text-muted hover:text-text",onClick:()=>i(e,null),children:"Clear"})]})]})}function Ic(e,t,n){const r=Math.max(1,...e),s=(n==null?void 0:n.opacity)??.9;return e.map((i,o)=>{const l=i/r*100;return a.jsx("rect",{x:o+.05,y:100-l,width:.9,height:l,fill:t,opacity:s},`${t}-${o}`)})}function ON(e,t){const n=(e.min-t.min)/(t.max-t.min),r=(e.max-t.min)/(t.max-t.min),s=ms*gh(Math.min(n,r)),i=ms*Math.abs(r-n);return a.jsx("rect",{x:s,y:0,width:Math.max(.5,i),height:100,fill:"rgba(255,255,255,0.08)",stroke:"rgba(255,255,255,0.4)",strokeWidth:.4})}function ug(e,t,n){const r=gh((e-t.min)/(t.max-t.min)),s=ms*r;return a.jsx("line",{x1:s,y1:0,x2:s,y2:100,stroke:n.color,strokeWidth:n.strokeWidth??.5,strokeDasharray:n.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}const DN=new Map;function zN({items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}){const[c,d]=u.useState(!1),f=s&&n.includes(s)?s:n[0],p=u.useMemo(()=>c?n:f?[f]:[],[c,n,f]),h=u.useMemo(()=>sf(e,p),[e,p]),w=u.useMemo(()=>sf(t,p),[t,p]),x=r??DN;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("label",{className:"ui-label",children:"Metric"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-[11px]",onClick:()=>d(b=>!b),"aria-pressed":c,children:c?"Show one":"Show all"})]}),c?a.jsx("div",{className:"ui-input ui-input-readonly w-full flex items-center text-xs",children:"All metrics"}):a.jsx("select",{className:"ui-select w-full",value:f,onChange:b=>i(b.target.value),children:n.map(b=>a.jsx("option",{value:b,children:b},b))})]}),c?a.jsx("div",{className:"space-y-3",children:n.map(b=>a.jsx(ag,{metricKey:b,populationValues:Qs(h,b),filteredValues:Qs(w,b),selectedValues:Qs(x,b),filters:o,onChangeRange:l,showTitle:!0},b))}):f?a.jsx(ag,{metricKey:f,populationValues:Qs(h,f),filteredValues:Qs(w,f),selectedValues:Qs(x,f),filters:o,onChangeRange:l}):a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]})}const $N=12;function BN({items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l,onChangeFilters:c}){const d=u.useMemo(()=>r!=null&&r.length?sf(r,n):null,[r,n]),f=d&&r&&r.length?a.jsx(UN,{selectedValuesByKey:d,totalItems:r.length,metricKeys:n}):null,p=a.jsx(PN,{filters:o,onChangeFilters:c});return n.length?a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,a.jsx(zN,{items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:d,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}),p]}):a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,p,a.jsx("div",{className:"p-4 text-sm text-muted",children:"No metrics found in this dataset."})]})}function UN({selectedValuesByKey:e,totalItems:t,metricKeys:n}){const r=u.useMemo(()=>e.size?{entries:(n.length?n.filter(p=>e.has(p)):Array.from(e.keys()).sort()).map(p=>{const h=e.get(p)??[],w=Math.min(...h),x=Math.max(...h),b=h.reduce((S,y)=>S+y,0)/Math.max(1,h.length);return{key:p,value:h[0],min:w,max:x,avg:b,count:h.length}}),totalItems:t}:null,[e,n,t]);if(!r)return null;const{entries:s,totalItems:i}=r,o=s.slice(0,$N),l=s.length-o.length,c=i>1;return a.jsxs("div",{className:"ui-card",children:[a.jsxs("div",{className:"ui-card-header",children:[a.jsx("div",{className:"ui-section-title",children:"Selected metrics"}),a.jsxs("div",{className:"text-[11px] text-muted",children:[i," item",i===1?"":"s"]})]}),a.jsxs("div",{className:"space-y-1 text-[12px]",children:[o.map(d=>a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-muted w-28 shrink-0 truncate",title:d.key,children:d.key}),a.jsxs("span",{className:"font-mono text-text text-right tabular-nums",children:[c?`${nn(d.min)}  ${nn(d.max)}`:nn(d.value),c&&a.jsxs("span",{className:"text-[11px] text-muted ml-2",children:["avg ",nn(d.avg),d.count!==i?`  ${d.count}/${i}`:""]})]})]},d.key)),l>0&&a.jsxs("div",{className:"text-[11px] text-muted",children:["+",l," more"]})]})]})}const VN=[{label:"Root",path:"/"}],WN="w-11 h-11 rounded-md border border-border flex items-center justify-center transition-colors",HN="bg-accent-muted text-accent",QN="bg-surface text-text hover:bg-surface-hover";function Ql(e){return`${WN} ${e?HN:QN}`}function KN({leftTool:e,onToolChange:t,compareEnabled:n,compareActive:r,onOpenCompare:s,views:i,activeViewId:o,onActivateView:l,onSaveView:c,current:d,data:f,onOpenFolder:p,onOpenFolderActions:h,onPullRefreshFolders:w,onContextMenu:x,countVersion:b,items:S,filteredItems:y,metricKeys:m,selectedItems:v,selectedMetric:g,onSelectMetric:C,filters:E,onChangeRange:T,onChangeFilters:M,onResize:I}){const j=Ql(e==="folders"),B=Ql(e==="metrics"),F=Ql(r),Q=`${Ql(!1)} cursor-pointer`;return a.jsxs("div",{className:"app-left-panel col-start-1 row-start-2 relative border-r border-border bg-panel overflow-visible",children:[a.jsxs("div",{className:"absolute inset-y-0 left-0 w-12 border-r border-border flex flex-col items-center gap-2 py-3 bg-surface-overlay",children:[a.jsx("button",{className:j,title:"Folders","aria-label":"Folders","aria-pressed":e==="folders",onClick:()=>t("folders"),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M3 7.5h6l2-2h10a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2z"})})}),a.jsx("button",{className:B,title:"Metrics / Filters","aria-label":"Metrics and Filters","aria-pressed":e==="metrics",onClick:()=>t("metrics"),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]})}),a.jsx("div",{className:"w-6 h-px bg-border/70 my-1"}),a.jsx("button",{className:`${F} ${n?"":"opacity-40 cursor-not-allowed"}`,title:n?"Compare selected images":"Compare (select 2+)","aria-label":"Compare selected images","aria-pressed":r,"aria-disabled":!n,disabled:!n,onClick:()=>{n&&s()},children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("rect",{x:"3",y:"4",width:"8",height:"16",rx:"1"}),a.jsx("rect",{x:"13",y:"4",width:"8",height:"16",rx:"1"})]})}),a.jsx("div",{className:"flex-1"}),a.jsx("a",{className:Q,href:"https://github.com/trojblue/lenslet",title:"Lenslet on GitHub","aria-label":"Lenslet on GitHub",target:"_blank",rel:"noreferrer",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:a.jsx("path",{d:"M12 .5C5.73.5.5 5.74.5 12.02c0 5.1 3.29 9.42 7.86 10.95.58.11.79-.25.79-.56v-2.17c-3.2.7-3.88-1.55-3.88-1.55-.53-1.35-1.29-1.71-1.29-1.71-1.05-.72.08-.71.08-.71 1.16.08 1.78 1.2 1.78 1.2 1.03 1.77 2.71 1.26 3.37.96.1-.75.4-1.26.73-1.55-2.55-.29-5.23-1.29-5.23-5.74 0-1.27.45-2.31 1.19-3.13-.12-.29-.52-1.46.11-3.05 0 0 .97-.31 3.18 1.19.92-.26 1.91-.39 2.89-.39.98 0 1.97.13 2.89.39 2.2-1.5 3.18-1.19 3.18-1.19.63 1.59.23 2.76.11 3.05.74.82 1.19 1.86 1.19 3.13 0 4.46-2.69 5.45-5.25 5.73.41.36.78 1.07.78 2.16v3.2c0 .31.21.67.8.56 4.56-1.53 7.85-5.85 7.85-10.95C23.5 5.74 18.27.5 12 .5z"})})})]}),a.jsx("div",{className:"ml-12 h-full overflow-hidden",children:e==="folders"?a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-2 py-2 border-b border-border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Smart Folders"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:c,title:"Save current view as Smart Folder",children:"+ New"})]}),i.length?a.jsx("div",{className:"flex flex-col gap-1",children:i.map(ee=>{const z=ee.id===o;return a.jsx("button",{className:`text-left px-2 py-2 rounded-md text-sm ${z?"bg-accent-muted text-accent":"hover:bg-hover text-text"}`,onClick:()=>l(ee),children:ee.name},ee.id)})}):a.jsx("div",{className:"text-xs text-muted px-1 py-1.5",children:"No saved Smart Folders yet."})]}),a.jsx(RN,{current:d,roots:VN,data:f,onOpen:p,onPullRefresh:w,onContextMenu:x,onOpenActions:h,countVersion:b,className:"flex-1 min-h-0 overflow-auto scrollbar-thin",showResizeHandle:!1})]}):a.jsx(BN,{items:S,filteredItems:y,metricKeys:m,selectedItems:v,selectedMetric:g,onSelectMetric:C,filters:E,onChangeRange:T,onChangeFilters:M})}),a.jsx("div",{className:"toolbar-offset sidebar-resize-handle sidebar-resize-handle-left absolute bottom-0",onPointerDown:I})]})}function qN({persistenceEnabled:e,indexing:t=null,showSwitchToMostRecentBanner:n=!1,onSwitchToMostRecent:r,offViewSummary:s,onRevealOffView:i,canRevealOffView:o=!1,onClearOffView:l,browserZoomPercent:c}){const f=!!(s!=null&&s.names.length)&&s?` (${s.names.join(", ")}${s.extra?` +${s.extra}`:""})`:"",p=o&&i!=null,h=typeof c=="number"?c:null,w=h!==null&&Math.abs(h-100)>=2,x=(t==null?void 0:t.state)==="running",b=(t==null?void 0:t.state)==="error",S=t!=null&&t.scope&&t.scope!=="/"?` (${t.scope})`:"",y=(()=>{if(!x)return null;const g=typeof(t==null?void 0:t.done)=="number"?t.done:null,C=typeof(t==null?void 0:t.total)=="number"?t.total:null;return g===null&&C===null?null:C===null?`${g??0} indexed`:`${Math.min(g??0,C)} / ${C}`})(),m=n&&r!=null;return!e||x||b||m||w||!!s?a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-col gap-2",children:[!e&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Not persisted."})," Workspace is read-only; edits stay in memory until restart."]}),x&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Indexing in progress",S,"."]})," ",y?`${y} complete.`:"Preparing searchable index."]}),b&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Indexing failed."})," ",(t==null?void 0:t.error)||"Open server logs for details."]}),m&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("span",{children:[a.jsx("span",{className:"font-semibold",children:"Indexing complete."})," ","Scan-stable ordering is active for this generation."]}),a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>r==null?void 0:r(),children:"Switch to Most recent"})]}),w&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Browser zoom ",Math.round(h),"%."]})," For best results, set it to 100% so UI elements stay in correct proportions."]}),s&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex items-center justify-between gap-3",children:[a.jsxs("span",{children:["Updates outside current view: ",s.count," item",s.count===1?"":"s",f]}),a.jsxs("div",{className:"flex items-center gap-2",children:[p&&a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>i==null?void 0:i(),"aria-label":"Reveal off-view updates",children:"Reveal"}),a.jsx("button",{className:"text-muted hover:text-text transition-colors text-base leading-none",onClick:l,"aria-label":"Clear off-view updates",children:""})]})]})]})}):null}function GN(e){return e.isOffline?"offline":e.isUnstable?"unstable":e.recentEditActive?"recent":Number.isFinite(e.editingCount)&&e.editingCount>0?"editing":"live"}const YN=6e3,XN=1e4,JN=24*60*6e4,ZN=3e4,eM=350,tM=1400,r0=[-2,-1,1,2],s0=[-2,-1,0,1,2,3];r0.length;s0.length;function nM(e,t,n){return Math.min(Math.max(e,t),n)}function i0(e,t,n){const r=new Set,s=[];for(const i of n){const o=t+i;if(o<0||o>=e.length)continue;const l=e[o];!l||r.has(l)||(r.add(l),s.push(l))}return s}function rM(e,t){if(!t)return[];const n=e.indexOf(t);return n<0?[]:i0(e,n,r0)}function sM(e,t){if(e.length<2)return[];const n=Math.max(0,e.length-2),r=nM(t,0,n);return i0(e,r,s0)}function iM({paths:e,defaultDestination:t,destinations:n,loadingDestinations:r,onClose:s,onSubmit:i}){const[o,l]=u.useState(()=>Rt(t||"/")),[c,d]=u.useState(!1);u.useEffect(()=>{l(Rt(t||"/"))},[t,e]);const f=Rt(o||"/"),p=e.length>0&&!c,h=e.slice(0,3).map(S=>ph(S)||S),w=Math.max(0,e.length-h.length),x=n.filter(S=>S!==f).slice(0,8),b=async S=>{if(S.preventDefault(),!!p){d(!0);try{await i(e,f)}finally{d(!1)}}};return a.jsx("div",{className:"toolbar-offset fixed inset-0 z-overlay bg-black/45 backdrop-blur-[1px] flex items-center justify-center p-3",children:a.jsxs("div",{className:"w-full max-w-[560px] rounded-xl border border-border bg-panel shadow-[0_20px_60px_rgba(0,0,0,0.55)]",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Move to folder"}),a.jsxs("div",{className:"text-xs text-muted",children:[e.length," item(s) selected"]})]}),a.jsx("button",{type:"button",className:"btn btn-icon",onClick:s,"aria-label":"Close move dialog",disabled:c,children:""})]}),a.jsxs("form",{className:"px-4 py-3 flex flex-col gap-3",onSubmit:b,children:[a.jsxs("div",{className:"text-xs text-muted",children:[h.join(", "),w>0?` and ${w} more`:""]}),a.jsxs("label",{className:"text-xs text-muted flex flex-col gap-1.5",children:["Destination folder",a.jsx("input",{value:o,onChange:S=>l(S.target.value),className:"input w-full",list:"move-destination-list",placeholder:"/",autoFocus:!0,disabled:c})]}),a.jsx("datalist",{id:"move-destination-list",children:n.map(S=>a.jsx("option",{value:S},S))}),a.jsx("div",{className:"text-[11px] text-muted",children:r?"Loading folder list":`${n.length.toLocaleString()} destination(s) loaded`}),x.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.map(S=>a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>l(S),disabled:c,children:S},S))}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-border",children:[a.jsx("button",{type:"button",className:"btn",onClick:s,disabled:c,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-active",disabled:!p,children:c?"Moving":"Move"})]})]})]})})}function oM(e){return JSON.stringify(e,null,2)}function lM(e){const t=s=>'"'+s.replaceAll('"','""')+'"',n="path,folder,name,star,type,size,width,height,tags,notes",r=e.map(s=>{const i=(s.tags||[]).join(" "),o=s.notes||"";return[s.path,s.folder,s.name,String(s.star??""),s.type??"",s.size??"",s.width??"",s.height??"",i,o].map(l=>t(String(l))).join(",")});return[n,...r].join(`
`)}function aM(e){return e.map(t=>{const n=t.path.split("/").filter(Boolean);n.pop();const r=n.length?`/${n.join("/")}`:"/";return{path:t.path,folder:r,name:t.name,star:t.star??null,type:t.type,size:t.size,width:t.w,height:t.h}})}function uM({x:e,y:t,items:n}){const r=u.useRef(null),[s,i]=u.useState({x:e,y:t}),[o,l]=u.useState(!1),c=u.useCallback((f,p)=>{p.stopPropagation(),f.disabled||f.onClick()},[]),d=u.useCallback(()=>{const f=r.current,p=cx(),h=f==null?void 0:f.getBoundingClientRect(),w=(h==null?void 0:h.width)??180,x=(h==null?void 0:h.height)??Math.max(40,n.length*36),b=ux({x:e,y:t,menuWidth:w,menuHeight:x,viewport:p});i(S=>S.x===b.x&&S.y===b.y?S:b),l(!0)},[n.length,e,t]);return u.useLayoutEffect(()=>{d()},[d]),u.useEffect(()=>(window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}),[d]),a.jsx("div",{ref:r,className:"dropdown-panel fixed",role:"menu",style:{left:s.x,top:s.y,minWidth:180,visibility:o?"visible":"hidden"},onClick:f=>f.stopPropagation(),children:n.map((f,p)=>a.jsxs("button",{className:`dropdown-item w-full ${f.danger?"text-danger hover:text-danger":""}`,role:"menuitem","aria-disabled":f.disabled,disabled:f.disabled,onClick:h=>c(f,h),children:[f.icon&&a.jsx("span",{className:"shrink-0",children:f.icon}),a.jsx("span",{children:f.label})]},p))})}const cM="Refresh unavailable in read-only mode";function dM({refreshing:e,refreshEnabled:t,onRefresh:n}){return{label:t?e?"Refreshing":"Refresh":cM,disabled:!t||e,onClick:n}}function cg(e){return e==="csv"?"text/csv;charset=utf-8":"application/json;charset=utf-8"}function dg(e,t){const n=aM(e);return t==="csv"?lM(n):oM(n)}function fg(){return new Date().toISOString().replace(/[:.]/g,"-")}async function fM(e){return(await pe.getFolder(e,{recursive:!0})).items}function hM({ctx:e,current:t,items:n,setCtx:r,refreshEnabled:s,onRefetch:i,onOpenMoveDialog:o,onRefreshFolder:l}){const c=DE(t),[d,f]=u.useState(!1),[p,h]=u.useState(null),w=e.kind==="grid"?e.payload.paths:[],x=u.useMemo(()=>new Map(n.map(M=>[M.path,M])),[n]),b=()=>{r(null)},S=async()=>{const M=e.kind==="tree"?e.payload.path:"/";f(!0);try{await l(M)}catch(I){console.error("Failed to refresh folder:",I)}finally{f(!1),b()}},y=M=>async()=>{h(M);const I=e.kind==="tree"?e.payload.path:t;try{const j=await fM(I),B=dg(j,M),F=cg(M),Q=I==="/"?"root":(I.replace(/^\/+/,"")||"root").replace(/\//g,"_");ko(new Blob([B],{type:F}),`metadata_${Q}_${fg()}.${M}`)}catch(j){console.error("Failed to export folder:",j),alert("Failed to export folder. See console for details.")}finally{h(null),b()}},m=M=>async()=>{h(M);try{const I=new Set(w),j=n.filter(Q=>I.has(Q.path)),B=dg(j,M),F=cg(M);ko(new Blob([B],{type:F}),`metadata_selection_${fg()}.${M}`)}finally{h(null),b()}},v=async()=>{var M;if(w.length){b();for(const I of w)try{const j=await pe.getFile(I),B=((M=x.get(I))==null?void 0:M.name)||ph(I)||"image";ko(j,B)}catch(j){console.error(`Failed to download ${I}:`,j)}}},g=async()=>{if(!c){for(const M of w)try{await pe.moveFile(M,"/_trash_")}catch(I){console.error(`Failed to trash ${M}:`,I)}i(),b()}},C=async()=>{if(confirm(`Delete ${w.length} file(s) permanently? This cannot be undone.`)){try{await pe.deleteFiles(w)}catch(M){console.error("Failed to delete files:",M)}i(),b()}},E=async()=>{for(const M of w)try{const j=(await pe.getSidecar(M)).original_position,B=j&&j.split("/").slice(0,-1).join("/")||"/";await pe.moveFile(M,B)}catch(I){console.error(`Failed to recover ${M}:`,I)}i(),b()},T=e.kind==="tree"?[dM({refreshing:d,refreshEnabled:s,onRefresh:S}),{label:p==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!p||d,onClick:y("csv")},{label:p==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!p||d,onClick:y("json")}]:pM({selectedPaths:w,inTrash:c,exporting:p,onDownloadSelection:v,onMoveSelection:o,onMoveToTrash:g,onPermanentDelete:C,onRecover:E,onExportCsv:m("csv"),onExportJson:m("json")});return a.jsx(uM,{x:e.x,y:e.y,items:T})}function pM({selectedPaths:e,inTrash:t,exporting:n,onDownloadSelection:r,onMoveSelection:s,onMoveToTrash:i,onPermanentDelete:o,onRecover:l,onExportCsv:c,onExportJson:d}){const f=[];return e.length&&f.push({label:e.length>1?`Download (${e.length})`:"Download",onClick:r}),e.length&&f.push({label:"Move to",disabled:t,onClick:()=>{t||s(e)}}),f.push({label:"Move to trash",disabled:t,onClick:i}),t&&(f.push({label:"Permanent delete",danger:!0,onClick:o}),f.push({label:"Recover",onClick:l})),e.length&&(f.push({label:n==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!n,onClick:c}),f.push({label:n==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!n,onClick:d})),f}function Kl(e){const t=u.useRef(e);return t.current=e,t}function mM(e,t){return t?e.some(n=>{var s;const r=(s=n.metrics)==null?void 0:s[t];return r!=null&&!Number.isNaN(r)}):!1}function gM(e,t){const n={0:0,1:0,2:0,3:0,4:0,5:0};for(const r of e){const s=t[r.path]??r.star??0,i=String(s);n[i]=(n[i]||0)+1}return n}function yM(e,t=250){const n=new Set;let r=0;for(const s of e){const i=s.metrics;if(i)for(const o of Object.keys(i))n.add(o);if(r+=1,r>=t&&n.size>0)break}return Array.from(n).sort()}function vM(e,t,n,r){return e||t?n:r}function xM(e,t,n,r,s,i){return e?n:t||i==="/"?r:s}function wM(e){if(!e)return null;if(e.queryPath){const t=e.queryPath.split("/").filter(Boolean);return t.length?t[t.length-1]:e.queryPath}return e.queryVector?"Vector query":null}function bM(e,t,n,r){return e?t>0?`${n} of ${r}`:`${r}`:null}function SM(e){return!e.similarityActive&&!e.searching&&e.itemCount===0&&e.isLoading}const CM=(e,t)=>["search",e,t],kM=2e4,ql="/";function EM(e){return e.trim().replace(/\s+/g," ")}function o0(e){const t=e.trim();return!t||t===ql?ql:t.startsWith(ql)?t:`${ql}${t}`}function yh(e,t){const n=EM(e);return n?{q:n,path:o0(t)}:null}function NM(e){return!Array.isArray(e)||e[0]!=="search"||typeof e[1]!="string"||typeof e[2]!="string"?null:yh(e[1],e[2])}function MM(e,t){if(!t)return!1;const n=NM(e);return n?n.path===t.path:!1}function jM(e,t){const n=sl(),r=yh(e,t),s=CM((r==null?void 0:r.q)??"",(r==null?void 0:r.path)??o0(t));return rl({enabled:r!==null,queryKey:s,queryFn:()=>r?pe.search(r.q,r.path):Promise.resolve({items:[]}),staleTime:3e3,gcTime:6e4,placeholderData:(i,o)=>{if(MM(o==null?void 0:o.queryKey,r))return i},retry:1,refetchInterval:n?kM:!1,refetchIntervalInBackground:n})}const RM=()=>["embeddings"];function PM(){return rl({queryKey:RM(),queryFn:pe.getEmbeddings,staleTime:6e4,gcTime:5*6e4,retry:1,refetchOnWindowFocus:!1})}function TM(e,t=250){const[n,r]=Jr.useState(e);return Jr.useEffect(()=>{const s=window.setTimeout(()=>r(e),Math.max(0,t));return()=>window.clearTimeout(s)},[e,t]),n}function hg(e){return e.addedAt?Date.parse(e.addedAt):0}function Ja(e,t){return e.name.localeCompare(t.name)}function IM(e,t){const n=hg(e),r=hg(t);return n===r?Ja(e,t):n-r}function LM(e){return(t,n)=>{var i,o;const r=(i=t.metrics)==null?void 0:i[e],s=(o=n.metrics)==null?void 0:o[e];return r==null&&s==null?Ja(t,n):r==null?1:s==null?-1:r===s?Ja(t,n):r-s}}function pg(e,t){return BE(e,t)}function _M(e){let t=e>>>0;return()=>{t+=1831565813;let n=Math.imul(t^t>>>15,1|t);return n^=n+Math.imul(n^n>>>7,61|n),((n^n>>>14)>>>0)/4294967296}}function AM(e,t){const n=_M(t||1),r=[...e];for(let s=r.length-1;s>0;s-=1){const i=Math.floor(n()*(s+1));[r[s],r[i]]=[r[i],r[s]]}return r}function FM(e,t,n){if(t.kind==="builtin"&&t.key==="random"){const i=n??Date.now();return AM(e,i)}let r=IM;t.kind==="metric"?r=LM(t.key):t.key==="name"&&(r=Ja);const s=[...e].sort(r);return t.dir==="desc"?s.reverse():s}function OM(e,t){return e?t instanceof ln||t instanceof Error?t.message:"Failed to load embeddings.":null}function DM({current:e,query:t,similarityState:n,scanStableMode:r=!1,viewState:s,randomSeed:i,localStarOverrides:o,sessionResetToken:l=0,onFolderHydratedSnapshot:c,getCachedHydratedSnapshot:d}){var _,G;const f=wr(),{data:p,refetch:h,isLoading:w,isError:x}=Jx(e,!0),{data:b}=xN("/",{enabled:e!=="/"}),[S,y]=u.useState(),m=u.useRef(0),v=u.useCallback(()=>h(),[h]);u.useEffect(()=>{f.removeQueries({predicate:({queryKey:V})=>yN(V,e,!1)})},[e,f]),u.useEffect(()=>{m.current+=1,CS({requestId:m.current});const V=(d==null?void 0:d(e))??null;y(V??void 0)},[e,d,l]),u.useEffect(()=>()=>{YS()},[e]),u.useEffect(()=>{if(!p)return;const V=m.current;u.startTransition(()=>{y(p),c==null||c(p.path,p)}),kS(V)},[c,p]);const g=n!==null,C=TM(t,250),E=u.useMemo(()=>g?null:yh(C,e),[g,C,e]),T=E!==null,M=(E==null?void 0:E.q)??"",I=jM((E==null?void 0:E.q)??"",(E==null?void 0:E.path)??e),j=PM(),B=((_=j.data)==null?void 0:_.embeddings)??[],F=((G=j.data)==null?void 0:G.rejected)??[],Q=B.length>0,ee=OM(j.isError,j.error),z=u.useMemo(()=>{var J;return(T?((J=I.data)==null?void 0:J.items)??[]:(S==null?void 0:S.items)??[]).map(se=>({...se,star:o[se.path]!==void 0?o[se.path]:se.star}))},[T,I.data,S,o]),L=u.useMemo(()=>{var se;const V=new Map;for(const Y of z)V.set(Y.path,Y);const J=((se=I.data)==null?void 0:se.items)??[];for(const Y of J){if(V.has(Y.path))continue;const q=o[Y.path]!==void 0?o[Y.path]:Y.star;V.set(Y.path,{...Y,star:q})}return V},[z,I.data,o]),R=u.useMemo(()=>n?n.items.map(V=>{const J=L.get(V.path);return J||mE(V.path,o[V.path])}):[],[n,L,o]),P=u.useMemo(()=>{if(n)return pg(R,s.filters);const V=pg(z,s.filters);return r?V:FM(V,s.sort,i)},[n,R,z,r,s.filters,s.sort,i]),A=n?R.length:z.length,O=P.length,K=(S==null?void 0:S.totalItems)??(S==null?void 0:S.items.length)??A,U=e==="/"?K:(b==null?void 0:b.totalItems)??(b==null?void 0:b.items.length)??K;return{data:S,refetch:v,isLoading:w,isError:x,searching:T,normalizedQ:M,similarityActive:g,embeddings:B,embeddingsRejected:F,embeddingsAvailable:Q,embeddingsLoading:j.isLoading,embeddingsError:ee,poolItems:z,similarityItems:R,items:P,totalCount:A,filteredCount:O,scopeTotal:K,rootTotal:U}}function zM({current:e,itemPaths:t,items:n,selectionPool:r,focusGridCell:s}){const[i,o]=u.useState([]),[l,c]=u.useState(null),[d,f]=u.useState(!1),[p,h]=u.useState(0),[w,x]=u.useState(0),b=u.useRef(!1),S=u.useRef(!1),y=u.useRef(null),m=u.useMemo(()=>new Set(i),[i]),v=u.useMemo(()=>{if(!i.length)return[];const q=new Map(r.map(fe=>[fe.path,fe])),H=new Map(n.map(fe=>[fe.path,fe]));return i.map(fe=>q.get(fe)??H.get(fe)).filter(fe=>!!fe)},[i,r,n]),g=u.useMemo(()=>n.filter(q=>m.has(q.path)),[n,m]),C=u.useMemo(()=>g.map(q=>q.path),[g]),E=Math.max(0,g.length-2),T=Math.min(p,E),M=g[T]??null,I=g[T+1]??null,j=T>0,B=T<g.length-2,F=g.length>=2,Q=l!=null||d,ee=l??i[0]??null,z=ee?t.indexOf(ee):-1,L=z>0,R=z>=0&&z<t.length-1;u.useEffect(()=>{h(q=>q>E?E:q)},[E]);const P=u.useCallback(()=>{x(q=>q+1)},[]),A=u.useCallback(q=>{y.current=q},[]),O=u.useCallback(()=>{c(null),b.current=!1},[]),K=u.useCallback(q=>{if(q){c(q),o([q]);return}O()},[O]),U=u.useCallback(q=>{l&&(c(null),b.current=!1,Wl(q))},[l]),_=u.useCallback(q=>{c(q),b.current=!0,Fx(q)},[]),G=u.useCallback(()=>{c(null),b.current?(b.current=!1,window.history.back()):Wl(e),s(y.current)},[e,s]),V=u.useCallback(()=>{d||!F||(i[0]&&(y.current=i[0]),h(0),f(!0),l&&(c(null),b.current&&(b.current=!1),Wl(e)),S.current||(window.history.pushState({compare:!0},"",window.location.href),S.current=!0))},[d,F,e,i,l]),J=u.useCallback(()=>{f(!1),S.current&&(S.current=!1,window.history.back()),s(y.current??i[0])},[s,i]),se=u.useCallback(q=>{g.length<2||h(H=>{const fe=Math.max(0,g.length-2);return Math.min(fe,Math.max(0,H+q))})},[g.length]),Y=u.useCallback(q=>{if(!t.length)return;const H=l??i[0];if(!H)return;const fe=t.indexOf(H);if(fe===-1)return;const Te=Math.min(t.length-1,Math.max(0,fe+q)),we=t[Te];!we||we===H||(l&&(c(we),Wl(we)),o([we]))},[t,i,l]);return u.useEffect(()=>{d&&(F||J())},[d,F,J]),u.useEffect(()=>{const q=()=>{l&&(b.current=!1,c(null)),d&&(S.current=!1,f(!1))};return window.addEventListener("popstate",q),()=>window.removeEventListener("popstate",q)},[l,d]),{selectedPaths:i,setSelectedPaths:o,viewer:l,compareOpen:d,restoreGridToSelectionToken:w,bumpRestoreGridToSelectionToken:P,selectedItems:v,compareItems:g,comparePaths:C,compareIndexClamped:T,compareA:M,compareB:I,canComparePrev:j,canCompareNext:B,compareEnabled:F,canPrevImage:L,canNextImage:R,overlayActive:Q,rememberFocusedPath:A,openViewer:_,closeViewer:G,openCompare:V,closeCompare:J,handleCompareNavigate:se,handleNavigate:Y,resetViewerState:O,clearViewerForSearch:U,syncHashImageSelection:K}}const $M=2048,BM=6,UM=10;function l0(e){const t=new Map;for(const n of e)t.set(n.path,n.name);return t}function a0(e,t){return t.get(e)??e.split("/").pop()??e}function mg(e,t){const n=e.filter(r=>!t.has(r.path));return n.length===e.length?e:n}function gg(e,t,n,r,s){const i=e.filter(l=>l.path!==t);return[{path:t,ts:n,kind:r},...i].slice(0,s)}function VM(e,t){if(!e.length)return null;const n=l0(t),r=new Set,s=[];for(const o of e)r.has(o.path)||(r.add(o.path),s.push(o.path));const i=s.slice(0,2).map(o=>a0(o,n));return{count:s.length,names:i,extra:Math.max(0,s.length-i.length)}}function WM(e,t,n,r){if(!e.length)return[];const s=l0(t);return e.map(i=>({path:i.path,label:a0(i.path,s),timeLabel:r(i.ts,n)}))}function HM(e){const[t,n]=u.useState([]),[r,s]=u.useState([]),[i,o]=u.useState(new Map),l=u.useRef(new Map),c=u.useRef(new Set),d=u.useRef(new Set),f=u.useRef(new Set);u.useEffect(()=>()=>{for(const S of l.current.values())window.clearTimeout(S);l.current.clear(),c.current.clear()},[]),u.useEffect(()=>{d.current=new Set(e),n(S=>mg(S,f.current))},[e]);const p=u.useCallback((S,y)=>{if(y!=null){if(c.current.has(y))return;if(c.current.add(y),c.current.size>$M){const E=c.current.values().next().value;E!=null&&c.current.delete(E)}}const m=y!=null?`event:${y}`:`event:${S}:${Date.now()}`;o(E=>{if(E.get(S)===m)return E;const T=new Map(E);return T.set(S,m),T});const v=l.current,g=v.get(S);g!=null&&window.clearTimeout(g);const C=window.setTimeout(()=>{o(E=>{if(E.get(S)!==m)return E;const T=new Map(E);return T.delete(S),T}),v.delete(S)},tM);v.set(S,C)},[]),h=u.useCallback(S=>{f.current=S,n(y=>mg(y,S))},[]),w=u.useCallback((S,y,m)=>{const v=Date.now();d.current.has(S)&&f.current.has(S)||n(C=>gg(C,S,v,y,BM)),p(S,m)},[p]),x=u.useCallback((S,y,m)=>{const v=Date.now(),g=Mx(m)??v;s(C=>gg(C,S,g,y,UM))},[]),b=u.useCallback(()=>{n([])},[]);return{offViewActivity:t,recentTouches:r,highlightedPaths:i,onVisiblePathsChange:h,markRecentActivity:w,markRecentTouch:x,clearOffViewActivity:b}}function yg(e){if(typeof e!="number"||!Number.isFinite(e))return;const t=Math.trunc(e);return t<0?0:t}function QM(e){if(typeof e!="string")return;const t=e.trim();return t.length?t:void 0}function KM(e){if(!e)return null;const t=e.state;if(t!=="idle"&&t!=="running"&&t!=="ready"&&t!=="error")return null;let n=yg(e.done);const r=yg(e.total);return n!==void 0&&r!==void 0&&n>r&&(n=r),{state:t,scope:typeof e.scope=="string"?e.scope:void 0,done:n,total:r,generation:QM(e.generation),started_at:typeof e.started_at=="string"?e.started_at:void 0,finished_at:typeof e.finished_at=="string"?e.finished_at:void 0,error:typeof e.error=="string"?e.error:void 0}}function qM(e,t){return e===t?!0:!e||!t?!1:e.state===t.state&&e.scope===t.scope&&e.done===t.done&&e.total===t.total&&e.generation===t.generation&&e.started_at===t.started_at&&e.finished_at===t.finished_at&&e.error===t.error}function GM(e){return(e==null?void 0:e.state)==="idle"||(e==null?void 0:e.state)==="running"}function YM(e,t,n){return(e==null?void 0:e.state)==="running"?t:n}const u0=[1],XM={supportedVersions:[...u0],maxPathsV2:null,supportsV2:!1};function JM(e){if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.trunc(e);return t>0?t:null}function ZM(e){if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.trunc(e);return t>=2?t:null}function ej(e){let t=[...u0];const n=e==null?void 0:e.supported_versions;if(Array.isArray(n)){const i=Array.from(new Set(n.map(o=>JM(o)).filter(o=>o!==null))).sort((o,l)=>o-l);i.length>0&&(t=i)}const r=ZM(e==null?void 0:e.max_paths_v2),s=t.includes(2)&&r!==null&&r>2;return{supportedVersions:t,maxPathsV2:r,supportsV2:s}}function tj(e,t){if(e===t)return!0;if(e.supportsV2!==t.supportsV2||e.maxPathsV2!==t.maxPathsV2||e.supportedVersions.length!==t.supportedVersions.length)return!1;for(let n=0;n<e.supportedVersions.length;n+=1)if(e.supportedVersions[n]!==t.supportedVersions[n])return!1;return!0}const nj=1200,vg=3e3;function rj(e){switch(e){case"live":return"Live";case"reconnecting":return"Reconnecting";case"offline":return"Offline";case"connecting":case"idle":default:return"Connecting"}}function xg(e){if(!(e instanceof ln))return null;const t=e.body;if(!t||typeof t!="object")return null;const n=t.error;return typeof n=="string"?n:null}function wg(e,t){return t-e<JN?Fk(e,t):Ok(e)}function sj({current:e,currentGalleryId:t,itemPaths:n,items:r,queryClient:s,updateItemCaches:i,setLocalStarOverrides:o}){const l=u.useRef(Ai()),c=u.useRef(null),d=u.useRef(null),f=u.useRef(null),p=u.useRef(!1),h=u.useRef(null),w=u.useRef("idle"),[x,b]=u.useState("idle"),[S,y]=u.useState({}),[m,v]=u.useState(null),[g,C]=u.useState(null),[E,T]=u.useState(!1),[M,I]=u.useState(()=>Date.now()),[j,B]=u.useState(!0),[F,Q]=u.useState(null),[ee,z]=u.useState(null),[L,R]=u.useState(XM);u.useEffect(()=>{if(g==null){T(!1);return}T(!0);const le=window.setTimeout(()=>T(!1),YN);return()=>window.clearTimeout(le)},[g]),u.useEffect(()=>{if(m==null)return;I(Date.now());const le=window.setInterval(()=>I(Date.now()),1e4);return()=>window.clearInterval(le)},[m]);const{offViewActivity:P,recentTouches:A,highlightedPaths:O,onVisiblePathsChange:K,markRecentActivity:U,markRecentTouch:_,clearOffViewActivity:G}=HM(n),V=u.useCallback(le=>{const oe=Date.now(),Ie=Mx(le)??oe,Se=Ie>oe?oe:Ie;v(ce=>ce==null?Se:ce>Se?ce:Se),C(oe),I(oe)},[]),J=u.useCallback(le=>{le.length&&y(oe=>{let ge=!1;const Ie={...oe};for(const Se of le){const ce=oe[Se.gallery_id];ce&&ce.viewing===Se.viewing&&ce.editing===Se.editing||(Ie[Se.gallery_id]=Se,ge=!0)}return ge?Ie:oe})},[]),se=u.useCallback(()=>{h.current!=null&&(window.clearTimeout(h.current),h.current=null)},[]),Y=u.useCallback(le=>{le&&y(oe=>{if(!(le in oe))return oe;const ge={...oe};return delete ge[le],ge})},[]),q=u.useCallback(le=>{c.current=le.lease_id,d.current=le.gallery_id,J([le])},[J]),H=u.useCallback(async(le,oe=!1)=>{const ge=l.current,Ie=oe?void 0:c.current??void 0,Se=ce=>pe.joinPresence(le,ce,ge);try{q(await Se(Ie));return}catch(ce){if(!oe&&xg(ce)==="invalid_lease"){q(await Se(void 0));return}throw ce}},[q]),fe=u.useCallback(async(le,oe)=>{if(le===oe){await H(oe);return}const ge=c.current;if(!ge){await H(oe,!0);return}try{const Ie=await pe.movePresence(le,oe,ge,l.current);d.current=Ie.to_scope.gallery_id,J([Ie.from_scope,Ie.to_scope]);return}catch(Ie){const Se=xg(Ie);if(Se==="invalid_lease"){await H(oe,!0);return}if(Se==="scope_mismatch"){await H(oe);return}throw Ie}},[J,H]),Te=u.useCallback(async le=>{const oe=d.current;if(!oe){await H(le,!0);return}if(oe===le){await H(le);return}await fe(oe,le)},[H,fe]),we=u.useCallback(async()=>{if(p.current)return;const le=f.current;if(le){f.current=null,p.current=!0;try{await Te(le)}catch{}finally{p.current=!1;const oe=f.current;oe&&oe!==d.current&&we()}}},[Te]),he=u.useCallback((le,oe=!1)=>{if(f.current=le,se(),oe||d.current==null){we();return}h.current=window.setTimeout(()=>{h.current=null,we()},eM)},[se,we]),ze=u.useCallback(()=>{d.current=null,c.current=null,f.current=null,se()},[se]),Ue=u.useCallback(le=>{const oe=d.current,ge=c.current;!oe||!ge||(JS(oe,ge,l.current),le&&Y(oe),ze())},[Y,ze]);u.useEffect(()=>{WS();const le=QS(ge=>{if(ge.type==="presence"){const ce=ge.data;if(!(ce!=null&&ce.gallery_id))return;J([ce]);return}const Ie=ge.data;if(!(Ie!=null&&Ie.path))return;const Se=Ie.path;if(ge.type==="item-updated"){const ce=ge.data,Fe={v:1,tags:ce.tags??[],notes:ce.notes??"",star:ce.star??null,version:ce.version??1,updated_at:ce.updated_at??"",updated_by:ce.updated_by??"server"};s.setQueryData(Wo(Se),Fe),i({path:Se,star:ce.star??null,metrics:ce.metrics,comments:ce.notes??""}),Ek(Se,Fe),U(Se,"item-updated",ge.id),_(Se,"item-updated",ce.updated_at),V(ce.updated_at),o(Ge=>{if(Ge[Se]===void 0)return Ge;const et={...Ge};return delete et[Se],et})}else if(ge.type==="metrics-updated"){const ce=ge.data;i({path:Se,metrics:ce.metrics}),U(Se,"metrics-updated",ge.id),_(Se,"metrics-updated",ce.updated_at),V(ce.updated_at)}}),oe=KS(b);return()=>{le(),oe(),HS()}},[J,U,_,s,o,i,V]),u.useEffect(()=>{const le=d.current;le!==t&&he(t,le==null)},[t,he]),u.useEffect(()=>{const le=window.setInterval(()=>{const oe=d.current;oe&&H(oe)},ZN);return()=>{window.clearInterval(le)}},[H]),u.useEffect(()=>{const le=w.current;if(w.current=x,x==="live"&&le!=="live"){he(t,!0);return}(x==="reconnecting"||x==="offline")&&Y(d.current)},[Y,x,t,he]),u.useEffect(()=>{const le=()=>Ue(!0),oe=()=>Ue(!0),ge=()=>{he(t,!0)};return window.addEventListener("pagehide",le),window.addEventListener("beforeunload",oe),window.addEventListener("pageshow",ge),()=>{window.removeEventListener("pagehide",le),window.removeEventListener("beforeunload",oe),window.removeEventListener("pageshow",ge),Ue(!1)}},[t,he,Ue]),u.useEffect(()=>{let le=!1,oe=null;const ge=()=>{oe!=null&&(window.clearTimeout(oe),oe=null)},Ie=ce=>{ge(),oe=window.setTimeout(()=>{Se()},ce)},Se=async()=>{var ce;try{const Fe=await pe.getHealth();if(le)return;B(((ce=Fe==null?void 0:Fe.labels)==null?void 0:ce.enabled)??!0);const Ge=(Fe==null?void 0:Fe.mode)??null;Q(Ge);const et=KM(Fe==null?void 0:Fe.indexing);z(gt=>qM(gt,et)?gt:et);const kn=ej(Fe==null?void 0:Fe.compare_export);R(gt=>tj(gt,kn)?gt:kn),GM(et)&&Ie(YM(et,nj,vg))}catch{if(le)return;Ie(vg)}};return Se(),()=>{le=!0,ge()}},[]);const Tt=S[e],Bt=(Tt==null?void 0:Tt.editing)??0,Ut=m!=null,Dn=u.useMemo(()=>rj(x),[x]),tn=u.useMemo(()=>!Ut||m==null?"No edits yet.":wg(m,M),[Ut,m,M]),Cn=u.useMemo(()=>VM(P,r),[P,r]),Vt=u.useMemo(()=>WM(A,r,M,wg),[r,M,A]);return{connectionStatus:x,connectionLabel:Dn,presence:Tt,editingCount:Bt,recentEditActive:E,hasEdits:Ut,lastEditedLabel:tn,persistenceEnabled:j,healthMode:F,indexing:ee,compareExportCapability:L,highlightedPaths:O,onVisiblePathsChange:K,offViewSummary:Cn,recentTouchesDisplay:Vt,clearOffViewActivity:G}}const ij=600;function oj(e){if(!(e instanceof ln))return!1;if(e.status===403||e.status===405)return!0;const t=String(e.message||"").toLowerCase();return t.includes("read-only")||t.includes("no-write")||t.includes("write")}function oo(e,t){return oj(e)?"This workspace is read-only. Upload and move actions are disabled.":e instanceof ln||e instanceof Error&&e.message?e.message:t}function Lc(e){return Array.from(new Set(e.filter(Boolean)))}function bg(e,t){return t.length?t.length===1?t[0]:`${e} failed for ${t.length} item(s). ${t[0]}`:""}async function lj(){const e=["/"],t=new Set,n=new Set(["/"]);for(;e.length>0&&t.size<ij;){const r=e.shift()??"/",s=Rt(r);if(t.has(s))continue;t.add(s);let i=null;try{i=await pe.getFolder(s)}catch{i=null}if(i)for(const o of i.dirs??[]){const l=Rt(Ox(s,o.name));n.has(l)||(n.add(l),e.push(l))}}return Array.from(n).sort((r,s)=>r==="/"?-1:s==="/"?1:r.localeCompare(s))}function aj({appRef:e,uploadInputRef:t,current:n,currentDirCount:r,selectedPaths:s,setSelectedPaths:i,refetch:o,invalidateDerivedCounts:l}){const c=wr(),[d,f]=u.useState(!1),[p,h]=u.useState(null),[w,x]=u.useState(!1),[b,S]=u.useState(null),[y,m]=u.useState(["/"]),[v,g]=u.useState(!1),[C,E]=u.useState(null);u.useEffect(()=>{h(null)},[n]);const T=u.useCallback(L=>{const R=Lc(s);return R.includes(L)?R:[L]},[s]),M=u.useCallback((L,R)=>{const P=T(L);i(P),E({x:R.x,y:R.y,kind:"grid",payload:{paths:P}})},[T,i]),I=u.useCallback((L,R)=>{E({x:R.x,y:R.y,kind:"tree",payload:{path:L}})},[]);u.useEffect(()=>{if(!b)return;let L=!1;return g(!0),lj().then(R=>{L||m(R)}).catch(R=>{L||h(oo(R,"Failed to load destination folders."))}).finally(()=>{L||g(!1)}),()=>{L=!0}},[b]);const j=u.useCallback(async(L,R)=>{const P=Lc(L);if(!P.length)return!1;const A=Rt(R||"/");h(null);const O=[],K=[];for(const _ of P)try{await pe.moveFile(_,A)}catch(G){O.push(`${ph(_)||_}: ${oo(G,"Move failed.")}`),K.push(_)}try{await c.invalidateQueries({predicate:({queryKey:_})=>Array.isArray(_)&&_[0]==="folder"}),l(),await o()}catch(_){O.push(oo(_,"Move completed, but refresh failed."))}if(O.length)return h(bg("Move",O)),i(K),!1;S(null),E(null);const U=new Set(P);return i(_=>_.filter(G=>!U.has(G))),!0},[l,c,o,i]),B=u.useCallback(L=>{const R=Lc(L);R.length&&(h(null),S({paths:R}),E(null))},[]),F=u.useCallback(async L=>{if(!L.length)return;if(!(r===0)){h("Uploads are only allowed into folders without subdirectories.");return}f(!0),h(null);const P=[];try{for(const A of L)try{await pe.uploadFile(n,A)}catch(O){P.push(`${A.name}: ${oo(O,"Upload failed.")}`)}try{await o()}catch(A){P.push(oo(A,"Upload completed, but refresh failed."))}}finally{f(!1)}if(P.length){h(bg("Upload",P));return}h(null)},[n,r,o]),Q=u.useCallback(()=>{var L;d||(L=t.current)==null||L.click()},[t,d]),ee=u.useCallback(async L=>{const R=Array.from(L.target.files??[]);L.target.value="",R.length&&await F(R)},[F]);u.useEffect(()=>{const L=e.current;if(!L)return;const R=O=>{O.dataTransfer&&Array.from(O.dataTransfer.types).includes("Files")&&(O.preventDefault(),x(!0))},P=O=>{const K=O.relatedTarget;K&&L.contains(K)||x(!1)},A=async O=>{var U;O.preventDefault(),x(!1);const K=Array.from(((U=O.dataTransfer)==null?void 0:U.files)??[]);K.length&&await F(K)};return L.addEventListener("dragover",R),L.addEventListener("dragleave",P),L.addEventListener("drop",A),()=>{L.removeEventListener("dragover",R),L.removeEventListener("dragleave",P),L.removeEventListener("drop",A)}},[e,F]),u.useEffect(()=>{const L=()=>E(null),R=P=>{P.key==="Escape"&&E(null)};return window.addEventListener("click",L),window.addEventListener("keydown",R),()=>{window.removeEventListener("click",L),window.removeEventListener("keydown",R)}},[]);const z=u.useCallback(()=>{S(null)},[]);return{uploading:d,actionError:p,isDraggingOver:w,moveDialog:b,moveFolders:y,moveFoldersLoading:v,ctx:C,setCtx:E,closeMoveDialog:z,openUploadPicker:Q,handleUploadInputChange:ee,openGridActions:M,openFolderActions:I,openMoveDialogForPaths:B,moveSelectedToFolder:j}}const uj=1e4;function Fn(e){const t=e.trim();return!t||t==="/"?"/":t.startsWith("/")?t:`/${t}`}function c0(e,t){const n=Fn(t),r=e[n];return r||{path:n,hydratedSnapshot:null,hydratedGeneratedAt:null,hydratedItemCount:0,hydratedAtMs:null,topAnchorPath:null}}function of(e,t){return t==="/"?!0:e===t||e.startsWith(`${t}/`)}function cj(e){for(const t of e)return t;return null}function dj(e,t,n,r){const s=c0(e,t),i=n.items.length<=uj?n:null,o={...s,path:Fn(t),hydratedSnapshot:i,hydratedGeneratedAt:n.generatedAt??null,hydratedItemCount:n.totalItems??n.items.length,hydratedAtMs:r};return s.hydratedSnapshot===o.hydratedSnapshot&&s.hydratedGeneratedAt===o.hydratedGeneratedAt&&s.hydratedItemCount===o.hydratedItemCount&&s.hydratedAtMs===o.hydratedAtMs?e:{...e,[o.path]:o}}function Sg(e,t,n){const r=c0(e,t),s=Fn(t),i=n?Fn(n):null;return r.topAnchorPath===i&&r.path===s?e:{...e,[s]:{...r,path:s,topAnchorPath:i}}}function d0(e,t){const n=Fn(t);if(!e[n])return e;const r={...e};return delete r[n],r}function fj(e,t){const n=Fn(t);let r=!1;const s={...e};for(const i of Object.keys(s))of(i,n)&&(r=!0,delete s[i]);return r?s:e}function hj(e,t){const n=Fn(e),r=Fn(t);return!!(n===r||of(n,r)||of(r,n))}function pj(e,t,n){return hj(t,n)?e:d0(e,n)}function mj(){const e=u.useRef({}),t=u.useCallback(p=>e.current[Fn(p)]??null,[]),n=u.useCallback(p=>{var h;return((h=e.current[Fn(p)])==null?void 0:h.hydratedSnapshot)??null},[]),r=u.useCallback(p=>{var h;return((h=e.current[Fn(p)])==null?void 0:h.topAnchorPath)??null},[]),s=u.useCallback((p,h)=>{e.current=dj(e.current,p,h,Date.now())},[]),i=u.useCallback((p,h)=>{e.current=Sg(e.current,p,h)},[]),o=u.useCallback((p,h)=>{const w=cj(h);w&&(e.current=Sg(e.current,p,w))},[]),l=u.useCallback(p=>{e.current=d0(e.current,p)},[]),c=u.useCallback(p=>{e.current=fj(e.current,p)},[]),d=u.useCallback((p,h)=>{e.current=pj(e.current,p,h)},[]),f=u.useCallback(()=>{e.current={}},[]);return u.useMemo(()=>({getSession:t,getHydratedSnapshot:n,getTopAnchorPath:r,saveHydratedSnapshot:s,saveTopAnchorPath:i,saveTopAnchorFromVisiblePaths:o,invalidatePath:l,invalidateSubtree:c,invalidateForScopeTransition:d,clearAllSessions:f}),[t,n,r,s,i,o,l,c,d,f])}const gj={stars:{read:e=>{const t=e.stars||[];return t.length?{id:"stars",label:`Rating in: ${Rc(t)}`}:null},clear:(e,t)=>t.clearStars()},starsIn:{read:e=>{const t=e.starsIn.values||[];return t.length?{id:"stars-in",label:`Rating in: ${Rc(t)}`}:null},clear:(e,t)=>t.clearStars()},starsNotIn:{read:e=>{const t=e.starsNotIn.values||[];return t.length?{id:"stars-not-in",label:`Rating not in: ${Rc(t)}`}:null},clear:(e,t)=>t.clearStarsNotIn()},nameContains:{read:e=>{var n;const t=(n=e.nameContains.value)==null?void 0:n.trim();return t?{id:"name-contains",label:`Filename contains: ${t}`}:null},clear:(e,t)=>t.clearNameContains()},nameNotContains:{read:e=>{var n;const t=(n=e.nameNotContains.value)==null?void 0:n.trim();return t?{id:"name-not-contains",label:`Filename not: ${t}`}:null},clear:(e,t)=>t.clearNameNotContains()},commentsContains:{read:e=>{var n;const t=(n=e.commentsContains.value)==null?void 0:n.trim();return t?{id:"comments-contains",label:`Comments contain: ${t}`}:null},clear:(e,t)=>t.clearCommentsContains()},commentsNotContains:{read:e=>{var n;const t=(n=e.commentsNotContains.value)==null?void 0:n.trim();return t?{id:"comments-not-contains",label:`Comments not: ${t}`}:null},clear:(e,t)=>t.clearCommentsNotContains()},urlContains:{read:e=>{var n;const t=(n=e.urlContains.value)==null?void 0:n.trim();return t?{id:"url-contains",label:`URL contains: ${t}`}:null},clear:(e,t)=>t.clearUrlContains()},urlNotContains:{read:e=>{var n;const t=(n=e.urlNotContains.value)==null?void 0:n.trim();return t?{id:"url-not-contains",label:`URL not: ${t}`}:null},clear:(e,t)=>t.clearUrlNotContains()},dateRange:{read:e=>{const{from:t,to:n}=e.dateRange;return!t&&!n?null:{id:"date-range",label:`Date: ${cE(t,n)}`}},clear:(e,t)=>t.clearDateRange()},widthCompare:{read:e=>({id:"width-compare",label:`Width ${e.widthCompare.op} ${e.widthCompare.value}`}),clear:(e,t)=>t.clearWidthCompare()},heightCompare:{read:e=>({id:"height-compare",label:`Height ${e.heightCompare.op} ${e.heightCompare.value}`}),clear:(e,t)=>t.clearHeightCompare()},metricRange:{read:e=>({id:`metric:${e.metricRange.key}`,label:`${e.metricRange.key}: ${hE(e.metricRange.min,e.metricRange.max)}`}),clear:(e,t)=>t.clearMetricRange(e.metricRange.key)}};function yj(e,t){if("stars"in e)return t("stars",e);if("starsIn"in e)return t("starsIn",e);if("starsNotIn"in e)return t("starsNotIn",e);if("nameContains"in e)return t("nameContains",e);if("nameNotContains"in e)return t("nameNotContains",e);if("commentsContains"in e)return t("commentsContains",e);if("commentsNotContains"in e)return t("commentsNotContains",e);if("urlContains"in e)return t("urlContains",e);if("urlNotContains"in e)return t("urlNotContains",e);if("dateRange"in e)return t("dateRange",e);if("widthCompare"in e)return t("widthCompare",e);if("heightCompare"in e)return t("heightCompare",e);if("metricRange"in e)return t("metricRange",e)}function vj(e,t){const n=[];for(const r of e.and)yj(r,(s,i)=>{const o=gj[s],l=o.read(i);l&&n.push({id:l.id,label:l.label,onRemove:()=>o.clear(i,t)})});return n}function bu(e){if(typeof e!="string")return null;const t=e.trim();return t.length?t:null}function xj(e,t){const n=bu(t==null?void 0:t.generation);return n&&(e===null||(t==null?void 0:t.state)==="idle"||(t==null?void 0:t.state)==="running")?n:e}function wj(e,t){const r=bu(e==null?void 0:e.generation)??((e==null?void 0:e.state)==="ready"?t.scanGeneration:null),s=r!==null&&t.scanGeneration===r&&t.recentGeneration!==r,i=s&&(e==null?void 0:e.state)==="ready";return{scanStableActive:s,sortLocked:s,showSwitchToMostRecentBanner:i}}const tt={sortKey:"sortKey",sortDir:"sortDir",sortSpec:"sortSpec",starFilters:"starFilters",filterAst:"filterAst",selectedMetric:"selectedMetric",viewMode:"viewMode",gridItemSize:"gridItemSize",leftOpen:"leftOpen",rightOpen:"rightOpen"},Gl={scanGeneration:"indexingScanGeneration",recentGeneration:"indexingMostRecentGeneration"};function Cg(e){if(typeof window>"u")return null;try{const t=window.localStorage.getItem(e);return bu(t)}catch{return null}}function kg(e,t){if(!(typeof window>"u"))try{window.localStorage.setItem(e,t)}catch{}}function Eg(e,t){for(const n of e)pe.prefetchFile(n,t),pe.prefetchThumb(n)}function bj(){var Lh;const[e,t]=u.useState("/"),[n,r]=u.useState(""),[s,i]=u.useState(!1),[o,l]=u.useState(null),[c,d]=u.useState(null),[f,p]=u.useState(100),[h,w]=u.useState(null),[x,b]=u.useState(()=>({filters:{and:[]},sort:{kind:"builtin",key:"added",dir:"desc"},selectedMetric:void 0})),[S,y]=u.useState(()=>Date.now()),[m,v]=u.useState("adaptive"),[g,C]=u.useState(220),[E,T]=u.useState(!1),[M,I]=u.useState(!0),[j,B]=u.useState(!0),[F,Q]=u.useState(()=>typeof window>"u"?1440:window.innerWidth),ee=ca(ua.narrow),[z,L]=u.useState("folders"),[R,P]=u.useState([]),[A,O]=u.useState(null),[K,U]=u.useState(0),[_,G]=u.useState(()=>Cg(Gl.scanGeneration)),[V,J]=u.useState(()=>Cg(Gl.recentGeneration)),[se,Y]=u.useState(!1),[q,H]=u.useState({}),fe=u.useRef(null),Te=u.useRef(null),we=u.useRef(null),he=u.useRef(null),ze=u.useRef(null),Ue=u.useRef(null),Tt=u.useRef(!1),{leftW:Bt,rightW:Ut,onResizeLeft:Dn,onResizeRight:tn}=hN(fe,z),{getHydratedSnapshot:Cn,getTopAnchorPath:Vt,saveHydratedSnapshot:le,saveTopAnchorPath:oe,invalidateSubtree:ge}=mj(),[Ie,Se]=u.useState(0),[ce,Fe]=u.useState(0),Ge=wr(),et=wk(),kn=sl(),gt=Sk(),[zn,Ce]=u.useState(!1),{data:rt,refetch:dn,isLoading:$n,searching:Wt,normalizedQ:Bi,similarityActive:D,embeddings:X,embeddingsRejected:ae,embeddingsAvailable:ye,embeddingsLoading:be,embeddingsError:Ee,poolItems:ie,similarityItems:Ne,items:me,totalCount:it,filteredCount:Oe,scopeTotal:yt,rootTotal:Ht}=DM({current:e,query:n,similarityState:o,scanStableMode:se,viewState:x,randomSeed:S,localStarOverrides:q,onFolderHydratedSnapshot:le,getCachedHydratedSnapshot:Cn,sessionResetToken:ce}),En=u.useMemo(()=>Rt(e||"/"),[e]),fn=u.useMemo(()=>Qm(x.filters),[x.filters]),Ye=u.useMemo(()=>me.map(N=>N.path),[me]),Bn=u.useCallback(N=>{if(!N)return;const $=document.getElementById(`cell-${encodeURIComponent(N)}`);$==null||$.focus()},[]),Ui=o?Ne:ie,{selectedPaths:vt,setSelectedPaths:St,viewer:Ct,compareOpen:Qt,restoreGridToSelectionToken:Fs,bumpRestoreGridToSelectionToken:Un,selectedItems:Zn,compareItems:ll,comparePaths:Vi,compareIndexClamped:Vn,compareA:er,compareB:al,canComparePrev:Su,canCompareNext:Cu,compareEnabled:ku,canPrevImage:Wi,canNextImage:ss,overlayActive:Eu,rememberFocusedPath:Nu,openViewer:Mu,closeViewer:ul,openCompare:Os,closeCompare:Hi,handleCompareNavigate:cl,handleNavigate:br,resetViewerState:dl,clearViewerForSearch:Ds,syncHashImageSelection:ju}=zM({current:e,itemPaths:Ye,items:me,selectionPool:Ui,focusGridCell:Bn}),fl=Kl(ju),hl=Kl(Un);u.useEffect(()=>{const N=re=>{const de=Rt(re),Le=OE(de)?de:null,kt=Le?Hm(de):de,je=!Tt.current;Tt.current=!0,fl.current(Le),t(Re=>{const dt=fE(Re,kt,Le,je);return Re===dt?Re:(hl.current(),dt)})};N(Wm());const $=()=>N(Wm());return window.addEventListener("hashchange",$),()=>window.removeEventListener("hashchange",$)},[hl,fl]);const Ru=Ui,zs=o?null:x.sort.kind==="metric"?x.sort.key:null,pl=u.useMemo(()=>mM(me,zs),[me,zs]),Pu=u.useCallback(N=>{const $=Object.prototype.hasOwnProperty.call(N,"star"),re=N.metrics!==void 0,de=N.comments!==void 0;if(!$&&!re&&!de)return;const Le=je=>{if(je.path!==N.path)return je;let Re=je;return $&&je.star!==N.star&&(Re={...Re,star:N.star??null}),re&&(Re={...Re,metrics:N.metrics??void 0}),de&&je.comments!==N.comments&&(Re={...Re,comments:N.comments??""}),Re},kt=je=>{if(!je)return je;let Re=!1;const dt=je.items.map(hn=>{const Us=Le(hn);return Us!==hn&&(Re=!0),Us});return Re?{...je,items:dt}:je};Ge.setQueriesData({predicate:({queryKey:je})=>Array.isArray(je)&&je[0]==="folder"},kt),Ge.setQueriesData({predicate:({queryKey:je})=>Array.isArray(je)&&je[0]==="search"},kt)},[Ge]),{connectionStatus:$s,connectionLabel:Tu,presence:Iu,editingCount:Lu,recentEditActive:_u,hasEdits:Au,lastEditedLabel:Fu,persistenceEnabled:ml,healthMode:Qi,indexing:te,compareExportCapability:ve,highlightedPaths:Xe,onVisiblePathsChange:tr,offViewSummary:f0,recentTouchesDisplay:h0,clearOffViewActivity:p0}=sj({current:e,currentGalleryId:En,itemPaths:Ye,items:me,queryClient:Ge,updateItemCaches:Pu,setLocalStarOverrides:H}),Bs=Qi!=="dataset"&&Qi!=="table";u.useEffect(()=>{const N=xj(_,te);!N||N===_||(G(N),kg(Gl.scanGeneration,N))},[te,_]);const Ki=u.useMemo(()=>wj(te,{scanGeneration:_,recentGeneration:V}),[te,V,_]);u.useEffect(()=>{Y(N=>N===Ki.scanStableActive?N:Ki.scanStableActive)},[Ki.scanStableActive]);const m0=u.useCallback(()=>{const N=bu(te==null?void 0:te.generation)??_;N&&(V!==N&&(J(N),kg(Gl.recentGeneration,N)),b($=>$.sort.kind==="builtin"&&$.sort.key==="added"&&$.sort.dir==="desc"?$:{...$,sort:{kind:"builtin",key:"added",dir:"desc"}}))},[te==null?void 0:te.generation,V,_]),g0=u.useCallback(N=>{N&&oe(e,N)},[e,oe]),y0=u.useMemo(()=>Vt(e),[e,Vt]);u.useEffect(()=>{Se(N=>N+1)},[e]);const Ou=u.useCallback(()=>{U(N=>N+1)},[]),vh=u.useCallback(N=>{const $=Rt(N||"/");return $===""?"/":$},[]),xh=u.useCallback(N=>{const $=re=>N==="/"?!0:re===N||re.startsWith(`${N}/`);Ge.invalidateQueries({predicate:({queryKey:re})=>{if(!Array.isArray(re)||re[0]!=="folder")return!1;const de=typeof re[1]=="string"?re[1]:"";return $(de)}})},[Ge]),Du=u.useCallback(async N=>{if(!Bs)return;const $=vh(N);await pe.refreshFolder($),xh($),Ou(),ge($),(e===$||e.startsWith($==="/"?"/":`${$}/`))&&(Fe(re=>re+1),await dn()),$d.evictPrefix($),qs.evictPrefix($)},[e,Ou,ge,xh,vh,dn,Bs]),v0=u.useCallback(async()=>{if(Bs)try{await Du(e)}catch(N){console.error("Failed to refresh folder:",N)}},[e,Bs,Du]),x0=u.useMemo(()=>gM(o?Ne:ie,q),[o,Ne,ie,q]),Sr=u.useMemo(()=>yM(o?Ne:ie),[o,Ne,ie]);u.useEffect(()=>{D||Sr.length&&b(N=>{const $=N.selectedMetric&&Sr.includes(N.selectedMetric)?N.selectedMetric:Sr[0];return $===N.selectedMetric?N:{...N,selectedMetric:$}})},[Sr,D]),u.useEffect(()=>{D||x.sort.kind==="metric"&&(Sr.includes(x.sort.key)||b(N=>({...N,sort:{kind:"builtin",key:"added",dir:N.sort.dir}})))},[Sr,x.sort,D]);const gl=u.useMemo(()=>rN(x.filters),[x.filters]),zu=D||Wt||gl>0,w0=et.state==="syncing"?"Syncing":et.state==="error"?et.message?`Not saved  ${et.message}`:"Not saved  retry":"All changes saved",b0=gt!=null&&gt>XN,S0=$s==="offline"||$s==="connecting"||$s==="idle",C0=$s==="reconnecting"||kn||et.state==="error"||b0,k0=GN({isOffline:S0,isUnstable:C0,recentEditActive:_u,editingCount:Lu}),E0=vM(D,zu,Oe,yt),N0=xM(D,zu,it,yt,Ht,e),wh=u.useMemo(()=>wM(o),[o]),bh=u.useMemo(()=>bM(o!==null,gl,Oe,it),[o,gl,Oe,it]),M0=SM({similarityActive:D,searching:Wt,itemCount:me.length,isLoading:$n}),It=u.useCallback(N=>{b($=>({...$,filters:N($.filters)}))},[]),j0=u.useCallback(N=>{b($=>({...$,filters:N}))},[]),$u=u.useCallback(()=>{It(N=>Pc(N,[]))},[It]),Sh=u.useCallback(()=>{b(N=>({...N,filters:{and:[]}}))},[]),Bu=u.useCallback(()=>{l(null);const N=Ue.current;Ue.current=null,N&&N.length?(St(N),Un()):St([])},[Un,St]),R0=u.useCallback(()=>{o&&Bu(),r(""),b(N=>({...N,filters:{and:[]}}))},[Bu,o]),P0=u.useCallback(async N=>{!o&&Ue.current===null&&(Ue.current=vt);const $=await pe.searchEmbeddings(N);if(l({embedding:$.embedding,queryPath:N.query_path??null,queryVector:N.query_vector_b64??null,topK:N.top_k??50,minScore:N.min_score??null,items:$.items,createdAt:Date.now()}),$.items.length){const re=N.query_path&&$.items.some(de=>de.path===N.query_path)?N.query_path:$.items[0].path;St([re]),Un()}else St([])},[Un,vt,St,o]),Uu=u.useCallback((N,$)=>{It(re=>nN(re,N,$))},[It]),Ch=u.useMemo(()=>vj(x.filters,{clearStars:$u,clearStarsNotIn:()=>It(N=>zx(N,[])),clearNameContains:()=>It(N=>$x(N,"")),clearNameNotContains:()=>It(N=>Bx(N,"")),clearCommentsContains:()=>It(N=>Ux(N,"")),clearCommentsNotContains:()=>It(N=>Vx(N,"")),clearUrlContains:()=>It(N=>Wx(N,"")),clearUrlNotContains:()=>It(N=>Hx(N,"")),clearDateRange:()=>It(N=>nf(N,null)),clearWidthCompare:()=>It(N=>pa(N,null)),clearHeightCompare:()=>It(N=>ma(N,null)),clearMetricRange:N=>Uu(N,null)}),[x.filters,$u,Uu,It]),T0=u.useCallback(N=>{const $=new Set(fn);$.has(N)?$.delete(N):$.add(N),b(re=>({...re,filters:Pc(re.filters,Array.from($))}))},[fn]),I0=u.useCallback(()=>{I(!0),L("metrics")},[]),L0=u.useCallback(N=>{b($=>({...$,sort:N})),N.kind==="builtin"&&N.key==="random"&&y(Date.now())},[]),kh=u.useCallback(N=>{if(N==="/"||N==="")return"Lenslet | Root";const $=N.split("/").filter(Boolean);if(!$.length)return"Lenslet";const re=$.slice(-2).join("/");return`Lenslet | ${$.length>2?`.../${re}`:`/${re}`}`},[]),_0=u.useMemo(()=>dE(e),[e]);u.useEffect(()=>{document.title=kh(e)},[e,kh]),u.useEffect(()=>{let N=!0;return pe.getViews().then($=>{N&&P($.views||[])}).catch(()=>{N&&P([])}),()=>{N=!1}},[]),u.useEffect(()=>{Wt&&(St([]),Ds(e))},[Ds,e,Wt,St]),u.useEffect(()=>{const N=fe.current,$=he.current;if(!N||!$)return;const re=()=>{const Le=Math.max(48,Math.round($.getBoundingClientRect().height));N.style.setProperty("--toolbar-h",`${Le}px`)};re();const de=window.ResizeObserver;if(de){const Le=new de(re);return Le.observe($),()=>Le.disconnect()}return window.addEventListener("resize",re),()=>window.removeEventListener("resize",re)},[]),u.useEffect(()=>{try{const N=localStorage.getItem(tt.sortKey),$=localStorage.getItem(tt.sortDir),re=localStorage.getItem(tt.sortSpec),de=localStorage.getItem(tt.starFilters),Le=localStorage.getItem(tt.filterAst),kt=localStorage.getItem(tt.selectedMetric),je=localStorage.getItem(tt.viewMode),Re=localStorage.getItem(tt.gridItemSize),dt=localStorage.getItem(tt.leftOpen),hn=localStorage.getItem(tt.rightOpen),_h=(Et=>{if(!Et)return null;const ot=jc(Et);return!ot||typeof ot!="object"?null:ot.kind==="builtin"&&(ot.key==="name"||ot.key==="added"||ot.key==="random")&&(ot.dir==="asc"||ot.dir==="desc")||ot.kind==="metric"&&typeof ot.key=="string"&&ot.key.length>0&&(ot.dir==="asc"||ot.dir==="desc")?ot:null})(re)??{kind:"builtin",key:N==="name"||N==="added"||N==="random"?N:"added",dir:$==="asc"||$==="desc"?$:"desc"};_h.key==="random"&&y(Date.now());let Wu=(Et=>{if(!Et)return null;const ot=jc(Et);return tf(ot)})(Le)??{and:[]};if(de){const Et=jc(de);if(Array.isArray(Et)){const ot=Et.filter(q0=>[0,1,2,3,4,5].includes(q0));Wu=Pc(Wu,ot)}}if(b(Et=>({...Et,sort:_h,filters:Wu,selectedMetric:kt||Et.selectedMetric})),(je==="grid"||je==="adaptive")&&v(je),Re){const Et=Number(Re);!isNaN(Et)&&Et>=80&&Et<=500&&C(Et)}(dt==="0"||dt==="false")&&I(!1),(hn==="0"||hn==="false")&&B(!1)}catch{}},[]),u.useEffect(()=>{ee&&(I(!1),B(!1))},[ee]),u.useEffect(()=>{if(typeof window>"u")return;const N=[1,1.25,1.5,1.75,2,3,4],$=Le=>N.reduce((kt,je)=>Math.abs(je-Le)<Math.abs(kt-Le)?je:kt,N[0]),re=()=>{var Us;const Le=window.devicePixelRatio||1,kt=$(Le),je=((Us=window.visualViewport)==null?void 0:Us.scale)??1,Re=Le*je/kt;if(!Number.isFinite(Re)){w(null);return}const dt=Math.round(Re*100),hn=Math.min(500,Math.max(25,dt));w(hn)};re(),window.addEventListener("resize",re),window.addEventListener("orientationchange",re);const de=window.visualViewport;return de&&de.addEventListener("resize",re),()=>{window.removeEventListener("resize",re),window.removeEventListener("orientationchange",re),de&&de.removeEventListener("resize",re)}},[]),u.useEffect(()=>{try{localStorage.setItem(tt.sortKey,x.sort.kind==="builtin"?x.sort.key:"added"),localStorage.setItem(tt.sortDir,x.sort.dir),localStorage.setItem(tt.sortSpec,JSON.stringify(x.sort));const N=Qm(x.filters);localStorage.setItem(tt.starFilters,JSON.stringify(N)),localStorage.setItem(tt.filterAst,JSON.stringify(x.filters)),x.selectedMetric?localStorage.setItem(tt.selectedMetric,x.selectedMetric):localStorage.removeItem(tt.selectedMetric),localStorage.setItem(tt.viewMode,m),localStorage.setItem(tt.gridItemSize,String(g)),localStorage.setItem(tt.leftOpen,M?"1":"0"),localStorage.setItem(tt.rightOpen,j?"1":"0")}catch{}},[x,m,g,M,j]),u.useEffect(()=>{if(typeof window>"u")return;const N=()=>Q(window.innerWidth);return N(),window.addEventListener("resize",N),window.addEventListener("orientationchange",N),()=>{window.removeEventListener("resize",N),window.removeEventListener("orientationchange",N)}},[]);const yl=F<=Yr.mobileMax,Eh=Kl(g);u.useEffect(()=>{yl||E&&T(!1)},[yl,E]),u.useEffect(()=>{const N=Te.current;if(!N)return;const $=de=>Math.min(500,Math.max(80,de)),re=de=>{de.ctrlKey&&(Ct||Qt||(de.preventDefault(),C(Le=>$(Le+(de.deltaY<0?20:-20)))))};return N.addEventListener("wheel",re,{passive:!1}),()=>N.removeEventListener("wheel",re)},[Ct,Qt]),u.useEffect(()=>{if(Ct||Qt)return;const N=Te.current;if(!N)return;const $=Re=>Math.min(500,Math.max(80,Re));let re=null;const de=Re=>{if(Re.length<2)return 0;const[dt,hn]=[Re[0],Re[1]];return Math.hypot(dt.clientX-hn.clientX,dt.clientY-hn.clientY)},Le=Re=>{if(Re.touches.length!==2)return;const dt=de(Re.touches);dt&&(re={dist:dt,size:Eh.current})},kt=Re=>{if(!re||Re.touches.length!==2)return;const dt=de(Re.touches);if(!dt)return;Re.preventDefault();const hn=$(re.size*(dt/re.dist));C(hn)},je=()=>{re=null};return N.addEventListener("touchstart",Le,{passive:!0}),N.addEventListener("touchmove",kt,{passive:!1}),N.addEventListener("touchend",je),N.addEventListener("touchcancel",je),()=>{N.removeEventListener("touchstart",Le),N.removeEventListener("touchmove",kt),N.removeEventListener("touchend",je),N.removeEventListener("touchcancel",je)}},[Ct,Qt,Eh]),u.useEffect(()=>{Eg(rM(Ye,Ct),"viewer")},[Ct,Ye]),u.useEffect(()=>{Qt&&Eg(sM(Vi,Vn),"compare")},[Qt,Vi,Vn]);const Vu=u.useCallback(N=>{dl();const $=Rt(N);t($),Fx($)},[dl]),{uploading:A0,actionError:Nh,isDraggingOver:F0,moveDialog:Mh,moveFolders:O0,moveFoldersLoading:D0,ctx:jh,setCtx:z0,closeMoveDialog:$0,openUploadPicker:B0,handleUploadInputChange:U0,openGridActions:Rh,openFolderActions:Ph,openMoveDialogForPaths:V0,moveSelectedToFolder:W0}=aj({appRef:fe,uploadInputRef:ze,current:e,currentDirCount:((Lh=rt==null?void 0:rt.dirs)==null?void 0:Lh.length)??0,selectedPaths:vt,setSelectedPaths:St,refetch:dn,invalidateDerivedCounts:Ou}),H0=u.useCallback(async()=>{const N=window.prompt("Save Smart Folder as:","New Smart Folder");if(!N)return;const $=aE(N,R),re={id:$,name:N,pool:{kind:"folder",path:e},view:JSON.parse(JSON.stringify(x))},de=[...R.filter(Le=>Le.id!==$),re];P(de),O($);try{await pe.saveViews({version:1,views:de})}catch(Le){if(Le instanceof ln&&Le.status===403){const kt=new Blob([JSON.stringify({version:1,views:de},null,2)],{type:"application/json"});ko(kt,`lenslet-smart-folder-${$}.json`),alert("No-write mode: exported Smart Folder JSON instead of saving.");return}console.error("Failed to save Smart Folder:",Le)}},[e,x,R]);u.useEffect(()=>{if(!A)return;const N=R.find(de=>de.id===A);if(!N){O(null);return}const $=N.pool.path===e,re=JSON.stringify(N.view)===JSON.stringify(x);(!$||!re)&&O(null)},[A,R,e,x]);const Th=Kl({current:e,items:me,selectedPaths:vt,viewer:Ct,compareOpen:Qt,mobileSelectMode:E,openFolder:Vu});u.useEffect(()=>{const N=$=>{const re=Th.current;if(!ch($.target)){if(($.ctrlKey||$.metaKey)&&$.key.toLowerCase()==="b"){$.preventDefault(),$.altKey?B(de=>!de):I(de=>!de);return}if(!(re.viewer||re.compareOpen)){if($.key==="Backspace"||$.key==="Delete")$.preventDefault(),re.openFolder(Hm(re.current));else if(($.ctrlKey||$.metaKey)&&$.key.toLowerCase()==="a")$.preventDefault(),St(re.items.map(de=>de.path));else if($.key==="Escape"){if(re.selectedPaths.length){$.preventDefault(),St([]);return}re.mobileSelectMode&&($.preventDefault(),T(!1))}else if($.key==="/"){$.preventDefault();const de=document.querySelector(".toolbar-right .input");de==null||de.focus()}}}};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[Th,St]);const Ih=u.useMemo(()=>mS({viewportWidth:F,leftOpen:M,rightOpen:j,leftWidth:Bt,rightWidth:Ut}),[F,M,j,Bt,Ut]),Q0=M?`${Ih.leftWidth}px`:"0px",K0=j?`${Ih.rightWidth}px`:"0px";return a.jsxs("div",{className:"app-shell grid h-full grid-cols-[var(--left)_1fr_var(--right)]",ref:fe,style:{"--left":Q0,"--right":K0},children:[a.jsx(vS,{rootRef:he,onSearch:r,viewerActive:!!Ct,onBack:ul,zoomPercent:Ct?f:void 0,onZoomPercentChange:N=>d(N),currentLabel:_0,itemCount:E0,totalCount:N0,sortSpec:x.sort,metricKeys:Sr,onSortChange:L0,sortDisabled:D||Ki.sortLocked,filterCount:gl,onOpenFilters:I0,starFilters:fn,onToggleStar:T0,onClearStars:$u,onClearFilters:Sh,starCounts:x0,viewMode:m,onViewMode:v,gridItemSize:g,onGridItemSize:C,leftOpen:M,rightOpen:j,onToggleLeft:()=>I(N=>!N),onToggleRight:()=>B(N=>!N),onPrevImage:()=>br(-1),onNextImage:()=>br(1),canPrevImage:Wi,canNextImage:ss,searchDisabled:D,searchPlaceholder:D?"Exit similarity to search":void 0,onUploadClick:B0,uploadBusy:A0,uploadDisabled:Qt,multiSelectMode:E,selectedCount:vt.length,onToggleMultiSelectMode:yl?()=>T(N=>!N):void 0,syncIndicator:{state:k0,presence:Iu,syncLabel:w0,connectionLabel:Tu,lastEditedLabel:Fu,hasEdits:Au,localTypingActive:zn,recentTouches:h0}}),a.jsx("input",{ref:ze,type:"file",multiple:!0,accept:"image/*",className:"sr-only",onChange:U0}),M&&a.jsx(KN,{leftTool:z,onToolChange:L,compareEnabled:ku,compareActive:Qt,onOpenCompare:Os,views:R,activeViewId:A,onActivateView:N=>{var re;O(N.id);const $=tf((re=N.view)==null?void 0:re.filters)??{and:[]};b({...N.view,filters:$}),Vu(N.pool.path)},onSaveView:H0,current:e,data:rt,onOpenFolder:N=>{O(null),Vu(N)},onOpenFolderActions:Ph,onPullRefreshFolders:Bs?v0:void 0,onContextMenu:(N,$)=>{N.preventDefault(),Ph($,{x:N.clientX,y:N.clientY})},countVersion:K,items:Ru,filteredItems:me,metricKeys:Sr,selectedItems:Zn,selectedMetric:x.selectedMetric,onSelectMetric:N=>b($=>({...$,selectedMetric:N})),filters:x.filters,onChangeRange:Uu,onChangeFilters:j0,onResize:Dn}),a.jsxs("div",{className:"grid-shell col-start-2 row-start-2 relative overflow-hidden flex flex-col",ref:Te,children:[a.jsx("div",{"aria-live":"polite",className:"sr-only",children:vt.length?`${vt.length} selected`:""}),a.jsx(qN,{persistenceEnabled:ml,indexing:te,showSwitchToMostRecentBanner:Ki.showSwitchToMostRecentBanner,onSwitchToMostRecent:m0,offViewSummary:f0,canRevealOffView:zu,onRevealOffView:R0,onClearOffView:p0,browserZoomPercent:h}),Nh&&a.jsx("div",{className:"border-b border-border bg-panel px-3 py-2",children:a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",children:Nh})}),o&&a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"font-semibold",children:"Similarity mode"}),a.jsxs("span",{className:"text-muted",children:["Embedding: ",o.embedding]}),wh&&a.jsxs("span",{className:"text-muted",children:["Query: ",wh]}),bh&&a.jsxs("span",{className:"text-muted",children:["Results: ",bh]}),a.jsxs("span",{className:"text-muted",children:["Top K: ",o.topK]}),o.minScore!=null&&a.jsxs("span",{className:"text-muted",children:["Min score: ",o.minScore]})]}),a.jsx("button",{className:"btn btn-sm",onClick:Bu,children:"Exit similarity"})]})}),Ch.length>0&&a.jsx("div",{className:"sticky top-0 z-10 px-3 py-2 bg-panel border-b border-border",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Filters"}),Ch.map(N=>a.jsxs("span",{className:"filter-chip",children:[a.jsx("span",{className:"truncate max-w-[240px]",title:N.label,children:N.label}),a.jsx("button",{className:"filter-chip-remove","aria-label":`Clear filter ${N.label}`,onClick:N.onRemove,children:""})]},N.id)),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:Sh,children:"Clear all"})]})}),a.jsxs("div",{className:"flex-1 min-h-0 relative",children:[a.jsx(BC,{items:me,selected:vt,restoreToSelectionToken:Fs,restoreToTopAnchorToken:Ie,restoreToTopAnchorPath:y0,multiSelectMode:yl&&E,onSelectionChange:St,onOpenViewer:N=>{Nu(N),Mu(N),St([N])},highlight:Wt?Bi:"",recentlyUpdated:Xe,onVisiblePathsChange:tr,onTopAnchorPathChange:g0,suppressSelectionHighlight:Eu,viewMode:m,targetCellSize:g,onContextMenuItem:(N,$)=>{N.preventDefault(),Rh($,{x:N.clientX,y:N.clientY})},onOpenItemActions:Rh,scrollRef:we,hideScrollbar:pl,isLoading:M0}),pl&&zs&&a.jsx(WC,{items:me,metricKey:zs,scrollRef:we,sortDir:x.sort.dir})]})]}),j&&a.jsx(LE,{path:vt[0]??null,selectedPaths:vt,items:me,compareActive:Qt,compareA:er,compareB:al,onOpenCompare:Os,sortSpec:x.sort,onResize:tn,onStarChanged:(N,$)=>{H(re=>{const de={...re};for(const Le of N)de[Le]=$;return de})},onFindSimilar:()=>i(!0),embeddingsAvailable:ye,embeddingsLoading:be,compareExportSupportsV2:ve.supportsV2,compareExportMaxPathsV2:ve.maxPathsV2,onLocalTypingChange:Ce}),a.jsx(_E,{open:s,embeddings:X,rejected:ae,selectedPath:vt[0]??null,embeddingsLoading:be,embeddingsError:Ee,onClose:()=>i(!1),onSearch:P0}),Ct&&a.jsx(sk,{path:Ct,onClose:ul,onZoomChange:N=>p(Math.round(N)),requestedZoomPercent:c,onZoomRequestConsumed:()=>d(null),canPrev:Wi,canNext:ss,onNavigate:br}),Qt&&a.jsx(dk,{aItem:er,bItem:al,index:Vn,total:ll.length,canPrev:Su,canNext:Cu,onNavigate:cl,onClose:Hi}),Mh&&a.jsx(iM,{paths:Mh.paths,defaultDestination:e,destinations:O0,loadingDestinations:D0,onClose:$0,onSubmit:W0}),F0&&a.jsx("div",{className:"toolbar-offset fixed inset-0 left-[var(--left)] right-[var(--right)] bg-accent/10 border-2 border-dashed border-accent text-text flex items-center justify-center text-lg z-overlay pointer-events-none",children:"Drop images to upload"}),jh&&a.jsx(hM,{ctx:jh,current:e,items:me,setCtx:z0,refreshEnabled:Bs,onRefetch:dn,onOpenMoveDialog:V0,onRefreshFolder:Du})]})}const Sj=new Qb({defaultOptions:{queries:{staleTime:1e4,gcTime:5*6e4,retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),1e4),refetchOnWindowFocus:!1,refetchOnReconnect:"always"},mutations:{retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),5e3)}}});function Cj(){return a.jsx(Kb,{client:Sj,children:a.jsx(bj,{})})}Gv(document.getElementById("root")).render(a.jsx(Cj,{}));
