var W0=Object.defineProperty;var Ah=e=>{throw TypeError(e)};var H0=(e,t,n)=>t in e?W0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var lt=(e,t,n)=>H0(e,typeof t!="symbol"?t+"":t,n),Wu=(e,t,n)=>t.has(e)||Ah("Cannot "+n);var k=(e,t,n)=>(Wu(e,t,"read from private field"),n?n.call(e):t.get(e)),ue=(e,t,n)=>t.has(e)?Ah("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),J=(e,t,n,r)=>(Wu(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),ye=(e,t,n)=>(Wu(e,t,"access private method"),n);var ml=(e,t,n,r)=>({set _(s){J(e,t,s,n)},get _(){return k(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function Q0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Fg={exports:{}},Ya={},Og={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xo=Symbol.for("react.element"),K0=Symbol.for("react.portal"),q0=Symbol.for("react.fragment"),G0=Symbol.for("react.strict_mode"),Y0=Symbol.for("react.profiler"),X0=Symbol.for("react.provider"),J0=Symbol.for("react.context"),Z0=Symbol.for("react.forward_ref"),ew=Symbol.for("react.suspense"),tw=Symbol.for("react.memo"),nw=Symbol.for("react.lazy"),Fh=Symbol.iterator;function rw(e){return e===null||typeof e!="object"?null:(e=Fh&&e[Fh]||e["@@iterator"],typeof e=="function"?e:null)}var Dg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zg=Object.assign,$g={};function Ai(e,t,n){this.props=e,this.context=t,this.refs=$g,this.updater=n||Dg}Ai.prototype.isReactComponent={};Ai.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ai.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Bg(){}Bg.prototype=Ai.prototype;function af(e,t,n){this.props=e,this.context=t,this.refs=$g,this.updater=n||Dg}var uf=af.prototype=new Bg;uf.constructor=af;zg(uf,Ai.prototype);uf.isPureReactComponent=!0;var Oh=Array.isArray,Ug=Object.prototype.hasOwnProperty,cf={current:null},Vg={key:!0,ref:!0,__self:!0,__source:!0};function Wg(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Ug.call(t,r)&&!Vg.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Xo,type:e,key:i,ref:o,props:s,_owner:cf.current}}function sw(e,t){return{$$typeof:Xo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function df(e){return typeof e=="object"&&e!==null&&e.$$typeof===Xo}function iw(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Dh=/\/+/g;function Hu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?iw(""+e.key):t.toString(36)}function Kl(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Xo:case K0:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+Hu(o,0):r,Oh(s)?(n="",e!=null&&(n=e.replace(Dh,"$&/")+"/"),Kl(s,t,n,"",function(d){return d})):s!=null&&(df(s)&&(s=sw(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Dh,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",Oh(e))for(var l=0;l<e.length;l++){i=e[l];var c=r+Hu(i,l);o+=Kl(i,t,n,c,s)}else if(c=rw(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=r+Hu(i,l++),o+=Kl(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function gl(e,t,n){if(e==null)return e;var r=[],s=0;return Kl(e,r,"","",function(i){return t.call(n,i,s++)}),r}function ow(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Dt={current:null},ql={transition:null},lw={ReactCurrentDispatcher:Dt,ReactCurrentBatchConfig:ql,ReactCurrentOwner:cf};function Hg(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:gl,forEach:function(e,t,n){gl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return gl(e,function(){t++}),t},toArray:function(e){return gl(e,function(t){return t})||[]},only:function(e){if(!df(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ke.Component=Ai;ke.Fragment=q0;ke.Profiler=Y0;ke.PureComponent=af;ke.StrictMode=G0;ke.Suspense=ew;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lw;ke.act=Hg;ke.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=zg({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=cf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Ug.call(t,c)&&!Vg.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Xo,type:e.type,key:s,ref:i,props:r,_owner:o}};ke.createContext=function(e){return e={$$typeof:J0,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:X0,_context:e},e.Consumer=e};ke.createElement=Wg;ke.createFactory=function(e){var t=Wg.bind(null,e);return t.type=e,t};ke.createRef=function(){return{current:null}};ke.forwardRef=function(e){return{$$typeof:Z0,render:e}};ke.isValidElement=df;ke.lazy=function(e){return{$$typeof:nw,_payload:{_status:-1,_result:e},_init:ow}};ke.memo=function(e,t){return{$$typeof:tw,type:e,compare:t===void 0?null:t}};ke.startTransition=function(e){var t=ql.transition;ql.transition={};try{e()}finally{ql.transition=t}};ke.unstable_act=Hg;ke.useCallback=function(e,t){return Dt.current.useCallback(e,t)};ke.useContext=function(e){return Dt.current.useContext(e)};ke.useDebugValue=function(){};ke.useDeferredValue=function(e){return Dt.current.useDeferredValue(e)};ke.useEffect=function(e,t){return Dt.current.useEffect(e,t)};ke.useId=function(){return Dt.current.useId()};ke.useImperativeHandle=function(e,t,n){return Dt.current.useImperativeHandle(e,t,n)};ke.useInsertionEffect=function(e,t){return Dt.current.useInsertionEffect(e,t)};ke.useLayoutEffect=function(e,t){return Dt.current.useLayoutEffect(e,t)};ke.useMemo=function(e,t){return Dt.current.useMemo(e,t)};ke.useReducer=function(e,t,n){return Dt.current.useReducer(e,t,n)};ke.useRef=function(e){return Dt.current.useRef(e)};ke.useState=function(e){return Dt.current.useState(e)};ke.useSyncExternalStore=function(e,t,n){return Dt.current.useSyncExternalStore(e,t,n)};ke.useTransition=function(){return Dt.current.useTransition()};ke.version="18.3.1";Og.exports=ke;var u=Og.exports;const Zr=Q0(u);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aw=u,uw=Symbol.for("react.element"),cw=Symbol.for("react.fragment"),dw=Object.prototype.hasOwnProperty,fw=aw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hw={key:!0,ref:!0,__self:!0,__source:!0};function Qg(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)dw.call(t,r)&&!hw.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:uw,type:e,key:i,ref:o,props:s,_owner:fw.current}}Ya.Fragment=cw;Ya.jsx=Qg;Ya.jsxs=Qg;Fg.exports=Ya;var a=Fg.exports,Kg={exports:{}},un={},qg={exports:{}},Gg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(T,A){var O=T.length;T.push(A);e:for(;0<O;){var H=O-1>>>1,U=T[H];if(0<s(U,A))T[H]=A,T[O]=U,O=H;else break e}}function n(T){return T.length===0?null:T[0]}function r(T){if(T.length===0)return null;var A=T[0],O=T.pop();if(O!==A){T[0]=O;e:for(var H=0,U=T.length,_=U>>>1;H<_;){var Q=2*(H+1)-1,V=T[Q],ee=Q+1,ie=T[ee];if(0>s(V,O))ee<U&&0>s(ie,V)?(T[H]=ie,T[ee]=O,H=ee):(T[H]=V,T[Q]=O,H=Q);else if(ee<U&&0>s(ie,O))T[H]=ie,T[ee]=O,H=ee;else break e}}return A}function s(T,A){var O=T.sortIndex-A.sortIndex;return O!==0?O:T.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],f=1,p=null,h=3,w=!1,x=!1,b=!1,C=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(T){for(var A=n(d);A!==null;){if(A.callback===null)r(d);else if(A.startTime<=T)r(d),A.sortIndex=A.expirationTime,t(c,A);else break;A=n(d)}}function m(T){if(b=!1,y(T),!x)if(n(c)!==null)x=!0,L(S);else{var A=n(d);A!==null&&R(m,A.startTime-T)}}function S(T,A){x=!1,b&&(b=!1,v(M),M=-1),w=!0;var O=h;try{for(y(A),p=n(c);p!==null&&(!(p.expirationTime>A)||T&&!B());){var H=p.callback;if(typeof H=="function"){p.callback=null,h=p.priorityLevel;var U=H(p.expirationTime<=A);A=e.unstable_now(),typeof U=="function"?p.callback=U:p===n(c)&&r(c),y(A)}else r(c);p=n(c)}if(p!==null)var _=!0;else{var Q=n(d);Q!==null&&R(m,Q.startTime-A),_=!1}return _}finally{p=null,h=O,w=!1}}var E=!1,j=null,M=-1,I=5,P=-1;function B(){return!(e.unstable_now()-P<I)}function F(){if(j!==null){var T=e.unstable_now();P=T;var A=!0;try{A=j(!0,T)}finally{A?K():(E=!1,j=null)}}else E=!1}var K;if(typeof g=="function")K=function(){g(F)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,z=Z.port2;Z.port1.onmessage=F,K=function(){z.postMessage(null)}}else K=function(){C(F,0)};function L(T){j=T,E||(E=!0,K())}function R(T,A){M=C(function(){T(e.unstable_now())},A)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(T){T.callback=null},e.unstable_continueExecution=function(){x||w||(x=!0,L(S))},e.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<T?Math.floor(1e3/T):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(T){switch(h){case 1:case 2:case 3:var A=3;break;default:A=h}var O=h;h=A;try{return T()}finally{h=O}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(T,A){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var O=h;h=T;try{return A()}finally{h=O}},e.unstable_scheduleCallback=function(T,A,O){var H=e.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?H+O:H):O=H,T){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=O+U,T={id:f++,callback:A,priorityLevel:T,startTime:O,expirationTime:U,sortIndex:-1},O>H?(T.sortIndex=O,t(d,T),n(c)===null&&T===n(d)&&(b?(v(M),M=-1):b=!0,R(m,O-H))):(T.sortIndex=U,t(c,T),x||w||(x=!0,L(S))),T},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(T){var A=h;return function(){var O=h;h=A;try{return T.apply(this,arguments)}finally{h=O}}}})(Gg);qg.exports=Gg;var pw=qg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mw=u,an=pw;function W(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Yg=new Set,Eo={};function As(e,t){ji(e,t),ji(e+"Capture",t)}function ji(e,t){for(Eo[e]=t,e=0;e<t.length;e++)Yg.add(t[e])}var mr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lc=Object.prototype.hasOwnProperty,gw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zh={},$h={};function vw(e){return Lc.call($h,e)?!0:Lc.call(zh,e)?!1:gw.test(e)?$h[e]=!0:(zh[e]=!0,!1)}function yw(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function xw(e,t,n,r){if(t===null||typeof t>"u"||yw(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function zt(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){wt[e]=new zt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];wt[t]=new zt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){wt[e]=new zt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){wt[e]=new zt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){wt[e]=new zt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){wt[e]=new zt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){wt[e]=new zt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){wt[e]=new zt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){wt[e]=new zt(e,5,!1,e.toLowerCase(),null,!1,!1)});var ff=/[\-:]([a-z])/g;function hf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ff,hf);wt[t]=new zt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ff,hf);wt[t]=new zt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ff,hf);wt[t]=new zt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){wt[e]=new zt(e,1,!1,e.toLowerCase(),null,!1,!1)});wt.xlinkHref=new zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){wt[e]=new zt(e,1,!1,e.toLowerCase(),null,!0,!0)});function pf(e,t,n,r){var s=wt.hasOwnProperty(t)?wt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(xw(t,n,s,r)&&(n=null),r||s===null?vw(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var xr=mw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,vl=Symbol.for("react.element"),qs=Symbol.for("react.portal"),Gs=Symbol.for("react.fragment"),mf=Symbol.for("react.strict_mode"),_c=Symbol.for("react.profiler"),Xg=Symbol.for("react.provider"),Jg=Symbol.for("react.context"),gf=Symbol.for("react.forward_ref"),Ac=Symbol.for("react.suspense"),Fc=Symbol.for("react.suspense_list"),vf=Symbol.for("react.memo"),jr=Symbol.for("react.lazy"),Zg=Symbol.for("react.offscreen"),Bh=Symbol.iterator;function Qi(e){return e===null||typeof e!="object"?null:(e=Bh&&e[Bh]||e["@@iterator"],typeof e=="function"?e:null)}var Qe=Object.assign,Qu;function oo(e){if(Qu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Qu=t&&t[1]||""}return`
`+Qu+e}var Ku=!1;function qu(e,t){if(!e||Ku)return"";Ku=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Ku=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?oo(e):""}function ww(e){switch(e.tag){case 5:return oo(e.type);case 16:return oo("Lazy");case 13:return oo("Suspense");case 19:return oo("SuspenseList");case 0:case 2:case 15:return e=qu(e.type,!1),e;case 11:return e=qu(e.type.render,!1),e;case 1:return e=qu(e.type,!0),e;default:return""}}function Oc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Gs:return"Fragment";case qs:return"Portal";case _c:return"Profiler";case mf:return"StrictMode";case Ac:return"Suspense";case Fc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Jg:return(e.displayName||"Context")+".Consumer";case Xg:return(e._context.displayName||"Context")+".Provider";case gf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case vf:return t=e.displayName||null,t!==null?t:Oc(e.type)||"Memo";case jr:t=e._payload,e=e._init;try{return Oc(e(t))}catch{}}return null}function bw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Oc(t);case 8:return t===mf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function es(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ev(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Sw(e){var t=ev(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function yl(e){e._valueTracker||(e._valueTracker=Sw(e))}function tv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ev(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ha(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Dc(e,t){var n=t.checked;return Qe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Uh(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=es(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function nv(e,t){t=t.checked,t!=null&&pf(e,"checked",t,!1)}function zc(e,t){nv(e,t);var n=es(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?$c(e,t.type,n):t.hasOwnProperty("defaultValue")&&$c(e,t.type,es(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Vh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function $c(e,t,n){(t!=="number"||ha(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var lo=Array.isArray;function oi(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+es(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Bc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(W(91));return Qe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Wh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(W(92));if(lo(n)){if(1<n.length)throw Error(W(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:es(n)}}function rv(e,t){var n=es(t.value),r=es(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Hh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function sv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Uc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?sv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var xl,iv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(xl=xl||document.createElement("div"),xl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=xl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function No(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ho={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Cw=["Webkit","ms","Moz","O"];Object.keys(ho).forEach(function(e){Cw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ho[t]=ho[e]})});function ov(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ho.hasOwnProperty(e)&&ho[e]?(""+t).trim():t+"px"}function lv(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ov(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var kw=Qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vc(e,t){if(t){if(kw[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(W(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(W(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(W(61))}if(t.style!=null&&typeof t.style!="object")throw Error(W(62))}}function Wc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Hc=null;function yf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Qc=null,li=null,ai=null;function Qh(e){if(e=el(e)){if(typeof Qc!="function")throw Error(W(280));var t=e.stateNode;t&&(t=tu(t),Qc(e.stateNode,e.type,t))}}function av(e){li?ai?ai.push(e):ai=[e]:li=e}function uv(){if(li){var e=li,t=ai;if(ai=li=null,Qh(e),t)for(e=0;e<t.length;e++)Qh(t[e])}}function cv(e,t){return e(t)}function dv(){}var Gu=!1;function fv(e,t,n){if(Gu)return e(t,n);Gu=!0;try{return cv(e,t,n)}finally{Gu=!1,(li!==null||ai!==null)&&(dv(),uv())}}function jo(e,t){var n=e.stateNode;if(n===null)return null;var r=tu(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(W(231,t,typeof n));return n}var Kc=!1;if(mr)try{var Ki={};Object.defineProperty(Ki,"passive",{get:function(){Kc=!0}}),window.addEventListener("test",Ki,Ki),window.removeEventListener("test",Ki,Ki)}catch{Kc=!1}function Ew(e,t,n,r,s,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(f){this.onError(f)}}var po=!1,pa=null,ma=!1,qc=null,Nw={onError:function(e){po=!0,pa=e}};function jw(e,t,n,r,s,i,o,l,c){po=!1,pa=null,Ew.apply(Nw,arguments)}function Mw(e,t,n,r,s,i,o,l,c){if(jw.apply(this,arguments),po){if(po){var d=pa;po=!1,pa=null}else throw Error(W(198));ma||(ma=!0,qc=d)}}function Fs(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function hv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Kh(e){if(Fs(e)!==e)throw Error(W(188))}function Rw(e){var t=e.alternate;if(!t){if(t=Fs(e),t===null)throw Error(W(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Kh(s),e;if(i===r)return Kh(s),t;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?e:t}function pv(e){return e=Rw(e),e!==null?mv(e):null}function mv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=mv(e);if(t!==null)return t;e=e.sibling}return null}var gv=an.unstable_scheduleCallback,qh=an.unstable_cancelCallback,Pw=an.unstable_shouldYield,Tw=an.unstable_requestPaint,tt=an.unstable_now,Iw=an.unstable_getCurrentPriorityLevel,xf=an.unstable_ImmediatePriority,vv=an.unstable_UserBlockingPriority,ga=an.unstable_NormalPriority,Lw=an.unstable_LowPriority,yv=an.unstable_IdlePriority,Xa=null,Yn=null;function _w(e){if(Yn&&typeof Yn.onCommitFiberRoot=="function")try{Yn.onCommitFiberRoot(Xa,e,void 0,(e.current.flags&128)===128)}catch{}}var _n=Math.clz32?Math.clz32:Ow,Aw=Math.log,Fw=Math.LN2;function Ow(e){return e>>>=0,e===0?32:31-(Aw(e)/Fw|0)|0}var wl=64,bl=4194304;function ao(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function va(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=ao(l):(i&=o,i!==0&&(r=ao(i)))}else o=n&~s,o!==0?r=ao(o):i!==0&&(r=ao(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-_n(t),s=1<<n,r|=e[n],t&=~s;return r}function Dw(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zw(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-_n(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=Dw(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Gc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function xv(){var e=wl;return wl<<=1,!(wl&4194240)&&(wl=64),e}function Yu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Jo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-_n(t),e[t]=n}function $w(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-_n(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function wf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-_n(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Ae=0;function wv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var bv,bf,Sv,Cv,kv,Yc=!1,Sl=[],Ur=null,Vr=null,Wr=null,Mo=new Map,Ro=new Map,Rr=[],Bw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gh(e,t){switch(e){case"focusin":case"focusout":Ur=null;break;case"dragenter":case"dragleave":Vr=null;break;case"mouseover":case"mouseout":Wr=null;break;case"pointerover":case"pointerout":Mo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ro.delete(t.pointerId)}}function qi(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=el(t),t!==null&&bf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Uw(e,t,n,r,s){switch(t){case"focusin":return Ur=qi(Ur,e,t,n,r,s),!0;case"dragenter":return Vr=qi(Vr,e,t,n,r,s),!0;case"mouseover":return Wr=qi(Wr,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return Mo.set(i,qi(Mo.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ro.set(i,qi(Ro.get(i)||null,e,t,n,r,s)),!0}return!1}function Ev(e){var t=us(e.target);if(t!==null){var n=Fs(t);if(n!==null){if(t=n.tag,t===13){if(t=hv(n),t!==null){e.blockedOn=t,kv(e.priority,function(){Sv(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Gl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Hc=r,n.target.dispatchEvent(r),Hc=null}else return t=el(n),t!==null&&bf(t),e.blockedOn=n,!1;t.shift()}return!0}function Yh(e,t,n){Gl(e)&&n.delete(t)}function Vw(){Yc=!1,Ur!==null&&Gl(Ur)&&(Ur=null),Vr!==null&&Gl(Vr)&&(Vr=null),Wr!==null&&Gl(Wr)&&(Wr=null),Mo.forEach(Yh),Ro.forEach(Yh)}function Gi(e,t){e.blockedOn===t&&(e.blockedOn=null,Yc||(Yc=!0,an.unstable_scheduleCallback(an.unstable_NormalPriority,Vw)))}function Po(e){function t(s){return Gi(s,e)}if(0<Sl.length){Gi(Sl[0],e);for(var n=1;n<Sl.length;n++){var r=Sl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Ur!==null&&Gi(Ur,e),Vr!==null&&Gi(Vr,e),Wr!==null&&Gi(Wr,e),Mo.forEach(t),Ro.forEach(t),n=0;n<Rr.length;n++)r=Rr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Rr.length&&(n=Rr[0],n.blockedOn===null);)Ev(n),n.blockedOn===null&&Rr.shift()}var ui=xr.ReactCurrentBatchConfig,ya=!0;function Ww(e,t,n,r){var s=Ae,i=ui.transition;ui.transition=null;try{Ae=1,Sf(e,t,n,r)}finally{Ae=s,ui.transition=i}}function Hw(e,t,n,r){var s=Ae,i=ui.transition;ui.transition=null;try{Ae=4,Sf(e,t,n,r)}finally{Ae=s,ui.transition=i}}function Sf(e,t,n,r){if(ya){var s=Xc(e,t,n,r);if(s===null)oc(e,t,r,xa,n),Gh(e,r);else if(Uw(s,e,t,n,r))r.stopPropagation();else if(Gh(e,r),t&4&&-1<Bw.indexOf(e)){for(;s!==null;){var i=el(s);if(i!==null&&bv(i),i=Xc(e,t,n,r),i===null&&oc(e,t,r,xa,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else oc(e,t,r,null,n)}}var xa=null;function Xc(e,t,n,r){if(xa=null,e=yf(r),e=us(e),e!==null)if(t=Fs(e),t===null)e=null;else if(n=t.tag,n===13){if(e=hv(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return xa=e,null}function Nv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Iw()){case xf:return 1;case vv:return 4;case ga:case Lw:return 16;case yv:return 536870912;default:return 16}default:return 16}}var $r=null,Cf=null,Yl=null;function jv(){if(Yl)return Yl;var e,t=Cf,n=t.length,r,s="value"in $r?$r.value:$r.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return Yl=s.slice(e,1<r?1-r:void 0)}function Xl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Cl(){return!0}function Xh(){return!1}function cn(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Cl:Xh,this.isPropagationStopped=Xh,this}return Qe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Cl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Cl)},persist:function(){},isPersistent:Cl}),t}var Fi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kf=cn(Fi),Zo=Qe({},Fi,{view:0,detail:0}),Qw=cn(Zo),Xu,Ju,Yi,Ja=Qe({},Zo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ef,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Yi&&(Yi&&e.type==="mousemove"?(Xu=e.screenX-Yi.screenX,Ju=e.screenY-Yi.screenY):Ju=Xu=0,Yi=e),Xu)},movementY:function(e){return"movementY"in e?e.movementY:Ju}}),Jh=cn(Ja),Kw=Qe({},Ja,{dataTransfer:0}),qw=cn(Kw),Gw=Qe({},Zo,{relatedTarget:0}),Zu=cn(Gw),Yw=Qe({},Fi,{animationName:0,elapsedTime:0,pseudoElement:0}),Xw=cn(Yw),Jw=Qe({},Fi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Zw=cn(Jw),e1=Qe({},Fi,{data:0}),Zh=cn(e1),t1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},n1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},r1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function s1(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=r1[e])?!!t[e]:!1}function Ef(){return s1}var i1=Qe({},Zo,{key:function(e){if(e.key){var t=t1[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Xl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?n1[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ef,charCode:function(e){return e.type==="keypress"?Xl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Xl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),o1=cn(i1),l1=Qe({},Ja,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ep=cn(l1),a1=Qe({},Zo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ef}),u1=cn(a1),c1=Qe({},Fi,{propertyName:0,elapsedTime:0,pseudoElement:0}),d1=cn(c1),f1=Qe({},Ja,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),h1=cn(f1),p1=[9,13,27,32],Nf=mr&&"CompositionEvent"in window,mo=null;mr&&"documentMode"in document&&(mo=document.documentMode);var m1=mr&&"TextEvent"in window&&!mo,Mv=mr&&(!Nf||mo&&8<mo&&11>=mo),tp=" ",np=!1;function Rv(e,t){switch(e){case"keyup":return p1.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ys=!1;function g1(e,t){switch(e){case"compositionend":return Pv(t);case"keypress":return t.which!==32?null:(np=!0,tp);case"textInput":return e=t.data,e===tp&&np?null:e;default:return null}}function v1(e,t){if(Ys)return e==="compositionend"||!Nf&&Rv(e,t)?(e=jv(),Yl=Cf=$r=null,Ys=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mv&&t.locale!=="ko"?null:t.data;default:return null}}var y1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!y1[e.type]:t==="textarea"}function Tv(e,t,n,r){av(r),t=wa(t,"onChange"),0<t.length&&(n=new kf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var go=null,To=null;function x1(e){Uv(e,0)}function Za(e){var t=Zs(e);if(tv(t))return e}function w1(e,t){if(e==="change")return t}var Iv=!1;if(mr){var ec;if(mr){var tc="oninput"in document;if(!tc){var sp=document.createElement("div");sp.setAttribute("oninput","return;"),tc=typeof sp.oninput=="function"}ec=tc}else ec=!1;Iv=ec&&(!document.documentMode||9<document.documentMode)}function ip(){go&&(go.detachEvent("onpropertychange",Lv),To=go=null)}function Lv(e){if(e.propertyName==="value"&&Za(To)){var t=[];Tv(t,To,e,yf(e)),fv(x1,t)}}function b1(e,t,n){e==="focusin"?(ip(),go=t,To=n,go.attachEvent("onpropertychange",Lv)):e==="focusout"&&ip()}function S1(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Za(To)}function C1(e,t){if(e==="click")return Za(t)}function k1(e,t){if(e==="input"||e==="change")return Za(t)}function E1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var On=typeof Object.is=="function"?Object.is:E1;function Io(e,t){if(On(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Lc.call(t,s)||!On(e[s],t[s]))return!1}return!0}function op(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lp(e,t){var n=op(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=op(n)}}function _v(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?_v(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Av(){for(var e=window,t=ha();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ha(e.document)}return t}function jf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function N1(e){var t=Av(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&_v(n.ownerDocument.documentElement,n)){if(r!==null&&jf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=lp(n,i);var o=lp(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var j1=mr&&"documentMode"in document&&11>=document.documentMode,Xs=null,Jc=null,vo=null,Zc=!1;function ap(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Zc||Xs==null||Xs!==ha(r)||(r=Xs,"selectionStart"in r&&jf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),vo&&Io(vo,r)||(vo=r,r=wa(Jc,"onSelect"),0<r.length&&(t=new kf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Xs)))}function kl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Js={animationend:kl("Animation","AnimationEnd"),animationiteration:kl("Animation","AnimationIteration"),animationstart:kl("Animation","AnimationStart"),transitionend:kl("Transition","TransitionEnd")},nc={},Fv={};mr&&(Fv=document.createElement("div").style,"AnimationEvent"in window||(delete Js.animationend.animation,delete Js.animationiteration.animation,delete Js.animationstart.animation),"TransitionEvent"in window||delete Js.transitionend.transition);function eu(e){if(nc[e])return nc[e];if(!Js[e])return e;var t=Js[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Fv)return nc[e]=t[n];return e}var Ov=eu("animationend"),Dv=eu("animationiteration"),zv=eu("animationstart"),$v=eu("transitionend"),Bv=new Map,up="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ns(e,t){Bv.set(e,t),As(t,[e])}for(var rc=0;rc<up.length;rc++){var sc=up[rc],M1=sc.toLowerCase(),R1=sc[0].toUpperCase()+sc.slice(1);ns(M1,"on"+R1)}ns(Ov,"onAnimationEnd");ns(Dv,"onAnimationIteration");ns(zv,"onAnimationStart");ns("dblclick","onDoubleClick");ns("focusin","onFocus");ns("focusout","onBlur");ns($v,"onTransitionEnd");ji("onMouseEnter",["mouseout","mouseover"]);ji("onMouseLeave",["mouseout","mouseover"]);ji("onPointerEnter",["pointerout","pointerover"]);ji("onPointerLeave",["pointerout","pointerover"]);As("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));As("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));As("onBeforeInput",["compositionend","keypress","textInput","paste"]);As("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));As("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));As("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),P1=new Set("cancel close invalid load scroll toggle".split(" ").concat(uo));function cp(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Mw(r,t,void 0,e),e.currentTarget=null}function Uv(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;cp(s,l,d),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;cp(s,l,d),i=c}}}if(ma)throw e=qc,ma=!1,qc=null,e}function ze(e,t){var n=t[sd];n===void 0&&(n=t[sd]=new Set);var r=e+"__bubble";n.has(r)||(Vv(t,e,2,!1),n.add(r))}function ic(e,t,n){var r=0;t&&(r|=4),Vv(n,e,r,t)}var El="_reactListening"+Math.random().toString(36).slice(2);function Lo(e){if(!e[El]){e[El]=!0,Yg.forEach(function(n){n!=="selectionchange"&&(P1.has(n)||ic(n,!1,e),ic(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[El]||(t[El]=!0,ic("selectionchange",!1,t))}}function Vv(e,t,n,r){switch(Nv(t)){case 1:var s=Ww;break;case 4:s=Hw;break;default:s=Sf}n=s.bind(null,t,n,e),s=void 0,!Kc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function oc(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=us(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}fv(function(){var d=i,f=yf(n),p=[];e:{var h=Bv.get(e);if(h!==void 0){var w=kf,x=e;switch(e){case"keypress":if(Xl(n)===0)break e;case"keydown":case"keyup":w=o1;break;case"focusin":x="focus",w=Zu;break;case"focusout":x="blur",w=Zu;break;case"beforeblur":case"afterblur":w=Zu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Jh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=qw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=u1;break;case Ov:case Dv:case zv:w=Xw;break;case $v:w=d1;break;case"scroll":w=Qw;break;case"wheel":w=h1;break;case"copy":case"cut":case"paste":w=Zw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=ep}var b=(t&4)!==0,C=!b&&e==="scroll",v=b?h!==null?h+"Capture":null:h;b=[];for(var g=d,y;g!==null;){y=g;var m=y.stateNode;if(y.tag===5&&m!==null&&(y=m,v!==null&&(m=jo(g,v),m!=null&&b.push(_o(g,m,y)))),C)break;g=g.return}0<b.length&&(h=new w(h,x,null,n,f),p.push({event:h,listeners:b}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",h&&n!==Hc&&(x=n.relatedTarget||n.fromElement)&&(us(x)||x[gr]))break e;if((w||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,w?(x=n.relatedTarget||n.toElement,w=d,x=x?us(x):null,x!==null&&(C=Fs(x),x!==C||x.tag!==5&&x.tag!==6)&&(x=null)):(w=null,x=d),w!==x)){if(b=Jh,m="onMouseLeave",v="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(b=ep,m="onPointerLeave",v="onPointerEnter",g="pointer"),C=w==null?h:Zs(w),y=x==null?h:Zs(x),h=new b(m,g+"leave",w,n,f),h.target=C,h.relatedTarget=y,m=null,us(f)===d&&(b=new b(v,g+"enter",x,n,f),b.target=y,b.relatedTarget=C,m=b),C=m,w&&x)t:{for(b=w,v=x,g=0,y=b;y;y=Vs(y))g++;for(y=0,m=v;m;m=Vs(m))y++;for(;0<g-y;)b=Vs(b),g--;for(;0<y-g;)v=Vs(v),y--;for(;g--;){if(b===v||v!==null&&b===v.alternate)break t;b=Vs(b),v=Vs(v)}b=null}else b=null;w!==null&&dp(p,h,w,b,!1),x!==null&&C!==null&&dp(p,C,x,b,!0)}}e:{if(h=d?Zs(d):window,w=h.nodeName&&h.nodeName.toLowerCase(),w==="select"||w==="input"&&h.type==="file")var S=w1;else if(rp(h))if(Iv)S=k1;else{S=S1;var E=b1}else(w=h.nodeName)&&w.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=C1);if(S&&(S=S(e,d))){Tv(p,S,n,f);break e}E&&E(e,h,d),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&$c(h,"number",h.value)}switch(E=d?Zs(d):window,e){case"focusin":(rp(E)||E.contentEditable==="true")&&(Xs=E,Jc=d,vo=null);break;case"focusout":vo=Jc=Xs=null;break;case"mousedown":Zc=!0;break;case"contextmenu":case"mouseup":case"dragend":Zc=!1,ap(p,n,f);break;case"selectionchange":if(j1)break;case"keydown":case"keyup":ap(p,n,f)}var j;if(Nf)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Ys?Rv(e,n)&&(M="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(Mv&&n.locale!=="ko"&&(Ys||M!=="onCompositionStart"?M==="onCompositionEnd"&&Ys&&(j=jv()):($r=f,Cf="value"in $r?$r.value:$r.textContent,Ys=!0)),E=wa(d,M),0<E.length&&(M=new Zh(M,e,null,n,f),p.push({event:M,listeners:E}),j?M.data=j:(j=Pv(n),j!==null&&(M.data=j)))),(j=m1?g1(e,n):v1(e,n))&&(d=wa(d,"onBeforeInput"),0<d.length&&(f=new Zh("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=j))}Uv(p,t)})}function _o(e,t,n){return{instance:e,listener:t,currentTarget:n}}function wa(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=jo(e,n),i!=null&&r.unshift(_o(e,i,s)),i=jo(e,t),i!=null&&r.push(_o(e,i,s))),e=e.return}return r}function Vs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function dp(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,s?(c=jo(n,i),c!=null&&o.unshift(_o(n,c,l))):s||(c=jo(n,i),c!=null&&o.push(_o(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var T1=/\r\n?/g,I1=/\u0000|\uFFFD/g;function fp(e){return(typeof e=="string"?e:""+e).replace(T1,`
`).replace(I1,"")}function Nl(e,t,n){if(t=fp(t),fp(e)!==t&&n)throw Error(W(425))}function ba(){}var ed=null,td=null;function nd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var rd=typeof setTimeout=="function"?setTimeout:void 0,L1=typeof clearTimeout=="function"?clearTimeout:void 0,hp=typeof Promise=="function"?Promise:void 0,_1=typeof queueMicrotask=="function"?queueMicrotask:typeof hp<"u"?function(e){return hp.resolve(null).then(e).catch(A1)}:rd;function A1(e){setTimeout(function(){throw e})}function lc(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Po(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Po(t)}function Hr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function pp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Oi=Math.random().toString(36).slice(2),Gn="__reactFiber$"+Oi,Ao="__reactProps$"+Oi,gr="__reactContainer$"+Oi,sd="__reactEvents$"+Oi,F1="__reactListeners$"+Oi,O1="__reactHandles$"+Oi;function us(e){var t=e[Gn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[gr]||n[Gn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=pp(e);e!==null;){if(n=e[Gn])return n;e=pp(e)}return t}e=n,n=e.parentNode}return null}function el(e){return e=e[Gn]||e[gr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Zs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(W(33))}function tu(e){return e[Ao]||null}var id=[],ei=-1;function rs(e){return{current:e}}function $e(e){0>ei||(e.current=id[ei],id[ei]=null,ei--)}function De(e,t){ei++,id[ei]=e.current,e.current=t}var ts={},Pt=rs(ts),Xt=rs(!1),Ms=ts;function Mi(e,t){var n=e.type.contextTypes;if(!n)return ts;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Jt(e){return e=e.childContextTypes,e!=null}function Sa(){$e(Xt),$e(Pt)}function mp(e,t,n){if(Pt.current!==ts)throw Error(W(168));De(Pt,t),De(Xt,n)}function Wv(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(W(108,bw(e)||"Unknown",s));return Qe({},n,r)}function Ca(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ts,Ms=Pt.current,De(Pt,e),De(Xt,Xt.current),!0}function gp(e,t,n){var r=e.stateNode;if(!r)throw Error(W(169));n?(e=Wv(e,t,Ms),r.__reactInternalMemoizedMergedChildContext=e,$e(Xt),$e(Pt),De(Pt,e)):$e(Xt),De(Xt,n)}var ir=null,nu=!1,ac=!1;function Hv(e){ir===null?ir=[e]:ir.push(e)}function D1(e){nu=!0,Hv(e)}function ss(){if(!ac&&ir!==null){ac=!0;var e=0,t=Ae;try{var n=ir;for(Ae=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}ir=null,nu=!1}catch(s){throw ir!==null&&(ir=ir.slice(e+1)),gv(xf,ss),s}finally{Ae=t,ac=!1}}return null}var ti=[],ni=0,ka=null,Ea=0,vn=[],yn=0,Rs=null,cr=1,dr="";function os(e,t){ti[ni++]=Ea,ti[ni++]=ka,ka=e,Ea=t}function Qv(e,t,n){vn[yn++]=cr,vn[yn++]=dr,vn[yn++]=Rs,Rs=e;var r=cr;e=dr;var s=32-_n(r)-1;r&=~(1<<s),n+=1;var i=32-_n(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,cr=1<<32-_n(t)+s|n<<s|r,dr=i+e}else cr=1<<i|n<<s|r,dr=e}function Mf(e){e.return!==null&&(os(e,1),Qv(e,1,0))}function Rf(e){for(;e===ka;)ka=ti[--ni],ti[ni]=null,Ea=ti[--ni],ti[ni]=null;for(;e===Rs;)Rs=vn[--yn],vn[yn]=null,dr=vn[--yn],vn[yn]=null,cr=vn[--yn],vn[yn]=null}var on=null,sn=null,Be=!1,Ln=null;function Kv(e,t){var n=wn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function vp(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,on=e,sn=Hr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,on=e,sn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Rs!==null?{id:cr,overflow:dr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=wn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,on=e,sn=null,!0):!1;default:return!1}}function od(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ld(e){if(Be){var t=sn;if(t){var n=t;if(!vp(e,t)){if(od(e))throw Error(W(418));t=Hr(n.nextSibling);var r=on;t&&vp(e,t)?Kv(r,n):(e.flags=e.flags&-4097|2,Be=!1,on=e)}}else{if(od(e))throw Error(W(418));e.flags=e.flags&-4097|2,Be=!1,on=e}}}function yp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;on=e}function jl(e){if(e!==on)return!1;if(!Be)return yp(e),Be=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!nd(e.type,e.memoizedProps)),t&&(t=sn)){if(od(e))throw qv(),Error(W(418));for(;t;)Kv(e,t),t=Hr(t.nextSibling)}if(yp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(W(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){sn=Hr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}sn=null}}else sn=on?Hr(e.stateNode.nextSibling):null;return!0}function qv(){for(var e=sn;e;)e=Hr(e.nextSibling)}function Ri(){sn=on=null,Be=!1}function Pf(e){Ln===null?Ln=[e]:Ln.push(e)}var z1=xr.ReactCurrentBatchConfig;function Xi(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,e))}return e}function Ml(e,t){throw e=Object.prototype.toString.call(t),Error(W(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function xp(e){var t=e._init;return t(e._payload)}function Gv(e){function t(v,g){if(e){var y=v.deletions;y===null?(v.deletions=[g],v.flags|=16):y.push(g)}}function n(v,g){if(!e)return null;for(;g!==null;)t(v,g),g=g.sibling;return null}function r(v,g){for(v=new Map;g!==null;)g.key!==null?v.set(g.key,g):v.set(g.index,g),g=g.sibling;return v}function s(v,g){return v=Gr(v,g),v.index=0,v.sibling=null,v}function i(v,g,y){return v.index=y,e?(y=v.alternate,y!==null?(y=y.index,y<g?(v.flags|=2,g):y):(v.flags|=2,g)):(v.flags|=1048576,g)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,g,y,m){return g===null||g.tag!==6?(g=mc(y,v.mode,m),g.return=v,g):(g=s(g,y),g.return=v,g)}function c(v,g,y,m){var S=y.type;return S===Gs?f(v,g,y.props.children,m,y.key):g!==null&&(g.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===jr&&xp(S)===g.type)?(m=s(g,y.props),m.ref=Xi(v,g,y),m.return=v,m):(m=sa(y.type,y.key,y.props,null,v.mode,m),m.ref=Xi(v,g,y),m.return=v,m)}function d(v,g,y,m){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=gc(y,v.mode,m),g.return=v,g):(g=s(g,y.children||[]),g.return=v,g)}function f(v,g,y,m,S){return g===null||g.tag!==7?(g=js(y,v.mode,m,S),g.return=v,g):(g=s(g,y),g.return=v,g)}function p(v,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=mc(""+g,v.mode,y),g.return=v,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case vl:return y=sa(g.type,g.key,g.props,null,v.mode,y),y.ref=Xi(v,null,g),y.return=v,y;case qs:return g=gc(g,v.mode,y),g.return=v,g;case jr:var m=g._init;return p(v,m(g._payload),y)}if(lo(g)||Qi(g))return g=js(g,v.mode,y,null),g.return=v,g;Ml(v,g)}return null}function h(v,g,y,m){var S=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return S!==null?null:l(v,g,""+y,m);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case vl:return y.key===S?c(v,g,y,m):null;case qs:return y.key===S?d(v,g,y,m):null;case jr:return S=y._init,h(v,g,S(y._payload),m)}if(lo(y)||Qi(y))return S!==null?null:f(v,g,y,m,null);Ml(v,y)}return null}function w(v,g,y,m,S){if(typeof m=="string"&&m!==""||typeof m=="number")return v=v.get(y)||null,l(g,v,""+m,S);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case vl:return v=v.get(m.key===null?y:m.key)||null,c(g,v,m,S);case qs:return v=v.get(m.key===null?y:m.key)||null,d(g,v,m,S);case jr:var E=m._init;return w(v,g,y,E(m._payload),S)}if(lo(m)||Qi(m))return v=v.get(y)||null,f(g,v,m,S,null);Ml(g,m)}return null}function x(v,g,y,m){for(var S=null,E=null,j=g,M=g=0,I=null;j!==null&&M<y.length;M++){j.index>M?(I=j,j=null):I=j.sibling;var P=h(v,j,y[M],m);if(P===null){j===null&&(j=I);break}e&&j&&P.alternate===null&&t(v,j),g=i(P,g,M),E===null?S=P:E.sibling=P,E=P,j=I}if(M===y.length)return n(v,j),Be&&os(v,M),S;if(j===null){for(;M<y.length;M++)j=p(v,y[M],m),j!==null&&(g=i(j,g,M),E===null?S=j:E.sibling=j,E=j);return Be&&os(v,M),S}for(j=r(v,j);M<y.length;M++)I=w(j,v,M,y[M],m),I!==null&&(e&&I.alternate!==null&&j.delete(I.key===null?M:I.key),g=i(I,g,M),E===null?S=I:E.sibling=I,E=I);return e&&j.forEach(function(B){return t(v,B)}),Be&&os(v,M),S}function b(v,g,y,m){var S=Qi(y);if(typeof S!="function")throw Error(W(150));if(y=S.call(y),y==null)throw Error(W(151));for(var E=S=null,j=g,M=g=0,I=null,P=y.next();j!==null&&!P.done;M++,P=y.next()){j.index>M?(I=j,j=null):I=j.sibling;var B=h(v,j,P.value,m);if(B===null){j===null&&(j=I);break}e&&j&&B.alternate===null&&t(v,j),g=i(B,g,M),E===null?S=B:E.sibling=B,E=B,j=I}if(P.done)return n(v,j),Be&&os(v,M),S;if(j===null){for(;!P.done;M++,P=y.next())P=p(v,P.value,m),P!==null&&(g=i(P,g,M),E===null?S=P:E.sibling=P,E=P);return Be&&os(v,M),S}for(j=r(v,j);!P.done;M++,P=y.next())P=w(j,v,M,P.value,m),P!==null&&(e&&P.alternate!==null&&j.delete(P.key===null?M:P.key),g=i(P,g,M),E===null?S=P:E.sibling=P,E=P);return e&&j.forEach(function(F){return t(v,F)}),Be&&os(v,M),S}function C(v,g,y,m){if(typeof y=="object"&&y!==null&&y.type===Gs&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case vl:e:{for(var S=y.key,E=g;E!==null;){if(E.key===S){if(S=y.type,S===Gs){if(E.tag===7){n(v,E.sibling),g=s(E,y.props.children),g.return=v,v=g;break e}}else if(E.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===jr&&xp(S)===E.type){n(v,E.sibling),g=s(E,y.props),g.ref=Xi(v,E,y),g.return=v,v=g;break e}n(v,E);break}else t(v,E);E=E.sibling}y.type===Gs?(g=js(y.props.children,v.mode,m,y.key),g.return=v,v=g):(m=sa(y.type,y.key,y.props,null,v.mode,m),m.ref=Xi(v,g,y),m.return=v,v=m)}return o(v);case qs:e:{for(E=y.key;g!==null;){if(g.key===E)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(v,g.sibling),g=s(g,y.children||[]),g.return=v,v=g;break e}else{n(v,g);break}else t(v,g);g=g.sibling}g=gc(y,v.mode,m),g.return=v,v=g}return o(v);case jr:return E=y._init,C(v,g,E(y._payload),m)}if(lo(y))return x(v,g,y,m);if(Qi(y))return b(v,g,y,m);Ml(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(n(v,g.sibling),g=s(g,y),g.return=v,v=g):(n(v,g),g=mc(y,v.mode,m),g.return=v,v=g),o(v)):n(v,g)}return C}var Pi=Gv(!0),Yv=Gv(!1),Na=rs(null),ja=null,ri=null,Tf=null;function If(){Tf=ri=ja=null}function Lf(e){var t=Na.current;$e(Na),e._currentValue=t}function ad(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ci(e,t){ja=e,Tf=ri=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Yt=!0),e.firstContext=null)}function Sn(e){var t=e._currentValue;if(Tf!==e)if(e={context:e,memoizedValue:t,next:null},ri===null){if(ja===null)throw Error(W(308));ri=e,ja.dependencies={lanes:0,firstContext:e}}else ri=ri.next=e;return t}var cs=null;function _f(e){cs===null?cs=[e]:cs.push(e)}function Xv(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,_f(t)):(n.next=s.next,s.next=n),t.interleaved=n,vr(e,r)}function vr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Mr=!1;function Af(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Qr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Te&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,vr(e,n)}return s=r.interleaved,s===null?(t.next=t,_f(r)):(t.next=s.next,s.next=t),r.interleaved=t,vr(e,n)}function Jl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,wf(e,n)}}function wp(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ma(e,t,n,r){var s=e.updateQueue;Mr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=c))}if(i!==null){var p=s.baseState;o=0,f=d=c=null,l=i;do{var h=l.lane,w=l.eventTime;if((r&h)===h){f!==null&&(f=f.next={eventTime:w,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,b=l;switch(h=t,w=n,b.tag){case 1:if(x=b.payload,typeof x=="function"){p=x.call(w,p,h);break e}p=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=b.payload,h=typeof x=="function"?x.call(w,p,h):x,h==null)break e;p=Qe({},p,h);break e;case 2:Mr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else w={eventTime:w,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=w,c=p):f=f.next=w,o|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(f===null&&(c=p),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Ts|=o,e.lanes=o,e.memoizedState=p}}function bp(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var tl={},Xn=rs(tl),Fo=rs(tl),Oo=rs(tl);function ds(e){if(e===tl)throw Error(W(174));return e}function Ff(e,t){switch(De(Oo,t),De(Fo,e),De(Xn,tl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Uc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Uc(t,e)}$e(Xn),De(Xn,t)}function Ti(){$e(Xn),$e(Fo),$e(Oo)}function Zv(e){ds(Oo.current);var t=ds(Xn.current),n=Uc(t,e.type);t!==n&&(De(Fo,e),De(Xn,n))}function Of(e){Fo.current===e&&($e(Xn),$e(Fo))}var We=rs(0);function Ra(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var uc=[];function Df(){for(var e=0;e<uc.length;e++)uc[e]._workInProgressVersionPrimary=null;uc.length=0}var Zl=xr.ReactCurrentDispatcher,cc=xr.ReactCurrentBatchConfig,Ps=0,He=null,at=null,ht=null,Pa=!1,yo=!1,Do=0,$1=0;function Nt(){throw Error(W(321))}function zf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!On(e[n],t[n]))return!1;return!0}function $f(e,t,n,r,s,i){if(Ps=i,He=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Zl.current=e===null||e.memoizedState===null?W1:H1,e=n(r,s),yo){i=0;do{if(yo=!1,Do=0,25<=i)throw Error(W(301));i+=1,ht=at=null,t.updateQueue=null,Zl.current=Q1,e=n(r,s)}while(yo)}if(Zl.current=Ta,t=at!==null&&at.next!==null,Ps=0,ht=at=He=null,Pa=!1,t)throw Error(W(300));return e}function Bf(){var e=Do!==0;return Do=0,e}function Hn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?He.memoizedState=ht=e:ht=ht.next=e,ht}function Cn(){if(at===null){var e=He.alternate;e=e!==null?e.memoizedState:null}else e=at.next;var t=ht===null?He.memoizedState:ht.next;if(t!==null)ht=t,at=e;else{if(e===null)throw Error(W(310));at=e,e={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},ht===null?He.memoizedState=ht=e:ht=ht.next=e}return ht}function zo(e,t){return typeof t=="function"?t(e):t}function dc(e){var t=Cn(),n=t.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=e;var r=at,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,d=i;do{var f=d.lane;if((Ps&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,He.lanes|=f,Ts|=f}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=l,On(r,t.memoizedState)||(Yt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,He.lanes|=i,Ts|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function fc(e){var t=Cn(),n=t.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);On(i,t.memoizedState)||(Yt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function ey(){}function ty(e,t){var n=He,r=Cn(),s=t(),i=!On(r.memoizedState,s);if(i&&(r.memoizedState=s,Yt=!0),r=r.queue,Uf(sy.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||ht!==null&&ht.memoizedState.tag&1){if(n.flags|=2048,$o(9,ry.bind(null,n,r,s,t),void 0,null),pt===null)throw Error(W(349));Ps&30||ny(n,t,s)}return s}function ny(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=He.updateQueue,t===null?(t={lastEffect:null,stores:null},He.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function ry(e,t,n,r){t.value=n,t.getSnapshot=r,iy(t)&&oy(e)}function sy(e,t,n){return n(function(){iy(t)&&oy(e)})}function iy(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!On(e,n)}catch{return!0}}function oy(e){var t=vr(e,1);t!==null&&An(t,e,1,-1)}function Sp(e){var t=Hn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:zo,lastRenderedState:e},t.queue=e,e=e.dispatch=V1.bind(null,He,e),[t.memoizedState,e]}function $o(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=He.updateQueue,t===null?(t={lastEffect:null,stores:null},He.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function ly(){return Cn().memoizedState}function ea(e,t,n,r){var s=Hn();He.flags|=e,s.memoizedState=$o(1|t,n,void 0,r===void 0?null:r)}function ru(e,t,n,r){var s=Cn();r=r===void 0?null:r;var i=void 0;if(at!==null){var o=at.memoizedState;if(i=o.destroy,r!==null&&zf(r,o.deps)){s.memoizedState=$o(t,n,i,r);return}}He.flags|=e,s.memoizedState=$o(1|t,n,i,r)}function Cp(e,t){return ea(8390656,8,e,t)}function Uf(e,t){return ru(2048,8,e,t)}function ay(e,t){return ru(4,2,e,t)}function uy(e,t){return ru(4,4,e,t)}function cy(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function dy(e,t,n){return n=n!=null?n.concat([e]):null,ru(4,4,cy.bind(null,t,e),n)}function Vf(){}function fy(e,t){var n=Cn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&zf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function hy(e,t){var n=Cn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&zf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function py(e,t,n){return Ps&21?(On(n,t)||(n=xv(),He.lanes|=n,Ts|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Yt=!0),e.memoizedState=n)}function B1(e,t){var n=Ae;Ae=n!==0&&4>n?n:4,e(!0);var r=cc.transition;cc.transition={};try{e(!1),t()}finally{Ae=n,cc.transition=r}}function my(){return Cn().memoizedState}function U1(e,t,n){var r=qr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},gy(e))vy(t,n);else if(n=Xv(e,t,n,r),n!==null){var s=Ot();An(n,e,r,s),yy(n,t,r)}}function V1(e,t,n){var r=qr(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(gy(e))vy(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,On(l,o)){var c=t.interleaved;c===null?(s.next=s,_f(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Xv(e,t,s,r),n!==null&&(s=Ot(),An(n,e,r,s),yy(n,t,r))}}function gy(e){var t=e.alternate;return e===He||t!==null&&t===He}function vy(e,t){yo=Pa=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function yy(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,wf(e,n)}}var Ta={readContext:Sn,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useInsertionEffect:Nt,useLayoutEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useMutableSource:Nt,useSyncExternalStore:Nt,useId:Nt,unstable_isNewReconciler:!1},W1={readContext:Sn,useCallback:function(e,t){return Hn().memoizedState=[e,t===void 0?null:t],e},useContext:Sn,useEffect:Cp,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ea(4194308,4,cy.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ea(4194308,4,e,t)},useInsertionEffect:function(e,t){return ea(4,2,e,t)},useMemo:function(e,t){var n=Hn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Hn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=U1.bind(null,He,e),[r.memoizedState,e]},useRef:function(e){var t=Hn();return e={current:e},t.memoizedState=e},useState:Sp,useDebugValue:Vf,useDeferredValue:function(e){return Hn().memoizedState=e},useTransition:function(){var e=Sp(!1),t=e[0];return e=B1.bind(null,e[1]),Hn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=He,s=Hn();if(Be){if(n===void 0)throw Error(W(407));n=n()}else{if(n=t(),pt===null)throw Error(W(349));Ps&30||ny(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Cp(sy.bind(null,r,i,e),[e]),r.flags|=2048,$o(9,ry.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Hn(),t=pt.identifierPrefix;if(Be){var n=dr,r=cr;n=(r&~(1<<32-_n(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Do++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=$1++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},H1={readContext:Sn,useCallback:fy,useContext:Sn,useEffect:Uf,useImperativeHandle:dy,useInsertionEffect:ay,useLayoutEffect:uy,useMemo:hy,useReducer:dc,useRef:ly,useState:function(){return dc(zo)},useDebugValue:Vf,useDeferredValue:function(e){var t=Cn();return py(t,at.memoizedState,e)},useTransition:function(){var e=dc(zo)[0],t=Cn().memoizedState;return[e,t]},useMutableSource:ey,useSyncExternalStore:ty,useId:my,unstable_isNewReconciler:!1},Q1={readContext:Sn,useCallback:fy,useContext:Sn,useEffect:Uf,useImperativeHandle:dy,useInsertionEffect:ay,useLayoutEffect:uy,useMemo:hy,useReducer:fc,useRef:ly,useState:function(){return fc(zo)},useDebugValue:Vf,useDeferredValue:function(e){var t=Cn();return at===null?t.memoizedState=e:py(t,at.memoizedState,e)},useTransition:function(){var e=fc(zo)[0],t=Cn().memoizedState;return[e,t]},useMutableSource:ey,useSyncExternalStore:ty,useId:my,unstable_isNewReconciler:!1};function Mn(e,t){if(e&&e.defaultProps){t=Qe({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function ud(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Qe({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var su={isMounted:function(e){return(e=e._reactInternals)?Fs(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ot(),s=qr(e),i=fr(r,s);i.payload=t,n!=null&&(i.callback=n),t=Qr(e,i,s),t!==null&&(An(t,e,s,r),Jl(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ot(),s=qr(e),i=fr(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Qr(e,i,s),t!==null&&(An(t,e,s,r),Jl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ot(),r=qr(e),s=fr(n,r);s.tag=2,t!=null&&(s.callback=t),t=Qr(e,s,r),t!==null&&(An(t,e,r,n),Jl(t,e,r))}};function kp(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!Io(n,r)||!Io(s,i):!0}function xy(e,t,n){var r=!1,s=ts,i=t.contextType;return typeof i=="object"&&i!==null?i=Sn(i):(s=Jt(t)?Ms:Pt.current,r=t.contextTypes,i=(r=r!=null)?Mi(e,s):ts),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=su,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Ep(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&su.enqueueReplaceState(t,t.state,null)}function cd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Af(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Sn(i):(i=Jt(t)?Ms:Pt.current,s.context=Mi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(ud(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&su.enqueueReplaceState(s,s.state,null),Ma(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Ii(e,t){try{var n="",r=t;do n+=ww(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function hc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function dd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var K1=typeof WeakMap=="function"?WeakMap:Map;function wy(e,t,n){n=fr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){La||(La=!0,bd=r),dd(e,t)},n}function by(e,t,n){n=fr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){dd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){dd(e,t),typeof r!="function"&&(Kr===null?Kr=new Set([this]):Kr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Np(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new K1;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=lb.bind(null,e,t,n),t.then(e,e))}function jp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Mp(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=fr(-1,1),t.tag=2,Qr(n,t,1))),n.lanes|=1),e)}var q1=xr.ReactCurrentOwner,Yt=!1;function At(e,t,n,r){t.child=e===null?Yv(t,null,n,r):Pi(t,e.child,n,r)}function Rp(e,t,n,r,s){n=n.render;var i=t.ref;return ci(t,s),r=$f(e,t,n,r,i,s),n=Bf(),e!==null&&!Yt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,yr(e,t,s)):(Be&&n&&Mf(t),t.flags|=1,At(e,t,r,s),t.child)}function Pp(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!Xf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,Sy(e,t,i,r,s)):(e=sa(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Io,n(o,r)&&e.ref===t.ref)return yr(e,t,s)}return t.flags|=1,e=Gr(i,r),e.ref=t.ref,e.return=t,t.child=e}function Sy(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(Io(i,r)&&e.ref===t.ref)if(Yt=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Yt=!0);else return t.lanes=e.lanes,yr(e,t,s)}return fd(e,t,n,r,s)}function Cy(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(ii,rn),rn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,De(ii,rn),rn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,De(ii,rn),rn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,De(ii,rn),rn|=r;return At(e,t,s,n),t.child}function ky(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function fd(e,t,n,r,s){var i=Jt(n)?Ms:Pt.current;return i=Mi(t,i),ci(t,s),n=$f(e,t,n,r,i,s),r=Bf(),e!==null&&!Yt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,yr(e,t,s)):(Be&&r&&Mf(t),t.flags|=1,At(e,t,n,s),t.child)}function Tp(e,t,n,r,s){if(Jt(n)){var i=!0;Ca(t)}else i=!1;if(ci(t,s),t.stateNode===null)ta(e,t),xy(t,n,r),cd(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Sn(d):(d=Jt(n)?Ms:Pt.current,d=Mi(t,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&Ep(t,o,r,d),Mr=!1;var h=t.memoizedState;o.state=h,Ma(t,r,o,s),c=t.memoizedState,l!==r||h!==c||Xt.current||Mr?(typeof f=="function"&&(ud(t,n,f,r),c=t.memoizedState),(l=Mr||kp(t,n,l,r,h,c,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Jv(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Mn(t.type,l),o.props=d,p=t.pendingProps,h=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Sn(c):(c=Jt(n)?Ms:Pt.current,c=Mi(t,c));var w=n.getDerivedStateFromProps;(f=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||h!==c)&&Ep(t,o,r,c),Mr=!1,h=t.memoizedState,o.state=h,Ma(t,r,o,s);var x=t.memoizedState;l!==p||h!==x||Xt.current||Mr?(typeof w=="function"&&(ud(t,n,w,r),x=t.memoizedState),(d=Mr||kp(t,n,d,r,h,x,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=x),o.props=r,o.state=x,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return hd(e,t,n,r,i,s)}function hd(e,t,n,r,s,i){ky(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&gp(t,n,!1),yr(e,t,i);r=t.stateNode,q1.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Pi(t,e.child,null,i),t.child=Pi(t,null,l,i)):At(e,t,l,i),t.memoizedState=r.state,s&&gp(t,n,!0),t.child}function Ey(e){var t=e.stateNode;t.pendingContext?mp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&mp(e,t.context,!1),Ff(e,t.containerInfo)}function Ip(e,t,n,r,s){return Ri(),Pf(s),t.flags|=256,At(e,t,n,r),t.child}var pd={dehydrated:null,treeContext:null,retryLane:0};function md(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ny(e,t,n){var r=t.pendingProps,s=We.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),De(We,s&1),e===null)return ld(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=lu(o,r,0,null),e=js(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=md(n),t.memoizedState=pd,e):Wf(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return G1(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Gr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Gr(l,i):(i=js(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?md(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=pd,r}return i=e.child,e=i.sibling,r=Gr(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Wf(e,t){return t=lu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Rl(e,t,n,r){return r!==null&&Pf(r),Pi(t,e.child,null,n),e=Wf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function G1(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=hc(Error(W(422))),Rl(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=lu({mode:"visible",children:r.children},s,0,null),i=js(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Pi(t,e.child,null,o),t.child.memoizedState=md(o),t.memoizedState=pd,i);if(!(t.mode&1))return Rl(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(W(419)),r=hc(i,r,void 0),Rl(e,t,o,r)}if(l=(o&e.childLanes)!==0,Yt||l){if(r=pt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,vr(e,s),An(r,e,s,-1))}return Yf(),r=hc(Error(W(421))),Rl(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=ab.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,sn=Hr(s.nextSibling),on=t,Be=!0,Ln=null,e!==null&&(vn[yn++]=cr,vn[yn++]=dr,vn[yn++]=Rs,cr=e.id,dr=e.overflow,Rs=t),t=Wf(t,r.children),t.flags|=4096,t)}function Lp(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ad(e.return,t,n)}function pc(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function jy(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(At(e,t,r.children,n),r=We.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Lp(e,n,t);else if(e.tag===19)Lp(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(De(We,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Ra(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),pc(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Ra(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}pc(t,!0,n,null,i);break;case"together":pc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ta(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function yr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ts|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(W(153));if(t.child!==null){for(e=t.child,n=Gr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Gr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Y1(e,t,n){switch(t.tag){case 3:Ey(t),Ri();break;case 5:Zv(t);break;case 1:Jt(t.type)&&Ca(t);break;case 4:Ff(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;De(Na,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(De(We,We.current&1),t.flags|=128,null):n&t.child.childLanes?Ny(e,t,n):(De(We,We.current&1),e=yr(e,t,n),e!==null?e.sibling:null);De(We,We.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return jy(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),De(We,We.current),r)break;return null;case 22:case 23:return t.lanes=0,Cy(e,t,n)}return yr(e,t,n)}var My,gd,Ry,Py;My=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};gd=function(){};Ry=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,ds(Xn.current);var i=null;switch(n){case"input":s=Dc(e,s),r=Dc(e,r),i=[];break;case"select":s=Qe({},s,{value:void 0}),r=Qe({},r,{value:void 0}),i=[];break;case"textarea":s=Bc(e,s),r=Bc(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ba)}Vc(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Eo.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Eo.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ze("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Py=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ji(e,t){if(!Be)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function X1(e,t,n){var r=t.pendingProps;switch(Rf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(t),null;case 1:return Jt(t.type)&&Sa(),jt(t),null;case 3:return r=t.stateNode,Ti(),$e(Xt),$e(Pt),Df(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(jl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ln!==null&&(kd(Ln),Ln=null))),gd(e,t),jt(t),null;case 5:Of(t);var s=ds(Oo.current);if(n=t.type,e!==null&&t.stateNode!=null)Ry(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(W(166));return jt(t),null}if(e=ds(Xn.current),jl(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Gn]=t,r[Ao]=i,e=(t.mode&1)!==0,n){case"dialog":ze("cancel",r),ze("close",r);break;case"iframe":case"object":case"embed":ze("load",r);break;case"video":case"audio":for(s=0;s<uo.length;s++)ze(uo[s],r);break;case"source":ze("error",r);break;case"img":case"image":case"link":ze("error",r),ze("load",r);break;case"details":ze("toggle",r);break;case"input":Uh(r,i),ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},ze("invalid",r);break;case"textarea":Wh(r,i),ze("invalid",r)}Vc(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Nl(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Nl(r.textContent,l,e),s=["children",""+l]):Eo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&ze("scroll",r)}switch(n){case"input":yl(r),Vh(r,i,!0);break;case"textarea":yl(r),Hh(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ba)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=sv(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Gn]=t,e[Ao]=r,My(e,t,!1,!1),t.stateNode=e;e:{switch(o=Wc(n,r),n){case"dialog":ze("cancel",e),ze("close",e),s=r;break;case"iframe":case"object":case"embed":ze("load",e),s=r;break;case"video":case"audio":for(s=0;s<uo.length;s++)ze(uo[s],e);s=r;break;case"source":ze("error",e),s=r;break;case"img":case"image":case"link":ze("error",e),ze("load",e),s=r;break;case"details":ze("toggle",e),s=r;break;case"input":Uh(e,r),s=Dc(e,r),ze("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Qe({},r,{value:void 0}),ze("invalid",e);break;case"textarea":Wh(e,r),s=Bc(e,r),ze("invalid",e);break;default:s=r}Vc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?lv(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&iv(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&No(e,c):typeof c=="number"&&No(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Eo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ze("scroll",e):c!=null&&pf(e,i,c,o))}switch(n){case"input":yl(e),Vh(e,r,!1);break;case"textarea":yl(e),Hh(e);break;case"option":r.value!=null&&e.setAttribute("value",""+es(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?oi(e,!!r.multiple,i,!1):r.defaultValue!=null&&oi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=ba)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return jt(t),null;case 6:if(e&&t.stateNode!=null)Py(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(W(166));if(n=ds(Oo.current),ds(Xn.current),jl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Gn]=t,(i=r.nodeValue!==n)&&(e=on,e!==null))switch(e.tag){case 3:Nl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Nl(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Gn]=t,t.stateNode=r}return jt(t),null;case 13:if($e(We),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Be&&sn!==null&&t.mode&1&&!(t.flags&128))qv(),Ri(),t.flags|=98560,i=!1;else if(i=jl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(W(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Gn]=t}else Ri(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;jt(t),i=!1}else Ln!==null&&(kd(Ln),Ln=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||We.current&1?ct===0&&(ct=3):Yf())),t.updateQueue!==null&&(t.flags|=4),jt(t),null);case 4:return Ti(),gd(e,t),e===null&&Lo(t.stateNode.containerInfo),jt(t),null;case 10:return Lf(t.type._context),jt(t),null;case 17:return Jt(t.type)&&Sa(),jt(t),null;case 19:if($e(We),i=t.memoizedState,i===null)return jt(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)Ji(i,!1);else{if(ct!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Ra(e),o!==null){for(t.flags|=128,Ji(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return De(We,We.current&1|2),t.child}e=e.sibling}i.tail!==null&&tt()>Li&&(t.flags|=128,r=!0,Ji(i,!1),t.lanes=4194304)}else{if(!r)if(e=Ra(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ji(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Be)return jt(t),null}else 2*tt()-i.renderingStartTime>Li&&n!==1073741824&&(t.flags|=128,r=!0,Ji(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=tt(),t.sibling=null,n=We.current,De(We,r?n&1|2:n&1),t):(jt(t),null);case 22:case 23:return Gf(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?rn&1073741824&&(jt(t),t.subtreeFlags&6&&(t.flags|=8192)):jt(t),null;case 24:return null;case 25:return null}throw Error(W(156,t.tag))}function J1(e,t){switch(Rf(t),t.tag){case 1:return Jt(t.type)&&Sa(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ti(),$e(Xt),$e(Pt),Df(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Of(t),null;case 13:if($e(We),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(W(340));Ri()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return $e(We),null;case 4:return Ti(),null;case 10:return Lf(t.type._context),null;case 22:case 23:return Gf(),null;case 24:return null;default:return null}}var Pl=!1,Mt=!1,Z1=typeof WeakSet=="function"?WeakSet:Set,te=null;function si(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Je(e,t,r)}else n.current=null}function vd(e,t,n){try{n()}catch(r){Je(e,t,r)}}var _p=!1;function eb(e,t){if(ed=ya,e=Av(),jf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,f=0,p=e,h=null;t:for(;;){for(var w;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(w=p.firstChild)!==null;)h=p,p=w;for(;;){if(p===e)break t;if(h===n&&++d===s&&(l=o),h===i&&++f===r&&(c=o),(w=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=w}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(td={focusedElem:e,selectionRange:n},ya=!1,te=t;te!==null;)if(t=te,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,te=e;else for(;te!==null;){t=te;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var b=x.memoizedProps,C=x.memoizedState,v=t.stateNode,g=v.getSnapshotBeforeUpdate(t.elementType===t.type?b:Mn(t.type,b),C);v.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(m){Je(t,t.return,m)}if(e=t.sibling,e!==null){e.return=t.return,te=e;break}te=t.return}return x=_p,_p=!1,x}function xo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&vd(t,n,i)}s=s.next}while(s!==r)}}function iu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function yd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Ty(e){var t=e.alternate;t!==null&&(e.alternate=null,Ty(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gn],delete t[Ao],delete t[sd],delete t[F1],delete t[O1])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Iy(e){return e.tag===5||e.tag===3||e.tag===4}function Ap(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Iy(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function xd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ba));else if(r!==4&&(e=e.child,e!==null))for(xd(e,t,n),e=e.sibling;e!==null;)xd(e,t,n),e=e.sibling}function wd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(wd(e,t,n),e=e.sibling;e!==null;)wd(e,t,n),e=e.sibling}var yt=null,In=!1;function kr(e,t,n){for(n=n.child;n!==null;)Ly(e,t,n),n=n.sibling}function Ly(e,t,n){if(Yn&&typeof Yn.onCommitFiberUnmount=="function")try{Yn.onCommitFiberUnmount(Xa,n)}catch{}switch(n.tag){case 5:Mt||si(n,t);case 6:var r=yt,s=In;yt=null,kr(e,t,n),yt=r,In=s,yt!==null&&(In?(e=yt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):yt.removeChild(n.stateNode));break;case 18:yt!==null&&(In?(e=yt,n=n.stateNode,e.nodeType===8?lc(e.parentNode,n):e.nodeType===1&&lc(e,n),Po(e)):lc(yt,n.stateNode));break;case 4:r=yt,s=In,yt=n.stateNode.containerInfo,In=!0,kr(e,t,n),yt=r,In=s;break;case 0:case 11:case 14:case 15:if(!Mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&vd(n,t,o),s=s.next}while(s!==r)}kr(e,t,n);break;case 1:if(!Mt&&(si(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Je(n,t,l)}kr(e,t,n);break;case 21:kr(e,t,n);break;case 22:n.mode&1?(Mt=(r=Mt)||n.memoizedState!==null,kr(e,t,n),Mt=r):kr(e,t,n);break;default:kr(e,t,n)}}function Fp(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Z1),t.forEach(function(r){var s=ub.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Nn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:yt=l.stateNode,In=!1;break e;case 3:yt=l.stateNode.containerInfo,In=!0;break e;case 4:yt=l.stateNode.containerInfo,In=!0;break e}l=l.return}if(yt===null)throw Error(W(160));Ly(i,o,s),yt=null,In=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Je(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)_y(t,e),t=t.sibling}function _y(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Nn(t,e),Wn(e),r&4){try{xo(3,e,e.return),iu(3,e)}catch(b){Je(e,e.return,b)}try{xo(5,e,e.return)}catch(b){Je(e,e.return,b)}}break;case 1:Nn(t,e),Wn(e),r&512&&n!==null&&si(n,n.return);break;case 5:if(Nn(t,e),Wn(e),r&512&&n!==null&&si(n,n.return),e.flags&32){var s=e.stateNode;try{No(s,"")}catch(b){Je(e,e.return,b)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&nv(s,i),Wc(l,o);var d=Wc(l,i);for(o=0;o<c.length;o+=2){var f=c[o],p=c[o+1];f==="style"?lv(s,p):f==="dangerouslySetInnerHTML"?iv(s,p):f==="children"?No(s,p):pf(s,f,p,d)}switch(l){case"input":zc(s,i);break;case"textarea":rv(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?oi(s,!!i.multiple,w,!1):h!==!!i.multiple&&(i.defaultValue!=null?oi(s,!!i.multiple,i.defaultValue,!0):oi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ao]=i}catch(b){Je(e,e.return,b)}}break;case 6:if(Nn(t,e),Wn(e),r&4){if(e.stateNode===null)throw Error(W(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(b){Je(e,e.return,b)}}break;case 3:if(Nn(t,e),Wn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Po(t.containerInfo)}catch(b){Je(e,e.return,b)}break;case 4:Nn(t,e),Wn(e);break;case 13:Nn(t,e),Wn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Kf=tt())),r&4&&Fp(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(Mt=(d=Mt)||f,Nn(t,e),Mt=d):Nn(t,e),Wn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!f&&e.mode&1)for(te=e,f=e.child;f!==null;){for(p=te=f;te!==null;){switch(h=te,w=h.child,h.tag){case 0:case 11:case 14:case 15:xo(4,h,h.return);break;case 1:si(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(b){Je(r,n,b)}}break;case 5:si(h,h.return);break;case 22:if(h.memoizedState!==null){Dp(p);continue}}w!==null?(w.return=h,te=w):Dp(p)}f=f.sibling}e:for(f=null,p=e;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=ov("display",o))}catch(b){Je(e,e.return,b)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(b){Je(e,e.return,b)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Nn(t,e),Wn(e),r&4&&Fp(e);break;case 21:break;default:Nn(t,e),Wn(e)}}function Wn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Iy(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(No(s,""),r.flags&=-33);var i=Ap(e);wd(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Ap(e);xd(e,l,o);break;default:throw Error(W(161))}}catch(c){Je(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function tb(e,t,n){te=e,Ay(e)}function Ay(e,t,n){for(var r=(e.mode&1)!==0;te!==null;){var s=te,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Pl;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Mt;l=Pl;var d=Mt;if(Pl=o,(Mt=c)&&!d)for(te=s;te!==null;)o=te,c=o.child,o.tag===22&&o.memoizedState!==null?zp(s):c!==null?(c.return=o,te=c):zp(s);for(;i!==null;)te=i,Ay(i),i=i.sibling;te=s,Pl=l,Mt=d}Op(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,te=i):Op(e)}}function Op(e){for(;te!==null;){var t=te;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Mt||iu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Mt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Mn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&bp(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}bp(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&Po(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}Mt||t.flags&512&&yd(t)}catch(h){Je(t,t.return,h)}}if(t===e){te=null;break}if(n=t.sibling,n!==null){n.return=t.return,te=n;break}te=t.return}}function Dp(e){for(;te!==null;){var t=te;if(t===e){te=null;break}var n=t.sibling;if(n!==null){n.return=t.return,te=n;break}te=t.return}}function zp(e){for(;te!==null;){var t=te;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{iu(4,t)}catch(c){Je(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){Je(t,s,c)}}var i=t.return;try{yd(t)}catch(c){Je(t,i,c)}break;case 5:var o=t.return;try{yd(t)}catch(c){Je(t,o,c)}}}catch(c){Je(t,t.return,c)}if(t===e){te=null;break}var l=t.sibling;if(l!==null){l.return=t.return,te=l;break}te=t.return}}var nb=Math.ceil,Ia=xr.ReactCurrentDispatcher,Hf=xr.ReactCurrentOwner,bn=xr.ReactCurrentBatchConfig,Te=0,pt=null,st=null,xt=0,rn=0,ii=rs(0),ct=0,Bo=null,Ts=0,ou=0,Qf=0,wo=null,Gt=null,Kf=0,Li=1/0,sr=null,La=!1,bd=null,Kr=null,Tl=!1,Br=null,_a=0,bo=0,Sd=null,na=-1,ra=0;function Ot(){return Te&6?tt():na!==-1?na:na=tt()}function qr(e){return e.mode&1?Te&2&&xt!==0?xt&-xt:z1.transition!==null?(ra===0&&(ra=xv()),ra):(e=Ae,e!==0||(e=window.event,e=e===void 0?16:Nv(e.type)),e):1}function An(e,t,n,r){if(50<bo)throw bo=0,Sd=null,Error(W(185));Jo(e,n,r),(!(Te&2)||e!==pt)&&(e===pt&&(!(Te&2)&&(ou|=n),ct===4&&Pr(e,xt)),Zt(e,r),n===1&&Te===0&&!(t.mode&1)&&(Li=tt()+500,nu&&ss()))}function Zt(e,t){var n=e.callbackNode;zw(e,t);var r=va(e,e===pt?xt:0);if(r===0)n!==null&&qh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&qh(n),t===1)e.tag===0?D1($p.bind(null,e)):Hv($p.bind(null,e)),_1(function(){!(Te&6)&&ss()}),n=null;else{switch(wv(r)){case 1:n=xf;break;case 4:n=vv;break;case 16:n=ga;break;case 536870912:n=yv;break;default:n=ga}n=Vy(n,Fy.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Fy(e,t){if(na=-1,ra=0,Te&6)throw Error(W(327));var n=e.callbackNode;if(di()&&e.callbackNode!==n)return null;var r=va(e,e===pt?xt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Aa(e,r);else{t=r;var s=Te;Te|=2;var i=Dy();(pt!==e||xt!==t)&&(sr=null,Li=tt()+500,Ns(e,t));do try{ib();break}catch(l){Oy(e,l)}while(!0);If(),Ia.current=i,Te=s,st!==null?t=0:(pt=null,xt=0,t=ct)}if(t!==0){if(t===2&&(s=Gc(e),s!==0&&(r=s,t=Cd(e,s))),t===1)throw n=Bo,Ns(e,0),Pr(e,r),Zt(e,tt()),n;if(t===6)Pr(e,r);else{if(s=e.current.alternate,!(r&30)&&!rb(s)&&(t=Aa(e,r),t===2&&(i=Gc(e),i!==0&&(r=i,t=Cd(e,i))),t===1))throw n=Bo,Ns(e,0),Pr(e,r),Zt(e,tt()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(W(345));case 2:ls(e,Gt,sr);break;case 3:if(Pr(e,r),(r&130023424)===r&&(t=Kf+500-tt(),10<t)){if(va(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Ot(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=rd(ls.bind(null,e,Gt,sr),t);break}ls(e,Gt,sr);break;case 4:if(Pr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-_n(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=tt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*nb(r/1960))-r,10<r){e.timeoutHandle=rd(ls.bind(null,e,Gt,sr),r);break}ls(e,Gt,sr);break;case 5:ls(e,Gt,sr);break;default:throw Error(W(329))}}}return Zt(e,tt()),e.callbackNode===n?Fy.bind(null,e):null}function Cd(e,t){var n=wo;return e.current.memoizedState.isDehydrated&&(Ns(e,t).flags|=256),e=Aa(e,t),e!==2&&(t=Gt,Gt=n,t!==null&&kd(t)),e}function kd(e){Gt===null?Gt=e:Gt.push.apply(Gt,e)}function rb(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!On(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Pr(e,t){for(t&=~Qf,t&=~ou,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-_n(t),r=1<<n;e[n]=-1,t&=~r}}function $p(e){if(Te&6)throw Error(W(327));di();var t=va(e,0);if(!(t&1))return Zt(e,tt()),null;var n=Aa(e,t);if(e.tag!==0&&n===2){var r=Gc(e);r!==0&&(t=r,n=Cd(e,r))}if(n===1)throw n=Bo,Ns(e,0),Pr(e,t),Zt(e,tt()),n;if(n===6)throw Error(W(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ls(e,Gt,sr),Zt(e,tt()),null}function qf(e,t){var n=Te;Te|=1;try{return e(t)}finally{Te=n,Te===0&&(Li=tt()+500,nu&&ss())}}function Is(e){Br!==null&&Br.tag===0&&!(Te&6)&&di();var t=Te;Te|=1;var n=bn.transition,r=Ae;try{if(bn.transition=null,Ae=1,e)return e()}finally{Ae=r,bn.transition=n,Te=t,!(Te&6)&&ss()}}function Gf(){rn=ii.current,$e(ii)}function Ns(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,L1(n)),st!==null)for(n=st.return;n!==null;){var r=n;switch(Rf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Sa();break;case 3:Ti(),$e(Xt),$e(Pt),Df();break;case 5:Of(r);break;case 4:Ti();break;case 13:$e(We);break;case 19:$e(We);break;case 10:Lf(r.type._context);break;case 22:case 23:Gf()}n=n.return}if(pt=e,st=e=Gr(e.current,null),xt=rn=t,ct=0,Bo=null,Qf=ou=Ts=0,Gt=wo=null,cs!==null){for(t=0;t<cs.length;t++)if(n=cs[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}cs=null}return e}function Oy(e,t){do{var n=st;try{if(If(),Zl.current=Ta,Pa){for(var r=He.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Pa=!1}if(Ps=0,ht=at=He=null,yo=!1,Do=0,Hf.current=null,n===null||n.return===null){ct=1,Bo=t,st=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=xt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var w=jp(o);if(w!==null){w.flags&=-257,Mp(w,o,l,i,t),w.mode&1&&Np(i,d,t),t=w,c=d;var x=t.updateQueue;if(x===null){var b=new Set;b.add(c),t.updateQueue=b}else x.add(c);break e}else{if(!(t&1)){Np(i,d,t),Yf();break e}c=Error(W(426))}}else if(Be&&l.mode&1){var C=jp(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Mp(C,o,l,i,t),Pf(Ii(c,l));break e}}i=c=Ii(c,l),ct!==4&&(ct=2),wo===null?wo=[i]:wo.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=wy(i,c,t);wp(i,v);break e;case 1:l=c;var g=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Kr===null||!Kr.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var m=by(i,l,t);wp(i,m);break e}}i=i.return}while(i!==null)}$y(n)}catch(S){t=S,st===n&&n!==null&&(st=n=n.return);continue}break}while(!0)}function Dy(){var e=Ia.current;return Ia.current=Ta,e===null?Ta:e}function Yf(){(ct===0||ct===3||ct===2)&&(ct=4),pt===null||!(Ts&268435455)&&!(ou&268435455)||Pr(pt,xt)}function Aa(e,t){var n=Te;Te|=2;var r=Dy();(pt!==e||xt!==t)&&(sr=null,Ns(e,t));do try{sb();break}catch(s){Oy(e,s)}while(!0);if(If(),Te=n,Ia.current=r,st!==null)throw Error(W(261));return pt=null,xt=0,ct}function sb(){for(;st!==null;)zy(st)}function ib(){for(;st!==null&&!Pw();)zy(st)}function zy(e){var t=Uy(e.alternate,e,rn);e.memoizedProps=e.pendingProps,t===null?$y(e):st=t,Hf.current=null}function $y(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=J1(n,t),n!==null){n.flags&=32767,st=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ct=6,st=null;return}}else if(n=X1(n,t,rn),n!==null){st=n;return}if(t=t.sibling,t!==null){st=t;return}st=t=e}while(t!==null);ct===0&&(ct=5)}function ls(e,t,n){var r=Ae,s=bn.transition;try{bn.transition=null,Ae=1,ob(e,t,n,r)}finally{bn.transition=s,Ae=r}return null}function ob(e,t,n,r){do di();while(Br!==null);if(Te&6)throw Error(W(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(W(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if($w(e,i),e===pt&&(st=pt=null,xt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Tl||(Tl=!0,Vy(ga,function(){return di(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=bn.transition,bn.transition=null;var o=Ae;Ae=1;var l=Te;Te|=4,Hf.current=null,eb(e,n),_y(n,e),N1(td),ya=!!ed,td=ed=null,e.current=n,tb(n),Tw(),Te=l,Ae=o,bn.transition=i}else e.current=n;if(Tl&&(Tl=!1,Br=e,_a=s),i=e.pendingLanes,i===0&&(Kr=null),_w(n.stateNode),Zt(e,tt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(La)throw La=!1,e=bd,bd=null,e;return _a&1&&e.tag!==0&&di(),i=e.pendingLanes,i&1?e===Sd?bo++:(bo=0,Sd=e):bo=0,ss(),null}function di(){if(Br!==null){var e=wv(_a),t=bn.transition,n=Ae;try{if(bn.transition=null,Ae=16>e?16:e,Br===null)var r=!1;else{if(e=Br,Br=null,_a=0,Te&6)throw Error(W(331));var s=Te;for(Te|=4,te=e.current;te!==null;){var i=te,o=i.child;if(te.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(te=d;te!==null;){var f=te;switch(f.tag){case 0:case 11:case 15:xo(8,f,i)}var p=f.child;if(p!==null)p.return=f,te=p;else for(;te!==null;){f=te;var h=f.sibling,w=f.return;if(Ty(f),f===d){te=null;break}if(h!==null){h.return=w,te=h;break}te=w}}}var x=i.alternate;if(x!==null){var b=x.child;if(b!==null){x.child=null;do{var C=b.sibling;b.sibling=null,b=C}while(b!==null)}}te=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,te=o;else e:for(;te!==null;){if(i=te,i.flags&2048)switch(i.tag){case 0:case 11:case 15:xo(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,te=v;break e}te=i.return}}var g=e.current;for(te=g;te!==null;){o=te;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,te=y;else e:for(o=g;te!==null;){if(l=te,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:iu(9,l)}}catch(S){Je(l,l.return,S)}if(l===o){te=null;break e}var m=l.sibling;if(m!==null){m.return=l.return,te=m;break e}te=l.return}}if(Te=s,ss(),Yn&&typeof Yn.onPostCommitFiberRoot=="function")try{Yn.onPostCommitFiberRoot(Xa,e)}catch{}r=!0}return r}finally{Ae=n,bn.transition=t}}return!1}function Bp(e,t,n){t=Ii(n,t),t=wy(e,t,1),e=Qr(e,t,1),t=Ot(),e!==null&&(Jo(e,1,t),Zt(e,t))}function Je(e,t,n){if(e.tag===3)Bp(e,e,n);else for(;t!==null;){if(t.tag===3){Bp(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Kr===null||!Kr.has(r))){e=Ii(n,e),e=by(t,e,1),t=Qr(t,e,1),e=Ot(),t!==null&&(Jo(t,1,e),Zt(t,e));break}}t=t.return}}function lb(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ot(),e.pingedLanes|=e.suspendedLanes&n,pt===e&&(xt&n)===n&&(ct===4||ct===3&&(xt&130023424)===xt&&500>tt()-Kf?Ns(e,0):Qf|=n),Zt(e,t)}function By(e,t){t===0&&(e.mode&1?(t=bl,bl<<=1,!(bl&130023424)&&(bl=4194304)):t=1);var n=Ot();e=vr(e,t),e!==null&&(Jo(e,t,n),Zt(e,n))}function ab(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),By(e,n)}function ub(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(t),By(e,n)}var Uy;Uy=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Xt.current)Yt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Yt=!1,Y1(e,t,n);Yt=!!(e.flags&131072)}else Yt=!1,Be&&t.flags&1048576&&Qv(t,Ea,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;ta(e,t),e=t.pendingProps;var s=Mi(t,Pt.current);ci(t,n),s=$f(null,t,r,e,s,n);var i=Bf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Jt(r)?(i=!0,Ca(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Af(t),s.updater=su,t.stateNode=s,s._reactInternals=t,cd(t,r,e,n),t=hd(null,t,r,!0,i,n)):(t.tag=0,Be&&i&&Mf(t),At(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(ta(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=db(r),e=Mn(r,e),s){case 0:t=fd(null,t,r,e,n);break e;case 1:t=Tp(null,t,r,e,n);break e;case 11:t=Rp(null,t,r,e,n);break e;case 14:t=Pp(null,t,r,Mn(r.type,e),n);break e}throw Error(W(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Mn(r,s),fd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Mn(r,s),Tp(e,t,r,s,n);case 3:e:{if(Ey(t),e===null)throw Error(W(387));r=t.pendingProps,i=t.memoizedState,s=i.element,Jv(e,t),Ma(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Ii(Error(W(423)),t),t=Ip(e,t,r,n,s);break e}else if(r!==s){s=Ii(Error(W(424)),t),t=Ip(e,t,r,n,s);break e}else for(sn=Hr(t.stateNode.containerInfo.firstChild),on=t,Be=!0,Ln=null,n=Yv(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ri(),r===s){t=yr(e,t,n);break e}At(e,t,r,n)}t=t.child}return t;case 5:return Zv(t),e===null&&ld(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,nd(r,s)?o=null:i!==null&&nd(r,i)&&(t.flags|=32),ky(e,t),At(e,t,o,n),t.child;case 6:return e===null&&ld(t),null;case 13:return Ny(e,t,n);case 4:return Ff(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Pi(t,null,r,n):At(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Mn(r,s),Rp(e,t,r,s,n);case 7:return At(e,t,t.pendingProps,n),t.child;case 8:return At(e,t,t.pendingProps.children,n),t.child;case 12:return At(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,De(Na,r._currentValue),r._currentValue=o,i!==null)if(On(i.value,o)){if(i.children===s.children&&!Xt.current){t=yr(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=fr(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),ad(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ad(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}At(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,ci(t,n),s=Sn(s),r=r(s),t.flags|=1,At(e,t,r,n),t.child;case 14:return r=t.type,s=Mn(r,t.pendingProps),s=Mn(r.type,s),Pp(e,t,r,s,n);case 15:return Sy(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Mn(r,s),ta(e,t),t.tag=1,Jt(r)?(e=!0,Ca(t)):e=!1,ci(t,n),xy(t,r,s),cd(t,r,s,n),hd(null,t,r,!0,e,n);case 19:return jy(e,t,n);case 22:return Cy(e,t,n)}throw Error(W(156,t.tag))};function Vy(e,t){return gv(e,t)}function cb(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wn(e,t,n,r){return new cb(e,t,n,r)}function Xf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function db(e){if(typeof e=="function")return Xf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===gf)return 11;if(e===vf)return 14}return 2}function Gr(e,t){var n=e.alternate;return n===null?(n=wn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function sa(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")Xf(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Gs:return js(n.children,s,i,t);case mf:o=8,s|=8;break;case _c:return e=wn(12,n,t,s|2),e.elementType=_c,e.lanes=i,e;case Ac:return e=wn(13,n,t,s),e.elementType=Ac,e.lanes=i,e;case Fc:return e=wn(19,n,t,s),e.elementType=Fc,e.lanes=i,e;case Zg:return lu(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Xg:o=10;break e;case Jg:o=9;break e;case gf:o=11;break e;case vf:o=14;break e;case jr:o=16,r=null;break e}throw Error(W(130,e==null?e:typeof e,""))}return t=wn(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function js(e,t,n,r){return e=wn(7,e,r,t),e.lanes=n,e}function lu(e,t,n,r){return e=wn(22,e,r,t),e.elementType=Zg,e.lanes=n,e.stateNode={isHidden:!1},e}function mc(e,t,n){return e=wn(6,e,null,t),e.lanes=n,e}function gc(e,t,n){return t=wn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function fb(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Yu(0),this.expirationTimes=Yu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Jf(e,t,n,r,s,i,o,l,c){return e=new fb(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=wn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Af(i),e}function hb(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qs,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Wy(e){if(!e)return ts;e=e._reactInternals;e:{if(Fs(e)!==e||e.tag!==1)throw Error(W(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Jt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(W(171))}if(e.tag===1){var n=e.type;if(Jt(n))return Wv(e,n,t)}return t}function Hy(e,t,n,r,s,i,o,l,c){return e=Jf(n,r,!0,e,s,i,o,l,c),e.context=Wy(null),n=e.current,r=Ot(),s=qr(n),i=fr(r,s),i.callback=t??null,Qr(n,i,s),e.current.lanes=s,Jo(e,s,r),Zt(e,r),e}function au(e,t,n,r){var s=t.current,i=Ot(),o=qr(s);return n=Wy(n),t.context===null?t.context=n:t.pendingContext=n,t=fr(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Qr(s,t,o),e!==null&&(An(e,s,o,i),Jl(e,s,o)),o}function Fa(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Up(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Zf(e,t){Up(e,t),(e=e.alternate)&&Up(e,t)}function pb(){return null}var Qy=typeof reportError=="function"?reportError:function(e){console.error(e)};function eh(e){this._internalRoot=e}uu.prototype.render=eh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(W(409));au(e,t,null,null)};uu.prototype.unmount=eh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Is(function(){au(null,e,null,null)}),t[gr]=null}};function uu(e){this._internalRoot=e}uu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Cv();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rr.length&&t!==0&&t<Rr[n].priority;n++);Rr.splice(n,0,e),n===0&&Ev(e)}};function th(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function cu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Vp(){}function mb(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Fa(o);i.call(d)}}var o=Hy(t,r,e,0,null,!1,!1,"",Vp);return e._reactRootContainer=o,e[gr]=o.current,Lo(e.nodeType===8?e.parentNode:e),Is(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=Fa(c);l.call(d)}}var c=Jf(e,0,!1,null,null,!1,!1,"",Vp);return e._reactRootContainer=c,e[gr]=c.current,Lo(e.nodeType===8?e.parentNode:e),Is(function(){au(t,c,n,r)}),c}function du(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Fa(o);l.call(c)}}au(t,o,e,s)}else o=mb(n,t,e,s,r);return Fa(o)}bv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ao(t.pendingLanes);n!==0&&(wf(t,n|1),Zt(t,tt()),!(Te&6)&&(Li=tt()+500,ss()))}break;case 13:Is(function(){var r=vr(e,1);if(r!==null){var s=Ot();An(r,e,1,s)}}),Zf(e,1)}};bf=function(e){if(e.tag===13){var t=vr(e,134217728);if(t!==null){var n=Ot();An(t,e,134217728,n)}Zf(e,134217728)}};Sv=function(e){if(e.tag===13){var t=qr(e),n=vr(e,t);if(n!==null){var r=Ot();An(n,e,t,r)}Zf(e,t)}};Cv=function(){return Ae};kv=function(e,t){var n=Ae;try{return Ae=e,t()}finally{Ae=n}};Qc=function(e,t,n){switch(t){case"input":if(zc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=tu(r);if(!s)throw Error(W(90));tv(r),zc(r,s)}}}break;case"textarea":rv(e,n);break;case"select":t=n.value,t!=null&&oi(e,!!n.multiple,t,!1)}};cv=qf;dv=Is;var gb={usingClientEntryPoint:!1,Events:[el,Zs,tu,av,uv,qf]},Zi={findFiberByHostInstance:us,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},vb={bundleType:Zi.bundleType,version:Zi.version,rendererPackageName:Zi.rendererPackageName,rendererConfig:Zi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=pv(e),e===null?null:e.stateNode},findFiberByHostInstance:Zi.findFiberByHostInstance||pb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Il.isDisabled&&Il.supportsFiber)try{Xa=Il.inject(vb),Yn=Il}catch{}}un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gb;un.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!th(t))throw Error(W(200));return hb(e,t,null,n)};un.createRoot=function(e,t){if(!th(e))throw Error(W(299));var n=!1,r="",s=Qy;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Jf(e,1,!1,null,null,n,!1,r,s),e[gr]=t.current,Lo(e.nodeType===8?e.parentNode:e),new eh(t)};un.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(W(188)):(e=Object.keys(e).join(","),Error(W(268,e)));return e=pv(t),e=e===null?null:e.stateNode,e};un.flushSync=function(e){return Is(e)};un.hydrate=function(e,t,n){if(!cu(t))throw Error(W(200));return du(null,e,t,!0,n)};un.hydrateRoot=function(e,t,n){if(!th(e))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Qy;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Hy(t,null,e,1,n??null,s,!1,i,o),e[gr]=t.current,Lo(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new uu(t)};un.render=function(e,t,n){if(!cu(t))throw Error(W(200));return du(null,e,t,!1,n)};un.unmountComponentAtNode=function(e){if(!cu(e))throw Error(W(40));return e._reactRootContainer?(Is(function(){du(null,null,e,!1,function(){e._reactRootContainer=null,e[gr]=null})}),!0):!1};un.unstable_batchedUpdates=qf;un.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!cu(n))throw Error(W(200));if(e==null||e._reactInternals===void 0)throw Error(W(38));return du(e,t,n,!1,r)};un.version="18.3.1-next-f1338f8080-20240426";function Ky(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Ky)}catch(e){console.error(e)}}Ky(),Kg.exports=un;var fu=Kg.exports,qy,Wp=fu;qy=Wp.createRoot,Wp.hydrateRoot;var Di=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},yb={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Tr,lf,Eg,xb=(Eg=class{constructor(){ue(this,Tr,yb);ue(this,lf,!1)}setTimeoutProvider(e){J(this,Tr,e)}setTimeout(e,t){return k(this,Tr).setTimeout(e,t)}clearTimeout(e){k(this,Tr).clearTimeout(e)}setInterval(e,t){return k(this,Tr).setInterval(e,t)}clearInterval(e){k(this,Tr).clearInterval(e)}},Tr=new WeakMap,lf=new WeakMap,Eg),fs=new xb;function wb(e){setTimeout(e,0)}var Ls=typeof window>"u"||"Deno"in globalThis;function Ft(){}function bb(e,t){return typeof e=="function"?e(t):e}function Ed(e){return typeof e=="number"&&e>=0&&e!==1/0}function Gy(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Yr(e,t){return typeof e=="function"?e(t):e}function gn(e,t){return typeof e=="function"?e(t):e}function Hp(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(r){if(t.queryHash!==nh(o,t.options))return!1}else if(!Uo(t.queryKey,o))return!1}if(n!=="all"){const c=t.isActive();if(n==="active"&&!c||n==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function Qp(e,t){const{exact:n,status:r,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(_s(t.options.mutationKey)!==_s(i))return!1}else if(!Uo(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function nh(e,t){return((t==null?void 0:t.queryKeyHashFn)||_s)(e)}function _s(e){return JSON.stringify(e,(t,n)=>Nd(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function Uo(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Uo(e[n],t[n])):!1}var Sb=Object.prototype.hasOwnProperty;function Yy(e,t){if(e===t)return e;const n=Kp(e)&&Kp(t);if(!n&&!(Nd(e)&&Nd(t)))return t;const s=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),o=i.length,l=n?new Array(o):{};let c=0;for(let d=0;d<o;d++){const f=n?d:i[d],p=e[f],h=t[f];if(p===h){l[f]=p,(n?d<s:Sb.call(e,f))&&c++;continue}if(p===null||h===null||typeof p!="object"||typeof h!="object"){l[f]=h;continue}const w=Yy(p,h);l[f]=w,w===p&&c++}return s===o&&c===s?e:l}function Oa(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function Kp(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Nd(e){if(!qp(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!qp(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function qp(e){return Object.prototype.toString.call(e)==="[object Object]"}function Cb(e){return new Promise(t=>{fs.setTimeout(t,e)})}function jd(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?Yy(e,t):t}function kb(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function Eb(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var rh=Symbol();function Xy(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===rh?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Jy(e,t){return typeof e=="function"?e(...t):!!e}function Nb(e,t,n){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=t()),r||(r=!0,s.aborted?n():s.addEventListener("abort",n,{once:!0})),s)}),e}var vs,Ir,mi,Ng,jb=(Ng=class extends Di{constructor(){super();ue(this,vs);ue(this,Ir);ue(this,mi);J(this,mi,t=>{if(!Ls&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){k(this,Ir)||this.setEventListener(k(this,mi))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,Ir))==null||t.call(this),J(this,Ir,void 0))}setEventListener(t){var n;J(this,mi,t),(n=k(this,Ir))==null||n.call(this),J(this,Ir,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){k(this,vs)!==t&&(J(this,vs,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof k(this,vs)=="boolean"?k(this,vs):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},vs=new WeakMap,Ir=new WeakMap,mi=new WeakMap,Ng),sh=new jb;function Md(){let e,t;const n=new Promise((s,i)=>{e=s,t=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}var Mb=wb;function Rb(){let e=[],t=0,n=l=>{l()},r=l=>{l()},s=Mb;const i=l=>{t?e.push(l):s(()=>{n(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{r(()=>{l.forEach(c=>{n(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var ut=Rb(),gi,Lr,vi,jg,Pb=(jg=class extends Di{constructor(){super();ue(this,gi,!0);ue(this,Lr);ue(this,vi);J(this,vi,t=>{if(!Ls&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){k(this,Lr)||this.setEventListener(k(this,vi))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,Lr))==null||t.call(this),J(this,Lr,void 0))}setEventListener(t){var n;J(this,vi,t),(n=k(this,Lr))==null||n.call(this),J(this,Lr,t(this.setOnline.bind(this)))}setOnline(t){k(this,gi)!==t&&(J(this,gi,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return k(this,gi)}},gi=new WeakMap,Lr=new WeakMap,vi=new WeakMap,jg),Da=new Pb;function Tb(e){return Math.min(1e3*2**e,3e4)}function Zy(e){return(e??"online")==="online"?Da.isOnline():!0}var Rd=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function ex(e){let t=!1,n=0,r;const s=Md(),i=()=>s.status!=="pending",o=b=>{var C;if(!i()){const v=new Rd(b);h(v),(C=e.onCancel)==null||C.call(e,v)}},l=()=>{t=!0},c=()=>{t=!1},d=()=>sh.isFocused()&&(e.networkMode==="always"||Da.isOnline())&&e.canRun(),f=()=>Zy(e.networkMode)&&e.canRun(),p=b=>{i()||(r==null||r(),s.resolve(b))},h=b=>{i()||(r==null||r(),s.reject(b))},w=()=>new Promise(b=>{var C;r=v=>{(i()||d())&&b(v)},(C=e.onPause)==null||C.call(e)}).then(()=>{var b;r=void 0,i()||(b=e.onContinue)==null||b.call(e)}),x=()=>{if(i())return;let b;const C=n===0?e.initialPromise:void 0;try{b=C??e.fn()}catch(v){b=Promise.reject(v)}Promise.resolve(b).then(p).catch(v=>{var E;if(i())return;const g=e.retry??(Ls?0:3),y=e.retryDelay??Tb,m=typeof y=="function"?y(n,v):y,S=g===!0||typeof g=="number"&&n<g||typeof g=="function"&&g(n,v);if(t||!S){h(v);return}n++,(E=e.onFail)==null||E.call(e,n,v),Cb(m).then(()=>d()?void 0:w()).then(()=>{t?h(v):x()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:l,continueRetry:c,canStart:f,start:()=>(f()?x():w().then(x),s)}}var ys,Mg,tx=(Mg=class{constructor(){ue(this,ys)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Ed(this.gcTime)&&J(this,ys,fs.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Ls?1/0:5*60*1e3))}clearGcTimeout(){k(this,ys)&&(fs.clearTimeout(k(this,ys)),J(this,ys,void 0))}},ys=new WeakMap,Mg),xs,yi,mn,ws,ft,Qo,bs,Pn,rr,Rg,Ib=(Rg=class extends tx{constructor(t){super();ue(this,Pn);ue(this,xs);ue(this,yi);ue(this,mn);ue(this,ws);ue(this,ft);ue(this,Qo);ue(this,bs);J(this,bs,!1),J(this,Qo,t.defaultOptions),this.setOptions(t.options),this.observers=[],J(this,ws,t.client),J(this,mn,k(this,ws).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,J(this,xs,Yp(this.options)),this.state=t.state??k(this,xs),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=k(this,ft))==null?void 0:t.promise}setOptions(t){if(this.options={...k(this,Qo),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Yp(this.options);n.data!==void 0&&(this.setState(Gp(n.data,n.dataUpdatedAt)),J(this,xs,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&k(this,mn).remove(this)}setData(t,n){const r=jd(this.state.data,t,this.options);return ye(this,Pn,rr).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){ye(this,Pn,rr).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=k(this,ft))==null?void 0:r.promise;return(s=k(this,ft))==null||s.cancel(t),n?n.then(Ft).catch(Ft):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(k(this,xs))}isActive(){return this.observers.some(t=>gn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===rh||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Yr(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Gy(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,ft))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,ft))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),k(this,mn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(k(this,ft)&&(k(this,bs)?k(this,ft).cancel({revert:!0}):k(this,ft).cancelRetry()),this.scheduleGc()),k(this,mn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ye(this,Pn,rr).call(this,{type:"invalidate"})}async fetch(t,n){var c,d,f,p,h,w,x,b,C,v,g,y;if(this.state.fetchStatus!=="idle"&&((c=k(this,ft))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(k(this,ft))return k(this,ft).continueRetry(),k(this,ft).promise}if(t&&this.setOptions(t),!this.options.queryFn){const m=this.observers.find(S=>S.options.queryFn);m&&this.setOptions(m.options)}const r=new AbortController,s=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(J(this,bs,!0),r.signal)})},i=()=>{const m=Xy(this.options,n),E=(()=>{const j={client:k(this,ws),queryKey:this.queryKey,meta:this.meta};return s(j),j})();return J(this,bs,!1),this.options.persister?this.options.persister(m,E,this):m(E)},l=(()=>{const m={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:k(this,ws),state:this.state,fetchFn:i};return s(m),m})();(d=this.options.behavior)==null||d.onFetch(l,this),J(this,yi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&ye(this,Pn,rr).call(this,{type:"fetch",meta:(p=l.fetchOptions)==null?void 0:p.meta}),J(this,ft,ex({initialPromise:n==null?void 0:n.initialPromise,fn:l.fetchFn,onCancel:m=>{m instanceof Rd&&m.revert&&this.setState({...k(this,yi),fetchStatus:"idle"}),r.abort()},onFail:(m,S)=>{ye(this,Pn,rr).call(this,{type:"failed",failureCount:m,error:S})},onPause:()=>{ye(this,Pn,rr).call(this,{type:"pause"})},onContinue:()=>{ye(this,Pn,rr).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const m=await k(this,ft).start();if(m===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(m),(w=(h=k(this,mn).config).onSuccess)==null||w.call(h,m,this),(b=(x=k(this,mn).config).onSettled)==null||b.call(x,m,this.state.error,this),m}catch(m){if(m instanceof Rd){if(m.silent)return k(this,ft).promise;if(m.revert){if(this.state.data===void 0)throw m;return this.state.data}}throw ye(this,Pn,rr).call(this,{type:"error",error:m}),(v=(C=k(this,mn).config).onError)==null||v.call(C,m,this),(y=(g=k(this,mn).config).onSettled)==null||y.call(g,this.state.data,m,this),m}finally{this.scheduleGc()}}},xs=new WeakMap,yi=new WeakMap,mn=new WeakMap,ws=new WeakMap,ft=new WeakMap,Qo=new WeakMap,bs=new WeakMap,Pn=new WeakSet,rr=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...nx(r.data,this.options),fetchMeta:t.meta??null};case"success":const s={...r,...Gp(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return J(this,yi,t.manual?s:void 0),s;case"error":const i=t.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),ut.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),k(this,mn).notify({query:this,type:"updated",action:t})})},Rg);function nx(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Zy(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Gp(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Yp(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Kt,Me,Ko,Lt,Ss,xi,or,_r,qo,wi,bi,Cs,ks,Ar,Si,_e,co,Pd,Td,Id,Ld,_d,Ad,Fd,rx,Pg,Lb=(Pg=class extends Di{constructor(t,n){super();ue(this,_e);ue(this,Kt);ue(this,Me);ue(this,Ko);ue(this,Lt);ue(this,Ss);ue(this,xi);ue(this,or);ue(this,_r);ue(this,qo);ue(this,wi);ue(this,bi);ue(this,Cs);ue(this,ks);ue(this,Ar);ue(this,Si,new Set);this.options=n,J(this,Kt,t),J(this,_r,null),J(this,or,Md()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(k(this,Me).addObserver(this),Xp(k(this,Me),this.options)?ye(this,_e,co).call(this):this.updateResult(),ye(this,_e,Ld).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Od(k(this,Me),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Od(k(this,Me),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,ye(this,_e,_d).call(this),ye(this,_e,Ad).call(this),k(this,Me).removeObserver(this)}setOptions(t){const n=this.options,r=k(this,Me);if(this.options=k(this,Kt).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof gn(this.options.enabled,k(this,Me))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");ye(this,_e,Fd).call(this),k(this,Me).setOptions(this.options),n._defaulted&&!Oa(this.options,n)&&k(this,Kt).getQueryCache().notify({type:"observerOptionsUpdated",query:k(this,Me),observer:this});const s=this.hasListeners();s&&Jp(k(this,Me),r,this.options,n)&&ye(this,_e,co).call(this),this.updateResult(),s&&(k(this,Me)!==r||gn(this.options.enabled,k(this,Me))!==gn(n.enabled,k(this,Me))||Yr(this.options.staleTime,k(this,Me))!==Yr(n.staleTime,k(this,Me)))&&ye(this,_e,Pd).call(this);const i=ye(this,_e,Td).call(this);s&&(k(this,Me)!==r||gn(this.options.enabled,k(this,Me))!==gn(n.enabled,k(this,Me))||i!==k(this,Ar))&&ye(this,_e,Id).call(this,i)}getOptimisticResult(t){const n=k(this,Kt).getQueryCache().build(k(this,Kt),t),r=this.createResult(n,t);return Ab(this,r)&&(J(this,Lt,r),J(this,xi,this.options),J(this,Ss,k(this,Me).state)),r}getCurrentResult(){return k(this,Lt)}trackResult(t,n){return new Proxy(t,{get:(r,s)=>(this.trackProp(s),n==null||n(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&k(this,or).status==="pending"&&k(this,or).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(t){k(this,Si).add(t)}getCurrentQuery(){return k(this,Me)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=k(this,Kt).defaultQueryOptions(t),r=k(this,Kt).getQueryCache().build(k(this,Kt),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return ye(this,_e,co).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),k(this,Lt)))}createResult(t,n){var I;const r=k(this,Me),s=this.options,i=k(this,Lt),o=k(this,Ss),l=k(this,xi),d=t!==r?t.state:k(this,Ko),{state:f}=t;let p={...f},h=!1,w;if(n._optimisticResults){const P=this.hasListeners(),B=!P&&Xp(t,n),F=P&&Jp(t,r,n,s);(B||F)&&(p={...p,...nx(f.data,t.options)}),n._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:x,errorUpdatedAt:b,status:C}=p;w=p.data;let v=!1;if(n.placeholderData!==void 0&&w===void 0&&C==="pending"){let P;i!=null&&i.isPlaceholderData&&n.placeholderData===(l==null?void 0:l.placeholderData)?(P=i.data,v=!0):P=typeof n.placeholderData=="function"?n.placeholderData((I=k(this,bi))==null?void 0:I.state.data,k(this,bi)):n.placeholderData,P!==void 0&&(C="success",w=jd(i==null?void 0:i.data,P,n),h=!0)}if(n.select&&w!==void 0&&!v)if(i&&w===(o==null?void 0:o.data)&&n.select===k(this,qo))w=k(this,wi);else try{J(this,qo,n.select),w=n.select(w),w=jd(i==null?void 0:i.data,w,n),J(this,wi,w),J(this,_r,null)}catch(P){J(this,_r,P)}k(this,_r)&&(x=k(this,_r),w=k(this,wi),b=Date.now(),C="error");const g=p.fetchStatus==="fetching",y=C==="pending",m=C==="error",S=y&&g,E=w!==void 0,M={status:C,fetchStatus:p.fetchStatus,isPending:y,isSuccess:C==="success",isError:m,isInitialLoading:S,isLoading:S,data:w,dataUpdatedAt:p.dataUpdatedAt,error:x,errorUpdatedAt:b,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:g,isRefetching:g&&!y,isLoadingError:m&&!E,isPaused:p.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:m&&E,isStale:ih(t,n),refetch:this.refetch,promise:k(this,or),isEnabled:gn(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const P=K=>{M.status==="error"?K.reject(M.error):M.data!==void 0&&K.resolve(M.data)},B=()=>{const K=J(this,or,M.promise=Md());P(K)},F=k(this,or);switch(F.status){case"pending":t.queryHash===r.queryHash&&P(F);break;case"fulfilled":(M.status==="error"||M.data!==F.value)&&B();break;case"rejected":(M.status!=="error"||M.error!==F.reason)&&B();break}}return M}updateResult(){const t=k(this,Lt),n=this.createResult(k(this,Me),this.options);if(J(this,Ss,k(this,Me).state),J(this,xi,this.options),k(this,Ss).data!==void 0&&J(this,bi,k(this,Me)),Oa(n,t))return;J(this,Lt,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!k(this,Si).size)return!0;const o=new Set(i??k(this,Si));return this.options.throwOnError&&o.add("error"),Object.keys(k(this,Lt)).some(l=>{const c=l;return k(this,Lt)[c]!==t[c]&&o.has(c)})};ye(this,_e,rx).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&ye(this,_e,Ld).call(this)}},Kt=new WeakMap,Me=new WeakMap,Ko=new WeakMap,Lt=new WeakMap,Ss=new WeakMap,xi=new WeakMap,or=new WeakMap,_r=new WeakMap,qo=new WeakMap,wi=new WeakMap,bi=new WeakMap,Cs=new WeakMap,ks=new WeakMap,Ar=new WeakMap,Si=new WeakMap,_e=new WeakSet,co=function(t){ye(this,_e,Fd).call(this);let n=k(this,Me).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Ft)),n},Pd=function(){ye(this,_e,_d).call(this);const t=Yr(this.options.staleTime,k(this,Me));if(Ls||k(this,Lt).isStale||!Ed(t))return;const r=Gy(k(this,Lt).dataUpdatedAt,t)+1;J(this,Cs,fs.setTimeout(()=>{k(this,Lt).isStale||this.updateResult()},r))},Td=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(k(this,Me)):this.options.refetchInterval)??!1},Id=function(t){ye(this,_e,Ad).call(this),J(this,Ar,t),!(Ls||gn(this.options.enabled,k(this,Me))===!1||!Ed(k(this,Ar))||k(this,Ar)===0)&&J(this,ks,fs.setInterval(()=>{(this.options.refetchIntervalInBackground||sh.isFocused())&&ye(this,_e,co).call(this)},k(this,Ar)))},Ld=function(){ye(this,_e,Pd).call(this),ye(this,_e,Id).call(this,ye(this,_e,Td).call(this))},_d=function(){k(this,Cs)&&(fs.clearTimeout(k(this,Cs)),J(this,Cs,void 0))},Ad=function(){k(this,ks)&&(fs.clearInterval(k(this,ks)),J(this,ks,void 0))},Fd=function(){const t=k(this,Kt).getQueryCache().build(k(this,Kt),this.options);if(t===k(this,Me))return;const n=k(this,Me);J(this,Me,t),J(this,Ko,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},rx=function(t){ut.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(k(this,Lt))}),k(this,Kt).getQueryCache().notify({query:k(this,Me),type:"observerResultsUpdated"})})},Pg);function _b(e,t){return gn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Xp(e,t){return _b(e,t)||e.state.data!==void 0&&Od(e,t,t.refetchOnMount)}function Od(e,t,n){if(gn(t.enabled,e)!==!1&&Yr(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&ih(e,t)}return!1}function Jp(e,t,n,r){return(e!==t||gn(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&ih(e,n)}function ih(e,t){return gn(t.enabled,e)!==!1&&e.isStaleByTime(Yr(t.staleTime,e))}function Ab(e,t){return!Oa(e.getCurrentResult(),t)}function Zp(e){return{onFetch:(t,n)=>{var f,p,h,w,x;const r=t.options,s=(h=(p=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:p.fetchMore)==null?void 0:h.direction,i=((w=t.state.data)==null?void 0:w.pages)||[],o=((x=t.state.data)==null?void 0:x.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let b=!1;const C=y=>{Nb(y,()=>t.signal,()=>b=!0)},v=Xy(t.options,t.fetchOptions),g=async(y,m,S)=>{if(b)return Promise.reject();if(m==null&&y.pages.length)return Promise.resolve(y);const j=(()=>{const B={client:t.client,queryKey:t.queryKey,pageParam:m,direction:S?"backward":"forward",meta:t.options.meta};return C(B),B})(),M=await v(j),{maxPages:I}=t.options,P=S?Eb:kb;return{pages:P(y.pages,M,I),pageParams:P(y.pageParams,m,I)}};if(s&&i.length){const y=s==="backward",m=y?Fb:em,S={pages:i,pageParams:o},E=m(r,S);l=await g(S,E,y)}else{const y=e??i.length;do{const m=c===0?o[0]??r.initialPageParam:em(r,l);if(c>0&&m==null)break;l=await g(l,m),c++}while(c<y)}return l};t.options.persister?t.fetchFn=()=>{var b,C;return(C=(b=t.options).persister)==null?void 0:C.call(b,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=d}}}function em(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function Fb(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var Go,Qn,_t,Es,Kn,Nr,Tg,Ob=(Tg=class extends tx{constructor(t){super();ue(this,Kn);ue(this,Go);ue(this,Qn);ue(this,_t);ue(this,Es);J(this,Go,t.client),this.mutationId=t.mutationId,J(this,_t,t.mutationCache),J(this,Qn,[]),this.state=t.state||sx(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){k(this,Qn).includes(t)||(k(this,Qn).push(t),this.clearGcTimeout(),k(this,_t).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){J(this,Qn,k(this,Qn).filter(n=>n!==t)),this.scheduleGc(),k(this,_t).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){k(this,Qn).length||(this.state.status==="pending"?this.scheduleGc():k(this,_t).remove(this))}continue(){var t;return((t=k(this,Es))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,c,d,f,p,h,w,x,b,C,v,g,y,m,S,E,j,M,I;const n=()=>{ye(this,Kn,Nr).call(this,{type:"continue"})},r={client:k(this,Go),meta:this.options.meta,mutationKey:this.options.mutationKey};J(this,Es,ex({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(P,B)=>{ye(this,Kn,Nr).call(this,{type:"failed",failureCount:P,error:B})},onPause:()=>{ye(this,Kn,Nr).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>k(this,_t).canRun(this)}));const s=this.state.status==="pending",i=!k(this,Es).canStart();try{if(s)n();else{ye(this,Kn,Nr).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(o=k(this,_t).config).onMutate)==null?void 0:l.call(o,t,this,r));const B=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t,r));B!==this.state.context&&ye(this,Kn,Nr).call(this,{type:"pending",context:B,variables:t,isPaused:i})}const P=await k(this,Es).start();return await((p=(f=k(this,_t).config).onSuccess)==null?void 0:p.call(f,P,t,this.state.context,this,r)),await((w=(h=this.options).onSuccess)==null?void 0:w.call(h,P,t,this.state.context,r)),await((b=(x=k(this,_t).config).onSettled)==null?void 0:b.call(x,P,null,this.state.variables,this.state.context,this,r)),await((v=(C=this.options).onSettled)==null?void 0:v.call(C,P,null,t,this.state.context,r)),ye(this,Kn,Nr).call(this,{type:"success",data:P}),P}catch(P){try{await((y=(g=k(this,_t).config).onError)==null?void 0:y.call(g,P,t,this.state.context,this,r))}catch(B){Promise.reject(B)}try{await((S=(m=this.options).onError)==null?void 0:S.call(m,P,t,this.state.context,r))}catch(B){Promise.reject(B)}try{await((j=(E=k(this,_t).config).onSettled)==null?void 0:j.call(E,void 0,P,this.state.variables,this.state.context,this,r))}catch(B){Promise.reject(B)}try{await((I=(M=this.options).onSettled)==null?void 0:I.call(M,void 0,P,t,this.state.context,r))}catch(B){Promise.reject(B)}throw ye(this,Kn,Nr).call(this,{type:"error",error:P}),P}finally{k(this,_t).runNext(this)}}},Go=new WeakMap,Qn=new WeakMap,_t=new WeakMap,Es=new WeakMap,Kn=new WeakSet,Nr=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),ut.batch(()=>{k(this,Qn).forEach(r=>{r.onMutationUpdate(t)}),k(this,_t).notify({mutation:this,type:"updated",action:t})})},Tg);function sx(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var lr,Tn,Yo,Ig,Db=(Ig=class extends Di{constructor(t={}){super();ue(this,lr);ue(this,Tn);ue(this,Yo);this.config=t,J(this,lr,new Set),J(this,Tn,new Map),J(this,Yo,0)}build(t,n,r){const s=new Ob({client:t,mutationCache:this,mutationId:++ml(this,Yo)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){k(this,lr).add(t);const n=Ll(t);if(typeof n=="string"){const r=k(this,Tn).get(n);r?r.push(t):k(this,Tn).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(k(this,lr).delete(t)){const n=Ll(t);if(typeof n=="string"){const r=k(this,Tn).get(n);if(r)if(r.length>1){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}else r[0]===t&&k(this,Tn).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Ll(t);if(typeof n=="string"){const r=k(this,Tn).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var r;const n=Ll(t);if(typeof n=="string"){const s=(r=k(this,Tn).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){ut.batch(()=>{k(this,lr).forEach(t=>{this.notify({type:"removed",mutation:t})}),k(this,lr).clear(),k(this,Tn).clear()})}getAll(){return Array.from(k(this,lr))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Qp(n,r))}findAll(t={}){return this.getAll().filter(n=>Qp(t,n))}notify(t){ut.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return ut.batch(()=>Promise.all(t.map(n=>n.continue().catch(Ft))))}},lr=new WeakMap,Tn=new WeakMap,Yo=new WeakMap,Ig);function Ll(e){var t;return(t=e.options.scope)==null?void 0:t.id}var ar,Fr,qt,ur,pr,ia,Dd,Lg,zb=(Lg=class extends Di{constructor(n,r){super();ue(this,pr);ue(this,ar);ue(this,Fr);ue(this,qt);ue(this,ur);J(this,ar,n),this.setOptions(r),this.bindMethods(),ye(this,pr,ia).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var s;const r=this.options;this.options=k(this,ar).defaultMutationOptions(n),Oa(this.options,r)||k(this,ar).getMutationCache().notify({type:"observerOptionsUpdated",mutation:k(this,qt),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&_s(r.mutationKey)!==_s(this.options.mutationKey)?this.reset():((s=k(this,qt))==null?void 0:s.state.status)==="pending"&&k(this,qt).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=k(this,qt))==null||n.removeObserver(this)}onMutationUpdate(n){ye(this,pr,ia).call(this),ye(this,pr,Dd).call(this,n)}getCurrentResult(){return k(this,Fr)}reset(){var n;(n=k(this,qt))==null||n.removeObserver(this),J(this,qt,void 0),ye(this,pr,ia).call(this),ye(this,pr,Dd).call(this)}mutate(n,r){var s;return J(this,ur,r),(s=k(this,qt))==null||s.removeObserver(this),J(this,qt,k(this,ar).getMutationCache().build(k(this,ar),this.options)),k(this,qt).addObserver(this),k(this,qt).execute(n)}},ar=new WeakMap,Fr=new WeakMap,qt=new WeakMap,ur=new WeakMap,pr=new WeakSet,ia=function(){var r;const n=((r=k(this,qt))==null?void 0:r.state)??sx();J(this,Fr,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Dd=function(n){ut.batch(()=>{var r,s,i,o,l,c,d,f;if(k(this,ur)&&this.hasListeners()){const p=k(this,Fr).variables,h=k(this,Fr).context,w={client:k(this,ar),meta:this.options.meta,mutationKey:this.options.mutationKey};if((n==null?void 0:n.type)==="success"){try{(s=(r=k(this,ur)).onSuccess)==null||s.call(r,n.data,p,h,w)}catch(x){Promise.reject(x)}try{(o=(i=k(this,ur)).onSettled)==null||o.call(i,n.data,null,p,h,w)}catch(x){Promise.reject(x)}}else if((n==null?void 0:n.type)==="error"){try{(c=(l=k(this,ur)).onError)==null||c.call(l,n.error,p,h,w)}catch(x){Promise.reject(x)}try{(f=(d=k(this,ur)).onSettled)==null||f.call(d,void 0,n.error,p,h,w)}catch(x){Promise.reject(x)}}}this.listeners.forEach(p=>{p(k(this,Fr))})})},Lg),qn,_g,$b=(_g=class extends Di{constructor(t={}){super();ue(this,qn);this.config=t,J(this,qn,new Map)}build(t,n,r){const s=n.queryKey,i=n.queryHash??nh(s,n);let o=this.get(i);return o||(o=new Ib({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){k(this,qn).has(t.queryHash)||(k(this,qn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=k(this,qn).get(t.queryHash);n&&(t.destroy(),n===t&&k(this,qn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ut.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return k(this,qn).get(t)}getAll(){return[...k(this,qn).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Hp(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>Hp(t,r)):n}notify(t){ut.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){ut.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ut.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},qn=new WeakMap,_g),Xe,Or,Dr,Ci,ki,zr,Ei,Ni,Ag,Bb=(Ag=class{constructor(e={}){ue(this,Xe);ue(this,Or);ue(this,Dr);ue(this,Ci);ue(this,ki);ue(this,zr);ue(this,Ei);ue(this,Ni);J(this,Xe,e.queryCache||new $b),J(this,Or,e.mutationCache||new Db),J(this,Dr,e.defaultOptions||{}),J(this,Ci,new Map),J(this,ki,new Map),J(this,zr,0)}mount(){ml(this,zr)._++,k(this,zr)===1&&(J(this,Ei,sh.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,Xe).onFocus())})),J(this,Ni,Da.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,Xe).onOnline())})))}unmount(){var e,t;ml(this,zr)._--,k(this,zr)===0&&((e=k(this,Ei))==null||e.call(this),J(this,Ei,void 0),(t=k(this,Ni))==null||t.call(this),J(this,Ni,void 0))}isFetching(e){return k(this,Xe).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return k(this,Or).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,Xe).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=k(this,Xe).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Yr(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return k(this,Xe).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=k(this,Xe).get(r.queryHash),i=s==null?void 0:s.state.data,o=bb(t,i);if(o!==void 0)return k(this,Xe).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return ut.batch(()=>k(this,Xe).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,Xe).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=k(this,Xe);ut.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=k(this,Xe);return ut.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=ut.batch(()=>k(this,Xe).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(Ft).catch(Ft)}invalidateQueries(e,t={}){return ut.batch(()=>(k(this,Xe).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=ut.batch(()=>k(this,Xe).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(Ft)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Ft)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=k(this,Xe).build(this,t);return n.isStaleByTime(Yr(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ft).catch(Ft)}fetchInfiniteQuery(e){return e.behavior=Zp(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ft).catch(Ft)}ensureInfiniteQueryData(e){return e.behavior=Zp(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Da.isOnline()?k(this,Or).resumePausedMutations():Promise.resolve()}getQueryCache(){return k(this,Xe)}getMutationCache(){return k(this,Or)}getDefaultOptions(){return k(this,Dr)}setDefaultOptions(e){J(this,Dr,e)}setQueryDefaults(e,t){k(this,Ci).set(_s(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...k(this,Ci).values()],n={};return t.forEach(r=>{Uo(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){k(this,ki).set(_s(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...k(this,ki).values()],n={};return t.forEach(r=>{Uo(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...k(this,Dr).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=nh(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===rh&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...k(this,Dr).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){k(this,Xe).clear(),k(this,Or).clear()}},Xe=new WeakMap,Or=new WeakMap,Dr=new WeakMap,Ci=new WeakMap,ki=new WeakMap,zr=new WeakMap,Ei=new WeakMap,Ni=new WeakMap,Ag),ix=u.createContext(void 0),wr=e=>{const t=u.useContext(ix);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Ub=({client:e,children:t})=>(u.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(ix.Provider,{value:e,children:t})),ox=u.createContext(!1),Vb=()=>u.useContext(ox);ox.Provider;function Wb(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Hb=u.createContext(Wb()),Qb=()=>u.useContext(Hb),Kb=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},qb=e=>{u.useEffect(()=>{e.clearReset()},[e])},Gb=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||Jy(n,[e.error,r])),Yb=e=>{if(e.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Xb=(e,t)=>e.isLoading&&e.isFetching&&!t,Jb=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,tm=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function Zb(e,t,n){var p,h,w,x,b;const r=Vb(),s=Qb(),i=wr(),o=i.defaultQueryOptions(e);(h=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||h.call(p,o),o._optimisticResults=r?"isRestoring":"optimistic",Yb(o),Kb(o,s),qb(s);const l=!i.getQueryCache().get(o.queryHash),[c]=u.useState(()=>new t(i,o)),d=c.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(u.useSyncExternalStore(u.useCallback(C=>{const v=f?c.subscribe(ut.batchCalls(C)):Ft;return c.updateResult(),v},[c,f]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),u.useEffect(()=>{c.setOptions(o)},[o,c]),Jb(o,d))throw tm(o,c,s);if(Gb({result:d,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((x=(w=i.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||x.call(w,o,d),o.experimental_prefetchInRender&&!Ls&&Xb(d,r)){const C=l?tm(o,c,s):(b=i.getQueryCache().get(o.queryHash))==null?void 0:b.promise;C==null||C.catch(Ft).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?d:c.trackResult(d)}function hu(e,t){return Zb(e,Lb)}function eS(e,t){const n=wr(),[r]=u.useState(()=>new zb(n,e));u.useEffect(()=>{r.setOptions(e)},[r,e]);const s=u.useSyncExternalStore(u.useCallback(o=>r.subscribe(ut.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=u.useCallback((o,l)=>{r.mutate(o,l).catch(Ft)},[r]);if(s.error&&Jy(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}const lx=8,tS=6;function nm(e,t,n){return n<t?t:Math.min(n,Math.max(t,e))}function ax({x:e,y:t,menuWidth:n,menuHeight:r,viewport:s,margin:i=lx}){const o=i,l=i,c=s.width-Math.max(0,n)-i,d=s.height-Math.max(0,r)-i;return{x:nm(e,o,c),y:nm(t,l,d)}}function nS({anchorRect:e,menuSize:t,viewport:n,align:r="left",margin:s=lx,sideOffset:i=tS}){const o=r==="right"?e.right-t.width:e.left,l=e.bottom+i,c=e.top-t.height-i,d=l+t.height+s<=n.height,f=c>=s;return ax({x:o,y:!d&&f?c:l,menuWidth:t.width,menuHeight:t.height,viewport:n,margin:s})}function ux(){return typeof window>"u"?{width:1024,height:768}:{width:window.innerWidth,height:window.innerHeight}}function rm(e){return e.length>0&&"options"in e[0]}function sm(){return{x:0,y:0,ready:!1}}function oh({value:e,onChange:t,options:n,placeholder:r="Select...",trigger:s,triggerClassName:i="",panelClassName:o="",align:l="left",width:c="auto",showChevron:d=!0,title:f,disabled:p=!1,"aria-label":h}){var K,Z;const[w,x]=u.useState(!1),b=u.useRef(null),C=u.useRef(null),v=u.useRef(null),[g,y]=u.useState(sm),S=u.useCallback(()=>{const z=L=>{const R=L.find(T=>T.value===e);return R?R.label:null};if(rm(n))for(const L of n){const R=z(L.options);if(R)return R}else{const L=z(n);if(L)return L}return r},[e,n,r])(),E=((K=b.current)==null?void 0:K.getBoundingClientRect().width)??((Z=C.current)==null?void 0:Z.offsetWidth)??0,j=c==="trigger"?E:c==="auto"?void 0:c,M=u.useCallback(()=>{if(!w)return;const z=b.current,L=v.current;if(!z||!L)return;const R=z.getBoundingClientRect(),T=L.getBoundingClientRect(),A=j??T.width??180,O=T.height||L.scrollHeight||1,H=nS({anchorRect:R,menuSize:{width:A,height:O},viewport:ux(),align:l});y(U=>U.x===H.x&&U.y===H.y&&U.ready?U:{x:H.x,y:H.y,ready:!0})},[l,j,w]);u.useLayoutEffect(()=>{if(!w){y(sm());return}M()},[w,M,n,e]),u.useEffect(()=>{if(!w)return;const z=T=>{var O,H;const A=T.target;(O=b.current)!=null&&O.contains(A)||(H=v.current)!=null&&H.contains(A)||x(!1)},L=T=>{var A;T.key==="Escape"&&(x(!1),(A=C.current)==null||A.focus())},R=()=>M();return window.addEventListener("click",z),window.addEventListener("keydown",L),window.addEventListener("resize",R),window.addEventListener("scroll",R,!0),()=>{window.removeEventListener("click",z),window.removeEventListener("keydown",L),window.removeEventListener("resize",R),window.removeEventListener("scroll",R,!0)}},[w,M]);const I=z=>{var L;t(z),x(!1),(L=C.current)==null||L.focus()},P=z=>z.map(L=>a.jsxs("button",{className:"dropdown-item","data-active":L.value===e,disabled:L.disabled,onClick:()=>!L.disabled&&I(L.value),role:"menuitem",children:[L.icon&&a.jsx("span",{className:"shrink-0",children:L.icon}),a.jsx("span",{className:"flex-1 truncate",children:L.label}),L.value===e&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0 text-accent",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})]},L.value)),B=u.useMemo(()=>({position:"fixed",left:g.x,top:g.y,visibility:g.ready?"visible":"hidden",...j?{width:j,minWidth:j}:{}}),[j,g]),F=w?a.jsx("div",{ref:v,className:`dropdown-panel ${o}`,style:B,role:"listbox","aria-label":h,children:rm(n)?n.map((z,L)=>a.jsxs("div",{children:[z.label&&a.jsx("div",{className:"dropdown-label",children:z.label}),P(z.options),L<n.length-1&&a.jsx("div",{className:"dropdown-divider"})]},z.label||L)):P(n)}):null;return a.jsxs("div",{ref:b,className:"relative",children:[s?a.jsx("div",{onClick:()=>!p&&x(z=>!z),children:s}):a.jsxs("button",{ref:C,type:"button",className:`dropdown-trigger ${i}`,onClick:()=>x(z=>!z),disabled:p,title:f,"aria-label":h,"aria-haspopup":"listbox","aria-expanded":w,children:[a.jsx("span",{className:"truncate",children:S}),d&&a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`shrink-0 opacity-60 transition-transform ${w?"rotate-180":""}`,children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),F&&typeof document<"u"?fu.createPortal(F,document.body):F]})}const rS={offline:"sync-dot-offline",unstable:"sync-dot-unstable",recent:"sync-dot-recent",editing:"sync-dot-editing",live:"sync-dot-live"};function sS({state:e,presence:t,syncLabel:n,connectionLabel:r,lastEditedLabel:s,hasEdits:i,localTypingActive:o,recentTouches:l,isNarrow:c}){const[d,f]=u.useState(!1),[p,h]=u.useState(null),w=u.useRef(null),x=u.useRef(null),b=u.useRef(null),C=t?`${t.viewing} viewing  ${t.editing} editing`:"- viewing  - editing",v=t?String(t.viewing):"-",g=u.useCallback(()=>{b.current&&(window.clearTimeout(b.current),b.current=null)},[]),y=u.useCallback((S,E)=>{var j;E&&((j=navigator.clipboard)==null||j.writeText(E).then(()=>{h(S),g(),b.current=window.setTimeout(()=>{h(M=>M===S?null:M)},1e3)}).catch(()=>{}))},[g]),m=u.useCallback(()=>{f(!1),window.requestAnimationFrame(()=>{var S;return(S=x.current)==null?void 0:S.focus()})},[]);return u.useEffect(()=>{if(!d)return;const S=j=>{!w.current||w.current.contains(j.target)||m()},E=j=>{j.key==="Escape"&&m()};return window.addEventListener("mousedown",S),window.addEventListener("keydown",E),()=>{window.removeEventListener("mousedown",S),window.removeEventListener("keydown",E)}},[d,m]),u.useEffect(()=>()=>{g()},[g]),a.jsxs("div",{ref:w,className:"sync-indicator",children:[a.jsxs("button",{ref:x,type:"button",className:"sync-indicator-button",onClick:()=>d?m():f(!0),"aria-haspopup":"dialog","aria-expanded":d,"aria-label":"Sync status",title:C,children:[a.jsx("span",{className:`sync-indicator-dot ${rS[e]}`,"aria-hidden":"true"}),!c&&a.jsx("span",{className:"sync-indicator-count tabular-nums",children:v}),!c&&o&&a.jsx("span",{className:"sync-indicator-local",children:"typing"})]}),d&&a.jsxs("div",{role:"dialog","aria-label":"Sync status",className:"sync-indicator-card select-text",children:[a.jsx("div",{className:"sync-indicator-line sync-indicator-primary",children:n}),a.jsx("div",{className:"sync-indicator-line",children:r}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:C}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:i?`Last edited: ${s}`:"No edits yet."}),o&&a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:"Local typing in progress (saved on blur)."}),a.jsxs("div",{className:"sync-indicator-section",children:[a.jsx("div",{className:"sync-indicator-section-title",children:"Recently touched files"}),l.length>0?a.jsx("div",{className:"sync-indicator-list",children:l.map(S=>a.jsxs("div",{className:"sync-indicator-item",children:[a.jsx("button",{type:"button",className:"sync-indicator-item-name",title:`Copy filename: ${S.label}`,onClick:()=>y(S.path,S.label),children:S.label}),a.jsx("span",{className:"sync-indicator-item-time tabular-nums",children:p===S.path?"Copied":S.timeLabel})]},S.path))}):a.jsx("div",{className:"sync-indicator-empty",children:"No recent touches."})]})]})]})}const Xr={phoneMax:480,mobileMax:767,narrowMax:900,tabletMax:1024,mediumMax:1180},oa={phone:`(max-width: ${Xr.phoneMax}px)`,narrow:`(max-width: ${Xr.narrowMax}px)`,toolbarCompact:`(max-width: ${Xr.mediumMax}px)`},im=200,om=240,iS=320,oS=360,lS=420;function lm(e,t,n){return Math.min(Math.max(e,t),n)}function aS(e){return e<=Xr.tabletMax?iS:e<=Xr.mediumMax?oS:lS}function uS(e){return e<=Xr.tabletMax?360:e<=Xr.mediumMax?420:520}function cS({viewportWidth:e,leftOpen:t,rightOpen:n,leftWidth:r,rightWidth:s}){const i=aS(e);let o=t?lm(r,im,i):0,l=n?lm(s,om,i):0;const c=Math.max(0,e-uS(e));if(o+l>c){let d=o+l-c;if(l>0){const f=Math.max(0,l-om),p=Math.min(f,d);l-=p,d-=p}if(d>0&&o>0){const f=Math.max(0,o-im),p=Math.min(f,d);o-=p,d-=p}d>0&&l>0&&(l=Math.max(0,c-o)),o+l>c&&(o=Math.max(0,c-l))}return{leftWidth:Number(o.toFixed(2)),rightWidth:Number(l.toFixed(2))}}function la(e,t=!1){const[n,r]=u.useState(t);return u.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;const s=window.matchMedia(e),i=s,o=()=>r(s.matches);if(o(),typeof s.addEventListener=="function")return s.addEventListener("change",o),()=>s.removeEventListener("change",o);if(typeof i.addListener=="function"&&typeof i.removeListener=="function")return i.addListener(o),()=>{var l;return(l=i.removeListener)==null?void 0:l.call(i,o)}},[e]),n}function cx({isRandom:e,dir:t}){return e?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),a.jsx("path",{d:"M21 3v5h-5"})]}):t==="desc"?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 5v14"}),a.jsx("path",{d:"M19 12l-7 7-7-7"})]}):a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 19V5"}),a.jsx("path",{d:"M5 12l7-7 7 7"})]})}function dS({viewerActive:e,filtersOpen:t,filtersRef:n,totalFilterCount:r,filterCount:s,starFilterList:i,starCounts:o,onToggleFilters:l,onOpenFilters:c,onToggleStar:d,onClearFilters:f,onClearStars:p}){return a.jsxs("div",{ref:n,className:`toolbar-filter relative ${e?"opacity-40 pointer-events-none":""}`,children:[a.jsxs("button",{className:`btn ${r>0?"btn-active":""}`,onClick:l,"aria-haspopup":"dialog","aria-expanded":t,title:"Filters","aria-disabled":e,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),a.jsx("span",{className:"toolbar-filters-label",children:"Filters"}),r>0&&a.jsx("span",{className:"toolbar-filters-count px-1.5 py-0.5 text-[11px] rounded-full bg-accent-strong text-text",children:r})]}),t&&a.jsxs("div",{role:"dialog","aria-label":"Filters",className:"dropdown-panel w-[240px]",style:{top:"38px",left:0},children:[a.jsx("div",{className:"dropdown-label",children:"Rating"}),a.jsxs("div",{className:"px-1",children:[[5,4,3,2,1].map(h=>{const w=i.includes(h),x=(o==null?void 0:o[String(h)])??0;return a.jsxs("button",{onClick:()=>d==null?void 0:d(h),className:`dropdown-item justify-between ${w?"bg-accent-muted":""}`,children:[a.jsxs("span",{className:w?"text-star-active":"text-text",children:["".repeat(h),"".repeat(5-h)]}),a.jsx("span",{className:"text-xs text-muted",children:x})]},h)}),a.jsxs("button",{onClick:()=>d==null?void 0:d(0),className:`dropdown-item justify-between ${i.includes(0)?"bg-accent-muted":""}`,children:[a.jsx("span",{className:"text-text",children:"Unrated"}),a.jsx("span",{className:"text-xs text-muted",children:(o==null?void 0:o["0"])??0})]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("div",{className:"dropdown-label",children:"Metrics"}),a.jsxs("button",{className:"dropdown-item",onClick:()=>{l(),c==null||c()},children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]}),a.jsx("span",{children:"Open Metrics Panel"}),(s||0)>0&&a.jsxs("span",{className:"ml-auto text-xs text-muted",children:[s," active"]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("button",{className:"dropdown-item text-muted hover:text-text",onClick:()=>{f?f():p==null||p()},disabled:r===0,children:"Clear all filters"})]})]})}function fS({viewMode:e,currentSort:t,sortOnlyOptions:n,sortDisabled:r,sortControlsDisabled:s,sortDir:i,isRandom:o,showSelectModeToggle:l,multiSelectMode:c,selectModeLabel:d,uploadBusy:f,uploadDisabled:p,onViewMode:h,onSortChange:w,onToggleSortDir:x,onToggleMultiSelectMode:b,onUploadClick:C}){return a.jsx("div",{className:"mobile-drawer",children:a.jsxs("div",{className:"mobile-drawer-row",children:[a.jsxs("div",{className:"mobile-pill-group",children:[a.jsx("button",{className:`mobile-pill ${e==="grid"?"is-active":""}`,onClick:()=>h==null?void 0:h("grid"),"aria-pressed":e==="grid",children:"Grid"}),a.jsx("button",{className:`mobile-pill ${e==="adaptive"?"is-active":""}`,onClick:()=>h==null?void 0:h("adaptive"),"aria-pressed":e==="adaptive",children:"Masonry"})]}),a.jsx(oh,{value:t,onChange:v=>w==null?void 0:w(v),options:n,"aria-label":"Sort",triggerClassName:"mobile-pill mobile-pill-dropdown",panelClassName:"mobile-drawer-panel",disabled:r}),a.jsx("button",{className:`mobile-pill mobile-pill-icon ${s?"opacity-50 cursor-not-allowed":""}`,onClick:x,title:r?"Sorting disabled":o?"Shuffle":`Sort ${i==="desc"?"descending":"ascending"}`,"aria-label":o?"Shuffle":"Toggle sort direction","aria-disabled":s,disabled:s,children:a.jsx(cx,{isRandom:o,dir:i})}),l&&a.jsx("button",{className:`mobile-pill ${c?"is-active":""}`,onClick:()=>b==null?void 0:b(),"aria-pressed":c,title:c?"Exit select mode":"Enter select mode",children:d}),C&&a.jsx("button",{className:`mobile-pill ${p||f?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!p&&!f&&C(),disabled:p||f,children:f?"Uploading":"Upload"})]})})}function hS({rootRef:e,onSearch:t,viewerActive:n,onBack:r,zoomPercent:s,onZoomPercentChange:i,currentLabel:o,itemCount:l,totalCount:c,sortSpec:d,metricKeys:f,onSortChange:p,sortDisabled:h=!1,filterCount:w,onOpenFilters:x,starFilters:b,onToggleStar:C,onClearStars:v,onClearFilters:g,starCounts:y,viewMode:m,onViewMode:S,gridItemSize:E,onGridItemSize:j,leftOpen:M,rightOpen:I,onToggleLeft:P,onToggleRight:B,onPrevImage:F,onNextImage:K,canPrevImage:Z,canNextImage:z,searchDisabled:L=!1,searchPlaceholder:R,onUploadClick:T,uploadBusy:A=!1,uploadDisabled:O=!1,multiSelectMode:H=!1,selectedCount:U=0,onToggleMultiSelectMode:_,syncIndicator:Q}){const[V,ee]=u.useState(!1),[ie,q]=u.useState(!1),G=u.useRef(null),X=u.useRef(null),ce=la(oa.narrow),Ee=la(oa.phone),Se=la(oa.toolbarCompact);u.useEffect(()=>{if(!V)return;const Ce=rt=>{G.current&&!G.current.contains(rt.target)&&ee(!1)};return window.addEventListener("click",Ce),()=>window.removeEventListener("click",Ce)},[V]),u.useEffect(()=>{if(L){q(!1);return}if(!ce||n){q(!1);return}if(!ie)return;const Ce=window.requestAnimationFrame(()=>{var rt;return(rt=X.current)==null?void 0:rt.focus()});return()=>window.cancelAnimationFrame(Ce)},[ce,ie,n,L]);const he=d??{kind:"builtin",key:"added",dir:"desc"},Fe=he.dir,Ze=he.kind==="builtin"&&he.key==="random",$t=n||h,Bt=f!=null&&f.length?f.map(Ce=>({value:`metric:${Ce}`,label:Ce,disabled:h})):[],dn=[{value:"builtin:added",label:"Date added",disabled:h},{value:"builtin:name",label:"Filename",disabled:h},{value:"builtin:random",label:"Random",disabled:h},...Bt],Dn=[{label:"Layout",options:[{value:"layout:grid",label:"Grid"},{value:"layout:masonry",label:"Masonry"}]},{label:"Sort by",options:dn}],en=he.kind==="metric"?`metric:${he.key}`:`builtin:${he.key}`,oe=[{label:"Sort by",options:dn}],re=ce&&!n,Ie=!(!!n&&Se),ge=!!n&&!Ee,fe=re&&!!_,nt=H?U>0?`Done (${U})`:"Done":"Select",Ke=Ce=>{if(Ce.startsWith("layout:")){const rt=Ce==="layout:masonry"?"adaptive":"grid";S==null||S(rt)}else{if(h)return;p==null||p(am(Ce,he))}},bt=()=>{!p||h||p(Ze?he:{...he,dir:Fe==="desc"?"asc":"desc"})},qe=b??[],tn=qe.length,br=mS(w,tn),kn=pS(l,c),zn=o||"Root";return a.jsxs("div",{ref:e,className:`toolbar-shell ${n?"toolbar-shell-viewer":""} ${Ee?"toolbar-shell-phone":""} ${Se?"toolbar-shell-compact":""} fixed top-0 left-0 right-0 h-12 grid grid-cols-[minmax(0,1fr)_minmax(0,1fr)_auto] items-center px-3 gap-3 bg-panel border-b border-border z-[var(--z-toolbar)] col-span-full row-start-1 select-none`,children:[a.jsxs("div",{className:"toolbar-left flex items-center gap-4 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope flex items-center gap-3 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope-text flex flex-col min-w-0 leading-tight",children:[a.jsx("span",{className:"toolbar-scope-label text-[10px] uppercase tracking-widest text-muted",children:"Scope"}),a.jsx("span",{className:"text-sm font-medium text-text truncate",title:zn,children:zn})]}),kn&&a.jsx("span",{className:"toolbar-count text-xs text-muted whitespace-nowrap tabular-nums",children:kn})]}),n&&a.jsxs("button",{className:"toolbar-back-btn btn btn-sm",onClick:r,title:"Back to grid",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]}),Ie&&a.jsxs("div",{className:"toolbar-sort flex items-center gap-2",children:[a.jsxs("div",{className:`toolbar-sort-controls flex items-center gap-2 ${n?"opacity-40 pointer-events-none":""}`,children:[a.jsx(oh,{value:en,onChange:Ke,options:Dn,title:"Sort and layout options","aria-label":"Sort and layout",triggerClassName:"min-w-[110px]"}),a.jsx("button",{className:"toolbar-sort-dir btn btn-icon",onClick:bt,title:h?"Sorting disabled":Ze?"Shuffle":`Sort ${Fe==="desc"?"descending":"ascending"}`,"aria-label":Ze?"Shuffle":"Toggle sort direction","aria-disabled":$t,disabled:$t,children:a.jsx(cx,{isRandom:Ze,dir:Fe})})]}),a.jsx(dS,{viewerActive:!!n,filtersOpen:V,filtersRef:G,totalFilterCount:br,filterCount:w,starFilterList:qe,starCounts:y,onToggleFilters:()=>ee(Ce=>!Ce),onOpenFilters:x,onToggleStar:C,onClearFilters:g,onClearStars:v})]})]}),a.jsx("div",{className:"toolbar-center flex items-center gap-3 justify-center min-w-0",children:n?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"range",min:5,max:800,step:1,value:Math.round(Math.max(5,Math.min(800,s??100))),onChange:Ce=>i==null?void 0:i(Number(Ce.target.value)),className:"zoom-slider","aria-label":"Zoom level"}),a.jsxs("span",{className:"text-xs text-muted min-w-[42px] text-right",children:[Math.round(s??100),"%"]})]}):j&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-muted",children:"Size"}),a.jsx("input",{type:"range",min:80,max:500,step:10,value:E??220,onChange:Ce=>j(Number(Ce.target.value)),className:"w-28 h-1.5 bg-border rounded-full appearance-none cursor-pointer hover:bg-hover transition-colors [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-text [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-text [&::-moz-range-thumb]:border-0","aria-label":"Thumbnail size"})]})}),a.jsxs("div",{className:"toolbar-right flex items-center gap-2 justify-end",children:[ge&&a.jsxs("div",{className:"toolbar-nav flex items-center gap-1 mr-1",children:[a.jsx("button",{className:`btn btn-icon ${Z?"":"opacity-40 cursor-not-allowed"}`,title:"Previous image (A / )",onClick:()=>Z&&(F==null?void 0:F()),"aria-label":"Previous image","aria-disabled":!Z,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("button",{className:`btn btn-icon ${z?"":"opacity-40 cursor-not-allowed"}`,title:"Next image (D / )",onClick:()=>z&&(K==null?void 0:K()),"aria-label":"Next image","aria-disabled":!z,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 6l6 6-6 6"})})})]}),a.jsxs("div",{className:"toolbar-panels flex items-center gap-1",children:[a.jsx("button",{className:`btn btn-icon ${M?"":"opacity-50"}`,title:M?"Hide left panel (Ctrl+B)":"Show left panel (Ctrl+B)",onClick:P,"aria-pressed":M,"aria-label":"Toggle left panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"11",y:"5",width:"10",height:"14",rx:"1.5"})]})}),a.jsx("button",{className:`btn btn-icon ${I?"":"opacity-50"}`,title:I?"Hide right panel (Ctrl+Alt+B)":"Show right panel (Ctrl+Alt+B)",onClick:B,"aria-pressed":I,"aria-label":"Toggle right panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"15",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"3",y:"5",width:"10",height:"14",rx:"1.5"})]})})]}),!n&&T&&a.jsxs("button",{className:`btn ${O?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!O&&T(),"aria-label":"Upload images",title:A?"Uploading":"Upload images","aria-disabled":O||A,disabled:O||A,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M12 16V5"}),a.jsx("path",{d:"M7 10l5-5 5 5"}),a.jsx("path",{d:"M4 19h16"})]}),a.jsx("span",{children:A?"Uploading":"Upload"})]}),Q&&a.jsx(sS,{...Q,isNarrow:ce||Se}),!n&&ce&&a.jsx("button",{className:`btn btn-icon ${ie?"btn-active":""} ${L?"opacity-50 cursor-not-allowed":""}`,"aria-label":ie?"Close search":"Open search",title:L?"Search disabled":ie?"Close search":"Search",onClick:()=>!L&&q(Ce=>!Ce),disabled:L,children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"11",cy:"11",r:"7"}),a.jsx("path",{d:"M21 21l-4.35-4.35"})]})}),!n&&!ce?a.jsx("div",{className:"toolbar-search toolbar-search-desktop w-[240px]",children:a.jsx("input",{ref:X,"aria-label":"Search filename, tags, notes",placeholder:L?R??"Search disabled":"Search...",onChange:Ce=>t(Ce.target.value),className:"toolbar-search-input input w-full focus:w-full transition-all duration-200 select-text",disabled:L})}):null]}),!n&&ce&&ie&&!L&&a.jsx("div",{className:"toolbar-search-row",children:a.jsx("input",{ref:X,"aria-label":"Search filename, tags, notes",placeholder:R??"Search...",onChange:Ce=>t(Ce.target.value),className:"toolbar-search-input-mobile input input-lg w-full select-text"})}),re&&a.jsx(fS,{viewMode:m,currentSort:en,sortOnlyOptions:oe,sortDisabled:h,sortControlsDisabled:$t,sortDir:Fe,isRandom:Ze,showSelectModeToggle:fe,multiSelectMode:H,selectModeLabel:nt,uploadBusy:A,uploadDisabled:O,onViewMode:S,onSortChange:Ce=>p==null?void 0:p(am(Ce,he)),onToggleSortDir:bt,onToggleMultiSelectMode:_,onUploadClick:T})]})}function pS(e,t){if(typeof e!="number")return null;const n=e.toLocaleString();if(typeof t!="number")return`${n} items`;const r=t.toLocaleString();return t===e?`${n} items`:`${n} / ${r} items`}function mS(e,t){return typeof e=="number"?e:t>0?1:0}function am(e,t){if(e.startsWith("metric:")){const n=e.slice(7);return n?{kind:"metric",key:n,dir:t.dir}:t}if(e.startsWith("builtin:")){const n=e.slice(8);if(n==="name"||n==="added"||n==="random")return{kind:"builtin",key:n,dir:t.dir}}return t}class ln extends Error{constructor(n,r,s,i){super(r);lt(this,"status");lt(this,"url");lt(this,"body");this.name="FetchError",this.status=n,this.url=s,this.body=i}}function gS(e){const t=e.trim();return t.startsWith("{")||t.startsWith("[")}function dx(e,t,n){if(t&&typeof t=="object"){const r=t,s=typeof r.error=="string"?r.error:null,i=typeof r.message=="string"?r.message:null;if(s&&i)return`${s}: ${i}`;if(s)return s;if(i)return i}return typeof t=="string"&&t?t:`HTTP ${e} for ${n}`}function vt(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{let c=null;const d=await l.text().catch(()=>"");if(d)if((l.headers.get("content-type")||"").includes("application/json")||gS(d))try{c=JSON.parse(d)}catch{c=d}else c=d;if(!l.ok)throw new ln(l.status,dx(l.status,c,e),e,c);return c}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}function eo(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{if(!l.ok){const c=await l.text().catch(()=>""),d=c||null;throw new ln(l.status,dx(l.status,d,e),e,d)}return l.blob()}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}class fx{constructor(t){lt(this,"store",new Map);lt(this,"inflight",new Map);lt(this,"totalBytes",0);this.maxBytes=t}getMaxBytes(){return this.maxBytes}getTotalBytes(){return this.totalBytes}getSize(){return this.store.size}has(t){return this.store.has(t)}isInflight(t){return this.inflight.has(t)}get(t){const n=this.store.get(t);if(n)return this.store.delete(t),this.store.set(t,n),n.blob}evictIfNeeded(t){for(;this.totalBytes+t>this.maxBytes&&this.store.size>0;){const n=this.store.keys().next().value;if(n==null)break;const r=this.store.get(n);r&&(this.totalBytes-=r.size),this.store.delete(n)}}set(t,n){const r=n.size||0;if(!(r>this.maxBytes)){if(this.store.has(t)){const s=this.store.get(t);this.totalBytes-=s.size,this.store.delete(t)}this.evictIfNeeded(r),this.store.set(t,{blob:n,size:r}),this.totalBytes+=r}}async getOrFetch(t,n){const r=this.get(t);if(r)return r;const s=this.inflight.get(t);if(s)return s.promise;const i=n(),o=typeof i=="object"&&"promise"in i,l=o?i.promise:i,c=o?i.abort:void 0,d=l.then(f=>(this.set(t,f),f)).finally(()=>{this.inflight.delete(t)});return this.inflight.set(t,{promise:d,abort:c}),d}prefetch(t,n){if(this.store.has(t)||this.inflight.has(t))return;const r=n(),s=typeof r=="object"&&"promise"in r,i=s?r.promise:r,o=s?r.abort:void 0,l=i.then(c=>(this.set(t,c),c)).catch(()=>new Blob).finally(()=>{this.inflight.delete(t)});this.inflight.set(t,{promise:l,abort:o})}cancelPrefetch(t){const n=this.inflight.get(t);if(n!=null&&n.abort)try{n.abort()}catch{}this.inflight.delete(t)}clear(){for(const[t,n]of this.inflight)if(n.abort)try{n.abort()}catch{}this.inflight.clear(),this.store.clear(),this.totalBytes=0}evictPrefix(t){const n=(()=>{const s=t?`/${t.replace(/^\/+/,"")}`:"/";return s==="/"?"/":s.replace(/\/+$/,"")})(),r=s=>{const i=s.startsWith("/")?s.replace(/\/+$/,""):`/${s.replace(/\/+$/,"")}`;return n==="/"?!0:i===n||i.startsWith(`${n}/`)};for(const[s,i]of Array.from(this.store.entries()))r(s)&&(this.totalBytes-=i.size,this.store.delete(s));for(const[s,i]of Array.from(this.inflight.entries()))if(r(s)){if(i.abort)try{i.abort()}catch{}this.inflight.delete(s)}this.totalBytes<0&&(this.totalBytes=0)}}const Ks=new fx(60*1024*1024),zd=new fx(20*1024*1024),Jr={browseStart:e=>`lenslet:browse:load:start:${e}`,browseComplete:e=>`lenslet:browse:load:complete:${e}`,firstGrid:e=>`lenslet:browse:first-grid:${e}`,firstGridLatency:e=>`lenslet:browse:first-grid-latency:${e}`,firstThumb:e=>`lenslet:browse:first-thumb:${e}`,firstThumbLatency:e=>`lenslet:browse:first-thumb-latency:${e}`},Ue={activeRequestId:null,activeLoadStartedAtMs:null,firstGridItemLatencyMs:null,firstGridItemPath:null,firstThumbnailLatencyMs:null,firstThumbnailPath:null,requestBudget:null};function lh(){return typeof performance<"u"&&typeof performance.now=="function"?performance.now():Date.now()}function pu(e){if(!(typeof performance>"u"||typeof performance.mark!="function"))try{performance.mark(e)}catch{}}function hx(e,t,n){if(!(typeof performance>"u"||typeof performance.measure!="function"))try{performance.measure(e,t,n)}catch{}}function zi(){typeof window>"u"||(window.__lensletBrowseHotpath=px())}function px(){return{firstGridItemLatencyMs:Ue.firstGridItemLatencyMs,firstGridItemPath:Ue.firstGridItemPath,firstThumbnailLatencyMs:Ue.firstThumbnailLatencyMs,firstThumbnailPath:Ue.firstThumbnailPath,requestBudget:Ue.requestBudget?{...Ue.requestBudget}:null}}function vS(e){Ue.requestBudget={...e},zi()}function yS(e){Ue.activeRequestId=e.requestId,Ue.activeLoadStartedAtMs=lh(),Ue.firstGridItemLatencyMs=null,Ue.firstGridItemPath=null,Ue.firstThumbnailLatencyMs=null,Ue.firstThumbnailPath=null,pu(Jr.browseStart(e.requestId)),zi()}function xS(e){Ue.activeRequestId===e&&(pu(Jr.browseComplete(e)),zi())}function wS(e){const t=Ue.activeRequestId,n=Ue.activeLoadStartedAtMs;if(t==null||n==null||Ue.firstGridItemLatencyMs!=null)return;const r=Math.max(0,lh()-n);Ue.firstGridItemLatencyMs=Math.round(r),Ue.firstGridItemPath=e;const s=Jr.firstGrid(t);pu(s),hx(Jr.firstGridLatency(t),Jr.browseStart(t),s),zi()}function um(e){const t=Ue.activeRequestId,n=Ue.activeLoadStartedAtMs;if(t==null||n==null||Ue.firstThumbnailLatencyMs!=null)return;const r=Math.max(0,lh()-n);Ue.firstThumbnailLatencyMs=Math.round(r),Ue.firstThumbnailPath=e;const s=Jr.firstThumb(t);pu(s),hx(Jr.firstThumbLatency(t),Jr.browseStart(t),s),zi()}zi();const bS=["folders","thumb","file"],vc={folders:2,thumb:6,file:3};let cm=1;const It={folders:{limit:vc.folders,inflight:new Map,queued:[],peakInflight:0},thumb:{limit:vc.thumb,inflight:new Map,queued:[],peakInflight:0},file:{limit:vc.file,inflight:new Map,queued:[],peakInflight:0}};function za(){if(typeof DOMException<"u")return new DOMException("request aborted","AbortError");const e=new Error("request aborted");return e.name="AbortError",e}function SS(){return{limits:{folders:It.folders.limit,thumb:It.thumb.limit,file:It.file.limit},inflight:{folders:It.folders.inflight.size,thumb:It.thumb.inflight.size,file:It.file.inflight.size},queued:{folders:It.folders.queued.length,thumb:It.thumb.queued.length,file:It.file.queued.length},peakInflight:{folders:It.folders.peakInflight,thumb:It.thumb.peakInflight,file:It.file.peakInflight},updatedAtMs:Date.now()}}function as(){vS(SS())}function dm(e){const t=It[e];for(;t.inflight.size<t.limit&&t.queued.length>0;){const n=t.queued.shift();if(!n)break;n.start()}}function to(e,t){const n=It[e],r=cm;cm+=1;let s=!1,i=!1,o=null;return{promise:new Promise((d,f)=>{const p=()=>{i&&(i=!1,n.inflight.delete(r),dm(e),as())},h=()=>{if(s||i)return;i=!0;let w;try{w=t()}catch(x){s=!0,p(),f(x);return}o={abort:w.abort,reject:f},n.inflight.set(r,o),n.peakInflight=Math.max(n.peakInflight,n.inflight.size),as(),w.promise.then(x=>{s||(s=!0,p(),d(x))},x=>{s||(s=!0,p(),f(x))})};if(n.inflight.size<n.limit){h();return}n.queued.push({id:r,start:h,reject:f}),as()}),abort:()=>{if(s)return;if(s=!0,i){if(n.inflight.delete(r),o!=null&&o.abort)try{o.abort()}catch{}o==null||o.reject(za()),dm(e),as();return}const d=n.queued.findIndex(f=>f.id===r);if(d>=0){const[f]=n.queued.splice(d,1);f.reject(za()),as()}}}}function CS(e=bS){for(const t of e){const n=It[t];for(const s of Array.from(n.inflight.values())){if(s.abort)try{s.abort()}catch{}s.reject(za())}n.inflight.clear();const r=n.queued.splice(0,n.queued.length);for(const s of r)s.reject(za())}as()}as();const yc={};function kS(){const e=yc==null?void 0:yc.VITE_API_BASE,t=typeof window<"u",n=t?window.location.origin:"http://localhost",r=t?window.location.hostname:"localhost",s=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\]|.+\.localhost)$/i.test(r);if(!e)return"";let i;try{i=new URL(e,n)}catch{return""}const o=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\])$/i.test(i.hostname);return s?i.origin:o?"":i.origin}const Ve=kS();const ES=40*1024*1024;function NS(e){return e==="viewer"||e==="compare"}function fm(e){return`${Ve}/thumb?path=${encodeURIComponent(e)}`}function hm(e){return`${Ve}/file?path=${encodeURIComponent(e)}`}const xc="lenslet.client_id",pm="lenslet.client_id.session",mx="lenslet.last_event_id",jS=1e3,MS=3e4,RS=5;let $d=null,aa=null,mm=0,fi=null,hi=0,mu=!0,$a=!1;function gx(){return typeof window<"u"&&typeof EventSource<"u"}function gm(e,t){if(!e)return null;try{return e.getItem(t)}catch{return null}}function vm(e,t,n){if(e)try{e.setItem(t,n)}catch{}}function PS(e,t){if(e)try{e.removeItem(t)}catch{}}function TS(){if(typeof navigator>"u")return"server";const e=navigator.userAgent||"",t=navigator.language||"",n=navigator.platform||"",r=typeof Intl<"u"&&Intl.DateTimeFormat().resolvedOptions().timeZone||"",s=typeof screen<"u"?`${screen.width}x${screen.height}x${screen.colorDepth}`:"";return[e,t,n,r,s].join("|")}function IS(e){let t=2166136261;for(let n=0;n<e.length;n+=1)t^=e.charCodeAt(n),t=t*16777619>>>0;return t.toString(16).padStart(8,"0")}function ym(){return typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`client_${Math.random().toString(36).slice(2,10)}_${Date.now()}`}function no(e){return $d=e,e}function Ba(e){if(typeof window>"u")return null;try{return e==="local"?window.localStorage:window.sessionStorage}catch{return null}}function _i(){if($d)return $d;const e=Ba("local"),t=Ba("session"),n=gm(t,pm);if(n)return no(n);const r=gm(e,xc);if(t){const i=ym();return vm(t,pm,i),r&&PS(e,xc),no(i)}if(r)return no(r);if(e){const i=ym();return vm(e,xc,i),no(i)}const s=`fp_${IS(TS())}_${Math.random().toString(36).slice(2,8)}`;return no(s)}function gu(e="lenslet"){mm+=1;const t=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`nonce_${Math.random().toString(36).slice(2,10)}_${Date.now()}_${mm}`;return`${e}:${_i()}:${t}`}function LS(){if(aa!=null)return aa;if(typeof window>"u")return null;const e=Ba("local");if(!e)return null;try{const t=e.getItem(mx);if(!t)return null;const n=Number(t);return!Number.isFinite(n)||n<=0?null:(aa=n,n)}catch{return null}}function _S(e){if(!Number.isFinite(e)||e<=0||(aa=e,typeof window>"u"))return;const t=Ba("local");if(t)try{t.setItem(mx,String(e))}catch{}}function AS(){if(typeof window>"u")return`${Ve}/events`;const e=new URL(`${Ve}/events`,window.location.origin),t=LS();return t!=null&&Number.isFinite(t)&&e.searchParams.set("last_event_id",String(t)),e.toString()}function FS(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}let Rn=null,vx="idle";const Bd=new Set,Ud=new Set,Vd=new Set;function pi(e){vx=e;for(const t of Ud)t(e)}function ah(e){if($a!==e){$a=e;for(const t of Vd)t(e)}}function uh(){fi!=null&&(window.clearTimeout(fi),fi=null)}function OS(){hi=0,uh()}function DS(){if(!mu||fi!=null)return;hi+=1;const e=Math.min(jS*Math.pow(2,hi-1),MS);hi>=RS?(pi("offline"),ah(!0)):pi("reconnecting"),fi=window.setTimeout(()=>{fi=null,yx()},e)}function yx(){if(!mu||!gx()||(Rn&&Rn.readyState===EventSource.CLOSED&&(Rn.close(),Rn=null),Rn))return;hi>0?pi("reconnecting"):pi("connecting");const e=new EventSource(AS());Rn=e;const t=n=>r=>{const s=FS(r.data);if(!s)return;const i=r.lastEventId?Number(r.lastEventId):null,o=i!=null&&Number.isFinite(i)?i:null;o!=null&&_S(o);for(const l of Bd)l({type:n,id:o,data:s})};e.addEventListener("item-updated",t("item-updated")),e.addEventListener("metrics-updated",t("metrics-updated")),e.addEventListener("presence",t("presence")),e.onopen=()=>{OS(),ah(!1),pi("live")},e.onerror=()=>{Rn===e&&(e.close(),Rn=null,DS())}}function zS(){mu=!0,gx()&&(uh(),yx())}function $S(){mu=!1,uh(),hi=0,Rn&&(Rn.close(),Rn=null),ah(!1),pi("offline")}function BS(e){return Bd.add(e),()=>{Bd.delete(e)}}function US(e){return Ud.add(e),e(vx),()=>{Ud.delete(e)}}function VS(e){return Vd.add(e),e($a),()=>{Vd.delete(e)}}function WS(){return $a}function HS(e){CS(e)}function QS(e,t){const n=JSON.stringify(t),r=`${Ve}${e}`;if(typeof navigator<"u"&&typeof navigator.sendBeacon=="function")try{if(navigator.sendBeacon(r,new Blob([n],{type:"application/json"})))return!0}catch{}if(typeof fetch!="function")return!1;try{return fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0}),!0}catch{return!1}}function KS(e,t,n){return QS("/presence/leave",{gallery_id:e,lease_id:t,client_id:n??_i()})}function _l(e){return e??_i()}function Al(e,t){return vt(`${Ve}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).promise}function qS(e,t){const n=new URLSearchParams({path:e});return t!=null&&t.recursive&&n.set("recursive","1"),n.toString()}const me={getFolder:(e,t)=>to("folders",()=>vt(`${Ve}/folders?${qS(e,t)}`)).promise,search:(e,t)=>{const n=new URLSearchParams;return e&&n.set("q",e),t&&n.set("path",t),vt(`${Ve}/search?${n}`).promise},getEmbeddings:()=>vt(`${Ve}/embeddings`).promise,searchEmbeddings:e=>vt(`${Ve}/embeddings/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,refreshFolder:e=>{const t=new URLSearchParams({path:e});return vt(`${Ve}/refresh?${t}`,{method:"POST"}).promise},getSidecar:e=>vt(`${Ve}/item?path=${encodeURIComponent(e)}`).promise,patchSidecar:(e,t,n)=>{const s={"Content-Type":"application/json","Idempotency-Key":(n==null?void 0:n.idempotencyKey)??gu("patch"),"x-client-id":_i(),"x-updated-by":"web"};return(n==null?void 0:n.ifMatch)!=null&&(s["If-Match"]=String(n.ifMatch)),vt(`${Ve}/item?path=${encodeURIComponent(e)}`,{method:"PATCH",headers:s,body:JSON.stringify(t)}).promise},getMetadata:e=>vt(`${Ve}/metadata?path=${encodeURIComponent(e)}`).promise,putSidecar:(e,t)=>vt(`${Ve}/item?path=${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json","x-client-id":_i(),"x-updated-by":"web"},body:JSON.stringify(t)}).promise,getHealth:()=>vt(`${Ve}/health`).promise,joinPresence:(e,t,n)=>Al("/presence/join",{gallery_id:e,client_id:_l(n),lease_id:t}),movePresence:(e,t,n,r)=>Al("/presence/move",{from_gallery_id:e,to_gallery_id:t,client_id:_l(r),lease_id:n}),leavePresence:(e,t,n)=>Al("/presence/leave",{gallery_id:e,client_id:_l(n),lease_id:t}),postPresence:(e,t,n)=>Al("/presence",{gallery_id:e,client_id:_l(n),lease_id:t}),getThumb:e=>zd.getOrFetch(e,()=>to("thumb",()=>eo(fm(e)))),prefetchThumb:e=>{zd.prefetch(e,()=>to("thumb",()=>eo(fm(e))))},getFile:e=>Ks.getOrFetch(e,()=>to("file",()=>eo(hm(e)))),exportComparison:e=>eo(`${Ve}/export-comparison`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,prefetchFile:async(e,t)=>{if(NS(t)&&!(Ks.has(e)||Ks.isInflight(e)))try{const n=await to("file",()=>eo(hm(e),{headers:{"x-lenslet-prefetch":t}})).promise;n.size<=ES&&Ks.set(e,n)}catch{}},cancelPrefetch:e=>{Ks.cancelPrefetch(e)},uploadFile:async(e,t)=>{const n=new FormData;return n.append("dest",e),n.append("file",t),vt(`${Ve}/file`,{method:"POST",body:n,timeoutMs:6e4}).promise},moveFile:async(e,t)=>{const n=new FormData;return n.append("src",e),n.append("dest",t),vt(`${Ve}/move`,{method:"POST",body:n}).promise},deleteFiles:async e=>vt(`${Ve}/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paths:e})}).promise,exportIntent:async e=>{const t=new FormData;return t.append("path",e),vt(`${Ve}/export-intent`,{method:"POST",body:t}).promise},getViews:()=>vt(`${Ve}/views`).promise,saveViews:e=>vt(`${Ve}/views`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise};class GS{constructor(t=400){lt(this,"cache",new Map);lt(this,"maxSize");this.maxSize=t,typeof window<"u"&&window.addEventListener("beforeunload",()=>this.clear(),{once:!0})}get(t){const n=this.cache.get(t);return n&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){for(this.cache.has(t)&&this.cache.delete(t);this.cache.size>=this.maxSize;){const r=this.cache.keys().next().value;if(r===void 0)break;const s=this.cache.get(r);if(this.cache.delete(r),s)try{URL.revokeObjectURL(s)}catch{}}this.cache.set(t,n)}clear(){for(const t of this.cache.values())try{URL.revokeObjectURL(t)}catch{}this.cache.clear()}}const wc=new GS(400);function YS({path:e,name:t,onClick:n,selected:r,highlighted:s,highlightKey:i,displayW:o,displayH:l,ioRoot:c,isScrolling:d,priority:f}){const p=u.useRef(null),[h,w]=u.useState(()=>wc.get(e)??null),[x,b]=u.useState(!1),[C,v]=u.useState(()=>!!h);u.useEffect(()=>{const y=p.current;if(!y)return;const m=new IntersectionObserver(S=>{for(const E of S)E.target===y&&b(E.isIntersecting||E.intersectionRatio>0)},{root:c??null,rootMargin:"200px 0px",threshold:.01});return m.observe(y),()=>{m.unobserve(y),m.disconnect()}},[c]),u.useEffect(()=>{if(h||!(x&&!d||f))return;let y=!0;return me.getThumb(e).then(m=>{if(!y)return;const S=URL.createObjectURL(m);wc.set(e,S),w(S)}).catch(()=>{}),()=>{y=!1}},[e,h,x,d,f]),u.useEffect(()=>{var m;if(!h){v(!1);return}const y=(m=p.current)==null?void 0:m.querySelector("img");y&&y.complete&&y.naturalWidth>0?(v(!0),um(e)):v(!1)},[h]),u.useEffect(()=>{w(wc.get(e)??null)},[e]);const g=["absolute inset-0 relative bg-hover border border-border rounded-lg overflow-hidden select-none",r?"outline-2 outline-accent":"",s?"thumb-updated-ring":"","hover:outline hover:outline-1 hover:outline-accent"].filter(Boolean).join(" ");return a.jsx("div",{ref:p,"data-highlight-key":i??void 0,className:g,onClick:n,children:h?a.jsx("img",{className:`w-full h-full object-cover block pointer-events-none select-none opacity-0 transition-opacity duration-[160ms] ${C?"opacity-100":""}`,src:h,alt:t,loading:"lazy",decoding:"async",onLoad:()=>{v(!0),um(e)},width:o?Math.round(o):void 0,height:l?Math.round(l):void 0}):null})}function Ws(e,t,n){let r=n.initialDeps??[],s,i=!0;function o(){var l,c,d;let f;n.key&&((l=n.debug)!=null&&l.call(n))&&(f=Date.now());const p=e();if(!(p.length!==r.length||p.some((x,b)=>r[b]!==x)))return s;r=p;let w;if(n.key&&((c=n.debug)!=null&&c.call(n))&&(w=Date.now()),s=t(...p),n.key&&((d=n.debug)!=null&&d.call(n))){const x=Math.round((Date.now()-f)*100)/100,b=Math.round((Date.now()-w)*100)/100,C=b/16,v=(g,y)=>{for(g=String(g);g.length<y;)g=" "+g;return g};console.info(`%c ${v(b,5)} /${v(x,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*C,120))}deg 100% 31%);`,n==null?void 0:n.key)}return n!=null&&n.onChange&&!(i&&n.skipInitialOnChange)&&n.onChange(s),i=!1,s}return o.updateDeps=l=>{r=l},o}function xm(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const XS=(e,t)=>Math.abs(e-t)<1.01,JS=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},wm=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},ZS=e=>e,eC=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},tC=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=o=>{const{width:l,height:c}=o;t({width:Math.round(l),height:Math.round(c)})};if(s(wm(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(o=>{const l=()=>{const c=o[0];if(c!=null&&c.borderBoxSize){const d=c.borderBoxSize[0];if(d){s({width:d.inlineSize,height:d.blockSize});return}}s(wm(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},bm={passive:!0},Sm=typeof window>"u"?!0:"onscrollend"in window,nC=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&Sm?()=>{}:JS(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),o=f=>()=>{const{horizontal:p,isRtl:h}=e.options;s=p?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,f)},l=o(!0),c=o(!1);c(),n.addEventListener("scroll",l,bm);const d=e.options.useScrollendEvent&&Sm;return d&&n.addEventListener("scrollend",c,bm),()=>{n.removeEventListener("scroll",l),d&&n.removeEventListener("scrollend",c)}},rC=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},sC=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const o=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class iC{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:ZS,rangeExtractor:eC,onChange:()=>{},measureElement:rC,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=Ws(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let o=r-1;o>=0;o--){const l=n[o];if(s.has(l.lane))continue;const c=i.get(l.lane);if(c==null||l.end>c.end?i.set(l.lane,l):l.end<c.end&&s.set(l.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=Ws(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(n,r,s,i,o,l)=>(this.prevLanes!==void 0&&this.prevLanes!==l&&(this.lanesChangedFlag=!0),this.prevLanes=l,this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=Ws(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l},c)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>n)for(const h of this.laneAssignments.keys())h>=n&&this.laneAssignments.delete(h);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(h=>{this.itemSizeCache.set(h.key,h.size)}));const d=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===n&&(this.lanesSettling=!1);const f=this.measurementsCache.slice(0,d),p=new Array(l).fill(void 0);for(let h=0;h<d;h++){const w=f[h];w&&(p[w.lane]=h)}for(let h=d;h<n;h++){const w=i(h),x=this.laneAssignments.get(h);let b,C;if(x!==void 0&&this.options.lanes>1){b=x;const m=p[b],S=m!==void 0?f[m]:void 0;C=S?S.end+this.options.gap:r+s}else{const m=this.options.lanes===1?f[h-1]:this.getFurthestMeasurement(f,h);C=m?m.end+this.options.gap:r+s,b=m?m.lane:h%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(h,b)}const v=c.get(w),g=typeof v=="number"?v:this.options.estimateSize(h),y=C+g;f[h]={index:h,start:C,size:g,end:y,key:w,lane:b},p[b]=h}return this.measurementsCache=f,f},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Ws(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?oC({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=Ws(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,o)=>i===null||o===null?[]:n({startIndex:i,endIndex:o,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==n&&(l&&this.observer.unobserve(l),this.observer.observe(n),this.elementsCache.set(o,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,o=r-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,o,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=Ws(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,o=n.length;i<o;i++){const l=n[i],c=r[l];s.push(c)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return xm(r[xx(0,r.length-1,s=>xm(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),o=this.getScrollOffset();r==="auto"&&(r=n>=o+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),o=this.getScrollOffset();if(r==="auto")if(s.end>=o+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=o+this.options.scrollPaddingStart)r="start";else return[o,r];const l=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),n=Math.max(0,Math.min(n,this.options.count-1));let i=0;const o=10,l=d=>{if(!this.targetWindow)return;const f=this.getOffsetForIndex(n,d);if(!f){console.warn("Failed to get offset for index:",n);return}const[p,h]=f;this._scrollToOffset(p,{adjustments:void 0,behavior:s}),this.targetWindow.requestAnimationFrame(()=>{const w=this.getScrollOffset(),x=this.getOffsetForIndex(n,h);if(!x){console.warn("Failed to get offset for index:",n);return}XS(x[0],w)||c(h)})},c=d=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(d)):console.warn(`Failed to scroll to index ${n} after ${o} attempts.`))};l(r)},this.scrollBy=(n,{behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=r.length-1;for(;o>=0&&i.some(l=>l===null);){const l=r[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}s=Math.max(...i.filter(l=>l!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(t)}}const xx=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function oC({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=c=>e[c].start;if(e.length<=r)return{startIndex:0,endIndex:s};let o=xx(0,s,i,n),l=o;if(r===1)for(;l<s&&e[l].end<n+t;)l++;else if(r>1){const c=Array(r).fill(0);for(;l<s&&c.some(f=>f<n+t);){const f=e[l];c[f.lane]=f.end,l++}const d=Array(r).fill(n+t);for(;o>=0&&d.some(f=>f>=n);){const f=e[o];d[f.lane]=f.start,o--}o=Math.max(0,o-o%r),l=Math.min(s,l+(r-1-l%r))}return{startIndex:o,endIndex:l}}const Cm=typeof document<"u"?u.useLayoutEffect:u.useEffect;function lC(e){const t=u.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var o;i?fu.flushSync(t):t(),(o=e.onChange)==null||o.call(e,s,i)}},[r]=u.useState(()=>new iC(n));return r.setOptions(n),Cm(()=>r._didMount(),[]),Cm(()=>r._willUpdate()),r}function aC(e){return lC({observeElementRect:tC,observeElementOffset:nC,scrollToFn:sC,...e})}function uC({containerW:e,gap:t,targetCell:n,aspect:r,captionH:s}){const i=Math.max(1,Math.floor((e+t)/(n+t))),o=(e-t*(i-1))/i,l=o*r.h/r.w,c=l+s+t;return{columns:i,cellW:o,mediaH:l,rowH:c}}const cC=1.333;function dC({items:e,containerWidth:t,targetHeight:n,gap:r,captionH:s}){if(t<=0)return[];const i=[];let o=[],l=0;const c=(d,f)=>({index:i.length,height:f+s+r,imageH:f,items:d.map(p=>({item:p.item,displayW:p.aspect*f,displayH:f,originalIndex:p.originalIndex}))});for(let d=0;d<e.length;d++){const f=e[d],p=f.w>0&&f.h>0?f.w/f.h:cC;o.push({item:f,aspect:p,originalIndex:d}),l+=p;const h=(o.length-1)*r;if(l*n+h>=t){const x=(t-h)/l;i.push(c(o,x)),o=[],l=0}}return o.length>0&&i.push(c(o,n)),i}function fC(e,t,n){return{mode:"adaptive",rows:dC({items:t,containerWidth:e,targetHeight:n.targetCell,gap:n.gap,captionH:n.captionH})}}function hC(e,t,n){const{columns:r,cellW:s,mediaH:i,rowH:o}=uC({containerW:e,gap:n.gap,targetCell:n.targetCell,aspect:n.aspect,captionH:n.captionH}),l=Math.ceil(t.length/Math.max(1,r));return{mode:"grid",columns:r,cellW:s,mediaH:i,rowH:o,rowCount:l}}function pC(e,t,n){const[r,s]=u.useState(0);u.useLayoutEffect(()=>{const c=e.current;if(!c)return;const d=()=>{const p=getComputedStyle(c),h=c.clientWidth-parseFloat(p.paddingLeft)-parseFloat(p.paddingRight);s(h)},f=new ResizeObserver(d);return f.observe(c),d(),()=>f.disconnect()},[]);const i=u.useMemo(()=>n.viewMode==="adaptive"?fC(r,t,n):hC(r,t,n),[r,t,n.viewMode,n.gap,n.targetCell,n.aspect.w,n.aspect.h,n.captionH]),o=aC({count:i.mode==="adaptive"?i.rows.length:i.rowCount,getScrollElement:()=>e.current,estimateSize:c=>i.mode==="adaptive"?i.rows[c].height:i.rowH,overscan:8}),l=o.getVirtualItems();return u.useEffect(()=>{o.measure()},[i,o]),{width:r,layout:i,rowVirtualizer:o,virtualRows:l}}function mC(e,t,n,r){if(!e.length)return null;const s=n?e.findIndex(l=>l.path===n):0,i=Math.max(1,t);let o=s;if(r.key==="ArrowRight"||r.key==="d")o=Math.min(e.length-1,s+1);else if(r.key==="ArrowLeft"||r.key==="a")o=Math.max(0,s-1);else if(r.key==="ArrowDown"||r.key==="s")o=Math.min(e.length-1,s+i);else if(r.key==="ArrowUp"||r.key==="w")o=Math.max(0,s-i);else return r.key==="Enter"&&n?"open":null;return o}function gC(e,t,n){if(e.length===0)return[];const r=Array.from(new Set(e.map(d=>d.index))).sort((d,f)=>d-f),s=r[0],i=r[r.length-1],o=t.mode==="adaptive"?Math.max(0,t.rows.length-1):Math.max(0,Math.ceil(n.length/Math.max(1,t.columns))-1),l=[s-1,i+1].filter(d=>d>=0&&d<=o);if(l.length===0)return[];const c=[];for(const d of l){if(t.mode==="adaptive"){const h=t.rows[d];if(!h)continue;for(const w of h.items)c.push(w.item.path);continue}const f=d*t.columns,p=n.slice(f,f+t.columns);for(const h of p)c.push(h.path)}return Array.from(new Set(c))}function vC(e,t){var s,i;let n=0,r=e.length-1;for(;n<=r;){const o=n+r>>1,l=e[o],c=((s=l.items[0])==null?void 0:s.originalIndex)??-1,d=((i=l.items[l.items.length-1])==null?void 0:i.originalIndex)??-1;if(t>=c&&t<=d)return o;t<c?r=o-1:n=o+1}return 0}function yC(e,t,n){const r=new Set;for(const s of n){if(t.mode==="adaptive"){const l=t.rows[s.index];if(!l)continue;for(const c of l.items)r.add(c.item.path);continue}const i=s.index*t.columns,o=Math.min(e.length,i+t.columns);for(let l=i;l<o;l+=1){const c=e[l];c&&r.add(c.path)}}return r}function xC(e,t,n,r){var o,l,c;const s=wC(n,r);if(!s)return null;if(t.mode==="adaptive")return((l=(o=t.rows[s.index])==null?void 0:o.items[0])==null?void 0:l.item.path)??null;const i=s.index*t.columns;return((c=e[i])==null?void 0:c.path)??null}function wC(e,t){if(e.length===0)return null;const n=Math.max(0,t);for(const r of e){const s=r.start??0;if((r.end??s+(r.size??0))>n)return r}return e[0]}function bC({selectionToken:e,appliedSelectionToken:t,selectedPath:n,topAnchorToken:r,appliedTopAnchorToken:s,topAnchorPath:i,hasPath:o}){const l=e??0;if(l>0&&l!==t&&n&&o(n))return{source:"selection",path:n,token:l};const c=r??0;return c>0&&c!==s&&i&&o(i)?{source:"top-anchor",path:i,token:c}:null}function SC({path:e,pathToIndex:t,layout:n,adaptiveRowMeta:r}){var o;const s=t.get(e);if(s==null||s<0)return null;const i=n.mode==="grid"?Math.floor(s/Math.max(1,n.columns)):vC(n.rows,s);return n.mode==="grid"?i*n.rowH:((o=r==null?void 0:r[i])==null?void 0:o.start)??0}const CC=500,kC=450,EC=600,NC=8;function jC(e){return Math.max(kC,Math.min(EC,e))}class MC{constructor(t){lt(this,"delayMs");lt(this,"moveTolerancePx");lt(this,"onLongPress");lt(this,"onCancel");lt(this,"timerId",null);lt(this,"activePointerId",null);lt(this,"startX",0);lt(this,"startY",0);lt(this,"lastEvent",null);lt(this,"fired",!1);this.delayMs=jC(t.delayMs??CC),this.moveTolerancePx=Math.max(0,t.moveTolerancePx??NC),this.onLongPress=t.onLongPress,this.onCancel=t.onCancel}pointerDown(t){return(t.pointerType??"mouse")==="mouse"?!1:t.isPrimary===!1?(this.cancel("multitouch"),!1):this.activePointerId!=null&&this.activePointerId!==t.pointerId?(this.cancel("multitouch"),!1):(this.activePointerId=t.pointerId,this.startX=t.clientX,this.startY=t.clientY,this.lastEvent=t,this.fired=!1,this.clearTimer(),this.timerId=setTimeout(()=>{this.activePointerId==null||this.fired||this.lastEvent==null||(this.fired=!0,this.clearTimer(),this.onLongPress(this.lastEvent))},this.delayMs),!0)}pointerMove(t){if(!this.matchesPointer(t.pointerId)||this.fired)return;this.lastEvent=t;const n=t.clientX-this.startX,r=t.clientY-this.startY;Math.hypot(n,r)>this.moveTolerancePx&&this.cancel("movement")}pointerUp(t){if(!(t!=null&&!this.matchesPointer(t))){if(!this.fired){this.cancel("pointerup");return}this.reset()}}pointerCancel(t){t!=null&&!this.matchesPointer(t)||this.cancel("pointercancel")}cancelFromScroll(){this.cancel("scroll")}destroy(){this.cancel("cleanup")}matchesPointer(t){return this.activePointerId!=null&&this.activePointerId===t}clearTimer(){this.timerId!=null&&(clearTimeout(this.timerId),this.timerId=null)}reset(){this.clearTimer(),this.activePointerId=null,this.lastEvent=null,this.fired=!1}cancel(t){var r;const n=this.timerId!=null&&!this.fired&&t!=="cleanup";this.reset(),n&&((r=this.onCancel)==null||r.call(this,t))}}function RC(e){return e==="touch"||e==="pen"}function PC(e){return e.multiSelectMode||e.isShift||e.isToggle||!RC(e.pointerType)?!1:e.selectedPaths.length===1&&e.selectedPaths[0]===e.path}function km(e,t){return e.includes(t)?e.filter(n=>n!==t):[...e,t]}const nr=12,TC=44,IC={w:4,h:3},LC=350,_C=120;function AC(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Em(e){return{pointerId:e.pointerId,pointerType:e.pointerType,clientX:e.clientX,clientY:e.clientY,isPrimary:e.isPrimary}}function FC(e,t){const n=(t??"").trim();if(!n)return e;const r=e.toLowerCase().indexOf(n.toLowerCase());if(r===-1)return e;const s=e.slice(0,r),i=e.slice(r,r+n.length),o=e.slice(r+n.length);return a.jsxs(a.Fragment,{children:[s,a.jsx("mark",{className:"bg-accent/20 text-inherit rounded px-0.5",children:i}),o]})}function OC({items:e,selected:t,restoreToSelectionToken:n,restoreToTopAnchorToken:r,restoreToTopAnchorPath:s,multiSelectMode:i=!1,onSelectionChange:o,onOpenViewer:l,onContextMenuItem:c,onOpenItemActions:d,highlight:f,recentlyUpdated:p,onVisiblePathsChange:h,onTopAnchorPathChange:w,suppressSelectionHighlight:x=!1,viewMode:b="grid",targetCellSize:C=220,scrollRef:v,hideScrollbar:g=!1,isLoading:y=!1}){const[m,S]=u.useState(null),[E,j]=u.useState(null),[M,I]=u.useState(!1),[P,B]=u.useState(null),[F,K]=u.useState(null),Z=u.useRef(null),z=u.useRef(null),L=u.useRef(null),R=v??L,T=u.useRef(null),A=u.useRef(0),O=u.useRef(0),H=u.useRef(new Set),U=u.useRef(null),_=u.useRef(null),Q=u.useRef(null),V=u.useRef(null),ee=u.useRef(null),ie=u.useRef({path:null,pointerType:null}),q=C,{width:G,layout:X,rowVirtualizer:ce,virtualRows:Ee}=pC(R,e,{gap:nr,targetCell:q,aspect:IC,captionH:TC,viewMode:b}),Se=u.useMemo(()=>{const D=new Map;for(let Y=0;Y<e.length;Y++)D.set(e[Y].path,Y);return D},[e]),he=u.useMemo(()=>{if(X.mode!=="adaptive")return null;const D=new Map;return X.rows.forEach((Y,le)=>{let ve=0;Y.items.forEach((be,Ne)=>{const se=ve+be.displayW/2;D.set(be.item.path,{row:le,center:se,order:Ne}),ve+=be.displayW+nr})}),D},[X]);u.useEffect(()=>{if(!t.length)return;const D=t[0];P!==D&&B(D)},[t,P]);const Fe=u.useMemo(()=>{if(X.mode!=="adaptive")return null;let D=0;return X.rows.map(Y=>{const le=D;return D+=Y.height,{start:le,height:Y.height}})},[X]),Ze=u.useRef(null),$t=(D,Y)=>{try{if(Ze.current!=null){try{cancelAnimationFrame(Ze.current)}catch{}Ze.current=null}const le=D.scrollTop,ve=Y-le;if(Math.abs(ve)<1){D.scrollTop=Y;return}const be=140,Ne=performance.now(),se=pe=>1-Math.pow(1-pe,3),je=pe=>{const it=Math.min(1,(pe-Ne)/be),Oe=se(it);D.scrollTop=le+ve*Oe,it<1?Ze.current=requestAnimationFrame(je):Ze.current=null};Ze.current=requestAnimationFrame(je)}catch{D.scrollTop=Y}},[Bt,dn]=u.useState(!1);u.useEffect(()=>{const D=R.current;if(!D)return;let Y=0;const le=()=>{var ve;(ve=_.current)==null||ve.cancelFromScroll(),dn(!0),window.clearTimeout(Y),Y=window.setTimeout(()=>dn(!1),_C)};return D.addEventListener("scroll",le,{passive:!0}),()=>D.removeEventListener("scroll",le)},[]),u.useEffect(()=>{const D=new MC({onLongPress:Y=>{const le=Q.current;if(!le||!d)return;const ve=V.current??{x:Y.clientX,y:Y.clientY};d(le,ve),ee.current={path:le,untilMs:Date.now()+700}}});return _.current=D,()=>{D.destroy(),_.current===D&&(_.current=null)}},[d]);const Dn=()=>{z.current!=null&&(window.clearTimeout(z.current),z.current=null)},en=()=>{if(Dn(),I(!1),S(null),Z.current){try{URL.revokeObjectURL(Z.current)}catch{}Z.current=null}j(null)},oe=D=>{Bt||(Dn(),S(D),I(!1),z.current=window.setTimeout(async()=>{z.current=null;try{const Y=await me.getFile(D),le=URL.createObjectURL(Y);if(Z.current)try{URL.revokeObjectURL(Z.current)}catch{}Z.current=le,j(le),I(!0)}catch{}},LC))},re=X.mode==="grid"?X.columns:Math.max(1,Math.floor(G/(q+nr))),we=(D,Y)=>{if(X.mode!=="adaptive")return null;const le=X.rows[D];if(!le)return null;let ve=0,be=null;for(const Ne of le.items){const se=ve+Ne.displayW/2,je=Math.abs(se-Y);(!be||je<be.dist)&&(be={path:Ne.item.path,dist:je}),ve+=Ne.displayW+nr}return be?be.path:null},Ie=(D,Y)=>{var Oe,mt,Vt,En;if(!e.length)return null;const le=D??e[0].path;if(X.mode!=="adaptive"){const hn=mC(e,re,le,Y);return hn==="open"||hn==null?hn:((Oe=e[hn])==null?void 0:Oe.path)??null}const ve=he==null?void 0:he.get(le);if(!ve)return le;const be=Se.get(le)??0,Ne=Y.key;if(Ne==="Enter")return"open";if(Ne==="ArrowRight"||Ne==="d")return((mt=e[Math.min(e.length-1,be+1)])==null?void 0:mt.path)??le;if(Ne==="ArrowLeft"||Ne==="a")return((Vt=e[Math.max(0,be-1)])==null?void 0:Vt.path)??le;const se=Ne==="ArrowDown"||Ne==="s"?1:Ne==="ArrowUp"||Ne==="w"?-1:0;if(se===0)return null;const je=ve.row+se;if(je<0||je>=(((En=X.rows)==null?void 0:En.length)??0))return le;const pe=ve.center;return we(je,pe)??le},ge=D=>{var Y;try{(Y=document.getElementById(`cell-${encodeURIComponent(D)}`))==null||Y.focus()}catch{}},fe=u.useCallback(D=>{try{me.prefetchThumb(D)}catch{}},[]),nt=u.useCallback((D,Y)=>{d==null||d(D,Y)},[d]),Ke=()=>{Q.current=null,V.current=null},bt=(D,Y)=>{var le;Y.target.closest("[data-grid-action]")||(ie.current={path:D,pointerType:Y.pointerType},!i&&(Q.current=D,V.current={x:Y.clientX,y:Y.clientY},(le=_.current)==null||le.pointerDown(Em(Y))))},qe=D=>{var Y;i||(V.current={x:D.clientX,y:D.clientY},(Y=_.current)==null||Y.pointerMove(Em(D)))},tn=D=>{var Y;i||((Y=_.current)==null||Y.pointerUp(D.pointerId),Ke())},br=D=>{var Y;i||((Y=_.current)==null||Y.pointerCancel(D.pointerId),Ke())},kn=(D,Y)=>{const le=ee.current;if(le&&le.path===D&&le.untilMs>Date.now()){ee.current=null,ge(D);return}le&&le.untilMs<=Date.now()&&(ee.current=null),B(D),K(D);const ve=!!Y.shiftKey,be=!!(Y.ctrlKey||Y.metaKey);if(i)o(km(t,D)),T.current=D;else if(PC({pointerType:ie.current.path===D?ie.current.pointerType:null,multiSelectMode:i,isShift:ve,isToggle:be,selectedPaths:t,path:D}))o([D]),T.current=D,l(D);else if(ve){const Ne=T.current??P??t[0]??D,se=Se.get(Ne)??e.findIndex(pe=>pe.path===Ne),je=Se.get(D)??e.findIndex(pe=>pe.path===D);if(se!==-1&&je!==-1){const pe=Math.min(se,je),it=Math.max(se,je),Oe=e.slice(pe,it+1).map(mt=>mt.path);if(be){const mt=new Set(t);for(const Vt of Oe)mt.add(Vt);o(Array.from(mt))}else o(Oe)}else o([D])}else be?(o(km(t,D)),T.current=D):(o([D]),T.current=D);Bt||fe(D),ge(D)},zn=(D,Y)=>{var le,ve;try{const be=Ce.has(D)&&t.length>0?t:[D];(le=Y.dataTransfer)==null||le.setData("application/x-lenslet-paths",JSON.stringify(be)),Y.dataTransfer&&(Y.dataTransfer.effectAllowed="copyMove");try{document.body.classList.add("drag-active")}catch{}const se=Y.currentTarget.querySelector(".cell-content img"),je=document.createElement("div");je.className="drag-ghost";const pe=document.createElement("img");pe.draggable=!1,pe.alt="drag",se&&se.src&&(pe.src=se.src),je.appendChild(pe),document.body.appendChild(je);const it=je.getBoundingClientRect().width||150;(ve=Y.dataTransfer)==null||ve.setDragImage(je,Math.round(it/2),0);const Oe=()=>{try{je.remove()}catch{}try{document.body.classList.remove("drag-active")}catch{}window.removeEventListener("dragend",Oe),window.removeEventListener("pointerup",Oe),document.removeEventListener("visibilitychange",Oe)};window.addEventListener("dragend",Oe),window.addEventListener("pointerup",Oe),document.addEventListener("visibilitychange",Oe)}catch{}};u.useEffect(()=>{const D=R.current;if(!D)return;const Y=le=>{var Oe,mt,Vt;const ve=Ie(F,le);if(ve==null)return;if(le.preventDefault(),ve==="open"){F&&l(F);return}const be=e.find(En=>En.path===ve);if(!be)return;K(be.path),B(be.path),o([be.path]),T.current=be.path;const Ne=X.mode==="grid"?Math.floor((Se.get(be.path)??0)/Math.max(1,X.columns)):((Oe=he==null?void 0:he.get(be.path))==null?void 0:Oe.row)??0,se=D.scrollTop,je=se+D.clientHeight,pe=X.mode==="adaptive"?((mt=Fe==null?void 0:Fe[Ne])==null?void 0:mt.start)??0:Ne*X.rowH,it=X.mode==="adaptive"?pe+(((Vt=Fe==null?void 0:Fe[Ne])==null?void 0:Vt.height)??0):pe+X.rowH;(pe<se||it>je)&&$t(D,pe),ge(be.path)};return D.addEventListener("keydown",Y),()=>{D.removeEventListener("keydown",Y)}},[e,F,re,l,X,he,Fe,Se]),u.useLayoutEffect(()=>{const D=R.current;if(!D)return;const Y=bC({selectionToken:n,appliedSelectionToken:A.current,selectedPath:t[0]??null,topAnchorToken:r,appliedTopAnchorToken:O.current,topAnchorPath:s??null,hasPath:ve=>Se.has(ve)});if(!Y)return;const le=SC({path:Y.path,pathToIndex:Se,layout:X,adaptiveRowMeta:Fe});if(le!=null){try{D.scrollTop=le}catch{}if(Y.source==="selection"){A.current=Y.token;return}O.current=Y.token}},[n,r,s,t,Se,X,Fe]);const Ce=u.useMemo(()=>new Set(t),[t]),rt=!!(m&&E&&M),fn=u.useMemo(()=>gC(Ee,X,e),[e,X,Ee]);u.useEffect(()=>{if(!(Bt||fn.length===0))for(const D of fn)fe(D)},[Bt,fn,fe]),u.useEffect(()=>{var D;(D=R.current)==null||D.focus()},[]),u.useEffect(()=>{var D;if(x){try{(D=R.current)==null||D.blur()}catch{}K(null)}},[x]);const $n=u.useMemo(()=>yC(e,X,Ee),[e,X,Ee]),Ut=u.useMemo(()=>{var D;return xC(e,X,Ee,((D=R.current)==null?void 0:D.scrollTop)??0)},[e,X,Ee,R]);u.useEffect(()=>{h&&(AC(H.current,$n)||(H.current=$n,h($n)))},[h,$n]),u.useEffect(()=>{w&&U.current!==Ut&&(U.current=Ut,w(Ut))},[w,Ut]);const $i=F?`cell-${encodeURIComponent(F)}`:void 0;return u.useEffect(()=>{if(!e.length||px().firstGridItemLatencyMs!=null)return;const D=R.current;if(!D)return;const Y=D.querySelector('[role="gridcell"][id^="cell-"]');if(!Y)return;const le=D.getBoundingClientRect(),ve=Y.getBoundingClientRect();if(!(ve.bottom>=le.top&&ve.top<=le.bottom))return;const Ne=Y.id.startsWith("cell-")?Y.id.slice(5):"";let se=e[0].path;if(Ne)try{se=decodeURIComponent(Ne)}catch{se=e[0].path}wS(se)},[e,R]),a.jsxs("div",{role:"grid","aria-label":"Gallery",className:`relative h-full overflow-auto p-3 outline-none ${g?"scrollbar-hidden pr-4":"scrollbar-thin"} ${rt?"cursor-zoom-in":""}`,ref:R,tabIndex:0,"aria-activedescendant":$i,"aria-busy":y||void 0,onMouseDown:()=>{var D;return(D=R.current)==null?void 0:D.focus()},style:{"--gap":`${nr}px`},children:[a.jsxs("div",{className:"relative w-full",style:{height:ce.getTotalSize()},children:[Ee.map(D=>{var Ne;let Y=[],le={},ve="";if(X.mode==="adaptive"){const se=X.rows[D.index];if(!se)return null;Y=se.items,le={height:se.height,transform:`translate3d(0, ${D.start}px, 0)`,display:"flex",gap:nr,paddingBottom:nr},ve="absolute top-0 left-0 right-0 w-full will-change-transform"}else{const se=D.index*X.columns;Y=e.slice(se,se+X.columns).map(pe=>({item:pe,displayW:X.cellW,displayH:X.mediaH})),le={transform:`translate3d(0, ${D.start}px, 0)`,gridTemplateColumns:`repeat(${X.columns}, minmax(0, 1fr))`,gap:nr,paddingBottom:nr},ve="absolute top-0 left-0 right-0 w-full grid will-change-transform"}const be=D.index===((Ne=Ee[0])==null?void 0:Ne.index);return a.jsx("div",{className:ve,role:"row",style:le,children:Y.map(({item:se,displayW:je,displayH:pe})=>{const it=!x&&(P===se.path||Ce.has(se.path)),Oe=(p==null?void 0:p.get(se.path))??null,mt=Oe!=null,Vt=X.mode==="adaptive"?{width:je}:{},En=X.mode==="adaptive"?{height:pe}:{},hn=X.mode==="adaptive"?"relative rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group shrink-0":"relative aspect-[4/3] rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group";return a.jsxs("div",{id:`cell-${encodeURIComponent(se.path)}`,className:`relative min-w-0 ${it?"outline outline-2 outline-accent outline-offset-2 rounded-[10px]":""}`,role:"gridcell","aria-selected":it,tabIndex:F===se.path?0:-1,onFocus:()=>K(se.path),draggable:!0,style:Vt,onDragStart:Ge=>zn(se.path,Ge),onPointerDown:Ge=>bt(se.path,Ge),onPointerMove:qe,onPointerUp:tn,onPointerCancel:br,onContextMenu:Ge=>{Ge.preventDefault(),Ge.stopPropagation(),c==null||c(Ge,se.path)},children:[a.jsxs("div",{className:hn,style:En,onDoubleClick:()=>{i||l(se.path)},onMouseLeave:en,children:[a.jsx("button",{type:"button",className:"grid-item-action-btn touch-manipulation","data-grid-action":"1","aria-label":`Open actions for ${se.name}`,"aria-haspopup":"menu",onPointerDown:Ge=>Ge.stopPropagation(),onClick:Ge=>{Ge.stopPropagation();const Bn=Ge.currentTarget.getBoundingClientRect();nt(se.path,{x:Bn.right-4,y:Bn.bottom-4})},children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})}),a.jsx("div",{className:"cell-content absolute inset-0",children:a.jsx(YS,{path:se.path,name:se.name,selected:it,highlighted:mt,highlightKey:Oe,displayW:je,displayH:pe,ioRoot:R.current,isScrolling:Bt,priority:be,onClick:Ge=>kn(se.path,Ge)})}),a.jsx("div",{className:"absolute right-0 bottom-0 w-7 h-7 cursor-zoom-in",onMouseEnter:()=>oe(se.path),onMouseLeave:en,children:a.jsx("div",{className:"grid-item-preview-corner absolute right-0 bottom-0 h-[18px] w-[18px] flex items-center justify-center text-text select-none",style:{clipPath:'path("M0 9C0 4.02944 4.02944 0 9 0H18V18H0V9Z")',background:"linear-gradient(135deg, rgba(18,18,18,0.9) 0%, rgba(34,34,34,0.9) 60%, rgba(22,22,22,0.9) 100%)",borderTop:"1px solid rgba(255,255,255,0.08)",borderLeft:"1px solid rgba(255,255,255,0.08)",boxShadow:"0 1px 2px rgba(0,0,0,0.45)",backdropFilter:"blur(1px)"},children:a.jsxs("svg",{width:"11",height:"11",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round",className:"text-[#d9dce2]","aria-hidden":"true",style:{transform:"translate(0px,0px)"},children:[a.jsx("circle",{cx:"11",cy:"11",r:"5.4"}),a.jsx("path",{d:"M15.5 15.5 L19 19"})]})})})]}),a.jsxs("div",{className:"flex flex-col items-center text-center gap-0 mt-1 px-0.5 text-white/90",children:[a.jsx("div",{className:"text-sm leading-[18px] thumb-filename line-clamp-2 break-words hyphens-auto text-center",title:se.name,children:FC(se.name,f)}),a.jsxs("div",{className:"text-[11px] leading-[15px] opacity-70",children:[se.w,"  ",se.h]})]})]},se.path)})},D.key)}),m&&E&&M&&fu.createPortal(a.jsx("div",{className:"toolbar-offset fixed inset-0 z-[999] flex items-center justify-center pointer-events-none bg-black/20 opacity-100",children:a.jsx("img",{src:E,alt:"preview",className:"max-w-[80vw] max-h-[80vh] object-contain opacity-[0.98]"})}),document.body)]},`${b}-${re}`),y&&e.length===0&&a.jsx("div",{className:"pointer-events-none absolute inset-3 z-20 flex items-center justify-center",children:a.jsxs("div",{className:"w-full max-w-[580px] rounded-lg border border-border bg-panel/95 px-4 py-3 shadow-lg",children:[a.jsx("div",{className:"flex items-center justify-between gap-3 text-xs text-text",children:a.jsx("span",{className:"font-semibold",children:"Loading gallery"})}),a.jsx("div",{className:"mt-2 text-[11px] text-muted",children:"Preparing gallery"})]})})]})}const DC=48,zC=[.1,.24,.5,.74,.9];function $C({items:e,metricKey:t,scrollRef:n,sortDir:r}){const{orderedValues:s,numericValues:i}=u.useMemo(()=>{var P;const M=[],I=[];for(const B of e){const F=(P=B.metrics)==null?void 0:P[t],K=F==null||Number.isNaN(F)?null:F;M.push(K),K!=null&&I.push(K)}return{orderedValues:M,numericValues:I}},[e,t]),o=u.useMemo(()=>BC(i,DC),[i]),l=u.useMemo(()=>UC(i,zC),[i]),[c,d]=u.useState(0),[f,p]=u.useState(null),[h,w]=u.useState(!1),x=u.useRef(null);if(u.useEffect(()=>{const M=n.current;if(!M)return;const I=()=>{const P=Math.max(1,M.scrollHeight-M.clientHeight),B=hs(P>0?M.scrollTop/P:0);d(B)};return I(),M.addEventListener("scroll",I,{passive:!0}),window.addEventListener("resize",I),()=>{M.removeEventListener("scroll",I),window.removeEventListener("resize",I)}},[n,e.length]),u.useEffect(()=>{p(null)},[t,e.length]),!o)return null;const b={min:o.min,max:o.max},C=f!=null?jm(f):null,v=jm(c),g=r==="desc",y=u.useMemo(()=>f==null?null:HC(s,f),[s,f]);function m(M){p(hs(M))}function S(){p(null)}function E(M){const I=n.current;if(!I)return;const P=Math.max(0,I.scrollHeight-I.clientHeight);I.scrollTop=hs(M)*P}function j(M){var P;const I=(P=x.current)==null?void 0:P.getBoundingClientRect();return I?hs((M.clientY-I.top)/I.height):null}return a.jsxs("div",{className:"absolute right-0 top-3 bottom-3 w-[14px] flex items-stretch pointer-events-auto",children:[a.jsxs("svg",{ref:x,viewBox:"0 0 10 100",preserveAspectRatio:"none",className:"w-full h-full rounded bg-surface-inset border border-border/60 cursor-ns-resize",onPointerDown:M=>{var P;M.preventDefault();const I=j(M);I!=null&&(w(!0),m(I),E(I),(P=x.current)==null||P.setPointerCapture(M.pointerId))},onPointerMove:M=>{const I=j(M);if(I==null){h||S();return}m(I),h&&E(I)},onPointerUp:M=>{var I;w(!1),(I=x.current)==null||I.releasePointerCapture(M.pointerId)},onPointerLeave:()=>{h||S()},children:[VC(o.bins,"var(--border-strong)",{flip:g}),WC(l,b,{flip:g,color:"var(--muted)"}),Nm(v,{color:"var(--highlight)",strokeWidth:.8}),C!=null&&Nm(C,{color:"var(--text-secondary)",strokeWidth:.6,dashed:!0})]}),y!=null&&f!=null&&a.jsx("div",{className:"pointer-events-none absolute right-full mr-2 px-1.5 py-0.5 rounded border border-border bg-surface text-[10px] text-text shadow",style:{top:`calc(${(f*100).toFixed(2)}% - 8px)`},children:KC(y)})]})}function BC(e,t){if(!e.length)return null;const n=Math.min(...e);let r=Math.max(...e);n===r&&(r=n+1);const s=new Array(t).fill(0),i=t/(r-n);for(const o of e){const l=Math.max(0,Math.min(t-1,Math.floor((o-n)*i)));s[l]+=1}return{bins:s,min:n,max:r}}function UC(e,t){if(!e.length)return[];const n=[...e].sort((s,i)=>s-i),r=n.length-1;return t.map(s=>{const i=r*s,o=Math.floor(i),l=Math.ceil(i);if(o===l)return n[o];const c=i-o;return n[o]+(n[l]-n[o])*c})}function VC(e,t,n){const r=Math.max(1,...e),s=100/e.length,i=(n==null?void 0:n.flip)??!1;return e.map((o,l)=>{const c=Math.max(.8,o/r*10),d=(i?e.length-1-l:l)*s;return a.jsx("rect",{x:10-c,y:d,width:c,height:Math.max(.2,s-.2),fill:t,opacity:.9},`sb-${l}`)})}function WC(e,t,n){const r=(n==null?void 0:n.flip)??!1,s=n==null?void 0:n.color;return e.map((i,o)=>{const l=QC(i,t,r),c=o===2;return a.jsx("line",{x1:0,y1:l,x2:10,y2:l,stroke:s,strokeWidth:c?.8:.5,opacity:c?.9:.6,vectorEffect:"non-scaling-stroke"},`qt-${o}-${i}`)})}function Nm(e,t){return a.jsx("line",{x1:0,y1:e,x2:10,y2:e,stroke:t.color,strokeWidth:t.strokeWidth??.6,strokeDasharray:t.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}function HC(e,t){if(!e.length)return null;const n=Math.round(hs(t)*(e.length-1)),r=e[n];if(r!=null)return r;for(let s=1;s<e.length;s++){const i=n-s;if(i>=0&&e[i]!=null)return e[i];const o=n+s;if(o<e.length&&e[o]!=null)return e[o]}return null}function QC(e,t,n){const r=t.max-t.min;if(r===0)return 0;const s=hs((e-t.min)/r);return(n?1-s:s)*100}function jm(e){return hs(e)*100}function hs(e){return e<0?0:e>1?1:e}function KC(e){if(e==null||Number.isNaN(e))return"-";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function ps(e,t){const[n,r]=u.useState(null),s=u.useRef(null);return u.useEffect(()=>{if(!e){if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}r(null);return}let i=!0;return e().then(o=>{if(!i)return;const l=URL.createObjectURL(o);if(s.current)try{URL.revokeObjectURL(s.current)}catch{}s.current=l,r(l)}).catch(()=>{}),()=>{i=!1}},t),u.useEffect(()=>()=>{if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}},[]),n}const qC=1.2,GC=.05,YC=8;function bc(e){return Number(Math.min(YC,Math.max(GC,e)).toFixed(4))}function Mm(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Rm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function XC(e,t){try{e.setPointerCapture(t)}catch{}}function JC(e,t){try{e.releasePointerCapture(t)}catch{}}function ZC(){const[e,t]=u.useState(1),[n,r]=u.useState(0),[s,i]=u.useState(0),[o,l]=u.useState(1),[c,d]=u.useState(!1),[f,p]=u.useState(!1),[h,w]=u.useState(!1),x=u.useRef(null),b=u.useRef(null),C=u.useRef(1),v=u.useRef(0),g=u.useRef(0),y=u.useRef(new Map),m=u.useRef(null),S=u.useRef(null),E=(R,T)=>{v.current=R,g.current=T,r(R),i(T)},j=R=>{const T=bc(R);C.current=T,t(T)},M=(R,T)=>{m.current={pointerId:R,startX:T.x,startY:T.y,startTx:v.current,startTy:g.current},S.current=null,p(!0)},I=()=>{const R=Array.from(y.current.entries());if(R.length<2)return;const[T,A]=R,[O,H]=T,[U,_]=A,Q=Mm(H,_);!Number.isFinite(Q)||Q<=2||(S.current={pointerIds:[O,U],startDistance:Q,startCenter:Rm(H,_),startScale:C.current,startTx:v.current,startTy:g.current},m.current=null,p(!0))},P=()=>{const R=x.current,T=b.current;if(!R||!T||!T.naturalWidth||!T.naturalHeight)return;const A=R.getBoundingClientRect(),O=A.width/T.naturalWidth,H=A.height/T.naturalHeight,U=Math.min(1,Math.min(O,H));l(U);const _=T.naturalWidth*U,Q=T.naturalHeight*U;E((A.width-_)/2,(A.height-Q)/2),j(1)};u.useEffect(()=>{const R=x.current;if(!R)return;const T=new ResizeObserver(()=>{try{requestAnimationFrame(()=>P())}catch{P()}});return T.observe(R),()=>T.disconnect()},[]),u.useEffect(()=>{C.current=e,v.current=n,g.current=s},[e,n,s]),u.useEffect(()=>()=>{y.current.clear(),m.current=null,S.current=null},[]);const B=R=>{R.preventDefault();const T=R.deltaY>0?-1:1,A=x.current;if(!A)return;const O=A.getBoundingClientRect(),H=R.clientX-O.left,U=R.clientY-O.top,_=C.current,Q=bc(_*Math.pow(qC,T));if(Q===_)return;const V=Q/_,ee=H-V*(H-v.current),ie=U-V*(U-g.current);j(Q),E(ee,ie)},F=R=>{if((R.pointerType??"mouse")==="mouse"&&R.button!==0)return;const A=y.current,O=b.current;if(!O||A.size===0&&R.target!==O)return;const H=R.currentTarget,U=H.getBoundingClientRect();if(!(R.clientX<U.left||R.clientX>U.right||R.clientY<U.top||R.clientY>U.bottom)){if(R.preventDefault(),R.stopPropagation(),A.set(R.pointerId,{x:R.clientX,y:R.clientY}),XC(H,R.pointerId),A.size>=2){I();return}M(R.pointerId,{x:R.clientX,y:R.clientY})}},K=R=>{const T=y.current;if(!T.has(R.pointerId))return;T.set(R.pointerId,{x:R.clientX,y:R.clientY});const A=S.current;if(A){const _=T.get(A.pointerIds[0]),Q=T.get(A.pointerIds[1]);if(_&&Q){const V=Mm(_,Q);if(V>2){const ee=Rm(_,Q),ie=bc(A.startScale*(V/A.startDistance)),q=ie/A.startScale,G=ee.x-q*(A.startCenter.x-A.startTx),X=ee.y-q*(A.startCenter.y-A.startTy);j(ie),E(G,X)}}return}const O=m.current;if(!O||O.pointerId!==R.pointerId)return;const H=R.clientX-O.startX,U=R.clientY-O.startY;E(O.startTx+H,O.startTy+U)},Z=(R,T)=>{const A=y.current;if(!A.has(R))return;if(A.delete(R),JC(T,R),A.size===0){m.current=null,S.current=null,p(!1);return}if(A.size>=2){I();return}const[O,H]=A.entries().next().value;M(O,H)};return{scale:e,setScale:t,tx:n,setTx:r,ty:s,setTy:i,base:o,setBase:l,ready:c,setReady:d,dragging:f,setDragging:p,visible:h,setVisible:w,containerRef:x,imgRef:b,fitAndCenter:P,handleWheel:B,handlePointerDown:F,handlePointerMove:K,handlePointerUp:R=>{Z(R.pointerId,R.currentTarget)},handlePointerCancel:R=>{Z(R.pointerId,R.currentTarget)}}}function ek({path:e,onClose:t,onNavigate:n,canPrev:r=!1,canNext:s=!1,onZoomChange:i,requestedZoomPercent:o,onZoomRequestConsumed:l}){const{scale:c,setScale:d,tx:f,setTx:p,ty:h,setTy:w,base:x,ready:b,setReady:C,dragging:v,visible:g,setVisible:y,containerRef:m,imgRef:S,fitAndCenter:E,handleWheel:j,handlePointerDown:M,handlePointerMove:I,handlePointerUp:P,handlePointerCancel:B}=ZC(),F=ps(()=>me.getFile(e),[e]),K=ps(()=>me.getThumb(e),[e]),Z=u.useCallback(()=>{y(!1),window.setTimeout(t,110)},[t,y]);return u.useEffect(()=>{requestAnimationFrame(()=>{var z;y(!0),(z=m.current)==null||z.focus()})},[e]),u.useEffect(()=>{const z=L=>{L.key==="Escape"?Z():(L.key==="ArrowRight"||L.key==="d")&&n?n(1):(L.key==="ArrowLeft"||L.key==="a")&&n&&n(-1)};return window.addEventListener("keydown",z),()=>window.removeEventListener("keydown",z)},[Z,n]),u.useEffect(()=>{C(!1)},[F]),u.useEffect(()=>{i&&i(x*c*100)},[x,c,i]),u.useEffect(()=>{if(o==null)return;const z=m.current;if(!z){l&&l();return}const L=Math.max(.05,Math.min(8,o/100/Math.max(1e-6,x))),R=z.getBoundingClientRect(),T=R.width/2,A=R.height/2;d(O=>{const H=L/O;return p(U=>T-H*(T-U)),w(U=>A-H*(A-U)),Number(L.toFixed(4))}),l&&l()},[o,x,l]),a.jsxs("div",{ref:m,role:"dialog","aria-modal":!0,"aria-label":"Image viewer",tabIndex:-1,className:`toolbar-offset touch-none absolute inset-0 left-[var(--left)] right-[var(--right)] flex items-start justify-start bg-panel z-viewer overflow-hidden transition-opacity duration-[110ms] ease-out cursor-grab focus:outline-none focus-visible:outline-none ${v?"cursor-grabbing select-none":""} ${g?"opacity-100":"opacity-0"}`,style:{outline:"none"},onClick:Z,onWheel:j,onPointerDown:M,onPointerMove:I,onPointerUp:P,onPointerCancel:B,onKeyDown:z=>{z.key==="Tab"&&z.preventDefault()},children:[a.jsxs("button",{"aria-label":"Close",onClick:z=>{z.stopPropagation(),Z()},className:"btn btn-sm absolute top-3 right-3 z-10",title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]}),K&&a.jsx("img",{src:K,alt:"thumb",className:"absolute top-0 left-0 max-w-none max-h-none object-contain pointer-events-none transition-opacity duration-[110ms] ease-out",draggable:!1,onDragStart:z=>z.preventDefault(),style:{transform:`translate(${f}px, ${h}px) scale(${x})`,transformOrigin:"0 0",opacity:b?0:.5,filter:"blur(0.25px)"}}),F&&a.jsx("img",{ref:S,src:F,alt:"viewer",className:"max-w-none max-h-none object-contain transition-opacity duration-[110ms] ease-out will-change-transform select-none",draggable:!1,onDragStart:z=>{z.preventDefault()},onLoad:z=>{E(),d(1);try{requestAnimationFrame(()=>C(!0))}catch{C(!0)}},onClick:z=>z.stopPropagation(),style:{transform:`translate(${f}px, ${h}px) scale(${x*c})`,transformOrigin:"0 0",opacity:b?.99:0,WebkitUserDrag:"none"}}),n&&a.jsxs("div",{className:"viewer-mobile-nav",onClick:z=>z.stopPropagation(),children:[a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${r?"":"is-disabled"}`,onClick:()=>r&&n(-1),"aria-label":"Previous image","aria-disabled":!r,disabled:!r,children:"Prev"}),a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${s?"":"is-disabled"}`,onClick:()=>s&&n(1),"aria-label":"Next image","aria-disabled":!s,disabled:!s,children:"Next"})]})]})}function ch(e){return!e||!(e instanceof HTMLElement)?!1:e.closest('input, textarea, [contenteditable="true"]')!==null}const tk=1.2,nk=.05,rk=8;function Sc(e){return Number(Math.min(rk,Math.max(nk,e)).toFixed(4))}function Pm(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Tm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function sk(e,t){try{e.setPointerCapture(t)}catch{}}function ik(e,t){try{e.releasePointerCapture(t)}catch{}}function ok(){const[e,t]=u.useState(1),[n,r]=u.useState(0),[s,i]=u.useState(0),[o,l]=u.useState(0),[c,d]=u.useState(0),[f,p]=u.useState(1),[h,w]=u.useState(1),[x,b]=u.useState(!1),C=u.useRef(null),v=u.useRef(null),g=u.useRef(null),y=u.useRef(1),m=u.useRef(0),S=u.useRef(0),E=u.useRef(0),j=u.useRef(0),M=u.useRef(new Map),I=u.useRef(null),P=u.useRef(null),B=u.useCallback(_=>{m.current=_.txA,S.current=_.tyA,E.current=_.txB,j.current=_.tyB,r(_.txA),i(_.tyA),l(_.txB),d(_.tyB)},[]),F=u.useCallback(_=>{const Q=Sc(_);y.current=Q,t(Q)},[]),K=u.useCallback((_,Q)=>{I.current={pointerId:_,startX:Q.x,startY:Q.y,startTxA:m.current,startTyA:S.current,startTxB:E.current,startTyB:j.current},P.current=null,b(!0)},[]),Z=u.useCallback(()=>{const _=Array.from(M.current.entries());if(_.length<2)return;const[Q,V]=_,[ee,ie]=Q,[q,G]=V,X=Pm(ie,G);!Number.isFinite(X)||X<=2||(P.current={pointerIds:[ee,q],startDistance:X,startCenter:Tm(ie,G),startScale:y.current,startTxA:m.current,startTyA:S.current,startTxB:E.current,startTyB:j.current},I.current=null,b(!0))},[]),z=u.useCallback((_,Q)=>{const V=M.current;if(!V.has(_))return;if(V.delete(_),ik(Q,_),V.size===0){I.current=null,P.current=null,b(!1);return}if(V.size>=2){Z();return}const[ee,ie]=V.entries().next().value;K(ee,ie)},[K,Z]),L=u.useCallback(()=>{const _=C.current;if(!_)return;const Q=_.getBoundingClientRect(),V=q=>{if(!q||!q.naturalWidth||!q.naturalHeight)return;const G=Q.width/q.naturalWidth,X=Q.height/q.naturalHeight,ce=Math.min(1,Math.min(G,X)),Ee=q.naturalWidth*ce,Se=q.naturalHeight*ce;return{base:ce,tx:(Q.width-Ee)/2,ty:(Q.height-Se)/2}},ee=V(v.current);ee&&(p(ee.base),m.current=ee.tx,S.current=ee.ty,r(ee.tx),i(ee.ty));const ie=V(g.current);ie&&(w(ie.base),E.current=ie.tx,j.current=ie.ty,l(ie.tx),d(ie.ty))},[]);u.useEffect(()=>{const _=C.current;if(!_)return;const Q=new ResizeObserver(()=>{try{requestAnimationFrame(()=>L())}catch{L()}});return Q.observe(_),()=>Q.disconnect()},[L]);const R=u.useCallback(()=>{F(1),L()},[L,F]);u.useEffect(()=>{y.current=e,m.current=n,S.current=s,E.current=o,j.current=c},[e,n,s,o,c]),u.useEffect(()=>()=>{M.current.clear(),I.current=null,P.current=null},[]);const T=u.useCallback(_=>{_.preventDefault();const Q=_.deltaY>0?-1:1,V=C.current;if(!V)return;const ee=V.getBoundingClientRect(),ie=_.clientX-ee.left,q=_.clientY-ee.top,G=y.current,X=Sc(G*Math.pow(tk,Q));if(X===G)return;const ce=X/G;F(X),B({txA:ie-ce*(ie-m.current),tyA:q-ce*(q-S.current),txB:ie-ce*(ie-E.current),tyB:q-ce*(q-j.current)})},[B,F]),A=u.useCallback(_=>{if((_.pointerType??"mouse")==="mouse"&&_.button!==0)return;const V=_.currentTarget;if(_.preventDefault(),M.current.set(_.pointerId,{x:_.clientX,y:_.clientY}),sk(V,_.pointerId),M.current.size>=2){Z();return}K(_.pointerId,{x:_.clientX,y:_.clientY})},[K,Z]),O=u.useCallback(_=>{const Q=M.current;if(!Q.has(_.pointerId))return;Q.set(_.pointerId,{x:_.clientX,y:_.clientY});const V=P.current;if(V){const G=Q.get(V.pointerIds[0]),X=Q.get(V.pointerIds[1]);if(G&&X){const ce=Pm(G,X);if(ce>2){const Ee=Tm(G,X),Se=Sc(V.startScale*(ce/V.startDistance)),he=Se/V.startScale;F(Se),B({txA:Ee.x-he*(V.startCenter.x-V.startTxA),tyA:Ee.y-he*(V.startCenter.y-V.startTyA),txB:Ee.x-he*(V.startCenter.x-V.startTxB),tyB:Ee.y-he*(V.startCenter.y-V.startTyB)})}}return}const ee=I.current;if(!ee||ee.pointerId!==_.pointerId)return;const ie=_.clientX-ee.startX,q=_.clientY-ee.startY;B({txA:ee.startTxA+ie,tyA:ee.startTyA+q,txB:ee.startTxB+ie,tyB:ee.startTyB+q})},[B,F]),H=u.useCallback(_=>{z(_.pointerId,_.currentTarget)},[z]),U=u.useCallback(_=>{z(_.pointerId,_.currentTarget)},[z]);return{scale:e,baseA:f,baseB:h,txA:n,tyA:s,txB:o,tyB:c,dragging:x,containerRef:C,imgARef:v,imgBRef:g,fitAndCenter:L,resetView:R,handleWheel:T,handlePointerDown:A,handlePointerMove:O,handlePointerUp:H,handlePointerCancel:U}}function lk({aItem:e,bItem:t,index:n,total:r,canPrev:s,canNext:i,onNavigate:o,onClose:l}){const c=u.useRef(null),[d,f]=u.useState(50),[p,h]=u.useState(!1),[w,x]=u.useState(!1),{scale:b,baseA:C,baseB:v,txA:g,tyA:y,txB:m,tyB:S,dragging:E,containerRef:j,imgARef:M,imgBRef:I,fitAndCenter:P,resetView:B,handleWheel:F,handlePointerDown:K,handlePointerMove:Z,handlePointerUp:z,handlePointerCancel:L}=ok(),R=(e==null?void 0:e.path)??null,T=(t==null?void 0:t.path)??null,A=(e==null?void 0:e.name)??R??"Select an image",O=(t==null?void 0:t.name)??T??"Select another image";u.useEffect(()=>{requestAnimationFrame(()=>{var q;return(q=c.current)==null?void 0:q.focus()})},[R,T]),u.useEffect(()=>{B(),h(!1),x(!1)},[R,T,B]),u.useEffect(()=>{const q=G=>{if(!ch(G.target)){if(G.key==="Escape"){G.preventDefault(),l();return}if((G.key==="ArrowRight"||G.key==="d")&&i){G.preventDefault(),o(1);return}(G.key==="ArrowLeft"||G.key==="a")&&s&&(G.preventDefault(),o(-1))}};return window.addEventListener("keydown",q),()=>window.removeEventListener("keydown",q)},[l,o,s,i]);const H=ps(R?()=>me.getFile(R):null,[R]),U=ps(T?()=>me.getFile(T):null,[T]),_=ps(R?()=>me.getThumb(R):null,[R]),Q=ps(T?()=>me.getThumb(T):null,[T]),V=u.useCallback(q=>Math.min(95,Math.max(5,q)),[]),ee=u.useCallback(q=>{const G=q.target;G!=null&&G.closest(".compare-label")||G!=null&&G.closest(".compare-divider-hit")||K(q)},[K]),ie=u.useCallback(q=>{const G=j.current;if(!G)return;q.preventDefault(),q.stopPropagation();const X=G.getBoundingClientRect(),ce=q.currentTarget;ce.setPointerCapture(q.pointerId);const Ee=he=>{const Fe=(he.clientX-X.left)/X.width*100;f(V(Fe))},Se=he=>{try{ce.releasePointerCapture(he.pointerId)}catch{}window.removeEventListener("pointermove",Ee),window.removeEventListener("pointerup",Se),window.removeEventListener("pointercancel",Se)};window.addEventListener("pointermove",Ee),window.addEventListener("pointerup",Se),window.addEventListener("pointercancel",Se)},[V]);return a.jsxs("div",{ref:c,role:"dialog","aria-modal":!0,"aria-label":"Compare images",tabIndex:-1,className:"toolbar-offset absolute inset-0 left-[var(--left)] right-[var(--right)] bg-panel z-viewer flex flex-col overflow-hidden focus:outline-none",onKeyDown:q=>{q.key==="Tab"&&q.preventDefault()},children:[a.jsxs("div",{className:"compare-header flex items-center gap-3 px-3 py-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Compare"}),a.jsx("div",{className:"text-xs text-muted",children:r>=2?`${n+1}-${Math.min(n+2,r)} of ${r}`:"Select 2 images"}),a.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(-1),disabled:!s,title:"Previous (Left Arrow or A)",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Prev"]}),a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(1),disabled:!i,title:"Next (Right Arrow or D)",children:["Next",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"btn btn-sm",onClick:l,title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]})]})]}),a.jsx("div",{className:"flex-1 min-h-0 p-3 bg-panel",children:a.jsx("div",{ref:j,className:`compare-stage ${E?"is-dragging":""}`,onWheel:F,onPointerDown:ee,onPointerMove:Z,onPointerUp:z,onPointerCancel:L,children:!e||!t?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-sm text-muted",children:"Select 2 images to compare."}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"compare-label left-3",children:[a.jsx("span",{className:"compare-label-tag",children:"A"}),a.jsx("span",{className:"truncate",title:e.path,children:A})]}),a.jsxs("div",{className:"compare-label right-3",children:[a.jsx("span",{className:"compare-label-tag",children:"B"}),a.jsx("span",{className:"truncate",title:t.path,children:O})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 ${100-d}% 0 0)`},children:[_&&a.jsx("img",{src:_,alt:"thumb A",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:q=>q.preventDefault(),style:{transform:`translate(${g}px, ${y}px) scale(${C})`,transformOrigin:"0 0",opacity:p?0:.5}}),H&&a.jsx("img",{ref:M,src:H,alt:"compare A",className:"compare-image",draggable:!1,onDragStart:q=>q.preventDefault(),onLoad:()=>{P();try{requestAnimationFrame(()=>h(!0))}catch{h(!0)}},style:{transform:`translate(${g}px, ${y}px) scale(${C*b})`,transformOrigin:"0 0",opacity:p?.99:0}})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 0 0 ${d}%)`},children:[Q&&a.jsx("img",{src:Q,alt:"thumb B",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:q=>q.preventDefault(),style:{transform:`translate(${m}px, ${S}px) scale(${v})`,transformOrigin:"0 0",opacity:w?0:.5}}),U&&a.jsx("img",{ref:I,src:U,alt:"compare B",className:"compare-image",draggable:!1,onDragStart:q=>q.preventDefault(),onLoad:()=>{P();try{requestAnimationFrame(()=>x(!0))}catch{x(!0)}},style:{transform:`translate(${m}px, ${S}px) scale(${v*b})`,transformOrigin:"0 0",opacity:w?.99:0}})]}),a.jsxs("div",{className:"compare-divider-hit",style:{left:`${d}%`},onPointerDown:ie,children:[a.jsx("div",{className:"compare-divider-line"}),a.jsx("div",{className:"compare-divider-handle"})]})]})})})]})}function vu(){const[e,t]=u.useState(WS());return u.useEffect(()=>VS(t),[]),e}const Vo=e=>["item",e],ak={v:1,tags:[],notes:"",version:1,updated_at:"",updated_by:"web"},jn=new Map,ua=new Map,Wd=new Map,dh=new Map;let Im=0;const Jn=new Map,fo=new Map,uk=12e3,Hd=new Set,Qd=new Set;let fh={state:"idle"},Wo=null,Kd=0;function Fl(e){fh=e;for(const t of Hd)t(e)}function hr(){const e=Jn.size>0,t=jn.size+ua.size+Kd;if(e){Fl({state:"error",message:"Conflict detected"});return}if(Wo){Fl({state:"error",message:Wo});return}if(t>0){Fl({state:"syncing"});return}Fl({state:"idle"})}function hh(){let e=null;for(const t of Wd.values())e=e==null?t:Math.min(e,t);for(const t of dh.values())e=e==null?t:Math.min(e,t);return e}function Ua(){const e=hh();for(const t of Qd)t(e)}function Va(e){Wo=e,hr()}function wx(){Wo&&(Wo=null,hr())}function Lm(e){Kd=Math.max(0,Kd+e),hr()}function ck(){Im+=1;const e=Im;return dh.set(e,Date.now()),Ua(),e}function dk(e){e!=null&&dh.delete(e)&&Ua()}function yu(e){const t=fo.get(e);if(!t||!t.size)return;const n=Jn.get(e)??null;for(const r of t)r(n)}function _m(e){return Jn.get(e)??null}function xu(e){Jn.delete(e)&&(yu(e),hr())}function fk(e,t){Jn.set(e,t),yu(e),hr()}function hk(e,t){const n=fo.get(e)??new Set;return n.add(t),fo.set(e,n),t(Jn.get(e)??null),()=>{const r=fo.get(e);r&&(r.delete(t),r.size||fo.delete(e))}}function pk(e){const[t,n]=u.useState(()=>e?_m(e):null);return u.useEffect(()=>{if(!e){n(null);return}return n(_m(e)),hk(e,n)},[e]),t}function mk(e){return Hd.add(e),e(fh),()=>{Hd.delete(e)}}function gk(){const[e,t]=u.useState(fh);return u.useEffect(()=>mk(t),[]),e}function vk(e){return Qd.add(e),e(hh()),()=>{Qd.delete(e)}}function yk(){const[e,t]=u.useState(()=>hh()),[n,r]=u.useState(()=>e==null?null:Date.now()-e);return u.useEffect(()=>vk(t),[]),u.useEffect(()=>{if(e==null){r(null);return}r(Date.now()-e);const s=window.setInterval(()=>{r(Date.now()-e)},1e3);return()=>window.clearInterval(s)},[e]),n}function qd(e){const t={};return Object.prototype.hasOwnProperty.call(e,"star")&&(t.set_star=e.star??null),Object.prototype.hasOwnProperty.call(e,"notes")&&(t.set_notes=e.notes??""),Object.prototype.hasOwnProperty.call(e,"tags")&&(t.set_tags=Array.isArray(e.tags)?e.tags:[]),t}function Gd(e){var t,n;return e.set_star!==void 0||e.set_notes!==void 0||e.set_tags!==void 0||(((t=e.add_tags)==null?void 0:t.length)??0)>0||(((n=e.remove_tags)==null?void 0:n.length)??0)>0}function ro(e){const t=[],n=new Set;for(const r of e??[]){if(typeof r!="string")continue;const s=r.trim();!s||n.has(s)||(n.add(s),t.push(s))}return t}function xk(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function wk(e,t){if(e.set_star!==void 0&&(t.star??null)!==e.set_star||e.set_notes!==void 0&&(t.notes??"")!==(e.set_notes??""))return!1;if(e.set_tags!==void 0){const r=ro(e.set_tags),s=ro(t.tags);return xk(r,s)}const n=ro(t.tags);for(const r of ro(e.add_tags))if(!n.includes(r))return!1;for(const r of ro(e.remove_tags))if(n.includes(r))return!1;return!0}function bx(e,t,n){if(n instanceof ln&&n.status===409){const r=n.body;if(r!=null&&r.current)return fk(e,{path:e,current:r.current,pending:t,receivedAt:new Date().toISOString()}),!0}return!1}function bk(e,t){const n=Jn.get(e);if(n){if(wk(n.pending,t)){xu(e);return}Jn.set(e,{...n,current:t}),yu(e),hr()}}function Sk(e){const t=vu();return hu({queryKey:Vo(e),queryFn:()=>me.getSidecar(e),enabled:!!e,staleTime:3e4,gcTime:5*6e4,retry:2,refetchInterval:t?uk:!1,refetchIntervalInBackground:t})}function Ck(e){const t=wr();return eS({mutationFn:async({patch:n,baseVersion:r,idempotencyKey:s})=>{const i=qd(n);if(!Gd(i))return t.getQueryData(Vo(e))??ak;const o={...i,base_version:r};try{return await me.patchSidecar(e,o,{idempotencyKey:s??gu("patch"),ifMatch:r})}catch(l){throw bx(e,i,l),l}},retry:(n,r)=>r instanceof ln&&r.status===409?!1:n<2,retryDelay:n=>Math.min(1e3*Math.pow(2,n),4e3),onMutate:()=>(wx(),Lm(1),{inflightId:ck()}),onSuccess:n=>{xu(e),t.setQueryData(Vo(e),n)},onError:n=>{n instanceof ln&&n.status===409||(n instanceof ln?Va(n.message):Va("Failed to save"))},onSettled:(n,r,s,i)=>{Lm(-1),dk(i==null?void 0:i.inflightId)}})}const kk=6;async function Sx(e,t){if(!e.length)return;let n=0;const r=[],s=async()=>{for(;n<e.length;){const o=n++,l=e[o];try{await Cx(l,t)}catch(c){r.push({path:l,error:c}),console.error(`[bulkUpdateSidecars] Failed for ${l}:`,c)}}},i=Array.from({length:Math.min(kk,e.length)},()=>s());if(await Promise.all(i),r.length===e.length)throw new Error(`All ${e.length} sidecar updates failed`)}async function Cx(e,t){const n=jn.get(e)||{};jn.set(e,{...n,...t}),wx(),hr();const r=ua.get(e);if(r)return r;Wd.set(e,Date.now()),Ua();const s=(async()=>{try{for(;jn.has(e);){const i=jn.get(e);if(!i)break;const o=qd(i);if(!Gd(o)){jn.get(e)===i&&jn.delete(e);continue}let l=1;try{l=(await me.getSidecar(e)).version??1}catch{l=1}const c={...o,base_version:l};try{await me.patchSidecar(e,c,{idempotencyKey:gu("patch"),ifMatch:l}),xu(e),jn.get(e)===i&&jn.delete(e)}catch(d){if(bx(e,o,d)){const p=jn.get(e);if(p&&p!==i){const h=qd(p);if(Gd(h)){const w=Jn.get(e);w&&(Jn.set(e,{...w,pending:h}),yu(e))}}jn.delete(e)}else d instanceof ln?Va(d.message):Va("Failed to save");throw d}}}finally{ua.delete(e),Wd.delete(e),Ua(),hr()}})();return ua.set(e,s),hr(),s}function nl(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function kx(e){return e==="pil_info"||e.startsWith("pil_info.")||e.startsWith("pil_info[")}function Yd(e,t){if(typeof t=="number")return e?`${e}[${t}]`:`[${t}]`;const n=/^[A-Za-z0-9_$-]+$/.test(t);return e?n?`${e}.${t}`:`${e}["${t}"]`:n?t:`["${t}"]`}function Wa(e){return e==null?String(e):typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):Array.isArray(e)?`[${e.map(Wa).join(",")}]`:typeof e=="object"?`{${Object.entries(e).sort(([n],[r])=>n.localeCompare(r)).map(([n,r])=>`${n}:${Wa(r)}`).join(",")}}`:String(e)}function Ol(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return String(e);try{return JSON.stringify(e,null,1)}catch{return String(e)}}function Ha(e,t,n,r,s){if(s.skipPilInfo&&kx(t))return;const i=t||"(root)";if(r>=s.maxDepth){n.set(i,e);return}if(Array.isArray(e)){if(!e.length){n.set(i,[]);return}if(e.length>s.maxArray){n.set(i,e);return}e.forEach((o,l)=>Ha(o,Yd(t,l),n,r+1,s));return}if(nl(e)){const o=Object.keys(e).sort((l,c)=>l.localeCompare(c));if(!o.length){n.set(t||"(root)",{});return}for(const l of o)s.skipPilInfo&&!t&&l==="pil_info"||Ha(e[l],Yd(t,l),n,r+1,s);return}n.set(i,e)}function ca(e){if(Array.isArray(e))return e.map(ca);if(e&&typeof e=="object")return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,ca(n)]));if(typeof e=="string"){const t=e.trim();if(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]")||t.startsWith('"')&&t.endsWith('"'))try{const r=JSON.parse(t);return ca(r)}catch{return e}}return e}function Cc(e){return e?ca(e):null}function kc(e,t){if(!e)return null;if(!t&&nl(e)&&"pil_info"in e){const n={};for(const[r,s]of Object.entries(e))n[r]=r==="pil_info"?"Hidden (toggle Show PIL info to expand)":s;return n}return e}function So(e,t=[]){return e===null?{kind:"null",text:"null"}:e===void 0?{kind:"undefined",text:"undefined"}:typeof e=="string"?{kind:"string",text:JSON.stringify(e)}:typeof e=="number"?{kind:"number",text:String(e)}:typeof e=="boolean"?{kind:"boolean",text:e?"true":"false"}:Array.isArray(e)?{kind:"array",items:e.map((n,r)=>So(n,[...t,r]))}:nl(e)?{kind:"object",entries:Object.keys(e).map(n=>{const r=[...t,n];return{key:n,path:r,value:So(e[n],r)}})}:{kind:"fallback",text:String(e)}}function Ek(e){let t="";for(const n of e)t=Yd(t,n);return t||"(root)"}function Nk(e,t){let n=e;for(const r of t){if(typeof r=="number"){if(!Array.isArray(n))return;n=n[r];continue}if(!nl(n))return;n=n[r]}return n}function jk(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e;try{return JSON.stringify(e,null,1)}catch{return String(e)}}function Ec(e,t){const n=Nk(e,t);return{pathLabel:Ek(t),copyText:jk(n)}}function Nc(e){return!!e&&nl(e)&&"pil_info"in e}function Mk(e,t,n){if(e==null||t==null)return null;const r=new Map,s=new Map,i={maxDepth:n.maxDepth,maxArray:n.maxArray,skipPilInfo:!n.includePilInfo};Ha(e,"",r,0,i),Ha(t,"",s,0,i);const o=new Set([...r.keys(),...s.keys()]),l=[];let c=0,d=0,f=0;const p=Array.from(o).sort((b,C)=>b.localeCompare(C)),h=!n.includePilInfo;for(const b of p){if(h&&kx(b))continue;const C=r.has(b),v=s.has(b);if(!C&&v){d+=1,l.push({key:b,kind:"onlyB",aText:"",bText:Ol(s.get(b))});continue}if(C&&!v){c+=1,l.push({key:b,kind:"onlyA",aText:Ol(r.get(b)),bText:""});continue}const g=r.get(b),y=s.get(b),m=Wa(g),S=Wa(y);m!==S&&(f+=1,l.push({key:b,kind:"different",aText:Ol(g),bText:Ol(y)}))}const w=Math.max(0,l.length-n.limit);return{entries:w?l.slice(0,n.limit):l,onlyA:c,onlyB:d,different:f,truncatedCount:w}}function Xd(e){const t=["B","KB","MB","GB","TB"];let n=0,r=e;for(;r>=1024&&n<t.length-1;)r/=1024,n+=1;return`${r.toFixed(1)} ${t[n]}`}function Ex(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function jc(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function Rk(e,t=28){if(e.length<=t)return e;const n=Math.max(4,Math.floor((t-1)/2));return`${e.slice(0,n)}${e.slice(-n)}`}const Pk=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"});function Tk(e){const t=e.trim();return!t||/[zZ]|[+-]\d{2}:?\d{2}$/.test(t)?t:`${t.includes("T")?t:t.replace(" ","T")}Z`}function Nx(e){if(!e)return null;const t=Date.parse(Tk(e));return Number.isFinite(t)?t:null}function Ik(e,t=Date.now()){const n=Math.max(0,t-e),r=Math.max(1,Math.floor(n/1e3));if(r<60)return`${r} second${r===1?"":"s"} ago`;const s=Math.floor(r/60);if(s<60)return`${s} minute${s===1?"":"s"} ago`;const i=Math.floor(s/60);return`${i} hour${i===1?"":"s"} ago`}function Lk(e){return Pk.format(new Date(e))}function rl({title:e,open:t,onToggle:n,actions:r,children:s,contentClassName:i}){const[o,l]=u.useState(t),[c,d]=u.useState(t?"open":"closed");return u.useEffect(()=>{if(t){l(!0);const p=window.requestAnimationFrame(()=>d("open"));return()=>window.cancelAnimationFrame(p)}d("closing");const f=window.setTimeout(()=>{l(!1),d("closed")},140);return()=>window.clearTimeout(f)},[t]),a.jsxs("div",{className:"border-b border-border/60",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[a.jsxs("button",{type:"button",onClick:n,"aria-expanded":t,className:"flex items-center gap-2 inspector-section-title hover:text-text transition-colors",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`transition-transform ${t?"rotate-90":""}`,"aria-hidden":"true",children:a.jsx("path",{d:"m9 18 6-6-6-6"})}),a.jsx("span",{children:e})]}),r]}),o&&a.jsx("div",{className:"inspector-section-body","data-state":c,"aria-hidden":!t,children:a.jsx("div",{className:i??"px-3 pb-3",children:s})})]})}function Dl({copied:e,value:t,className:n="",title:r}){return a.jsxs("span",{className:`ui-kv-value relative inline-block text-right min-w-[80px] ${n}`.trim(),title:r,children:[a.jsx("span",{className:e?"invisible block":"block",children:t}),e&&a.jsx("span",{className:"absolute inset-0 text-right",children:"Copied"})]})}function _k({open:e,onToggle:t,multi:n,star:r,onSelectStar:s,hasStarConflict:i,onApplyConflict:o,onKeepTheirs:l,currentItem:c,sourceValue:d,sortSpec:f,copiedField:p,onCopyInfo:h,metricsExpanded:w,onToggleMetricsExpanded:x,metricsPreviewLimit:b}){return a.jsxs(rl,{title:"Basics",open:e,onToggle:t,children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs mb-1",role:"radiogroup","aria-label":"Star rating",children:[a.jsx("span",{className:"ui-kv-label w-16 shrink-0",children:n?"Rating (all)":"Rating"}),a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(C=>{const v=(r??0)>=C;return a.jsx("button",{className:`w-6 h-6 flex items-center justify-center rounded-lg border border-border/60 bg-transparent text-[13px] ${v?"text-star-active":"text-star-inactive"} hover:border-border hover:text-star-hover transition-colors`,onClick:()=>{s(r===C&&!n?null:C)},title:`${C} star${C>1?"s":""} (key ${C})`,"aria-label":`${C} star${C>1?"s":""}`,"aria-pressed":r===C,children:v?"":""},C)})})]}),i&&a.jsxs("div",{className:"ui-banner ui-banner-danger mt-2 text-[11px] flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Rating conflict."}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:o,children:"Apply again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:l,children:"Keep theirs"})]})]}),!n&&c&&a.jsxs("div",{className:"text-[12px] space-y-1.5 leading-relaxed",children:[a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("dimensions",`${c.w}${c.h}`),children:"Dimensions"}),a.jsx(Dl,{copied:p==="dimensions",value:`${c.w}${c.h}`})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("size",Xd(c.size)),children:"Size"}),a.jsx(Dl,{copied:p==="size",value:Xd(c.size)})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("type",c.type),children:"Type"}),a.jsx(Dl,{copied:p==="type",value:c.type,className:"break-all"})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>d&&h("source",d),children:"Source"}),a.jsx(Dl,{copied:p==="source",value:d,className:"inspector-value-clamp break-words max-w-[70%]",title:d})]}),(()=>{const C=c.metrics||null;if(!C)return null;const v=Object.entries(C).filter(([,I])=>I!=null);if(!v.length)return null;const g=(f==null?void 0:f.kind)==="metric"?f.key:null,y=[...v].sort(([I],[P])=>I.localeCompare(P));let m=y;if(g){const I=y.findIndex(([P])=>P===g);I>0&&(m=[y[I],...y.slice(0,I),...y.slice(I+1)])}const S=m.length>b,j=w||!S?m:m.slice(0,b),M=m.length-b;return a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"ui-subsection-title mb-1",children:"Metrics"}),a.jsxs("div",{className:"space-y-1",children:[j.map(([I,P])=>{const B=g===I;return a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:`w-24 shrink-0 ${B?"text-accent font-medium":"ui-kv-label"}`,children:I}),a.jsx("span",{className:`ui-kv-value text-right ${B?"text-accent font-medium":""}`,children:Ex(P)})]},I)}),S&&a.jsx("button",{type:"button",className:"text-[11px] text-muted underline underline-offset-2 hover:text-text",onClick:x,"aria-expanded":w,children:w?"Show less":`+${M} more`})]})]})})()]})]})}const zl=2,Ak={color:"var(--json-string)"},Fk={color:"var(--json-number)"},Ok={color:"var(--json-literal)"},Dk={color:"var(--json-fallback)"},zk={color:"var(--json-key)"};function Jd(e,t,n){switch(e.kind){case"null":case"boolean":return a.jsx("span",{style:Ok,children:e.text});case"undefined":case"fallback":return a.jsx("span",{style:Dk,children:e.text});case"string":return a.jsx("span",{style:Ak,children:e.text});case"number":return a.jsx("span",{style:Fk,children:e.text});case"array":return e.items.length===0?"[]":a.jsxs(a.Fragment,{children:[`[
`,e.items.map((r,s)=>a.jsxs(Zr.Fragment,{children:[" ".repeat(t+zl),Jd(r,t+zl,n),s<e.items.length-1?",":"",`
`]},s))," ".repeat(t),"]"]});case"object":return e.entries.length===0?"{}":a.jsxs(a.Fragment,{children:[`{
`,e.entries.map((r,s)=>a.jsxs(Zr.Fragment,{children:[" ".repeat(t+zl),a.jsx("span",{className:"ui-json-key",style:zk,onClick:n?i=>{i.stopPropagation(),n(r.path)}:void 0,children:JSON.stringify(r.key)}),": ",Jd(r.value,t+zl,n),s<e.entries.length-1?",":"",`
`]},JSON.stringify(r.path)))," ".repeat(t),"}"]})}}function jx({node:e,onPathClick:t}){return a.jsx("code",{className:"block whitespace-pre-wrap",children:Jd(e,0,t)})}const Mx=Zr.memo(function({compareDiff:t}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-muted",children:[a.jsxs("span",{children:[t.different," ","different"," ",""," ",t.onlyA," ","only A"," ",""," ",t.onlyB," ","only B"]}),a.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:"Deep paths"})]}),t.entries.length===0?a.jsx("div",{className:"text-muted",children:"No differences found."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2 text-[10px] uppercase tracking-wide text-muted",children:[a.jsx("div",{children:"Path"}),a.jsx("div",{children:"A"}),a.jsx("div",{children:"B"})]}),t.entries.map(n=>a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2",children:[a.jsx("div",{className:"text-[11px] text-muted font-mono break-all",children:n.key}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.aText}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.bText})]},n.key)),t.truncatedCount>0&&a.jsxs("div",{className:"text-muted text-[11px]",children:["+",t.truncatedCount," ","more differences not shown."]})]})]})});Mx.displayName="CompareDiffTable";const Zd=Zr.memo(function({side:t,compareMetaLoaded:n,hasPilInfo:r,showPilInfo:s,onToggleShowPilInfo:i,copied:o,onCopy:l,copiedPath:c,displayNode:d,compareMetaContent:f,onMetaPathCopy:p}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:["Metadata"," ",t]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[r&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:i,disabled:!n,children:s?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:l,disabled:!n,children:o?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[c&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",c]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",children:n&&d?a.jsx(jx,{node:d,onPathClick:p}):f})]})]})});Zd.displayName="CompareMetadataPane";function $k({open:e,onToggle:t,compareMetaState:n,compareMetaError:r,compareLabelA:s,compareLabelB:i,compareIncludePilInfo:o,onToggleCompareIncludePilInfo:l,onReload:c,compareDiff:d,compareHasPilInfoA:f,compareHasPilInfoB:p,compareShowPilInfoA:h,compareShowPilInfoB:w,onToggleCompareShowPilInfoA:x,onToggleCompareShowPilInfoB:b,compareMetaCopied:C,onCopyCompareMetadata:v,compareValueCopiedPathA:g,compareValueCopiedPathB:y,compareDisplayNodeA:m,compareDisplayNodeB:S,compareMetaContent:E,onCompareMetaPathCopyA:j,onCompareMetaPathCopyB:M}){const I=n==="loaded";return a.jsx(rl,{title:"Compare Metadata",open:e,onToggle:t,actions:a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:c,disabled:n==="loading",children:n==="loading"?"Loading":"Reload"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:l,disabled:!I,children:o?"Hide PIL info":"Include PIL info"})]}),children:a.jsxs("div",{className:"space-y-2 text-[11px]",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] text-muted",children:[a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"A"}),a.jsx("div",{className:"text-text break-all",title:s,children:s})]}),a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"B"}),a.jsx("div",{className:"text-text break-all",title:i,children:i})]})]}),n==="loading"&&a.jsx("div",{className:"text-muted",children:"Loading metadata"}),n==="error"&&r&&a.jsx("div",{className:"text-danger break-words",children:r}),I&&d&&a.jsx(Mx,{compareDiff:d}),a.jsxs("div",{className:"grid gap-3 pt-2",children:[a.jsx(Zd,{side:"A",compareMetaLoaded:I,hasPilInfo:f,showPilInfo:h,onToggleShowPilInfo:x,copied:C==="A",onCopy:()=>v("A"),copiedPath:g,displayNode:m,compareMetaContent:E,onMetaPathCopy:j}),a.jsx(Zd,{side:"B",compareMetaLoaded:I,hasPilInfo:p,showPilInfo:w,onToggleShowPilInfo:b,copied:C==="B",onCopy:()=>v("B"),copiedPath:y,displayNode:S,compareMetaContent:E,onMetaPathCopy:M})]})]})})}const Rx=Zr.memo($k);Rx.displayName="CompareMetadataSection";function Bk({open:e,onToggle:t,metadataLoading:n,metadataActionLabel:r,onMetadataAction:s,metadataActionDisabled:i,hasPilInfo:o,showPilInfo:l,onToggleShowPilInfo:c,metaValueCopiedPath:d,metaHeightClass:f,metaLoaded:p,metaDisplayNode:h,metaContent:w,metaError:x,onMetaPathCopy:b}){const C=a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[p&&o&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:c,disabled:!p,children:l?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[78px]",onClick:s,disabled:i||n,children:r})]});return a.jsxs(rl,{title:"Metadata",open:e,onToggle:t,actions:C,children:[a.jsxs("div",{className:"relative",children:[d&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",d]}),a.jsx("pre",{className:`ui-code-block ui-code-block-resizable ${f} overflow-auto whitespace-pre-wrap`,children:p&&h?a.jsx(jx,{node:h,onPathClick:b}):w})]}),x&&a.jsx("div",{className:"text-[11px] text-danger mt-1 break-words",children:x})]})}const Px=Zr.memo(Bk);Px.displayName="MetadataSection";function Uk({open:e,onToggle:t,multi:n,showConflictBanner:r,onApplyConflict:s,onKeepTheirs:i,notes:o,onNotesChange:l,onNotesBlur:c,tags:d,onTagsChange:f,onTagsBlur:p}){return a.jsxs(rl,{title:"Notes & Tags",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",children:[r&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Conflicting edits detected."}),a.jsx("div",{className:"text-[11px] text-muted mt-0.5",children:"Your changes were not saved because this item was updated elsewhere."}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:s,children:"Apply my changes again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:i,children:"Keep theirs"})]})]}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full scrollbar-thin",placeholder:"Add notes",value:o,onChange:h=>l(h.target.value),onBlur:c,"aria-label":n?"Notes for selected items":"Notes"}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:n?"Tags (apply to all, comma-separated)":"Tags (comma-separated)"}),a.jsx("input",{className:"ui-input inspector-input w-full",placeholder:"tag1, tag2",value:d,onChange:h=>f(h.target.value),onBlur:p,"aria-label":n?"Tags for selected items":"Tags"})]})]})}function Vk(e){return e===2?null:e>2?`Side-by-side view supports exactly 2 selections (selected ${e}).`:"Select exactly 2 images to open side-by-side view."}function Wk({selectedCount:e,compareActive:t,onOpenCompare:n}){const r=Vk(e),s=!n||t||r!==null,i=t?"Side-by-side viewer is already open.":r??"Open side by side to compare selected images.";return a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Selection Actions"}),a.jsx("div",{className:"flex flex-wrap items-center gap-2",children:a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>n==null?void 0:n(),disabled:s,children:"Side by side view"})}),a.jsx("div",{className:"text-[11px] text-muted",children:i})]})}const Am=2,Tx=12,Fm=120,Om=!0,Ho="Comparison export (v1) requires exactly 2 selected images.",Hk=`Comparison export (v2) requires between 2 and ${Tx} selected images.`,Ix="Comparison export for more than 2 selections is unavailable on this server.";function Lx(e,t){return`Comparison export (v2) supports up to ${e} selections (selected ${t}).`}function Qk(e){return e.replace(/[\u0000-\u001f\u007f]/g,"").trim()}function Kk(e){const n=e.replace(/\r\n?/g,`
`).replace(/\n+$/g,"");return n?n.split(`
`):[]}function qk(e){if(e.length!==0)return e.length===1?[e[0]]:[e[0],e[1]]}function Gk(e){return e.map(t=>t.trim()).filter(t=>t.length>0)}function _x(e,t){const{maxLines:n,tooManyLinesMessage:r}=t,s=Kk(e);if(s.length>n)return{ok:!1,message:r};const i=s.map(l=>Qk(l));return i.some(l=>l.length>Fm)?{ok:!1,message:`Each label must be at most ${Fm} characters.`}:i.some(l=>l.length>0)?{ok:!0,labels:i}:{ok:!0,labels:void 0}}function Yk(e){const{pathA:t,pathB:n,labelsText:r,embedMetadata:s,reverseOrder:i}=e;if(!t||!n)return{ok:!1,message:Ho};const o=_x(r,{maxLines:Am,tooManyLinesMessage:`Enter at most ${Am} label lines (line 1 = A, line 2 = B).`});if(!o.ok)return o;const l={v:1,paths:[t,n],embed_metadata:s,reverse_order:i};return o.labels&&(l.labels=qk(o.labels)),{ok:!0,payload:l}}function Xk(e){const{paths:t,labelsText:n,embedMetadata:r,reverseOrder:s}=e,i=Gk(t);if(i.length!==t.length||i.length<2||i.length>Tx)return{ok:!1,message:Hk};const o=_x(n,{maxLines:i.length,tooManyLinesMessage:`Enter at most ${i.length} label lines (one per selected image).`});if(!o.ok)return o;const l={v:2,paths:i,embed_metadata:r,reverse_order:s};return o.labels&&(l.labels=o.labels),{ok:!0,payload:l}}function so(e){return String(e).padStart(2,"0")}function Jk(e,t=new Date){const n=t.getUTCFullYear(),r=so(t.getUTCMonth()+1),s=so(t.getUTCDate()),i=so(t.getUTCHours()),o=so(t.getUTCMinutes()),l=so(t.getUTCSeconds());return`comparison${e?"_reverse":""}_${n}${r}${s}_${i}${o}${l}.png`}function Zk({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r}){return e<2?`Comparison export requires at least 2 selections (selected ${e}).`:e===2?t?null:Ho:!n||r===null?Ix:e>r?Lx(r,e):null}function eE({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r,compareExportLabelsText:s,onCompareExportLabelsTextChange:i,compareExportEmbedMetadata:o,onCompareExportEmbedMetadataChange:l,compareExportBusy:c,compareExportMode:d,onComparisonExport:f,compareExportError:p}){const h=Zk({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r}),w=c||h!==null,x=e>2?`Label for image 1
Label for image 2
...`:`Label for A
Label for B`;return a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Selection Export"}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full h-20 scrollbar-thin",placeholder:x,value:s,onChange:b=>i(b.target.value),disabled:w,"aria-label":"Selection export labels"}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-[11px] text-muted",children:[a.jsx("input",{type:"checkbox",checked:o,onChange:b=>l(b.target.checked),disabled:w}),a.jsx("span",{children:"Embed metadata"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>f(!1),disabled:w,children:d==="normal"?"Exporting":"Export comparison"}),a.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",onClick:()=>f(!0),disabled:w,children:d==="reverse"?"Exporting":"Export (reverse order)"})]}),h&&a.jsx("div",{className:"text-[11px] text-muted",children:h}),p&&a.jsx("div",{className:"text-danger break-words",children:p})]})}const tE=[{id:"selectionActions",isVisible:()=>!0,render:({selectionActionsProps:e})=>a.jsx(Wk,{...e})},{id:"selectionExport",isVisible:({compareActive:e})=>!e,render:({selectionExportProps:e})=>a.jsx(eE,{...e})}];function nE({open:e,onToggle:t,multi:n,selectedCount:r,totalSize:s,filename:i,compareActive:o,compareReady:l,onOpenCompare:c,compareExportSupportsV2:d,compareExportMaxPathsV2:f,compareExportLabelsText:p,onCompareExportLabelsTextChange:h,compareExportEmbedMetadata:w,onCompareExportEmbedMetadataChange:x,compareExportBusy:b,compareExportMode:C,onComparisonExport:v,compareExportError:g,onFindSimilar:y,canFindSimilar:m,findSimilarDisabledReason:S}){const E={compareActive:o,selectionActionsProps:{selectedCount:r,compareActive:o,onOpenCompare:c},selectionExportProps:{selectedCount:r,compareReady:l,compareExportSupportsV2:d,compareExportMaxPathsV2:f,compareExportLabelsText:p,onCompareExportLabelsTextChange:h,compareExportEmbedMetadata:w,onCompareExportEmbedMetadataChange:x,compareExportBusy:b,compareExportMode:C,onComparisonExport:v,compareExportError:g}};return a.jsxs(rl,{title:n?"Selection":"Item",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",actions:y&&a.jsx("button",{type:"button",className:"btn btn-sm",onClick:y,disabled:!m,title:S??"Find similar",children:"Find similar"}),children:[n?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Selected"}),a.jsxs("div",{className:"inspector-field-value",children:[r," files"]})]}),a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Total size"}),a.jsx("div",{className:"inspector-field-value",children:Xd(s)})]})]}),tE.filter(j=>j.isVisible(E)).map(j=>a.jsx(u.Fragment,{children:j.render(E)},j.id))]}):a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Filename"}),a.jsx("div",{className:"inspector-field-value break-all",title:i,children:i})]}),S&&a.jsx("div",{className:"text-[11px] text-muted",children:S})]})}const rE=[{id:"overview",isVisible:()=>!0,render:({overviewProps:e})=>a.jsx(nE,{...e})},{id:"compareMetadata",isVisible:({compareActive:e,compareReady:t})=>e&&t,render:({compareMetadataProps:e})=>a.jsx(Rx,{...e})},{id:"basics",isVisible:()=>!0,render:({basicsProps:e})=>a.jsx(_k,{...e})},{id:"metadata",isVisible:({multi:e})=>!e,render:({metadataProps:e})=>a.jsx(Px,{...e})},{id:"notes",isVisible:()=>!0,render:({notesProps:e})=>a.jsx(Uk,{...e})}];function sE(e,t){const n=iE(e)||"view",r=new Set(t.map(i=>i.id));if(!r.has(n))return n;let s=2;for(;r.has(`${n}-${s}`);)s+=1;return`${n}-${s}`}function iE(e){return e.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function Mc(e){const t=e.filter(s=>s>0).sort((s,i)=>i-s),n=e.includes(0),r=[...t.map(s=>String(s))];return n&&r.push("None"),r.join(", ")}function oE(e,t){return e&&t?`${e} to ${t}`:e?`from ${e}`:t?`to ${t}`:""}function lE(e){if(e==="/"||e==="")return"Root";const t=e.split("/").filter(Boolean);return t.length?t.length<=2?`/${t.join("/")}`:`.../${t.slice(-2).join("/")}`:"Root"}function aE(e,t,n,r){return!n||r?t:e==="/"||e===""?e||"/":n===e||n.startsWith(`${e}/`)?e:t}function uE(e,t){return`${Dm(e)}${Dm(t)}`}function Dm(e){const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function cE(e){const t=e.toLowerCase();return t.endsWith(".png")?"image/png":t.endsWith(".webp")?"image/webp":"image/jpeg"}function dE(e,t){const n=e.split("/").pop()??e;return{path:e,name:n,type:cE(e),w:0,h:0,size:0,hasThumb:!0,hasMeta:!1,star:t??null}}function Co(e,t){const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}function fE({selectedPaths:e,comparePathA:t,comparePathB:n}){if(e.length!==2)return null;if(t&&n)return[t,n];const[r,s]=e;return!r||!s?null:[r,s]}function hE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s,labelsText:i,embedMetadata:o,reverseOrder:l}){const c=e.length;if(c<2)return{ok:!1,message:Ho};if(c===2){const d=fE({selectedPaths:e,comparePathA:t,comparePathB:n});if(!d)return{ok:!1,message:Ho};const[f,p]=d;return Yk({pathA:f,pathB:p,labelsText:i,embedMetadata:o,reverseOrder:l})}return r?s!==null&&c>s?{ok:!1,message:Lx(s,c)}:Xk({paths:e,labelsText:i,embedMetadata:o,reverseOrder:l}):{ok:!1,message:Ix}}function pE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s}){const[i,o]=u.useState(""),[l,c]=u.useState(Om),[d,f]=u.useState(null),[p,h]=u.useState(null),w=d!==null;u.useEffect(()=>{if(e.length<2){o(""),c(Om),f(null),h(null);return}f(null),h(null)},[t,n,e]);const x=u.useCallback(v=>{o(v),h(null)},[]),b=u.useCallback(v=>{c(v)},[]),C=u.useCallback(async v=>{if(w)return;if(e.length<2){h(Ho);return}const y=hE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s,labelsText:i,embedMetadata:l,reverseOrder:v});if(!y.ok){h(y.message);return}f(v?"reverse":"normal"),h(null);try{const m=await me.exportComparison(y.payload);Co(m,Jk(v))}catch(m){const S=m instanceof Error?m.message:"Failed to export comparison.";h(S)}finally{f(null)}},[w,l,i,s,r,t,n,e]);return{compareExportLabelsText:i,compareExportEmbedMetadata:l,compareExportMode:d,compareExportError:p,compareExportBusy:w,handleCompareExportLabelsTextChange:x,handleCompareExportEmbedMetadataChange:b,runComparisonExport:C}}function zm(e,t){return e?`${e}::${t??""}`:null}function $m(e,t,n){return!e||!t||!n?null:`${t}::${n}`}function Qa({activeRequestId:e,responseRequestId:t,activeContextKey:n,responseContextKey:r}){return e===t&&n===r}function mE({compareReady:e,comparePathA:t,comparePathB:n}){const[r,s]=u.useState("idle"),[i,o]=u.useState(null),[l,c]=u.useState(null),[d,f]=u.useState(null),[p,h]=u.useState(!1),[w,x]=u.useState(!1),[b,C]=u.useState(!1),v=$m(e,t,n),g=u.useRef(0),y=u.useRef(v);y.current=v;const m=u.useCallback(async(E,j,M)=>{const I=g.current+1;g.current=I,s("loading"),o(null);try{const[P,B]=await Promise.all([me.getMetadata(E),me.getMetadata(j)]);if(!Qa({activeRequestId:g.current,responseRequestId:I,activeContextKey:y.current,responseContextKey:M}))return;c(P.meta),f(B.meta),s("loaded")}catch(P){if(!Qa({activeRequestId:g.current,responseRequestId:I,activeContextKey:y.current,responseContextKey:M}))return;const B=P instanceof Error?P.message:"Failed to load metadata";c(null),f(null),o(B),s("error")}},[]);u.useEffect(()=>{if(g.current+=1,!v||!t||!n){s("idle"),o(null),c(null),f(null),x(!1),C(!1);return}h(!1),x(!1),C(!1),m(t,n,v)},[v,t,n,m]);const S=u.useCallback(()=>{const E=$m(e,t,n);!E||!t||!n||m(t,n,E)},[e,t,n,m]);return{compareMetaState:r,compareMetaError:i,compareMetaA:l,compareMetaB:d,compareIncludePilInfo:p,compareShowPilInfoA:w,compareShowPilInfoB:b,setCompareIncludePilInfo:h,setCompareShowPilInfoA:x,setCompareShowPilInfoB:C,reloadCompareMetadata:S}}function gE({path:e,sidecarUpdatedAt:t}){const[n,r]=u.useState(null),[s,i]=u.useState(null),[o,l]=u.useState("idle"),[c,d]=u.useState(!1),f=zm(e,t),p=u.useRef(0),h=u.useRef(f);h.current=f,u.useEffect(()=>{p.current+=1,r(null),i(null),l("idle"),d(!1)},[f]);const w=u.useCallback(async()=>{const x=zm(e,t);if(!x||!e)return;const b=p.current+1;p.current=b,l("loading"),i(null);try{const C=await me.getMetadata(e);if(!Qa({activeRequestId:p.current,responseRequestId:b,activeContextKey:h.current,responseContextKey:x}))return;r(C.meta),l("loaded")}catch(C){if(!Qa({activeRequestId:p.current,responseRequestId:b,activeContextKey:h.current,responseContextKey:x}))return;const v=C instanceof Error?C.message:"Failed to load metadata";r(null),i(v),l("error")}},[e,t]);return{metaRaw:n,metaError:s,metaState:o,showPilInfo:c,setMetaError:i,setShowPilInfo:d,fetchMetadata:w}}function vE({path:e,sidecarUpdatedAt:t,selectedPaths:n,compareReady:r,comparePathA:s,comparePathB:i,compareExportSupportsV2:o,compareExportMaxPathsV2:l}){const c=gE({path:e,sidecarUpdatedAt:t}),d=mE({compareReady:r,comparePathA:s,comparePathB:i}),f=pE({selectedPaths:n,comparePathA:s,comparePathB:i,compareExportSupportsV2:o,compareExportMaxPathsV2:l});return{metaRaw:c.metaRaw,metaError:c.metaError,metaState:c.metaState,showPilInfo:c.showPilInfo,setMetaError:c.setMetaError,compareMetaState:d.compareMetaState,compareMetaError:d.compareMetaError,compareMetaA:d.compareMetaA,compareMetaB:d.compareMetaB,compareIncludePilInfo:d.compareIncludePilInfo,compareShowPilInfoA:d.compareShowPilInfoA,compareShowPilInfoB:d.compareShowPilInfoB,compareExportLabelsText:f.compareExportLabelsText,compareExportEmbedMetadata:f.compareExportEmbedMetadata,compareExportMode:f.compareExportMode,compareExportError:f.compareExportError,compareExportBusy:f.compareExportBusy,setShowPilInfo:c.setShowPilInfo,setCompareIncludePilInfo:d.setCompareIncludePilInfo,setCompareShowPilInfoA:d.setCompareShowPilInfoA,setCompareShowPilInfoB:d.setCompareShowPilInfoB,fetchMetadata:c.fetchMetadata,reloadCompareMetadata:d.reloadCompareMetadata,handleCompareExportLabelsTextChange:f.handleCompareExportLabelsTextChange,handleCompareExportEmbedMetadataChange:f.handleCompareExportEmbedMetadataChange,runComparisonExport:f.runComparisonExport}}function $l(e){return{notes:(e==null?void 0:e.notes)??"",tags:((e==null?void 0:e.tags)??[]).join(", ")}}function Ka(e){return e.split(",").map(t=>t.trim()).filter(Boolean)}function yE(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function xE(e,t){return e!==t}function wE(e,t){return!yE(Ka(e),Ka(t))}function bE({path:e,selectedPaths:t,multi:n,sidecar:r,conflict:s,star:i,queryClient:o,mutateSidecar:l,onStarChanged:c,onLocalTypingChange:d}){const[f,p]=u.useState(""),[h,w]=u.useState(""),x=u.useRef(!1),b=u.useRef(!1),C=u.useRef(!1),v=u.useRef($l(void 0)),g=u.useCallback(F=>{x.current!==F&&(x.current=F,d==null||d(F))},[d]),y=u.useCallback(F=>{v.current=F,b.current=!1,C.current=!1,p(F.tags),w(F.notes),g(!1)},[g]);u.useEffect(()=>{if(!e){y($l(void 0));return}y($l(r))},[e,y,r==null?void 0:r.updated_at,r==null?void 0:r.version]),u.useEffect(()=>()=>{g(!1)},[g]);const m=u.useCallback(F=>{if(n&&t.length){Sx(t,F);return}e&&l(F,(r==null?void 0:r.version)??1)},[n,l,e,t,r==null?void 0:r.version]),S=u.useMemo(()=>({tags:!!(s!=null&&s.pending.set_tags),notes:(s==null?void 0:s.pending.set_notes)!==void 0,star:(s==null?void 0:s.pending.set_star)!==void 0}),[s]),E=u.useCallback(F=>{w(F),b.current=!0,g(!0)},[g]),j=u.useCallback(()=>{const F=b.current;b.current=!1,F&&xE(h,v.current.notes)&&(m({notes:h}),v.current={...v.current,notes:h}),g(!1)},[m,h,g]),M=u.useCallback(F=>{p(F),C.current=!0,g(!0)},[g]),I=u.useCallback(()=>{const F=C.current;C.current=!1,F&&wE(f,v.current.tags)&&(m({tags:Ka(f)}),v.current={...v.current,tags:f}),g(!1)},[m,g,f]),P=u.useCallback(()=>{if(!s||!e)return;const F={};s.pending.set_tags!==void 0&&(F.tags=Ka(f)),s.pending.set_notes!==void 0&&(F.notes=h),s.pending.set_star!==void 0&&(F.star=i??null),l(F,s.current.version??1)},[s,l,h,e,i,f]),B=u.useCallback(()=>{if(!s||!e)return;const F=s.current,K=$l(F);v.current=K,b.current=!1,C.current=!1,p(K.tags),w(K.notes),g(!1),o.setQueryData(Vo(e),F),xu(e),c==null||c([e],F.star??null)},[s,g,c,e,o]);return{tags:f,notes:h,conflictFields:S,commitSidecar:m,applyConflict:P,keepTheirs:B,handleNotesChange:E,handleNotesBlur:j,handleTagsChange:M,handleTagsBlur:I}}const SE=["overview","compare","basics","metadata","notes"],Bm="lenslet.inspector.sections",Um="lenslet.inspector.metricsExpanded",CE={overview:!0,compare:!0,metadata:!0,basics:!0,notes:!0};function Qt(e){e.current!==null&&(window.clearTimeout(e.current),e.current=null)}function kE({path:e,sidecarUpdatedAt:t,compareReady:n,comparePathA:r,comparePathB:s}){const[i,o]=u.useState(CE),[l,c]=u.useState(!1),[d,f]=u.useState(null),[p,h]=u.useState(!1),[w,x]=u.useState(null),[b,C]=u.useState(null),[v,g]=u.useState(null),[y,m]=u.useState(null),S=u.useRef(null),E=u.useRef(null),j=u.useRef(null),M=u.useRef(null),I=u.useRef(null),P=u.useCallback(U=>{o(_=>({..._,[U]:!_[U]}))},[]),B=u.useCallback(()=>P("overview"),[P]),F=u.useCallback(()=>P("compare"),[P]),K=u.useCallback(()=>P("basics"),[P]),Z=u.useCallback(()=>P("metadata"),[P]),z=u.useCallback(()=>P("notes"),[P]),L=u.useCallback(()=>{c(U=>!U)},[]),R=u.useCallback(U=>{f(U),Qt(S),S.current=window.setTimeout(()=>{f(_=>_===U?null:_),S.current=null},1e3)},[]),T=u.useCallback(()=>{h(!0),Qt(E),E.current=window.setTimeout(()=>{h(!1),E.current=null},1200)},[]),A=u.useCallback(U=>{x(U),Qt(j),j.current=window.setTimeout(()=>{x(null),j.current=null},900)},[]),O=u.useCallback(U=>{C(U),Qt(M),M.current=window.setTimeout(()=>{C(_=>_===U?null:_),M.current=null},1200)},[]),H=u.useCallback((U,_)=>{U==="A"?g(_):m(_),Qt(I),I.current=window.setTimeout(()=>{g(null),m(null),I.current=null},900)},[]);return u.useEffect(()=>{try{const U=localStorage.getItem(Bm);if(!U)return;const _=JSON.parse(U);if(!_||typeof _!="object")return;const Q={};for(const V of SE)typeof _[V]=="boolean"&&(Q[V]=_[V]);Object.keys(Q).length>0&&o(V=>({...V,...Q}))}catch{}},[]),u.useEffect(()=>{try{localStorage.setItem(Bm,JSON.stringify(i))}catch{}},[i]),u.useEffect(()=>{try{const U=localStorage.getItem(Um);U==="1"||U==="true"?c(!0):(U==="0"||U==="false")&&c(!1)}catch{}},[]),u.useEffect(()=>{try{localStorage.setItem(Um,l?"1":"0")}catch{}},[l]),u.useEffect(()=>{h(!1),x(null),Qt(E),Qt(j)},[e,t]),u.useEffect(()=>{C(null),g(null),m(null),Qt(M),Qt(I)},[r,s,n]),u.useEffect(()=>()=>{Qt(S),Qt(E),Qt(j),Qt(M),Qt(I)},[]),{openSections:i,toggleOverviewSection:B,toggleCompareSection:F,toggleBasicsSection:K,toggleMetadataSection:Z,toggleNotesSection:z,metricsExpanded:l,toggleMetricsExpanded:L,copiedField:d,markInfoCopied:R,metaCopied:p,markMetadataCopied:T,metaValueCopiedPath:w,markMetadataValueCopied:A,compareMetaCopied:b,markCompareMetadataCopied:O,compareValueCopiedPathA:v,compareValueCopiedPathB:y,markCompareMetadataValueCopied:H}}const EE=12,NE=120,jE=8,ME=80;function RE({path:e,selectedPaths:t=[],items:n=[],compareActive:r=!1,compareA:s=null,compareB:i=null,onOpenCompare:o,onResize:l,onStarChanged:c,sortSpec:d,onFindSimilar:f,embeddingsAvailable:p=!1,embeddingsLoading:h=!1,compareExportSupportsV2:w=!1,compareExportMaxPathsV2:x=null,onLocalTypingChange:b}){const C=!!e,{data:v}=Sk(e??""),g=Ck(e??""),y=wr(),m=t.length>1,S=!!f&&p&&!m,E=f?p?m?"Select a single image to search.":null:h?"Loading embeddings...":"No embeddings detected.":null,M=u.useMemo(()=>{var xe;return((xe=n.find(Ye=>Ye.path===e))==null?void 0:xe.star)??null},[n,e])??(v==null?void 0:v.star)??null,I=pk(m?null:e),P=(s==null?void 0:s.path)??null,B=(i==null?void 0:i.path)??null,F=t.length===2&&!!t[0]&&!!t[1],Z=r&&(!!P&&!!B),{openSections:z,toggleOverviewSection:L,toggleCompareSection:R,toggleBasicsSection:T,toggleMetadataSection:A,toggleNotesSection:O,metricsExpanded:H,toggleMetricsExpanded:U,copiedField:_,markInfoCopied:Q,metaCopied:V,markMetadataCopied:ee,metaValueCopiedPath:ie,markMetadataValueCopied:q,compareMetaCopied:G,markCompareMetadataCopied:X,compareValueCopiedPathA:ce,compareValueCopiedPathB:Ee,markCompareMetadataValueCopied:Se}=kE({path:e,sidecarUpdatedAt:v==null?void 0:v.updated_at,comparePathA:P,comparePathB:B,compareReady:Z}),he=Z&&r&&z.compare,Fe=!m&&z.metadata,Ze=(s==null?void 0:s.name)??P??"A",$t=(i==null?void 0:i.name)??B??"B",Bt=u.useCallback((ae,xe)=>{g.mutate({patch:ae,baseVersion:xe,idempotencyKey:gu("patch")})},[g]),{tags:dn,notes:Dn,conflictFields:en,commitSidecar:oe,applyConflict:re,keepTheirs:we,handleNotesChange:Ie,handleNotesBlur:ge,handleTagsChange:fe,handleTagsBlur:nt}=bE({path:e,selectedPaths:t,multi:m,sidecar:v,conflict:I,star:M,queryClient:y,mutateSidecar:Bt,onStarChanged:c,onLocalTypingChange:b}),{metaRaw:Ke,metaError:bt,metaState:qe,showPilInfo:tn,setMetaError:br,compareMetaState:kn,compareMetaError:zn,compareMetaA:Ce,compareMetaB:rt,compareIncludePilInfo:fn,compareShowPilInfoA:$n,compareShowPilInfoB:Ut,compareExportLabelsText:$i,compareExportEmbedMetadata:D,compareExportMode:Y,compareExportError:le,compareExportBusy:ve,setShowPilInfo:be,setCompareIncludePilInfo:Ne,setCompareShowPilInfoA:se,setCompareShowPilInfoB:je,fetchMetadata:pe,reloadCompareMetadata:it,handleCompareExportLabelsTextChange:Oe,handleCompareExportEmbedMetadataChange:mt,runComparisonExport:Vt}=vE({path:e,sidecarUpdatedAt:v==null?void 0:v.updated_at,selectedPaths:t,compareReady:Z,comparePathA:P,comparePathB:B,compareExportSupportsV2:w,compareExportMaxPathsV2:x}),En=u.useMemo(()=>{const ae=new Set(t);return n.filter(xe=>ae.has(xe.path))},[n,t]),hn=u.useMemo(()=>En.reduce((ae,xe)=>ae+(xe.size||0),0),[En]);u.useEffect(()=>{if(!e)return;const ae=xe=>{if(ch(xe.target))return;const Ye=xe.key;if(!/^[0-5]$/.test(Ye))return;xe.preventDefault();const tr=Ye==="0"?null:Number(Ye);if(m&&t.length){oe({star:tr}),c==null||c(t,tr);return}oe({star:tr}),c==null||c([e],tr)};return window.addEventListener("keydown",ae),()=>window.removeEventListener("keydown",ae)},[e,m,t,oe,c]);const Ge=ps(e?()=>me.getThumb(e):null,[e]),Bn=e?e.split("/").pop()||e:"",Bi=u.useMemo(()=>{var xe;if(Bn.includes("."))return Bn.slice(Bn.lastIndexOf(".")+1).toUpperCase();const ae=n.find(Ye=>Ye.path===e);return(xe=ae==null?void 0:ae.type)!=null&&xe.includes("/")?ae.type.split("/")[1].toUpperCase():""},[Bn,n,e]),gt=u.useMemo(()=>n.find(ae=>ae.path===e),[n,e]),St=u.useMemo(()=>e?(gt==null?void 0:gt.source)??e:"",[gt,e]),Ct=u.useMemo(()=>{if(!Ke)return"";try{return JSON.stringify(Ke,null,1)}catch{return""}},[Ke]),Wt=u.useMemo(()=>Cc(Ke),[Ke]),Os=u.useMemo(()=>Cc(Ce),[Ce]),Un=u.useMemo(()=>Cc(rt),[rt]),Zn=u.useMemo(()=>kc(Wt,tn),[Wt,tn]),sl=u.useMemo(()=>{if(!Ce)return"";try{return JSON.stringify(Ce,null,1)}catch{return""}},[Ce]),Ui=u.useMemo(()=>{if(!rt)return"";try{return JSON.stringify(rt,null,1)}catch{return""}},[rt]),Vn=u.useMemo(()=>kc(Os,$n),[Os,$n]),er=u.useMemo(()=>kc(Un,Ut),[Un,Ut]),il=u.useCallback(()=>{var ae;Ct&&((ae=navigator.clipboard)==null||ae.writeText(Ct).then(()=>{ee()}).catch(xe=>{const Ye=xe instanceof Error?xe.message:"Copy failed";br(Ye)}))},[ee,Ct,br]),bu=u.useMemo(()=>!Fe||!Zn?null:So(Zn),[Fe,Zn]),Su=u.useMemo(()=>!he||!Vn?null:So(Vn),[he,Vn]),Cu=u.useMemo(()=>!he||!er?null:So(er),[he,er]),Vi=u.useCallback((ae,xe)=>{var Ye;(Ye=navigator.clipboard)==null||Ye.writeText(xe).then(()=>{q(ae)}).catch(()=>{})},[q]),is=u.useCallback((ae,xe,Ye)=>{var tr;(tr=navigator.clipboard)==null||tr.writeText(Ye).then(()=>{Se(ae,xe)}).catch(()=>{})},[Se]),ku=u.useCallback(ae=>{if(!Zn)return;const xe=Ec(Zn,ae);Vi(xe.pathLabel,xe.copyText)},[Zn,Vi]),Eu=u.useCallback(ae=>{if(!Vn)return;const xe=Ec(Vn,ae);is("A",xe.pathLabel,xe.copyText)},[Vn,is]),Nu=u.useCallback(ae=>{if(!er)return;const xe=Ec(er,ae);is("B",xe.pathLabel,xe.copyText)},[er,is]),ol=u.useCallback(ae=>{var Ye;const xe=ae==="A"?sl:Ui;xe&&((Ye=navigator.clipboard)==null||Ye.writeText(xe).then(()=>{X(ae)}).catch(()=>{}))},[sl,Ui,X]);let Ds=Zn?"":"PNG metadata not loaded yet.";qe==="loading"?Ds="Loading metadata":qe==="error"&&bt&&(Ds=bt);let Wi="Metadata not loaded yet.";kn==="loading"?Wi="Loading metadata":kn==="error"&&zn&&(Wi=zn);const ll=qe==="loading",Sr=qe==="loaded"&&!!Ct,al=Sr?"h-48":"h-24";let zs="Load meta";ll?zs="Loading":Sr&&(zs=V?"Copied":"Copy");const ju=Sr?il:pe,ul=Nc(Ke),cl=Nc(Ce),Mu=Nc(rt),$s=u.useMemo(()=>he?Mk(Os,Un,{includePilInfo:fn,limit:NE,maxDepth:jE,maxArray:ME}):null,[he,Os,Un,fn]),dl=u.useCallback((ae,xe)=>{var Ye;xe&&((Ye=navigator.clipboard)==null||Ye.writeText(xe).then(()=>{Q(ae)}).catch(()=>{}))},[Q]),Ru=u.useCallback(ae=>{if(m&&t.length){c==null||c(t,ae),Sx(t,{star:ae});return}e&&(c==null||c([e],ae),Cx(e,{star:ae}))},[m,c,e,t]),Bs=u.useCallback(()=>{be(ae=>!ae)},[be]),Pu=u.useCallback(()=>{Ne(ae=>!ae)},[Ne]),Tu=u.useCallback(()=>{se(ae=>!ae)},[se]),Iu=u.useCallback(()=>{je(ae=>!ae)},[je]),Lu=u.useCallback(ae=>{Vt(ae)},[Vt]),_u=!m&&!!I&&(en.tags||en.notes),Au=!m&&!!I&&en.star,fl="toolbar-offset sidebar-resize-handle sidebar-resize-handle-right absolute bottom-0";if(!C)return a.jsx("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:a.jsx("div",{className:fl,onPointerDown:l})});const Ht={multi:m,compareActive:r,compareReady:Z,overviewProps:{open:z.overview,onToggle:L,multi:m,selectedCount:t.length,totalSize:hn,filename:Bn,compareActive:r,compareReady:F,onOpenCompare:o,compareExportSupportsV2:w,compareExportMaxPathsV2:x,compareExportLabelsText:$i,onCompareExportLabelsTextChange:Oe,compareExportEmbedMetadata:D,onCompareExportEmbedMetadataChange:mt,compareExportBusy:ve,compareExportMode:Y,onComparisonExport:Lu,compareExportError:le,onFindSimilar:f,canFindSimilar:S,findSimilarDisabledReason:E},compareMetadataProps:{open:z.compare,onToggle:R,compareMetaState:kn,compareMetaError:zn,compareLabelA:Ze,compareLabelB:$t,compareIncludePilInfo:fn,onToggleCompareIncludePilInfo:Pu,onReload:it,compareDiff:$s,compareHasPilInfoA:cl,compareHasPilInfoB:Mu,compareShowPilInfoA:$n,compareShowPilInfoB:Ut,onToggleCompareShowPilInfoA:Tu,onToggleCompareShowPilInfoB:Iu,compareMetaCopied:G,onCopyCompareMetadata:ol,compareValueCopiedPathA:ce,compareValueCopiedPathB:Ee,compareDisplayNodeA:Su,compareDisplayNodeB:Cu,compareMetaContent:Wi,onCompareMetaPathCopyA:Eu,onCompareMetaPathCopyB:Nu},basicsProps:{open:z.basics,onToggle:T,multi:m,star:M,onSelectStar:Ru,hasStarConflict:Au,onApplyConflict:re,onKeepTheirs:we,currentItem:gt??null,sourceValue:St,sortSpec:d,copiedField:_,onCopyInfo:dl,metricsExpanded:H,onToggleMetricsExpanded:U,metricsPreviewLimit:EE},metadataProps:{open:z.metadata,onToggle:A,metadataLoading:ll,metadataActionLabel:zs,onMetadataAction:ju,metadataActionDisabled:!e,hasPilInfo:ul,showPilInfo:tn,onToggleShowPilInfo:Bs,metaValueCopiedPath:ie,metaHeightClass:al,metaLoaded:Sr,metaDisplayNode:bu,metaContent:Ds,metaError:bt,onMetaPathCopy:ku},notesProps:{open:z.notes,onToggle:O,multi:m,showConflictBanner:_u,onApplyConflict:re,onKeepTheirs:we,notes:Dn,onNotesChange:Ie,onNotesBlur:ge,tags:dn,onTagsChange:fe,onTagsBlur:nt}};return a.jsxs("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:[!m&&a.jsx("div",{className:"p-3 border-b border-border flex justify-center",children:a.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-border w-[220px] h-[160px] bg-panel select-none",children:[Ge&&a.jsx("img",{src:Ge,alt:"thumb",className:"block w-full h-full object-contain"}),!!Bi&&a.jsx("div",{className:"absolute top-1.5 left-1.5 bg-surface border border-border text-text text-xs px-1.5 py-0.5 rounded-md select-none",children:Bi})]})}),rE.filter(ae=>ae.isVisible(Ht)).map(ae=>a.jsx(u.Fragment,{children:ae.render(Ht)},ae.id)),a.jsx("div",{className:fl,onPointerDown:l})]})}function PE({open:e,embeddings:t,rejected:n=[],selectedPath:r,embeddingsLoading:s=!1,embeddingsError:i,onClose:o,onSearch:l}){const[c,d]=u.useState(""),[f,p]=u.useState("path"),[h,w]=u.useState(""),[x,b]=u.useState(""),[C,v]=u.useState("50"),[g,y]=u.useState(""),[m,S]=u.useState(null),[E,j]=u.useState(!1),M=u.useRef(null),I=u.useRef(null),P=u.useMemo(()=>t.find(L=>L.name===c)??t[0]??null,[t,c]);u.useEffect(()=>{e&&(S(null),t.length>0&&!t.some(L=>L.name===c)&&d(t[0].name),r?(p("path"),w(r)):(p("vector"),w("")))},[e,t,c,r]),u.useEffect(()=>{if(!e)return;const L=f==="vector"?I.current:M.current,R=window.requestAnimationFrame(()=>L==null?void 0:L.focus());return()=>window.cancelAnimationFrame(R)},[e,f]);const B=u.useCallback(async()=>{if(S(null),!t.length){S("No embeddings available for similarity search.");return}if(!P){S("Select an embedding to search.");return}const L=h.trim(),R=x.trim(),T=Number(C);if(!Number.isFinite(T)||T<=0){S("Top K must be a positive number.");return}const A=Math.min(1e3,Math.max(1,Math.floor(T))),O=g.trim()===""?null:Number(g);if(O!=null&&!Number.isFinite(O)){S("Min score must be a valid number.");return}if(f==="path"&&!L){S("Select an image path for the query.");return}if(f==="vector"&&!R){S("Paste a base64 vector for the query.");return}const H={embedding:P.name,query_path:f==="path"?L:null,query_vector_b64:f==="vector"?R:null,top_k:A,min_score:O};j(!0);try{await l(H),o()}catch(U){U instanceof ln||U instanceof Error?S(U.message):S("Failed to run similarity search.")}finally{j(!1)}},[t.length,P,h,x,C,g,f,l,o]);u.useEffect(()=>{if(!e)return;const L=R=>{if(R.key==="Escape"){R.preventDefault(),o();return}(R.ctrlKey||R.metaKey)&&R.key==="Enter"&&(R.preventDefault(),B())};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[e,o,B]);const F=u.useCallback(()=>{var L;r&&(p("path"),w(r),(L=M.current)==null||L.focus())},[r]);if(!e)return null;const K=t.map(L=>({value:L.name,label:L.name})),Z=n.length>0,z=n.slice(0,3);return a.jsx("div",{className:"fixed inset-0 z-[var(--z-overlay)] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",onClick:L=>{L.target===L.currentTarget&&o()},children:a.jsxs("div",{className:"w-full max-w-2xl rounded-lg border border-border bg-panel shadow-[0_20px_50px_rgba(0,0,0,0.55)]",onClick:L=>L.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Find similar",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Find similar"}),a.jsx("div",{className:"text-xs text-muted",children:"Search with embeddings"})]}),a.jsx("button",{className:"btn btn-sm",onClick:o,"aria-label":"Close",children:"Close"})]}),a.jsxs("div",{className:"px-4 py-4 space-y-4",children:[i&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:i}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Embedding"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(oh,{value:(P==null?void 0:P.name)??"",onChange:d,options:K,placeholder:s?"Loading embeddings...":"Select embedding",disabled:!t.length,triggerClassName:"min-w-[180px]"}),P&&a.jsxs("span",{className:"text-xs text-muted",children:[P.dimension," dims, ",P.metric,", ",P.dtype]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Query mode"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:`btn btn-sm ${f==="path"?"btn-active":""}`,onClick:()=>p("path"),"aria-pressed":f==="path",children:"Selected image"}),a.jsx("button",{type:"button",className:`btn btn-sm ${f==="vector"?"btn-active":""}`,onClick:()=>p("vector"),"aria-pressed":f==="vector",children:"Vector input"})]})]}),f==="path"?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Image path"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{ref:M,type:"text",className:"input w-full",value:h,onChange:L=>w(L.target.value),placeholder:r?"Selected image path":"Select an image first"}),a.jsx("button",{type:"button",className:"btn btn-sm",onClick:F,disabled:!r,title:r?"Use selected image":"Select an image first",children:"Use selected"})]})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Vector (base64 float32)"}),a.jsx("textarea",{ref:I,className:"ui-textarea w-full font-mono text-[11px]",rows:5,value:x,onChange:L=>b(L.target.value),placeholder:"Paste base64-encoded float32 vector"}),a.jsx("div",{className:"text-[11px] text-muted",children:"Base64 of little-endian float32. Length must match embedding dimension."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Top K"}),a.jsx("input",{type:"number",min:1,max:1e3,step:1,className:"input ui-number w-full",value:C,onChange:L=>v(L.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Min score"}),a.jsx("input",{type:"number",step:.01,className:"input ui-number w-full",value:g,onChange:L=>y(L.target.value),placeholder:"Optional"})]})]}),Z&&a.jsxs("div",{className:"ui-banner text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Skipped columns"}),a.jsxs("div",{className:"mt-1 space-y-1 text-muted",children:[z.map(L=>a.jsxs("div",{children:[L.name,": ",L.reason]},L.name)),n.length>z.length&&a.jsxs("div",{children:["+",n.length-z.length," more"]})]})]}),m&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:m})]}),a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-border",children:[a.jsx("div",{className:"text-xs text-muted",children:P?`Metric: ${P.metric}`:"Metric: cosine"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:o,disabled:E,children:"Cancel"}),a.jsx("button",{className:"btn btn-sm btn-active",onClick:B,disabled:E||!t.length,children:E?"Searching...":"Find similar"})]})]})]})})}const TE=/^[\/@a-zA-Z0-9._\-\/]{1,512}$/,IE=[".jpg",".jpeg",".png",".webp"];function Rt(e){try{const t=decodeURI(e||""),r=(t.startsWith("/")?t:`/${t}`).replace(/\/{2,}/g,"/"),s=r.length>1?r.replace(/\/$/,""):r;return TE.test(s)?s:"/"}catch{return"/"}}function Vm(){return(window.location.hash||"").replace(/^#/,"")}function Ax(e){const t=Rt(e),n=`#${encodeURI(t)}`;window.location.hash!==n&&(window.location.hash=n)}function Bl(e){const t=Rt(e),n=`#${encodeURI(t)}`;if(window.location.hash!==n){const r=`${window.location.pathname}${window.location.search}${n}`;window.history.replaceState(window.history.state,"",r)}}function LE(e){const n=Rt(e).toLowerCase();return IE.some(r=>n.endsWith(r))}function Fx(e,t){const n=e.replace(/\/+$/,""),r=t.replace(/^\/+/,""),s=[n,r].filter(Boolean).join("/");return s.startsWith("/")?s:`/${s}`}function Wm(e){const n=Rt(e).split("/").filter(Boolean);return n.length<=1?"/":"/"+n.slice(0,-1).join("/")}function ph(e){return Rt(e).split("/").filter(Boolean).pop()||""}function _E(e){return e.endsWith("/_trash_")}const AE=new Set([0,1,2,3,4,5]),mh=new Set(["<","<=",">",">="]),FE=/^\d{4}-\d{2}-\d{2}$/;function OE(e,t){return!t||!t.and.length?e:e.filter(n=>DE(n,t.and))}function DE(e,t){for(const n of t)if(!zE(e,n))return!1;return!0}function zE(e,t){var n,r,s,i,o,l,c;if("stars"in t){const d=t.stars;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsIn"in t){const d=t.starsIn.values;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsNotIn"in t){const d=t.starsNotIn.values;if(!d||!d.length)return!0;const f=e.star??0;return!d.includes(f)}if("nameContains"in t){const d=(n=t.nameContains.value)==null?void 0:n.trim();return d?(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("nameNotContains"in t){const d=(r=t.nameNotContains.value)==null?void 0:r.trim();return d?!(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("commentsContains"in t){const d=(s=t.commentsContains.value)==null?void 0:s.trim();if(!d)return!0;const f=e.comments??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("commentsNotContains"in t){const d=(i=t.commentsNotContains.value)==null?void 0:i.trim();if(!d)return!0;const f=e.comments??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("urlContains"in t){const d=(o=t.urlContains.value)==null?void 0:o.trim();if(!d)return!0;const f=e.source??e.url??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("urlNotContains"in t){const d=(l=t.urlNotContains.value)==null?void 0:l.trim();if(!d)return!0;const f=e.source??e.url??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("dateRange"in t){const{from:d,to:f}=t.dateRange;if(!d&&!f)return!0;if(!e.addedAt)return!1;const p=Date.parse(e.addedAt);if(Number.isNaN(p))return!1;const h=Km(d,!1),w=Km(f,!0);return!(h!=null&&p<h||w!=null&&p>w)}if("widthCompare"in t){const{op:d,value:f}=t.widthCompare;if(!Number.isFinite(f))return!0;const p=e.w;return!Number.isFinite(p)||p<=0?!1:qm(p,d,f)}if("heightCompare"in t){const{op:d,value:f}=t.heightCompare;if(!Number.isFinite(f))return!0;const p=e.h;return!Number.isFinite(p)||p<=0?!1:qm(p,d,f)}if("metricRange"in t){const{key:d,min:f,max:p}=t.metricRange,h=(c=e.metrics)==null?void 0:c[d];return!(h==null||h<f||h>p)}return!0}function ef(e){if(!e||typeof e!="object")return null;const t=e.and;if(!Array.isArray(t))return null;const n=[];for(const r of t){const s=eN(r);s&&n.push(s)}return{and:n}}function Hm(e){var r;const t=e.and.find(s=>"stars"in s),n=e.and.find(s=>"starsIn"in s);return(r=n==null?void 0:n.starsIn)!=null&&r.values?n.starsIn.values:(t==null?void 0:t.stars)??[]}function Rc(e,t){return Ox(e,t)}function $E(e){var n;const t=e.and.find(r=>"starsIn"in r);return((n=t==null?void 0:t.starsIn)==null?void 0:n.values)??[]}function Ox(e,t){const n=ko(t),r=e.and.filter(s=>!("starsIn"in s)&&!("stars"in s));return n.length?{and:[{starsIn:{values:n}},...r]}:{and:r}}function BE(e){var n;const t=e.and.find(r=>"starsNotIn"in r);return((n=t==null?void 0:t.starsNotIn)==null?void 0:n.values)??[]}function Dx(e,t){const n=ko(t),r=e.and.filter(s=>!("starsNotIn"in s));return n.length?{and:[{starsNotIn:{values:n}},...r]}:{and:r}}function UE(e){var n;const t=e.and.find(r=>"nameContains"in r);return((n=t==null?void 0:t.nameContains)==null?void 0:n.value)??null}function zx(e,t){const n=xn(t),r=e.and.filter(s=>!("nameContains"in s));return n?{and:[{nameContains:{value:n}},...r]}:{and:r}}function VE(e){var n;const t=e.and.find(r=>"nameNotContains"in r);return((n=t==null?void 0:t.nameNotContains)==null?void 0:n.value)??null}function $x(e,t){const n=xn(t),r=e.and.filter(s=>!("nameNotContains"in s));return n?{and:[{nameNotContains:{value:n}},...r]}:{and:r}}function WE(e){var n;const t=e.and.find(r=>"commentsContains"in r);return((n=t==null?void 0:t.commentsContains)==null?void 0:n.value)??null}function Bx(e,t){const n=xn(t),r=e.and.filter(s=>!("commentsContains"in s));return n?{and:[{commentsContains:{value:n}},...r]}:{and:r}}function HE(e){var n;const t=e.and.find(r=>"commentsNotContains"in r);return((n=t==null?void 0:t.commentsNotContains)==null?void 0:n.value)??null}function Ux(e,t){const n=xn(t),r=e.and.filter(s=>!("commentsNotContains"in s));return n?{and:[{commentsNotContains:{value:n}},...r]}:{and:r}}function QE(e){var n;const t=e.and.find(r=>"urlContains"in r);return((n=t==null?void 0:t.urlContains)==null?void 0:n.value)??null}function Vx(e,t){const n=xn(t),r=e.and.filter(s=>!("urlContains"in s));return n?{and:[{urlContains:{value:n}},...r]}:{and:r}}function KE(e){var n;const t=e.and.find(r=>"urlNotContains"in r);return((n=t==null?void 0:t.urlNotContains)==null?void 0:n.value)??null}function Wx(e,t){const n=xn(t),r=e.and.filter(s=>!("urlNotContains"in s));return n?{and:[{urlNotContains:{value:n}},...r]}:{and:r}}function qE(e){const t=e.and.find(n=>"dateRange"in n);return(t==null?void 0:t.dateRange)??null}function tf(e,t){const n=qa((t==null?void 0:t.from)??null),r=qa((t==null?void 0:t.to)??null),s=e.and.filter(i=>!("dateRange"in i));return!n&&!r?{and:s}:{and:[{dateRange:{...n?{from:n}:{},...r?{to:r}:{}}},...s]}}function GE(e){const t=e.and.find(n=>"widthCompare"in n);return(t==null?void 0:t.widthCompare)??null}function da(e,t){const n=e.and.filter(r=>!("widthCompare"in r));return!t||!Number.isFinite(t.value)||!mh.has(t.op)?{and:n}:{and:[{widthCompare:{op:t.op,value:t.value}},...n]}}function YE(e){const t=e.and.find(n=>"heightCompare"in n);return(t==null?void 0:t.heightCompare)??null}function fa(e,t){const n=e.and.filter(r=>!("heightCompare"in r));return!t||!Number.isFinite(t.value)||!mh.has(t.op)?{and:n}:{and:[{heightCompare:{op:t.op,value:t.value}},...n]}}function XE(e,t){const n=e.and.find(r=>"metricRange"in r&&r.metricRange.key===t);return(n==null?void 0:n.metricRange)??null}function JE(e,t,n){const r=e.and.filter(s=>!("metricRange"in s&&s.metricRange.key===t));return n?{and:[{metricRange:{key:t,min:n.min,max:n.max}},...r]}:{and:r}}function ZE(e){const t=ef(e);return t?t.and.length:0}function eN(e){var t,n,r,s,i,o,l,c;if(!e||typeof e!="object")return null;if("stars"in e){const d=ko(e.stars);return d.length?{starsIn:{values:d}}:null}if("starsIn"in e){const d=ko((t=e.starsIn)==null?void 0:t.values);return d.length?{starsIn:{values:d}}:null}if("starsNotIn"in e){const d=ko((n=e.starsNotIn)==null?void 0:n.values);return d.length?{starsNotIn:{values:d}}:null}if("nameContains"in e){const d=xn((r=e.nameContains)==null?void 0:r.value);return d?{nameContains:{value:d}}:null}if("nameNotContains"in e){const d=xn((s=e.nameNotContains)==null?void 0:s.value);return d?{nameNotContains:{value:d}}:null}if("commentsContains"in e){const d=xn((i=e.commentsContains)==null?void 0:i.value);return d?{commentsContains:{value:d}}:null}if("commentsNotContains"in e){const d=xn((o=e.commentsNotContains)==null?void 0:o.value);return d?{commentsNotContains:{value:d}}:null}if("urlContains"in e){const d=xn((l=e.urlContains)==null?void 0:l.value);return d?{urlContains:{value:d}}:null}if("urlNotContains"in e){const d=xn((c=e.urlNotContains)==null?void 0:c.value);return d?{urlNotContains:{value:d}}:null}if("dateRange"in e){const d=e.dateRange,f=qa((d==null?void 0:d.from)??null),p=qa((d==null?void 0:d.to)??null);return!f&&!p?null:{dateRange:{...f?{from:f}:{},...p?{to:p}:{}}}}if("widthCompare"in e){const d=e.widthCompare,f=Qm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{widthCompare:f}:null}if("heightCompare"in e){const d=e.heightCompare,f=Qm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{heightCompare:f}:null}if("metricRange"in e){const d=e.metricRange;if(!d||typeof d!="object")return null;const f=typeof d.key=="string"?d.key:"",p=nf(d.min),h=nf(d.max);return!f||p==null||h==null||p>h?null:{metricRange:{key:f,min:p,max:h}}}return null}function ko(e){if(!Array.isArray(e))return[];const t=[],n=new Set;for(const r of e){const s=typeof r=="number"?r:typeof r=="string"?Number(r):NaN;!Number.isInteger(s)||!AE.has(s)||n.has(s)||(n.add(s),t.push(s))}return t}function xn(e){if(typeof e!="string")return null;const t=e.trim();return t||null}function qa(e){if(typeof e!="string")return null;const t=e.trim();if(!t)return null;const n=Date.parse(t);return Number.isNaN(n)?null:t}function Qm(e,t){if(typeof e!="string"||!mh.has(e))return null;const n=nf(t);return n==null?null:{op:e,value:n}}function Km(e,t){if(!e)return null;const n=e.trim();if(!n)return null;const r=Date.parse(n);return Number.isNaN(r)?null:t&&FE.test(n)?r+24*60*60*1e3-1:r}function qm(e,t,n){switch(t){case"<":return e<n;case"<=":return e<=n;case">":return e>n;case">=":return e>=n;default:return!0}}function nf(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null}const ms={leftFolders:"leftW.folders",leftMetrics:"leftW.metrics",leftLegacy:"leftW",right:"rightW"},Gm=200,Ym=240,Hx=200;function tN(e){return Number.isFinite(e)&&e>0}function Ul(e){const t=Number(e);return tN(t)?t:null}function Qx(e,t,n){return Math.min(Math.max(e,t),n)}function nN(e){return e==="metrics"?ms.leftMetrics:ms.leftFolders}function rN(e){const t=Ul(e.getItem(ms.leftFolders))??Ul(e.getItem(ms.leftLegacy)),n=Ul(e.getItem(ms.leftMetrics)),r=Ul(e.getItem(ms.right));return{leftFoldersW:t,leftMetricsW:n,rightW:r}}function Xm(e,t,n){e.setItem(t,String(n))}function sN({clientX:e,appLeft:t,appWidth:n,rightWidth:r}){const s=e-t,i=Math.max(Gm,n-r-Hx);return Qx(s,Gm,i)}function iN({clientX:e,appLeft:t,appWidth:n,leftWidth:r}){const s=e-t,i=n-s,o=Math.max(Ym,n-r-Hx);return Qx(i,Ym,o)}function oN(e){return(e.pointerType??"mouse")==="mouse"&&e.button!==0}function lN(e,t){try{e.setPointerCapture(t)}catch{}}function aN(e,t){try{e.releasePointerCapture(t)}catch{}}function uN(e,t){const[n,r]=u.useState(240),[s,i]=u.useState(320),[o,l]=u.useState(240),c=t==="metrics"?s:n,d=u.useRef(c),f=u.useRef(o);u.useEffect(()=>{d.current=c},[c]),u.useEffect(()=>{f.current=o},[o]),u.useEffect(()=>{try{const x=rN(window.localStorage);x.leftFoldersW!==null&&r(x.leftFoldersW),x.leftMetricsW!==null&&i(x.leftMetricsW),x.rightW!==null&&l(x.rightW)}catch{}},[]);const p=(x,b,C)=>{if(oN(x))return;x.preventDefault();const v=x.currentTarget,g=x.pointerId;lN(v,g);const y=E=>{E.pointerId===g&&b(E)};function m(){window.removeEventListener("pointermove",y),window.removeEventListener("pointerup",S),window.removeEventListener("pointercancel",S),aN(v,g)}function S(E){E.pointerId===g&&(m(),C())}window.addEventListener("pointermove",y),window.addEventListener("pointerup",S),window.addEventListener("pointercancel",S)};return{leftW:c,rightW:o,onResizeLeft:x=>{const b=e.current;if(!b)return;const C=b.getBoundingClientRect(),v=nN(t);let g=d.current;p(x,y=>{const m=sN({clientX:y.clientX,appLeft:C.left,appWidth:C.width,rightWidth:f.current});g=m,t==="metrics"?i(m):r(m)},()=>{try{Xm(window.localStorage,v,g)}catch{}})},onResizeRight:x=>{const b=e.current;if(!b)return;const C=b.getBoundingClientRect();let v=f.current;p(x,g=>{const y=iN({clientX:g.clientX,appLeft:C.left,appWidth:C.width,leftWidth:d.current});v=y,f.current=y,l(y)},()=>{try{Xm(window.localStorage,ms.right,v)}catch{}})}}}const cN=5*6e4,dN=6e4,Kx=(e,t)=>t!=null&&t.recursive?["folder",e,"recursive"]:["folder",e];function qx(e){return e[0]!=="folder"||e[2]!=="recursive"||typeof e[1]!="string"?null:e}function fN(e){return qx(e)!==null}function hN(e,t,n=!0){if(!fN(e))return!0;const r=qx(e);if(r==null)return!1;const[,s]=r;return!!(s===t||n&&s==="/")}function pN(e,t,n=!0){return!Array.isArray(e)||e[0]!=="folder"?!1:!hN(e,t,n)}const mN=15e3;function gN(e,t){return me.getFolder(e,t)}function rf(e,t=!1,n){const r=vu(),s={recursive:t},i=!!s.recursive;return hu({queryKey:Kx(e,s),queryFn:()=>gN(e,s),enabled:(n==null?void 0:n.enabled)??!0,staleTime:1e4,gcTime:i?dN:cN,retry:2,retryDelay:o=>Math.min(1e3*Math.pow(2,o),5e3),refetchOnWindowFocus:!1,refetchInterval:r?mN:!1,refetchIntervalInBackground:r})}const Gx="application/x-lenslet-paths",vN='[role="treeitem"].drop-target';function Jm(e){var n;return Array.from(((n=e.dataTransfer)==null?void 0:n.types)||[]).includes(Gx)}function yN(e){document.querySelectorAll(vN).forEach(t=>{t!==e&&t.classList.remove("drop-target")})}function Zm(e){yN(e),e.classList.add("drop-target")}function eg(e){return e.startsWith("/")?e:`/${e}`}function xN({path:e,isLeaf:t}){const n=wr(),r=u.useCallback(l=>{Jm(l)&&(l.preventDefault(),t&&Zm(l.currentTarget))},[t]),s=u.useCallback(l=>{!t||!Jm(l)||(l.preventDefault(),Zm(l.currentTarget))},[t]),i=u.useCallback(l=>{const c=l.currentTarget,d=document.elementFromPoint(l.clientX,l.clientY);d&&c.contains(d)||c.classList.remove("drop-target")},[]),o=u.useCallback(async l=>{const c=l.dataTransfer;if(!c)return;l.preventDefault(),l.currentTarget.classList.remove("drop-target");const d=c.getData(Gx),p=(d?JSON.parse(d):[]).filter(Boolean);if(!p.length)return;let h=p[0].split("/").slice(0,-1).join("/")||"/";h=eg(h);const w=eg(e);try{for(const x of p)await me.moveFile(x,w);n.invalidateQueries({queryKey:["folder",h]}),n.invalidateQueries({queryKey:["folder",w]}),n.setQueryData(["folder",h],x=>!x||!Array.isArray(x.items)?x:{...x,items:x.items.filter(b=>!p.includes(b.path))})}catch{}},[e,n]);return{onDragOver:r,onDragEnter:s,onDragLeave:i,onDrop:o}}const wN='[role="tree"] [role="treeitem"]';function bN(){return Array.from(document.querySelectorAll(wN))}function SN(e,t){var i;const n=bN(),r=n.findIndex(o=>o===e);if(r===-1)return;let s=r;t==="ArrowDown"?s=Math.min(n.length-1,r+1):t==="ArrowUp"?s=Math.max(0,r-1):t==="Home"?s=0:t==="End"&&(s=n.length-1),(i=n[s])==null||i.focus()}function CN({path:e,isLeaf:t,isExpanded:n,setExpanded:r,onOpen:s}){return u.useCallback(i=>{if(i.key==="Enter"){i.preventDefault(),s(e);return}if(i.key==="ArrowRight"){!t&&!n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.add(e),l}));return}if(i.key==="ArrowLeft"){!t&&n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.delete(e),l}));return}(i.key==="ArrowDown"||i.key==="ArrowUp"||i.key==="Home"||i.key==="End")&&(i.preventDefault(),SN(i.currentTarget,i.key))},[e,t,n,r,s])}const tg=64,kN=120;function EN(e){const t=e.split("/").filter(Boolean),n=["/"];let r="";for(const s of t)r=r?`${r}/${s}`:`/${s}`,n.push(r);return n}function NN({current:e,roots:t,data:n,onOpen:r,onPullRefresh:s,onResize:i,onContextMenu:o,onOpenActions:l,countVersion:c,className:d,showResizeHandle:f=!0}){const[p,h]=u.useState(new Set(["/"])),w=u.useRef(new Map),x=u.useRef(new Map),[b,C]=u.useState(!1),[v,g]=u.useState(0),y=u.useRef(null),m=u.useRef(!1),S=wr(),E=u.useCallback(()=>{g(0),y.current=null,m.current=!1},[]),j=u.useCallback(async R=>{const T=Rt(R||"/"),A=w.current,O=x.current,H=A.get(T);if(H!==void 0)return H;const U=S.getQueryData(Kx(T,{recursive:!0}));if(U){const V=U.totalItems??U.items.length;return A.set(T,V),V}const _=O.get(T);if(_)return _;const Q=(async()=>{try{const V=await me.getFolder(T,{recursive:!0}),ee=V.totalItems??V.items.length;return A.set(T,ee),ee}finally{O.delete(T)}})();return O.set(T,Q),Q},[S]);u.useEffect(()=>{w.current.clear(),x.current.clear()},[c]),u.useEffect(()=>{const R=EN(e);h(T=>{const A=new Set(T);for(const O of R)A.add(O);return A})},[e]);const M=u.useCallback(async()=>{if(!(!s||b)){C(!0);try{await s()}catch(R){console.error("Failed to refresh folders:",R)}finally{C(!1),g(0)}}},[s,b]),I=u.useCallback(R=>{!s||b||R.touches.length===1&&(R.currentTarget.scrollTop>0||(y.current=R.touches[0].clientY,m.current=!1))},[s,b]),P=u.useCallback(R=>{if(!s||b||R.touches.length!==1)return;const T=y.current;if(T==null)return;if(R.currentTarget.scrollTop>0){E();return}const A=R.touches[0].clientY-T;if(A<=0){m.current&&g(0);return}!m.current&&A<8||(m.current=!0,R.preventDefault(),g(Math.min(kN,A*.55)))},[b,s,E]),B=u.useCallback(()=>{if(!s||b){E();return}const R=m.current&&v>=tg;if(y.current=null,m.current=!1,R){M();return}g(0)},[M,b,s,v,E]),F=d??"h-full overflow-auto bg-panel scrollbar-thin",K=s?`${F} overscroll-y-contain`:F,Z=!!s&&(b||v>0),z=v>=tg,L=b?28:Math.min(44,v);return a.jsxs("div",{className:K,onTouchStart:s?I:void 0,onTouchMove:s?P:void 0,onTouchEnd:s?B:void 0,onTouchCancel:s?B:void 0,children:[Z&&a.jsx("div",{className:"flex items-end justify-center text-[11px] text-muted select-none transition-[height,opacity] duration-150",style:{height:L,opacity:b||v>8?1:.65},"aria-live":"polite",children:b?"Refreshing":z?"Release to refresh":"Pull to refresh"}),a.jsx("div",{className:"p-1",role:"tree","aria-label":"Folders",children:t.map(R=>a.jsx(Yx,{path:R.path,label:R.label,depth:0,current:e,expanded:p,setExpanded:h,onOpen:r,onContextMenu:o,onOpenActions:l,initial:n,getSubtreeCount:j,countVersion:c},R.path))}),f&&a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 left-[calc(var(--left)-6px)]",onPointerDown:i})]})}function Yx({path:e,label:t,depth:n,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:c,initial:d,getSubtreeCount:f,countVersion:p}){var F;const h=s.has(e),w=r===e,x=e==="/"||h||w,{data:b}=rf(e,!1,{enabled:x}),C=d&&e===d.path?d:b,g=!!C?C.dirs.length===0:!1,[y,m]=u.useState(C?C.items.length:null),S=CN({path:e,isLeaf:g,isExpanded:h,setExpanded:i,onOpen:o}),{onDragOver:E,onDragEnter:j,onDragLeave:M,onDrop:I}=xN({path:e,isLeaf:g}),P=K=>{K.stopPropagation(),!g&&i(Z=>{const z=new Set(Z);return z.has(e)?z.delete(e):z.add(e),z})},B=K=>{if(K.stopPropagation(),!c)return;const Z=K.currentTarget.getBoundingClientRect();c(e,{x:Z.right-4,y:Z.bottom-4})};return u.useEffect(()=>{let K=!1;if(!C){m(null);return}if(m(C.items.length),!!(h&&(n>0||w)))return f(e).then(z=>{K||m(z)}).catch(z=>{K||console.warn(`Failed to compute subtree count for ${e}:`,z)}),()=>{K=!0}},[C,e,f,p,h,n,w]),a.jsxs("div",{children:[a.jsxs("div",{className:`tree-row flex items-center gap-1.5 py-1 px-2 rounded-md cursor-pointer min-h-[40px] outline-none transition-colors duration-75 ${w?"bg-accent/20 text-accent font-medium":"hover:bg-white/5 text-text"}`,role:"treeitem","aria-level":n+1,"aria-expanded":g?void 0:h,"aria-selected":w,tabIndex:w?0:-1,style:{paddingLeft:8+n*14},onClick:()=>o(e),onContextMenu:K=>{K.preventDefault(),K.stopPropagation(),l==null||l(K,e)},onKeyDown:S,onDragOver:E,onDragEnter:j,onDragLeave:M,onDrop:I,children:[a.jsx("button",{type:"button",className:"tree-expand-btn touch-manipulation",onClick:P,"aria-label":g?`No subfolders in ${t}`:`${h?"Collapse":"Expand"} ${t}`,"aria-expanded":g?void 0:h,disabled:g,children:g?"":h?"":""}),a.jsx("span",{className:"flex-1 overflow-hidden truncate text-sm",title:t,children:Rk(t,28)}),y!==null&&a.jsx("span",{className:"text-[10px] opacity-50 bg-white/5 border border-white/5 rounded px-1.5 min-w-[24px] text-center",children:y}),c&&a.jsx("button",{type:"button",className:"tree-row-action-btn touch-manipulation","aria-label":`Open actions for ${t}`,"aria-haspopup":"menu",onPointerDown:K=>K.stopPropagation(),onClick:B,children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]}),h&&((F=C==null?void 0:C.dirs)==null?void 0:F.map(K=>a.jsx(Yx,{path:Fx(e,K.name),label:K.name,depth:n+1,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:c,getSubtreeCount:f,countVersion:p},K.name)))]})}const ng=[5,4,3,2,1],rg=["<","<=",">",">="];function jN({filters:e,onChangeFilters:t}){const n=u.useMemo(()=>$E(e),[e]),r=u.useMemo(()=>BE(e),[e]),s=u.useMemo(()=>UE(e)??"",[e]),i=u.useMemo(()=>VE(e)??"",[e]),o=u.useMemo(()=>WE(e)??"",[e]),l=u.useMemo(()=>HE(e)??"",[e]),c=u.useMemo(()=>QE(e)??"",[e]),d=u.useMemo(()=>KE(e)??"",[e]),f=u.useMemo(()=>qE(e)??{},[e]),p=u.useMemo(()=>sg(f.from),[f.from]),h=u.useMemo(()=>sg(f.to),[f.to]),w=u.useMemo(()=>GE(e),[e]),x=u.useMemo(()=>YE(e),[e]),[b,C]=u.useState((w==null?void 0:w.op)??">="),[v,g]=u.useState((x==null?void 0:x.op)??">=");u.useEffect(()=>{w!=null&&w.op&&C(w.op)},[w==null?void 0:w.op]),u.useEffect(()=>{x!=null&&x.op&&g(x.op)},[x==null?void 0:x.op]);const y=(m,S)=>{const E=new Set(n),j=new Set(r);m==="include"?E.has(S)?E.delete(S):(E.add(S),j.delete(S)):j.has(S)?j.delete(S):(j.add(S),E.delete(S));let M=Ox(e,Array.from(E));M=Dx(M,Array.from(j)),t(M)};return a.jsxs("div",{className:"ui-card",children:[a.jsx("div",{className:"ui-section-title mb-3",children:"Attributes"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Rating"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Include"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[ng.map(m=>{const S=n.includes(m);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${S?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>y("include",m),"aria-pressed":S,title:`Include ${m} star${m>1?"s":""}`,children:[m,""]},`stars-in-${m}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${n.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>y("include",0),"aria-pressed":n.includes(0),title:"Include unrated",children:"None"})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Exclude"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[ng.map(m=>{const S=r.includes(m);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${S?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>y("exclude",m),"aria-pressed":S,title:`Exclude ${m} star${m>1?"s":""}`,children:[m,""]},`stars-out-${m}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${r.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>y("exclude",0),"aria-pressed":r.includes(0),title:"Exclude unrated",children:"None"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Filename"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:s,placeholder:"e.g. draft",onChange:m=>t(zx(e,m.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:i,placeholder:"e.g. v1",onChange:m=>t($x(e,m.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Comments"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:o,placeholder:"e.g. hero",onChange:m=>t(Bx(e,m.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:l,placeholder:"e.g. todo",onChange:m=>t(Ux(e,m.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"URL"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:c,placeholder:"e.g. s3://bucket",onChange:m=>t(Vx(e,m.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:d,placeholder:"e.g. http://",onChange:m=>t(Wx(e,m.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Date Added"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"From"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:p,onChange:m=>t(tf(e,{from:m.target.value||null,to:f.to??null}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"To"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:h,onChange:m=>t(tf(e,{from:f.from??null,to:m.target.value||null}))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Dimensions"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Width"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:b,onChange:m=>{const S=m.target.value;C(S),w&&t(da(e,{op:S,value:w.value}))},children:rg.map(m=>a.jsx("option",{value:m,children:m},`w-${m}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:w?String(w.value):"",min:0,placeholder:"px",onChange:m=>{const S=m.target.value;if(!S){t(da(e,null));return}const E=Number(S);Number.isFinite(E)&&t(da(e,{op:b,value:E}))}})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Height"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:v,onChange:m=>{const S=m.target.value;g(S),x&&t(fa(e,{op:S,value:x.value}))},children:rg.map(m=>a.jsx("option",{value:m,children:m},`h-${m}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:x?String(x.value):"",min:0,placeholder:"px",onChange:m=>{const S=m.target.value;if(!S){t(fa(e,null));return}const E=Number(S);Number.isFinite(E)&&t(fa(e,{op:v,value:E}))}})]})]})]})]})]})]})}function sg(e){return e?e.length>=10?e.slice(0,10):e:""}const MN=[];function sf(e,t){if(t!=null&&t.length)return RN(e,t);const n=new Map;for(const r of e){const s=r.metrics;if(s)for(const[i,o]of Object.entries(s)){if(o==null||Number.isNaN(o))continue;const l=n.get(i);l?l.push(o):n.set(i,[o])}}return n}function RN(e,t){const n=t.map(s=>({key:s,values:[]}));for(const s of e){const i=s.metrics;if(i)for(const o of n){const l=i[o.key];l==null||Number.isNaN(l)||o.values.push(l)}}const r=new Map;for(const s of n)s.values.length&&r.set(s.key,s.values);return r}function Hs(e,t){return e.get(t)??MN}function Pc(e,t,n){if(!e.length)return null;const r=n?n.min:Math.min(...e);let s=n?n.max:Math.max(...e);r===s&&(s=r+1);const i=new Array(t).fill(0),o=t/(s-r);for(const l of e){const c=Math.max(0,Math.min(t-1,Math.floor((l-r)*o)));i[c]+=1}return{bins:i,min:r,max:s,count:e.length}}function Xx(e,t){return e<t?{min:e,max:t}:{min:t,max:e}}function nn(e){return Ex(e)}function Er(e){if(!Number.isFinite(e))return"";const t=e.toString();return t.includes("e")?e.toFixed(6):t}function ig(e){const t=e.trim();if(!t)return{value:null,valid:!0};const n=Number(t);return Number.isFinite(n)?{value:n,valid:!0}:{value:null,valid:!1}}function og(e,t,n){return e<t?t:e>n?n:e}function gh(e){return e<0?0:e>1?1:e}function Qs(e,t){const n=Math.max(1,Math.abs(e),Math.abs(t));return Math.abs(e-t)<=1e-6*n}function PN(e,t,n){const r=gh((e-t.left)/t.width);return n.min+(n.max-n.min)*r}function TN(e,t,n=4){return e==null?!1:Math.abs(t-e)>=n}function Jx(e,t){return Xx(e??t,t)}function IN(e,t,n,r){return e&&t!=null?{commitRange:Jx(n,t),shouldClear:!1}:{commitRange:null,shouldClear:r!=null}}function LN({metricKey:e,domain:t,activeRange:n,onChangeRange:r}){const[s,i]=u.useState(null),[o,l]=u.useState(!1),c=u.useRef(null),d=u.useRef(null),f=u.useRef(!1),p=u.useRef(null),[h,w]=u.useState(null),x=s??n;u.useEffect(()=>{w(null)},[e,t==null?void 0:t.min,t==null?void 0:t.max]);const b=y=>{var S;if(!t)return null;const m=(S=p.current)==null?void 0:S.getBoundingClientRect();return m?PN(y,{left:m.left,width:m.width},t):null};return{svgRef:p,hoverValue:h,displayRange:x,onPointerDown:y=>{var S;if(!t)return;y.preventDefault();const m=b(y.clientX);m!=null&&(l(!0),i(null),c.current=m,d.current=y.clientX,f.current=!1,w(m),(S=p.current)==null||S.setPointerCapture(y.pointerId))},onPointerMove:y=>{const m=b(y.clientX);if(m==null){o||w(null);return}w(m),o&&(!f.current&&!TN(d.current,y.clientX)||(f.current=!0,i(Jx(c.current,m))))},onPointerUp:y=>{var E;if(!o)return;l(!1),(E=p.current)==null||E.releasePointerCapture(y.pointerId);const m=b(y.clientX),S=IN(f.current,m,c.current,n);S.commitRange?(w(m),r(S.commitRange)):S.shouldClear&&r(null),c.current=null,d.current=null,f.current=!1,setTimeout(()=>i(null),0)},onPointerLeave:()=>w(null)}}const gs=40;function lg({metricKey:e,populationValues:t,filteredValues:n,selectedValues:r=[],filters:s,onChangeRange:i,showTitle:o=!1}){const l=u.useMemo(()=>Pc(t,gs),[t]),c=u.useMemo(()=>l?Pc(n,gs,l):null,[n,l]),d=XE(s,e),f=l?{min:l.min,max:l.max}:null,{svgRef:p,hoverValue:h,displayRange:w,onPointerDown:x,onPointerMove:b,onPointerUp:C,onPointerLeave:v}=LN({metricKey:e,domain:f,activeRange:d,onChangeRange:F=>i(e,F)}),[g,y]=u.useState(""),[m,S]=u.useState(""),[E,j]=u.useState(null),M=r.length===1?r[0]:null,I=u.useMemo(()=>!l||r.length<2?null:Pc(r,gs,l),[r,l]);u.useEffect(()=>{if(!d||!f){E!=="min"&&y(d?Er(d.min):""),E!=="max"&&S(d?Er(d.max):"");return}if(E!=="min"){const F=Qs(d.min,f.min)?"":Er(d.min);y(F)}if(E!=="max"){const F=Qs(d.max,f.max)?"":Er(d.max);S(F)}},[d,f,E]);const P=(F,K)=>{if(!f)return;const Z=ig(F),z=ig(K);if(!Z.valid||!z.valid){Z.valid||y(d?Er(d.min):""),z.valid||S(d?Er(d.max):"");return}if(Z.value==null&&z.value==null){i(e,null);return}const L=Z.value??f.min,R=z.value??f.max,T=og(L,f.min,f.max),A=og(R,f.min,f.max),O=Xx(T,A);if(Qs(O.min,f.min)&&Qs(O.max,f.max)){i(e,null);return}i(e,O)};if(!l||!f)return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]});const B=r.length;return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mb-2 tabular-nums",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{children:["Population: ",l.count]}),a.jsxs("span",{children:["Filtered: ",(c==null?void 0:c.count)??0]}),B>1&&a.jsxs("span",{className:"text-text",children:["Selected: ",B]})]}),M!=null&&a.jsxs("span",{className:"text-text",children:["Selected: ",nn(M)]})]}),a.jsxs("svg",{ref:p,viewBox:`0 0 ${gs} 100`,preserveAspectRatio:"none",className:"w-full h-28 cursor-crosshair rounded-md bg-surface-inset",onPointerDown:x,onPointerMove:b,onPointerUp:C,onPointerLeave:v,children:[Tc(l.bins,"#2e3a4b"),c&&Tc(c.bins,"#3a8fff"),I&&Tc(I.bins,"#f59e0b",{opacity:.55}),w&&_N(w,f),M!=null&&ag(M,f,{color:"var(--highlight)",strokeWidth:.7}),h!=null&&ag(h,f,{color:"rgba(255,255,255,0.75)",strokeWidth:.5,dashed:!0})]}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mt-2 tabular-nums",children:[a.jsx("span",{children:nn(f.min)}),a.jsxs("div",{className:"flex flex-col items-center text-center leading-tight",children:[w?a.jsx("span",{className:"text-text",children:Qs(w.min,f.min)?` ${nn(w.max)}`:Qs(w.max,f.max)?` ${nn(w.min)}`:`${nn(w.min)}  ${nn(w.max)}`}):h!=null?a.jsxs("span",{className:"text-text",children:["Cursor: ",nn(h)]}):a.jsx("span",{children:"Drag to filter"}),w&&h!=null&&a.jsxs("span",{className:"text-[11px] text-muted",children:["Cursor: ",nn(h)]})]}),a.jsx("span",{children:nn(f.max)})]}),a.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2 mt-3 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Min"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:g,placeholder:Er(f.min),onFocus:()=>j("min"),onBlur:()=>{j(null),P(g,m)},onChange:F=>y(F.target.value),onKeyDown:F=>{F.key==="Enter"&&F.currentTarget.blur()}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Max"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:m,placeholder:Er(f.max),onFocus:()=>j("max"),onBlur:()=>{j(null),P(g,m)},onChange:F=>S(F.target.value),onKeyDown:F=>{F.key==="Enter"&&F.currentTarget.blur()}})]}),a.jsx("button",{className:"btn btn-xs btn-ghost text-muted hover:text-text",onClick:()=>i(e,null),children:"Clear"})]})]})}function Tc(e,t,n){const r=Math.max(1,...e),s=(n==null?void 0:n.opacity)??.9;return e.map((i,o)=>{const l=i/r*100;return a.jsx("rect",{x:o+.05,y:100-l,width:.9,height:l,fill:t,opacity:s},`${t}-${o}`)})}function _N(e,t){const n=(e.min-t.min)/(t.max-t.min),r=(e.max-t.min)/(t.max-t.min),s=gs*gh(Math.min(n,r)),i=gs*Math.abs(r-n);return a.jsx("rect",{x:s,y:0,width:Math.max(.5,i),height:100,fill:"rgba(255,255,255,0.08)",stroke:"rgba(255,255,255,0.4)",strokeWidth:.4})}function ag(e,t,n){const r=gh((e-t.min)/(t.max-t.min)),s=gs*r;return a.jsx("line",{x1:s,y1:0,x2:s,y2:100,stroke:n.color,strokeWidth:n.strokeWidth??.5,strokeDasharray:n.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}const AN=new Map;function FN({items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}){const[c,d]=u.useState(!1),f=s&&n.includes(s)?s:n[0],p=u.useMemo(()=>c?n:f?[f]:[],[c,n,f]),h=u.useMemo(()=>sf(e,p),[e,p]),w=u.useMemo(()=>sf(t,p),[t,p]),x=r??AN;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("label",{className:"ui-label",children:"Metric"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-[11px]",onClick:()=>d(b=>!b),"aria-pressed":c,children:c?"Show one":"Show all"})]}),c?a.jsx("div",{className:"ui-input ui-input-readonly w-full flex items-center text-xs",children:"All metrics"}):a.jsx("select",{className:"ui-select w-full",value:f,onChange:b=>i(b.target.value),children:n.map(b=>a.jsx("option",{value:b,children:b},b))})]}),c?a.jsx("div",{className:"space-y-3",children:n.map(b=>a.jsx(lg,{metricKey:b,populationValues:Hs(h,b),filteredValues:Hs(w,b),selectedValues:Hs(x,b),filters:o,onChangeRange:l,showTitle:!0},b))}):f?a.jsx(lg,{metricKey:f,populationValues:Hs(h,f),filteredValues:Hs(w,f),selectedValues:Hs(x,f),filters:o,onChangeRange:l}):a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]})}const ON=12;function DN({items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l,onChangeFilters:c}){const d=u.useMemo(()=>r!=null&&r.length?sf(r,n):null,[r,n]),f=d&&r&&r.length?a.jsx(zN,{selectedValuesByKey:d,totalItems:r.length,metricKeys:n}):null,p=a.jsx(jN,{filters:o,onChangeFilters:c});return n.length?a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,a.jsx(FN,{items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:d,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}),p]}):a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,p,a.jsx("div",{className:"p-4 text-sm text-muted",children:"No metrics found in this dataset."})]})}function zN({selectedValuesByKey:e,totalItems:t,metricKeys:n}){const r=u.useMemo(()=>e.size?{entries:(n.length?n.filter(p=>e.has(p)):Array.from(e.keys()).sort()).map(p=>{const h=e.get(p)??[],w=Math.min(...h),x=Math.max(...h),b=h.reduce((C,v)=>C+v,0)/Math.max(1,h.length);return{key:p,value:h[0],min:w,max:x,avg:b,count:h.length}}),totalItems:t}:null,[e,n,t]);if(!r)return null;const{entries:s,totalItems:i}=r,o=s.slice(0,ON),l=s.length-o.length,c=i>1;return a.jsxs("div",{className:"ui-card",children:[a.jsxs("div",{className:"ui-card-header",children:[a.jsx("div",{className:"ui-section-title",children:"Selected metrics"}),a.jsxs("div",{className:"text-[11px] text-muted",children:[i," item",i===1?"":"s"]})]}),a.jsxs("div",{className:"space-y-1 text-[12px]",children:[o.map(d=>a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-muted w-28 shrink-0 truncate",title:d.key,children:d.key}),a.jsxs("span",{className:"font-mono text-text text-right tabular-nums",children:[c?`${nn(d.min)}  ${nn(d.max)}`:nn(d.value),c&&a.jsxs("span",{className:"text-[11px] text-muted ml-2",children:["avg ",nn(d.avg),d.count!==i?`  ${d.count}/${i}`:""]})]})]},d.key)),l>0&&a.jsxs("div",{className:"text-[11px] text-muted",children:["+",l," more"]})]})]})}const $N=[{label:"Root",path:"/"}],BN="w-11 h-11 rounded-md border border-border flex items-center justify-center transition-colors",UN="bg-accent-muted text-accent",VN="bg-surface text-text hover:bg-surface-hover";function Vl(e){return`${BN} ${e?UN:VN}`}function WN({leftTool:e,onToolChange:t,compareEnabled:n,compareActive:r,onOpenCompare:s,views:i,activeViewId:o,onActivateView:l,onSaveView:c,current:d,data:f,onOpenFolder:p,onOpenFolderActions:h,onPullRefreshFolders:w,onContextMenu:x,countVersion:b,items:C,filteredItems:v,metricKeys:g,selectedItems:y,selectedMetric:m,onSelectMetric:S,filters:E,onChangeRange:j,onChangeFilters:M,onResize:I}){const P=Vl(e==="folders"),B=Vl(e==="metrics"),F=Vl(r),K=`${Vl(!1)} cursor-pointer`;return a.jsxs("div",{className:"app-left-panel col-start-1 row-start-2 relative border-r border-border bg-panel overflow-visible",children:[a.jsxs("div",{className:"absolute inset-y-0 left-0 w-12 border-r border-border flex flex-col items-center gap-2 py-3 bg-surface-overlay",children:[a.jsx("button",{className:P,title:"Folders","aria-label":"Folders","aria-pressed":e==="folders",onClick:()=>t("folders"),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M3 7.5h6l2-2h10a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2z"})})}),a.jsx("button",{className:B,title:"Metrics / Filters","aria-label":"Metrics and Filters","aria-pressed":e==="metrics",onClick:()=>t("metrics"),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]})}),a.jsx("div",{className:"w-6 h-px bg-border/70 my-1"}),a.jsx("button",{className:`${F} ${n?"":"opacity-40 cursor-not-allowed"}`,title:n?"Compare selected images":"Compare (select 2+)","aria-label":"Compare selected images","aria-pressed":r,"aria-disabled":!n,disabled:!n,onClick:()=>{n&&s()},children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("rect",{x:"3",y:"4",width:"8",height:"16",rx:"1"}),a.jsx("rect",{x:"13",y:"4",width:"8",height:"16",rx:"1"})]})}),a.jsx("div",{className:"flex-1"}),a.jsx("a",{className:K,href:"https://github.com/trojblue/lenslet",title:"Lenslet on GitHub","aria-label":"Lenslet on GitHub",target:"_blank",rel:"noreferrer",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:a.jsx("path",{d:"M12 .5C5.73.5.5 5.74.5 12.02c0 5.1 3.29 9.42 7.86 10.95.58.11.79-.25.79-.56v-2.17c-3.2.7-3.88-1.55-3.88-1.55-.53-1.35-1.29-1.71-1.29-1.71-1.05-.72.08-.71.08-.71 1.16.08 1.78 1.2 1.78 1.2 1.03 1.77 2.71 1.26 3.37.96.1-.75.4-1.26.73-1.55-2.55-.29-5.23-1.29-5.23-5.74 0-1.27.45-2.31 1.19-3.13-.12-.29-.52-1.46.11-3.05 0 0 .97-.31 3.18 1.19.92-.26 1.91-.39 2.89-.39.98 0 1.97.13 2.89.39 2.2-1.5 3.18-1.19 3.18-1.19.63 1.59.23 2.76.11 3.05.74.82 1.19 1.86 1.19 3.13 0 4.46-2.69 5.45-5.25 5.73.41.36.78 1.07.78 2.16v3.2c0 .31.21.67.8.56 4.56-1.53 7.85-5.85 7.85-10.95C23.5 5.74 18.27.5 12 .5z"})})})]}),a.jsx("div",{className:"ml-12 h-full overflow-hidden",children:e==="folders"?a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-2 py-2 border-b border-border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Smart Folders"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:c,title:"Save current view as Smart Folder",children:"+ New"})]}),i.length?a.jsx("div",{className:"flex flex-col gap-1",children:i.map(Z=>{const z=Z.id===o;return a.jsx("button",{className:`text-left px-2 py-2 rounded-md text-sm ${z?"bg-accent-muted text-accent":"hover:bg-hover text-text"}`,onClick:()=>l(Z),children:Z.name},Z.id)})}):a.jsx("div",{className:"text-xs text-muted px-1 py-1.5",children:"No saved Smart Folders yet."})]}),a.jsx(NN,{current:d,roots:$N,data:f,onOpen:p,onPullRefresh:w,onContextMenu:x,onOpenActions:h,countVersion:b,className:"flex-1 min-h-0 overflow-auto scrollbar-thin",showResizeHandle:!1})]}):a.jsx(DN,{items:C,filteredItems:v,metricKeys:g,selectedItems:y,selectedMetric:m,onSelectMetric:S,filters:E,onChangeRange:j,onChangeFilters:M})}),a.jsx("div",{className:"toolbar-offset sidebar-resize-handle sidebar-resize-handle-left absolute bottom-0",onPointerDown:I})]})}function HN({persistenceEnabled:e,indexing:t=null,showSwitchToMostRecentBanner:n=!1,onSwitchToMostRecent:r,offViewSummary:s,onRevealOffView:i,canRevealOffView:o=!1,onClearOffView:l,browserZoomPercent:c}){const f=!!(s!=null&&s.names.length)&&s?` (${s.names.join(", ")}${s.extra?` +${s.extra}`:""})`:"",p=o&&i!=null,h=typeof c=="number"?c:null,w=h!==null&&Math.abs(h-100)>=2,x=(t==null?void 0:t.state)==="running",b=(t==null?void 0:t.state)==="error",C=t!=null&&t.scope&&t.scope!=="/"?` (${t.scope})`:"",v=(()=>{if(!x)return null;const m=typeof(t==null?void 0:t.done)=="number"?t.done:null,S=typeof(t==null?void 0:t.total)=="number"?t.total:null;return m===null&&S===null?null:S===null?`${m??0} indexed`:`${Math.min(m??0,S)} / ${S}`})(),g=n&&r!=null;return!e||x||b||g||w||!!s?a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-col gap-2",children:[!e&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Not persisted."})," Workspace is read-only; edits stay in memory until restart."]}),x&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Indexing in progress",C,"."]})," ",v?`${v} complete.`:"Preparing searchable index."]}),b&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Indexing failed."})," ",(t==null?void 0:t.error)||"Open server logs for details."]}),g&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("span",{children:[a.jsx("span",{className:"font-semibold",children:"Indexing complete."})," ","Scan-stable ordering is active for this generation."]}),a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>r==null?void 0:r(),children:"Switch to Most recent"})]}),w&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Browser zoom ",Math.round(h),"%."]})," For best results, set it to 100% so UI elements stay in correct proportions."]}),s&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex items-center justify-between gap-3",children:[a.jsxs("span",{children:["Updates outside current view: ",s.count," item",s.count===1?"":"s",f]}),a.jsxs("div",{className:"flex items-center gap-2",children:[p&&a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>i==null?void 0:i(),"aria-label":"Reveal off-view updates",children:"Reveal"}),a.jsx("button",{className:"text-muted hover:text-text transition-colors text-base leading-none",onClick:l,"aria-label":"Clear off-view updates",children:""})]})]})]})}):null}function QN(e){return e.isOffline?"offline":e.isUnstable?"unstable":e.recentEditActive?"recent":Number.isFinite(e.editingCount)&&e.editingCount>0?"editing":"live"}const KN=6e3,qN=1e4,GN=24*60*6e4,YN=3e4,XN=350,JN=1400,Zx=[-2,-1,1,2],e0=[-2,-1,0,1,2,3];Zx.length;e0.length;function ZN(e,t,n){return Math.min(Math.max(e,t),n)}function t0(e,t,n){const r=new Set,s=[];for(const i of n){const o=t+i;if(o<0||o>=e.length)continue;const l=e[o];!l||r.has(l)||(r.add(l),s.push(l))}return s}function ej(e,t){if(!t)return[];const n=e.indexOf(t);return n<0?[]:t0(e,n,Zx)}function tj(e,t){if(e.length<2)return[];const n=Math.max(0,e.length-2),r=ZN(t,0,n);return t0(e,r,e0)}function nj({paths:e,defaultDestination:t,destinations:n,loadingDestinations:r,onClose:s,onSubmit:i}){const[o,l]=u.useState(()=>Rt(t||"/")),[c,d]=u.useState(!1);u.useEffect(()=>{l(Rt(t||"/"))},[t,e]);const f=Rt(o||"/"),p=e.length>0&&!c,h=e.slice(0,3).map(C=>ph(C)||C),w=Math.max(0,e.length-h.length),x=n.filter(C=>C!==f).slice(0,8),b=async C=>{if(C.preventDefault(),!!p){d(!0);try{await i(e,f)}finally{d(!1)}}};return a.jsx("div",{className:"toolbar-offset fixed inset-0 z-overlay bg-black/45 backdrop-blur-[1px] flex items-center justify-center p-3",children:a.jsxs("div",{className:"w-full max-w-[560px] rounded-xl border border-border bg-panel shadow-[0_20px_60px_rgba(0,0,0,0.55)]",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Move to folder"}),a.jsxs("div",{className:"text-xs text-muted",children:[e.length," item(s) selected"]})]}),a.jsx("button",{type:"button",className:"btn btn-icon",onClick:s,"aria-label":"Close move dialog",disabled:c,children:""})]}),a.jsxs("form",{className:"px-4 py-3 flex flex-col gap-3",onSubmit:b,children:[a.jsxs("div",{className:"text-xs text-muted",children:[h.join(", "),w>0?` and ${w} more`:""]}),a.jsxs("label",{className:"text-xs text-muted flex flex-col gap-1.5",children:["Destination folder",a.jsx("input",{value:o,onChange:C=>l(C.target.value),className:"input w-full",list:"move-destination-list",placeholder:"/",autoFocus:!0,disabled:c})]}),a.jsx("datalist",{id:"move-destination-list",children:n.map(C=>a.jsx("option",{value:C},C))}),a.jsx("div",{className:"text-[11px] text-muted",children:r?"Loading folder list":`${n.length.toLocaleString()} destination(s) loaded`}),x.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.map(C=>a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>l(C),disabled:c,children:C},C))}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-border",children:[a.jsx("button",{type:"button",className:"btn",onClick:s,disabled:c,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-active",disabled:!p,children:c?"Moving":"Move"})]})]})]})})}function rj(e){return JSON.stringify(e,null,2)}function sj(e){const t=s=>'"'+s.replaceAll('"','""')+'"',n="path,folder,name,star,type,size,width,height,tags,notes",r=e.map(s=>{const i=(s.tags||[]).join(" "),o=s.notes||"";return[s.path,s.folder,s.name,String(s.star??""),s.type??"",s.size??"",s.width??"",s.height??"",i,o].map(l=>t(String(l))).join(",")});return[n,...r].join(`
`)}function ij(e){return e.map(t=>{const n=t.path.split("/").filter(Boolean);n.pop();const r=n.length?`/${n.join("/")}`:"/";return{path:t.path,folder:r,name:t.name,star:t.star??null,type:t.type,size:t.size,width:t.w,height:t.h}})}function oj({x:e,y:t,items:n}){const r=u.useRef(null),[s,i]=u.useState({x:e,y:t}),[o,l]=u.useState(!1),c=u.useCallback((f,p)=>{p.stopPropagation(),f.disabled||f.onClick()},[]),d=u.useCallback(()=>{const f=r.current,p=ux(),h=f==null?void 0:f.getBoundingClientRect(),w=(h==null?void 0:h.width)??180,x=(h==null?void 0:h.height)??Math.max(40,n.length*36),b=ax({x:e,y:t,menuWidth:w,menuHeight:x,viewport:p});i(C=>C.x===b.x&&C.y===b.y?C:b),l(!0)},[n.length,e,t]);return u.useLayoutEffect(()=>{d()},[d]),u.useEffect(()=>(window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}),[d]),a.jsx("div",{ref:r,className:"dropdown-panel fixed",role:"menu",style:{left:s.x,top:s.y,minWidth:180,visibility:o?"visible":"hidden"},onClick:f=>f.stopPropagation(),children:n.map((f,p)=>a.jsxs("button",{className:`dropdown-item w-full ${f.danger?"text-danger hover:text-danger":""}`,role:"menuitem","aria-disabled":f.disabled,disabled:f.disabled,onClick:h=>c(f,h),children:[f.icon&&a.jsx("span",{className:"shrink-0",children:f.icon}),a.jsx("span",{children:f.label})]},p))})}function ug(e){return e==="csv"?"text/csv;charset=utf-8":"application/json;charset=utf-8"}function cg(e,t){const n=ij(e);return t==="csv"?sj(n):rj(n)}function dg(){return new Date().toISOString().replace(/[:.]/g,"-")}async function lj(e){return(await me.getFolder(e,{recursive:!0})).items}function aj({ctx:e,current:t,items:n,setCtx:r,onRefetch:s,onOpenMoveDialog:i,onRefreshFolder:o}){const l=_E(t),[c,d]=u.useState(!1),[f,p]=u.useState(null),h=e.kind==="grid"?e.payload.paths:[],w=u.useMemo(()=>new Map(n.map(j=>[j.path,j])),[n]),x=()=>{r(null)},b=async()=>{const j=e.kind==="tree"?e.payload.path:"/";d(!0);try{await o(j)}catch(M){console.error("Failed to refresh folder:",M)}finally{d(!1),x()}},C=j=>async()=>{p(j);const M=e.kind==="tree"?e.payload.path:t;try{const I=await lj(M),P=cg(I,j),B=ug(j),F=M==="/"?"root":(M.replace(/^\/+/,"")||"root").replace(/\//g,"_");Co(new Blob([P],{type:B}),`metadata_${F}_${dg()}.${j}`)}catch(I){console.error("Failed to export folder:",I),alert("Failed to export folder. See console for details.")}finally{p(null),x()}},v=j=>async()=>{p(j);try{const M=new Set(h),I=n.filter(F=>M.has(F.path)),P=cg(I,j),B=ug(j);Co(new Blob([P],{type:B}),`metadata_selection_${dg()}.${j}`)}finally{p(null),x()}},g=async()=>{var j;if(h.length){x();for(const M of h)try{const I=await me.getFile(M),P=((j=w.get(M))==null?void 0:j.name)||ph(M)||"image";Co(I,P)}catch(I){console.error(`Failed to download ${M}:`,I)}}},y=async()=>{if(!l){for(const j of h)try{await me.moveFile(j,"/_trash_")}catch(M){console.error(`Failed to trash ${j}:`,M)}s(),x()}},m=async()=>{if(confirm(`Delete ${h.length} file(s) permanently? This cannot be undone.`)){try{await me.deleteFiles(h)}catch(j){console.error("Failed to delete files:",j)}s(),x()}},S=async()=>{for(const j of h)try{const I=(await me.getSidecar(j)).original_position,P=I&&I.split("/").slice(0,-1).join("/")||"/";await me.moveFile(j,P)}catch(M){console.error(`Failed to recover ${j}:`,M)}s(),x()},E=e.kind==="tree"?[{label:c?"Refreshing":"Refresh",disabled:c,onClick:b},{label:f==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!f||c,onClick:C("csv")},{label:f==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!f||c,onClick:C("json")}]:uj({selectedPaths:h,inTrash:l,exporting:f,onDownloadSelection:g,onMoveSelection:i,onMoveToTrash:y,onPermanentDelete:m,onRecover:S,onExportCsv:v("csv"),onExportJson:v("json")});return a.jsx(oj,{x:e.x,y:e.y,items:E})}function uj({selectedPaths:e,inTrash:t,exporting:n,onDownloadSelection:r,onMoveSelection:s,onMoveToTrash:i,onPermanentDelete:o,onRecover:l,onExportCsv:c,onExportJson:d}){const f=[];return e.length&&f.push({label:e.length>1?`Download (${e.length})`:"Download",onClick:r}),e.length&&f.push({label:"Move to",disabled:t,onClick:()=>{t||s(e)}}),f.push({label:"Move to trash",disabled:t,onClick:i}),t&&(f.push({label:"Permanent delete",danger:!0,onClick:o}),f.push({label:"Recover",onClick:l})),e.length&&(f.push({label:n==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!n,onClick:c}),f.push({label:n==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!n,onClick:d})),f}function Wl(e){const t=u.useRef(e);return t.current=e,t}function cj(e,t){return t?e.some(n=>{var s;const r=(s=n.metrics)==null?void 0:s[t];return r!=null&&!Number.isNaN(r)}):!1}function dj(e,t){const n={0:0,1:0,2:0,3:0,4:0,5:0};for(const r of e){const s=t[r.path]??r.star??0,i=String(s);n[i]=(n[i]||0)+1}return n}function fj(e,t=250){const n=new Set;let r=0;for(const s of e){const i=s.metrics;if(i)for(const o of Object.keys(i))n.add(o);if(r+=1,r>=t&&n.size>0)break}return Array.from(n).sort()}function hj(e,t,n,r){return e||t?n:r}function pj(e,t,n,r,s,i){return e?n:t||i==="/"?r:s}function mj(e){if(!e)return null;if(e.queryPath){const t=e.queryPath.split("/").filter(Boolean);return t.length?t[t.length-1]:e.queryPath}return e.queryVector?"Vector query":null}function gj(e,t,n,r){return e?t>0?`${n} of ${r}`:`${r}`:null}function vj(e){return!e.similarityActive&&!e.searching&&e.itemCount===0&&e.isLoading}const yj=(e,t)=>["search",e,t],xj=2e4,Hl="/";function wj(e){return e.trim().replace(/\s+/g," ")}function n0(e){const t=e.trim();return!t||t===Hl?Hl:t.startsWith(Hl)?t:`${Hl}${t}`}function vh(e,t){const n=wj(e);return n?{q:n,path:n0(t)}:null}function bj(e){return!Array.isArray(e)||e[0]!=="search"||typeof e[1]!="string"||typeof e[2]!="string"?null:vh(e[1],e[2])}function Sj(e,t){if(!t)return!1;const n=bj(e);return n?n.path===t.path:!1}function Cj(e,t){const n=vu(),r=vh(e,t),s=yj((r==null?void 0:r.q)??"",(r==null?void 0:r.path)??n0(t));return hu({enabled:r!==null,queryKey:s,queryFn:()=>r?me.search(r.q,r.path):Promise.resolve({items:[]}),staleTime:3e3,gcTime:6e4,placeholderData:(i,o)=>{if(Sj(o==null?void 0:o.queryKey,r))return i},retry:1,refetchInterval:n?xj:!1,refetchIntervalInBackground:n})}const kj=()=>["embeddings"];function Ej(){return hu({queryKey:kj(),queryFn:me.getEmbeddings,staleTime:6e4,gcTime:5*6e4,retry:1,refetchOnWindowFocus:!1})}function Nj(e,t=250){const[n,r]=Zr.useState(e);return Zr.useEffect(()=>{const s=window.setTimeout(()=>r(e),Math.max(0,t));return()=>window.clearTimeout(s)},[e,t]),n}function fg(e){return e.addedAt?Date.parse(e.addedAt):0}function Ga(e,t){return e.name.localeCompare(t.name)}function jj(e,t){const n=fg(e),r=fg(t);return n===r?Ga(e,t):n-r}function Mj(e){return(t,n)=>{var i,o;const r=(i=t.metrics)==null?void 0:i[e],s=(o=n.metrics)==null?void 0:o[e];return r==null&&s==null?Ga(t,n):r==null?1:s==null?-1:r===s?Ga(t,n):r-s}}function hg(e,t){return OE(e,t)}function Rj(e){let t=e>>>0;return()=>{t+=1831565813;let n=Math.imul(t^t>>>15,1|t);return n^=n+Math.imul(n^n>>>7,61|n),((n^n>>>14)>>>0)/4294967296}}function Pj(e,t){const n=Rj(t||1),r=[...e];for(let s=r.length-1;s>0;s-=1){const i=Math.floor(n()*(s+1));[r[s],r[i]]=[r[i],r[s]]}return r}function Tj(e,t,n){if(t.kind==="builtin"&&t.key==="random"){const i=n??Date.now();return Pj(e,i)}let r=jj;t.kind==="metric"?r=Mj(t.key):t.key==="name"&&(r=Ga);const s=[...e].sort(r);return t.dir==="desc"?s.reverse():s}function Ij(e,t){return e?t instanceof ln||t instanceof Error?t.message:"Failed to load embeddings.":null}function Lj({current:e,query:t,similarityState:n,scanStableMode:r=!1,viewState:s,randomSeed:i,localStarOverrides:o,sessionResetToken:l=0,onFolderHydratedSnapshot:c,getCachedHydratedSnapshot:d}){var _,Q;const f=wr(),{data:p,refetch:h,isLoading:w,isError:x}=rf(e,!0),[b,C]=u.useState(),v=u.useRef(0),g=u.useCallback(()=>h(),[h]),{data:y}=rf("/",!0,{enabled:!1});u.useEffect(()=>{f.removeQueries({predicate:({queryKey:V})=>pN(V,e,!0)})},[e,f]),u.useEffect(()=>{v.current+=1,yS({requestId:v.current});const V=(d==null?void 0:d(e))??null;C(V??void 0)},[e,d,l]),u.useEffect(()=>()=>{HS()},[e]),u.useEffect(()=>{if(!p)return;const V=v.current;u.startTransition(()=>{C(p),c==null||c(p.path,p)}),xS(V)},[c,p]);const m=n!==null,S=Nj(t,250),E=u.useMemo(()=>m?null:vh(S,e),[m,S,e]),j=E!==null,M=(E==null?void 0:E.q)??"",I=Cj((E==null?void 0:E.q)??"",(E==null?void 0:E.path)??e),P=Ej(),B=((_=P.data)==null?void 0:_.embeddings)??[],F=((Q=P.data)==null?void 0:Q.rejected)??[],K=B.length>0,Z=Ij(P.isError,P.error),z=u.useMemo(()=>{var ee;return(j?((ee=I.data)==null?void 0:ee.items)??[]:(b==null?void 0:b.items)??[]).map(ie=>({...ie,star:o[ie.path]!==void 0?o[ie.path]:ie.star}))},[j,I.data,b,o]),L=u.useMemo(()=>{var ie;const V=new Map;for(const q of z)V.set(q.path,q);const ee=((ie=I.data)==null?void 0:ie.items)??[];for(const q of ee){if(V.has(q.path))continue;const G=o[q.path]!==void 0?o[q.path]:q.star;V.set(q.path,{...q,star:G})}return V},[z,I.data,o]),R=u.useMemo(()=>n?n.items.map(V=>{const ee=L.get(V.path);return ee||dE(V.path,o[V.path])}):[],[n,L,o]),T=u.useMemo(()=>{if(n)return hg(R,s.filters);const V=hg(z,s.filters);return r?V:Tj(V,s.sort,i)},[n,R,z,r,s.filters,s.sort,i]),A=n?R.length:z.length,O=T.length,H=(b==null?void 0:b.totalItems)??(b==null?void 0:b.items.length)??A,U=e==="/"?H:(y==null?void 0:y.totalItems)??(y==null?void 0:y.items.length)??H;return{data:b,refetch:g,isLoading:w,isError:x,searching:j,normalizedQ:M,similarityActive:m,embeddings:B,embeddingsRejected:F,embeddingsAvailable:K,embeddingsLoading:P.isLoading,embeddingsError:Z,poolItems:z,similarityItems:R,items:T,totalCount:A,filteredCount:O,scopeTotal:H,rootTotal:U}}function _j({current:e,itemPaths:t,items:n,selectionPool:r,focusGridCell:s}){const[i,o]=u.useState([]),[l,c]=u.useState(null),[d,f]=u.useState(!1),[p,h]=u.useState(0),[w,x]=u.useState(0),b=u.useRef(!1),C=u.useRef(!1),v=u.useRef(null),g=u.useMemo(()=>new Set(i),[i]),y=u.useMemo(()=>{if(!i.length)return[];const G=new Map(r.map(ce=>[ce.path,ce])),X=new Map(n.map(ce=>[ce.path,ce]));return i.map(ce=>G.get(ce)??X.get(ce)).filter(ce=>!!ce)},[i,r,n]),m=u.useMemo(()=>n.filter(G=>g.has(G.path)),[n,g]),S=u.useMemo(()=>m.map(G=>G.path),[m]),E=Math.max(0,m.length-2),j=Math.min(p,E),M=m[j]??null,I=m[j+1]??null,P=j>0,B=j<m.length-2,F=m.length>=2,K=l!=null||d,Z=l??i[0]??null,z=Z?t.indexOf(Z):-1,L=z>0,R=z>=0&&z<t.length-1;u.useEffect(()=>{h(G=>G>E?E:G)},[E]);const T=u.useCallback(()=>{x(G=>G+1)},[]),A=u.useCallback(G=>{v.current=G},[]),O=u.useCallback(()=>{c(null),b.current=!1},[]),H=u.useCallback(G=>{if(G){c(G),o([G]);return}O()},[O]),U=u.useCallback(G=>{l&&(c(null),b.current=!1,Bl(G))},[l]),_=u.useCallback(G=>{c(G),b.current=!0,Ax(G)},[]),Q=u.useCallback(()=>{c(null),b.current?(b.current=!1,window.history.back()):Bl(e),s(v.current)},[e,s]),V=u.useCallback(()=>{d||!F||(i[0]&&(v.current=i[0]),h(0),f(!0),l&&(c(null),b.current&&(b.current=!1),Bl(e)),C.current||(window.history.pushState({compare:!0},"",window.location.href),C.current=!0))},[d,F,e,i,l]),ee=u.useCallback(()=>{f(!1),C.current&&(C.current=!1,window.history.back()),s(v.current??i[0])},[s,i]),ie=u.useCallback(G=>{m.length<2||h(X=>{const ce=Math.max(0,m.length-2);return Math.min(ce,Math.max(0,X+G))})},[m.length]),q=u.useCallback(G=>{if(!t.length)return;const X=l??i[0];if(!X)return;const ce=t.indexOf(X);if(ce===-1)return;const Ee=Math.min(t.length-1,Math.max(0,ce+G)),Se=t[Ee];!Se||Se===X||(l&&(c(Se),Bl(Se)),o([Se]))},[t,i,l]);return u.useEffect(()=>{d&&(F||ee())},[d,F,ee]),u.useEffect(()=>{const G=()=>{l&&(b.current=!1,c(null)),d&&(C.current=!1,f(!1))};return window.addEventListener("popstate",G),()=>window.removeEventListener("popstate",G)},[l,d]),{selectedPaths:i,setSelectedPaths:o,viewer:l,compareOpen:d,restoreGridToSelectionToken:w,bumpRestoreGridToSelectionToken:T,selectedItems:y,compareItems:m,comparePaths:S,compareIndexClamped:j,compareA:M,compareB:I,canComparePrev:P,canCompareNext:B,compareEnabled:F,canPrevImage:L,canNextImage:R,overlayActive:K,rememberFocusedPath:A,openViewer:_,closeViewer:Q,openCompare:V,closeCompare:ee,handleCompareNavigate:ie,handleNavigate:q,resetViewerState:O,clearViewerForSearch:U,syncHashImageSelection:H}}const Aj=2048,Fj=6,Oj=10;function r0(e){const t=new Map;for(const n of e)t.set(n.path,n.name);return t}function s0(e,t){return t.get(e)??e.split("/").pop()??e}function pg(e,t){const n=e.filter(r=>!t.has(r.path));return n.length===e.length?e:n}function mg(e,t,n,r,s){const i=e.filter(l=>l.path!==t);return[{path:t,ts:n,kind:r},...i].slice(0,s)}function Dj(e,t){if(!e.length)return null;const n=r0(t),r=new Set,s=[];for(const o of e)r.has(o.path)||(r.add(o.path),s.push(o.path));const i=s.slice(0,2).map(o=>s0(o,n));return{count:s.length,names:i,extra:Math.max(0,s.length-i.length)}}function zj(e,t,n,r){if(!e.length)return[];const s=r0(t);return e.map(i=>({path:i.path,label:s0(i.path,s),timeLabel:r(i.ts,n)}))}function $j(e){const[t,n]=u.useState([]),[r,s]=u.useState([]),[i,o]=u.useState(new Map),l=u.useRef(new Map),c=u.useRef(new Set),d=u.useRef(new Set),f=u.useRef(new Set);u.useEffect(()=>()=>{for(const C of l.current.values())window.clearTimeout(C);l.current.clear(),c.current.clear()},[]),u.useEffect(()=>{d.current=new Set(e),n(C=>pg(C,f.current))},[e]);const p=u.useCallback((C,v)=>{if(v!=null){if(c.current.has(v))return;if(c.current.add(v),c.current.size>Aj){const E=c.current.values().next().value;E!=null&&c.current.delete(E)}}const g=v!=null?`event:${v}`:`event:${C}:${Date.now()}`;o(E=>{if(E.get(C)===g)return E;const j=new Map(E);return j.set(C,g),j});const y=l.current,m=y.get(C);m!=null&&window.clearTimeout(m);const S=window.setTimeout(()=>{o(E=>{if(E.get(C)!==g)return E;const j=new Map(E);return j.delete(C),j}),y.delete(C)},JN);y.set(C,S)},[]),h=u.useCallback(C=>{f.current=C,n(v=>pg(v,C))},[]),w=u.useCallback((C,v,g)=>{const y=Date.now();d.current.has(C)&&f.current.has(C)||n(S=>mg(S,C,y,v,Fj)),p(C,g)},[p]),x=u.useCallback((C,v,g)=>{const y=Date.now(),m=Nx(g)??y;s(S=>mg(S,C,m,v,Oj))},[]),b=u.useCallback(()=>{n([])},[]);return{offViewActivity:t,recentTouches:r,highlightedPaths:i,onVisiblePathsChange:h,markRecentActivity:w,markRecentTouch:x,clearOffViewActivity:b}}function gg(e){if(typeof e!="number"||!Number.isFinite(e))return;const t=Math.trunc(e);return t<0?0:t}function Bj(e){if(typeof e!="string")return;const t=e.trim();return t.length?t:void 0}function Uj(e){if(!e)return null;const t=e.state;if(t!=="idle"&&t!=="running"&&t!=="ready"&&t!=="error")return null;let n=gg(e.done);const r=gg(e.total);return n!==void 0&&r!==void 0&&n>r&&(n=r),{state:t,scope:typeof e.scope=="string"?e.scope:void 0,done:n,total:r,generation:Bj(e.generation),started_at:typeof e.started_at=="string"?e.started_at:void 0,finished_at:typeof e.finished_at=="string"?e.finished_at:void 0,error:typeof e.error=="string"?e.error:void 0}}function Vj(e,t){return e===t?!0:!e||!t?!1:e.state===t.state&&e.scope===t.scope&&e.done===t.done&&e.total===t.total&&e.generation===t.generation&&e.started_at===t.started_at&&e.finished_at===t.finished_at&&e.error===t.error}function Wj(e){return(e==null?void 0:e.state)==="idle"||(e==null?void 0:e.state)==="running"}function Hj(e,t,n){return(e==null?void 0:e.state)==="running"?t:n}const i0=[1],Qj={supportedVersions:[...i0],maxPathsV2:null,supportsV2:!1};function Kj(e){if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.trunc(e);return t>0?t:null}function qj(e){if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.trunc(e);return t>=2?t:null}function Gj(e){let t=[...i0];const n=e==null?void 0:e.supported_versions;if(Array.isArray(n)){const i=Array.from(new Set(n.map(o=>Kj(o)).filter(o=>o!==null))).sort((o,l)=>o-l);i.length>0&&(t=i)}const r=qj(e==null?void 0:e.max_paths_v2),s=t.includes(2)&&r!==null&&r>2;return{supportedVersions:t,maxPathsV2:r,supportsV2:s}}function Yj(e,t){if(e===t)return!0;if(e.supportsV2!==t.supportsV2||e.maxPathsV2!==t.maxPathsV2||e.supportedVersions.length!==t.supportedVersions.length)return!1;for(let n=0;n<e.supportedVersions.length;n+=1)if(e.supportedVersions[n]!==t.supportedVersions[n])return!1;return!0}const Xj=1200,vg=3e3;function Jj(e){switch(e){case"live":return"Live";case"reconnecting":return"Reconnecting";case"offline":return"Offline";case"connecting":case"idle":default:return"Connecting"}}function yg(e){if(!(e instanceof ln))return null;const t=e.body;if(!t||typeof t!="object")return null;const n=t.error;return typeof n=="string"?n:null}function xg(e,t){return t-e<GN?Ik(e,t):Lk(e)}function Zj({current:e,currentGalleryId:t,itemPaths:n,items:r,queryClient:s,updateItemCaches:i,setLocalStarOverrides:o}){const l=u.useRef(_i()),c=u.useRef(null),d=u.useRef(null),f=u.useRef(null),p=u.useRef(!1),h=u.useRef(null),w=u.useRef("idle"),[x,b]=u.useState("idle"),[C,v]=u.useState({}),[g,y]=u.useState(null),[m,S]=u.useState(null),[E,j]=u.useState(!1),[M,I]=u.useState(()=>Date.now()),[P,B]=u.useState(!0),[F,K]=u.useState(null),[Z,z]=u.useState(Qj);u.useEffect(()=>{if(m==null){j(!1);return}j(!0);const oe=window.setTimeout(()=>j(!1),KN);return()=>window.clearTimeout(oe)},[m]),u.useEffect(()=>{if(g==null)return;I(Date.now());const oe=window.setInterval(()=>I(Date.now()),1e4);return()=>window.clearInterval(oe)},[g]);const{offViewActivity:L,recentTouches:R,highlightedPaths:T,onVisiblePathsChange:A,markRecentActivity:O,markRecentTouch:H,clearOffViewActivity:U}=$j(n),_=u.useCallback(oe=>{const re=Date.now(),Ie=Nx(oe)??re,ge=Ie>re?re:Ie;y(fe=>fe==null?ge:fe>ge?fe:ge),S(re),I(re)},[]),Q=u.useCallback(oe=>{oe.length&&v(re=>{let we=!1;const Ie={...re};for(const ge of oe){const fe=re[ge.gallery_id];fe&&fe.viewing===ge.viewing&&fe.editing===ge.editing||(Ie[ge.gallery_id]=ge,we=!0)}return we?Ie:re})},[]),V=u.useCallback(()=>{h.current!=null&&(window.clearTimeout(h.current),h.current=null)},[]),ee=u.useCallback(oe=>{oe&&v(re=>{if(!(oe in re))return re;const we={...re};return delete we[oe],we})},[]),ie=u.useCallback(oe=>{c.current=oe.lease_id,d.current=oe.gallery_id,Q([oe])},[Q]),q=u.useCallback(async(oe,re=!1)=>{const we=l.current,Ie=re?void 0:c.current??void 0,ge=fe=>me.joinPresence(oe,fe,we);try{ie(await ge(Ie));return}catch(fe){if(!re&&yg(fe)==="invalid_lease"){ie(await ge(void 0));return}throw fe}},[ie]),G=u.useCallback(async(oe,re)=>{if(oe===re){await q(re);return}const we=c.current;if(!we){await q(re,!0);return}try{const Ie=await me.movePresence(oe,re,we,l.current);d.current=Ie.to_scope.gallery_id,Q([Ie.from_scope,Ie.to_scope]);return}catch(Ie){const ge=yg(Ie);if(ge==="invalid_lease"){await q(re,!0);return}if(ge==="scope_mismatch"){await q(re);return}throw Ie}},[Q,q]),X=u.useCallback(async oe=>{const re=d.current;if(!re){await q(oe,!0);return}if(re===oe){await q(oe);return}await G(re,oe)},[q,G]),ce=u.useCallback(async()=>{if(p.current)return;const oe=f.current;if(oe){f.current=null,p.current=!0;try{await X(oe)}catch{}finally{p.current=!1;const re=f.current;re&&re!==d.current&&ce()}}},[X]),Ee=u.useCallback((oe,re=!1)=>{if(f.current=oe,V(),re||d.current==null){ce();return}h.current=window.setTimeout(()=>{h.current=null,ce()},XN)},[V,ce]),Se=u.useCallback(()=>{d.current=null,c.current=null,f.current=null,V()},[V]),he=u.useCallback(oe=>{const re=d.current,we=c.current;!re||!we||(KS(re,we,l.current),oe&&ee(re),Se())},[ee,Se]);u.useEffect(()=>{zS();const oe=BS(we=>{if(we.type==="presence"){const fe=we.data;if(!(fe!=null&&fe.gallery_id))return;Q([fe]);return}const Ie=we.data;if(!(Ie!=null&&Ie.path))return;const ge=Ie.path;if(we.type==="item-updated"){const fe=we.data,nt={v:1,tags:fe.tags??[],notes:fe.notes??"",star:fe.star??null,version:fe.version??1,updated_at:fe.updated_at??"",updated_by:fe.updated_by??"server"};s.setQueryData(Vo(ge),nt),i({path:ge,star:fe.star??null,metrics:fe.metrics,comments:fe.notes??""}),bk(ge,nt),O(ge,"item-updated",we.id),H(ge,"item-updated",fe.updated_at),_(fe.updated_at),o(Ke=>{if(Ke[ge]===void 0)return Ke;const bt={...Ke};return delete bt[ge],bt})}else if(we.type==="metrics-updated"){const fe=we.data;i({path:ge,metrics:fe.metrics}),O(ge,"metrics-updated",we.id),H(ge,"metrics-updated",fe.updated_at),_(fe.updated_at)}}),re=US(b);return()=>{oe(),re(),$S()}},[Q,O,H,s,o,i,_]),u.useEffect(()=>{const oe=d.current;oe!==t&&Ee(t,oe==null)},[t,Ee]),u.useEffect(()=>{const oe=window.setInterval(()=>{const re=d.current;re&&q(re)},YN);return()=>{window.clearInterval(oe)}},[q]),u.useEffect(()=>{const oe=w.current;if(w.current=x,x==="live"&&oe!=="live"){Ee(t,!0);return}(x==="reconnecting"||x==="offline")&&ee(d.current)},[ee,x,t,Ee]),u.useEffect(()=>{const oe=()=>he(!0),re=()=>he(!0),we=()=>{Ee(t,!0)};return window.addEventListener("pagehide",oe),window.addEventListener("beforeunload",re),window.addEventListener("pageshow",we),()=>{window.removeEventListener("pagehide",oe),window.removeEventListener("beforeunload",re),window.removeEventListener("pageshow",we),he(!1)}},[t,Ee,he]),u.useEffect(()=>{let oe=!1,re=null;const we=()=>{re!=null&&(window.clearTimeout(re),re=null)},Ie=fe=>{we(),re=window.setTimeout(()=>{ge()},fe)},ge=async()=>{var fe;try{const nt=await me.getHealth();if(oe)return;B(((fe=nt==null?void 0:nt.labels)==null?void 0:fe.enabled)??!0);const Ke=Uj(nt==null?void 0:nt.indexing);K(qe=>Vj(qe,Ke)?qe:Ke);const bt=Gj(nt==null?void 0:nt.compare_export);z(qe=>Yj(qe,bt)?qe:bt),Wj(Ke)&&Ie(Hj(Ke,Xj,vg))}catch{if(oe)return;Ie(vg)}};return ge(),()=>{oe=!0,we()}},[]);const Fe=C[e],Ze=(Fe==null?void 0:Fe.editing)??0,$t=g!=null,Bt=u.useMemo(()=>Jj(x),[x]),dn=u.useMemo(()=>!$t||g==null?"No edits yet.":xg(g,M),[$t,g,M]),Dn=u.useMemo(()=>Dj(L,r),[L,r]),en=u.useMemo(()=>zj(R,r,M,xg),[r,M,R]);return{connectionStatus:x,connectionLabel:Bt,presence:Fe,editingCount:Ze,recentEditActive:E,hasEdits:$t,lastEditedLabel:dn,persistenceEnabled:P,indexing:F,compareExportCapability:Z,highlightedPaths:T,onVisiblePathsChange:A,offViewSummary:Dn,recentTouchesDisplay:en,clearOffViewActivity:U}}const eM=600;function tM(e){if(!(e instanceof ln))return!1;if(e.status===403||e.status===405)return!0;const t=String(e.message||"").toLowerCase();return t.includes("read-only")||t.includes("no-write")||t.includes("write")}function io(e,t){return tM(e)?"This workspace is read-only. Upload and move actions are disabled.":e instanceof ln||e instanceof Error&&e.message?e.message:t}function Ic(e){return Array.from(new Set(e.filter(Boolean)))}function wg(e,t){return t.length?t.length===1?t[0]:`${e} failed for ${t.length} item(s). ${t[0]}`:""}async function nM(){const e=["/"],t=new Set,n=new Set(["/"]);for(;e.length>0&&t.size<eM;){const r=e.shift()??"/",s=Rt(r);if(t.has(s))continue;t.add(s);let i=null;try{i=await me.getFolder(s)}catch{i=null}if(i)for(const o of i.dirs??[]){const l=Rt(Fx(s,o.name));n.has(l)||(n.add(l),e.push(l))}}return Array.from(n).sort((r,s)=>r==="/"?-1:s==="/"?1:r.localeCompare(s))}function rM({appRef:e,uploadInputRef:t,current:n,currentDirCount:r,selectedPaths:s,setSelectedPaths:i,refetch:o,invalidateDerivedCounts:l}){const c=wr(),[d,f]=u.useState(!1),[p,h]=u.useState(null),[w,x]=u.useState(!1),[b,C]=u.useState(null),[v,g]=u.useState(["/"]),[y,m]=u.useState(!1),[S,E]=u.useState(null);u.useEffect(()=>{h(null)},[n]);const j=u.useCallback(L=>{const R=Ic(s);return R.includes(L)?R:[L]},[s]),M=u.useCallback((L,R)=>{const T=j(L);i(T),E({x:R.x,y:R.y,kind:"grid",payload:{paths:T}})},[j,i]),I=u.useCallback((L,R)=>{E({x:R.x,y:R.y,kind:"tree",payload:{path:L}})},[]);u.useEffect(()=>{if(!b)return;let L=!1;return m(!0),nM().then(R=>{L||g(R)}).catch(R=>{L||h(io(R,"Failed to load destination folders."))}).finally(()=>{L||m(!1)}),()=>{L=!0}},[b]);const P=u.useCallback(async(L,R)=>{const T=Ic(L);if(!T.length)return!1;const A=Rt(R||"/");h(null);const O=[],H=[];for(const _ of T)try{await me.moveFile(_,A)}catch(Q){O.push(`${ph(_)||_}: ${io(Q,"Move failed.")}`),H.push(_)}try{await c.invalidateQueries({predicate:({queryKey:_})=>Array.isArray(_)&&_[0]==="folder"}),l(),await o()}catch(_){O.push(io(_,"Move completed, but refresh failed."))}if(O.length)return h(wg("Move",O)),i(H),!1;C(null),E(null);const U=new Set(T);return i(_=>_.filter(Q=>!U.has(Q))),!0},[l,c,o,i]),B=u.useCallback(L=>{const R=Ic(L);R.length&&(h(null),C({paths:R}),E(null))},[]),F=u.useCallback(async L=>{if(!L.length)return;if(!(r===0)){h("Uploads are only allowed into folders without subdirectories.");return}f(!0),h(null);const T=[];try{for(const A of L)try{await me.uploadFile(n,A)}catch(O){T.push(`${A.name}: ${io(O,"Upload failed.")}`)}try{await o()}catch(A){T.push(io(A,"Upload completed, but refresh failed."))}}finally{f(!1)}if(T.length){h(wg("Upload",T));return}h(null)},[n,r,o]),K=u.useCallback(()=>{var L;d||(L=t.current)==null||L.click()},[t,d]),Z=u.useCallback(async L=>{const R=Array.from(L.target.files??[]);L.target.value="",R.length&&await F(R)},[F]);u.useEffect(()=>{const L=e.current;if(!L)return;const R=O=>{O.dataTransfer&&Array.from(O.dataTransfer.types).includes("Files")&&(O.preventDefault(),x(!0))},T=O=>{const H=O.relatedTarget;H&&L.contains(H)||x(!1)},A=async O=>{var U;O.preventDefault(),x(!1);const H=Array.from(((U=O.dataTransfer)==null?void 0:U.files)??[]);H.length&&await F(H)};return L.addEventListener("dragover",R),L.addEventListener("dragleave",T),L.addEventListener("drop",A),()=>{L.removeEventListener("dragover",R),L.removeEventListener("dragleave",T),L.removeEventListener("drop",A)}},[e,F]),u.useEffect(()=>{const L=()=>E(null),R=T=>{T.key==="Escape"&&E(null)};return window.addEventListener("click",L),window.addEventListener("keydown",R),()=>{window.removeEventListener("click",L),window.removeEventListener("keydown",R)}},[]);const z=u.useCallback(()=>{C(null)},[]);return{uploading:d,actionError:p,isDraggingOver:w,moveDialog:b,moveFolders:v,moveFoldersLoading:y,ctx:S,setCtx:E,closeMoveDialog:z,openUploadPicker:K,handleUploadInputChange:Z,openGridActions:M,openFolderActions:I,openMoveDialogForPaths:B,moveSelectedToFolder:P}}function Fn(e){const t=e.trim();return!t||t==="/"?"/":t.startsWith("/")?t:`/${t}`}function o0(e,t){const n=Fn(t),r=e[n];return r||{path:n,hydratedSnapshot:null,hydratedGeneratedAt:null,hydratedItemCount:0,hydratedAtMs:null,topAnchorPath:null}}function of(e,t){return t==="/"?!0:e===t||e.startsWith(`${t}/`)}function sM(e){for(const t of e)return t;return null}function iM(e,t,n,r){const s=o0(e,t),i={...s,path:Fn(t),hydratedSnapshot:n,hydratedGeneratedAt:n.generatedAt??null,hydratedItemCount:n.totalItems??n.items.length,hydratedAtMs:r};return s.hydratedSnapshot===i.hydratedSnapshot&&s.hydratedGeneratedAt===i.hydratedGeneratedAt&&s.hydratedItemCount===i.hydratedItemCount&&s.hydratedAtMs===i.hydratedAtMs?e:{...e,[i.path]:i}}function bg(e,t,n){const r=o0(e,t),s=Fn(t),i=n?Fn(n):null;return r.topAnchorPath===i&&r.path===s?e:{...e,[s]:{...r,path:s,topAnchorPath:i}}}function l0(e,t){const n=Fn(t);if(!e[n])return e;const r={...e};return delete r[n],r}function oM(e,t){const n=Fn(t);let r=!1;const s={...e};for(const i of Object.keys(s))of(i,n)&&(r=!0,delete s[i]);return r?s:e}function lM(e,t){const n=Fn(e),r=Fn(t);return!!(n===r||of(n,r)||of(r,n))}function aM(e,t,n){return lM(t,n)?e:l0(e,n)}function uM(){const e=u.useRef({}),t=u.useCallback(p=>e.current[Fn(p)]??null,[]),n=u.useCallback(p=>{var h;return((h=e.current[Fn(p)])==null?void 0:h.hydratedSnapshot)??null},[]),r=u.useCallback(p=>{var h;return((h=e.current[Fn(p)])==null?void 0:h.topAnchorPath)??null},[]),s=u.useCallback((p,h)=>{e.current=iM(e.current,p,h,Date.now())},[]),i=u.useCallback((p,h)=>{e.current=bg(e.current,p,h)},[]),o=u.useCallback((p,h)=>{const w=sM(h);w&&(e.current=bg(e.current,p,w))},[]),l=u.useCallback(p=>{e.current=l0(e.current,p)},[]),c=u.useCallback(p=>{e.current=oM(e.current,p)},[]),d=u.useCallback((p,h)=>{e.current=aM(e.current,p,h)},[]),f=u.useCallback(()=>{e.current={}},[]);return u.useMemo(()=>({getSession:t,getHydratedSnapshot:n,getTopAnchorPath:r,saveHydratedSnapshot:s,saveTopAnchorPath:i,saveTopAnchorFromVisiblePaths:o,invalidatePath:l,invalidateSubtree:c,invalidateForScopeTransition:d,clearAllSessions:f}),[t,n,r,s,i,o,l,c,d,f])}const cM={stars:{read:e=>{const t=e.stars||[];return t.length?{id:"stars",label:`Rating in: ${Mc(t)}`}:null},clear:(e,t)=>t.clearStars()},starsIn:{read:e=>{const t=e.starsIn.values||[];return t.length?{id:"stars-in",label:`Rating in: ${Mc(t)}`}:null},clear:(e,t)=>t.clearStars()},starsNotIn:{read:e=>{const t=e.starsNotIn.values||[];return t.length?{id:"stars-not-in",label:`Rating not in: ${Mc(t)}`}:null},clear:(e,t)=>t.clearStarsNotIn()},nameContains:{read:e=>{var n;const t=(n=e.nameContains.value)==null?void 0:n.trim();return t?{id:"name-contains",label:`Filename contains: ${t}`}:null},clear:(e,t)=>t.clearNameContains()},nameNotContains:{read:e=>{var n;const t=(n=e.nameNotContains.value)==null?void 0:n.trim();return t?{id:"name-not-contains",label:`Filename not: ${t}`}:null},clear:(e,t)=>t.clearNameNotContains()},commentsContains:{read:e=>{var n;const t=(n=e.commentsContains.value)==null?void 0:n.trim();return t?{id:"comments-contains",label:`Comments contain: ${t}`}:null},clear:(e,t)=>t.clearCommentsContains()},commentsNotContains:{read:e=>{var n;const t=(n=e.commentsNotContains.value)==null?void 0:n.trim();return t?{id:"comments-not-contains",label:`Comments not: ${t}`}:null},clear:(e,t)=>t.clearCommentsNotContains()},urlContains:{read:e=>{var n;const t=(n=e.urlContains.value)==null?void 0:n.trim();return t?{id:"url-contains",label:`URL contains: ${t}`}:null},clear:(e,t)=>t.clearUrlContains()},urlNotContains:{read:e=>{var n;const t=(n=e.urlNotContains.value)==null?void 0:n.trim();return t?{id:"url-not-contains",label:`URL not: ${t}`}:null},clear:(e,t)=>t.clearUrlNotContains()},dateRange:{read:e=>{const{from:t,to:n}=e.dateRange;return!t&&!n?null:{id:"date-range",label:`Date: ${oE(t,n)}`}},clear:(e,t)=>t.clearDateRange()},widthCompare:{read:e=>({id:"width-compare",label:`Width ${e.widthCompare.op} ${e.widthCompare.value}`}),clear:(e,t)=>t.clearWidthCompare()},heightCompare:{read:e=>({id:"height-compare",label:`Height ${e.heightCompare.op} ${e.heightCompare.value}`}),clear:(e,t)=>t.clearHeightCompare()},metricRange:{read:e=>({id:`metric:${e.metricRange.key}`,label:`${e.metricRange.key}: ${uE(e.metricRange.min,e.metricRange.max)}`}),clear:(e,t)=>t.clearMetricRange(e.metricRange.key)}};function dM(e,t){if("stars"in e)return t("stars",e);if("starsIn"in e)return t("starsIn",e);if("starsNotIn"in e)return t("starsNotIn",e);if("nameContains"in e)return t("nameContains",e);if("nameNotContains"in e)return t("nameNotContains",e);if("commentsContains"in e)return t("commentsContains",e);if("commentsNotContains"in e)return t("commentsNotContains",e);if("urlContains"in e)return t("urlContains",e);if("urlNotContains"in e)return t("urlNotContains",e);if("dateRange"in e)return t("dateRange",e);if("widthCompare"in e)return t("widthCompare",e);if("heightCompare"in e)return t("heightCompare",e);if("metricRange"in e)return t("metricRange",e)}function fM(e,t){const n=[];for(const r of e.and)dM(r,(s,i)=>{const o=cM[s],l=o.read(i);l&&n.push({id:l.id,label:l.label,onRemove:()=>o.clear(i,t)})});return n}function wu(e){if(typeof e!="string")return null;const t=e.trim();return t.length?t:null}function hM(e,t){const n=wu(t==null?void 0:t.generation);return n&&(e===null||(t==null?void 0:t.state)==="idle"||(t==null?void 0:t.state)==="running")?n:e}function pM(e,t){const r=wu(e==null?void 0:e.generation)??((e==null?void 0:e.state)==="ready"?t.scanGeneration:null),s=r!==null&&t.scanGeneration===r&&t.recentGeneration!==r,i=s&&(e==null?void 0:e.state)==="ready";return{scanStableActive:s,sortLocked:s,showSwitchToMostRecentBanner:i}}const et={sortKey:"sortKey",sortDir:"sortDir",sortSpec:"sortSpec",starFilters:"starFilters",filterAst:"filterAst",selectedMetric:"selectedMetric",viewMode:"viewMode",gridItemSize:"gridItemSize",leftOpen:"leftOpen",rightOpen:"rightOpen"},Ql={scanGeneration:"indexingScanGeneration",recentGeneration:"indexingMostRecentGeneration"};function Sg(e){if(typeof window>"u")return null;try{const t=window.localStorage.getItem(e);return wu(t)}catch{return null}}function Cg(e,t){if(!(typeof window>"u"))try{window.localStorage.setItem(e,t)}catch{}}function kg(e,t){for(const n of e)me.prefetchFile(n,t),me.prefetchThumb(n)}function mM(){var Lh;const[e,t]=u.useState("/"),[n,r]=u.useState(""),[s,i]=u.useState(!1),[o,l]=u.useState(null),[c,d]=u.useState(null),[f,p]=u.useState(100),[h,w]=u.useState(null),[x,b]=u.useState(()=>({filters:{and:[]},sort:{kind:"builtin",key:"added",dir:"desc"},selectedMetric:void 0})),[C,v]=u.useState(()=>Date.now()),[g,y]=u.useState("adaptive"),[m,S]=u.useState(220),[E,j]=u.useState(!1),[M,I]=u.useState(!0),[P,B]=u.useState(!0),[F,K]=u.useState(()=>typeof window>"u"?1440:window.innerWidth),Z=la(oa.narrow),[z,L]=u.useState("folders"),[R,T]=u.useState([]),[A,O]=u.useState(null),[H,U]=u.useState(0),[_,Q]=u.useState(()=>Sg(Ql.scanGeneration)),[V,ee]=u.useState(()=>Sg(Ql.recentGeneration)),[ie,q]=u.useState(!1),[G,X]=u.useState({}),ce=u.useRef(null),Ee=u.useRef(null),Se=u.useRef(null),he=u.useRef(null),Fe=u.useRef(null),Ze=u.useRef(null),$t=u.useRef(!1),{leftW:Bt,rightW:dn,onResizeLeft:Dn,onResizeRight:en}=uN(ce,z),{getHydratedSnapshot:oe,getTopAnchorPath:re,saveHydratedSnapshot:we,saveTopAnchorPath:Ie,invalidateSubtree:ge}=uM(),[fe,nt]=u.useState(0),[Ke,bt]=u.useState(0),qe=wr(),tn=gk(),br=vu(),kn=yk(),[zn,Ce]=u.useState(!1),{data:rt,refetch:fn,isLoading:$n,searching:Ut,normalizedQ:$i,similarityActive:D,embeddings:Y,embeddingsRejected:le,embeddingsAvailable:ve,embeddingsLoading:be,embeddingsError:Ne,poolItems:se,similarityItems:je,items:pe,totalCount:it,filteredCount:Oe,scopeTotal:mt,rootTotal:Vt}=Lj({current:e,query:n,similarityState:o,scanStableMode:ie,viewState:x,randomSeed:C,localStarOverrides:G,onFolderHydratedSnapshot:we,getCachedHydratedSnapshot:oe,sessionResetToken:Ke}),En=u.useMemo(()=>Rt(e||"/"),[e]),hn=u.useMemo(()=>Hm(x.filters),[x.filters]),Ge=u.useMemo(()=>pe.map(N=>N.path),[pe]),Bn=u.useCallback(N=>{if(!N)return;const $=document.getElementById(`cell-${encodeURIComponent(N)}`);$==null||$.focus()},[]),Bi=o?je:se,{selectedPaths:gt,setSelectedPaths:St,viewer:Ct,compareOpen:Wt,restoreGridToSelectionToken:Os,bumpRestoreGridToSelectionToken:Un,selectedItems:Zn,compareItems:sl,comparePaths:Ui,compareIndexClamped:Vn,compareA:er,compareB:il,canComparePrev:bu,canCompareNext:Su,compareEnabled:Cu,canPrevImage:Vi,canNextImage:is,overlayActive:ku,rememberFocusedPath:Eu,openViewer:Nu,closeViewer:ol,openCompare:Ds,closeCompare:Wi,handleCompareNavigate:ll,handleNavigate:Sr,resetViewerState:al,clearViewerForSearch:zs,syncHashImageSelection:ju}=_j({current:e,itemPaths:Ge,items:pe,selectionPool:Bi,focusGridCell:Bn}),ul=Wl(ju),cl=Wl(Un);u.useEffect(()=>{const N=ne=>{const de=Rt(ne),Le=LE(de)?de:null,kt=Le?Wm(de):de,Re=!$t.current;$t.current=!0,ul.current(Le),t(Pe=>{const dt=aE(Pe,kt,Le,Re);return Pe===dt?Pe:(cl.current(),dt)})};N(Vm());const $=()=>N(Vm());return window.addEventListener("hashchange",$),()=>window.removeEventListener("hashchange",$)},[cl,ul]);const Mu=Bi,$s=o?null:x.sort.kind==="metric"?x.sort.key:null,dl=u.useMemo(()=>cj(pe,$s),[pe,$s]),Ru=u.useCallback(N=>{const $=Object.prototype.hasOwnProperty.call(N,"star"),ne=N.metrics!==void 0,de=N.comments!==void 0;if(!$&&!ne&&!de)return;const Le=Re=>{if(Re.path!==N.path)return Re;let Pe=Re;return $&&Re.star!==N.star&&(Pe={...Pe,star:N.star??null}),ne&&(Pe={...Pe,metrics:N.metrics??void 0}),de&&Re.comments!==N.comments&&(Pe={...Pe,comments:N.comments??""}),Pe},kt=Re=>{if(!Re)return Re;let Pe=!1;const dt=Re.items.map(pn=>{const Us=Le(pn);return Us!==pn&&(Pe=!0),Us});return Pe?{...Re,items:dt}:Re};qe.setQueriesData({predicate:({queryKey:Re})=>Array.isArray(Re)&&Re[0]==="folder"},kt),qe.setQueriesData({predicate:({queryKey:Re})=>Array.isArray(Re)&&Re[0]==="search"},kt)},[qe]),{connectionStatus:Bs,connectionLabel:Pu,presence:Tu,editingCount:Iu,recentEditActive:Lu,hasEdits:_u,lastEditedLabel:Au,persistenceEnabled:fl,indexing:Ht,compareExportCapability:ae,highlightedPaths:xe,onVisiblePathsChange:Ye,offViewSummary:tr,recentTouchesDisplay:a0,clearOffViewActivity:u0}=Zj({current:e,currentGalleryId:En,itemPaths:Ge,items:pe,queryClient:qe,updateItemCaches:Ru,setLocalStarOverrides:X});u.useEffect(()=>{const N=hM(_,Ht);!N||N===_||(Q(N),Cg(Ql.scanGeneration,N))},[Ht,_]);const Hi=u.useMemo(()=>pM(Ht,{scanGeneration:_,recentGeneration:V}),[Ht,V,_]);u.useEffect(()=>{q(N=>N===Hi.scanStableActive?N:Hi.scanStableActive)},[Hi.scanStableActive]);const c0=u.useCallback(()=>{const N=wu(Ht==null?void 0:Ht.generation)??_;N&&(V!==N&&(ee(N),Cg(Ql.recentGeneration,N)),b($=>$.sort.kind==="builtin"&&$.sort.key==="added"&&$.sort.dir==="desc"?$:{...$,sort:{kind:"builtin",key:"added",dir:"desc"}}))},[Ht==null?void 0:Ht.generation,V,_]),d0=u.useCallback(N=>{N&&Ie(e,N)},[e,Ie]),f0=u.useMemo(()=>re(e),[e,re]);u.useEffect(()=>{nt(N=>N+1)},[e]);const Fu=u.useCallback(()=>{U(N=>N+1)},[]),yh=u.useCallback(N=>{const $=Rt(N||"/");return $===""?"/":$},[]),xh=u.useCallback(N=>{const $=ne=>N==="/"?!0:ne===N||ne.startsWith(`${N}/`);qe.invalidateQueries({predicate:({queryKey:ne})=>{if(!Array.isArray(ne)||ne[0]!=="folder")return!1;const de=typeof ne[1]=="string"?ne[1]:"";return $(de)}})},[qe]),Ou=u.useCallback(async N=>{const $=yh(N);await me.refreshFolder($),xh($),Fu(),ge($),(e===$||e.startsWith($==="/"?"/":`${$}/`))&&(bt(ne=>ne+1),await fn()),zd.evictPrefix($),Ks.evictPrefix($)},[e,Fu,ge,xh,yh,fn]),h0=u.useCallback(async()=>{try{await Ou(e)}catch(N){console.error("Failed to refresh folder:",N)}},[e,Ou]),p0=u.useMemo(()=>dj(o?je:se,G),[o,je,se,G]),Cr=u.useMemo(()=>fj(o?je:se),[o,je,se]);u.useEffect(()=>{D||Cr.length&&b(N=>{const $=N.selectedMetric&&Cr.includes(N.selectedMetric)?N.selectedMetric:Cr[0];return $===N.selectedMetric?N:{...N,selectedMetric:$}})},[Cr,D]),u.useEffect(()=>{D||x.sort.kind==="metric"&&(Cr.includes(x.sort.key)||b(N=>({...N,sort:{kind:"builtin",key:"added",dir:N.sort.dir}})))},[Cr,x.sort,D]);const hl=u.useMemo(()=>ZE(x.filters),[x.filters]),Du=D||Ut||hl>0,m0=tn.state==="syncing"?"Syncing":tn.state==="error"?tn.message?`Not saved  ${tn.message}`:"Not saved  retry":"All changes saved",g0=kn!=null&&kn>qN,v0=Bs==="offline"||Bs==="connecting"||Bs==="idle",y0=Bs==="reconnecting"||br||tn.state==="error"||g0,x0=QN({isOffline:v0,isUnstable:y0,recentEditActive:Lu,editingCount:Iu}),w0=hj(D,Du,Oe,mt),b0=pj(D,Du,it,mt,Vt,e),wh=u.useMemo(()=>mj(o),[o]),bh=u.useMemo(()=>gj(o!==null,hl,Oe,it),[o,hl,Oe,it]),S0=vj({similarityActive:D,searching:Ut,itemCount:pe.length,isLoading:$n}),Tt=u.useCallback(N=>{b($=>({...$,filters:N($.filters)}))},[]),C0=u.useCallback(N=>{b($=>({...$,filters:N}))},[]),zu=u.useCallback(()=>{Tt(N=>Rc(N,[]))},[Tt]),Sh=u.useCallback(()=>{b(N=>({...N,filters:{and:[]}}))},[]),$u=u.useCallback(()=>{l(null);const N=Ze.current;Ze.current=null,N&&N.length?(St(N),Un()):St([])},[Un,St]),k0=u.useCallback(()=>{o&&$u(),r(""),b(N=>({...N,filters:{and:[]}}))},[$u,o]),E0=u.useCallback(async N=>{!o&&Ze.current===null&&(Ze.current=gt);const $=await me.searchEmbeddings(N);if(l({embedding:$.embedding,queryPath:N.query_path??null,queryVector:N.query_vector_b64??null,topK:N.top_k??50,minScore:N.min_score??null,items:$.items,createdAt:Date.now()}),$.items.length){const ne=N.query_path&&$.items.some(de=>de.path===N.query_path)?N.query_path:$.items[0].path;St([ne]),Un()}else St([])},[Un,gt,St,o]),Bu=u.useCallback((N,$)=>{Tt(ne=>JE(ne,N,$))},[Tt]),Ch=u.useMemo(()=>fM(x.filters,{clearStars:zu,clearStarsNotIn:()=>Tt(N=>Dx(N,[])),clearNameContains:()=>Tt(N=>zx(N,"")),clearNameNotContains:()=>Tt(N=>$x(N,"")),clearCommentsContains:()=>Tt(N=>Bx(N,"")),clearCommentsNotContains:()=>Tt(N=>Ux(N,"")),clearUrlContains:()=>Tt(N=>Vx(N,"")),clearUrlNotContains:()=>Tt(N=>Wx(N,"")),clearDateRange:()=>Tt(N=>tf(N,null)),clearWidthCompare:()=>Tt(N=>da(N,null)),clearHeightCompare:()=>Tt(N=>fa(N,null)),clearMetricRange:N=>Bu(N,null)}),[x.filters,zu,Bu,Tt]),N0=u.useCallback(N=>{const $=new Set(hn);$.has(N)?$.delete(N):$.add(N),b(ne=>({...ne,filters:Rc(ne.filters,Array.from($))}))},[hn]),j0=u.useCallback(()=>{I(!0),L("metrics")},[]),M0=u.useCallback(N=>{b($=>({...$,sort:N})),N.kind==="builtin"&&N.key==="random"&&v(Date.now())},[]),kh=u.useCallback(N=>{if(N==="/"||N==="")return"Lenslet | Root";const $=N.split("/").filter(Boolean);if(!$.length)return"Lenslet";const ne=$.slice(-2).join("/");return`Lenslet | ${$.length>2?`.../${ne}`:`/${ne}`}`},[]),R0=u.useMemo(()=>lE(e),[e]);u.useEffect(()=>{document.title=kh(e)},[e,kh]),u.useEffect(()=>{let N=!0;return me.getViews().then($=>{N&&T($.views||[])}).catch(()=>{N&&T([])}),()=>{N=!1}},[]),u.useEffect(()=>{Ut&&(St([]),zs(e))},[zs,e,Ut,St]),u.useEffect(()=>{const N=ce.current,$=he.current;if(!N||!$)return;const ne=()=>{const Le=Math.max(48,Math.round($.getBoundingClientRect().height));N.style.setProperty("--toolbar-h",`${Le}px`)};ne();const de=window.ResizeObserver;if(de){const Le=new de(ne);return Le.observe($),()=>Le.disconnect()}return window.addEventListener("resize",ne),()=>window.removeEventListener("resize",ne)},[]),u.useEffect(()=>{try{const N=localStorage.getItem(et.sortKey),$=localStorage.getItem(et.sortDir),ne=localStorage.getItem(et.sortSpec),de=localStorage.getItem(et.starFilters),Le=localStorage.getItem(et.filterAst),kt=localStorage.getItem(et.selectedMetric),Re=localStorage.getItem(et.viewMode),Pe=localStorage.getItem(et.gridItemSize),dt=localStorage.getItem(et.leftOpen),pn=localStorage.getItem(et.rightOpen),_h=(Et=>{if(!Et)return null;const ot=jc(Et);return!ot||typeof ot!="object"?null:ot.kind==="builtin"&&(ot.key==="name"||ot.key==="added"||ot.key==="random")&&(ot.dir==="asc"||ot.dir==="desc")||ot.kind==="metric"&&typeof ot.key=="string"&&ot.key.length>0&&(ot.dir==="asc"||ot.dir==="desc")?ot:null})(ne)??{kind:"builtin",key:N==="name"||N==="added"||N==="random"?N:"added",dir:$==="asc"||$==="desc"?$:"desc"};_h.key==="random"&&v(Date.now());let Vu=(Et=>{if(!Et)return null;const ot=jc(Et);return ef(ot)})(Le)??{and:[]};if(de){const Et=jc(de);if(Array.isArray(Et)){const ot=Et.filter(V0=>[0,1,2,3,4,5].includes(V0));Vu=Rc(Vu,ot)}}if(b(Et=>({...Et,sort:_h,filters:Vu,selectedMetric:kt||Et.selectedMetric})),(Re==="grid"||Re==="adaptive")&&y(Re),Pe){const Et=Number(Pe);!isNaN(Et)&&Et>=80&&Et<=500&&S(Et)}(dt==="0"||dt==="false")&&I(!1),(pn==="0"||pn==="false")&&B(!1)}catch{}},[]),u.useEffect(()=>{Z&&(I(!1),B(!1))},[Z]),u.useEffect(()=>{if(typeof window>"u")return;const N=[1,1.25,1.5,1.75,2,3,4],$=Le=>N.reduce((kt,Re)=>Math.abs(Re-Le)<Math.abs(kt-Le)?Re:kt,N[0]),ne=()=>{var Us;const Le=window.devicePixelRatio||1,kt=$(Le),Re=((Us=window.visualViewport)==null?void 0:Us.scale)??1,Pe=Le*Re/kt;if(!Number.isFinite(Pe)){w(null);return}const dt=Math.round(Pe*100),pn=Math.min(500,Math.max(25,dt));w(pn)};ne(),window.addEventListener("resize",ne),window.addEventListener("orientationchange",ne);const de=window.visualViewport;return de&&de.addEventListener("resize",ne),()=>{window.removeEventListener("resize",ne),window.removeEventListener("orientationchange",ne),de&&de.removeEventListener("resize",ne)}},[]),u.useEffect(()=>{try{localStorage.setItem(et.sortKey,x.sort.kind==="builtin"?x.sort.key:"added"),localStorage.setItem(et.sortDir,x.sort.dir),localStorage.setItem(et.sortSpec,JSON.stringify(x.sort));const N=Hm(x.filters);localStorage.setItem(et.starFilters,JSON.stringify(N)),localStorage.setItem(et.filterAst,JSON.stringify(x.filters)),x.selectedMetric?localStorage.setItem(et.selectedMetric,x.selectedMetric):localStorage.removeItem(et.selectedMetric),localStorage.setItem(et.viewMode,g),localStorage.setItem(et.gridItemSize,String(m)),localStorage.setItem(et.leftOpen,M?"1":"0"),localStorage.setItem(et.rightOpen,P?"1":"0")}catch{}},[x,g,m,M,P]),u.useEffect(()=>{if(typeof window>"u")return;const N=()=>K(window.innerWidth);return N(),window.addEventListener("resize",N),window.addEventListener("orientationchange",N),()=>{window.removeEventListener("resize",N),window.removeEventListener("orientationchange",N)}},[]);const pl=F<=Xr.mobileMax,Eh=Wl(m);u.useEffect(()=>{pl||E&&j(!1)},[pl,E]),u.useEffect(()=>{const N=Ee.current;if(!N)return;const $=de=>Math.min(500,Math.max(80,de)),ne=de=>{de.ctrlKey&&(Ct||Wt||(de.preventDefault(),S(Le=>$(Le+(de.deltaY<0?20:-20)))))};return N.addEventListener("wheel",ne,{passive:!1}),()=>N.removeEventListener("wheel",ne)},[Ct,Wt]),u.useEffect(()=>{if(Ct||Wt)return;const N=Ee.current;if(!N)return;const $=Pe=>Math.min(500,Math.max(80,Pe));let ne=null;const de=Pe=>{if(Pe.length<2)return 0;const[dt,pn]=[Pe[0],Pe[1]];return Math.hypot(dt.clientX-pn.clientX,dt.clientY-pn.clientY)},Le=Pe=>{if(Pe.touches.length!==2)return;const dt=de(Pe.touches);dt&&(ne={dist:dt,size:Eh.current})},kt=Pe=>{if(!ne||Pe.touches.length!==2)return;const dt=de(Pe.touches);if(!dt)return;Pe.preventDefault();const pn=$(ne.size*(dt/ne.dist));S(pn)},Re=()=>{ne=null};return N.addEventListener("touchstart",Le,{passive:!0}),N.addEventListener("touchmove",kt,{passive:!1}),N.addEventListener("touchend",Re),N.addEventListener("touchcancel",Re),()=>{N.removeEventListener("touchstart",Le),N.removeEventListener("touchmove",kt),N.removeEventListener("touchend",Re),N.removeEventListener("touchcancel",Re)}},[Ct,Wt,Eh]),u.useEffect(()=>{kg(ej(Ge,Ct),"viewer")},[Ct,Ge]),u.useEffect(()=>{Wt&&kg(tj(Ui,Vn),"compare")},[Wt,Ui,Vn]);const Uu=u.useCallback(N=>{al();const $=Rt(N);t($),Ax($)},[al]),{uploading:P0,actionError:Nh,isDraggingOver:T0,moveDialog:jh,moveFolders:I0,moveFoldersLoading:L0,ctx:Mh,setCtx:_0,closeMoveDialog:A0,openUploadPicker:F0,handleUploadInputChange:O0,openGridActions:Rh,openFolderActions:Ph,openMoveDialogForPaths:D0,moveSelectedToFolder:z0}=rM({appRef:ce,uploadInputRef:Fe,current:e,currentDirCount:((Lh=rt==null?void 0:rt.dirs)==null?void 0:Lh.length)??0,selectedPaths:gt,setSelectedPaths:St,refetch:fn,invalidateDerivedCounts:Fu}),$0=u.useCallback(async()=>{const N=window.prompt("Save Smart Folder as:","New Smart Folder");if(!N)return;const $=sE(N,R),ne={id:$,name:N,pool:{kind:"folder",path:e},view:JSON.parse(JSON.stringify(x))},de=[...R.filter(Le=>Le.id!==$),ne];T(de),O($);try{await me.saveViews({version:1,views:de})}catch(Le){if(Le instanceof ln&&Le.status===403){const kt=new Blob([JSON.stringify({version:1,views:de},null,2)],{type:"application/json"});Co(kt,`lenslet-smart-folder-${$}.json`),alert("No-write mode: exported Smart Folder JSON instead of saving.");return}console.error("Failed to save Smart Folder:",Le)}},[e,x,R]);u.useEffect(()=>{if(!A)return;const N=R.find(de=>de.id===A);if(!N){O(null);return}const $=N.pool.path===e,ne=JSON.stringify(N.view)===JSON.stringify(x);(!$||!ne)&&O(null)},[A,R,e,x]);const Th=Wl({current:e,items:pe,selectedPaths:gt,viewer:Ct,compareOpen:Wt,mobileSelectMode:E,openFolder:Uu});u.useEffect(()=>{const N=$=>{const ne=Th.current;if(!ch($.target)){if(($.ctrlKey||$.metaKey)&&$.key.toLowerCase()==="b"){$.preventDefault(),$.altKey?B(de=>!de):I(de=>!de);return}if(!(ne.viewer||ne.compareOpen)){if($.key==="Backspace"||$.key==="Delete")$.preventDefault(),ne.openFolder(Wm(ne.current));else if(($.ctrlKey||$.metaKey)&&$.key.toLowerCase()==="a")$.preventDefault(),St(ne.items.map(de=>de.path));else if($.key==="Escape"){if(ne.selectedPaths.length){$.preventDefault(),St([]);return}ne.mobileSelectMode&&($.preventDefault(),j(!1))}else if($.key==="/"){$.preventDefault();const de=document.querySelector(".toolbar-right .input");de==null||de.focus()}}}};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[Th,St]);const Ih=u.useMemo(()=>cS({viewportWidth:F,leftOpen:M,rightOpen:P,leftWidth:Bt,rightWidth:dn}),[F,M,P,Bt,dn]),B0=M?`${Ih.leftWidth}px`:"0px",U0=P?`${Ih.rightWidth}px`:"0px";return a.jsxs("div",{className:"app-shell grid h-full grid-cols-[var(--left)_1fr_var(--right)]",ref:ce,style:{"--left":B0,"--right":U0},children:[a.jsx(hS,{rootRef:he,onSearch:r,viewerActive:!!Ct,onBack:ol,zoomPercent:Ct?f:void 0,onZoomPercentChange:N=>d(N),currentLabel:R0,itemCount:w0,totalCount:b0,sortSpec:x.sort,metricKeys:Cr,onSortChange:M0,sortDisabled:D||Hi.sortLocked,filterCount:hl,onOpenFilters:j0,starFilters:hn,onToggleStar:N0,onClearStars:zu,onClearFilters:Sh,starCounts:p0,viewMode:g,onViewMode:y,gridItemSize:m,onGridItemSize:S,leftOpen:M,rightOpen:P,onToggleLeft:()=>I(N=>!N),onToggleRight:()=>B(N=>!N),onPrevImage:()=>Sr(-1),onNextImage:()=>Sr(1),canPrevImage:Vi,canNextImage:is,searchDisabled:D,searchPlaceholder:D?"Exit similarity to search":void 0,onUploadClick:F0,uploadBusy:P0,uploadDisabled:Wt,multiSelectMode:E,selectedCount:gt.length,onToggleMultiSelectMode:pl?()=>j(N=>!N):void 0,syncIndicator:{state:x0,presence:Tu,syncLabel:m0,connectionLabel:Pu,lastEditedLabel:Au,hasEdits:_u,localTypingActive:zn,recentTouches:a0}}),a.jsx("input",{ref:Fe,type:"file",multiple:!0,accept:"image/*",className:"sr-only",onChange:O0}),M&&a.jsx(WN,{leftTool:z,onToolChange:L,compareEnabled:Cu,compareActive:Wt,onOpenCompare:Ds,views:R,activeViewId:A,onActivateView:N=>{var ne;O(N.id);const $=ef((ne=N.view)==null?void 0:ne.filters)??{and:[]};b({...N.view,filters:$}),Uu(N.pool.path)},onSaveView:$0,current:e,data:rt,onOpenFolder:N=>{O(null),Uu(N)},onOpenFolderActions:Ph,onPullRefreshFolders:h0,onContextMenu:(N,$)=>{N.preventDefault(),Ph($,{x:N.clientX,y:N.clientY})},countVersion:H,items:Mu,filteredItems:pe,metricKeys:Cr,selectedItems:Zn,selectedMetric:x.selectedMetric,onSelectMetric:N=>b($=>({...$,selectedMetric:N})),filters:x.filters,onChangeRange:Bu,onChangeFilters:C0,onResize:Dn}),a.jsxs("div",{className:"grid-shell col-start-2 row-start-2 relative overflow-hidden flex flex-col",ref:Ee,children:[a.jsx("div",{"aria-live":"polite",className:"sr-only",children:gt.length?`${gt.length} selected`:""}),a.jsx(HN,{persistenceEnabled:fl,indexing:Ht,showSwitchToMostRecentBanner:Hi.showSwitchToMostRecentBanner,onSwitchToMostRecent:c0,offViewSummary:tr,canRevealOffView:Du,onRevealOffView:k0,onClearOffView:u0,browserZoomPercent:h}),Nh&&a.jsx("div",{className:"border-b border-border bg-panel px-3 py-2",children:a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",children:Nh})}),o&&a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"font-semibold",children:"Similarity mode"}),a.jsxs("span",{className:"text-muted",children:["Embedding: ",o.embedding]}),wh&&a.jsxs("span",{className:"text-muted",children:["Query: ",wh]}),bh&&a.jsxs("span",{className:"text-muted",children:["Results: ",bh]}),a.jsxs("span",{className:"text-muted",children:["Top K: ",o.topK]}),o.minScore!=null&&a.jsxs("span",{className:"text-muted",children:["Min score: ",o.minScore]})]}),a.jsx("button",{className:"btn btn-sm",onClick:$u,children:"Exit similarity"})]})}),Ch.length>0&&a.jsx("div",{className:"sticky top-0 z-10 px-3 py-2 bg-panel border-b border-border",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Filters"}),Ch.map(N=>a.jsxs("span",{className:"filter-chip",children:[a.jsx("span",{className:"truncate max-w-[240px]",title:N.label,children:N.label}),a.jsx("button",{className:"filter-chip-remove","aria-label":`Clear filter ${N.label}`,onClick:N.onRemove,children:""})]},N.id)),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:Sh,children:"Clear all"})]})}),a.jsxs("div",{className:"flex-1 min-h-0 relative",children:[a.jsx(OC,{items:pe,selected:gt,restoreToSelectionToken:Os,restoreToTopAnchorToken:fe,restoreToTopAnchorPath:f0,multiSelectMode:pl&&E,onSelectionChange:St,onOpenViewer:N=>{Eu(N),Nu(N),St([N])},highlight:Ut?$i:"",recentlyUpdated:xe,onVisiblePathsChange:Ye,onTopAnchorPathChange:d0,suppressSelectionHighlight:ku,viewMode:g,targetCellSize:m,onContextMenuItem:(N,$)=>{N.preventDefault(),Rh($,{x:N.clientX,y:N.clientY})},onOpenItemActions:Rh,scrollRef:Se,hideScrollbar:dl,isLoading:S0}),dl&&$s&&a.jsx($C,{items:pe,metricKey:$s,scrollRef:Se,sortDir:x.sort.dir})]})]}),P&&a.jsx(RE,{path:gt[0]??null,selectedPaths:gt,items:pe,compareActive:Wt,compareA:er,compareB:il,onOpenCompare:Ds,sortSpec:x.sort,onResize:en,onStarChanged:(N,$)=>{X(ne=>{const de={...ne};for(const Le of N)de[Le]=$;return de})},onFindSimilar:()=>i(!0),embeddingsAvailable:ve,embeddingsLoading:be,compareExportSupportsV2:ae.supportsV2,compareExportMaxPathsV2:ae.maxPathsV2,onLocalTypingChange:Ce}),a.jsx(PE,{open:s,embeddings:Y,rejected:le,selectedPath:gt[0]??null,embeddingsLoading:be,embeddingsError:Ne,onClose:()=>i(!1),onSearch:E0}),Ct&&a.jsx(ek,{path:Ct,onClose:ol,onZoomChange:N=>p(Math.round(N)),requestedZoomPercent:c,onZoomRequestConsumed:()=>d(null),canPrev:Vi,canNext:is,onNavigate:Sr}),Wt&&a.jsx(lk,{aItem:er,bItem:il,index:Vn,total:sl.length,canPrev:bu,canNext:Su,onNavigate:ll,onClose:Wi}),jh&&a.jsx(nj,{paths:jh.paths,defaultDestination:e,destinations:I0,loadingDestinations:L0,onClose:A0,onSubmit:z0}),T0&&a.jsx("div",{className:"toolbar-offset fixed inset-0 left-[var(--left)] right-[var(--right)] bg-accent/10 border-2 border-dashed border-accent text-text flex items-center justify-center text-lg z-overlay pointer-events-none",children:"Drop images to upload"}),Mh&&a.jsx(aj,{ctx:Mh,current:e,items:pe,setCtx:_0,onRefetch:fn,onOpenMoveDialog:D0,onRefreshFolder:Ou})]})}const gM=new Bb({defaultOptions:{queries:{staleTime:1e4,gcTime:5*6e4,retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),1e4),refetchOnWindowFocus:!1,refetchOnReconnect:"always"},mutations:{retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),5e3)}}});function vM(){return a.jsx(Ub,{client:gM,children:a.jsx(mM,{})})}qy(document.getElementById("root")).render(a.jsx(vM,{}));
