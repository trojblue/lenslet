var K0=Object.defineProperty;var Fh=e=>{throw TypeError(e)};var q0=(e,t,n)=>t in e?K0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var lt=(e,t,n)=>q0(e,typeof t!="symbol"?t+"":t,n),Hu=(e,t,n)=>t.has(e)||Fh("Cannot "+n);var k=(e,t,n)=>(Hu(e,t,"read from private field"),n?n.call(e):t.get(e)),ae=(e,t,n)=>t.has(e)?Fh("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),J=(e,t,n,r)=>(Hu(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),ve=(e,t,n)=>(Hu(e,t,"access private method"),n);var yl=(e,t,n,r)=>({set _(s){J(e,t,s,n)},get _(){return k(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function G0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zg={exports:{}},Za={},$g={exports:{}},Se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var el=Symbol.for("react.element"),Y0=Symbol.for("react.portal"),X0=Symbol.for("react.fragment"),J0=Symbol.for("react.strict_mode"),Z0=Symbol.for("react.profiler"),ew=Symbol.for("react.provider"),tw=Symbol.for("react.context"),nw=Symbol.for("react.forward_ref"),rw=Symbol.for("react.suspense"),sw=Symbol.for("react.memo"),iw=Symbol.for("react.lazy"),Oh=Symbol.iterator;function ow(e){return e===null||typeof e!="object"?null:(e=Oh&&e[Oh]||e["@@iterator"],typeof e=="function"?e:null)}var Bg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ug=Object.assign,Vg={};function Ai(e,t,n){this.props=e,this.context=t,this.refs=Vg,this.updater=n||Bg}Ai.prototype.isReactComponent={};Ai.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ai.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Wg(){}Wg.prototype=Ai.prototype;function uf(e,t,n){this.props=e,this.context=t,this.refs=Vg,this.updater=n||Bg}var cf=uf.prototype=new Wg;cf.constructor=uf;Ug(cf,Ai.prototype);cf.isPureReactComponent=!0;var Dh=Array.isArray,Hg=Object.prototype.hasOwnProperty,df={current:null},Qg={key:!0,ref:!0,__self:!0,__source:!0};function Kg(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Hg.call(t,r)&&!Qg.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:el,type:e,key:i,ref:o,props:s,_owner:df.current}}function lw(e,t){return{$$typeof:el,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ff(e){return typeof e=="object"&&e!==null&&e.$$typeof===el}function aw(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var zh=/\/+/g;function Qu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?aw(""+e.key):t.toString(36)}function Gl(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case el:case Y0:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+Qu(o,0):r,Dh(s)?(n="",e!=null&&(n=e.replace(zh,"$&/")+"/"),Gl(s,t,n,"",function(d){return d})):s!=null&&(ff(s)&&(s=lw(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(zh,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",Dh(e))for(var l=0;l<e.length;l++){i=e[l];var c=r+Qu(i,l);o+=Gl(i,t,n,c,s)}else if(c=ow(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=r+Qu(i,l++),o+=Gl(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function vl(e,t,n){if(e==null)return e;var r=[],s=0;return Gl(e,r,"","",function(i){return t.call(n,i,s++)}),r}function uw(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Dt={current:null},Yl={transition:null},cw={ReactCurrentDispatcher:Dt,ReactCurrentBatchConfig:Yl,ReactCurrentOwner:df};function qg(){throw Error("act(...) is not supported in production builds of React.")}Se.Children={map:vl,forEach:function(e,t,n){vl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return vl(e,function(){t++}),t},toArray:function(e){return vl(e,function(t){return t})||[]},only:function(e){if(!ff(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Se.Component=Ai;Se.Fragment=X0;Se.Profiler=Z0;Se.PureComponent=uf;Se.StrictMode=J0;Se.Suspense=rw;Se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cw;Se.act=qg;Se.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Ug({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=df.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Hg.call(t,c)&&!Qg.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:el,type:e.type,key:s,ref:i,props:r,_owner:o}};Se.createContext=function(e){return e={$$typeof:tw,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ew,_context:e},e.Consumer=e};Se.createElement=Kg;Se.createFactory=function(e){var t=Kg.bind(null,e);return t.type=e,t};Se.createRef=function(){return{current:null}};Se.forwardRef=function(e){return{$$typeof:nw,render:e}};Se.isValidElement=ff;Se.lazy=function(e){return{$$typeof:iw,_payload:{_status:-1,_result:e},_init:uw}};Se.memo=function(e,t){return{$$typeof:sw,type:e,compare:t===void 0?null:t}};Se.startTransition=function(e){var t=Yl.transition;Yl.transition={};try{e()}finally{Yl.transition=t}};Se.unstable_act=qg;Se.useCallback=function(e,t){return Dt.current.useCallback(e,t)};Se.useContext=function(e){return Dt.current.useContext(e)};Se.useDebugValue=function(){};Se.useDeferredValue=function(e){return Dt.current.useDeferredValue(e)};Se.useEffect=function(e,t){return Dt.current.useEffect(e,t)};Se.useId=function(){return Dt.current.useId()};Se.useImperativeHandle=function(e,t,n){return Dt.current.useImperativeHandle(e,t,n)};Se.useInsertionEffect=function(e,t){return Dt.current.useInsertionEffect(e,t)};Se.useLayoutEffect=function(e,t){return Dt.current.useLayoutEffect(e,t)};Se.useMemo=function(e,t){return Dt.current.useMemo(e,t)};Se.useReducer=function(e,t,n){return Dt.current.useReducer(e,t,n)};Se.useRef=function(e){return Dt.current.useRef(e)};Se.useState=function(e){return Dt.current.useState(e)};Se.useSyncExternalStore=function(e,t,n){return Dt.current.useSyncExternalStore(e,t,n)};Se.useTransition=function(){return Dt.current.useTransition()};Se.version="18.3.1";$g.exports=Se;var u=$g.exports;const Yr=G0(u);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dw=u,fw=Symbol.for("react.element"),hw=Symbol.for("react.fragment"),pw=Object.prototype.hasOwnProperty,mw=dw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gw={key:!0,ref:!0,__self:!0,__source:!0};function Gg(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)pw.call(t,r)&&!gw.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:fw,type:e,key:i,ref:o,props:s,_owner:mw.current}}Za.Fragment=hw;Za.jsx=Gg;Za.jsxs=Gg;zg.exports=Za;var a=zg.exports,Yg={exports:{}},un={},Xg={exports:{}},Jg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(T,L){var O=T.length;T.push(L);e:for(;0<O;){var Q=O-1>>>1,V=T[Q];if(0<s(V,L))T[Q]=L,T[O]=V,O=Q;else break e}}function n(T){return T.length===0?null:T[0]}function r(T){if(T.length===0)return null;var L=T[0],O=T.pop();if(O!==L){T[0]=O;e:for(var Q=0,V=T.length,A=V>>>1;Q<A;){var K=2*(Q+1)-1,W=T[K],X=K+1,ne=T[X];if(0>s(W,O))X<V&&0>s(ne,W)?(T[Q]=ne,T[X]=O,Q=X):(T[Q]=W,T[K]=O,Q=K);else if(X<V&&0>s(ne,O))T[Q]=ne,T[X]=O,Q=X;else break e}}return L}function s(T,L){var O=T.sortIndex-L.sortIndex;return O!==0?O:T.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],f=1,p=null,h=3,w=!1,x=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(T){for(var L=n(d);L!==null;){if(L.callback===null)r(d);else if(L.startTime<=T)r(d),L.sortIndex=L.expirationTime,t(c,L);else break;L=n(d)}}function m(T){if(S=!1,v(T),!x)if(n(c)!==null)x=!0,I(b);else{var L=n(d);L!==null&&R(m,L.startTime-T)}}function b(T,L){x=!1,S&&(S=!1,y(M),M=-1),w=!0;var O=h;try{for(v(L),p=n(c);p!==null&&(!(p.expirationTime>L)||T&&!U());){var Q=p.callback;if(typeof Q=="function"){p.callback=null,h=p.priorityLevel;var V=Q(p.expirationTime<=L);L=e.unstable_now(),typeof V=="function"?p.callback=V:p===n(c)&&r(c),v(L)}else r(c);p=n(c)}if(p!==null)var A=!0;else{var K=n(d);K!==null&&R(m,K.startTime-L),A=!1}return A}finally{p=null,h=O,w=!1}}var E=!1,j=null,M=-1,_=5,P=-1;function U(){return!(e.unstable_now()-P<_)}function F(){if(j!==null){var T=e.unstable_now();P=T;var L=!0;try{L=j(!0,T)}finally{L?q():(E=!1,j=null)}}else E=!1}var q;if(typeof g=="function")q=function(){g(F)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,B=Z.port2;Z.port1.onmessage=F,q=function(){B.postMessage(null)}}else q=function(){C(F,0)};function I(T){j=T,E||(E=!0,q())}function R(T,L){M=C(function(){T(e.unstable_now())},L)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(T){T.callback=null},e.unstable_continueExecution=function(){x||w||(x=!0,I(b))},e.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<T?Math.floor(1e3/T):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(T){switch(h){case 1:case 2:case 3:var L=3;break;default:L=h}var O=h;h=L;try{return T()}finally{h=O}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(T,L){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var O=h;h=T;try{return L()}finally{h=O}},e.unstable_scheduleCallback=function(T,L,O){var Q=e.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?Q+O:Q):O=Q,T){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=O+V,T={id:f++,callback:L,priorityLevel:T,startTime:O,expirationTime:V,sortIndex:-1},O>Q?(T.sortIndex=O,t(d,T),n(c)===null&&T===n(d)&&(S?(y(M),M=-1):S=!0,R(m,O-Q))):(T.sortIndex=V,t(c,T),x||w||(x=!0,I(b))),T},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(T){var L=h;return function(){var O=h;h=L;try{return T.apply(this,arguments)}finally{h=O}}}})(Jg);Xg.exports=Jg;var yw=Xg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vw=u,an=yw;function H(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Zg=new Set,jo={};function Ls(e,t){ji(e,t),ji(e+"Capture",t)}function ji(e,t){for(jo[e]=t,e=0;e<t.length;e++)Zg.add(t[e])}var hr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lc=Object.prototype.hasOwnProperty,xw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$h={},Bh={};function ww(e){return Lc.call(Bh,e)?!0:Lc.call($h,e)?!1:xw.test(e)?Bh[e]=!0:($h[e]=!0,!1)}function Sw(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function bw(e,t,n,r){if(t===null||typeof t>"u"||Sw(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function zt(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){wt[e]=new zt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];wt[t]=new zt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){wt[e]=new zt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){wt[e]=new zt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){wt[e]=new zt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){wt[e]=new zt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){wt[e]=new zt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){wt[e]=new zt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){wt[e]=new zt(e,5,!1,e.toLowerCase(),null,!1,!1)});var hf=/[\-:]([a-z])/g;function pf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(hf,pf);wt[t]=new zt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(hf,pf);wt[t]=new zt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(hf,pf);wt[t]=new zt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){wt[e]=new zt(e,1,!1,e.toLowerCase(),null,!1,!1)});wt.xlinkHref=new zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){wt[e]=new zt(e,1,!1,e.toLowerCase(),null,!0,!0)});function mf(e,t,n,r){var s=wt.hasOwnProperty(t)?wt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(bw(t,n,s,r)&&(n=null),r||s===null?ww(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var yr=vw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xl=Symbol.for("react.element"),qs=Symbol.for("react.portal"),Gs=Symbol.for("react.fragment"),gf=Symbol.for("react.strict_mode"),Ac=Symbol.for("react.profiler"),ey=Symbol.for("react.provider"),ty=Symbol.for("react.context"),yf=Symbol.for("react.forward_ref"),Fc=Symbol.for("react.suspense"),Oc=Symbol.for("react.suspense_list"),vf=Symbol.for("react.memo"),Er=Symbol.for("react.lazy"),ny=Symbol.for("react.offscreen"),Uh=Symbol.iterator;function Ki(e){return e===null||typeof e!="object"?null:(e=Uh&&e[Uh]||e["@@iterator"],typeof e=="function"?e:null)}var Qe=Object.assign,Ku;function lo(e){if(Ku===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ku=t&&t[1]||""}return`
`+Ku+e}var qu=!1;function Gu(e,t){if(!e||qu)return"";qu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{qu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?lo(e):""}function Cw(e){switch(e.tag){case 5:return lo(e.type);case 16:return lo("Lazy");case 13:return lo("Suspense");case 19:return lo("SuspenseList");case 0:case 2:case 15:return e=Gu(e.type,!1),e;case 11:return e=Gu(e.type.render,!1),e;case 1:return e=Gu(e.type,!0),e;default:return""}}function Dc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Gs:return"Fragment";case qs:return"Portal";case Ac:return"Profiler";case gf:return"StrictMode";case Fc:return"Suspense";case Oc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ty:return(e.displayName||"Context")+".Consumer";case ey:return(e._context.displayName||"Context")+".Provider";case yf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case vf:return t=e.displayName||null,t!==null?t:Dc(e.type)||"Memo";case Er:t=e._payload,e=e._init;try{return Dc(e(t))}catch{}}return null}function kw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dc(t);case 8:return t===gf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Xr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ry(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ew(e){var t=ry(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function wl(e){e._valueTracker||(e._valueTracker=Ew(e))}function sy(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ry(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ga(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function zc(e,t){var n=t.checked;return Qe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Vh(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Xr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function iy(e,t){t=t.checked,t!=null&&mf(e,"checked",t,!1)}function $c(e,t){iy(e,t);var n=Xr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Bc(e,t.type,n):t.hasOwnProperty("defaultValue")&&Bc(e,t.type,Xr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Wh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Bc(e,t,n){(t!=="number"||ga(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ao=Array.isArray;function oi(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Xr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Uc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(H(91));return Qe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Hh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(H(92));if(ao(n)){if(1<n.length)throw Error(H(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Xr(n)}}function oy(e,t){var n=Xr(t.value),r=Xr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Qh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function ly(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?ly(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Sl,ay=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Sl=Sl||document.createElement("div"),Sl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Sl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Mo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var po={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nw=["Webkit","ms","Moz","O"];Object.keys(po).forEach(function(e){Nw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),po[t]=po[e]})});function uy(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||po.hasOwnProperty(e)&&po[e]?(""+t).trim():t+"px"}function cy(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=uy(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var jw=Qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wc(e,t){if(t){if(jw[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(H(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(H(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(H(61))}if(t.style!=null&&typeof t.style!="object")throw Error(H(62))}}function Hc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qc=null;function xf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Kc=null,li=null,ai=null;function Kh(e){if(e=rl(e)){if(typeof Kc!="function")throw Error(H(280));var t=e.stateNode;t&&(t=su(t),Kc(e.stateNode,e.type,t))}}function dy(e){li?ai?ai.push(e):ai=[e]:li=e}function fy(){if(li){var e=li,t=ai;if(ai=li=null,Kh(e),t)for(e=0;e<t.length;e++)Kh(t[e])}}function hy(e,t){return e(t)}function py(){}var Yu=!1;function my(e,t,n){if(Yu)return e(t,n);Yu=!0;try{return hy(e,t,n)}finally{Yu=!1,(li!==null||ai!==null)&&(py(),fy())}}function Po(e,t){var n=e.stateNode;if(n===null)return null;var r=su(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(H(231,t,typeof n));return n}var qc=!1;if(hr)try{var qi={};Object.defineProperty(qi,"passive",{get:function(){qc=!0}}),window.addEventListener("test",qi,qi),window.removeEventListener("test",qi,qi)}catch{qc=!1}function Mw(e,t,n,r,s,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(f){this.onError(f)}}var mo=!1,ya=null,va=!1,Gc=null,Pw={onError:function(e){mo=!0,ya=e}};function Rw(e,t,n,r,s,i,o,l,c){mo=!1,ya=null,Mw.apply(Pw,arguments)}function Tw(e,t,n,r,s,i,o,l,c){if(Rw.apply(this,arguments),mo){if(mo){var d=ya;mo=!1,ya=null}else throw Error(H(198));va||(va=!0,Gc=d)}}function As(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function gy(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function qh(e){if(As(e)!==e)throw Error(H(188))}function Iw(e){var t=e.alternate;if(!t){if(t=As(e),t===null)throw Error(H(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return qh(s),e;if(i===r)return qh(s),t;i=i.sibling}throw Error(H(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?e:t}function yy(e){return e=Iw(e),e!==null?vy(e):null}function vy(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=vy(e);if(t!==null)return t;e=e.sibling}return null}var xy=an.unstable_scheduleCallback,Gh=an.unstable_cancelCallback,_w=an.unstable_shouldYield,Lw=an.unstable_requestPaint,nt=an.unstable_now,Aw=an.unstable_getCurrentPriorityLevel,wf=an.unstable_ImmediatePriority,wy=an.unstable_UserBlockingPriority,xa=an.unstable_NormalPriority,Fw=an.unstable_LowPriority,Sy=an.unstable_IdlePriority,eu=null,Kn=null;function Ow(e){if(Kn&&typeof Kn.onCommitFiberRoot=="function")try{Kn.onCommitFiberRoot(eu,e,void 0,(e.current.flags&128)===128)}catch{}}var An=Math.clz32?Math.clz32:$w,Dw=Math.log,zw=Math.LN2;function $w(e){return e>>>=0,e===0?32:31-(Dw(e)/zw|0)|0}var bl=64,Cl=4194304;function uo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function wa(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=uo(l):(i&=o,i!==0&&(r=uo(i)))}else o=n&~s,o!==0?r=uo(o):i!==0&&(r=uo(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-An(t),s=1<<n,r|=e[n],t&=~s;return r}function Bw(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Uw(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-An(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=Bw(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Yc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function by(){var e=bl;return bl<<=1,!(bl&4194240)&&(bl=64),e}function Xu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function tl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-An(t),e[t]=n}function Vw(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-An(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Sf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-An(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Ae=0;function Cy(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ky,bf,Ey,Ny,jy,Xc=!1,kl=[],$r=null,Br=null,Ur=null,Ro=new Map,To=new Map,jr=[],Ww="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yh(e,t){switch(e){case"focusin":case"focusout":$r=null;break;case"dragenter":case"dragleave":Br=null;break;case"mouseover":case"mouseout":Ur=null;break;case"pointerover":case"pointerout":Ro.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":To.delete(t.pointerId)}}function Gi(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=rl(t),t!==null&&bf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Hw(e,t,n,r,s){switch(t){case"focusin":return $r=Gi($r,e,t,n,r,s),!0;case"dragenter":return Br=Gi(Br,e,t,n,r,s),!0;case"mouseover":return Ur=Gi(Ur,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return Ro.set(i,Gi(Ro.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,To.set(i,Gi(To.get(i)||null,e,t,n,r,s)),!0}return!1}function My(e){var t=as(e.target);if(t!==null){var n=As(t);if(n!==null){if(t=n.tag,t===13){if(t=gy(n),t!==null){e.blockedOn=t,jy(e.priority,function(){Ey(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Xl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Qc=r,n.target.dispatchEvent(r),Qc=null}else return t=rl(n),t!==null&&bf(t),e.blockedOn=n,!1;t.shift()}return!0}function Xh(e,t,n){Xl(e)&&n.delete(t)}function Qw(){Xc=!1,$r!==null&&Xl($r)&&($r=null),Br!==null&&Xl(Br)&&(Br=null),Ur!==null&&Xl(Ur)&&(Ur=null),Ro.forEach(Xh),To.forEach(Xh)}function Yi(e,t){e.blockedOn===t&&(e.blockedOn=null,Xc||(Xc=!0,an.unstable_scheduleCallback(an.unstable_NormalPriority,Qw)))}function Io(e){function t(s){return Yi(s,e)}if(0<kl.length){Yi(kl[0],e);for(var n=1;n<kl.length;n++){var r=kl[n];r.blockedOn===e&&(r.blockedOn=null)}}for($r!==null&&Yi($r,e),Br!==null&&Yi(Br,e),Ur!==null&&Yi(Ur,e),Ro.forEach(t),To.forEach(t),n=0;n<jr.length;n++)r=jr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<jr.length&&(n=jr[0],n.blockedOn===null);)My(n),n.blockedOn===null&&jr.shift()}var ui=yr.ReactCurrentBatchConfig,Sa=!0;function Kw(e,t,n,r){var s=Ae,i=ui.transition;ui.transition=null;try{Ae=1,Cf(e,t,n,r)}finally{Ae=s,ui.transition=i}}function qw(e,t,n,r){var s=Ae,i=ui.transition;ui.transition=null;try{Ae=4,Cf(e,t,n,r)}finally{Ae=s,ui.transition=i}}function Cf(e,t,n,r){if(Sa){var s=Jc(e,t,n,r);if(s===null)lc(e,t,r,ba,n),Yh(e,r);else if(Hw(s,e,t,n,r))r.stopPropagation();else if(Yh(e,r),t&4&&-1<Ww.indexOf(e)){for(;s!==null;){var i=rl(s);if(i!==null&&ky(i),i=Jc(e,t,n,r),i===null&&lc(e,t,r,ba,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else lc(e,t,r,null,n)}}var ba=null;function Jc(e,t,n,r){if(ba=null,e=xf(r),e=as(e),e!==null)if(t=As(e),t===null)e=null;else if(n=t.tag,n===13){if(e=gy(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ba=e,null}function Py(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Aw()){case wf:return 1;case wy:return 4;case xa:case Fw:return 16;case Sy:return 536870912;default:return 16}default:return 16}}var Dr=null,kf=null,Jl=null;function Ry(){if(Jl)return Jl;var e,t=kf,n=t.length,r,s="value"in Dr?Dr.value:Dr.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return Jl=s.slice(e,1<r?1-r:void 0)}function Zl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function El(){return!0}function Jh(){return!1}function cn(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?El:Jh,this.isPropagationStopped=Jh,this}return Qe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=El)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=El)},persist:function(){},isPersistent:El}),t}var Fi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ef=cn(Fi),nl=Qe({},Fi,{view:0,detail:0}),Gw=cn(nl),Ju,Zu,Xi,tu=Qe({},nl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xi&&(Xi&&e.type==="mousemove"?(Ju=e.screenX-Xi.screenX,Zu=e.screenY-Xi.screenY):Zu=Ju=0,Xi=e),Ju)},movementY:function(e){return"movementY"in e?e.movementY:Zu}}),Zh=cn(tu),Yw=Qe({},tu,{dataTransfer:0}),Xw=cn(Yw),Jw=Qe({},nl,{relatedTarget:0}),ec=cn(Jw),Zw=Qe({},Fi,{animationName:0,elapsedTime:0,pseudoElement:0}),e1=cn(Zw),t1=Qe({},Fi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),n1=cn(t1),r1=Qe({},Fi,{data:0}),ep=cn(r1),s1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},o1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function l1(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=o1[e])?!!t[e]:!1}function Nf(){return l1}var a1=Qe({},nl,{key:function(e){if(e.key){var t=s1[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Zl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?i1[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nf,charCode:function(e){return e.type==="keypress"?Zl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Zl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),u1=cn(a1),c1=Qe({},tu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tp=cn(c1),d1=Qe({},nl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nf}),f1=cn(d1),h1=Qe({},Fi,{propertyName:0,elapsedTime:0,pseudoElement:0}),p1=cn(h1),m1=Qe({},tu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),g1=cn(m1),y1=[9,13,27,32],jf=hr&&"CompositionEvent"in window,go=null;hr&&"documentMode"in document&&(go=document.documentMode);var v1=hr&&"TextEvent"in window&&!go,Ty=hr&&(!jf||go&&8<go&&11>=go),np=" ",rp=!1;function Iy(e,t){switch(e){case"keyup":return y1.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _y(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ys=!1;function x1(e,t){switch(e){case"compositionend":return _y(t);case"keypress":return t.which!==32?null:(rp=!0,np);case"textInput":return e=t.data,e===np&&rp?null:e;default:return null}}function w1(e,t){if(Ys)return e==="compositionend"||!jf&&Iy(e,t)?(e=Ry(),Jl=kf=Dr=null,Ys=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ty&&t.locale!=="ko"?null:t.data;default:return null}}var S1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!S1[e.type]:t==="textarea"}function Ly(e,t,n,r){dy(r),t=Ca(t,"onChange"),0<t.length&&(n=new Ef("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var yo=null,_o=null;function b1(e){Hy(e,0)}function nu(e){var t=Zs(e);if(sy(t))return e}function C1(e,t){if(e==="change")return t}var Ay=!1;if(hr){var tc;if(hr){var nc="oninput"in document;if(!nc){var ip=document.createElement("div");ip.setAttribute("oninput","return;"),nc=typeof ip.oninput=="function"}tc=nc}else tc=!1;Ay=tc&&(!document.documentMode||9<document.documentMode)}function op(){yo&&(yo.detachEvent("onpropertychange",Fy),_o=yo=null)}function Fy(e){if(e.propertyName==="value"&&nu(_o)){var t=[];Ly(t,_o,e,xf(e)),my(b1,t)}}function k1(e,t,n){e==="focusin"?(op(),yo=t,_o=n,yo.attachEvent("onpropertychange",Fy)):e==="focusout"&&op()}function E1(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return nu(_o)}function N1(e,t){if(e==="click")return nu(t)}function j1(e,t){if(e==="input"||e==="change")return nu(t)}function M1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Dn=typeof Object.is=="function"?Object.is:M1;function Lo(e,t){if(Dn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Lc.call(t,s)||!Dn(e[s],t[s]))return!1}return!0}function lp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ap(e,t){var n=lp(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=lp(n)}}function Oy(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Oy(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Dy(){for(var e=window,t=ga();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ga(e.document)}return t}function Mf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function P1(e){var t=Dy(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Oy(n.ownerDocument.documentElement,n)){if(r!==null&&Mf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=ap(n,i);var o=ap(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var R1=hr&&"documentMode"in document&&11>=document.documentMode,Xs=null,Zc=null,vo=null,ed=!1;function up(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ed||Xs==null||Xs!==ga(r)||(r=Xs,"selectionStart"in r&&Mf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),vo&&Lo(vo,r)||(vo=r,r=Ca(Zc,"onSelect"),0<r.length&&(t=new Ef("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Xs)))}function Nl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Js={animationend:Nl("Animation","AnimationEnd"),animationiteration:Nl("Animation","AnimationIteration"),animationstart:Nl("Animation","AnimationStart"),transitionend:Nl("Transition","TransitionEnd")},rc={},zy={};hr&&(zy=document.createElement("div").style,"AnimationEvent"in window||(delete Js.animationend.animation,delete Js.animationiteration.animation,delete Js.animationstart.animation),"TransitionEvent"in window||delete Js.transitionend.transition);function ru(e){if(rc[e])return rc[e];if(!Js[e])return e;var t=Js[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in zy)return rc[e]=t[n];return e}var $y=ru("animationend"),By=ru("animationiteration"),Uy=ru("animationstart"),Vy=ru("transitionend"),Wy=new Map,cp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zr(e,t){Wy.set(e,t),Ls(t,[e])}for(var sc=0;sc<cp.length;sc++){var ic=cp[sc],T1=ic.toLowerCase(),I1=ic[0].toUpperCase()+ic.slice(1);Zr(T1,"on"+I1)}Zr($y,"onAnimationEnd");Zr(By,"onAnimationIteration");Zr(Uy,"onAnimationStart");Zr("dblclick","onDoubleClick");Zr("focusin","onFocus");Zr("focusout","onBlur");Zr(Vy,"onTransitionEnd");ji("onMouseEnter",["mouseout","mouseover"]);ji("onMouseLeave",["mouseout","mouseover"]);ji("onPointerEnter",["pointerout","pointerover"]);ji("onPointerLeave",["pointerout","pointerover"]);Ls("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ls("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ls("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ls("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ls("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ls("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var co="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_1=new Set("cancel close invalid load scroll toggle".split(" ").concat(co));function dp(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Tw(r,t,void 0,e),e.currentTarget=null}function Hy(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;dp(s,l,d),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;dp(s,l,d),i=c}}}if(va)throw e=Gc,va=!1,Gc=null,e}function De(e,t){var n=t[id];n===void 0&&(n=t[id]=new Set);var r=e+"__bubble";n.has(r)||(Qy(t,e,2,!1),n.add(r))}function oc(e,t,n){var r=0;t&&(r|=4),Qy(n,e,r,t)}var jl="_reactListening"+Math.random().toString(36).slice(2);function Ao(e){if(!e[jl]){e[jl]=!0,Zg.forEach(function(n){n!=="selectionchange"&&(_1.has(n)||oc(n,!1,e),oc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[jl]||(t[jl]=!0,oc("selectionchange",!1,t))}}function Qy(e,t,n,r){switch(Py(t)){case 1:var s=Kw;break;case 4:s=qw;break;default:s=Cf}n=s.bind(null,t,n,e),s=void 0,!qc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function lc(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=as(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}my(function(){var d=i,f=xf(n),p=[];e:{var h=Wy.get(e);if(h!==void 0){var w=Ef,x=e;switch(e){case"keypress":if(Zl(n)===0)break e;case"keydown":case"keyup":w=u1;break;case"focusin":x="focus",w=ec;break;case"focusout":x="blur",w=ec;break;case"beforeblur":case"afterblur":w=ec;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Zh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=Xw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=f1;break;case $y:case By:case Uy:w=e1;break;case Vy:w=p1;break;case"scroll":w=Gw;break;case"wheel":w=g1;break;case"copy":case"cut":case"paste":w=n1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=tp}var S=(t&4)!==0,C=!S&&e==="scroll",y=S?h!==null?h+"Capture":null:h;S=[];for(var g=d,v;g!==null;){v=g;var m=v.stateNode;if(v.tag===5&&m!==null&&(v=m,y!==null&&(m=Po(g,y),m!=null&&S.push(Fo(g,m,v)))),C)break;g=g.return}0<S.length&&(h=new w(h,x,null,n,f),p.push({event:h,listeners:S}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",h&&n!==Qc&&(x=n.relatedTarget||n.fromElement)&&(as(x)||x[pr]))break e;if((w||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,w?(x=n.relatedTarget||n.toElement,w=d,x=x?as(x):null,x!==null&&(C=As(x),x!==C||x.tag!==5&&x.tag!==6)&&(x=null)):(w=null,x=d),w!==x)){if(S=Zh,m="onMouseLeave",y="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(S=tp,m="onPointerLeave",y="onPointerEnter",g="pointer"),C=w==null?h:Zs(w),v=x==null?h:Zs(x),h=new S(m,g+"leave",w,n,f),h.target=C,h.relatedTarget=v,m=null,as(f)===d&&(S=new S(y,g+"enter",x,n,f),S.target=v,S.relatedTarget=C,m=S),C=m,w&&x)t:{for(S=w,y=x,g=0,v=S;v;v=Vs(v))g++;for(v=0,m=y;m;m=Vs(m))v++;for(;0<g-v;)S=Vs(S),g--;for(;0<v-g;)y=Vs(y),v--;for(;g--;){if(S===y||y!==null&&S===y.alternate)break t;S=Vs(S),y=Vs(y)}S=null}else S=null;w!==null&&fp(p,h,w,S,!1),x!==null&&C!==null&&fp(p,C,x,S,!0)}}e:{if(h=d?Zs(d):window,w=h.nodeName&&h.nodeName.toLowerCase(),w==="select"||w==="input"&&h.type==="file")var b=C1;else if(sp(h))if(Ay)b=j1;else{b=E1;var E=k1}else(w=h.nodeName)&&w.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(b=N1);if(b&&(b=b(e,d))){Ly(p,b,n,f);break e}E&&E(e,h,d),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&Bc(h,"number",h.value)}switch(E=d?Zs(d):window,e){case"focusin":(sp(E)||E.contentEditable==="true")&&(Xs=E,Zc=d,vo=null);break;case"focusout":vo=Zc=Xs=null;break;case"mousedown":ed=!0;break;case"contextmenu":case"mouseup":case"dragend":ed=!1,up(p,n,f);break;case"selectionchange":if(R1)break;case"keydown":case"keyup":up(p,n,f)}var j;if(jf)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Ys?Iy(e,n)&&(M="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(Ty&&n.locale!=="ko"&&(Ys||M!=="onCompositionStart"?M==="onCompositionEnd"&&Ys&&(j=Ry()):(Dr=f,kf="value"in Dr?Dr.value:Dr.textContent,Ys=!0)),E=Ca(d,M),0<E.length&&(M=new ep(M,e,null,n,f),p.push({event:M,listeners:E}),j?M.data=j:(j=_y(n),j!==null&&(M.data=j)))),(j=v1?x1(e,n):w1(e,n))&&(d=Ca(d,"onBeforeInput"),0<d.length&&(f=new ep("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=j))}Hy(p,t)})}function Fo(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ca(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Po(e,n),i!=null&&r.unshift(Fo(e,i,s)),i=Po(e,t),i!=null&&r.push(Fo(e,i,s))),e=e.return}return r}function Vs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function fp(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,s?(c=Po(n,i),c!=null&&o.unshift(Fo(n,c,l))):s||(c=Po(n,i),c!=null&&o.push(Fo(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var L1=/\r\n?/g,A1=/\u0000|\uFFFD/g;function hp(e){return(typeof e=="string"?e:""+e).replace(L1,`
`).replace(A1,"")}function Ml(e,t,n){if(t=hp(t),hp(e)!==t&&n)throw Error(H(425))}function ka(){}var td=null,nd=null;function rd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var sd=typeof setTimeout=="function"?setTimeout:void 0,F1=typeof clearTimeout=="function"?clearTimeout:void 0,pp=typeof Promise=="function"?Promise:void 0,O1=typeof queueMicrotask=="function"?queueMicrotask:typeof pp<"u"?function(e){return pp.resolve(null).then(e).catch(D1)}:sd;function D1(e){setTimeout(function(){throw e})}function ac(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Io(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Io(t)}function Vr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function mp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Oi=Math.random().toString(36).slice(2),Qn="__reactFiber$"+Oi,Oo="__reactProps$"+Oi,pr="__reactContainer$"+Oi,id="__reactEvents$"+Oi,z1="__reactListeners$"+Oi,$1="__reactHandles$"+Oi;function as(e){var t=e[Qn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pr]||n[Qn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=mp(e);e!==null;){if(n=e[Qn])return n;e=mp(e)}return t}e=n,n=e.parentNode}return null}function rl(e){return e=e[Qn]||e[pr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Zs(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(H(33))}function su(e){return e[Oo]||null}var od=[],ei=-1;function es(e){return{current:e}}function ze(e){0>ei||(e.current=od[ei],od[ei]=null,ei--)}function Oe(e,t){ei++,od[ei]=e.current,e.current=t}var Jr={},Rt=es(Jr),Kt=es(!1),js=Jr;function Mi(e,t){var n=e.type.contextTypes;if(!n)return Jr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function qt(e){return e=e.childContextTypes,e!=null}function Ea(){ze(Kt),ze(Rt)}function gp(e,t,n){if(Rt.current!==Jr)throw Error(H(168));Oe(Rt,t),Oe(Kt,n)}function Ky(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(H(108,kw(e)||"Unknown",s));return Qe({},n,r)}function Na(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Jr,js=Rt.current,Oe(Rt,e),Oe(Kt,Kt.current),!0}function yp(e,t,n){var r=e.stateNode;if(!r)throw Error(H(169));n?(e=Ky(e,t,js),r.__reactInternalMemoizedMergedChildContext=e,ze(Kt),ze(Rt),Oe(Rt,e)):ze(Kt),Oe(Kt,n)}var rr=null,iu=!1,uc=!1;function qy(e){rr===null?rr=[e]:rr.push(e)}function B1(e){iu=!0,qy(e)}function ts(){if(!uc&&rr!==null){uc=!0;var e=0,t=Ae;try{var n=rr;for(Ae=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}rr=null,iu=!1}catch(s){throw rr!==null&&(rr=rr.slice(e+1)),xy(wf,ts),s}finally{Ae=t,uc=!1}}return null}var ti=[],ni=0,ja=null,Ma=0,gn=[],yn=0,Ms=null,ar=1,ur="";function is(e,t){ti[ni++]=Ma,ti[ni++]=ja,ja=e,Ma=t}function Gy(e,t,n){gn[yn++]=ar,gn[yn++]=ur,gn[yn++]=Ms,Ms=e;var r=ar;e=ur;var s=32-An(r)-1;r&=~(1<<s),n+=1;var i=32-An(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ar=1<<32-An(t)+s|n<<s|r,ur=i+e}else ar=1<<i|n<<s|r,ur=e}function Pf(e){e.return!==null&&(is(e,1),Gy(e,1,0))}function Rf(e){for(;e===ja;)ja=ti[--ni],ti[ni]=null,Ma=ti[--ni],ti[ni]=null;for(;e===Ms;)Ms=gn[--yn],gn[yn]=null,ur=gn[--yn],gn[yn]=null,ar=gn[--yn],gn[yn]=null}var on=null,sn=null,Be=!1,Ln=null;function Yy(e,t){var n=xn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function vp(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,on=e,sn=Vr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,on=e,sn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ms!==null?{id:ar,overflow:ur}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=xn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,on=e,sn=null,!0):!1;default:return!1}}function ld(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ad(e){if(Be){var t=sn;if(t){var n=t;if(!vp(e,t)){if(ld(e))throw Error(H(418));t=Vr(n.nextSibling);var r=on;t&&vp(e,t)?Yy(r,n):(e.flags=e.flags&-4097|2,Be=!1,on=e)}}else{if(ld(e))throw Error(H(418));e.flags=e.flags&-4097|2,Be=!1,on=e}}}function xp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;on=e}function Pl(e){if(e!==on)return!1;if(!Be)return xp(e),Be=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!rd(e.type,e.memoizedProps)),t&&(t=sn)){if(ld(e))throw Xy(),Error(H(418));for(;t;)Yy(e,t),t=Vr(t.nextSibling)}if(xp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(H(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){sn=Vr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}sn=null}}else sn=on?Vr(e.stateNode.nextSibling):null;return!0}function Xy(){for(var e=sn;e;)e=Vr(e.nextSibling)}function Pi(){sn=on=null,Be=!1}function Tf(e){Ln===null?Ln=[e]:Ln.push(e)}var U1=yr.ReactCurrentBatchConfig;function Ji(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,e))}return e}function Rl(e,t){throw e=Object.prototype.toString.call(t),Error(H(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function wp(e){var t=e._init;return t(e._payload)}function Jy(e){function t(y,g){if(e){var v=y.deletions;v===null?(y.deletions=[g],y.flags|=16):v.push(g)}}function n(y,g){if(!e)return null;for(;g!==null;)t(y,g),g=g.sibling;return null}function r(y,g){for(y=new Map;g!==null;)g.key!==null?y.set(g.key,g):y.set(g.index,g),g=g.sibling;return y}function s(y,g){return y=Kr(y,g),y.index=0,y.sibling=null,y}function i(y,g,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<g?(y.flags|=2,g):v):(y.flags|=2,g)):(y.flags|=1048576,g)}function o(y){return e&&y.alternate===null&&(y.flags|=2),y}function l(y,g,v,m){return g===null||g.tag!==6?(g=gc(v,y.mode,m),g.return=y,g):(g=s(g,v),g.return=y,g)}function c(y,g,v,m){var b=v.type;return b===Gs?f(y,g,v.props.children,m,v.key):g!==null&&(g.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Er&&wp(b)===g.type)?(m=s(g,v.props),m.ref=Ji(y,g,v),m.return=y,m):(m=oa(v.type,v.key,v.props,null,y.mode,m),m.ref=Ji(y,g,v),m.return=y,m)}function d(y,g,v,m){return g===null||g.tag!==4||g.stateNode.containerInfo!==v.containerInfo||g.stateNode.implementation!==v.implementation?(g=yc(v,y.mode,m),g.return=y,g):(g=s(g,v.children||[]),g.return=y,g)}function f(y,g,v,m,b){return g===null||g.tag!==7?(g=Ns(v,y.mode,m,b),g.return=y,g):(g=s(g,v),g.return=y,g)}function p(y,g,v){if(typeof g=="string"&&g!==""||typeof g=="number")return g=gc(""+g,y.mode,v),g.return=y,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case xl:return v=oa(g.type,g.key,g.props,null,y.mode,v),v.ref=Ji(y,null,g),v.return=y,v;case qs:return g=yc(g,y.mode,v),g.return=y,g;case Er:var m=g._init;return p(y,m(g._payload),v)}if(ao(g)||Ki(g))return g=Ns(g,y.mode,v,null),g.return=y,g;Rl(y,g)}return null}function h(y,g,v,m){var b=g!==null?g.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return b!==null?null:l(y,g,""+v,m);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case xl:return v.key===b?c(y,g,v,m):null;case qs:return v.key===b?d(y,g,v,m):null;case Er:return b=v._init,h(y,g,b(v._payload),m)}if(ao(v)||Ki(v))return b!==null?null:f(y,g,v,m,null);Rl(y,v)}return null}function w(y,g,v,m,b){if(typeof m=="string"&&m!==""||typeof m=="number")return y=y.get(v)||null,l(g,y,""+m,b);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case xl:return y=y.get(m.key===null?v:m.key)||null,c(g,y,m,b);case qs:return y=y.get(m.key===null?v:m.key)||null,d(g,y,m,b);case Er:var E=m._init;return w(y,g,v,E(m._payload),b)}if(ao(m)||Ki(m))return y=y.get(v)||null,f(g,y,m,b,null);Rl(g,m)}return null}function x(y,g,v,m){for(var b=null,E=null,j=g,M=g=0,_=null;j!==null&&M<v.length;M++){j.index>M?(_=j,j=null):_=j.sibling;var P=h(y,j,v[M],m);if(P===null){j===null&&(j=_);break}e&&j&&P.alternate===null&&t(y,j),g=i(P,g,M),E===null?b=P:E.sibling=P,E=P,j=_}if(M===v.length)return n(y,j),Be&&is(y,M),b;if(j===null){for(;M<v.length;M++)j=p(y,v[M],m),j!==null&&(g=i(j,g,M),E===null?b=j:E.sibling=j,E=j);return Be&&is(y,M),b}for(j=r(y,j);M<v.length;M++)_=w(j,y,M,v[M],m),_!==null&&(e&&_.alternate!==null&&j.delete(_.key===null?M:_.key),g=i(_,g,M),E===null?b=_:E.sibling=_,E=_);return e&&j.forEach(function(U){return t(y,U)}),Be&&is(y,M),b}function S(y,g,v,m){var b=Ki(v);if(typeof b!="function")throw Error(H(150));if(v=b.call(v),v==null)throw Error(H(151));for(var E=b=null,j=g,M=g=0,_=null,P=v.next();j!==null&&!P.done;M++,P=v.next()){j.index>M?(_=j,j=null):_=j.sibling;var U=h(y,j,P.value,m);if(U===null){j===null&&(j=_);break}e&&j&&U.alternate===null&&t(y,j),g=i(U,g,M),E===null?b=U:E.sibling=U,E=U,j=_}if(P.done)return n(y,j),Be&&is(y,M),b;if(j===null){for(;!P.done;M++,P=v.next())P=p(y,P.value,m),P!==null&&(g=i(P,g,M),E===null?b=P:E.sibling=P,E=P);return Be&&is(y,M),b}for(j=r(y,j);!P.done;M++,P=v.next())P=w(j,y,M,P.value,m),P!==null&&(e&&P.alternate!==null&&j.delete(P.key===null?M:P.key),g=i(P,g,M),E===null?b=P:E.sibling=P,E=P);return e&&j.forEach(function(F){return t(y,F)}),Be&&is(y,M),b}function C(y,g,v,m){if(typeof v=="object"&&v!==null&&v.type===Gs&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case xl:e:{for(var b=v.key,E=g;E!==null;){if(E.key===b){if(b=v.type,b===Gs){if(E.tag===7){n(y,E.sibling),g=s(E,v.props.children),g.return=y,y=g;break e}}else if(E.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Er&&wp(b)===E.type){n(y,E.sibling),g=s(E,v.props),g.ref=Ji(y,E,v),g.return=y,y=g;break e}n(y,E);break}else t(y,E);E=E.sibling}v.type===Gs?(g=Ns(v.props.children,y.mode,m,v.key),g.return=y,y=g):(m=oa(v.type,v.key,v.props,null,y.mode,m),m.ref=Ji(y,g,v),m.return=y,y=m)}return o(y);case qs:e:{for(E=v.key;g!==null;){if(g.key===E)if(g.tag===4&&g.stateNode.containerInfo===v.containerInfo&&g.stateNode.implementation===v.implementation){n(y,g.sibling),g=s(g,v.children||[]),g.return=y,y=g;break e}else{n(y,g);break}else t(y,g);g=g.sibling}g=yc(v,y.mode,m),g.return=y,y=g}return o(y);case Er:return E=v._init,C(y,g,E(v._payload),m)}if(ao(v))return x(y,g,v,m);if(Ki(v))return S(y,g,v,m);Rl(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,g!==null&&g.tag===6?(n(y,g.sibling),g=s(g,v),g.return=y,y=g):(n(y,g),g=gc(v,y.mode,m),g.return=y,y=g),o(y)):n(y,g)}return C}var Ri=Jy(!0),Zy=Jy(!1),Pa=es(null),Ra=null,ri=null,If=null;function _f(){If=ri=Ra=null}function Lf(e){var t=Pa.current;ze(Pa),e._currentValue=t}function ud(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ci(e,t){Ra=e,If=ri=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Qt=!0),e.firstContext=null)}function Sn(e){var t=e._currentValue;if(If!==e)if(e={context:e,memoizedValue:t,next:null},ri===null){if(Ra===null)throw Error(H(308));ri=e,Ra.dependencies={lanes:0,firstContext:e}}else ri=ri.next=e;return t}var us=null;function Af(e){us===null?us=[e]:us.push(e)}function ev(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Af(t)):(n.next=s.next,s.next=n),t.interleaved=n,mr(e,r)}function mr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Nr=!1;function Ff(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function cr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Wr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ie&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,mr(e,n)}return s=r.interleaved,s===null?(t.next=t,Af(r)):(t.next=s.next,s.next=t),r.interleaved=t,mr(e,n)}function ea(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Sf(e,n)}}function Sp(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ta(e,t,n,r){var s=e.updateQueue;Nr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=c))}if(i!==null){var p=s.baseState;o=0,f=d=c=null,l=i;do{var h=l.lane,w=l.eventTime;if((r&h)===h){f!==null&&(f=f.next={eventTime:w,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,S=l;switch(h=t,w=n,S.tag){case 1:if(x=S.payload,typeof x=="function"){p=x.call(w,p,h);break e}p=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=S.payload,h=typeof x=="function"?x.call(w,p,h):x,h==null)break e;p=Qe({},p,h);break e;case 2:Nr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else w={eventTime:w,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=w,c=p):f=f.next=w,o|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(f===null&&(c=p),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Rs|=o,e.lanes=o,e.memoizedState=p}}function bp(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(H(191,s));s.call(r)}}}var sl={},qn=es(sl),Do=es(sl),zo=es(sl);function cs(e){if(e===sl)throw Error(H(174));return e}function Of(e,t){switch(Oe(zo,t),Oe(Do,e),Oe(qn,sl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Vc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Vc(t,e)}ze(qn),Oe(qn,t)}function Ti(){ze(qn),ze(Do),ze(zo)}function nv(e){cs(zo.current);var t=cs(qn.current),n=Vc(t,e.type);t!==n&&(Oe(Do,e),Oe(qn,n))}function Df(e){Do.current===e&&(ze(qn),ze(Do))}var Ve=es(0);function Ia(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var cc=[];function zf(){for(var e=0;e<cc.length;e++)cc[e]._workInProgressVersionPrimary=null;cc.length=0}var ta=yr.ReactCurrentDispatcher,dc=yr.ReactCurrentBatchConfig,Ps=0,He=null,at=null,pt=null,_a=!1,xo=!1,$o=0,V1=0;function Nt(){throw Error(H(321))}function $f(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Dn(e[n],t[n]))return!1;return!0}function Bf(e,t,n,r,s,i){if(Ps=i,He=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ta.current=e===null||e.memoizedState===null?K1:q1,e=n(r,s),xo){i=0;do{if(xo=!1,$o=0,25<=i)throw Error(H(301));i+=1,pt=at=null,t.updateQueue=null,ta.current=G1,e=n(r,s)}while(xo)}if(ta.current=La,t=at!==null&&at.next!==null,Ps=0,pt=at=He=null,_a=!1,t)throw Error(H(300));return e}function Uf(){var e=$o!==0;return $o=0,e}function Un(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?He.memoizedState=pt=e:pt=pt.next=e,pt}function bn(){if(at===null){var e=He.alternate;e=e!==null?e.memoizedState:null}else e=at.next;var t=pt===null?He.memoizedState:pt.next;if(t!==null)pt=t,at=e;else{if(e===null)throw Error(H(310));at=e,e={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},pt===null?He.memoizedState=pt=e:pt=pt.next=e}return pt}function Bo(e,t){return typeof t=="function"?t(e):t}function fc(e){var t=bn(),n=t.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=e;var r=at,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,d=i;do{var f=d.lane;if((Ps&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,He.lanes|=f,Rs|=f}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=l,Dn(r,t.memoizedState)||(Qt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,He.lanes|=i,Rs|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function hc(e){var t=bn(),n=t.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);Dn(i,t.memoizedState)||(Qt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function rv(){}function sv(e,t){var n=He,r=bn(),s=t(),i=!Dn(r.memoizedState,s);if(i&&(r.memoizedState=s,Qt=!0),r=r.queue,Vf(lv.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||pt!==null&&pt.memoizedState.tag&1){if(n.flags|=2048,Uo(9,ov.bind(null,n,r,s,t),void 0,null),mt===null)throw Error(H(349));Ps&30||iv(n,t,s)}return s}function iv(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=He.updateQueue,t===null?(t={lastEffect:null,stores:null},He.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function ov(e,t,n,r){t.value=n,t.getSnapshot=r,av(t)&&uv(e)}function lv(e,t,n){return n(function(){av(t)&&uv(e)})}function av(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Dn(e,n)}catch{return!0}}function uv(e){var t=mr(e,1);t!==null&&Fn(t,e,1,-1)}function Cp(e){var t=Un();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bo,lastRenderedState:e},t.queue=e,e=e.dispatch=Q1.bind(null,He,e),[t.memoizedState,e]}function Uo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=He.updateQueue,t===null?(t={lastEffect:null,stores:null},He.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function cv(){return bn().memoizedState}function na(e,t,n,r){var s=Un();He.flags|=e,s.memoizedState=Uo(1|t,n,void 0,r===void 0?null:r)}function ou(e,t,n,r){var s=bn();r=r===void 0?null:r;var i=void 0;if(at!==null){var o=at.memoizedState;if(i=o.destroy,r!==null&&$f(r,o.deps)){s.memoizedState=Uo(t,n,i,r);return}}He.flags|=e,s.memoizedState=Uo(1|t,n,i,r)}function kp(e,t){return na(8390656,8,e,t)}function Vf(e,t){return ou(2048,8,e,t)}function dv(e,t){return ou(4,2,e,t)}function fv(e,t){return ou(4,4,e,t)}function hv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function pv(e,t,n){return n=n!=null?n.concat([e]):null,ou(4,4,hv.bind(null,t,e),n)}function Wf(){}function mv(e,t){var n=bn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&$f(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function gv(e,t){var n=bn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&$f(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function yv(e,t,n){return Ps&21?(Dn(n,t)||(n=by(),He.lanes|=n,Rs|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Qt=!0),e.memoizedState=n)}function W1(e,t){var n=Ae;Ae=n!==0&&4>n?n:4,e(!0);var r=dc.transition;dc.transition={};try{e(!1),t()}finally{Ae=n,dc.transition=r}}function vv(){return bn().memoizedState}function H1(e,t,n){var r=Qr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},xv(e))wv(t,n);else if(n=ev(e,t,n,r),n!==null){var s=Ot();Fn(n,e,r,s),Sv(n,t,r)}}function Q1(e,t,n){var r=Qr(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(xv(e))wv(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Dn(l,o)){var c=t.interleaved;c===null?(s.next=s,Af(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=ev(e,t,s,r),n!==null&&(s=Ot(),Fn(n,e,r,s),Sv(n,t,r))}}function xv(e){var t=e.alternate;return e===He||t!==null&&t===He}function wv(e,t){xo=_a=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Sv(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Sf(e,n)}}var La={readContext:Sn,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useInsertionEffect:Nt,useLayoutEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useMutableSource:Nt,useSyncExternalStore:Nt,useId:Nt,unstable_isNewReconciler:!1},K1={readContext:Sn,useCallback:function(e,t){return Un().memoizedState=[e,t===void 0?null:t],e},useContext:Sn,useEffect:kp,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,na(4194308,4,hv.bind(null,t,e),n)},useLayoutEffect:function(e,t){return na(4194308,4,e,t)},useInsertionEffect:function(e,t){return na(4,2,e,t)},useMemo:function(e,t){var n=Un();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Un();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=H1.bind(null,He,e),[r.memoizedState,e]},useRef:function(e){var t=Un();return e={current:e},t.memoizedState=e},useState:Cp,useDebugValue:Wf,useDeferredValue:function(e){return Un().memoizedState=e},useTransition:function(){var e=Cp(!1),t=e[0];return e=W1.bind(null,e[1]),Un().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=He,s=Un();if(Be){if(n===void 0)throw Error(H(407));n=n()}else{if(n=t(),mt===null)throw Error(H(349));Ps&30||iv(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,kp(lv.bind(null,r,i,e),[e]),r.flags|=2048,Uo(9,ov.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Un(),t=mt.identifierPrefix;if(Be){var n=ur,r=ar;n=(r&~(1<<32-An(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=$o++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=V1++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},q1={readContext:Sn,useCallback:mv,useContext:Sn,useEffect:Vf,useImperativeHandle:pv,useInsertionEffect:dv,useLayoutEffect:fv,useMemo:gv,useReducer:fc,useRef:cv,useState:function(){return fc(Bo)},useDebugValue:Wf,useDeferredValue:function(e){var t=bn();return yv(t,at.memoizedState,e)},useTransition:function(){var e=fc(Bo)[0],t=bn().memoizedState;return[e,t]},useMutableSource:rv,useSyncExternalStore:sv,useId:vv,unstable_isNewReconciler:!1},G1={readContext:Sn,useCallback:mv,useContext:Sn,useEffect:Vf,useImperativeHandle:pv,useInsertionEffect:dv,useLayoutEffect:fv,useMemo:gv,useReducer:hc,useRef:cv,useState:function(){return hc(Bo)},useDebugValue:Wf,useDeferredValue:function(e){var t=bn();return at===null?t.memoizedState=e:yv(t,at.memoizedState,e)},useTransition:function(){var e=hc(Bo)[0],t=bn().memoizedState;return[e,t]},useMutableSource:rv,useSyncExternalStore:sv,useId:vv,unstable_isNewReconciler:!1};function Pn(e,t){if(e&&e.defaultProps){t=Qe({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function cd(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Qe({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var lu={isMounted:function(e){return(e=e._reactInternals)?As(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ot(),s=Qr(e),i=cr(r,s);i.payload=t,n!=null&&(i.callback=n),t=Wr(e,i,s),t!==null&&(Fn(t,e,s,r),ea(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ot(),s=Qr(e),i=cr(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Wr(e,i,s),t!==null&&(Fn(t,e,s,r),ea(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ot(),r=Qr(e),s=cr(n,r);s.tag=2,t!=null&&(s.callback=t),t=Wr(e,s,r),t!==null&&(Fn(t,e,r,n),ea(t,e,r))}};function Ep(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!Lo(n,r)||!Lo(s,i):!0}function bv(e,t,n){var r=!1,s=Jr,i=t.contextType;return typeof i=="object"&&i!==null?i=Sn(i):(s=qt(t)?js:Rt.current,r=t.contextTypes,i=(r=r!=null)?Mi(e,s):Jr),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=lu,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Np(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&lu.enqueueReplaceState(t,t.state,null)}function dd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Ff(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Sn(i):(i=qt(t)?js:Rt.current,s.context=Mi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(cd(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&lu.enqueueReplaceState(s,s.state,null),Ta(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Ii(e,t){try{var n="",r=t;do n+=Cw(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function pc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function fd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Y1=typeof WeakMap=="function"?WeakMap:Map;function Cv(e,t,n){n=cr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Fa||(Fa=!0,bd=r),fd(e,t)},n}function kv(e,t,n){n=cr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){fd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){fd(e,t),typeof r!="function"&&(Hr===null?Hr=new Set([this]):Hr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function jp(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Y1;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=cS.bind(null,e,t,n),t.then(e,e))}function Mp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Pp(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=cr(-1,1),t.tag=2,Wr(n,t,1))),n.lanes|=1),e)}var X1=yr.ReactCurrentOwner,Qt=!1;function At(e,t,n,r){t.child=e===null?Zy(t,null,n,r):Ri(t,e.child,n,r)}function Rp(e,t,n,r,s){n=n.render;var i=t.ref;return ci(t,s),r=Bf(e,t,n,r,i,s),n=Uf(),e!==null&&!Qt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,gr(e,t,s)):(Be&&n&&Pf(t),t.flags|=1,At(e,t,r,s),t.child)}function Tp(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!Jf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,Ev(e,t,i,r,s)):(e=oa(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Lo,n(o,r)&&e.ref===t.ref)return gr(e,t,s)}return t.flags|=1,e=Kr(i,r),e.ref=t.ref,e.return=t,t.child=e}function Ev(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(Lo(i,r)&&e.ref===t.ref)if(Qt=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Qt=!0);else return t.lanes=e.lanes,gr(e,t,s)}return hd(e,t,n,r,s)}function Nv(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Oe(ii,rn),rn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Oe(ii,rn),rn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Oe(ii,rn),rn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Oe(ii,rn),rn|=r;return At(e,t,s,n),t.child}function jv(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function hd(e,t,n,r,s){var i=qt(n)?js:Rt.current;return i=Mi(t,i),ci(t,s),n=Bf(e,t,n,r,i,s),r=Uf(),e!==null&&!Qt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,gr(e,t,s)):(Be&&r&&Pf(t),t.flags|=1,At(e,t,n,s),t.child)}function Ip(e,t,n,r,s){if(qt(n)){var i=!0;Na(t)}else i=!1;if(ci(t,s),t.stateNode===null)ra(e,t),bv(t,n,r),dd(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Sn(d):(d=qt(n)?js:Rt.current,d=Mi(t,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&Np(t,o,r,d),Nr=!1;var h=t.memoizedState;o.state=h,Ta(t,r,o,s),c=t.memoizedState,l!==r||h!==c||Kt.current||Nr?(typeof f=="function"&&(cd(t,n,f,r),c=t.memoizedState),(l=Nr||Ep(t,n,l,r,h,c,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,tv(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Pn(t.type,l),o.props=d,p=t.pendingProps,h=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Sn(c):(c=qt(n)?js:Rt.current,c=Mi(t,c));var w=n.getDerivedStateFromProps;(f=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||h!==c)&&Np(t,o,r,c),Nr=!1,h=t.memoizedState,o.state=h,Ta(t,r,o,s);var x=t.memoizedState;l!==p||h!==x||Kt.current||Nr?(typeof w=="function"&&(cd(t,n,w,r),x=t.memoizedState),(d=Nr||Ep(t,n,d,r,h,x,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=x),o.props=r,o.state=x,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return pd(e,t,n,r,i,s)}function pd(e,t,n,r,s,i){jv(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&yp(t,n,!1),gr(e,t,i);r=t.stateNode,X1.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Ri(t,e.child,null,i),t.child=Ri(t,null,l,i)):At(e,t,l,i),t.memoizedState=r.state,s&&yp(t,n,!0),t.child}function Mv(e){var t=e.stateNode;t.pendingContext?gp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&gp(e,t.context,!1),Of(e,t.containerInfo)}function _p(e,t,n,r,s){return Pi(),Tf(s),t.flags|=256,At(e,t,n,r),t.child}var md={dehydrated:null,treeContext:null,retryLane:0};function gd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Pv(e,t,n){var r=t.pendingProps,s=Ve.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Oe(Ve,s&1),e===null)return ad(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=cu(o,r,0,null),e=Ns(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=gd(n),t.memoizedState=md,e):Hf(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return J1(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Kr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Kr(l,i):(i=Ns(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?gd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=md,r}return i=e.child,e=i.sibling,r=Kr(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Hf(e,t){return t=cu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Tl(e,t,n,r){return r!==null&&Tf(r),Ri(t,e.child,null,n),e=Hf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function J1(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=pc(Error(H(422))),Tl(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=cu({mode:"visible",children:r.children},s,0,null),i=Ns(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Ri(t,e.child,null,o),t.child.memoizedState=gd(o),t.memoizedState=md,i);if(!(t.mode&1))return Tl(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(H(419)),r=pc(i,r,void 0),Tl(e,t,o,r)}if(l=(o&e.childLanes)!==0,Qt||l){if(r=mt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,mr(e,s),Fn(r,e,s,-1))}return Xf(),r=pc(Error(H(421))),Tl(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=dS.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,sn=Vr(s.nextSibling),on=t,Be=!0,Ln=null,e!==null&&(gn[yn++]=ar,gn[yn++]=ur,gn[yn++]=Ms,ar=e.id,ur=e.overflow,Ms=t),t=Hf(t,r.children),t.flags|=4096,t)}function Lp(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ud(e.return,t,n)}function mc(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Rv(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(At(e,t,r.children,n),r=Ve.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Lp(e,n,t);else if(e.tag===19)Lp(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Oe(Ve,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Ia(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),mc(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Ia(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}mc(t,!0,n,null,i);break;case"together":mc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ra(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function gr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Rs|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(H(153));if(t.child!==null){for(e=t.child,n=Kr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Kr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Z1(e,t,n){switch(t.tag){case 3:Mv(t),Pi();break;case 5:nv(t);break;case 1:qt(t.type)&&Na(t);break;case 4:Of(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Oe(Pa,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Oe(Ve,Ve.current&1),t.flags|=128,null):n&t.child.childLanes?Pv(e,t,n):(Oe(Ve,Ve.current&1),e=gr(e,t,n),e!==null?e.sibling:null);Oe(Ve,Ve.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Rv(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Oe(Ve,Ve.current),r)break;return null;case 22:case 23:return t.lanes=0,Nv(e,t,n)}return gr(e,t,n)}var Tv,yd,Iv,_v;Tv=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};yd=function(){};Iv=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,cs(qn.current);var i=null;switch(n){case"input":s=zc(e,s),r=zc(e,r),i=[];break;case"select":s=Qe({},s,{value:void 0}),r=Qe({},r,{value:void 0}),i=[];break;case"textarea":s=Uc(e,s),r=Uc(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ka)}Wc(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(jo.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(jo.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&De("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};_v=function(e,t,n,r){n!==r&&(t.flags|=4)};function Zi(e,t){if(!Be)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function eS(e,t,n){var r=t.pendingProps;switch(Rf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(t),null;case 1:return qt(t.type)&&Ea(),jt(t),null;case 3:return r=t.stateNode,Ti(),ze(Kt),ze(Rt),zf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Pl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ln!==null&&(Ed(Ln),Ln=null))),yd(e,t),jt(t),null;case 5:Df(t);var s=cs(zo.current);if(n=t.type,e!==null&&t.stateNode!=null)Iv(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(H(166));return jt(t),null}if(e=cs(qn.current),Pl(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Qn]=t,r[Oo]=i,e=(t.mode&1)!==0,n){case"dialog":De("cancel",r),De("close",r);break;case"iframe":case"object":case"embed":De("load",r);break;case"video":case"audio":for(s=0;s<co.length;s++)De(co[s],r);break;case"source":De("error",r);break;case"img":case"image":case"link":De("error",r),De("load",r);break;case"details":De("toggle",r);break;case"input":Vh(r,i),De("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},De("invalid",r);break;case"textarea":Hh(r,i),De("invalid",r)}Wc(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ml(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ml(r.textContent,l,e),s=["children",""+l]):jo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&De("scroll",r)}switch(n){case"input":wl(r),Wh(r,i,!0);break;case"textarea":wl(r),Qh(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ka)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=ly(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Qn]=t,e[Oo]=r,Tv(e,t,!1,!1),t.stateNode=e;e:{switch(o=Hc(n,r),n){case"dialog":De("cancel",e),De("close",e),s=r;break;case"iframe":case"object":case"embed":De("load",e),s=r;break;case"video":case"audio":for(s=0;s<co.length;s++)De(co[s],e);s=r;break;case"source":De("error",e),s=r;break;case"img":case"image":case"link":De("error",e),De("load",e),s=r;break;case"details":De("toggle",e),s=r;break;case"input":Vh(e,r),s=zc(e,r),De("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Qe({},r,{value:void 0}),De("invalid",e);break;case"textarea":Hh(e,r),s=Uc(e,r),De("invalid",e);break;default:s=r}Wc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?cy(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ay(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Mo(e,c):typeof c=="number"&&Mo(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(jo.hasOwnProperty(i)?c!=null&&i==="onScroll"&&De("scroll",e):c!=null&&mf(e,i,c,o))}switch(n){case"input":wl(e),Wh(e,r,!1);break;case"textarea":wl(e),Qh(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Xr(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?oi(e,!!r.multiple,i,!1):r.defaultValue!=null&&oi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=ka)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return jt(t),null;case 6:if(e&&t.stateNode!=null)_v(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(H(166));if(n=cs(zo.current),cs(qn.current),Pl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Qn]=t,(i=r.nodeValue!==n)&&(e=on,e!==null))switch(e.tag){case 3:Ml(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ml(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Qn]=t,t.stateNode=r}return jt(t),null;case 13:if(ze(Ve),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Be&&sn!==null&&t.mode&1&&!(t.flags&128))Xy(),Pi(),t.flags|=98560,i=!1;else if(i=Pl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(H(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[Qn]=t}else Pi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;jt(t),i=!1}else Ln!==null&&(Ed(Ln),Ln=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ve.current&1?ct===0&&(ct=3):Xf())),t.updateQueue!==null&&(t.flags|=4),jt(t),null);case 4:return Ti(),yd(e,t),e===null&&Ao(t.stateNode.containerInfo),jt(t),null;case 10:return Lf(t.type._context),jt(t),null;case 17:return qt(t.type)&&Ea(),jt(t),null;case 19:if(ze(Ve),i=t.memoizedState,i===null)return jt(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)Zi(i,!1);else{if(ct!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Ia(e),o!==null){for(t.flags|=128,Zi(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Oe(Ve,Ve.current&1|2),t.child}e=e.sibling}i.tail!==null&&nt()>_i&&(t.flags|=128,r=!0,Zi(i,!1),t.lanes=4194304)}else{if(!r)if(e=Ia(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Zi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Be)return jt(t),null}else 2*nt()-i.renderingStartTime>_i&&n!==1073741824&&(t.flags|=128,r=!0,Zi(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=nt(),t.sibling=null,n=Ve.current,Oe(Ve,r?n&1|2:n&1),t):(jt(t),null);case 22:case 23:return Yf(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?rn&1073741824&&(jt(t),t.subtreeFlags&6&&(t.flags|=8192)):jt(t),null;case 24:return null;case 25:return null}throw Error(H(156,t.tag))}function tS(e,t){switch(Rf(t),t.tag){case 1:return qt(t.type)&&Ea(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ti(),ze(Kt),ze(Rt),zf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Df(t),null;case 13:if(ze(Ve),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(H(340));Pi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ze(Ve),null;case 4:return Ti(),null;case 10:return Lf(t.type._context),null;case 22:case 23:return Yf(),null;case 24:return null;default:return null}}var Il=!1,Mt=!1,nS=typeof WeakSet=="function"?WeakSet:Set,ee=null;function si(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xe(e,t,r)}else n.current=null}function vd(e,t,n){try{n()}catch(r){Xe(e,t,r)}}var Ap=!1;function rS(e,t){if(td=Sa,e=Dy(),Mf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,f=0,p=e,h=null;t:for(;;){for(var w;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(w=p.firstChild)!==null;)h=p,p=w;for(;;){if(p===e)break t;if(h===n&&++d===s&&(l=o),h===i&&++f===r&&(c=o),(w=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=w}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nd={focusedElem:e,selectionRange:n},Sa=!1,ee=t;ee!==null;)if(t=ee,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ee=e;else for(;ee!==null;){t=ee;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var S=x.memoizedProps,C=x.memoizedState,y=t.stateNode,g=y.getSnapshotBeforeUpdate(t.elementType===t.type?S:Pn(t.type,S),C);y.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(m){Xe(t,t.return,m)}if(e=t.sibling,e!==null){e.return=t.return,ee=e;break}ee=t.return}return x=Ap,Ap=!1,x}function wo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&vd(t,n,i)}s=s.next}while(s!==r)}}function au(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function xd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Lv(e){var t=e.alternate;t!==null&&(e.alternate=null,Lv(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Qn],delete t[Oo],delete t[id],delete t[z1],delete t[$1])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Av(e){return e.tag===5||e.tag===3||e.tag===4}function Fp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Av(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ka));else if(r!==4&&(e=e.child,e!==null))for(wd(e,t,n),e=e.sibling;e!==null;)wd(e,t,n),e=e.sibling}function Sd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Sd(e,t,n),e=e.sibling;e!==null;)Sd(e,t,n),e=e.sibling}var vt=null,_n=!1;function br(e,t,n){for(n=n.child;n!==null;)Fv(e,t,n),n=n.sibling}function Fv(e,t,n){if(Kn&&typeof Kn.onCommitFiberUnmount=="function")try{Kn.onCommitFiberUnmount(eu,n)}catch{}switch(n.tag){case 5:Mt||si(n,t);case 6:var r=vt,s=_n;vt=null,br(e,t,n),vt=r,_n=s,vt!==null&&(_n?(e=vt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):vt.removeChild(n.stateNode));break;case 18:vt!==null&&(_n?(e=vt,n=n.stateNode,e.nodeType===8?ac(e.parentNode,n):e.nodeType===1&&ac(e,n),Io(e)):ac(vt,n.stateNode));break;case 4:r=vt,s=_n,vt=n.stateNode.containerInfo,_n=!0,br(e,t,n),vt=r,_n=s;break;case 0:case 11:case 14:case 15:if(!Mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&vd(n,t,o),s=s.next}while(s!==r)}br(e,t,n);break;case 1:if(!Mt&&(si(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Xe(n,t,l)}br(e,t,n);break;case 21:br(e,t,n);break;case 22:n.mode&1?(Mt=(r=Mt)||n.memoizedState!==null,br(e,t,n),Mt=r):br(e,t,n);break;default:br(e,t,n)}}function Op(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new nS),t.forEach(function(r){var s=fS.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function jn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:vt=l.stateNode,_n=!1;break e;case 3:vt=l.stateNode.containerInfo,_n=!0;break e;case 4:vt=l.stateNode.containerInfo,_n=!0;break e}l=l.return}if(vt===null)throw Error(H(160));Fv(i,o,s),vt=null,_n=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Xe(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ov(t,e),t=t.sibling}function Ov(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(jn(t,e),Bn(e),r&4){try{wo(3,e,e.return),au(3,e)}catch(S){Xe(e,e.return,S)}try{wo(5,e,e.return)}catch(S){Xe(e,e.return,S)}}break;case 1:jn(t,e),Bn(e),r&512&&n!==null&&si(n,n.return);break;case 5:if(jn(t,e),Bn(e),r&512&&n!==null&&si(n,n.return),e.flags&32){var s=e.stateNode;try{Mo(s,"")}catch(S){Xe(e,e.return,S)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&iy(s,i),Hc(l,o);var d=Hc(l,i);for(o=0;o<c.length;o+=2){var f=c[o],p=c[o+1];f==="style"?cy(s,p):f==="dangerouslySetInnerHTML"?ay(s,p):f==="children"?Mo(s,p):mf(s,f,p,d)}switch(l){case"input":$c(s,i);break;case"textarea":oy(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?oi(s,!!i.multiple,w,!1):h!==!!i.multiple&&(i.defaultValue!=null?oi(s,!!i.multiple,i.defaultValue,!0):oi(s,!!i.multiple,i.multiple?[]:"",!1))}s[Oo]=i}catch(S){Xe(e,e.return,S)}}break;case 6:if(jn(t,e),Bn(e),r&4){if(e.stateNode===null)throw Error(H(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(S){Xe(e,e.return,S)}}break;case 3:if(jn(t,e),Bn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Io(t.containerInfo)}catch(S){Xe(e,e.return,S)}break;case 4:jn(t,e),Bn(e);break;case 13:jn(t,e),Bn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(qf=nt())),r&4&&Op(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(Mt=(d=Mt)||f,jn(t,e),Mt=d):jn(t,e),Bn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!f&&e.mode&1)for(ee=e,f=e.child;f!==null;){for(p=ee=f;ee!==null;){switch(h=ee,w=h.child,h.tag){case 0:case 11:case 14:case 15:wo(4,h,h.return);break;case 1:si(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(S){Xe(r,n,S)}}break;case 5:si(h,h.return);break;case 22:if(h.memoizedState!==null){zp(p);continue}}w!==null?(w.return=h,ee=w):zp(p)}f=f.sibling}e:for(f=null,p=e;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=uy("display",o))}catch(S){Xe(e,e.return,S)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(S){Xe(e,e.return,S)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:jn(t,e),Bn(e),r&4&&Op(e);break;case 21:break;default:jn(t,e),Bn(e)}}function Bn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Av(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Mo(s,""),r.flags&=-33);var i=Fp(e);Sd(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Fp(e);wd(e,l,o);break;default:throw Error(H(161))}}catch(c){Xe(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function sS(e,t,n){ee=e,Dv(e)}function Dv(e,t,n){for(var r=(e.mode&1)!==0;ee!==null;){var s=ee,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Il;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Mt;l=Il;var d=Mt;if(Il=o,(Mt=c)&&!d)for(ee=s;ee!==null;)o=ee,c=o.child,o.tag===22&&o.memoizedState!==null?$p(s):c!==null?(c.return=o,ee=c):$p(s);for(;i!==null;)ee=i,Dv(i),i=i.sibling;ee=s,Il=l,Mt=d}Dp(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ee=i):Dp(e)}}function Dp(e){for(;ee!==null;){var t=ee;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Mt||au(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Mt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Pn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&bp(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}bp(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&Io(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}Mt||t.flags&512&&xd(t)}catch(h){Xe(t,t.return,h)}}if(t===e){ee=null;break}if(n=t.sibling,n!==null){n.return=t.return,ee=n;break}ee=t.return}}function zp(e){for(;ee!==null;){var t=ee;if(t===e){ee=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ee=n;break}ee=t.return}}function $p(e){for(;ee!==null;){var t=ee;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{au(4,t)}catch(c){Xe(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){Xe(t,s,c)}}var i=t.return;try{xd(t)}catch(c){Xe(t,i,c)}break;case 5:var o=t.return;try{xd(t)}catch(c){Xe(t,o,c)}}}catch(c){Xe(t,t.return,c)}if(t===e){ee=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ee=l;break}ee=t.return}}var iS=Math.ceil,Aa=yr.ReactCurrentDispatcher,Qf=yr.ReactCurrentOwner,wn=yr.ReactCurrentBatchConfig,Ie=0,mt=null,st=null,xt=0,rn=0,ii=es(0),ct=0,Vo=null,Rs=0,uu=0,Kf=0,So=null,Ht=null,qf=0,_i=1/0,nr=null,Fa=!1,bd=null,Hr=null,_l=!1,zr=null,Oa=0,bo=0,Cd=null,sa=-1,ia=0;function Ot(){return Ie&6?nt():sa!==-1?sa:sa=nt()}function Qr(e){return e.mode&1?Ie&2&&xt!==0?xt&-xt:U1.transition!==null?(ia===0&&(ia=by()),ia):(e=Ae,e!==0||(e=window.event,e=e===void 0?16:Py(e.type)),e):1}function Fn(e,t,n,r){if(50<bo)throw bo=0,Cd=null,Error(H(185));tl(e,n,r),(!(Ie&2)||e!==mt)&&(e===mt&&(!(Ie&2)&&(uu|=n),ct===4&&Mr(e,xt)),Gt(e,r),n===1&&Ie===0&&!(t.mode&1)&&(_i=nt()+500,iu&&ts()))}function Gt(e,t){var n=e.callbackNode;Uw(e,t);var r=wa(e,e===mt?xt:0);if(r===0)n!==null&&Gh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Gh(n),t===1)e.tag===0?B1(Bp.bind(null,e)):qy(Bp.bind(null,e)),O1(function(){!(Ie&6)&&ts()}),n=null;else{switch(Cy(r)){case 1:n=wf;break;case 4:n=wy;break;case 16:n=xa;break;case 536870912:n=Sy;break;default:n=xa}n=Qv(n,zv.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function zv(e,t){if(sa=-1,ia=0,Ie&6)throw Error(H(327));var n=e.callbackNode;if(di()&&e.callbackNode!==n)return null;var r=wa(e,e===mt?xt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Da(e,r);else{t=r;var s=Ie;Ie|=2;var i=Bv();(mt!==e||xt!==t)&&(nr=null,_i=nt()+500,Es(e,t));do try{aS();break}catch(l){$v(e,l)}while(!0);_f(),Aa.current=i,Ie=s,st!==null?t=0:(mt=null,xt=0,t=ct)}if(t!==0){if(t===2&&(s=Yc(e),s!==0&&(r=s,t=kd(e,s))),t===1)throw n=Vo,Es(e,0),Mr(e,r),Gt(e,nt()),n;if(t===6)Mr(e,r);else{if(s=e.current.alternate,!(r&30)&&!oS(s)&&(t=Da(e,r),t===2&&(i=Yc(e),i!==0&&(r=i,t=kd(e,i))),t===1))throw n=Vo,Es(e,0),Mr(e,r),Gt(e,nt()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(H(345));case 2:os(e,Ht,nr);break;case 3:if(Mr(e,r),(r&130023424)===r&&(t=qf+500-nt(),10<t)){if(wa(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Ot(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=sd(os.bind(null,e,Ht,nr),t);break}os(e,Ht,nr);break;case 4:if(Mr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-An(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=nt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*iS(r/1960))-r,10<r){e.timeoutHandle=sd(os.bind(null,e,Ht,nr),r);break}os(e,Ht,nr);break;case 5:os(e,Ht,nr);break;default:throw Error(H(329))}}}return Gt(e,nt()),e.callbackNode===n?zv.bind(null,e):null}function kd(e,t){var n=So;return e.current.memoizedState.isDehydrated&&(Es(e,t).flags|=256),e=Da(e,t),e!==2&&(t=Ht,Ht=n,t!==null&&Ed(t)),e}function Ed(e){Ht===null?Ht=e:Ht.push.apply(Ht,e)}function oS(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Dn(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Mr(e,t){for(t&=~Kf,t&=~uu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-An(t),r=1<<n;e[n]=-1,t&=~r}}function Bp(e){if(Ie&6)throw Error(H(327));di();var t=wa(e,0);if(!(t&1))return Gt(e,nt()),null;var n=Da(e,t);if(e.tag!==0&&n===2){var r=Yc(e);r!==0&&(t=r,n=kd(e,r))}if(n===1)throw n=Vo,Es(e,0),Mr(e,t),Gt(e,nt()),n;if(n===6)throw Error(H(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,os(e,Ht,nr),Gt(e,nt()),null}function Gf(e,t){var n=Ie;Ie|=1;try{return e(t)}finally{Ie=n,Ie===0&&(_i=nt()+500,iu&&ts())}}function Ts(e){zr!==null&&zr.tag===0&&!(Ie&6)&&di();var t=Ie;Ie|=1;var n=wn.transition,r=Ae;try{if(wn.transition=null,Ae=1,e)return e()}finally{Ae=r,wn.transition=n,Ie=t,!(Ie&6)&&ts()}}function Yf(){rn=ii.current,ze(ii)}function Es(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,F1(n)),st!==null)for(n=st.return;n!==null;){var r=n;switch(Rf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ea();break;case 3:Ti(),ze(Kt),ze(Rt),zf();break;case 5:Df(r);break;case 4:Ti();break;case 13:ze(Ve);break;case 19:ze(Ve);break;case 10:Lf(r.type._context);break;case 22:case 23:Yf()}n=n.return}if(mt=e,st=e=Kr(e.current,null),xt=rn=t,ct=0,Vo=null,Kf=uu=Rs=0,Ht=So=null,us!==null){for(t=0;t<us.length;t++)if(n=us[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}us=null}return e}function $v(e,t){do{var n=st;try{if(_f(),ta.current=La,_a){for(var r=He.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}_a=!1}if(Ps=0,pt=at=He=null,xo=!1,$o=0,Qf.current=null,n===null||n.return===null){ct=1,Vo=t,st=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=xt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var w=Mp(o);if(w!==null){w.flags&=-257,Pp(w,o,l,i,t),w.mode&1&&jp(i,d,t),t=w,c=d;var x=t.updateQueue;if(x===null){var S=new Set;S.add(c),t.updateQueue=S}else x.add(c);break e}else{if(!(t&1)){jp(i,d,t),Xf();break e}c=Error(H(426))}}else if(Be&&l.mode&1){var C=Mp(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Pp(C,o,l,i,t),Tf(Ii(c,l));break e}}i=c=Ii(c,l),ct!==4&&(ct=2),So===null?So=[i]:So.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var y=Cv(i,c,t);Sp(i,y);break e;case 1:l=c;var g=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Hr===null||!Hr.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var m=kv(i,l,t);Sp(i,m);break e}}i=i.return}while(i!==null)}Vv(n)}catch(b){t=b,st===n&&n!==null&&(st=n=n.return);continue}break}while(!0)}function Bv(){var e=Aa.current;return Aa.current=La,e===null?La:e}function Xf(){(ct===0||ct===3||ct===2)&&(ct=4),mt===null||!(Rs&268435455)&&!(uu&268435455)||Mr(mt,xt)}function Da(e,t){var n=Ie;Ie|=2;var r=Bv();(mt!==e||xt!==t)&&(nr=null,Es(e,t));do try{lS();break}catch(s){$v(e,s)}while(!0);if(_f(),Ie=n,Aa.current=r,st!==null)throw Error(H(261));return mt=null,xt=0,ct}function lS(){for(;st!==null;)Uv(st)}function aS(){for(;st!==null&&!_w();)Uv(st)}function Uv(e){var t=Hv(e.alternate,e,rn);e.memoizedProps=e.pendingProps,t===null?Vv(e):st=t,Qf.current=null}function Vv(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=tS(n,t),n!==null){n.flags&=32767,st=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ct=6,st=null;return}}else if(n=eS(n,t,rn),n!==null){st=n;return}if(t=t.sibling,t!==null){st=t;return}st=t=e}while(t!==null);ct===0&&(ct=5)}function os(e,t,n){var r=Ae,s=wn.transition;try{wn.transition=null,Ae=1,uS(e,t,n,r)}finally{wn.transition=s,Ae=r}return null}function uS(e,t,n,r){do di();while(zr!==null);if(Ie&6)throw Error(H(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(H(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(Vw(e,i),e===mt&&(st=mt=null,xt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_l||(_l=!0,Qv(xa,function(){return di(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=wn.transition,wn.transition=null;var o=Ae;Ae=1;var l=Ie;Ie|=4,Qf.current=null,rS(e,n),Ov(n,e),P1(nd),Sa=!!td,nd=td=null,e.current=n,sS(n),Lw(),Ie=l,Ae=o,wn.transition=i}else e.current=n;if(_l&&(_l=!1,zr=e,Oa=s),i=e.pendingLanes,i===0&&(Hr=null),Ow(n.stateNode),Gt(e,nt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Fa)throw Fa=!1,e=bd,bd=null,e;return Oa&1&&e.tag!==0&&di(),i=e.pendingLanes,i&1?e===Cd?bo++:(bo=0,Cd=e):bo=0,ts(),null}function di(){if(zr!==null){var e=Cy(Oa),t=wn.transition,n=Ae;try{if(wn.transition=null,Ae=16>e?16:e,zr===null)var r=!1;else{if(e=zr,zr=null,Oa=0,Ie&6)throw Error(H(331));var s=Ie;for(Ie|=4,ee=e.current;ee!==null;){var i=ee,o=i.child;if(ee.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(ee=d;ee!==null;){var f=ee;switch(f.tag){case 0:case 11:case 15:wo(8,f,i)}var p=f.child;if(p!==null)p.return=f,ee=p;else for(;ee!==null;){f=ee;var h=f.sibling,w=f.return;if(Lv(f),f===d){ee=null;break}if(h!==null){h.return=w,ee=h;break}ee=w}}}var x=i.alternate;if(x!==null){var S=x.child;if(S!==null){x.child=null;do{var C=S.sibling;S.sibling=null,S=C}while(S!==null)}}ee=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ee=o;else e:for(;ee!==null;){if(i=ee,i.flags&2048)switch(i.tag){case 0:case 11:case 15:wo(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,ee=y;break e}ee=i.return}}var g=e.current;for(ee=g;ee!==null;){o=ee;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,ee=v;else e:for(o=g;ee!==null;){if(l=ee,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:au(9,l)}}catch(b){Xe(l,l.return,b)}if(l===o){ee=null;break e}var m=l.sibling;if(m!==null){m.return=l.return,ee=m;break e}ee=l.return}}if(Ie=s,ts(),Kn&&typeof Kn.onPostCommitFiberRoot=="function")try{Kn.onPostCommitFiberRoot(eu,e)}catch{}r=!0}return r}finally{Ae=n,wn.transition=t}}return!1}function Up(e,t,n){t=Ii(n,t),t=Cv(e,t,1),e=Wr(e,t,1),t=Ot(),e!==null&&(tl(e,1,t),Gt(e,t))}function Xe(e,t,n){if(e.tag===3)Up(e,e,n);else for(;t!==null;){if(t.tag===3){Up(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Hr===null||!Hr.has(r))){e=Ii(n,e),e=kv(t,e,1),t=Wr(t,e,1),e=Ot(),t!==null&&(tl(t,1,e),Gt(t,e));break}}t=t.return}}function cS(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ot(),e.pingedLanes|=e.suspendedLanes&n,mt===e&&(xt&n)===n&&(ct===4||ct===3&&(xt&130023424)===xt&&500>nt()-qf?Es(e,0):Kf|=n),Gt(e,t)}function Wv(e,t){t===0&&(e.mode&1?(t=Cl,Cl<<=1,!(Cl&130023424)&&(Cl=4194304)):t=1);var n=Ot();e=mr(e,t),e!==null&&(tl(e,t,n),Gt(e,n))}function dS(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Wv(e,n)}function fS(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(t),Wv(e,n)}var Hv;Hv=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Kt.current)Qt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Qt=!1,Z1(e,t,n);Qt=!!(e.flags&131072)}else Qt=!1,Be&&t.flags&1048576&&Gy(t,Ma,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;ra(e,t),e=t.pendingProps;var s=Mi(t,Rt.current);ci(t,n),s=Bf(null,t,r,e,s,n);var i=Uf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,qt(r)?(i=!0,Na(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ff(t),s.updater=lu,t.stateNode=s,s._reactInternals=t,dd(t,r,e,n),t=pd(null,t,r,!0,i,n)):(t.tag=0,Be&&i&&Pf(t),At(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(ra(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=pS(r),e=Pn(r,e),s){case 0:t=hd(null,t,r,e,n);break e;case 1:t=Ip(null,t,r,e,n);break e;case 11:t=Rp(null,t,r,e,n);break e;case 14:t=Tp(null,t,r,Pn(r.type,e),n);break e}throw Error(H(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Pn(r,s),hd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Pn(r,s),Ip(e,t,r,s,n);case 3:e:{if(Mv(t),e===null)throw Error(H(387));r=t.pendingProps,i=t.memoizedState,s=i.element,tv(e,t),Ta(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Ii(Error(H(423)),t),t=_p(e,t,r,n,s);break e}else if(r!==s){s=Ii(Error(H(424)),t),t=_p(e,t,r,n,s);break e}else for(sn=Vr(t.stateNode.containerInfo.firstChild),on=t,Be=!0,Ln=null,n=Zy(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Pi(),r===s){t=gr(e,t,n);break e}At(e,t,r,n)}t=t.child}return t;case 5:return nv(t),e===null&&ad(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,rd(r,s)?o=null:i!==null&&rd(r,i)&&(t.flags|=32),jv(e,t),At(e,t,o,n),t.child;case 6:return e===null&&ad(t),null;case 13:return Pv(e,t,n);case 4:return Of(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ri(t,null,r,n):At(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Pn(r,s),Rp(e,t,r,s,n);case 7:return At(e,t,t.pendingProps,n),t.child;case 8:return At(e,t,t.pendingProps.children,n),t.child;case 12:return At(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Oe(Pa,r._currentValue),r._currentValue=o,i!==null)if(Dn(i.value,o)){if(i.children===s.children&&!Kt.current){t=gr(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=cr(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),ud(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(H(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ud(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}At(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,ci(t,n),s=Sn(s),r=r(s),t.flags|=1,At(e,t,r,n),t.child;case 14:return r=t.type,s=Pn(r,t.pendingProps),s=Pn(r.type,s),Tp(e,t,r,s,n);case 15:return Ev(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Pn(r,s),ra(e,t),t.tag=1,qt(r)?(e=!0,Na(t)):e=!1,ci(t,n),bv(t,r,s),dd(t,r,s,n),pd(null,t,r,!0,e,n);case 19:return Rv(e,t,n);case 22:return Nv(e,t,n)}throw Error(H(156,t.tag))};function Qv(e,t){return xy(e,t)}function hS(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(e,t,n,r){return new hS(e,t,n,r)}function Jf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function pS(e){if(typeof e=="function")return Jf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===yf)return 11;if(e===vf)return 14}return 2}function Kr(e,t){var n=e.alternate;return n===null?(n=xn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function oa(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")Jf(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Gs:return Ns(n.children,s,i,t);case gf:o=8,s|=8;break;case Ac:return e=xn(12,n,t,s|2),e.elementType=Ac,e.lanes=i,e;case Fc:return e=xn(13,n,t,s),e.elementType=Fc,e.lanes=i,e;case Oc:return e=xn(19,n,t,s),e.elementType=Oc,e.lanes=i,e;case ny:return cu(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ey:o=10;break e;case ty:o=9;break e;case yf:o=11;break e;case vf:o=14;break e;case Er:o=16,r=null;break e}throw Error(H(130,e==null?e:typeof e,""))}return t=xn(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function Ns(e,t,n,r){return e=xn(7,e,r,t),e.lanes=n,e}function cu(e,t,n,r){return e=xn(22,e,r,t),e.elementType=ny,e.lanes=n,e.stateNode={isHidden:!1},e}function gc(e,t,n){return e=xn(6,e,null,t),e.lanes=n,e}function yc(e,t,n){return t=xn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function mS(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xu(0),this.expirationTimes=Xu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Zf(e,t,n,r,s,i,o,l,c){return e=new mS(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=xn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ff(i),e}function gS(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qs,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Kv(e){if(!e)return Jr;e=e._reactInternals;e:{if(As(e)!==e||e.tag!==1)throw Error(H(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(qt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(H(171))}if(e.tag===1){var n=e.type;if(qt(n))return Ky(e,n,t)}return t}function qv(e,t,n,r,s,i,o,l,c){return e=Zf(n,r,!0,e,s,i,o,l,c),e.context=Kv(null),n=e.current,r=Ot(),s=Qr(n),i=cr(r,s),i.callback=t??null,Wr(n,i,s),e.current.lanes=s,tl(e,s,r),Gt(e,r),e}function du(e,t,n,r){var s=t.current,i=Ot(),o=Qr(s);return n=Kv(n),t.context===null?t.context=n:t.pendingContext=n,t=cr(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Wr(s,t,o),e!==null&&(Fn(e,s,o,i),ea(e,s,o)),o}function za(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Vp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function eh(e,t){Vp(e,t),(e=e.alternate)&&Vp(e,t)}function yS(){return null}var Gv=typeof reportError=="function"?reportError:function(e){console.error(e)};function th(e){this._internalRoot=e}fu.prototype.render=th.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(H(409));du(e,t,null,null)};fu.prototype.unmount=th.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ts(function(){du(null,e,null,null)}),t[pr]=null}};function fu(e){this._internalRoot=e}fu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ny();e={blockedOn:null,target:e,priority:t};for(var n=0;n<jr.length&&t!==0&&t<jr[n].priority;n++);jr.splice(n,0,e),n===0&&My(e)}};function nh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function hu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Wp(){}function vS(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=za(o);i.call(d)}}var o=qv(t,r,e,0,null,!1,!1,"",Wp);return e._reactRootContainer=o,e[pr]=o.current,Ao(e.nodeType===8?e.parentNode:e),Ts(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=za(c);l.call(d)}}var c=Zf(e,0,!1,null,null,!1,!1,"",Wp);return e._reactRootContainer=c,e[pr]=c.current,Ao(e.nodeType===8?e.parentNode:e),Ts(function(){du(t,c,n,r)}),c}function pu(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=za(o);l.call(c)}}du(t,o,e,s)}else o=vS(n,t,e,s,r);return za(o)}ky=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=uo(t.pendingLanes);n!==0&&(Sf(t,n|1),Gt(t,nt()),!(Ie&6)&&(_i=nt()+500,ts()))}break;case 13:Ts(function(){var r=mr(e,1);if(r!==null){var s=Ot();Fn(r,e,1,s)}}),eh(e,1)}};bf=function(e){if(e.tag===13){var t=mr(e,134217728);if(t!==null){var n=Ot();Fn(t,e,134217728,n)}eh(e,134217728)}};Ey=function(e){if(e.tag===13){var t=Qr(e),n=mr(e,t);if(n!==null){var r=Ot();Fn(n,e,t,r)}eh(e,t)}};Ny=function(){return Ae};jy=function(e,t){var n=Ae;try{return Ae=e,t()}finally{Ae=n}};Kc=function(e,t,n){switch(t){case"input":if($c(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=su(r);if(!s)throw Error(H(90));sy(r),$c(r,s)}}}break;case"textarea":oy(e,n);break;case"select":t=n.value,t!=null&&oi(e,!!n.multiple,t,!1)}};hy=Gf;py=Ts;var xS={usingClientEntryPoint:!1,Events:[rl,Zs,su,dy,fy,Gf]},eo={findFiberByHostInstance:as,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wS={bundleType:eo.bundleType,version:eo.version,rendererPackageName:eo.rendererPackageName,rendererConfig:eo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=yy(e),e===null?null:e.stateNode},findFiberByHostInstance:eo.findFiberByHostInstance||yS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ll=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ll.isDisabled&&Ll.supportsFiber)try{eu=Ll.inject(wS),Kn=Ll}catch{}}un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xS;un.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nh(t))throw Error(H(200));return gS(e,t,null,n)};un.createRoot=function(e,t){if(!nh(e))throw Error(H(299));var n=!1,r="",s=Gv;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Zf(e,1,!1,null,null,n,!1,r,s),e[pr]=t.current,Ao(e.nodeType===8?e.parentNode:e),new th(t)};un.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(H(188)):(e=Object.keys(e).join(","),Error(H(268,e)));return e=yy(t),e=e===null?null:e.stateNode,e};un.flushSync=function(e){return Ts(e)};un.hydrate=function(e,t,n){if(!hu(t))throw Error(H(200));return pu(null,e,t,!0,n)};un.hydrateRoot=function(e,t,n){if(!nh(e))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Gv;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=qv(t,null,e,1,n??null,s,!1,i,o),e[pr]=t.current,Ao(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new fu(t)};un.render=function(e,t,n){if(!hu(t))throw Error(H(200));return pu(null,e,t,!1,n)};un.unmountComponentAtNode=function(e){if(!hu(e))throw Error(H(40));return e._reactRootContainer?(Ts(function(){pu(null,null,e,!1,function(){e._reactRootContainer=null,e[pr]=null})}),!0):!1};un.unstable_batchedUpdates=Gf;un.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!hu(n))throw Error(H(200));if(e==null||e._reactInternals===void 0)throw Error(H(38));return pu(e,t,n,!1,r)};un.version="18.3.1-next-f1338f8080-20240426";function Yv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Yv)}catch(e){console.error(e)}}Yv(),Yg.exports=un;var mu=Yg.exports,Xv,Hp=mu;Xv=Hp.createRoot,Hp.hydrateRoot;var Di=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},SS={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Pr,af,Mg,bS=(Mg=class{constructor(){ae(this,Pr,SS);ae(this,af,!1)}setTimeoutProvider(e){J(this,Pr,e)}setTimeout(e,t){return k(this,Pr).setTimeout(e,t)}clearTimeout(e){k(this,Pr).clearTimeout(e)}setInterval(e,t){return k(this,Pr).setInterval(e,t)}clearInterval(e){k(this,Pr).clearInterval(e)}},Pr=new WeakMap,af=new WeakMap,Mg),ds=new bS;function CS(e){setTimeout(e,0)}var Is=typeof window>"u"||"Deno"in globalThis;function Ft(){}function kS(e,t){return typeof e=="function"?e(t):e}function Nd(e){return typeof e=="number"&&e>=0&&e!==1/0}function Jv(e,t){return Math.max(e+(t||0)-Date.now(),0)}function qr(e,t){return typeof e=="function"?e(t):e}function mn(e,t){return typeof e=="function"?e(t):e}function Qp(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(r){if(t.queryHash!==rh(o,t.options))return!1}else if(!Wo(t.queryKey,o))return!1}if(n!=="all"){const c=t.isActive();if(n==="active"&&!c||n==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function Kp(e,t){const{exact:n,status:r,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(_s(t.options.mutationKey)!==_s(i))return!1}else if(!Wo(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function rh(e,t){return((t==null?void 0:t.queryKeyHashFn)||_s)(e)}function _s(e){return JSON.stringify(e,(t,n)=>jd(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function Wo(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Wo(e[n],t[n])):!1}var ES=Object.prototype.hasOwnProperty;function Zv(e,t){if(e===t)return e;const n=qp(e)&&qp(t);if(!n&&!(jd(e)&&jd(t)))return t;const s=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),o=i.length,l=n?new Array(o):{};let c=0;for(let d=0;d<o;d++){const f=n?d:i[d],p=e[f],h=t[f];if(p===h){l[f]=p,(n?d<s:ES.call(e,f))&&c++;continue}if(p===null||h===null||typeof p!="object"||typeof h!="object"){l[f]=h;continue}const w=Zv(p,h);l[f]=w,w===p&&c++}return s===o&&c===s?e:l}function $a(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function qp(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function jd(e){if(!Gp(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!Gp(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Gp(e){return Object.prototype.toString.call(e)==="[object Object]"}function NS(e){return new Promise(t=>{ds.setTimeout(t,e)})}function Md(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?Zv(e,t):t}function jS(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function MS(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var sh=Symbol();function ex(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===sh?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function tx(e,t){return typeof e=="function"?e(...t):!!e}function PS(e,t,n){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=t()),r||(r=!0,s.aborted?n():s.addEventListener("abort",n,{once:!0})),s)}),e}var gs,Rr,mi,Pg,RS=(Pg=class extends Di{constructor(){super();ae(this,gs);ae(this,Rr);ae(this,mi);J(this,mi,t=>{if(!Is&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){k(this,Rr)||this.setEventListener(k(this,mi))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,Rr))==null||t.call(this),J(this,Rr,void 0))}setEventListener(t){var n;J(this,mi,t),(n=k(this,Rr))==null||n.call(this),J(this,Rr,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){k(this,gs)!==t&&(J(this,gs,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof k(this,gs)=="boolean"?k(this,gs):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},gs=new WeakMap,Rr=new WeakMap,mi=new WeakMap,Pg),ih=new RS;function Pd(){let e,t;const n=new Promise((s,i)=>{e=s,t=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}var TS=CS;function IS(){let e=[],t=0,n=l=>{l()},r=l=>{l()},s=TS;const i=l=>{t?e.push(l):s(()=>{n(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{r(()=>{l.forEach(c=>{n(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var ut=IS(),gi,Tr,yi,Rg,_S=(Rg=class extends Di{constructor(){super();ae(this,gi,!0);ae(this,Tr);ae(this,yi);J(this,yi,t=>{if(!Is&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){k(this,Tr)||this.setEventListener(k(this,yi))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,Tr))==null||t.call(this),J(this,Tr,void 0))}setEventListener(t){var n;J(this,yi,t),(n=k(this,Tr))==null||n.call(this),J(this,Tr,t(this.setOnline.bind(this)))}setOnline(t){k(this,gi)!==t&&(J(this,gi,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return k(this,gi)}},gi=new WeakMap,Tr=new WeakMap,yi=new WeakMap,Rg),Ba=new _S;function LS(e){return Math.min(1e3*2**e,3e4)}function nx(e){return(e??"online")==="online"?Ba.isOnline():!0}var Rd=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function rx(e){let t=!1,n=0,r;const s=Pd(),i=()=>s.status!=="pending",o=S=>{var C;if(!i()){const y=new Rd(S);h(y),(C=e.onCancel)==null||C.call(e,y)}},l=()=>{t=!0},c=()=>{t=!1},d=()=>ih.isFocused()&&(e.networkMode==="always"||Ba.isOnline())&&e.canRun(),f=()=>nx(e.networkMode)&&e.canRun(),p=S=>{i()||(r==null||r(),s.resolve(S))},h=S=>{i()||(r==null||r(),s.reject(S))},w=()=>new Promise(S=>{var C;r=y=>{(i()||d())&&S(y)},(C=e.onPause)==null||C.call(e)}).then(()=>{var S;r=void 0,i()||(S=e.onContinue)==null||S.call(e)}),x=()=>{if(i())return;let S;const C=n===0?e.initialPromise:void 0;try{S=C??e.fn()}catch(y){S=Promise.reject(y)}Promise.resolve(S).then(p).catch(y=>{var E;if(i())return;const g=e.retry??(Is?0:3),v=e.retryDelay??LS,m=typeof v=="function"?v(n,y):v,b=g===!0||typeof g=="number"&&n<g||typeof g=="function"&&g(n,y);if(t||!b){h(y);return}n++,(E=e.onFail)==null||E.call(e,n,y),NS(m).then(()=>d()?void 0:w()).then(()=>{t?h(y):x()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:l,continueRetry:c,canStart:f,start:()=>(f()?x():w().then(x),s)}}var ys,Tg,sx=(Tg=class{constructor(){ae(this,ys)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Nd(this.gcTime)&&J(this,ys,ds.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Is?1/0:5*60*1e3))}clearGcTimeout(){k(this,ys)&&(ds.clearTimeout(k(this,ys)),J(this,ys,void 0))}},ys=new WeakMap,Tg),vs,vi,pn,xs,ht,Go,ws,Tn,tr,Ig,AS=(Ig=class extends sx{constructor(t){super();ae(this,Tn);ae(this,vs);ae(this,vi);ae(this,pn);ae(this,xs);ae(this,ht);ae(this,Go);ae(this,ws);J(this,ws,!1),J(this,Go,t.defaultOptions),this.setOptions(t.options),this.observers=[],J(this,xs,t.client),J(this,pn,k(this,xs).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,J(this,vs,Xp(this.options)),this.state=t.state??k(this,vs),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=k(this,ht))==null?void 0:t.promise}setOptions(t){if(this.options={...k(this,Go),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Xp(this.options);n.data!==void 0&&(this.setState(Yp(n.data,n.dataUpdatedAt)),J(this,vs,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&k(this,pn).remove(this)}setData(t,n){const r=Md(this.state.data,t,this.options);return ve(this,Tn,tr).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){ve(this,Tn,tr).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=k(this,ht))==null?void 0:r.promise;return(s=k(this,ht))==null||s.cancel(t),n?n.then(Ft).catch(Ft):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(k(this,vs))}isActive(){return this.observers.some(t=>mn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===sh||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>qr(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Jv(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,ht))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,ht))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),k(this,pn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(k(this,ht)&&(k(this,ws)?k(this,ht).cancel({revert:!0}):k(this,ht).cancelRetry()),this.scheduleGc()),k(this,pn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ve(this,Tn,tr).call(this,{type:"invalidate"})}async fetch(t,n){var c,d,f,p,h,w,x,S,C,y,g,v;if(this.state.fetchStatus!=="idle"&&((c=k(this,ht))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(k(this,ht))return k(this,ht).continueRetry(),k(this,ht).promise}if(t&&this.setOptions(t),!this.options.queryFn){const m=this.observers.find(b=>b.options.queryFn);m&&this.setOptions(m.options)}const r=new AbortController,s=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(J(this,ws,!0),r.signal)})},i=()=>{const m=ex(this.options,n),E=(()=>{const j={client:k(this,xs),queryKey:this.queryKey,meta:this.meta};return s(j),j})();return J(this,ws,!1),this.options.persister?this.options.persister(m,E,this):m(E)},l=(()=>{const m={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:k(this,xs),state:this.state,fetchFn:i};return s(m),m})();(d=this.options.behavior)==null||d.onFetch(l,this),J(this,vi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&ve(this,Tn,tr).call(this,{type:"fetch",meta:(p=l.fetchOptions)==null?void 0:p.meta}),J(this,ht,rx({initialPromise:n==null?void 0:n.initialPromise,fn:l.fetchFn,onCancel:m=>{m instanceof Rd&&m.revert&&this.setState({...k(this,vi),fetchStatus:"idle"}),r.abort()},onFail:(m,b)=>{ve(this,Tn,tr).call(this,{type:"failed",failureCount:m,error:b})},onPause:()=>{ve(this,Tn,tr).call(this,{type:"pause"})},onContinue:()=>{ve(this,Tn,tr).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const m=await k(this,ht).start();if(m===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(m),(w=(h=k(this,pn).config).onSuccess)==null||w.call(h,m,this),(S=(x=k(this,pn).config).onSettled)==null||S.call(x,m,this.state.error,this),m}catch(m){if(m instanceof Rd){if(m.silent)return k(this,ht).promise;if(m.revert){if(this.state.data===void 0)throw m;return this.state.data}}throw ve(this,Tn,tr).call(this,{type:"error",error:m}),(y=(C=k(this,pn).config).onError)==null||y.call(C,m,this),(v=(g=k(this,pn).config).onSettled)==null||v.call(g,this.state.data,m,this),m}finally{this.scheduleGc()}}},vs=new WeakMap,vi=new WeakMap,pn=new WeakMap,xs=new WeakMap,ht=new WeakMap,Go=new WeakMap,ws=new WeakMap,Tn=new WeakSet,tr=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...ix(r.data,this.options),fetchMeta:t.meta??null};case"success":const s={...r,...Yp(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return J(this,vi,t.manual?s:void 0),s;case"error":const i=t.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),ut.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),k(this,pn).notify({query:this,type:"updated",action:t})})},Ig);function ix(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:nx(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Yp(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Xp(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Vt,je,Yo,_t,Ss,xi,sr,Ir,Xo,wi,Si,bs,Cs,_r,bi,Le,fo,Td,Id,_d,Ld,Ad,Fd,Od,ox,_g,FS=(_g=class extends Di{constructor(t,n){super();ae(this,Le);ae(this,Vt);ae(this,je);ae(this,Yo);ae(this,_t);ae(this,Ss);ae(this,xi);ae(this,sr);ae(this,Ir);ae(this,Xo);ae(this,wi);ae(this,Si);ae(this,bs);ae(this,Cs);ae(this,_r);ae(this,bi,new Set);this.options=n,J(this,Vt,t),J(this,Ir,null),J(this,sr,Pd()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(k(this,je).addObserver(this),Jp(k(this,je),this.options)?ve(this,Le,fo).call(this):this.updateResult(),ve(this,Le,Ld).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Dd(k(this,je),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Dd(k(this,je),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,ve(this,Le,Ad).call(this),ve(this,Le,Fd).call(this),k(this,je).removeObserver(this)}setOptions(t){const n=this.options,r=k(this,je);if(this.options=k(this,Vt).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof mn(this.options.enabled,k(this,je))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");ve(this,Le,Od).call(this),k(this,je).setOptions(this.options),n._defaulted&&!$a(this.options,n)&&k(this,Vt).getQueryCache().notify({type:"observerOptionsUpdated",query:k(this,je),observer:this});const s=this.hasListeners();s&&Zp(k(this,je),r,this.options,n)&&ve(this,Le,fo).call(this),this.updateResult(),s&&(k(this,je)!==r||mn(this.options.enabled,k(this,je))!==mn(n.enabled,k(this,je))||qr(this.options.staleTime,k(this,je))!==qr(n.staleTime,k(this,je)))&&ve(this,Le,Td).call(this);const i=ve(this,Le,Id).call(this);s&&(k(this,je)!==r||mn(this.options.enabled,k(this,je))!==mn(n.enabled,k(this,je))||i!==k(this,_r))&&ve(this,Le,_d).call(this,i)}getOptimisticResult(t){const n=k(this,Vt).getQueryCache().build(k(this,Vt),t),r=this.createResult(n,t);return DS(this,r)&&(J(this,_t,r),J(this,xi,this.options),J(this,Ss,k(this,je).state)),r}getCurrentResult(){return k(this,_t)}trackResult(t,n){return new Proxy(t,{get:(r,s)=>(this.trackProp(s),n==null||n(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&k(this,sr).status==="pending"&&k(this,sr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(t){k(this,bi).add(t)}getCurrentQuery(){return k(this,je)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=k(this,Vt).defaultQueryOptions(t),r=k(this,Vt).getQueryCache().build(k(this,Vt),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return ve(this,Le,fo).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),k(this,_t)))}createResult(t,n){var _;const r=k(this,je),s=this.options,i=k(this,_t),o=k(this,Ss),l=k(this,xi),d=t!==r?t.state:k(this,Yo),{state:f}=t;let p={...f},h=!1,w;if(n._optimisticResults){const P=this.hasListeners(),U=!P&&Jp(t,n),F=P&&Zp(t,r,n,s);(U||F)&&(p={...p,...ix(f.data,t.options)}),n._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:x,errorUpdatedAt:S,status:C}=p;w=p.data;let y=!1;if(n.placeholderData!==void 0&&w===void 0&&C==="pending"){let P;i!=null&&i.isPlaceholderData&&n.placeholderData===(l==null?void 0:l.placeholderData)?(P=i.data,y=!0):P=typeof n.placeholderData=="function"?n.placeholderData((_=k(this,Si))==null?void 0:_.state.data,k(this,Si)):n.placeholderData,P!==void 0&&(C="success",w=Md(i==null?void 0:i.data,P,n),h=!0)}if(n.select&&w!==void 0&&!y)if(i&&w===(o==null?void 0:o.data)&&n.select===k(this,Xo))w=k(this,wi);else try{J(this,Xo,n.select),w=n.select(w),w=Md(i==null?void 0:i.data,w,n),J(this,wi,w),J(this,Ir,null)}catch(P){J(this,Ir,P)}k(this,Ir)&&(x=k(this,Ir),w=k(this,wi),S=Date.now(),C="error");const g=p.fetchStatus==="fetching",v=C==="pending",m=C==="error",b=v&&g,E=w!==void 0,M={status:C,fetchStatus:p.fetchStatus,isPending:v,isSuccess:C==="success",isError:m,isInitialLoading:b,isLoading:b,data:w,dataUpdatedAt:p.dataUpdatedAt,error:x,errorUpdatedAt:S,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:g,isRefetching:g&&!v,isLoadingError:m&&!E,isPaused:p.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:m&&E,isStale:oh(t,n),refetch:this.refetch,promise:k(this,sr),isEnabled:mn(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const P=q=>{M.status==="error"?q.reject(M.error):M.data!==void 0&&q.resolve(M.data)},U=()=>{const q=J(this,sr,M.promise=Pd());P(q)},F=k(this,sr);switch(F.status){case"pending":t.queryHash===r.queryHash&&P(F);break;case"fulfilled":(M.status==="error"||M.data!==F.value)&&U();break;case"rejected":(M.status!=="error"||M.error!==F.reason)&&U();break}}return M}updateResult(){const t=k(this,_t),n=this.createResult(k(this,je),this.options);if(J(this,Ss,k(this,je).state),J(this,xi,this.options),k(this,Ss).data!==void 0&&J(this,Si,k(this,je)),$a(n,t))return;J(this,_t,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!k(this,bi).size)return!0;const o=new Set(i??k(this,bi));return this.options.throwOnError&&o.add("error"),Object.keys(k(this,_t)).some(l=>{const c=l;return k(this,_t)[c]!==t[c]&&o.has(c)})};ve(this,Le,ox).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&ve(this,Le,Ld).call(this)}},Vt=new WeakMap,je=new WeakMap,Yo=new WeakMap,_t=new WeakMap,Ss=new WeakMap,xi=new WeakMap,sr=new WeakMap,Ir=new WeakMap,Xo=new WeakMap,wi=new WeakMap,Si=new WeakMap,bs=new WeakMap,Cs=new WeakMap,_r=new WeakMap,bi=new WeakMap,Le=new WeakSet,fo=function(t){ve(this,Le,Od).call(this);let n=k(this,je).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Ft)),n},Td=function(){ve(this,Le,Ad).call(this);const t=qr(this.options.staleTime,k(this,je));if(Is||k(this,_t).isStale||!Nd(t))return;const r=Jv(k(this,_t).dataUpdatedAt,t)+1;J(this,bs,ds.setTimeout(()=>{k(this,_t).isStale||this.updateResult()},r))},Id=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(k(this,je)):this.options.refetchInterval)??!1},_d=function(t){ve(this,Le,Fd).call(this),J(this,_r,t),!(Is||mn(this.options.enabled,k(this,je))===!1||!Nd(k(this,_r))||k(this,_r)===0)&&J(this,Cs,ds.setInterval(()=>{(this.options.refetchIntervalInBackground||ih.isFocused())&&ve(this,Le,fo).call(this)},k(this,_r)))},Ld=function(){ve(this,Le,Td).call(this),ve(this,Le,_d).call(this,ve(this,Le,Id).call(this))},Ad=function(){k(this,bs)&&(ds.clearTimeout(k(this,bs)),J(this,bs,void 0))},Fd=function(){k(this,Cs)&&(ds.clearInterval(k(this,Cs)),J(this,Cs,void 0))},Od=function(){const t=k(this,Vt).getQueryCache().build(k(this,Vt),this.options);if(t===k(this,je))return;const n=k(this,je);J(this,je,t),J(this,Yo,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},ox=function(t){ut.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(k(this,_t))}),k(this,Vt).getQueryCache().notify({query:k(this,je),type:"observerResultsUpdated"})})},_g);function OS(e,t){return mn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Jp(e,t){return OS(e,t)||e.state.data!==void 0&&Dd(e,t,t.refetchOnMount)}function Dd(e,t,n){if(mn(t.enabled,e)!==!1&&qr(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&oh(e,t)}return!1}function Zp(e,t,n,r){return(e!==t||mn(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&oh(e,n)}function oh(e,t){return mn(t.enabled,e)!==!1&&e.isStaleByTime(qr(t.staleTime,e))}function DS(e,t){return!$a(e.getCurrentResult(),t)}function em(e){return{onFetch:(t,n)=>{var f,p,h,w,x;const r=t.options,s=(h=(p=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:p.fetchMore)==null?void 0:h.direction,i=((w=t.state.data)==null?void 0:w.pages)||[],o=((x=t.state.data)==null?void 0:x.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let S=!1;const C=v=>{PS(v,()=>t.signal,()=>S=!0)},y=ex(t.options,t.fetchOptions),g=async(v,m,b)=>{if(S)return Promise.reject();if(m==null&&v.pages.length)return Promise.resolve(v);const j=(()=>{const U={client:t.client,queryKey:t.queryKey,pageParam:m,direction:b?"backward":"forward",meta:t.options.meta};return C(U),U})(),M=await y(j),{maxPages:_}=t.options,P=b?MS:jS;return{pages:P(v.pages,M,_),pageParams:P(v.pageParams,m,_)}};if(s&&i.length){const v=s==="backward",m=v?zS:tm,b={pages:i,pageParams:o},E=m(r,b);l=await g(b,E,v)}else{const v=e??i.length;do{const m=c===0?o[0]??r.initialPageParam:tm(r,l);if(c>0&&m==null)break;l=await g(l,m),c++}while(c<v)}return l};t.options.persister?t.fetchFn=()=>{var S,C;return(C=(S=t.options).persister)==null?void 0:C.call(S,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=d}}}function tm(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function zS(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var Jo,Vn,Lt,ks,Wn,kr,Lg,$S=(Lg=class extends sx{constructor(t){super();ae(this,Wn);ae(this,Jo);ae(this,Vn);ae(this,Lt);ae(this,ks);J(this,Jo,t.client),this.mutationId=t.mutationId,J(this,Lt,t.mutationCache),J(this,Vn,[]),this.state=t.state||lx(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){k(this,Vn).includes(t)||(k(this,Vn).push(t),this.clearGcTimeout(),k(this,Lt).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){J(this,Vn,k(this,Vn).filter(n=>n!==t)),this.scheduleGc(),k(this,Lt).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){k(this,Vn).length||(this.state.status==="pending"?this.scheduleGc():k(this,Lt).remove(this))}continue(){var t;return((t=k(this,ks))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,c,d,f,p,h,w,x,S,C,y,g,v,m,b,E,j,M,_;const n=()=>{ve(this,Wn,kr).call(this,{type:"continue"})},r={client:k(this,Jo),meta:this.options.meta,mutationKey:this.options.mutationKey};J(this,ks,rx({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(P,U)=>{ve(this,Wn,kr).call(this,{type:"failed",failureCount:P,error:U})},onPause:()=>{ve(this,Wn,kr).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>k(this,Lt).canRun(this)}));const s=this.state.status==="pending",i=!k(this,ks).canStart();try{if(s)n();else{ve(this,Wn,kr).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(o=k(this,Lt).config).onMutate)==null?void 0:l.call(o,t,this,r));const U=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t,r));U!==this.state.context&&ve(this,Wn,kr).call(this,{type:"pending",context:U,variables:t,isPaused:i})}const P=await k(this,ks).start();return await((p=(f=k(this,Lt).config).onSuccess)==null?void 0:p.call(f,P,t,this.state.context,this,r)),await((w=(h=this.options).onSuccess)==null?void 0:w.call(h,P,t,this.state.context,r)),await((S=(x=k(this,Lt).config).onSettled)==null?void 0:S.call(x,P,null,this.state.variables,this.state.context,this,r)),await((y=(C=this.options).onSettled)==null?void 0:y.call(C,P,null,t,this.state.context,r)),ve(this,Wn,kr).call(this,{type:"success",data:P}),P}catch(P){try{await((v=(g=k(this,Lt).config).onError)==null?void 0:v.call(g,P,t,this.state.context,this,r))}catch(U){Promise.reject(U)}try{await((b=(m=this.options).onError)==null?void 0:b.call(m,P,t,this.state.context,r))}catch(U){Promise.reject(U)}try{await((j=(E=k(this,Lt).config).onSettled)==null?void 0:j.call(E,void 0,P,this.state.variables,this.state.context,this,r))}catch(U){Promise.reject(U)}try{await((_=(M=this.options).onSettled)==null?void 0:_.call(M,void 0,P,t,this.state.context,r))}catch(U){Promise.reject(U)}throw ve(this,Wn,kr).call(this,{type:"error",error:P}),P}finally{k(this,Lt).runNext(this)}}},Jo=new WeakMap,Vn=new WeakMap,Lt=new WeakMap,ks=new WeakMap,Wn=new WeakSet,kr=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),ut.batch(()=>{k(this,Vn).forEach(r=>{r.onMutationUpdate(t)}),k(this,Lt).notify({mutation:this,type:"updated",action:t})})},Lg);function lx(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ir,In,Zo,Ag,BS=(Ag=class extends Di{constructor(t={}){super();ae(this,ir);ae(this,In);ae(this,Zo);this.config=t,J(this,ir,new Set),J(this,In,new Map),J(this,Zo,0)}build(t,n,r){const s=new $S({client:t,mutationCache:this,mutationId:++yl(this,Zo)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){k(this,ir).add(t);const n=Al(t);if(typeof n=="string"){const r=k(this,In).get(n);r?r.push(t):k(this,In).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(k(this,ir).delete(t)){const n=Al(t);if(typeof n=="string"){const r=k(this,In).get(n);if(r)if(r.length>1){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}else r[0]===t&&k(this,In).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Al(t);if(typeof n=="string"){const r=k(this,In).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var r;const n=Al(t);if(typeof n=="string"){const s=(r=k(this,In).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){ut.batch(()=>{k(this,ir).forEach(t=>{this.notify({type:"removed",mutation:t})}),k(this,ir).clear(),k(this,In).clear()})}getAll(){return Array.from(k(this,ir))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Kp(n,r))}findAll(t={}){return this.getAll().filter(n=>Kp(t,n))}notify(t){ut.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return ut.batch(()=>Promise.all(t.map(n=>n.continue().catch(Ft))))}},ir=new WeakMap,In=new WeakMap,Zo=new WeakMap,Ag);function Al(e){var t;return(t=e.options.scope)==null?void 0:t.id}var or,Lr,Wt,lr,fr,la,zd,Fg,US=(Fg=class extends Di{constructor(n,r){super();ae(this,fr);ae(this,or);ae(this,Lr);ae(this,Wt);ae(this,lr);J(this,or,n),this.setOptions(r),this.bindMethods(),ve(this,fr,la).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var s;const r=this.options;this.options=k(this,or).defaultMutationOptions(n),$a(this.options,r)||k(this,or).getMutationCache().notify({type:"observerOptionsUpdated",mutation:k(this,Wt),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&_s(r.mutationKey)!==_s(this.options.mutationKey)?this.reset():((s=k(this,Wt))==null?void 0:s.state.status)==="pending"&&k(this,Wt).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=k(this,Wt))==null||n.removeObserver(this)}onMutationUpdate(n){ve(this,fr,la).call(this),ve(this,fr,zd).call(this,n)}getCurrentResult(){return k(this,Lr)}reset(){var n;(n=k(this,Wt))==null||n.removeObserver(this),J(this,Wt,void 0),ve(this,fr,la).call(this),ve(this,fr,zd).call(this)}mutate(n,r){var s;return J(this,lr,r),(s=k(this,Wt))==null||s.removeObserver(this),J(this,Wt,k(this,or).getMutationCache().build(k(this,or),this.options)),k(this,Wt).addObserver(this),k(this,Wt).execute(n)}},or=new WeakMap,Lr=new WeakMap,Wt=new WeakMap,lr=new WeakMap,fr=new WeakSet,la=function(){var r;const n=((r=k(this,Wt))==null?void 0:r.state)??lx();J(this,Lr,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},zd=function(n){ut.batch(()=>{var r,s,i,o,l,c,d,f;if(k(this,lr)&&this.hasListeners()){const p=k(this,Lr).variables,h=k(this,Lr).context,w={client:k(this,or),meta:this.options.meta,mutationKey:this.options.mutationKey};if((n==null?void 0:n.type)==="success"){try{(s=(r=k(this,lr)).onSuccess)==null||s.call(r,n.data,p,h,w)}catch(x){Promise.reject(x)}try{(o=(i=k(this,lr)).onSettled)==null||o.call(i,n.data,null,p,h,w)}catch(x){Promise.reject(x)}}else if((n==null?void 0:n.type)==="error"){try{(c=(l=k(this,lr)).onError)==null||c.call(l,n.error,p,h,w)}catch(x){Promise.reject(x)}try{(f=(d=k(this,lr)).onSettled)==null||f.call(d,void 0,n.error,p,h,w)}catch(x){Promise.reject(x)}}}this.listeners.forEach(p=>{p(k(this,Lr))})})},Fg),Hn,Og,VS=(Og=class extends Di{constructor(t={}){super();ae(this,Hn);this.config=t,J(this,Hn,new Map)}build(t,n,r){const s=n.queryKey,i=n.queryHash??rh(s,n);let o=this.get(i);return o||(o=new AS({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){k(this,Hn).has(t.queryHash)||(k(this,Hn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=k(this,Hn).get(t.queryHash);n&&(t.destroy(),n===t&&k(this,Hn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ut.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return k(this,Hn).get(t)}getAll(){return[...k(this,Hn).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Qp(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>Qp(t,r)):n}notify(t){ut.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){ut.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ut.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Hn=new WeakMap,Og),Ye,Ar,Fr,Ci,ki,Or,Ei,Ni,Dg,WS=(Dg=class{constructor(e={}){ae(this,Ye);ae(this,Ar);ae(this,Fr);ae(this,Ci);ae(this,ki);ae(this,Or);ae(this,Ei);ae(this,Ni);J(this,Ye,e.queryCache||new VS),J(this,Ar,e.mutationCache||new BS),J(this,Fr,e.defaultOptions||{}),J(this,Ci,new Map),J(this,ki,new Map),J(this,Or,0)}mount(){yl(this,Or)._++,k(this,Or)===1&&(J(this,Ei,ih.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,Ye).onFocus())})),J(this,Ni,Ba.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,Ye).onOnline())})))}unmount(){var e,t;yl(this,Or)._--,k(this,Or)===0&&((e=k(this,Ei))==null||e.call(this),J(this,Ei,void 0),(t=k(this,Ni))==null||t.call(this),J(this,Ni,void 0))}isFetching(e){return k(this,Ye).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return k(this,Ar).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,Ye).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=k(this,Ye).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(qr(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return k(this,Ye).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=k(this,Ye).get(r.queryHash),i=s==null?void 0:s.state.data,o=kS(t,i);if(o!==void 0)return k(this,Ye).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return ut.batch(()=>k(this,Ye).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,Ye).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=k(this,Ye);ut.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=k(this,Ye);return ut.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=ut.batch(()=>k(this,Ye).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(Ft).catch(Ft)}invalidateQueries(e,t={}){return ut.batch(()=>(k(this,Ye).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=ut.batch(()=>k(this,Ye).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(Ft)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Ft)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=k(this,Ye).build(this,t);return n.isStaleByTime(qr(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ft).catch(Ft)}fetchInfiniteQuery(e){return e.behavior=em(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ft).catch(Ft)}ensureInfiniteQueryData(e){return e.behavior=em(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Ba.isOnline()?k(this,Ar).resumePausedMutations():Promise.resolve()}getQueryCache(){return k(this,Ye)}getMutationCache(){return k(this,Ar)}getDefaultOptions(){return k(this,Fr)}setDefaultOptions(e){J(this,Fr,e)}setQueryDefaults(e,t){k(this,Ci).set(_s(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...k(this,Ci).values()],n={};return t.forEach(r=>{Wo(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){k(this,ki).set(_s(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...k(this,ki).values()],n={};return t.forEach(r=>{Wo(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...k(this,Fr).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=rh(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===sh&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...k(this,Fr).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){k(this,Ye).clear(),k(this,Ar).clear()}},Ye=new WeakMap,Ar=new WeakMap,Fr=new WeakMap,Ci=new WeakMap,ki=new WeakMap,Or=new WeakMap,Ei=new WeakMap,Ni=new WeakMap,Dg),ax=u.createContext(void 0),vr=e=>{const t=u.useContext(ax);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},HS=({client:e,children:t})=>(u.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(ax.Provider,{value:e,children:t})),ux=u.createContext(!1),QS=()=>u.useContext(ux);ux.Provider;function KS(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var qS=u.createContext(KS()),GS=()=>u.useContext(qS),YS=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},XS=e=>{u.useEffect(()=>{e.clearReset()},[e])},JS=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||tx(n,[e.error,r])),ZS=e=>{if(e.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},eb=(e,t)=>e.isLoading&&e.isFetching&&!t,tb=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,nm=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function nb(e,t,n){var p,h,w,x,S;const r=QS(),s=GS(),i=vr(),o=i.defaultQueryOptions(e);(h=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||h.call(p,o),o._optimisticResults=r?"isRestoring":"optimistic",ZS(o),YS(o,s),XS(s);const l=!i.getQueryCache().get(o.queryHash),[c]=u.useState(()=>new t(i,o)),d=c.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(u.useSyncExternalStore(u.useCallback(C=>{const y=f?c.subscribe(ut.batchCalls(C)):Ft;return c.updateResult(),y},[c,f]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),u.useEffect(()=>{c.setOptions(o)},[o,c]),tb(o,d))throw nm(o,c,s);if(JS({result:d,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((x=(w=i.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||x.call(w,o,d),o.experimental_prefetchInRender&&!Is&&eb(d,r)){const C=l?nm(o,c,s):(S=i.getQueryCache().get(o.queryHash))==null?void 0:S.promise;C==null||C.catch(Ft).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?d:c.trackResult(d)}function gu(e,t){return nb(e,FS)}function rb(e,t){const n=vr(),[r]=u.useState(()=>new US(n,e));u.useEffect(()=>{r.setOptions(e)},[r,e]);const s=u.useSyncExternalStore(u.useCallback(o=>r.subscribe(ut.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=u.useCallback((o,l)=>{r.mutate(o,l).catch(Ft)},[r]);if(s.error&&tx(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}const cx=8,sb=6;function rm(e,t,n){return n<t?t:Math.min(n,Math.max(t,e))}function dx({x:e,y:t,menuWidth:n,menuHeight:r,viewport:s,margin:i=cx}){const o=i,l=i,c=s.width-Math.max(0,n)-i,d=s.height-Math.max(0,r)-i;return{x:rm(e,o,c),y:rm(t,l,d)}}function ib({anchorRect:e,menuSize:t,viewport:n,align:r="left",margin:s=cx,sideOffset:i=sb}){const o=r==="right"?e.right-t.width:e.left,l=e.bottom+i,c=e.top-t.height-i,d=l+t.height+s<=n.height,f=c>=s;return dx({x:o,y:!d&&f?c:l,menuWidth:t.width,menuHeight:t.height,viewport:n,margin:s})}function fx(){return typeof window>"u"?{width:1024,height:768}:{width:window.innerWidth,height:window.innerHeight}}function sm(e){return e.length>0&&"options"in e[0]}function im(){return{x:0,y:0,ready:!1}}function lh({value:e,onChange:t,options:n,placeholder:r="Select...",trigger:s,triggerClassName:i="",panelClassName:o="",align:l="left",width:c="auto",showChevron:d=!0,title:f,disabled:p=!1,"aria-label":h}){var q,Z;const[w,x]=u.useState(!1),S=u.useRef(null),C=u.useRef(null),y=u.useRef(null),[g,v]=u.useState(im),b=u.useCallback(()=>{const B=I=>{const R=I.find(T=>T.value===e);return R?R.label:null};if(sm(n))for(const I of n){const R=B(I.options);if(R)return R}else{const I=B(n);if(I)return I}return r},[e,n,r])(),E=((q=S.current)==null?void 0:q.getBoundingClientRect().width)??((Z=C.current)==null?void 0:Z.offsetWidth)??0,j=c==="trigger"?E:c==="auto"?void 0:c,M=u.useCallback(()=>{if(!w)return;const B=S.current,I=y.current;if(!B||!I)return;const R=B.getBoundingClientRect(),T=I.getBoundingClientRect(),L=j??T.width??180,O=T.height||I.scrollHeight||1,Q=ib({anchorRect:R,menuSize:{width:L,height:O},viewport:fx(),align:l});v(V=>V.x===Q.x&&V.y===Q.y&&V.ready?V:{x:Q.x,y:Q.y,ready:!0})},[l,j,w]);u.useLayoutEffect(()=>{if(!w){v(im());return}M()},[w,M,n,e]),u.useEffect(()=>{if(!w)return;const B=T=>{var O,Q;const L=T.target;(O=S.current)!=null&&O.contains(L)||(Q=y.current)!=null&&Q.contains(L)||x(!1)},I=T=>{var L;T.key==="Escape"&&(x(!1),(L=C.current)==null||L.focus())},R=()=>M();return window.addEventListener("click",B),window.addEventListener("keydown",I),window.addEventListener("resize",R),window.addEventListener("scroll",R,!0),()=>{window.removeEventListener("click",B),window.removeEventListener("keydown",I),window.removeEventListener("resize",R),window.removeEventListener("scroll",R,!0)}},[w,M]);const _=B=>{var I;t(B),x(!1),(I=C.current)==null||I.focus()},P=B=>B.map(I=>a.jsxs("button",{className:"dropdown-item","data-active":I.value===e,disabled:I.disabled,onClick:()=>!I.disabled&&_(I.value),role:"menuitem",children:[I.icon&&a.jsx("span",{className:"shrink-0",children:I.icon}),a.jsx("span",{className:"flex-1 truncate",children:I.label}),I.value===e&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0 text-accent",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})]},I.value)),U=u.useMemo(()=>({position:"fixed",left:g.x,top:g.y,visibility:g.ready?"visible":"hidden",...j?{width:j,minWidth:j}:{}}),[j,g]),F=w?a.jsx("div",{ref:y,className:`dropdown-panel ${o}`,style:U,role:"listbox","aria-label":h,children:sm(n)?n.map((B,I)=>a.jsxs("div",{children:[B.label&&a.jsx("div",{className:"dropdown-label",children:B.label}),P(B.options),I<n.length-1&&a.jsx("div",{className:"dropdown-divider"})]},B.label||I)):P(n)}):null;return a.jsxs("div",{ref:S,className:"relative",children:[s?a.jsx("div",{onClick:()=>!p&&x(B=>!B),children:s}):a.jsxs("button",{ref:C,type:"button",className:`dropdown-trigger ${i}`,onClick:()=>x(B=>!B),disabled:p,title:f,"aria-label":h,"aria-haspopup":"listbox","aria-expanded":w,children:[a.jsx("span",{className:"truncate",children:b}),d&&a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`shrink-0 opacity-60 transition-transform ${w?"rotate-180":""}`,children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),F&&typeof document<"u"?mu.createPortal(F,document.body):F]})}const ob={offline:"sync-dot-offline",unstable:"sync-dot-unstable",recent:"sync-dot-recent",editing:"sync-dot-editing",live:"sync-dot-live"};function lb({state:e,presence:t,syncLabel:n,connectionLabel:r,lastEditedLabel:s,hasEdits:i,localTypingActive:o,recentTouches:l,isNarrow:c}){const[d,f]=u.useState(!1),[p,h]=u.useState(null),w=u.useRef(null),x=u.useRef(null),S=u.useRef(null),C=t?`${t.viewing} viewing  ${t.editing} editing`:"- viewing  - editing",y=t?String(t.viewing):"-",g=u.useCallback(()=>{S.current&&(window.clearTimeout(S.current),S.current=null)},[]),v=u.useCallback((b,E)=>{var j;E&&((j=navigator.clipboard)==null||j.writeText(E).then(()=>{h(b),g(),S.current=window.setTimeout(()=>{h(M=>M===b?null:M)},1e3)}).catch(()=>{}))},[g]),m=u.useCallback(()=>{f(!1),window.requestAnimationFrame(()=>{var b;return(b=x.current)==null?void 0:b.focus()})},[]);return u.useEffect(()=>{if(!d)return;const b=j=>{!w.current||w.current.contains(j.target)||m()},E=j=>{j.key==="Escape"&&m()};return window.addEventListener("mousedown",b),window.addEventListener("keydown",E),()=>{window.removeEventListener("mousedown",b),window.removeEventListener("keydown",E)}},[d,m]),u.useEffect(()=>()=>{g()},[g]),a.jsxs("div",{ref:w,className:"sync-indicator",children:[a.jsxs("button",{ref:x,type:"button",className:"sync-indicator-button",onClick:()=>d?m():f(!0),"aria-haspopup":"dialog","aria-expanded":d,"aria-label":"Sync status",title:C,children:[a.jsx("span",{className:`sync-indicator-dot ${ob[e]}`,"aria-hidden":"true"}),!c&&a.jsx("span",{className:"sync-indicator-count tabular-nums",children:y}),!c&&o&&a.jsx("span",{className:"sync-indicator-local",children:"typing"})]}),d&&a.jsxs("div",{role:"dialog","aria-label":"Sync status",className:"sync-indicator-card select-text",children:[a.jsx("div",{className:"sync-indicator-line sync-indicator-primary",children:n}),a.jsx("div",{className:"sync-indicator-line",children:r}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:C}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:i?`Last edited: ${s}`:"No edits yet."}),o&&a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:"Local typing in progress (saved on blur)."}),a.jsxs("div",{className:"sync-indicator-section",children:[a.jsx("div",{className:"sync-indicator-section-title",children:"Recently touched files"}),l.length>0?a.jsx("div",{className:"sync-indicator-list",children:l.map(b=>a.jsxs("div",{className:"sync-indicator-item",children:[a.jsx("button",{type:"button",className:"sync-indicator-item-name",title:`Copy filename: ${b.label}`,onClick:()=>v(b.path,b.label),children:b.label}),a.jsx("span",{className:"sync-indicator-item-time tabular-nums",children:p===b.path?"Copied":b.timeLabel})]},b.path))}):a.jsx("div",{className:"sync-indicator-empty",children:"No recent touches."})]})]})]})}const Gr={phoneMax:480,mobileMax:767,narrowMax:900,tabletMax:1024,mediumMax:1180},aa={phone:`(max-width: ${Gr.phoneMax}px)`,narrow:`(max-width: ${Gr.narrowMax}px)`,toolbarCompact:`(max-width: ${Gr.mediumMax}px)`},om=200,lm=240,ab=320,ub=360,cb=420;function am(e,t,n){return Math.min(Math.max(e,t),n)}function db(e){return e<=Gr.tabletMax?ab:e<=Gr.mediumMax?ub:cb}function fb(e){return e<=Gr.tabletMax?360:e<=Gr.mediumMax?420:520}function hb({viewportWidth:e,leftOpen:t,rightOpen:n,leftWidth:r,rightWidth:s}){const i=db(e);let o=t?am(r,om,i):0,l=n?am(s,lm,i):0;const c=Math.max(0,e-fb(e));if(o+l>c){let d=o+l-c;if(l>0){const f=Math.max(0,l-lm),p=Math.min(f,d);l-=p,d-=p}if(d>0&&o>0){const f=Math.max(0,o-om),p=Math.min(f,d);o-=p,d-=p}d>0&&l>0&&(l=Math.max(0,c-o)),o+l>c&&(o=Math.max(0,c-l))}return{leftWidth:Number(o.toFixed(2)),rightWidth:Number(l.toFixed(2))}}function ua(e,t=!1){const[n,r]=u.useState(t);return u.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;const s=window.matchMedia(e),i=s,o=()=>r(s.matches);if(o(),typeof s.addEventListener=="function")return s.addEventListener("change",o),()=>s.removeEventListener("change",o);if(typeof i.addListener=="function"&&typeof i.removeListener=="function")return i.addListener(o),()=>{var l;return(l=i.removeListener)==null?void 0:l.call(i,o)}},[e]),n}function hx({isRandom:e,dir:t}){return e?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),a.jsx("path",{d:"M21 3v5h-5"})]}):t==="desc"?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 5v14"}),a.jsx("path",{d:"M19 12l-7 7-7-7"})]}):a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 19V5"}),a.jsx("path",{d:"M5 12l7-7 7 7"})]})}function pb({viewerActive:e,filtersOpen:t,filtersRef:n,totalFilterCount:r,filterCount:s,starFilterList:i,starCounts:o,onToggleFilters:l,onOpenFilters:c,onToggleStar:d,onClearFilters:f,onClearStars:p}){return a.jsxs("div",{ref:n,className:`toolbar-filter relative ${e?"opacity-40 pointer-events-none":""}`,children:[a.jsxs("button",{className:`btn ${r>0?"btn-active":""}`,onClick:l,"aria-haspopup":"dialog","aria-expanded":t,title:"Filters","aria-disabled":e,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),a.jsx("span",{className:"toolbar-filters-label",children:"Filters"}),r>0&&a.jsx("span",{className:"toolbar-filters-count px-1.5 py-0.5 text-[11px] rounded-full bg-accent-strong text-text",children:r})]}),t&&a.jsxs("div",{role:"dialog","aria-label":"Filters",className:"dropdown-panel w-[240px]",style:{top:"38px",left:0},children:[a.jsx("div",{className:"dropdown-label",children:"Rating"}),a.jsxs("div",{className:"px-1",children:[[5,4,3,2,1].map(h=>{const w=i.includes(h),x=(o==null?void 0:o[String(h)])??0;return a.jsxs("button",{onClick:()=>d==null?void 0:d(h),className:`dropdown-item justify-between ${w?"bg-accent-muted":""}`,children:[a.jsxs("span",{className:w?"text-star-active":"text-text",children:["".repeat(h),"".repeat(5-h)]}),a.jsx("span",{className:"text-xs text-muted",children:x})]},h)}),a.jsxs("button",{onClick:()=>d==null?void 0:d(0),className:`dropdown-item justify-between ${i.includes(0)?"bg-accent-muted":""}`,children:[a.jsx("span",{className:"text-text",children:"Unrated"}),a.jsx("span",{className:"text-xs text-muted",children:(o==null?void 0:o["0"])??0})]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("div",{className:"dropdown-label",children:"Metrics"}),a.jsxs("button",{className:"dropdown-item",onClick:()=>{l(),c==null||c()},children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]}),a.jsx("span",{children:"Open Metrics Panel"}),(s||0)>0&&a.jsxs("span",{className:"ml-auto text-xs text-muted",children:[s," active"]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("button",{className:"dropdown-item text-muted hover:text-text",onClick:()=>{f?f():p==null||p()},disabled:r===0,children:"Clear all filters"})]})]})}function mb({viewMode:e,currentSort:t,sortOnlyOptions:n,sortDisabled:r,sortControlsDisabled:s,sortDir:i,isRandom:o,showSelectModeToggle:l,multiSelectMode:c,selectModeLabel:d,uploadBusy:f,uploadDisabled:p,onViewMode:h,onSortChange:w,onToggleSortDir:x,onToggleMultiSelectMode:S,onUploadClick:C}){return a.jsx("div",{className:"mobile-drawer",children:a.jsxs("div",{className:"mobile-drawer-row",children:[a.jsxs("div",{className:"mobile-pill-group",children:[a.jsx("button",{className:`mobile-pill ${e==="grid"?"is-active":""}`,onClick:()=>h==null?void 0:h("grid"),"aria-pressed":e==="grid",children:"Grid"}),a.jsx("button",{className:`mobile-pill ${e==="adaptive"?"is-active":""}`,onClick:()=>h==null?void 0:h("adaptive"),"aria-pressed":e==="adaptive",children:"Masonry"})]}),a.jsx(lh,{value:t,onChange:y=>w==null?void 0:w(y),options:n,"aria-label":"Sort",triggerClassName:"mobile-pill mobile-pill-dropdown",panelClassName:"mobile-drawer-panel",disabled:r}),a.jsx("button",{className:`mobile-pill mobile-pill-icon ${s?"opacity-50 cursor-not-allowed":""}`,onClick:x,title:r?"Sorting disabled":o?"Shuffle":`Sort ${i==="desc"?"descending":"ascending"}`,"aria-label":o?"Shuffle":"Toggle sort direction","aria-disabled":s,disabled:s,children:a.jsx(hx,{isRandom:o,dir:i})}),l&&a.jsx("button",{className:`mobile-pill ${c?"is-active":""}`,onClick:()=>S==null?void 0:S(),"aria-pressed":c,title:c?"Exit select mode":"Enter select mode",children:d}),C&&a.jsx("button",{className:`mobile-pill ${p||f?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!p&&!f&&C(),disabled:p||f,children:f?"Uploading":"Upload"})]})})}function gb({rootRef:e,onSearch:t,viewerActive:n,onBack:r,zoomPercent:s,onZoomPercentChange:i,currentLabel:o,itemCount:l,totalCount:c,sortSpec:d,metricKeys:f,onSortChange:p,sortDisabled:h=!1,filterCount:w,onOpenFilters:x,starFilters:S,onToggleStar:C,onClearStars:y,onClearFilters:g,starCounts:v,viewMode:m,onViewMode:b,gridItemSize:E,onGridItemSize:j,leftOpen:M,rightOpen:_,onToggleLeft:P,onToggleRight:U,onPrevImage:F,onNextImage:q,canPrevImage:Z,canNextImage:B,searchDisabled:I=!1,searchPlaceholder:R,onUploadClick:T,uploadBusy:L=!1,uploadDisabled:O=!1,multiSelectMode:Q=!1,selectedCount:V=0,onToggleMultiSelectMode:A,syncIndicator:K}){const[W,X]=u.useState(!1),[ne,G]=u.useState(!1),D=u.useRef(null),he=u.useRef(null),ie=ua(aa.narrow),be=ua(aa.phone),Ce=ua(aa.toolbarCompact);u.useEffect(()=>{if(!W)return;const ke=qe=>{D.current&&!D.current.contains(qe.target)&&X(!1)};return window.addEventListener("click",ke),()=>window.removeEventListener("click",ke)},[W]),u.useEffect(()=>{if(I){G(!1);return}if(!ie||n){G(!1);return}if(!ne)return;const ke=window.requestAnimationFrame(()=>{var qe;return(qe=he.current)==null?void 0:qe.focus()});return()=>window.cancelAnimationFrame(ke)},[ie,ne,n,I]);const fe=d??{kind:"builtin",key:"added",dir:"desc"},$e=fe.dir,St=fe.kind==="builtin"&&fe.key==="random",dt=n||h,Cn=f!=null&&f.length?f.map(ke=>({value:`metric:${ke}`,label:ke,disabled:h})):[],dn=[{value:"builtin:added",label:"Date added",disabled:h},{value:"builtin:name",label:"Filename",disabled:h},{value:"builtin:random",label:"Random",disabled:h},...Cn],zn=[{label:"Layout",options:[{value:"layout:grid",label:"Grid"},{value:"layout:masonry",label:"Masonry"}]},{label:"Sort by",options:dn}],fn=fe.kind==="metric"?`metric:${fe.key}`:`builtin:${fe.key}`,re=[{label:"Sort by",options:dn}],se=ie&&!n,Me=!(!!n&&Ce),ge=!!n&&!be,de=se&&!!A,Je=Q?V>0?`Done (${V})`:"Done":"Select",Ze=ke=>{if(ke.startsWith("layout:")){const qe=ke==="layout:masonry"?"adaptive":"grid";b==null||b(qe)}else{if(h)return;p==null||p(um(ke,fe))}},bt=()=>{!p||h||p(St?fe:{...fe,dir:$e==="desc"?"asc":"desc"})},Ke=S??[],Yt=Ke.length,xr=vb(w,Yt),kn=yb(l,c),En=o||"Root";return a.jsxs("div",{ref:e,className:`toolbar-shell ${n?"toolbar-shell-viewer":""} ${be?"toolbar-shell-phone":""} ${Ce?"toolbar-shell-compact":""} fixed top-0 left-0 right-0 h-12 grid grid-cols-[minmax(0,1fr)_minmax(0,1fr)_auto] items-center px-3 gap-3 bg-panel border-b border-border z-[var(--z-toolbar)] col-span-full row-start-1 select-none`,children:[a.jsxs("div",{className:"toolbar-left flex items-center gap-4 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope flex items-center gap-3 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope-text flex flex-col min-w-0 leading-tight",children:[a.jsx("span",{className:"toolbar-scope-label text-[10px] uppercase tracking-widest text-muted",children:"Scope"}),a.jsx("span",{className:"text-sm font-medium text-text truncate",title:En,children:En})]}),kn&&a.jsx("span",{className:"toolbar-count text-xs text-muted whitespace-nowrap tabular-nums",children:kn})]}),n&&a.jsxs("button",{className:"toolbar-back-btn btn btn-sm",onClick:r,title:"Back to grid",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]}),Me&&a.jsxs("div",{className:"toolbar-sort flex items-center gap-2",children:[a.jsxs("div",{className:`toolbar-sort-controls flex items-center gap-2 ${n?"opacity-40 pointer-events-none":""}`,children:[a.jsx(lh,{value:fn,onChange:Ze,options:zn,title:"Sort and layout options","aria-label":"Sort and layout",triggerClassName:"min-w-[110px]"}),a.jsx("button",{className:"toolbar-sort-dir btn btn-icon",onClick:bt,title:h?"Sorting disabled":St?"Shuffle":`Sort ${$e==="desc"?"descending":"ascending"}`,"aria-label":St?"Shuffle":"Toggle sort direction","aria-disabled":dt,disabled:dt,children:a.jsx(hx,{isRandom:St,dir:$e})})]}),a.jsx(pb,{viewerActive:!!n,filtersOpen:W,filtersRef:D,totalFilterCount:xr,filterCount:w,starFilterList:Ke,starCounts:v,onToggleFilters:()=>X(ke=>!ke),onOpenFilters:x,onToggleStar:C,onClearFilters:g,onClearStars:y})]})]}),a.jsx("div",{className:"toolbar-center flex items-center gap-3 justify-center min-w-0",children:n?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"range",min:5,max:800,step:1,value:Math.round(Math.max(5,Math.min(800,s??100))),onChange:ke=>i==null?void 0:i(Number(ke.target.value)),className:"zoom-slider","aria-label":"Zoom level"}),a.jsxs("span",{className:"text-xs text-muted min-w-[42px] text-right",children:[Math.round(s??100),"%"]})]}):j&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-muted",children:"Size"}),a.jsx("input",{type:"range",min:80,max:500,step:10,value:E??220,onChange:ke=>j(Number(ke.target.value)),className:"w-28 h-1.5 bg-border rounded-full appearance-none cursor-pointer hover:bg-hover transition-colors [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-text [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-text [&::-moz-range-thumb]:border-0","aria-label":"Thumbnail size"})]})}),a.jsxs("div",{className:"toolbar-right flex items-center gap-2 justify-end",children:[ge&&a.jsxs("div",{className:"toolbar-nav flex items-center gap-1 mr-1",children:[a.jsx("button",{className:`btn btn-icon ${Z?"":"opacity-40 cursor-not-allowed"}`,title:"Previous image (A / )",onClick:()=>Z&&(F==null?void 0:F()),"aria-label":"Previous image","aria-disabled":!Z,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("button",{className:`btn btn-icon ${B?"":"opacity-40 cursor-not-allowed"}`,title:"Next image (D / )",onClick:()=>B&&(q==null?void 0:q()),"aria-label":"Next image","aria-disabled":!B,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 6l6 6-6 6"})})})]}),a.jsxs("div",{className:"toolbar-panels flex items-center gap-1",children:[a.jsx("button",{className:`btn btn-icon ${M?"":"opacity-50"}`,title:M?"Hide left panel (Ctrl+B)":"Show left panel (Ctrl+B)",onClick:P,"aria-pressed":M,"aria-label":"Toggle left panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"11",y:"5",width:"10",height:"14",rx:"1.5"})]})}),a.jsx("button",{className:`btn btn-icon ${_?"":"opacity-50"}`,title:_?"Hide right panel (Ctrl+Alt+B)":"Show right panel (Ctrl+Alt+B)",onClick:U,"aria-pressed":_,"aria-label":"Toggle right panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"15",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"3",y:"5",width:"10",height:"14",rx:"1.5"})]})})]}),!n&&T&&a.jsxs("button",{className:`btn ${O?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!O&&T(),"aria-label":"Upload images",title:L?"Uploading":"Upload images","aria-disabled":O||L,disabled:O||L,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M12 16V5"}),a.jsx("path",{d:"M7 10l5-5 5 5"}),a.jsx("path",{d:"M4 19h16"})]}),a.jsx("span",{children:L?"Uploading":"Upload"})]}),K&&a.jsx(lb,{...K,isNarrow:ie||Ce}),!n&&ie&&a.jsx("button",{className:`btn btn-icon ${ne?"btn-active":""} ${I?"opacity-50 cursor-not-allowed":""}`,"aria-label":ne?"Close search":"Open search",title:I?"Search disabled":ne?"Close search":"Search",onClick:()=>!I&&G(ke=>!ke),disabled:I,children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"11",cy:"11",r:"7"}),a.jsx("path",{d:"M21 21l-4.35-4.35"})]})}),!n&&!ie?a.jsx("div",{className:"toolbar-search toolbar-search-desktop w-[240px]",children:a.jsx("input",{ref:he,"aria-label":"Search filename, tags, notes",placeholder:I?R??"Search disabled":"Search...",onChange:ke=>t(ke.target.value),className:"toolbar-search-input input w-full focus:w-full transition-all duration-200 select-text",disabled:I})}):null]}),!n&&ie&&ne&&!I&&a.jsx("div",{className:"toolbar-search-row",children:a.jsx("input",{ref:he,"aria-label":"Search filename, tags, notes",placeholder:R??"Search...",onChange:ke=>t(ke.target.value),className:"toolbar-search-input-mobile input input-lg w-full select-text"})}),se&&a.jsx(mb,{viewMode:m,currentSort:fn,sortOnlyOptions:re,sortDisabled:h,sortControlsDisabled:dt,sortDir:$e,isRandom:St,showSelectModeToggle:de,multiSelectMode:Q,selectModeLabel:Je,uploadBusy:L,uploadDisabled:O,onViewMode:b,onSortChange:ke=>p==null?void 0:p(um(ke,fe)),onToggleSortDir:bt,onToggleMultiSelectMode:A,onUploadClick:T})]})}function yb(e,t){if(typeof e!="number")return null;const n=e.toLocaleString();if(typeof t!="number")return`${n} items`;const r=t.toLocaleString();return t===e?`${n} items`:`${n} / ${r} items`}function vb(e,t){return typeof e=="number"?e:t>0?1:0}function um(e,t){if(e.startsWith("metric:")){const n=e.slice(7);return n?{kind:"metric",key:n,dir:t.dir}:t}if(e.startsWith("builtin:")){const n=e.slice(8);if(n==="name"||n==="added"||n==="random")return{kind:"builtin",key:n,dir:t.dir}}return t}class ln extends Error{constructor(n,r,s,i){super(r);lt(this,"status");lt(this,"url");lt(this,"body");this.name="FetchError",this.status=n,this.url=s,this.body=i}}function xb(e){const t=e.trim();return t.startsWith("{")||t.startsWith("[")}function px(e,t,n){if(t&&typeof t=="object"){const r=t,s=typeof r.error=="string"?r.error:null,i=typeof r.message=="string"?r.message:null;if(s&&i)return`${s}: ${i}`;if(s)return s;if(i)return i}return typeof t=="string"&&t?t:`HTTP ${e} for ${n}`}function yt(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{let c=null;const d=await l.text().catch(()=>"");if(d)if((l.headers.get("content-type")||"").includes("application/json")||xb(d))try{c=JSON.parse(d)}catch{c=d}else c=d;if(!l.ok)throw new ln(l.status,px(l.status,c,e),e,c);return c}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}function to(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{if(!l.ok){const c=await l.text().catch(()=>""),d=c||null;throw new ln(l.status,px(l.status,d,e),e,d)}return l.blob()}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}class mx{constructor(t){lt(this,"store",new Map);lt(this,"inflight",new Map);lt(this,"totalBytes",0);this.maxBytes=t}getMaxBytes(){return this.maxBytes}getTotalBytes(){return this.totalBytes}getSize(){return this.store.size}has(t){return this.store.has(t)}isInflight(t){return this.inflight.has(t)}get(t){const n=this.store.get(t);if(n)return this.store.delete(t),this.store.set(t,n),n.blob}evictIfNeeded(t){for(;this.totalBytes+t>this.maxBytes&&this.store.size>0;){const n=this.store.keys().next().value;if(n==null)break;const r=this.store.get(n);r&&(this.totalBytes-=r.size),this.store.delete(n)}}set(t,n){const r=n.size||0;if(!(r>this.maxBytes)){if(this.store.has(t)){const s=this.store.get(t);this.totalBytes-=s.size,this.store.delete(t)}this.evictIfNeeded(r),this.store.set(t,{blob:n,size:r}),this.totalBytes+=r}}async getOrFetch(t,n){const r=this.get(t);if(r)return r;const s=this.inflight.get(t);if(s)return s.promise;const i=n(),o=typeof i=="object"&&"promise"in i,l=o?i.promise:i,c=o?i.abort:void 0,d=l.then(f=>(this.set(t,f),f)).finally(()=>{this.inflight.delete(t)});return this.inflight.set(t,{promise:d,abort:c}),d}prefetch(t,n){if(this.store.has(t)||this.inflight.has(t))return;const r=n(),s=typeof r=="object"&&"promise"in r,i=s?r.promise:r,o=s?r.abort:void 0,l=i.then(c=>(this.set(t,c),c)).catch(()=>new Blob).finally(()=>{this.inflight.delete(t)});this.inflight.set(t,{promise:l,abort:o})}cancelPrefetch(t){const n=this.inflight.get(t);if(n!=null&&n.abort)try{n.abort()}catch{}this.inflight.delete(t)}clear(){for(const[t,n]of this.inflight)if(n.abort)try{n.abort()}catch{}this.inflight.clear(),this.store.clear(),this.totalBytes=0}evictPrefix(t){const n=(()=>{const s=t?`/${t.replace(/^\/+/,"")}`:"/";return s==="/"?"/":s.replace(/\/+$/,"")})(),r=s=>{const i=s.startsWith("/")?s.replace(/\/+$/,""):`/${s.replace(/\/+$/,"")}`;return n==="/"?!0:i===n||i.startsWith(`${n}/`)};for(const[s,i]of Array.from(this.store.entries()))r(s)&&(this.totalBytes-=i.size,this.store.delete(s));for(const[s,i]of Array.from(this.inflight.entries()))if(r(s)){if(i.abort)try{i.abort()}catch{}this.inflight.delete(s)}this.totalBytes<0&&(this.totalBytes=0)}}const Ks=new mx(60*1024*1024),$d=new mx(20*1024*1024),Co={hydrationStart:e=>`lenslet:browse:hydration:start:${e}`,hydrationComplete:e=>`lenslet:browse:hydration:complete:${e}`,firstThumb:e=>`lenslet:browse:first-thumb:${e}`,firstThumbLatency:e=>`lenslet:browse:first-thumb-latency:${e}`},We={activeRequestId:null,activeHydrationStartedAtMs:null,firstThumbnailLatencyMs:null,firstThumbnailPath:null,requestBudget:null,hydration:null};function Ho(){return typeof performance<"u"&&typeof performance.now=="function"?performance.now():Date.now()}function ah(e){if(!(typeof performance>"u"||typeof performance.mark!="function"))try{performance.mark(e)}catch{}}function wb(e,t,n){if(!(typeof performance>"u"||typeof performance.measure!="function"))try{performance.measure(e,t,n)}catch{}}function zi(){typeof window>"u"||(window.__lensletBrowseHotpath=Sb())}function Sb(){return{firstThumbnailLatencyMs:We.firstThumbnailLatencyMs,firstThumbnailPath:We.firstThumbnailPath,requestBudget:We.requestBudget?{...We.requestBudget}:null,hydration:We.hydration?{...We.hydration}:null}}function bb(e){We.requestBudget={...e},zi()}function Cb(e){We.activeRequestId=e.requestId,We.activeHydrationStartedAtMs=Ho(),We.firstThumbnailLatencyMs=null,We.firstThumbnailPath=null,We.hydration={...e,completed:!1,updatedAtMs:Ho()},ah(Co.hydrationStart(e.requestId)),zi()}function kb(e){We.activeRequestId===e.requestId&&(We.hydration={...e,completed:!1,updatedAtMs:Ho()},zi())}function Eb(e){We.activeRequestId===e&&(We.hydration&&(We.hydration={...We.hydration,completed:!0,updatedAtMs:Ho()}),ah(Co.hydrationComplete(e)),zi())}function cm(e){const t=We.activeRequestId,n=We.activeHydrationStartedAtMs;if(t==null||n==null||We.firstThumbnailLatencyMs!=null)return;const r=Math.max(0,Ho()-n);We.firstThumbnailLatencyMs=Math.round(r),We.firstThumbnailPath=e;const s=Co.firstThumb(t);ah(s),wb(Co.firstThumbLatency(t),Co.hydrationStart(t),s),zi()}zi();const Nb=["folders","thumb","file"],vc={folders:2,thumb:8,file:3};let dm=1;const It={folders:{limit:vc.folders,inflight:new Map,queued:[],peakInflight:0},thumb:{limit:vc.thumb,inflight:new Map,queued:[],peakInflight:0},file:{limit:vc.file,inflight:new Map,queued:[],peakInflight:0}};function Ua(){if(typeof DOMException<"u")return new DOMException("request aborted","AbortError");const e=new Error("request aborted");return e.name="AbortError",e}function jb(){return{limits:{folders:It.folders.limit,thumb:It.thumb.limit,file:It.file.limit},inflight:{folders:It.folders.inflight.size,thumb:It.thumb.inflight.size,file:It.file.inflight.size},queued:{folders:It.folders.queued.length,thumb:It.thumb.queued.length,file:It.file.queued.length},peakInflight:{folders:It.folders.peakInflight,thumb:It.thumb.peakInflight,file:It.file.peakInflight},updatedAtMs:Date.now()}}function ls(){bb(jb())}function fm(e){const t=It[e];for(;t.inflight.size<t.limit&&t.queued.length>0;){const n=t.queued.shift();if(!n)break;n.start()}}function no(e,t){const n=It[e],r=dm;dm+=1;let s=!1,i=!1,o=null;return{promise:new Promise((d,f)=>{const p=()=>{i&&(i=!1,n.inflight.delete(r),fm(e),ls())},h=()=>{if(s||i)return;i=!0;let w;try{w=t()}catch(x){s=!0,p(),f(x);return}o={id:r,abort:w.abort,reject:f},n.inflight.set(r,o),n.peakInflight=Math.max(n.peakInflight,n.inflight.size),ls(),w.promise.then(x=>{s||(s=!0,p(),d(x))},x=>{s||(s=!0,p(),f(x))})};if(n.inflight.size<n.limit){h();return}n.queued.push({id:r,start:h,reject:f}),ls()}),abort:()=>{if(s)return;if(s=!0,i){if(n.inflight.delete(r),o!=null&&o.abort)try{o.abort()}catch{}o==null||o.reject(Ua()),fm(e),ls();return}const d=n.queued.findIndex(f=>f.id===r);if(d>=0){const[f]=n.queued.splice(d,1);f.reject(Ua()),ls()}}}}function Mb(e=Nb){for(const t of e){const n=It[t];for(const s of Array.from(n.inflight.values())){if(s.abort)try{s.abort()}catch{}s.reject(Ua())}n.inflight.clear();const r=n.queued.splice(0,n.queued.length);for(const s of r)s.reject(Ua())}ls()}ls();const xc={};function Pb(){const e=xc==null?void 0:xc.VITE_API_BASE,t=typeof window<"u",n=t?window.location.origin:"http://localhost",r=t?window.location.hostname:"localhost",s=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\]|.+\.localhost)$/i.test(r);if(!e)return"";let i;try{i=new URL(e,n)}catch{return""}const o=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\])$/i.test(i.hostname);return s?i.origin:o?"":i.origin}const Ue=Pb();const Rb=40*1024*1024;function Tb(e){return e==="viewer"||e==="compare"}function hm(e){return`${Ue}/thumb?path=${encodeURIComponent(e)}`}function pm(e){return`${Ue}/file?path=${encodeURIComponent(e)}`}const wc="lenslet.client_id",mm="lenslet.client_id.session",gx="lenslet.last_event_id",Ib=1e3,_b=3e4,Lb=5;let Bd=null,ca=null,gm=0,fi=null,hi=0,yu=!0,Va=!1;function yx(){return typeof window<"u"&&typeof EventSource<"u"}function ym(e,t){if(!e)return null;try{return e.getItem(t)}catch{return null}}function vm(e,t,n){if(e)try{e.setItem(t,n)}catch{}}function Ab(e,t){if(e)try{e.removeItem(t)}catch{}}function Fb(){if(typeof navigator>"u")return"server";const e=navigator.userAgent||"",t=navigator.language||"",n=navigator.platform||"",r=typeof Intl<"u"&&Intl.DateTimeFormat().resolvedOptions().timeZone||"",s=typeof screen<"u"?`${screen.width}x${screen.height}x${screen.colorDepth}`:"";return[e,t,n,r,s].join("|")}function Ob(e){let t=2166136261;for(let n=0;n<e.length;n+=1)t^=e.charCodeAt(n),t=t*16777619>>>0;return t.toString(16).padStart(8,"0")}function xm(){return typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`client_${Math.random().toString(36).slice(2,10)}_${Date.now()}`}function ro(e){return Bd=e,e}function Wa(e){if(typeof window>"u")return null;try{return e==="local"?window.localStorage:window.sessionStorage}catch{return null}}function Li(){if(Bd)return Bd;const e=Wa("local"),t=Wa("session"),n=ym(t,mm);if(n)return ro(n);const r=ym(e,wc);if(t){const i=xm();return vm(t,mm,i),r&&Ab(e,wc),ro(i)}if(r)return ro(r);if(e){const i=xm();return vm(e,wc,i),ro(i)}const s=`fp_${Ob(Fb())}_${Math.random().toString(36).slice(2,8)}`;return ro(s)}function vu(e="lenslet"){gm+=1;const t=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`nonce_${Math.random().toString(36).slice(2,10)}_${Date.now()}_${gm}`;return`${e}:${Li()}:${t}`}function Db(){if(ca!=null)return ca;if(typeof window>"u")return null;const e=Wa("local");if(!e)return null;try{const t=e.getItem(gx);if(!t)return null;const n=Number(t);return!Number.isFinite(n)||n<=0?null:(ca=n,n)}catch{return null}}function zb(e){if(!Number.isFinite(e)||e<=0||(ca=e,typeof window>"u"))return;const t=Wa("local");if(t)try{t.setItem(gx,String(e))}catch{}}function $b(){if(typeof window>"u")return`${Ue}/events`;const e=new URL(`${Ue}/events`,window.location.origin),t=Db();return t!=null&&Number.isFinite(t)&&e.searchParams.set("last_event_id",String(t)),e.toString()}function Bb(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}let Rn=null,vx="idle";const Ud=new Set,Vd=new Set,Wd=new Set;function pi(e){vx=e;for(const t of Vd)t(e)}function uh(e){if(Va!==e){Va=e;for(const t of Wd)t(e)}}function ch(){fi!=null&&(window.clearTimeout(fi),fi=null)}function Ub(){hi=0,ch()}function Vb(){if(!yu||fi!=null)return;hi+=1;const e=Math.min(Ib*Math.pow(2,hi-1),_b);hi>=Lb?(pi("offline"),uh(!0)):pi("reconnecting"),fi=window.setTimeout(()=>{fi=null,xx()},e)}function xx(){if(!yu||!yx()||(Rn&&Rn.readyState===EventSource.CLOSED&&(Rn.close(),Rn=null),Rn))return;hi>0?pi("reconnecting"):pi("connecting");const e=new EventSource($b());Rn=e;const t=n=>r=>{const s=Bb(r.data);if(!s)return;const i=r.lastEventId?Number(r.lastEventId):null,o=i!=null&&Number.isFinite(i)?i:null;o!=null&&zb(o);for(const l of Ud)l({type:n,id:o,data:s})};e.addEventListener("item-updated",t("item-updated")),e.addEventListener("metrics-updated",t("metrics-updated")),e.addEventListener("presence",t("presence")),e.onopen=()=>{Ub(),uh(!1),pi("live")},e.onerror=()=>{Rn===e&&(e.close(),Rn=null,Vb())}}function Wb(){yu=!0,yx()&&(ch(),xx())}function Hb(){yu=!1,ch(),hi=0,Rn&&(Rn.close(),Rn=null),uh(!1),pi("offline")}function Qb(e){return Ud.add(e),()=>{Ud.delete(e)}}function Kb(e){return Vd.add(e),e(vx),()=>{Vd.delete(e)}}function qb(e){return Wd.add(e),e(Va),()=>{Wd.delete(e)}}function Gb(){return Va}function wm(e){Mb(e)}function Yb(e,t){const n=JSON.stringify(t),r=`${Ue}${e}`;if(typeof navigator<"u"&&typeof navigator.sendBeacon=="function")try{if(navigator.sendBeacon(r,new Blob([n],{type:"application/json"})))return!0}catch{}if(typeof fetch!="function")return!1;try{return fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0}),!0}catch{return!1}}function Xb(e,t,n){return Yb("/presence/leave",{gallery_id:e,lease_id:t,client_id:n??Li()})}function Fl(e){return e??Li()}function Ol(e,t){return yt(`${Ue}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).promise}function Jb(e,t){const n=new URLSearchParams({path:e});return(t==null?void 0:t.page)!=null&&n.set("page",String(t.page)),(t==null?void 0:t.pageSize)!=null&&n.set("page_size",String(t.pageSize)),t!=null&&t.recursive&&n.set("recursive","1"),n.toString()}const pe={getFolder:(e,t)=>no("folders",()=>yt(`${Ue}/folders?${Jb(e,t)}`)).promise,search:(e,t)=>{const n=new URLSearchParams;return e&&n.set("q",e),t&&n.set("path",t),yt(`${Ue}/search?${n}`).promise},getEmbeddings:()=>yt(`${Ue}/embeddings`).promise,searchEmbeddings:e=>yt(`${Ue}/embeddings/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,refreshFolder:e=>{const t=new URLSearchParams({path:e});return yt(`${Ue}/refresh?${t}`,{method:"POST"}).promise},getSidecar:e=>yt(`${Ue}/item?path=${encodeURIComponent(e)}`).promise,patchSidecar:(e,t,n)=>{const s={"Content-Type":"application/json","Idempotency-Key":(n==null?void 0:n.idempotencyKey)??vu("patch"),"x-client-id":Li(),"x-updated-by":"web"};return(n==null?void 0:n.ifMatch)!=null&&(s["If-Match"]=String(n.ifMatch)),yt(`${Ue}/item?path=${encodeURIComponent(e)}`,{method:"PATCH",headers:s,body:JSON.stringify(t)}).promise},getMetadata:e=>yt(`${Ue}/metadata?path=${encodeURIComponent(e)}`).promise,putSidecar:(e,t)=>yt(`${Ue}/item?path=${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json","x-client-id":Li(),"x-updated-by":"web"},body:JSON.stringify(t)}).promise,getHealth:()=>yt(`${Ue}/health`).promise,joinPresence:(e,t,n)=>Ol("/presence/join",{gallery_id:e,client_id:Fl(n),lease_id:t}),movePresence:(e,t,n,r)=>Ol("/presence/move",{from_gallery_id:e,to_gallery_id:t,client_id:Fl(r),lease_id:n}),leavePresence:(e,t,n)=>Ol("/presence/leave",{gallery_id:e,client_id:Fl(n),lease_id:t}),postPresence:(e,t,n)=>Ol("/presence",{gallery_id:e,client_id:Fl(n),lease_id:t}),getThumb:e=>$d.getOrFetch(e,()=>no("thumb",()=>to(hm(e)))),prefetchThumb:e=>{$d.prefetch(e,()=>no("thumb",()=>to(hm(e))))},getFile:e=>Ks.getOrFetch(e,()=>no("file",()=>to(pm(e)))),exportComparison:e=>to(`${Ue}/export-comparison`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,prefetchFile:async(e,t)=>{if(Tb(t)&&!(Ks.has(e)||Ks.isInflight(e)))try{const n=await no("file",()=>to(pm(e),{headers:{"x-lenslet-prefetch":t}})).promise;n.size<=Rb&&Ks.set(e,n)}catch{}},cancelPrefetch:e=>{Ks.cancelPrefetch(e)},uploadFile:async(e,t)=>{const n=new FormData;return n.append("dest",e),n.append("file",t),yt(`${Ue}/file`,{method:"POST",body:n,timeoutMs:6e4}).promise},moveFile:async(e,t)=>{const n=new FormData;return n.append("src",e),n.append("dest",t),yt(`${Ue}/move`,{method:"POST",body:n}).promise},deleteFiles:async e=>yt(`${Ue}/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paths:e})}).promise,exportIntent:async e=>{const t=new FormData;return t.append("path",e),yt(`${Ue}/export-intent`,{method:"POST",body:t}).promise},getViews:()=>yt(`${Ue}/views`).promise,saveViews:e=>yt(`${Ue}/views`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise};class Zb{constructor(t=400){lt(this,"cache",new Map);lt(this,"maxSize");this.maxSize=t,typeof window<"u"&&window.addEventListener("beforeunload",()=>this.clear(),{once:!0})}get(t){const n=this.cache.get(t);return n&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){for(this.cache.has(t)&&this.cache.delete(t);this.cache.size>=this.maxSize;){const r=this.cache.keys().next().value;if(r===void 0)break;const s=this.cache.get(r);if(this.cache.delete(r),s)try{URL.revokeObjectURL(s)}catch{}}this.cache.set(t,n)}clear(){for(const t of this.cache.values())try{URL.revokeObjectURL(t)}catch{}this.cache.clear()}}const Sc=new Zb(400);function eC({path:e,name:t,onClick:n,selected:r,highlighted:s,highlightKey:i,displayW:o,displayH:l,ioRoot:c,isScrolling:d,priority:f}){const p=u.useRef(null),[h,w]=u.useState(()=>Sc.get(e)??null),[x,S]=u.useState(!1),[C,y]=u.useState(()=>!!h);u.useEffect(()=>{const v=p.current;if(!v)return;const m=new IntersectionObserver(b=>{for(const E of b)E.target===v&&S(E.isIntersecting||E.intersectionRatio>0)},{root:c??null,rootMargin:"200px 0px",threshold:.01});return m.observe(v),()=>{m.unobserve(v),m.disconnect()}},[c]),u.useEffect(()=>{if(h||!(x&&!d||f))return;let v=!0;return pe.getThumb(e).then(m=>{if(!v)return;const b=URL.createObjectURL(m);Sc.set(e,b),w(b)}).catch(()=>{}),()=>{v=!1}},[e,h,x,d,f]),u.useEffect(()=>{var m;if(!h){y(!1);return}const v=(m=p.current)==null?void 0:m.querySelector("img");v&&v.complete&&v.naturalWidth>0?(y(!0),cm(e)):y(!1)},[h]),u.useEffect(()=>{w(Sc.get(e)??null)},[e]);const g=["absolute inset-0 relative bg-hover border border-border rounded-lg overflow-hidden select-none",r?"outline-2 outline-accent":"",s?"thumb-updated-ring":"","hover:outline hover:outline-1 hover:outline-accent"].filter(Boolean).join(" ");return a.jsx("div",{ref:p,"data-highlight-key":i??void 0,className:g,onClick:n,children:h?a.jsx("img",{className:`w-full h-full object-cover block pointer-events-none select-none opacity-0 transition-opacity duration-[160ms] ${C?"opacity-100":""}`,src:h,alt:t,loading:"lazy",decoding:"async",onLoad:()=>{y(!0),cm(e)},width:o?Math.round(o):void 0,height:l?Math.round(l):void 0}):null})}function Ws(e,t,n){let r=n.initialDeps??[],s,i=!0;function o(){var l,c,d;let f;n.key&&((l=n.debug)!=null&&l.call(n))&&(f=Date.now());const p=e();if(!(p.length!==r.length||p.some((x,S)=>r[S]!==x)))return s;r=p;let w;if(n.key&&((c=n.debug)!=null&&c.call(n))&&(w=Date.now()),s=t(...p),n.key&&((d=n.debug)!=null&&d.call(n))){const x=Math.round((Date.now()-f)*100)/100,S=Math.round((Date.now()-w)*100)/100,C=S/16,y=(g,v)=>{for(g=String(g);g.length<v;)g=" "+g;return g};console.info(`%c ${y(S,5)} /${y(x,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*C,120))}deg 100% 31%);`,n==null?void 0:n.key)}return n!=null&&n.onChange&&!(i&&n.skipInitialOnChange)&&n.onChange(s),i=!1,s}return o.updateDeps=l=>{r=l},o}function Sm(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const tC=(e,t)=>Math.abs(e-t)<1.01,nC=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},bm=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},rC=e=>e,sC=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},iC=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=o=>{const{width:l,height:c}=o;t({width:Math.round(l),height:Math.round(c)})};if(s(bm(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(o=>{const l=()=>{const c=o[0];if(c!=null&&c.borderBoxSize){const d=c.borderBoxSize[0];if(d){s({width:d.inlineSize,height:d.blockSize});return}}s(bm(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},Cm={passive:!0},km=typeof window>"u"?!0:"onscrollend"in window,oC=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&km?()=>{}:nC(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),o=f=>()=>{const{horizontal:p,isRtl:h}=e.options;s=p?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,f)},l=o(!0),c=o(!1);c(),n.addEventListener("scroll",l,Cm);const d=e.options.useScrollendEvent&&km;return d&&n.addEventListener("scrollend",c,Cm),()=>{n.removeEventListener("scroll",l),d&&n.removeEventListener("scrollend",c)}},lC=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},aC=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const o=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class uC{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:rC,rangeExtractor:sC,onChange:()=>{},measureElement:lC,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=Ws(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let o=r-1;o>=0;o--){const l=n[o];if(s.has(l.lane))continue;const c=i.get(l.lane);if(c==null||l.end>c.end?i.set(l.lane,l):l.end<c.end&&s.set(l.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=Ws(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(n,r,s,i,o,l)=>(this.prevLanes!==void 0&&this.prevLanes!==l&&(this.lanesChangedFlag=!0),this.prevLanes=l,this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=Ws(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l},c)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>n)for(const h of this.laneAssignments.keys())h>=n&&this.laneAssignments.delete(h);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(h=>{this.itemSizeCache.set(h.key,h.size)}));const d=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===n&&(this.lanesSettling=!1);const f=this.measurementsCache.slice(0,d),p=new Array(l).fill(void 0);for(let h=0;h<d;h++){const w=f[h];w&&(p[w.lane]=h)}for(let h=d;h<n;h++){const w=i(h),x=this.laneAssignments.get(h);let S,C;if(x!==void 0&&this.options.lanes>1){S=x;const m=p[S],b=m!==void 0?f[m]:void 0;C=b?b.end+this.options.gap:r+s}else{const m=this.options.lanes===1?f[h-1]:this.getFurthestMeasurement(f,h);C=m?m.end+this.options.gap:r+s,S=m?m.lane:h%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(h,S)}const y=c.get(w),g=typeof y=="number"?y:this.options.estimateSize(h),v=C+g;f[h]={index:h,start:C,size:g,end:v,key:w,lane:S},p[S]=h}return this.measurementsCache=f,f},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Ws(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?cC({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=Ws(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,o)=>i===null||o===null?[]:n({startIndex:i,endIndex:o,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==n&&(l&&this.observer.unobserve(l),this.observer.observe(n),this.elementsCache.set(o,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,o=r-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,o,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=Ws(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,o=n.length;i<o;i++){const l=n[i],c=r[l];s.push(c)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return Sm(r[wx(0,r.length-1,s=>Sm(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),o=this.getScrollOffset();r==="auto"&&(r=n>=o+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),o=this.getScrollOffset();if(r==="auto")if(s.end>=o+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=o+this.options.scrollPaddingStart)r="start";else return[o,r];const l=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),n=Math.max(0,Math.min(n,this.options.count-1));let i=0;const o=10,l=d=>{if(!this.targetWindow)return;const f=this.getOffsetForIndex(n,d);if(!f){console.warn("Failed to get offset for index:",n);return}const[p,h]=f;this._scrollToOffset(p,{adjustments:void 0,behavior:s}),this.targetWindow.requestAnimationFrame(()=>{const w=this.getScrollOffset(),x=this.getOffsetForIndex(n,h);if(!x){console.warn("Failed to get offset for index:",n);return}tC(x[0],w)||c(h)})},c=d=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(d)):console.warn(`Failed to scroll to index ${n} after ${o} attempts.`))};l(r)},this.scrollBy=(n,{behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=r.length-1;for(;o>=0&&i.some(l=>l===null);){const l=r[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}s=Math.max(...i.filter(l=>l!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(t)}}const wx=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function cC({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=c=>e[c].start;if(e.length<=r)return{startIndex:0,endIndex:s};let o=wx(0,s,i,n),l=o;if(r===1)for(;l<s&&e[l].end<n+t;)l++;else if(r>1){const c=Array(r).fill(0);for(;l<s&&c.some(f=>f<n+t);){const f=e[l];c[f.lane]=f.end,l++}const d=Array(r).fill(n+t);for(;o>=0&&d.some(f=>f>=n);){const f=e[o];d[f.lane]=f.start,o--}o=Math.max(0,o-o%r),l=Math.min(s,l+(r-1-l%r))}return{startIndex:o,endIndex:l}}const Em=typeof document<"u"?u.useLayoutEffect:u.useEffect;function dC(e){const t=u.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var o;i?mu.flushSync(t):t(),(o=e.onChange)==null||o.call(e,s,i)}},[r]=u.useState(()=>new uC(n));return r.setOptions(n),Em(()=>r._didMount(),[]),Em(()=>r._willUpdate()),r}function fC(e){return dC({observeElementRect:iC,observeElementOffset:oC,scrollToFn:aC,...e})}function hC({containerW:e,gap:t,targetCell:n,aspect:r,captionH:s}){const i=Math.max(1,Math.floor((e+t)/(n+t))),o=(e-t*(i-1))/i,l=o*r.h/r.w,c=l+s+t;return{columns:i,cellW:o,mediaH:l,rowH:c}}const pC=1.333;function mC({items:e,containerWidth:t,targetHeight:n,gap:r,captionH:s}){if(t<=0)return[];const i=[];let o=[],l=0;const c=(d,f)=>({index:i.length,height:f+s+r,imageH:f,items:d.map(p=>({item:p.item,displayW:p.aspect*f,displayH:f,originalIndex:p.originalIndex}))});for(let d=0;d<e.length;d++){const f=e[d],p=f.w>0&&f.h>0?f.w/f.h:pC;o.push({item:f,aspect:p,originalIndex:d}),l+=p;const h=(o.length-1)*r;if(l*n+h>=t){const x=(t-h)/l;i.push(c(o,x)),o=[],l=0}}return o.length>0&&i.push(c(o,n)),i}function gC(e,t,n){return{mode:"adaptive",rows:mC({items:t,containerWidth:e,targetHeight:n.targetCell,gap:n.gap,captionH:n.captionH})}}function yC(e,t,n){const{columns:r,cellW:s,mediaH:i,rowH:o}=hC({containerW:e,gap:n.gap,targetCell:n.targetCell,aspect:n.aspect,captionH:n.captionH}),l=Math.ceil(t.length/Math.max(1,r));return{mode:"grid",columns:r,cellW:s,mediaH:i,rowH:o,rowCount:l}}function vC(e,t,n){const[r,s]=u.useState(0);u.useLayoutEffect(()=>{const c=e.current;if(!c)return;const d=()=>{const p=getComputedStyle(c),h=c.clientWidth-parseFloat(p.paddingLeft)-parseFloat(p.paddingRight);s(h)},f=new ResizeObserver(d);return f.observe(c),d(),()=>f.disconnect()},[]);const i=u.useMemo(()=>n.viewMode==="adaptive"?gC(r,t,n):yC(r,t,n),[r,t,n.viewMode,n.gap,n.targetCell,n.aspect.w,n.aspect.h,n.captionH]),o=fC({count:i.mode==="adaptive"?i.rows.length:i.rowCount,getScrollElement:()=>e.current,estimateSize:c=>i.mode==="adaptive"?i.rows[c].height:i.rowH,overscan:8}),l=o.getVirtualItems();return u.useEffect(()=>{o.measure()},[i,o]),{width:r,layout:i,rowVirtualizer:o,virtualRows:l}}function xC(e,t,n,r){if(!e.length)return null;const s=n?e.findIndex(l=>l.path===n):0,i=Math.max(1,t);let o=s;if(r.key==="ArrowRight"||r.key==="d")o=Math.min(e.length-1,s+1);else if(r.key==="ArrowLeft"||r.key==="a")o=Math.max(0,s-1);else if(r.key==="ArrowDown"||r.key==="s")o=Math.min(e.length-1,s+i);else if(r.key==="ArrowUp"||r.key==="w")o=Math.max(0,s-i);else return r.key==="Enter"&&n?"open":null;return o}function wC(e,t,n){if(e.length===0)return[];const r=Array.from(new Set(e.map(d=>d.index))).sort((d,f)=>d-f),s=r[0],i=r[r.length-1],o=t.mode==="adaptive"?Math.max(0,t.rows.length-1):Math.max(0,Math.ceil(n.length/Math.max(1,t.columns))-1),l=[s-1,i+1].filter(d=>d>=0&&d<=o);if(l.length===0)return[];const c=[];for(const d of l){if(t.mode==="adaptive"){const h=t.rows[d];if(!h)continue;for(const w of h.items)c.push(w.item.path);continue}const f=d*t.columns,p=n.slice(f,f+t.columns);for(const h of p)c.push(h.path)}return Array.from(new Set(c))}function SC(e,t){var s,i;let n=0,r=e.length-1;for(;n<=r;){const o=n+r>>1,l=e[o],c=((s=l.items[0])==null?void 0:s.originalIndex)??-1,d=((i=l.items[l.items.length-1])==null?void 0:i.originalIndex)??-1;if(t>=c&&t<=d)return o;t<c?r=o-1:n=o+1}return 0}function bC(e,t,n){const r=new Set;for(const s of n){if(t.mode==="adaptive"){const l=t.rows[s.index];if(!l)continue;for(const c of l.items)r.add(c.item.path);continue}const i=s.index*t.columns,o=Math.min(e.length,i+t.columns);for(let l=i;l<o;l+=1){const c=e[l];c&&r.add(c.path)}}return r}function CC(e,t,n,r){var o,l,c;const s=EC(n,r);if(!s)return null;if(t.mode==="adaptive")return((l=(o=t.rows[s.index])==null?void 0:o.items[0])==null?void 0:l.item.path)??null;const i=s.index*t.columns;return((c=e[i])==null?void 0:c.path)??null}function kC(e,t,n){let r=null,s=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;for(const o of e)o.path&&(o.bottom<=t||o.top>=n||o.top>s||o.top===s&&o.left>=i||(r=o.path,s=o.top,i=o.left));return r}function EC(e,t){if(e.length===0)return null;const n=Math.max(0,t);for(const r of e){const s=r.start??0;if((r.end??s+(r.size??0))>n)return r}return e[0]}function NC({selectionToken:e,appliedSelectionToken:t,selectedPath:n,topAnchorToken:r,appliedTopAnchorToken:s,topAnchorPath:i,hasPath:o}){const l=e??0;if(l>0&&l!==t&&n&&o(n))return{source:"selection",path:n,token:l};const c=r??0;return c>0&&c!==s&&i&&o(i)?{source:"top-anchor",path:i,token:c}:null}function jC({path:e,pathToIndex:t,layout:n,adaptiveRowMeta:r}){var o;const s=t.get(e);if(s==null||s<0)return null;const i=n.mode==="grid"?Math.floor(s/Math.max(1,n.columns)):SC(n.rows,s);return n.mode==="grid"?i*n.rowH:((o=r==null?void 0:r[i])==null?void 0:o.start)??0}const MC=500,PC=450,RC=600,TC=8;function IC(e){return Math.max(PC,Math.min(RC,e))}class _C{constructor(t){lt(this,"delayMs");lt(this,"moveTolerancePx");lt(this,"onLongPress");lt(this,"onCancel");lt(this,"timerId",null);lt(this,"activePointerId",null);lt(this,"startX",0);lt(this,"startY",0);lt(this,"lastEvent",null);lt(this,"fired",!1);this.delayMs=IC(t.delayMs??MC),this.moveTolerancePx=Math.max(0,t.moveTolerancePx??TC),this.onLongPress=t.onLongPress,this.onCancel=t.onCancel}pointerDown(t){return(t.pointerType??"mouse")==="mouse"?!1:t.isPrimary===!1?(this.cancel("multitouch"),!1):this.activePointerId!=null&&this.activePointerId!==t.pointerId?(this.cancel("multitouch"),!1):(this.activePointerId=t.pointerId,this.startX=t.clientX,this.startY=t.clientY,this.lastEvent=t,this.fired=!1,this.clearTimer(),this.timerId=setTimeout(()=>{this.activePointerId==null||this.fired||this.lastEvent==null||(this.fired=!0,this.clearTimer(),this.onLongPress(this.lastEvent))},this.delayMs),!0)}pointerMove(t){if(!this.matchesPointer(t.pointerId)||this.fired)return;this.lastEvent=t;const n=t.clientX-this.startX,r=t.clientY-this.startY;Math.hypot(n,r)>this.moveTolerancePx&&this.cancel("movement")}pointerUp(t){if(!(t!=null&&!this.matchesPointer(t))){if(!this.fired){this.cancel("pointerup");return}this.reset()}}pointerCancel(t){t!=null&&!this.matchesPointer(t)||this.cancel("pointercancel")}cancelFromScroll(){this.cancel("scroll")}destroy(){this.cancel("cleanup")}matchesPointer(t){return this.activePointerId!=null&&this.activePointerId===t}clearTimer(){this.timerId!=null&&(clearTimeout(this.timerId),this.timerId=null)}reset(){this.clearTimer(),this.activePointerId=null,this.lastEvent=null,this.fired=!1}cancel(t){var r;const n=this.timerId!=null&&!this.fired&&t!=="cleanup";this.reset(),n&&((r=this.onCancel)==null||r.call(this,t))}}function LC(e){return e==="touch"||e==="pen"}function AC(e){return e.multiSelectMode||e.isShift||e.isToggle||!LC(e.pointerType)?!1:e.selectedPaths.length===1&&e.selectedPaths[0]===e.path}function Nm(e,t){return e.includes(t)?e.filter(n=>n!==t):[...e,t]}const er=12,FC=44,OC={w:4,h:3},DC=350,zC=120;function $C(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function jm(e){return{pointerId:e.pointerId,pointerType:e.pointerType,clientX:e.clientX,clientY:e.clientY,isPrimary:e.isPrimary}}function BC(e,t){const n=(t??"").trim();if(!n)return e;const r=e.toLowerCase().indexOf(n.toLowerCase());if(r===-1)return e;const s=e.slice(0,r),i=e.slice(r,r+n.length),o=e.slice(r+n.length);return a.jsxs(a.Fragment,{children:[s,a.jsx("mark",{className:"bg-accent/20 text-inherit rounded px-0.5",children:i}),o]})}function UC(e){if(!e)return null;const t=e.getBoundingClientRect(),n=Array.from(e.querySelectorAll('[role="gridcell"][id^="cell-"]')).map(r=>{const s=r.getBoundingClientRect(),i=r.id.startsWith("cell-")?r.id.slice(5):"";let o="";try{o=i?decodeURIComponent(i):""}catch{o=""}return{path:o,top:s.top,left:s.left,bottom:s.bottom}});return kC(n,t.top,t.bottom)}function VC({items:e,selected:t,restoreToSelectionToken:n,restoreToTopAnchorToken:r,restoreToTopAnchorPath:s,multiSelectMode:i=!1,onSelectionChange:o,onOpenViewer:l,onContextMenuItem:c,onOpenItemActions:d,highlight:f,recentlyUpdated:p,onVisiblePathsChange:h,onTopAnchorPathChange:w,suppressSelectionHighlight:x=!1,viewMode:S="grid",targetCellSize:C=220,scrollRef:y,hideScrollbar:g=!1}){const[v,m]=u.useState(null),[b,E]=u.useState(null),[j,M]=u.useState(!1),[_,P]=u.useState(null),[U,F]=u.useState(null),q=u.useRef(null),Z=u.useRef(null),B=u.useRef(null),I=y??B,R=u.useRef(null),T=u.useRef(0),L=u.useRef(0),O=u.useRef(new Set),Q=u.useRef(null),V=u.useRef(null),A=u.useRef(null),K=u.useRef(null),W=u.useRef(null),X=u.useRef({path:null,pointerType:null}),ne=C,{width:G,layout:D,rowVirtualizer:he,virtualRows:ie}=vC(I,e,{gap:er,targetCell:ne,aspect:OC,captionH:FC,viewMode:S}),be=u.useMemo(()=>{const z=new Map;for(let Y=0;Y<e.length;Y++)z.set(e[Y].path,Y);return z},[e]),Ce=u.useMemo(()=>{if(D.mode!=="adaptive")return null;const z=new Map;return D.rows.forEach((Y,ue)=>{let we=0;Y.items.forEach((Ee,Pe)=>{const oe=we+Ee.displayW/2;z.set(Ee.item.path,{row:ue,center:oe,order:Pe}),we+=Ee.displayW+er})}),z},[D]);u.useEffect(()=>{if(!t.length)return;const z=t[0];_!==z&&P(z)},[t,_]);const fe=u.useMemo(()=>{if(D.mode!=="adaptive")return null;let z=0;return D.rows.map(Y=>{const ue=z;return z+=Y.height,{start:ue,height:Y.height}})},[D]),$e=u.useRef(null),St=(z,Y)=>{try{if($e.current!=null){try{cancelAnimationFrame($e.current)}catch{}$e.current=null}const ue=z.scrollTop,we=Y-ue;if(Math.abs(we)<1){z.scrollTop=Y;return}const Ee=140,Pe=performance.now(),oe=me=>1-Math.pow(1-me,3),Ne=me=>{const it=Math.min(1,(me-Pe)/Ee),Fe=oe(it);z.scrollTop=ue+we*Fe,it<1?$e.current=requestAnimationFrame(Ne):$e.current=null};$e.current=requestAnimationFrame(Ne)}catch{z.scrollTop=Y}},[dt,Cn]=u.useState(!1);u.useEffect(()=>{const z=I.current;if(!z)return;let Y=0;const ue=()=>{var we;(we=V.current)==null||we.cancelFromScroll(),Cn(!0),window.clearTimeout(Y),Y=window.setTimeout(()=>Cn(!1),zC)};return z.addEventListener("scroll",ue,{passive:!0}),()=>z.removeEventListener("scroll",ue)},[]),u.useEffect(()=>{const z=new _C({onLongPress:Y=>{const ue=A.current;if(!ue||!d)return;const we=K.current??{x:Y.clientX,y:Y.clientY};d(ue,we),W.current={path:ue,untilMs:Date.now()+700}}});return V.current=z,()=>{z.destroy(),V.current===z&&(V.current=null)}},[d]);const dn=()=>{Z.current!=null&&(window.clearTimeout(Z.current),Z.current=null)},zn=()=>{if(dn(),M(!1),m(null),q.current){try{URL.revokeObjectURL(q.current)}catch{}q.current=null}E(null)},fn=z=>{dt||(dn(),m(z),M(!1),Z.current=window.setTimeout(async()=>{Z.current=null;try{const Y=await pe.getFile(z),ue=URL.createObjectURL(Y);if(q.current)try{URL.revokeObjectURL(q.current)}catch{}q.current=ue,E(ue),M(!0)}catch{}},DC))},re=D.mode==="grid"?D.columns:Math.max(1,Math.floor(G/(ne+er))),se=(z,Y)=>{if(D.mode!=="adaptive")return null;const ue=D.rows[z];if(!ue)return null;let we=0,Ee=null;for(const Pe of ue.items){const oe=we+Pe.displayW/2,Ne=Math.abs(oe-Y);(!Ee||Ne<Ee.dist)&&(Ee={path:Pe.item.path,dist:Ne}),we+=Pe.displayW+er}return Ee?Ee.path:null},xe=(z,Y)=>{var Fe,gt,Zt,Nn;if(!e.length)return null;const ue=z??e[0].path;if(D.mode!=="adaptive"){const en=xC(e,re,ue,Y);return en==="open"||en==null?en:((Fe=e[en])==null?void 0:Fe.path)??null}const we=Ce==null?void 0:Ce.get(ue);if(!we)return ue;const Ee=be.get(ue)??0,Pe=Y.key;if(Pe==="Enter")return"open";if(Pe==="ArrowRight"||Pe==="d")return((gt=e[Math.min(e.length-1,Ee+1)])==null?void 0:gt.path)??ue;if(Pe==="ArrowLeft"||Pe==="a")return((Zt=e[Math.max(0,Ee-1)])==null?void 0:Zt.path)??ue;const oe=Pe==="ArrowDown"||Pe==="s"?1:Pe==="ArrowUp"||Pe==="w"?-1:0;if(oe===0)return null;const Ne=we.row+oe;if(Ne<0||Ne>=(((Nn=D.rows)==null?void 0:Nn.length)??0))return ue;const me=we.center;return se(Ne,me)??ue},Me=z=>{var Y;try{(Y=document.getElementById(`cell-${encodeURIComponent(z)}`))==null||Y.focus()}catch{}},ge=u.useCallback(z=>{try{pe.prefetchThumb(z)}catch{}},[]),de=u.useCallback((z,Y)=>{d==null||d(z,Y)},[d]),Je=()=>{A.current=null,K.current=null},Ze=(z,Y)=>{var ue;Y.target.closest("[data-grid-action]")||(X.current={path:z,pointerType:Y.pointerType},!i&&(A.current=z,K.current={x:Y.clientX,y:Y.clientY},(ue=V.current)==null||ue.pointerDown(jm(Y))))},bt=z=>{var Y;i||(K.current={x:z.clientX,y:z.clientY},(Y=V.current)==null||Y.pointerMove(jm(z)))},Ke=z=>{var Y;i||((Y=V.current)==null||Y.pointerUp(z.pointerId),Je())},Yt=z=>{var Y;i||((Y=V.current)==null||Y.pointerCancel(z.pointerId),Je())},xr=(z,Y)=>{const ue=W.current;if(ue&&ue.path===z&&ue.untilMs>Date.now()){W.current=null,Me(z);return}ue&&ue.untilMs<=Date.now()&&(W.current=null),P(z),F(z);const we=!!Y.shiftKey,Ee=!!(Y.ctrlKey||Y.metaKey);if(i)o(Nm(t,z)),R.current=z;else if(AC({pointerType:X.current.path===z?X.current.pointerType:null,multiSelectMode:i,isShift:we,isToggle:Ee,selectedPaths:t,path:z}))o([z]),R.current=z,l(z);else if(we){const Pe=R.current??_??t[0]??z,oe=be.get(Pe)??e.findIndex(me=>me.path===Pe),Ne=be.get(z)??e.findIndex(me=>me.path===z);if(oe!==-1&&Ne!==-1){const me=Math.min(oe,Ne),it=Math.max(oe,Ne),Fe=e.slice(me,it+1).map(gt=>gt.path);if(Ee){const gt=new Set(t);for(const Zt of Fe)gt.add(Zt);o(Array.from(gt))}else o(Fe)}else o([z])}else Ee?(o(Nm(t,z)),R.current=z):(o([z]),R.current=z);dt||ge(z),Me(z)},kn=(z,Y)=>{var ue,we;try{const Ee=En.has(z)&&t.length>0?t:[z];(ue=Y.dataTransfer)==null||ue.setData("application/x-lenslet-paths",JSON.stringify(Ee)),Y.dataTransfer&&(Y.dataTransfer.effectAllowed="copyMove");try{document.body.classList.add("drag-active")}catch{}const oe=Y.currentTarget.querySelector(".cell-content img"),Ne=document.createElement("div");Ne.className="drag-ghost";const me=document.createElement("img");me.draggable=!1,me.alt="drag",oe&&oe.src&&(me.src=oe.src),Ne.appendChild(me),document.body.appendChild(Ne);const it=Ne.getBoundingClientRect().width||150;(we=Y.dataTransfer)==null||we.setDragImage(Ne,Math.round(it/2),0);const Fe=()=>{try{Ne.remove()}catch{}try{document.body.classList.remove("drag-active")}catch{}window.removeEventListener("dragend",Fe),window.removeEventListener("pointerup",Fe),document.removeEventListener("visibilitychange",Fe)};window.addEventListener("dragend",Fe),window.addEventListener("pointerup",Fe),document.addEventListener("visibilitychange",Fe)}catch{}};u.useEffect(()=>{const z=I.current;if(!z)return;const Y=ue=>{var Fe,gt,Zt;const we=xe(U,ue);if(we==null)return;if(ue.preventDefault(),we==="open"){U&&l(U);return}const Ee=e.find(Nn=>Nn.path===we);if(!Ee)return;F(Ee.path),P(Ee.path),o([Ee.path]),R.current=Ee.path;const Pe=D.mode==="grid"?Math.floor((be.get(Ee.path)??0)/Math.max(1,D.columns)):((Fe=Ce==null?void 0:Ce.get(Ee.path))==null?void 0:Fe.row)??0,oe=z.scrollTop,Ne=oe+z.clientHeight,me=D.mode==="adaptive"?((gt=fe==null?void 0:fe[Pe])==null?void 0:gt.start)??0:Pe*D.rowH,it=D.mode==="adaptive"?me+(((Zt=fe==null?void 0:fe[Pe])==null?void 0:Zt.height)??0):me+D.rowH;(me<oe||it>Ne)&&St(z,me),Me(Ee.path)};return z.addEventListener("keydown",Y),()=>{z.removeEventListener("keydown",Y)}},[e,U,re,l,D,Ce,fe,be]),u.useLayoutEffect(()=>{const z=I.current;if(!z)return;const Y=NC({selectionToken:n,appliedSelectionToken:T.current,selectedPath:t[0]??null,topAnchorToken:r,appliedTopAnchorToken:L.current,topAnchorPath:s??null,hasPath:we=>be.has(we)});if(!Y)return;const ue=jC({path:Y.path,pathToIndex:be,layout:D,adaptiveRowMeta:fe});if(ue!=null){try{z.scrollTop=ue}catch{}if(Y.source==="selection"){T.current=Y.token;return}L.current=Y.token}},[n,r,s,t,be,D,fe]);const En=u.useMemo(()=>new Set(t),[t]),ke=!!(v&&b&&j),qe=u.useMemo(()=>wC(ie,D,e),[e,D,ie]);u.useEffect(()=>{if(!(dt||qe.length===0))for(const z of qe)ge(z)},[dt,qe,ge]),u.useEffect(()=>{var z;(z=I.current)==null||z.focus()},[]),u.useEffect(()=>{var z;if(x){try{(z=I.current)==null||z.blur()}catch{}F(null)}},[x]);const Xt=u.useMemo(()=>bC(e,D,ie),[e,D,ie]),Jt=u.useMemo(()=>{var Y;const z=UC(I.current);return z||CC(e,D,ie,((Y=I.current)==null?void 0:Y.scrollTop)??0)},[e,D,ie,I]);u.useEffect(()=>{h&&($C(O.current,Xt)||(O.current=Xt,h(Xt)))},[h,Xt]),u.useEffect(()=>{w&&Q.current!==Jt&&(Q.current=Jt,w(Jt))},[w,Jt]);const ns=U?`cell-${encodeURIComponent(U)}`:void 0;return a.jsx("div",{role:"grid","aria-label":"Gallery",className:`relative h-full overflow-auto p-3 outline-none ${g?"scrollbar-hidden pr-4":"scrollbar-thin"} ${ke?"cursor-zoom-in":""}`,ref:I,tabIndex:0,"aria-activedescendant":ns,onMouseDown:()=>{var z;return(z=I.current)==null?void 0:z.focus()},style:{"--gap":`${er}px`},children:a.jsxs("div",{className:"relative w-full",style:{height:he.getTotalSize()},children:[ie.map(z=>{var Pe;let Y=[],ue={},we="";if(D.mode==="adaptive"){const oe=D.rows[z.index];if(!oe)return null;Y=oe.items,ue={height:oe.height,transform:`translate3d(0, ${z.start}px, 0)`,display:"flex",gap:er,paddingBottom:er},we="absolute top-0 left-0 right-0 w-full will-change-transform"}else{const oe=z.index*D.columns;Y=e.slice(oe,oe+D.columns).map(me=>({item:me,displayW:D.cellW,displayH:D.mediaH})),ue={transform:`translate3d(0, ${z.start}px, 0)`,gridTemplateColumns:`repeat(${D.columns}, minmax(0, 1fr))`,gap:er,paddingBottom:er},we="absolute top-0 left-0 right-0 w-full grid will-change-transform"}const Ee=z.index===((Pe=ie[0])==null?void 0:Pe.index);return a.jsx("div",{className:we,role:"row",style:ue,children:Y.map(({item:oe,displayW:Ne,displayH:me})=>{const it=!x&&(_===oe.path||En.has(oe.path)),Fe=(p==null?void 0:p.get(oe.path))??null,gt=Fe!=null,Zt=D.mode==="adaptive"?{width:Ne}:{},Nn=D.mode==="adaptive"?{height:me}:{},en=D.mode==="adaptive"?"relative rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group shrink-0":"relative aspect-[4/3] rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group";return a.jsxs("div",{id:`cell-${encodeURIComponent(oe.path)}`,className:`relative min-w-0 ${it?"outline outline-2 outline-accent outline-offset-2 rounded-[10px]":""}`,role:"gridcell","aria-selected":it,tabIndex:U===oe.path?0:-1,onFocus:()=>F(oe.path),draggable:!0,style:Zt,onDragStart:et=>kn(oe.path,et),onPointerDown:et=>Ze(oe.path,et),onPointerMove:bt,onPointerUp:Ke,onPointerCancel:Yt,onContextMenu:et=>{et.preventDefault(),et.stopPropagation(),c==null||c(et,oe.path)},children:[a.jsxs("div",{className:en,style:Nn,onDoubleClick:()=>{i||l(oe.path)},onMouseLeave:zn,children:[a.jsx("button",{type:"button",className:"grid-item-action-btn touch-manipulation","data-grid-action":"1","aria-label":`Open actions for ${oe.name}`,"aria-haspopup":"menu",onPointerDown:et=>et.stopPropagation(),onClick:et=>{et.stopPropagation();const rs=et.currentTarget.getBoundingClientRect();de(oe.path,{x:rs.right-4,y:rs.bottom-4})},children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})}),a.jsx("div",{className:"cell-content absolute inset-0",children:a.jsx(eC,{path:oe.path,name:oe.name,selected:it,highlighted:gt,highlightKey:Fe,displayW:Ne,displayH:me,ioRoot:I.current,isScrolling:dt,priority:Ee,onClick:et=>xr(oe.path,et)})}),a.jsx("div",{className:"absolute right-0 bottom-0 w-7 h-7 cursor-zoom-in",onMouseEnter:()=>fn(oe.path),onMouseLeave:zn,children:a.jsx("div",{className:"grid-item-preview-corner absolute right-0 bottom-0 h-[18px] w-[18px] flex items-center justify-center text-text select-none",style:{clipPath:'path("M0 9C0 4.02944 4.02944 0 9 0H18V18H0V9Z")',background:"linear-gradient(135deg, rgba(18,18,18,0.9) 0%, rgba(34,34,34,0.9) 60%, rgba(22,22,22,0.9) 100%)",borderTop:"1px solid rgba(255,255,255,0.08)",borderLeft:"1px solid rgba(255,255,255,0.08)",boxShadow:"0 1px 2px rgba(0,0,0,0.45)",backdropFilter:"blur(1px)"},children:a.jsxs("svg",{width:"11",height:"11",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round",className:"text-[#d9dce2]","aria-hidden":"true",style:{transform:"translate(0px,0px)"},children:[a.jsx("circle",{cx:"11",cy:"11",r:"5.4"}),a.jsx("path",{d:"M15.5 15.5 L19 19"})]})})})]}),a.jsxs("div",{className:"flex flex-col items-center text-center gap-0 mt-1 px-0.5 text-white/90",children:[a.jsx("div",{className:"text-sm leading-[18px] thumb-filename line-clamp-2 break-words hyphens-auto text-center",title:oe.name,children:BC(oe.name,f)}),a.jsxs("div",{className:"text-[11px] leading-[15px] opacity-70",children:[oe.w,"  ",oe.h]})]})]},oe.path)})},z.key)}),v&&b&&j&&mu.createPortal(a.jsx("div",{className:"toolbar-offset fixed inset-0 z-[999] flex items-center justify-center pointer-events-none bg-black/20 opacity-100",children:a.jsx("img",{src:b,alt:"preview",className:"max-w-[80vw] max-h-[80vh] object-contain opacity-[0.98]"})}),document.body)]},`${S}-${re}`)})}const WC=48,HC=[.1,.24,.5,.74,.9];function QC({items:e,metricKey:t,scrollRef:n,sortDir:r}){const{orderedValues:s,numericValues:i}=u.useMemo(()=>{var P;const M=[],_=[];for(const U of e){const F=(P=U.metrics)==null?void 0:P[t],q=F==null||Number.isNaN(F)?null:F;M.push(q),q!=null&&_.push(q)}return{orderedValues:M,numericValues:_}},[e,t]),o=u.useMemo(()=>KC(i,WC),[i]),l=u.useMemo(()=>qC(i,HC),[i]),[c,d]=u.useState(0),[f,p]=u.useState(null),[h,w]=u.useState(!1),x=u.useRef(null);if(u.useEffect(()=>{const M=n.current;if(!M)return;const _=()=>{const P=Math.max(1,M.scrollHeight-M.clientHeight),U=fs(P>0?M.scrollTop/P:0);d(U)};return _(),M.addEventListener("scroll",_,{passive:!0}),window.addEventListener("resize",_),()=>{M.removeEventListener("scroll",_),window.removeEventListener("resize",_)}},[n,e.length]),u.useEffect(()=>{p(null)},[t,e.length]),!o)return null;const S={min:o.min,max:o.max},C=f!=null?Pm(f):null,y=Pm(c),g=r==="desc",v=u.useMemo(()=>f==null?null:XC(s,f),[s,f]);function m(M){p(fs(M))}function b(){p(null)}function E(M){const _=n.current;if(!_)return;const P=Math.max(0,_.scrollHeight-_.clientHeight);_.scrollTop=fs(M)*P}function j(M){var P;const _=(P=x.current)==null?void 0:P.getBoundingClientRect();return _?fs((M.clientY-_.top)/_.height):null}return a.jsxs("div",{className:"absolute right-0 top-3 bottom-3 w-[14px] flex items-stretch pointer-events-auto",children:[a.jsxs("svg",{ref:x,viewBox:"0 0 10 100",preserveAspectRatio:"none",className:"w-full h-full rounded bg-surface-inset border border-border/60 cursor-ns-resize",onPointerDown:M=>{var P;M.preventDefault();const _=j(M);_!=null&&(w(!0),m(_),E(_),(P=x.current)==null||P.setPointerCapture(M.pointerId))},onPointerMove:M=>{const _=j(M);if(_==null){h||b();return}m(_),h&&E(_)},onPointerUp:M=>{var _;w(!1),(_=x.current)==null||_.releasePointerCapture(M.pointerId)},onPointerLeave:()=>{h||b()},children:[GC(o.bins,"var(--border-strong)",{flip:g}),YC(l,S,{flip:g,color:"var(--muted)"}),Mm(y,{color:"var(--highlight)",strokeWidth:.8}),C!=null&&Mm(C,{color:"var(--text-secondary)",strokeWidth:.6,dashed:!0})]}),v!=null&&f!=null&&a.jsx("div",{className:"pointer-events-none absolute right-full mr-2 px-1.5 py-0.5 rounded border border-border bg-surface text-[10px] text-text shadow",style:{top:`calc(${(f*100).toFixed(2)}% - 8px)`},children:ZC(v)})]})}function KC(e,t){if(!e.length)return null;const n=Math.min(...e);let r=Math.max(...e);n===r&&(r=n+1);const s=new Array(t).fill(0),i=t/(r-n);for(const o of e){const l=Math.max(0,Math.min(t-1,Math.floor((o-n)*i)));s[l]+=1}return{bins:s,min:n,max:r}}function qC(e,t){if(!e.length)return[];const n=[...e].sort((s,i)=>s-i),r=n.length-1;return t.map(s=>{const i=r*s,o=Math.floor(i),l=Math.ceil(i);if(o===l)return n[o];const c=i-o;return n[o]+(n[l]-n[o])*c})}function GC(e,t,n){const r=Math.max(1,...e),s=100/e.length,i=(n==null?void 0:n.flip)??!1;return e.map((o,l)=>{const c=Math.max(.8,o/r*10),d=(i?e.length-1-l:l)*s;return a.jsx("rect",{x:10-c,y:d,width:c,height:Math.max(.2,s-.2),fill:t,opacity:.9},`sb-${l}`)})}function YC(e,t,n){const r=(n==null?void 0:n.flip)??!1,s=n==null?void 0:n.color;return e.map((i,o)=>{const l=JC(i,t,r),c=o===2;return a.jsx("line",{x1:0,y1:l,x2:10,y2:l,stroke:s,strokeWidth:c?.8:.5,opacity:c?.9:.6,vectorEffect:"non-scaling-stroke"},`qt-${o}-${i}`)})}function Mm(e,t){return a.jsx("line",{x1:0,y1:e,x2:10,y2:e,stroke:t.color,strokeWidth:t.strokeWidth??.6,strokeDasharray:t.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}function XC(e,t){if(!e.length)return null;const n=Math.round(fs(t)*(e.length-1)),r=e[n];if(r!=null)return r;for(let s=1;s<e.length;s++){const i=n-s;if(i>=0&&e[i]!=null)return e[i];const o=n+s;if(o<e.length&&e[o]!=null)return e[o]}return null}function JC(e,t,n){const r=t.max-t.min;if(r===0)return 0;const s=fs((e-t.min)/r);return(n?1-s:s)*100}function Pm(e){return fs(e)*100}function fs(e){return e<0?0:e>1?1:e}function ZC(e){if(e==null||Number.isNaN(e))return"-";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function hs(e,t){const[n,r]=u.useState(null),s=u.useRef(null);return u.useEffect(()=>{if(!e){if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}r(null);return}let i=!0;return e().then(o=>{if(!i)return;const l=URL.createObjectURL(o);if(s.current)try{URL.revokeObjectURL(s.current)}catch{}s.current=l,r(l)}).catch(()=>{}),()=>{i=!1}},t),u.useEffect(()=>()=>{if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}},[]),n}const ek=1.2,tk=.05,nk=8;function bc(e){return Number(Math.min(nk,Math.max(tk,e)).toFixed(4))}function Rm(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Tm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function rk(e,t){try{e.setPointerCapture(t)}catch{}}function sk(e,t){try{e.releasePointerCapture(t)}catch{}}function ik(){const[e,t]=u.useState(1),[n,r]=u.useState(0),[s,i]=u.useState(0),[o,l]=u.useState(1),[c,d]=u.useState(!1),[f,p]=u.useState(!1),[h,w]=u.useState(!1),x=u.useRef(null),S=u.useRef(null),C=u.useRef(1),y=u.useRef(0),g=u.useRef(0),v=u.useRef(new Map),m=u.useRef(null),b=u.useRef(null),E=(R,T)=>{y.current=R,g.current=T,r(R),i(T)},j=R=>{const T=bc(R);C.current=T,t(T)},M=(R,T)=>{m.current={pointerId:R,startX:T.x,startY:T.y,startTx:y.current,startTy:g.current},b.current=null,p(!0)},_=()=>{const R=Array.from(v.current.entries());if(R.length<2)return;const[T,L]=R,[O,Q]=T,[V,A]=L,K=Rm(Q,A);!Number.isFinite(K)||K<=2||(b.current={pointerIds:[O,V],startDistance:K,startCenter:Tm(Q,A),startScale:C.current,startTx:y.current,startTy:g.current},m.current=null,p(!0))},P=()=>{const R=x.current,T=S.current;if(!R||!T||!T.naturalWidth||!T.naturalHeight)return;const L=R.getBoundingClientRect(),O=L.width/T.naturalWidth,Q=L.height/T.naturalHeight,V=Math.min(1,Math.min(O,Q));l(V);const A=T.naturalWidth*V,K=T.naturalHeight*V;E((L.width-A)/2,(L.height-K)/2),j(1)};u.useEffect(()=>{const R=x.current;if(!R)return;const T=new ResizeObserver(()=>{try{requestAnimationFrame(()=>P())}catch{P()}});return T.observe(R),()=>T.disconnect()},[]),u.useEffect(()=>{C.current=e,y.current=n,g.current=s},[e,n,s]),u.useEffect(()=>()=>{v.current.clear(),m.current=null,b.current=null},[]);const U=R=>{R.preventDefault();const T=R.deltaY>0?-1:1,L=x.current;if(!L)return;const O=L.getBoundingClientRect(),Q=R.clientX-O.left,V=R.clientY-O.top,A=C.current,K=bc(A*Math.pow(ek,T));if(K===A)return;const W=K/A,X=Q-W*(Q-y.current),ne=V-W*(V-g.current);j(K),E(X,ne)},F=R=>{if((R.pointerType??"mouse")==="mouse"&&R.button!==0)return;const L=v.current,O=S.current;if(!O||L.size===0&&R.target!==O)return;const Q=R.currentTarget,V=Q.getBoundingClientRect();if(!(R.clientX<V.left||R.clientX>V.right||R.clientY<V.top||R.clientY>V.bottom)){if(R.preventDefault(),R.stopPropagation(),L.set(R.pointerId,{x:R.clientX,y:R.clientY}),rk(Q,R.pointerId),L.size>=2){_();return}M(R.pointerId,{x:R.clientX,y:R.clientY})}},q=R=>{const T=v.current;if(!T.has(R.pointerId))return;T.set(R.pointerId,{x:R.clientX,y:R.clientY});const L=b.current;if(L){const A=T.get(L.pointerIds[0]),K=T.get(L.pointerIds[1]);if(A&&K){const W=Rm(A,K);if(W>2){const X=Tm(A,K),ne=bc(L.startScale*(W/L.startDistance)),G=ne/L.startScale,D=X.x-G*(L.startCenter.x-L.startTx),he=X.y-G*(L.startCenter.y-L.startTy);j(ne),E(D,he)}}return}const O=m.current;if(!O||O.pointerId!==R.pointerId)return;const Q=R.clientX-O.startX,V=R.clientY-O.startY;E(O.startTx+Q,O.startTy+V)},Z=(R,T)=>{const L=v.current;if(!L.has(R))return;if(L.delete(R),sk(T,R),L.size===0){m.current=null,b.current=null,p(!1);return}if(L.size>=2){_();return}const[O,Q]=L.entries().next().value;M(O,Q)};return{scale:e,setScale:t,tx:n,setTx:r,ty:s,setTy:i,base:o,setBase:l,ready:c,setReady:d,dragging:f,setDragging:p,visible:h,setVisible:w,containerRef:x,imgRef:S,fitAndCenter:P,handleWheel:U,handlePointerDown:F,handlePointerMove:q,handlePointerUp:R=>{Z(R.pointerId,R.currentTarget)},handlePointerCancel:R=>{Z(R.pointerId,R.currentTarget)}}}function ok({path:e,onClose:t,onNavigate:n,canPrev:r=!1,canNext:s=!1,onZoomChange:i,requestedZoomPercent:o,onZoomRequestConsumed:l}){const{scale:c,setScale:d,tx:f,setTx:p,ty:h,setTy:w,base:x,ready:S,setReady:C,dragging:y,visible:g,setVisible:v,containerRef:m,imgRef:b,fitAndCenter:E,handleWheel:j,handlePointerDown:M,handlePointerMove:_,handlePointerUp:P,handlePointerCancel:U}=ik(),F=hs(()=>pe.getFile(e),[e]),q=hs(()=>pe.getThumb(e),[e]),Z=u.useCallback(()=>{v(!1),window.setTimeout(t,110)},[t,v]);return u.useEffect(()=>{requestAnimationFrame(()=>{var B;v(!0),(B=m.current)==null||B.focus()})},[e]),u.useEffect(()=>{const B=I=>{I.key==="Escape"?Z():(I.key==="ArrowRight"||I.key==="d")&&n?n(1):(I.key==="ArrowLeft"||I.key==="a")&&n&&n(-1)};return window.addEventListener("keydown",B),()=>window.removeEventListener("keydown",B)},[Z,n]),u.useEffect(()=>{C(!1)},[F]),u.useEffect(()=>{i&&i(x*c*100)},[x,c,i]),u.useEffect(()=>{if(o==null)return;const B=m.current;if(!B){l&&l();return}const I=Math.max(.05,Math.min(8,o/100/Math.max(1e-6,x))),R=B.getBoundingClientRect(),T=R.width/2,L=R.height/2;d(O=>{const Q=I/O;return p(V=>T-Q*(T-V)),w(V=>L-Q*(L-V)),Number(I.toFixed(4))}),l&&l()},[o,x,l]),a.jsxs("div",{ref:m,role:"dialog","aria-modal":!0,"aria-label":"Image viewer",tabIndex:-1,className:`toolbar-offset touch-none absolute inset-0 left-[var(--left)] right-[var(--right)] flex items-start justify-start bg-panel z-viewer overflow-hidden transition-opacity duration-[110ms] ease-out cursor-grab focus:outline-none focus-visible:outline-none ${y?"cursor-grabbing select-none":""} ${g?"opacity-100":"opacity-0"}`,style:{outline:"none"},onClick:Z,onWheel:j,onPointerDown:M,onPointerMove:_,onPointerUp:P,onPointerCancel:U,onKeyDown:B=>{B.key==="Tab"&&B.preventDefault()},children:[a.jsxs("button",{"aria-label":"Close",onClick:B=>{B.stopPropagation(),Z()},className:"btn btn-sm absolute top-3 right-3 z-10",title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]}),q&&a.jsx("img",{src:q,alt:"thumb",className:"absolute top-0 left-0 max-w-none max-h-none object-contain pointer-events-none transition-opacity duration-[110ms] ease-out",draggable:!1,onDragStart:B=>B.preventDefault(),style:{transform:`translate(${f}px, ${h}px) scale(${x})`,transformOrigin:"0 0",opacity:S?0:.5,filter:"blur(0.25px)"}}),F&&a.jsx("img",{ref:b,src:F,alt:"viewer",className:"max-w-none max-h-none object-contain transition-opacity duration-[110ms] ease-out will-change-transform select-none",draggable:!1,onDragStart:B=>{B.preventDefault()},onLoad:B=>{E(),d(1);try{requestAnimationFrame(()=>C(!0))}catch{C(!0)}},onClick:B=>B.stopPropagation(),style:{transform:`translate(${f}px, ${h}px) scale(${x*c})`,transformOrigin:"0 0",opacity:S?.99:0,WebkitUserDrag:"none"}}),n&&a.jsxs("div",{className:"viewer-mobile-nav",onClick:B=>B.stopPropagation(),children:[a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${r?"":"is-disabled"}`,onClick:()=>r&&n(-1),"aria-label":"Previous image","aria-disabled":!r,disabled:!r,children:"Prev"}),a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${s?"":"is-disabled"}`,onClick:()=>s&&n(1),"aria-label":"Next image","aria-disabled":!s,disabled:!s,children:"Next"})]})]})}function dh(e){return!e||!(e instanceof HTMLElement)?!1:e.closest('input, textarea, [contenteditable="true"]')!==null}const lk=1.2,ak=.05,uk=8;function Cc(e){return Number(Math.min(uk,Math.max(ak,e)).toFixed(4))}function Im(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function _m(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function ck(e,t){try{e.setPointerCapture(t)}catch{}}function dk(e,t){try{e.releasePointerCapture(t)}catch{}}function fk(){const[e,t]=u.useState(1),[n,r]=u.useState(0),[s,i]=u.useState(0),[o,l]=u.useState(0),[c,d]=u.useState(0),[f,p]=u.useState(1),[h,w]=u.useState(1),[x,S]=u.useState(!1),C=u.useRef(null),y=u.useRef(null),g=u.useRef(null),v=u.useRef(1),m=u.useRef(0),b=u.useRef(0),E=u.useRef(0),j=u.useRef(0),M=u.useRef(new Map),_=u.useRef(null),P=u.useRef(null),U=u.useCallback(A=>{m.current=A.txA,b.current=A.tyA,E.current=A.txB,j.current=A.tyB,r(A.txA),i(A.tyA),l(A.txB),d(A.tyB)},[]),F=u.useCallback(A=>{const K=Cc(A);v.current=K,t(K)},[]),q=u.useCallback((A,K)=>{_.current={pointerId:A,startX:K.x,startY:K.y,startTxA:m.current,startTyA:b.current,startTxB:E.current,startTyB:j.current},P.current=null,S(!0)},[]),Z=u.useCallback(()=>{const A=Array.from(M.current.entries());if(A.length<2)return;const[K,W]=A,[X,ne]=K,[G,D]=W,he=Im(ne,D);!Number.isFinite(he)||he<=2||(P.current={pointerIds:[X,G],startDistance:he,startCenter:_m(ne,D),startScale:v.current,startTxA:m.current,startTyA:b.current,startTxB:E.current,startTyB:j.current},_.current=null,S(!0))},[]),B=u.useCallback((A,K)=>{const W=M.current;if(!W.has(A))return;if(W.delete(A),dk(K,A),W.size===0){_.current=null,P.current=null,S(!1);return}if(W.size>=2){Z();return}const[X,ne]=W.entries().next().value;q(X,ne)},[q,Z]),I=u.useCallback(()=>{const A=C.current;if(!A)return;const K=A.getBoundingClientRect(),W=G=>{if(!G||!G.naturalWidth||!G.naturalHeight)return;const D=K.width/G.naturalWidth,he=K.height/G.naturalHeight,ie=Math.min(1,Math.min(D,he)),be=G.naturalWidth*ie,Ce=G.naturalHeight*ie;return{base:ie,tx:(K.width-be)/2,ty:(K.height-Ce)/2}},X=W(y.current);X&&(p(X.base),m.current=X.tx,b.current=X.ty,r(X.tx),i(X.ty));const ne=W(g.current);ne&&(w(ne.base),E.current=ne.tx,j.current=ne.ty,l(ne.tx),d(ne.ty))},[]);u.useEffect(()=>{const A=C.current;if(!A)return;const K=new ResizeObserver(()=>{try{requestAnimationFrame(()=>I())}catch{I()}});return K.observe(A),()=>K.disconnect()},[I]);const R=u.useCallback(()=>{F(1),I()},[I,F]);u.useEffect(()=>{v.current=e,m.current=n,b.current=s,E.current=o,j.current=c},[e,n,s,o,c]),u.useEffect(()=>()=>{M.current.clear(),_.current=null,P.current=null},[]);const T=u.useCallback(A=>{A.preventDefault();const K=A.deltaY>0?-1:1,W=C.current;if(!W)return;const X=W.getBoundingClientRect(),ne=A.clientX-X.left,G=A.clientY-X.top,D=v.current,he=Cc(D*Math.pow(lk,K));if(he===D)return;const ie=he/D;F(he),U({txA:ne-ie*(ne-m.current),tyA:G-ie*(G-b.current),txB:ne-ie*(ne-E.current),tyB:G-ie*(G-j.current)})},[U,F]),L=u.useCallback(A=>{if((A.pointerType??"mouse")==="mouse"&&A.button!==0)return;const W=A.currentTarget;if(A.preventDefault(),M.current.set(A.pointerId,{x:A.clientX,y:A.clientY}),ck(W,A.pointerId),M.current.size>=2){Z();return}q(A.pointerId,{x:A.clientX,y:A.clientY})},[q,Z]),O=u.useCallback(A=>{const K=M.current;if(!K.has(A.pointerId))return;K.set(A.pointerId,{x:A.clientX,y:A.clientY});const W=P.current;if(W){const D=K.get(W.pointerIds[0]),he=K.get(W.pointerIds[1]);if(D&&he){const ie=Im(D,he);if(ie>2){const be=_m(D,he),Ce=Cc(W.startScale*(ie/W.startDistance)),fe=Ce/W.startScale;F(Ce),U({txA:be.x-fe*(W.startCenter.x-W.startTxA),tyA:be.y-fe*(W.startCenter.y-W.startTyA),txB:be.x-fe*(W.startCenter.x-W.startTxB),tyB:be.y-fe*(W.startCenter.y-W.startTyB)})}}return}const X=_.current;if(!X||X.pointerId!==A.pointerId)return;const ne=A.clientX-X.startX,G=A.clientY-X.startY;U({txA:X.startTxA+ne,tyA:X.startTyA+G,txB:X.startTxB+ne,tyB:X.startTyB+G})},[U,F]),Q=u.useCallback(A=>{B(A.pointerId,A.currentTarget)},[B]),V=u.useCallback(A=>{B(A.pointerId,A.currentTarget)},[B]);return{scale:e,baseA:f,baseB:h,txA:n,tyA:s,txB:o,tyB:c,dragging:x,containerRef:C,imgARef:y,imgBRef:g,fitAndCenter:I,resetView:R,handleWheel:T,handlePointerDown:L,handlePointerMove:O,handlePointerUp:Q,handlePointerCancel:V}}function hk({aItem:e,bItem:t,index:n,total:r,canPrev:s,canNext:i,onNavigate:o,onClose:l}){const c=u.useRef(null),[d,f]=u.useState(50),[p,h]=u.useState(!1),[w,x]=u.useState(!1),{scale:S,baseA:C,baseB:y,txA:g,tyA:v,txB:m,tyB:b,dragging:E,containerRef:j,imgARef:M,imgBRef:_,fitAndCenter:P,resetView:U,handleWheel:F,handlePointerDown:q,handlePointerMove:Z,handlePointerUp:B,handlePointerCancel:I}=fk(),R=(e==null?void 0:e.path)??null,T=(t==null?void 0:t.path)??null,L=(e==null?void 0:e.name)??R??"Select an image",O=(t==null?void 0:t.name)??T??"Select another image";u.useEffect(()=>{requestAnimationFrame(()=>{var G;return(G=c.current)==null?void 0:G.focus()})},[R,T]),u.useEffect(()=>{U(),h(!1),x(!1)},[R,T,U]),u.useEffect(()=>{const G=D=>{if(!dh(D.target)){if(D.key==="Escape"){D.preventDefault(),l();return}if((D.key==="ArrowRight"||D.key==="d")&&i){D.preventDefault(),o(1);return}(D.key==="ArrowLeft"||D.key==="a")&&s&&(D.preventDefault(),o(-1))}};return window.addEventListener("keydown",G),()=>window.removeEventListener("keydown",G)},[l,o,s,i]);const Q=hs(R?()=>pe.getFile(R):null,[R]),V=hs(T?()=>pe.getFile(T):null,[T]),A=hs(R?()=>pe.getThumb(R):null,[R]),K=hs(T?()=>pe.getThumb(T):null,[T]),W=u.useCallback(G=>Math.min(95,Math.max(5,G)),[]),X=u.useCallback(G=>{const D=G.target;D!=null&&D.closest(".compare-label")||D!=null&&D.closest(".compare-divider-hit")||q(G)},[q]),ne=u.useCallback(G=>{const D=j.current;if(!D)return;G.preventDefault(),G.stopPropagation();const he=D.getBoundingClientRect(),ie=G.currentTarget;ie.setPointerCapture(G.pointerId);const be=fe=>{const $e=(fe.clientX-he.left)/he.width*100;f(W($e))},Ce=fe=>{try{ie.releasePointerCapture(fe.pointerId)}catch{}window.removeEventListener("pointermove",be),window.removeEventListener("pointerup",Ce),window.removeEventListener("pointercancel",Ce)};window.addEventListener("pointermove",be),window.addEventListener("pointerup",Ce),window.addEventListener("pointercancel",Ce)},[W]);return a.jsxs("div",{ref:c,role:"dialog","aria-modal":!0,"aria-label":"Compare images",tabIndex:-1,className:"toolbar-offset absolute inset-0 left-[var(--left)] right-[var(--right)] bg-panel z-viewer flex flex-col overflow-hidden focus:outline-none",onKeyDown:G=>{G.key==="Tab"&&G.preventDefault()},children:[a.jsxs("div",{className:"compare-header flex items-center gap-3 px-3 py-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Compare"}),a.jsx("div",{className:"text-xs text-muted",children:r>=2?`${n+1}-${Math.min(n+2,r)} of ${r}`:"Select 2 images"}),a.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(-1),disabled:!s,title:"Previous (Left Arrow or A)",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Prev"]}),a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(1),disabled:!i,title:"Next (Right Arrow or D)",children:["Next",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"btn btn-sm",onClick:l,title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]})]})]}),a.jsx("div",{className:"flex-1 min-h-0 p-3 bg-panel",children:a.jsx("div",{ref:j,className:`compare-stage ${E?"is-dragging":""}`,onWheel:F,onPointerDown:X,onPointerMove:Z,onPointerUp:B,onPointerCancel:I,children:!e||!t?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-sm text-muted",children:"Select 2 images to compare."}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"compare-label left-3",children:[a.jsx("span",{className:"compare-label-tag",children:"A"}),a.jsx("span",{className:"truncate",title:e.path,children:L})]}),a.jsxs("div",{className:"compare-label right-3",children:[a.jsx("span",{className:"compare-label-tag",children:"B"}),a.jsx("span",{className:"truncate",title:t.path,children:O})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 ${100-d}% 0 0)`},children:[A&&a.jsx("img",{src:A,alt:"thumb A",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:G=>G.preventDefault(),style:{transform:`translate(${g}px, ${v}px) scale(${C})`,transformOrigin:"0 0",opacity:p?0:.5}}),Q&&a.jsx("img",{ref:M,src:Q,alt:"compare A",className:"compare-image",draggable:!1,onDragStart:G=>G.preventDefault(),onLoad:()=>{P();try{requestAnimationFrame(()=>h(!0))}catch{h(!0)}},style:{transform:`translate(${g}px, ${v}px) scale(${C*S})`,transformOrigin:"0 0",opacity:p?.99:0}})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 0 0 ${d}%)`},children:[K&&a.jsx("img",{src:K,alt:"thumb B",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:G=>G.preventDefault(),style:{transform:`translate(${m}px, ${b}px) scale(${y})`,transformOrigin:"0 0",opacity:w?0:.5}}),V&&a.jsx("img",{ref:_,src:V,alt:"compare B",className:"compare-image",draggable:!1,onDragStart:G=>G.preventDefault(),onLoad:()=>{P();try{requestAnimationFrame(()=>x(!0))}catch{x(!0)}},style:{transform:`translate(${m}px, ${b}px) scale(${y*S})`,transformOrigin:"0 0",opacity:w?.99:0}})]}),a.jsxs("div",{className:"compare-divider-hit",style:{left:`${d}%`},onPointerDown:ne,children:[a.jsx("div",{className:"compare-divider-line"}),a.jsx("div",{className:"compare-divider-handle"})]})]})})})]})}function xu(){const[e,t]=u.useState(Gb());return u.useEffect(()=>qb(t),[]),e}const Qo=e=>["item",e],pk={v:1,tags:[],notes:"",version:1,updated_at:"",updated_by:"web"},Mn=new Map,da=new Map,Hd=new Map,fh=new Map;let Lm=0;const Gn=new Map,ho=new Map,mk=12e3,Qd=new Set,Kd=new Set;let hh={state:"idle"},Ko=null,qd=0;function Dl(e){hh=e;for(const t of Qd)t(e)}function dr(){const e=Gn.size>0,t=Mn.size+da.size+qd;if(e){Dl({state:"error",message:"Conflict detected"});return}if(Ko){Dl({state:"error",message:Ko});return}if(t>0){Dl({state:"syncing"});return}Dl({state:"idle"})}function ph(){let e=null;for(const t of Hd.values())e=e==null?t:Math.min(e,t);for(const t of fh.values())e=e==null?t:Math.min(e,t);return e}function Ha(){const e=ph();for(const t of Kd)t(e)}function Qa(e){Ko=e,dr()}function Sx(){Ko&&(Ko=null,dr())}function Am(e){qd=Math.max(0,qd+e),dr()}function gk(){Lm+=1;const e=Lm;return fh.set(e,Date.now()),Ha(),e}function yk(e){e!=null&&fh.delete(e)&&Ha()}function wu(e){const t=ho.get(e);if(!t||!t.size)return;const n=Gn.get(e)??null;for(const r of t)r(n)}function Fm(e){return Gn.get(e)??null}function Su(e){Gn.delete(e)&&(wu(e),dr())}function vk(e,t){Gn.set(e,t),wu(e),dr()}function xk(e,t){const n=ho.get(e)??new Set;return n.add(t),ho.set(e,n),t(Gn.get(e)??null),()=>{const r=ho.get(e);r&&(r.delete(t),r.size||ho.delete(e))}}function wk(e){const[t,n]=u.useState(()=>e?Fm(e):null);return u.useEffect(()=>{if(!e){n(null);return}return n(Fm(e)),xk(e,n)},[e]),t}function Sk(e){return Qd.add(e),e(hh),()=>{Qd.delete(e)}}function bk(){const[e,t]=u.useState(hh);return u.useEffect(()=>Sk(t),[]),e}function Ck(e){return Kd.add(e),e(ph()),()=>{Kd.delete(e)}}function kk(){const[e,t]=u.useState(()=>ph()),[n,r]=u.useState(()=>e==null?null:Date.now()-e);return u.useEffect(()=>Ck(t),[]),u.useEffect(()=>{if(e==null){r(null);return}r(Date.now()-e);const s=window.setInterval(()=>{r(Date.now()-e)},1e3);return()=>window.clearInterval(s)},[e]),n}function Gd(e){const t={};return Object.prototype.hasOwnProperty.call(e,"star")&&(t.set_star=e.star??null),Object.prototype.hasOwnProperty.call(e,"notes")&&(t.set_notes=e.notes??""),Object.prototype.hasOwnProperty.call(e,"tags")&&(t.set_tags=Array.isArray(e.tags)?e.tags:[]),t}function Yd(e){var t,n;return e.set_star!==void 0||e.set_notes!==void 0||e.set_tags!==void 0||(((t=e.add_tags)==null?void 0:t.length)??0)>0||(((n=e.remove_tags)==null?void 0:n.length)??0)>0}function so(e){const t=[],n=new Set;for(const r of e??[]){if(typeof r!="string")continue;const s=r.trim();!s||n.has(s)||(n.add(s),t.push(s))}return t}function Ek(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function Nk(e,t){if(e.set_star!==void 0&&(t.star??null)!==e.set_star||e.set_notes!==void 0&&(t.notes??"")!==(e.set_notes??""))return!1;if(e.set_tags!==void 0){const r=so(e.set_tags),s=so(t.tags);return Ek(r,s)}const n=so(t.tags);for(const r of so(e.add_tags))if(!n.includes(r))return!1;for(const r of so(e.remove_tags))if(n.includes(r))return!1;return!0}function bx(e,t,n){if(n instanceof ln&&n.status===409){const r=n.body;if(r!=null&&r.current)return vk(e,{path:e,current:r.current,pending:t,receivedAt:new Date().toISOString()}),!0}return!1}function jk(e,t){const n=Gn.get(e);if(n){if(Nk(n.pending,t)){Su(e);return}Gn.set(e,{...n,current:t}),wu(e),dr()}}function Mk(e){const t=xu();return gu({queryKey:Qo(e),queryFn:()=>pe.getSidecar(e),enabled:!!e,staleTime:3e4,gcTime:5*6e4,retry:2,refetchInterval:t?mk:!1,refetchIntervalInBackground:t})}function Pk(e){const t=vr();return rb({mutationFn:async({patch:n,baseVersion:r,idempotencyKey:s})=>{const i=Gd(n);if(!Yd(i))return t.getQueryData(Qo(e))??pk;const o={...i,base_version:r};try{return await pe.patchSidecar(e,o,{idempotencyKey:s??vu("patch"),ifMatch:r})}catch(l){throw bx(e,i,l),l}},retry:(n,r)=>r instanceof ln&&r.status===409?!1:n<2,retryDelay:n=>Math.min(1e3*Math.pow(2,n),4e3),onMutate:()=>(Sx(),Am(1),{inflightId:gk()}),onSuccess:n=>{Su(e),t.setQueryData(Qo(e),n)},onError:n=>{n instanceof ln&&n.status===409||(n instanceof ln?Qa(n.message):Qa("Failed to save"))},onSettled:(n,r,s,i)=>{Am(-1),yk(i==null?void 0:i.inflightId)}})}const Rk=6;async function Cx(e,t){if(!e.length)return;let n=0;const r=[],s=async()=>{for(;n<e.length;){const o=n++,l=e[o];try{await kx(l,t)}catch(c){r.push({path:l,error:c}),console.error(`[bulkUpdateSidecars] Failed for ${l}:`,c)}}},i=Array.from({length:Math.min(Rk,e.length)},()=>s());if(await Promise.all(i),r.length===e.length)throw new Error(`All ${e.length} sidecar updates failed`)}async function kx(e,t){const n=Mn.get(e)||{};Mn.set(e,{...n,...t}),Sx(),dr();const r=da.get(e);if(r)return r;Hd.set(e,Date.now()),Ha();const s=(async()=>{try{for(;Mn.has(e);){const i=Mn.get(e);if(!i)break;const o=Gd(i);if(!Yd(o)){Mn.get(e)===i&&Mn.delete(e);continue}let l=1;try{l=(await pe.getSidecar(e)).version??1}catch{l=1}const c={...o,base_version:l};try{await pe.patchSidecar(e,c,{idempotencyKey:vu("patch"),ifMatch:l}),Su(e),Mn.get(e)===i&&Mn.delete(e)}catch(d){if(bx(e,o,d)){const p=Mn.get(e);if(p&&p!==i){const h=Gd(p);if(Yd(h)){const w=Gn.get(e);w&&(Gn.set(e,{...w,pending:h}),wu(e))}}Mn.delete(e)}else d instanceof ln?Qa(d.message):Qa("Failed to save");throw d}}}finally{da.delete(e),Hd.delete(e),Ha(),dr()}})();return da.set(e,s),dr(),s}function il(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function Ex(e){return e==="pil_info"||e.startsWith("pil_info.")||e.startsWith("pil_info[")}function Xd(e,t){if(typeof t=="number")return e?`${e}[${t}]`:`[${t}]`;const n=/^[A-Za-z0-9_$-]+$/.test(t);return e?n?`${e}.${t}`:`${e}["${t}"]`:n?t:`["${t}"]`}function Ka(e){return e==null?String(e):typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):Array.isArray(e)?`[${e.map(Ka).join(",")}]`:typeof e=="object"?`{${Object.entries(e).sort(([n],[r])=>n.localeCompare(r)).map(([n,r])=>`${n}:${Ka(r)}`).join(",")}}`:String(e)}function zl(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return String(e);try{return JSON.stringify(e,null,1)}catch{return String(e)}}function qa(e,t,n,r,s){if(s.skipPilInfo&&Ex(t))return;const i=t||"(root)";if(r>=s.maxDepth){n.set(i,e);return}if(Array.isArray(e)){if(!e.length){n.set(i,[]);return}if(e.length>s.maxArray){n.set(i,e);return}e.forEach((o,l)=>qa(o,Xd(t,l),n,r+1,s));return}if(il(e)){const o=Object.keys(e).sort((l,c)=>l.localeCompare(c));if(!o.length){n.set(t||"(root)",{});return}for(const l of o)s.skipPilInfo&&!t&&l==="pil_info"||qa(e[l],Xd(t,l),n,r+1,s);return}n.set(i,e)}function fa(e){if(Array.isArray(e))return e.map(fa);if(e&&typeof e=="object")return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,fa(n)]));if(typeof e=="string"){const t=e.trim();if(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]")||t.startsWith('"')&&t.endsWith('"'))try{const r=JSON.parse(t);return fa(r)}catch{return e}}return e}function kc(e){return e?fa(e):null}function Ec(e,t){if(!e)return null;if(!t&&il(e)&&"pil_info"in e){const n={};for(const[r,s]of Object.entries(e))n[r]=r==="pil_info"?"Hidden (toggle Show PIL info to expand)":s;return n}return e}function ko(e,t=[]){return e===null?{kind:"null",text:"null"}:e===void 0?{kind:"undefined",text:"undefined"}:typeof e=="string"?{kind:"string",text:JSON.stringify(e)}:typeof e=="number"?{kind:"number",text:String(e)}:typeof e=="boolean"?{kind:"boolean",text:e?"true":"false"}:Array.isArray(e)?{kind:"array",items:e.map((n,r)=>ko(n,[...t,r]))}:il(e)?{kind:"object",entries:Object.keys(e).map(n=>{const r=[...t,n];return{key:n,path:r,value:ko(e[n],r)}})}:{kind:"fallback",text:String(e)}}function Tk(e){let t="";for(const n of e)t=Xd(t,n);return t||"(root)"}function Ik(e,t){let n=e;for(const r of t){if(typeof r=="number"){if(!Array.isArray(n))return;n=n[r];continue}if(!il(n))return;n=n[r]}return n}function _k(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e;try{return JSON.stringify(e,null,1)}catch{return String(e)}}function Nc(e,t){const n=Ik(e,t);return{pathLabel:Tk(t),copyText:_k(n)}}function jc(e){return!!e&&il(e)&&"pil_info"in e}function Lk(e,t,n){if(e==null||t==null)return null;const r=new Map,s=new Map,i={maxDepth:n.maxDepth,maxArray:n.maxArray,skipPilInfo:!n.includePilInfo};qa(e,"",r,0,i),qa(t,"",s,0,i);const o=new Set([...r.keys(),...s.keys()]),l=[];let c=0,d=0,f=0;const p=Array.from(o).sort((S,C)=>S.localeCompare(C)),h=!n.includePilInfo;for(const S of p){if(h&&Ex(S))continue;const C=r.has(S),y=s.has(S);if(!C&&y){d+=1,l.push({key:S,kind:"onlyB",aText:"",bText:zl(s.get(S))});continue}if(C&&!y){c+=1,l.push({key:S,kind:"onlyA",aText:zl(r.get(S)),bText:""});continue}const g=r.get(S),v=s.get(S),m=Ka(g),b=Ka(v);m!==b&&(f+=1,l.push({key:S,kind:"different",aText:zl(g),bText:zl(v)}))}const w=Math.max(0,l.length-n.limit);return{entries:w?l.slice(0,n.limit):l,onlyA:c,onlyB:d,different:f,truncatedCount:w}}function Jd(e){const t=["B","KB","MB","GB","TB"];let n=0,r=e;for(;r>=1024&&n<t.length-1;)r/=1024,n+=1;return`${r.toFixed(1)} ${t[n]}`}function Nx(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function Mc(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function Ak(e,t=28){if(e.length<=t)return e;const n=Math.max(4,Math.floor((t-1)/2));return`${e.slice(0,n)}${e.slice(-n)}`}const Fk=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"});function Ok(e){const t=e.trim();return!t||/[zZ]|[+-]\d{2}:?\d{2}$/.test(t)?t:`${t.includes("T")?t:t.replace(" ","T")}Z`}function jx(e){if(!e)return null;const t=Date.parse(Ok(e));return Number.isFinite(t)?t:null}function Dk(e,t=Date.now()){const n=Math.max(0,t-e),r=Math.max(1,Math.floor(n/1e3));if(r<60)return`${r} second${r===1?"":"s"} ago`;const s=Math.floor(r/60);if(s<60)return`${s} minute${s===1?"":"s"} ago`;const i=Math.floor(s/60);return`${i} hour${i===1?"":"s"} ago`}function zk(e){return Fk.format(new Date(e))}function ol({title:e,open:t,onToggle:n,actions:r,children:s,contentClassName:i}){const[o,l]=u.useState(t),[c,d]=u.useState(t?"open":"closed");return u.useEffect(()=>{if(t){l(!0);const p=window.requestAnimationFrame(()=>d("open"));return()=>window.cancelAnimationFrame(p)}d("closing");const f=window.setTimeout(()=>{l(!1),d("closed")},140);return()=>window.clearTimeout(f)},[t]),a.jsxs("div",{className:"border-b border-border/60",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[a.jsxs("button",{type:"button",onClick:n,"aria-expanded":t,className:"flex items-center gap-2 inspector-section-title hover:text-text transition-colors",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`transition-transform ${t?"rotate-90":""}`,"aria-hidden":"true",children:a.jsx("path",{d:"m9 18 6-6-6-6"})}),a.jsx("span",{children:e})]}),r]}),o&&a.jsx("div",{className:"inspector-section-body","data-state":c,"aria-hidden":!t,children:a.jsx("div",{className:i??"px-3 pb-3",children:s})})]})}function $l({copied:e,value:t,className:n="",title:r}){return a.jsxs("span",{className:`ui-kv-value relative inline-block text-right min-w-[80px] ${n}`.trim(),title:r,children:[a.jsx("span",{className:e?"invisible block":"block",children:t}),e&&a.jsx("span",{className:"absolute inset-0 text-right",children:"Copied"})]})}function $k({open:e,onToggle:t,multi:n,star:r,onSelectStar:s,hasStarConflict:i,onApplyConflict:o,onKeepTheirs:l,currentItem:c,sourceValue:d,sortSpec:f,copiedField:p,onCopyInfo:h,metricsExpanded:w,onToggleMetricsExpanded:x,metricsPreviewLimit:S}){return a.jsxs(ol,{title:"Basics",open:e,onToggle:t,children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs mb-1",role:"radiogroup","aria-label":"Star rating",children:[a.jsx("span",{className:"ui-kv-label w-16 shrink-0",children:n?"Rating (all)":"Rating"}),a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(C=>{const y=(r??0)>=C;return a.jsx("button",{className:`w-6 h-6 flex items-center justify-center rounded-lg border border-border/60 bg-transparent text-[13px] ${y?"text-star-active":"text-star-inactive"} hover:border-border hover:text-star-hover transition-colors`,onClick:()=>{s(r===C&&!n?null:C)},title:`${C} star${C>1?"s":""} (key ${C})`,"aria-label":`${C} star${C>1?"s":""}`,"aria-pressed":r===C,children:y?"":""},C)})})]}),i&&a.jsxs("div",{className:"ui-banner ui-banner-danger mt-2 text-[11px] flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Rating conflict."}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:o,children:"Apply again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:l,children:"Keep theirs"})]})]}),!n&&c&&a.jsxs("div",{className:"text-[12px] space-y-1.5 leading-relaxed",children:[a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("dimensions",`${c.w}${c.h}`),children:"Dimensions"}),a.jsx($l,{copied:p==="dimensions",value:`${c.w}${c.h}`})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("size",Jd(c.size)),children:"Size"}),a.jsx($l,{copied:p==="size",value:Jd(c.size)})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("type",c.type),children:"Type"}),a.jsx($l,{copied:p==="type",value:c.type,className:"break-all"})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>d&&h("source",d),children:"Source"}),a.jsx($l,{copied:p==="source",value:d,className:"inspector-value-clamp break-words max-w-[70%]",title:d})]}),(()=>{const C=c.metrics||null;if(!C)return null;const y=Object.entries(C).filter(([,_])=>_!=null);if(!y.length)return null;const g=(f==null?void 0:f.kind)==="metric"?f.key:null,v=[...y].sort(([_],[P])=>_.localeCompare(P));let m=v;if(g){const _=v.findIndex(([P])=>P===g);_>0&&(m=[v[_],...v.slice(0,_),...v.slice(_+1)])}const b=m.length>S,j=w||!b?m:m.slice(0,S),M=m.length-S;return a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"ui-subsection-title mb-1",children:"Metrics"}),a.jsxs("div",{className:"space-y-1",children:[j.map(([_,P])=>{const U=g===_;return a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:`w-24 shrink-0 ${U?"text-accent font-medium":"ui-kv-label"}`,children:_}),a.jsx("span",{className:`ui-kv-value text-right ${U?"text-accent font-medium":""}`,children:Nx(P)})]},_)}),b&&a.jsx("button",{type:"button",className:"text-[11px] text-muted underline underline-offset-2 hover:text-text",onClick:x,"aria-expanded":w,children:w?"Show less":`+${M} more`})]})]})})()]})]})}const Bl=2,Bk={color:"var(--json-string)"},Uk={color:"var(--json-number)"},Vk={color:"var(--json-literal)"},Wk={color:"var(--json-fallback)"},Hk={color:"var(--json-key)"};function Zd(e,t,n){switch(e.kind){case"null":case"boolean":return a.jsx("span",{style:Vk,children:e.text});case"undefined":case"fallback":return a.jsx("span",{style:Wk,children:e.text});case"string":return a.jsx("span",{style:Bk,children:e.text});case"number":return a.jsx("span",{style:Uk,children:e.text});case"array":return e.items.length===0?"[]":a.jsxs(a.Fragment,{children:[`[
`,e.items.map((r,s)=>a.jsxs(Yr.Fragment,{children:[" ".repeat(t+Bl),Zd(r,t+Bl,n),s<e.items.length-1?",":"",`
`]},s))," ".repeat(t),"]"]});case"object":return e.entries.length===0?"{}":a.jsxs(a.Fragment,{children:[`{
`,e.entries.map((r,s)=>a.jsxs(Yr.Fragment,{children:[" ".repeat(t+Bl),a.jsx("span",{className:"ui-json-key",style:Hk,onClick:n?i=>{i.stopPropagation(),n(r.path)}:void 0,children:JSON.stringify(r.key)}),": ",Zd(r.value,t+Bl,n),s<e.entries.length-1?",":"",`
`]},JSON.stringify(r.path)))," ".repeat(t),"}"]})}}function Mx({node:e,onPathClick:t}){return a.jsx("code",{className:"block whitespace-pre-wrap",children:Zd(e,0,t)})}const Px=Yr.memo(function({compareDiff:t}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-muted",children:[a.jsxs("span",{children:[t.different," ","different"," ",""," ",t.onlyA," ","only A"," ",""," ",t.onlyB," ","only B"]}),a.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:"Deep paths"})]}),t.entries.length===0?a.jsx("div",{className:"text-muted",children:"No differences found."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2 text-[10px] uppercase tracking-wide text-muted",children:[a.jsx("div",{children:"Path"}),a.jsx("div",{children:"A"}),a.jsx("div",{children:"B"})]}),t.entries.map(n=>a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2",children:[a.jsx("div",{className:"text-[11px] text-muted font-mono break-all",children:n.key}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.aText}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.bText})]},n.key)),t.truncatedCount>0&&a.jsxs("div",{className:"text-muted text-[11px]",children:["+",t.truncatedCount," ","more differences not shown."]})]})]})});Px.displayName="CompareDiffTable";const ef=Yr.memo(function({side:t,compareMetaLoaded:n,hasPilInfo:r,showPilInfo:s,onToggleShowPilInfo:i,copied:o,onCopy:l,copiedPath:c,displayNode:d,compareMetaContent:f,onMetaPathCopy:p}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:["Metadata"," ",t]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[r&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:i,disabled:!n,children:s?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:l,disabled:!n,children:o?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[c&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",c]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",children:n&&d?a.jsx(Mx,{node:d,onPathClick:p}):f})]})]})});ef.displayName="CompareMetadataPane";function Qk({open:e,onToggle:t,compareMetaState:n,compareMetaError:r,compareLabelA:s,compareLabelB:i,compareIncludePilInfo:o,onToggleCompareIncludePilInfo:l,onReload:c,compareDiff:d,compareHasPilInfoA:f,compareHasPilInfoB:p,compareShowPilInfoA:h,compareShowPilInfoB:w,onToggleCompareShowPilInfoA:x,onToggleCompareShowPilInfoB:S,compareMetaCopied:C,onCopyCompareMetadata:y,compareValueCopiedPathA:g,compareValueCopiedPathB:v,compareDisplayNodeA:m,compareDisplayNodeB:b,compareMetaContent:E,onCompareMetaPathCopyA:j,onCompareMetaPathCopyB:M}){const _=n==="loaded";return a.jsx(ol,{title:"Compare Metadata",open:e,onToggle:t,actions:a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:c,disabled:n==="loading",children:n==="loading"?"Loading":"Reload"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:l,disabled:!_,children:o?"Hide PIL info":"Include PIL info"})]}),children:a.jsxs("div",{className:"space-y-2 text-[11px]",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] text-muted",children:[a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"A"}),a.jsx("div",{className:"text-text break-all",title:s,children:s})]}),a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"B"}),a.jsx("div",{className:"text-text break-all",title:i,children:i})]})]}),n==="loading"&&a.jsx("div",{className:"text-muted",children:"Loading metadata"}),n==="error"&&r&&a.jsx("div",{className:"text-danger break-words",children:r}),_&&d&&a.jsx(Px,{compareDiff:d}),a.jsxs("div",{className:"grid gap-3 pt-2",children:[a.jsx(ef,{side:"A",compareMetaLoaded:_,hasPilInfo:f,showPilInfo:h,onToggleShowPilInfo:x,copied:C==="A",onCopy:()=>y("A"),copiedPath:g,displayNode:m,compareMetaContent:E,onMetaPathCopy:j}),a.jsx(ef,{side:"B",compareMetaLoaded:_,hasPilInfo:p,showPilInfo:w,onToggleShowPilInfo:S,copied:C==="B",onCopy:()=>y("B"),copiedPath:v,displayNode:b,compareMetaContent:E,onMetaPathCopy:M})]})]})})}const Rx=Yr.memo(Qk);Rx.displayName="CompareMetadataSection";function Kk({open:e,onToggle:t,metadataLoading:n,metadataActionLabel:r,onMetadataAction:s,metadataActionDisabled:i,hasPilInfo:o,showPilInfo:l,onToggleShowPilInfo:c,metaValueCopiedPath:d,metaHeightClass:f,metaLoaded:p,metaDisplayNode:h,metaContent:w,metaError:x,onMetaPathCopy:S}){const C=a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[p&&o&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:c,disabled:!p,children:l?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[78px]",onClick:s,disabled:i||n,children:r})]});return a.jsxs(ol,{title:"Metadata",open:e,onToggle:t,actions:C,children:[a.jsxs("div",{className:"relative",children:[d&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",d]}),a.jsx("pre",{className:`ui-code-block ui-code-block-resizable ${f} overflow-auto whitespace-pre-wrap`,children:p&&h?a.jsx(Mx,{node:h,onPathClick:S}):w})]}),x&&a.jsx("div",{className:"text-[11px] text-danger mt-1 break-words",children:x})]})}const Tx=Yr.memo(Kk);Tx.displayName="MetadataSection";function qk({open:e,onToggle:t,multi:n,showConflictBanner:r,onApplyConflict:s,onKeepTheirs:i,notes:o,onNotesChange:l,onNotesBlur:c,tags:d,onTagsChange:f,onTagsBlur:p}){return a.jsxs(ol,{title:"Notes & Tags",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",children:[r&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Conflicting edits detected."}),a.jsx("div",{className:"text-[11px] text-muted mt-0.5",children:"Your changes were not saved because this item was updated elsewhere."}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:s,children:"Apply my changes again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:i,children:"Keep theirs"})]})]}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full scrollbar-thin",placeholder:"Add notes",value:o,onChange:h=>l(h.target.value),onBlur:c,"aria-label":n?"Notes for selected items":"Notes"}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:n?"Tags (apply to all, comma-separated)":"Tags (comma-separated)"}),a.jsx("input",{className:"ui-input inspector-input w-full",placeholder:"tag1, tag2",value:d,onChange:h=>f(h.target.value),onBlur:p,"aria-label":n?"Tags for selected items":"Tags"})]})]})}function Gk(e){return e===2?null:e>2?`Side-by-side view supports exactly 2 selections (selected ${e}).`:"Select exactly 2 images to open side-by-side view."}function Yk({selectedCount:e,compareActive:t,onOpenCompare:n}){const r=Gk(e),s=!n||t||r!==null,i=t?"Side-by-side viewer is already open.":r??"Open side by side to compare selected images.";return a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Selection Actions"}),a.jsx("div",{className:"flex flex-wrap items-center gap-2",children:a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>n==null?void 0:n(),disabled:s,children:"Side by side view"})}),a.jsx("div",{className:"text-[11px] text-muted",children:i})]})}const Om=2,Ix=12,Dm=120,zm=!0,qo="Comparison export (v1) requires exactly 2 selected images.",Xk=`Comparison export (v2) requires between 2 and ${Ix} selected images.`,_x="Comparison export for more than 2 selections is unavailable on this server.";function Lx(e,t){return`Comparison export (v2) supports up to ${e} selections (selected ${t}).`}function Jk(e){return e.replace(/[\u0000-\u001f\u007f]/g,"").trim()}function Zk(e){const n=e.replace(/\r\n?/g,`
`).replace(/\n+$/g,"");return n?n.split(`
`):[]}function eE(e){if(e.length!==0)return e.length===1?[e[0]]:[e[0],e[1]]}function tE(e){return e.map(t=>t.trim()).filter(t=>t.length>0)}function Ax(e,t){const{maxLines:n,tooManyLinesMessage:r}=t,s=Zk(e);if(s.length>n)return{ok:!1,message:r};const i=s.map(l=>Jk(l));return i.some(l=>l.length>Dm)?{ok:!1,message:`Each label must be at most ${Dm} characters.`}:i.some(l=>l.length>0)?{ok:!0,labels:i}:{ok:!0,labels:void 0}}function nE(e){const{pathA:t,pathB:n,labelsText:r,embedMetadata:s,reverseOrder:i}=e;if(!t||!n)return{ok:!1,message:qo};const o=Ax(r,{maxLines:Om,tooManyLinesMessage:`Enter at most ${Om} label lines (line 1 = A, line 2 = B).`});if(!o.ok)return o;const l={v:1,paths:[t,n],embed_metadata:s,reverse_order:i};return o.labels&&(l.labels=eE(o.labels)),{ok:!0,payload:l}}function rE(e){const{paths:t,labelsText:n,embedMetadata:r,reverseOrder:s}=e,i=tE(t);if(i.length!==t.length||i.length<2||i.length>Ix)return{ok:!1,message:Xk};const o=Ax(n,{maxLines:i.length,tooManyLinesMessage:`Enter at most ${i.length} label lines (one per selected image).`});if(!o.ok)return o;const l={v:2,paths:i,embed_metadata:r,reverse_order:s};return o.labels&&(l.labels=o.labels),{ok:!0,payload:l}}function io(e){return String(e).padStart(2,"0")}function sE(e,t=new Date){const n=t.getUTCFullYear(),r=io(t.getUTCMonth()+1),s=io(t.getUTCDate()),i=io(t.getUTCHours()),o=io(t.getUTCMinutes()),l=io(t.getUTCSeconds());return`comparison${e?"_reverse":""}_${n}${r}${s}_${i}${o}${l}.png`}function iE({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r}){return e<2?`Comparison export requires at least 2 selections (selected ${e}).`:e===2?t?null:qo:!n||r===null?_x:e>r?Lx(r,e):null}function oE({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r,compareExportLabelsText:s,onCompareExportLabelsTextChange:i,compareExportEmbedMetadata:o,onCompareExportEmbedMetadataChange:l,compareExportBusy:c,compareExportMode:d,onComparisonExport:f,compareExportError:p}){const h=iE({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r}),w=c||h!==null,x=e>2?`Label for image 1
Label for image 2
...`:`Label for A
Label for B`;return a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Selection Export"}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full h-20 scrollbar-thin",placeholder:x,value:s,onChange:S=>i(S.target.value),disabled:w,"aria-label":"Selection export labels"}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-[11px] text-muted",children:[a.jsx("input",{type:"checkbox",checked:o,onChange:S=>l(S.target.checked),disabled:w}),a.jsx("span",{children:"Embed metadata"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>f(!1),disabled:w,children:d==="normal"?"Exporting":"Export comparison"}),a.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",onClick:()=>f(!0),disabled:w,children:d==="reverse"?"Exporting":"Export (reverse order)"})]}),h&&a.jsx("div",{className:"text-[11px] text-muted",children:h}),p&&a.jsx("div",{className:"text-danger break-words",children:p})]})}const lE=[{id:"selectionActions",isVisible:()=>!0,render:({selectionActionsProps:e})=>a.jsx(Yk,{...e})},{id:"selectionExport",isVisible:({compareActive:e})=>!e,render:({selectionExportProps:e})=>a.jsx(oE,{...e})}];function aE({open:e,onToggle:t,multi:n,selectedCount:r,totalSize:s,filename:i,compareActive:o,compareReady:l,onOpenCompare:c,compareExportSupportsV2:d,compareExportMaxPathsV2:f,compareExportLabelsText:p,onCompareExportLabelsTextChange:h,compareExportEmbedMetadata:w,onCompareExportEmbedMetadataChange:x,compareExportBusy:S,compareExportMode:C,onComparisonExport:y,compareExportError:g,onFindSimilar:v,canFindSimilar:m,findSimilarDisabledReason:b}){const E={compareActive:o,selectionActionsProps:{selectedCount:r,compareActive:o,onOpenCompare:c},selectionExportProps:{selectedCount:r,compareReady:l,compareExportSupportsV2:d,compareExportMaxPathsV2:f,compareExportLabelsText:p,onCompareExportLabelsTextChange:h,compareExportEmbedMetadata:w,onCompareExportEmbedMetadataChange:x,compareExportBusy:S,compareExportMode:C,onComparisonExport:y,compareExportError:g}};return a.jsxs(ol,{title:n?"Selection":"Item",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",actions:v&&a.jsx("button",{type:"button",className:"btn btn-sm",onClick:v,disabled:!m,title:b??"Find similar",children:"Find similar"}),children:[n?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Selected"}),a.jsxs("div",{className:"inspector-field-value",children:[r," files"]})]}),a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Total size"}),a.jsx("div",{className:"inspector-field-value",children:Jd(s)})]})]}),lE.filter(j=>j.isVisible(E)).map(j=>a.jsx(u.Fragment,{children:j.render(E)},j.id))]}):a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Filename"}),a.jsx("div",{className:"inspector-field-value break-all",title:i,children:i})]}),b&&a.jsx("div",{className:"text-[11px] text-muted",children:b})]})}const uE=[{id:"overview",isVisible:()=>!0,render:({overviewProps:e})=>a.jsx(aE,{...e})},{id:"compareMetadata",isVisible:({compareActive:e,compareReady:t})=>e&&t,render:({compareMetadataProps:e})=>a.jsx(Rx,{...e})},{id:"basics",isVisible:()=>!0,render:({basicsProps:e})=>a.jsx($k,{...e})},{id:"metadata",isVisible:({multi:e})=>!e,render:({metadataProps:e})=>a.jsx(Tx,{...e})},{id:"notes",isVisible:()=>!0,render:({notesProps:e})=>a.jsx(qk,{...e})}];function cE(e,t){const n=dE(e)||"view",r=new Set(t.map(i=>i.id));if(!r.has(n))return n;let s=2;for(;r.has(`${n}-${s}`);)s+=1;return`${n}-${s}`}function dE(e){return e.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function Pc(e){const t=e.filter(s=>s>0).sort((s,i)=>i-s),n=e.includes(0),r=[...t.map(s=>String(s))];return n&&r.push("None"),r.join(", ")}function fE(e,t){return e&&t?`${e} to ${t}`:e?`from ${e}`:t?`to ${t}`:""}function hE(e){if(e==="/"||e==="")return"Root";const t=e.split("/").filter(Boolean);return t.length?t.length<=2?`/${t.join("/")}`:`.../${t.slice(-2).join("/")}`:"Root"}function pE(e,t,n,r){return!n||r?t:e==="/"||e===""?e||"/":n===e||n.startsWith(`${e}/`)?e:t}function mE(e,t){return`${$m(e)}${$m(t)}`}function $m(e){const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function gE(e){const t=e.toLowerCase();return t.endsWith(".png")?"image/png":t.endsWith(".webp")?"image/webp":"image/jpeg"}function yE(e,t){const n=e.split("/").pop()??e;return{path:e,name:n,type:gE(e),w:0,h:0,size:0,hasThumb:!0,hasMeta:!1,star:t??null}}function Eo(e,t){const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}function vE({selectedPaths:e,comparePathA:t,comparePathB:n}){if(e.length!==2)return null;if(t&&n)return[t,n];const[r,s]=e;return!r||!s?null:[r,s]}function xE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s,labelsText:i,embedMetadata:o,reverseOrder:l}){const c=e.length;if(c<2)return{ok:!1,message:qo};if(c===2){const d=vE({selectedPaths:e,comparePathA:t,comparePathB:n});if(!d)return{ok:!1,message:qo};const[f,p]=d;return nE({pathA:f,pathB:p,labelsText:i,embedMetadata:o,reverseOrder:l})}return r?s!==null&&c>s?{ok:!1,message:Lx(s,c)}:rE({paths:e,labelsText:i,embedMetadata:o,reverseOrder:l}):{ok:!1,message:_x}}function wE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s}){const[i,o]=u.useState(""),[l,c]=u.useState(zm),[d,f]=u.useState(null),[p,h]=u.useState(null),w=d!==null;u.useEffect(()=>{if(e.length<2){o(""),c(zm),f(null),h(null);return}f(null),h(null)},[t,n,e]);const x=u.useCallback(y=>{o(y),h(null)},[]),S=u.useCallback(y=>{c(y)},[]),C=u.useCallback(async y=>{if(w)return;if(e.length<2){h(qo);return}const v=xE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s,labelsText:i,embedMetadata:l,reverseOrder:y});if(!v.ok){h(v.message);return}f(y?"reverse":"normal"),h(null);try{const m=await pe.exportComparison(v.payload);Eo(m,sE(y))}catch(m){const b=m instanceof Error?m.message:"Failed to export comparison.";h(b)}finally{f(null)}},[w,l,i,s,r,t,n,e]);return{compareExportLabelsText:i,compareExportEmbedMetadata:l,compareExportMode:d,compareExportError:p,compareExportBusy:w,handleCompareExportLabelsTextChange:x,handleCompareExportEmbedMetadataChange:S,runComparisonExport:C}}function Bm(e,t){return e?`${e}::${t??""}`:null}function Um(e,t,n){return!e||!t||!n?null:`${t}::${n}`}function Ga({activeRequestId:e,responseRequestId:t,activeContextKey:n,responseContextKey:r}){return e===t&&n===r}function SE({compareReady:e,comparePathA:t,comparePathB:n}){const[r,s]=u.useState("idle"),[i,o]=u.useState(null),[l,c]=u.useState(null),[d,f]=u.useState(null),[p,h]=u.useState(!1),[w,x]=u.useState(!1),[S,C]=u.useState(!1),y=Um(e,t,n),g=u.useRef(0),v=u.useRef(y);v.current=y;const m=u.useCallback(async(E,j,M)=>{const _=g.current+1;g.current=_,s("loading"),o(null);try{const[P,U]=await Promise.all([pe.getMetadata(E),pe.getMetadata(j)]);if(!Ga({activeRequestId:g.current,responseRequestId:_,activeContextKey:v.current,responseContextKey:M}))return;c(P.meta),f(U.meta),s("loaded")}catch(P){if(!Ga({activeRequestId:g.current,responseRequestId:_,activeContextKey:v.current,responseContextKey:M}))return;const U=P instanceof Error?P.message:"Failed to load metadata";c(null),f(null),o(U),s("error")}},[]);u.useEffect(()=>{if(g.current+=1,!y||!t||!n){s("idle"),o(null),c(null),f(null),x(!1),C(!1);return}h(!1),x(!1),C(!1),m(t,n,y)},[y,t,n,m]);const b=u.useCallback(()=>{const E=Um(e,t,n);!E||!t||!n||m(t,n,E)},[e,t,n,m]);return{compareMetaState:r,compareMetaError:i,compareMetaA:l,compareMetaB:d,compareIncludePilInfo:p,compareShowPilInfoA:w,compareShowPilInfoB:S,setCompareIncludePilInfo:h,setCompareShowPilInfoA:x,setCompareShowPilInfoB:C,reloadCompareMetadata:b}}function bE({path:e,sidecarUpdatedAt:t}){const[n,r]=u.useState(null),[s,i]=u.useState(null),[o,l]=u.useState("idle"),[c,d]=u.useState(!1),f=Bm(e,t),p=u.useRef(0),h=u.useRef(f);h.current=f,u.useEffect(()=>{p.current+=1,r(null),i(null),l("idle"),d(!1)},[f]);const w=u.useCallback(async()=>{const x=Bm(e,t);if(!x||!e)return;const S=p.current+1;p.current=S,l("loading"),i(null);try{const C=await pe.getMetadata(e);if(!Ga({activeRequestId:p.current,responseRequestId:S,activeContextKey:h.current,responseContextKey:x}))return;r(C.meta),l("loaded")}catch(C){if(!Ga({activeRequestId:p.current,responseRequestId:S,activeContextKey:h.current,responseContextKey:x}))return;const y=C instanceof Error?C.message:"Failed to load metadata";r(null),i(y),l("error")}},[e,t]);return{metaRaw:n,metaError:s,metaState:o,showPilInfo:c,setMetaError:i,setShowPilInfo:d,fetchMetadata:w}}function CE({path:e,sidecarUpdatedAt:t,selectedPaths:n,compareReady:r,comparePathA:s,comparePathB:i,compareExportSupportsV2:o,compareExportMaxPathsV2:l}){const c=bE({path:e,sidecarUpdatedAt:t}),d=SE({compareReady:r,comparePathA:s,comparePathB:i}),f=wE({selectedPaths:n,comparePathA:s,comparePathB:i,compareExportSupportsV2:o,compareExportMaxPathsV2:l});return{metaRaw:c.metaRaw,metaError:c.metaError,metaState:c.metaState,showPilInfo:c.showPilInfo,setMetaError:c.setMetaError,compareMetaState:d.compareMetaState,compareMetaError:d.compareMetaError,compareMetaA:d.compareMetaA,compareMetaB:d.compareMetaB,compareIncludePilInfo:d.compareIncludePilInfo,compareShowPilInfoA:d.compareShowPilInfoA,compareShowPilInfoB:d.compareShowPilInfoB,compareExportLabelsText:f.compareExportLabelsText,compareExportEmbedMetadata:f.compareExportEmbedMetadata,compareExportMode:f.compareExportMode,compareExportError:f.compareExportError,compareExportBusy:f.compareExportBusy,setShowPilInfo:c.setShowPilInfo,setCompareIncludePilInfo:d.setCompareIncludePilInfo,setCompareShowPilInfoA:d.setCompareShowPilInfoA,setCompareShowPilInfoB:d.setCompareShowPilInfoB,fetchMetadata:c.fetchMetadata,reloadCompareMetadata:d.reloadCompareMetadata,handleCompareExportLabelsTextChange:f.handleCompareExportLabelsTextChange,handleCompareExportEmbedMetadataChange:f.handleCompareExportEmbedMetadataChange,runComparisonExport:f.runComparisonExport}}function Ul(e){return{notes:(e==null?void 0:e.notes)??"",tags:((e==null?void 0:e.tags)??[]).join(", ")}}function Ya(e){return e.split(",").map(t=>t.trim()).filter(Boolean)}function kE(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function EE(e,t){return e!==t}function NE(e,t){return!kE(Ya(e),Ya(t))}function jE({path:e,selectedPaths:t,multi:n,sidecar:r,conflict:s,star:i,queryClient:o,mutateSidecar:l,onStarChanged:c,onLocalTypingChange:d}){const[f,p]=u.useState(""),[h,w]=u.useState(""),x=u.useRef(!1),S=u.useRef(!1),C=u.useRef(!1),y=u.useRef(Ul(void 0)),g=u.useCallback(F=>{x.current!==F&&(x.current=F,d==null||d(F))},[d]),v=u.useCallback(F=>{y.current=F,S.current=!1,C.current=!1,p(F.tags),w(F.notes),g(!1)},[g]);u.useEffect(()=>{if(!e){v(Ul(void 0));return}v(Ul(r))},[e,v,r==null?void 0:r.updated_at,r==null?void 0:r.version]),u.useEffect(()=>()=>{g(!1)},[g]);const m=u.useCallback(F=>{if(n&&t.length){Cx(t,F);return}e&&l(F,(r==null?void 0:r.version)??1)},[n,l,e,t,r==null?void 0:r.version]),b=u.useMemo(()=>({tags:!!(s!=null&&s.pending.set_tags),notes:(s==null?void 0:s.pending.set_notes)!==void 0,star:(s==null?void 0:s.pending.set_star)!==void 0}),[s]),E=u.useCallback(F=>{w(F),S.current=!0,g(!0)},[g]),j=u.useCallback(()=>{const F=S.current;S.current=!1,F&&EE(h,y.current.notes)&&(m({notes:h}),y.current={...y.current,notes:h}),g(!1)},[m,h,g]),M=u.useCallback(F=>{p(F),C.current=!0,g(!0)},[g]),_=u.useCallback(()=>{const F=C.current;C.current=!1,F&&NE(f,y.current.tags)&&(m({tags:Ya(f)}),y.current={...y.current,tags:f}),g(!1)},[m,g,f]),P=u.useCallback(()=>{if(!s||!e)return;const F={};s.pending.set_tags!==void 0&&(F.tags=Ya(f)),s.pending.set_notes!==void 0&&(F.notes=h),s.pending.set_star!==void 0&&(F.star=i??null),l(F,s.current.version??1)},[s,l,h,e,i,f]),U=u.useCallback(()=>{if(!s||!e)return;const F=s.current,q=Ul(F);y.current=q,S.current=!1,C.current=!1,p(q.tags),w(q.notes),g(!1),o.setQueryData(Qo(e),F),Su(e),c==null||c([e],F.star??null)},[s,g,c,e,o]);return{tags:f,notes:h,conflictFields:b,commitSidecar:m,applyConflict:P,keepTheirs:U,handleNotesChange:E,handleNotesBlur:j,handleTagsChange:M,handleTagsBlur:_}}const ME=["overview","compare","basics","metadata","notes"],Vm="lenslet.inspector.sections",Wm="lenslet.inspector.metricsExpanded",PE={overview:!0,compare:!0,metadata:!0,basics:!0,notes:!0};function Ut(e){e.current!==null&&(window.clearTimeout(e.current),e.current=null)}function RE({path:e,sidecarUpdatedAt:t,compareReady:n,comparePathA:r,comparePathB:s}){const[i,o]=u.useState(PE),[l,c]=u.useState(!1),[d,f]=u.useState(null),[p,h]=u.useState(!1),[w,x]=u.useState(null),[S,C]=u.useState(null),[y,g]=u.useState(null),[v,m]=u.useState(null),b=u.useRef(null),E=u.useRef(null),j=u.useRef(null),M=u.useRef(null),_=u.useRef(null),P=u.useCallback(V=>{o(A=>({...A,[V]:!A[V]}))},[]),U=u.useCallback(()=>P("overview"),[P]),F=u.useCallback(()=>P("compare"),[P]),q=u.useCallback(()=>P("basics"),[P]),Z=u.useCallback(()=>P("metadata"),[P]),B=u.useCallback(()=>P("notes"),[P]),I=u.useCallback(()=>{c(V=>!V)},[]),R=u.useCallback(V=>{f(V),Ut(b),b.current=window.setTimeout(()=>{f(A=>A===V?null:A),b.current=null},1e3)},[]),T=u.useCallback(()=>{h(!0),Ut(E),E.current=window.setTimeout(()=>{h(!1),E.current=null},1200)},[]),L=u.useCallback(V=>{x(V),Ut(j),j.current=window.setTimeout(()=>{x(null),j.current=null},900)},[]),O=u.useCallback(V=>{C(V),Ut(M),M.current=window.setTimeout(()=>{C(A=>A===V?null:A),M.current=null},1200)},[]),Q=u.useCallback((V,A)=>{V==="A"?g(A):m(A),Ut(_),_.current=window.setTimeout(()=>{g(null),m(null),_.current=null},900)},[]);return u.useEffect(()=>{try{const V=localStorage.getItem(Vm);if(!V)return;const A=JSON.parse(V);if(!A||typeof A!="object")return;const K={};for(const W of ME)typeof A[W]=="boolean"&&(K[W]=A[W]);Object.keys(K).length>0&&o(W=>({...W,...K}))}catch{}},[]),u.useEffect(()=>{try{localStorage.setItem(Vm,JSON.stringify(i))}catch{}},[i]),u.useEffect(()=>{try{const V=localStorage.getItem(Wm);V==="1"||V==="true"?c(!0):(V==="0"||V==="false")&&c(!1)}catch{}},[]),u.useEffect(()=>{try{localStorage.setItem(Wm,l?"1":"0")}catch{}},[l]),u.useEffect(()=>{h(!1),x(null),Ut(E),Ut(j)},[e,t]),u.useEffect(()=>{C(null),g(null),m(null),Ut(M),Ut(_)},[r,s,n]),u.useEffect(()=>()=>{Ut(b),Ut(E),Ut(j),Ut(M),Ut(_)},[]),{openSections:i,toggleOverviewSection:U,toggleCompareSection:F,toggleBasicsSection:q,toggleMetadataSection:Z,toggleNotesSection:B,metricsExpanded:l,toggleMetricsExpanded:I,copiedField:d,markInfoCopied:R,metaCopied:p,markMetadataCopied:T,metaValueCopiedPath:w,markMetadataValueCopied:L,compareMetaCopied:S,markCompareMetadataCopied:O,compareValueCopiedPathA:y,compareValueCopiedPathB:v,markCompareMetadataValueCopied:Q}}const TE=12,IE=120,_E=8,LE=80;function AE({path:e,selectedPaths:t=[],items:n=[],compareActive:r=!1,compareA:s=null,compareB:i=null,onOpenCompare:o,onResize:l,onStarChanged:c,sortSpec:d,onFindSimilar:f,embeddingsAvailable:p=!1,embeddingsLoading:h=!1,compareExportSupportsV2:w=!1,compareExportMaxPathsV2:x=null,onLocalTypingChange:S}){const C=!!e,{data:y}=Mk(e??""),g=Pk(e??""),v=vr(),m=t.length>1,b=!!f&&p&&!m,E=f?p?m?"Select a single image to search.":null:h?"Loading embeddings...":"No embeddings detected.":null,M=u.useMemo(()=>{var ye;return((ye=n.find(Ge=>Ge.path===e))==null?void 0:ye.star)??null},[n,e])??(y==null?void 0:y.star)??null,_=wk(m?null:e),P=(s==null?void 0:s.path)??null,U=(i==null?void 0:i.path)??null,F=t.length===2&&!!t[0]&&!!t[1],Z=r&&(!!P&&!!U),{openSections:B,toggleOverviewSection:I,toggleCompareSection:R,toggleBasicsSection:T,toggleMetadataSection:L,toggleNotesSection:O,metricsExpanded:Q,toggleMetricsExpanded:V,copiedField:A,markInfoCopied:K,metaCopied:W,markMetadataCopied:X,metaValueCopiedPath:ne,markMetadataValueCopied:G,compareMetaCopied:D,markCompareMetadataCopied:he,compareValueCopiedPathA:ie,compareValueCopiedPathB:be,markCompareMetadataValueCopied:Ce}=RE({path:e,sidecarUpdatedAt:y==null?void 0:y.updated_at,comparePathA:P,comparePathB:U,compareReady:Z}),fe=Z&&r&&B.compare,$e=!m&&B.metadata,St=(s==null?void 0:s.name)??P??"A",dt=(i==null?void 0:i.name)??U??"B",Cn=u.useCallback((le,ye)=>{g.mutate({patch:le,baseVersion:ye,idempotencyKey:vu("patch")})},[g]),{tags:dn,notes:zn,conflictFields:fn,commitSidecar:re,applyConflict:se,keepTheirs:xe,handleNotesChange:Me,handleNotesBlur:ge,handleTagsChange:de,handleTagsBlur:Je}=jE({path:e,selectedPaths:t,multi:m,sidecar:y,conflict:_,star:M,queryClient:v,mutateSidecar:Cn,onStarChanged:c,onLocalTypingChange:S}),{metaRaw:Ze,metaError:bt,metaState:Ke,showPilInfo:Yt,setMetaError:xr,compareMetaState:kn,compareMetaError:En,compareMetaA:ke,compareMetaB:qe,compareIncludePilInfo:Xt,compareShowPilInfoA:Jt,compareShowPilInfoB:ns,compareExportLabelsText:z,compareExportEmbedMetadata:Y,compareExportMode:ue,compareExportError:we,compareExportBusy:Ee,setShowPilInfo:Pe,setCompareIncludePilInfo:oe,setCompareShowPilInfoA:Ne,setCompareShowPilInfoB:me,fetchMetadata:it,reloadCompareMetadata:Fe,handleCompareExportLabelsTextChange:gt,handleCompareExportEmbedMetadataChange:Zt,runComparisonExport:Nn}=CE({path:e,sidecarUpdatedAt:y==null?void 0:y.updated_at,selectedPaths:t,compareReady:Z,comparePathA:P,comparePathB:U,compareExportSupportsV2:w,compareExportMaxPathsV2:x}),en=u.useMemo(()=>{const le=new Set(t);return n.filter(ye=>le.has(ye.path))},[n,t]),et=u.useMemo(()=>en.reduce((le,ye)=>le+(ye.size||0),0),[en]);u.useEffect(()=>{if(!e)return;const le=ye=>{if(dh(ye.target))return;const Ge=ye.key;if(!/^[0-5]$/.test(Ge))return;ye.preventDefault();const Zn=Ge==="0"?null:Number(Ge);if(m&&t.length){re({star:Zn}),c==null||c(t,Zn);return}re({star:Zn}),c==null||c([e],Zn)};return window.addEventListener("keydown",le),()=>window.removeEventListener("keydown",le)},[e,m,t,re,c]);const rs=hs(e?()=>pe.getThumb(e):null,[e]),wr=e?e.split("/").pop()||e:"",$t=u.useMemo(()=>{var ye;if(wr.includes("."))return wr.slice(wr.lastIndexOf(".")+1).toUpperCase();const le=n.find(Ge=>Ge.path===e);return(ye=le==null?void 0:le.type)!=null&&ye.includes("/")?le.type.split("/")[1].toUpperCase():""},[wr,n,e]),rt=u.useMemo(()=>n.find(le=>le.path===e),[n,e]),tn=u.useMemo(()=>e?(rt==null?void 0:rt.source)??e:"",[rt,e]),Ct=u.useMemo(()=>{if(!Ze)return"";try{return JSON.stringify(Ze,null,1)}catch{return""}},[Ze]),ll=u.useMemo(()=>kc(Ze),[Ze]),$n=u.useMemo(()=>kc(ke),[ke]),Fs=u.useMemo(()=>kc(qe),[qe]),Yn=u.useMemo(()=>Ec(ll,Yt),[ll,Yt]),$i=u.useMemo(()=>{if(!ke)return"";try{return JSON.stringify(ke,null,1)}catch{return""}},[ke]),Os=u.useMemo(()=>{if(!qe)return"";try{return JSON.stringify(qe,null,1)}catch{return""}},[qe]),Xn=u.useMemo(()=>Ec($n,Jt),[$n,Jt]),Jn=u.useMemo(()=>Ec(Fs,ns),[Fs,ns]),Cu=u.useCallback(()=>{var le;Ct&&((le=navigator.clipboard)==null||le.writeText(Ct).then(()=>{X()}).catch(ye=>{const Ge=ye instanceof Error?ye.message:"Copy failed";xr(Ge)}))},[X,Ct,xr]),ku=u.useMemo(()=>!$e||!Yn?null:ko(Yn),[$e,Yn]),Eu=u.useMemo(()=>!fe||!Xn?null:ko(Xn),[fe,Xn]),al=u.useMemo(()=>!fe||!Jn?null:ko(Jn),[fe,Jn]),Bi=u.useCallback((le,ye)=>{var Ge;(Ge=navigator.clipboard)==null||Ge.writeText(ye).then(()=>{G(le)}).catch(()=>{})},[G]),Ds=u.useCallback((le,ye,Ge)=>{var Zn;(Zn=navigator.clipboard)==null||Zn.writeText(Ge).then(()=>{Ce(le,ye)}).catch(()=>{})},[Ce]),Nu=u.useCallback(le=>{if(!Yn)return;const ye=Nc(Yn,le);Bi(ye.pathLabel,ye.copyText)},[Yn,Bi]),ju=u.useCallback(le=>{if(!Xn)return;const ye=Nc(Xn,le);Ds("A",ye.pathLabel,ye.copyText)},[Xn,Ds]),ul=u.useCallback(le=>{if(!Jn)return;const ye=Nc(Jn,le);Ds("B",ye.pathLabel,ye.copyText)},[Jn,Ds]),cl=u.useCallback(le=>{var Ge;const ye=le==="A"?$i:Os;ye&&((Ge=navigator.clipboard)==null||Ge.writeText(ye).then(()=>{he(le)}).catch(()=>{}))},[$i,Os,he]);let Ui=Yn?"":"PNG metadata not loaded yet.";Ke==="loading"?Ui="Loading metadata":Ke==="error"&&bt&&(Ui=bt);let Vi="Metadata not loaded yet.";kn==="loading"?Vi="Loading metadata":kn==="error"&&En&&(Vi=En);const zs=Ke==="loading",ss=Ke==="loaded"&&!!Ct,dl=ss?"h-48":"h-24";let Wi="Load meta";zs?Wi="Loading":ss&&(Wi=W?"Copied":"Copy");const fl=ss?Cu:it,hl=jc(Ze),Mu=jc(ke),$s=jc(qe),pl=u.useMemo(()=>fe?Lk($n,Fs,{includePilInfo:Xt,limit:IE,maxDepth:_E,maxArray:LE}):null,[fe,$n,Fs,Xt]),Pu=u.useCallback((le,ye)=>{var Ge;ye&&((Ge=navigator.clipboard)==null||Ge.writeText(ye).then(()=>{K(le)}).catch(()=>{}))},[K]),Bs=u.useCallback(le=>{if(m&&t.length){c==null||c(t,le),Cx(t,{star:le});return}e&&(c==null||c([e],le),kx(e,{star:le}))},[m,c,e,t]),Ru=u.useCallback(()=>{Pe(le=>!le)},[Pe]),Tu=u.useCallback(()=>{oe(le=>!le)},[oe]),Iu=u.useCallback(()=>{Ne(le=>!le)},[Ne]),_u=u.useCallback(()=>{me(le=>!le)},[me]),Lu=u.useCallback(le=>{Nn(le)},[Nn]),Au=!m&&!!_&&(fn.tags||fn.notes),Fu=!m&&!!_&&fn.star,Bt="toolbar-offset sidebar-resize-handle sidebar-resize-handle-right absolute bottom-0";if(!C)return a.jsx("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:a.jsx("div",{className:Bt,onPointerDown:l})});const Hi={multi:m,compareActive:r,compareReady:Z,overviewProps:{open:B.overview,onToggle:I,multi:m,selectedCount:t.length,totalSize:et,filename:wr,compareActive:r,compareReady:F,onOpenCompare:o,compareExportSupportsV2:w,compareExportMaxPathsV2:x,compareExportLabelsText:z,onCompareExportLabelsTextChange:gt,compareExportEmbedMetadata:Y,onCompareExportEmbedMetadataChange:Zt,compareExportBusy:Ee,compareExportMode:ue,onComparisonExport:Lu,compareExportError:we,onFindSimilar:f,canFindSimilar:b,findSimilarDisabledReason:E},compareMetadataProps:{open:B.compare,onToggle:R,compareMetaState:kn,compareMetaError:En,compareLabelA:St,compareLabelB:dt,compareIncludePilInfo:Xt,onToggleCompareIncludePilInfo:Tu,onReload:Fe,compareDiff:pl,compareHasPilInfoA:Mu,compareHasPilInfoB:$s,compareShowPilInfoA:Jt,compareShowPilInfoB:ns,onToggleCompareShowPilInfoA:Iu,onToggleCompareShowPilInfoB:_u,compareMetaCopied:D,onCopyCompareMetadata:cl,compareValueCopiedPathA:ie,compareValueCopiedPathB:be,compareDisplayNodeA:Eu,compareDisplayNodeB:al,compareMetaContent:Vi,onCompareMetaPathCopyA:ju,onCompareMetaPathCopyB:ul},basicsProps:{open:B.basics,onToggle:T,multi:m,star:M,onSelectStar:Bs,hasStarConflict:Fu,onApplyConflict:se,onKeepTheirs:xe,currentItem:rt??null,sourceValue:tn,sortSpec:d,copiedField:A,onCopyInfo:Pu,metricsExpanded:Q,onToggleMetricsExpanded:V,metricsPreviewLimit:TE},metadataProps:{open:B.metadata,onToggle:L,metadataLoading:zs,metadataActionLabel:Wi,onMetadataAction:fl,metadataActionDisabled:!e,hasPilInfo:hl,showPilInfo:Yt,onToggleShowPilInfo:Ru,metaValueCopiedPath:ne,metaHeightClass:dl,metaLoaded:ss,metaDisplayNode:ku,metaContent:Ui,metaError:bt,onMetaPathCopy:Nu},notesProps:{open:B.notes,onToggle:O,multi:m,showConflictBanner:Au,onApplyConflict:se,onKeepTheirs:xe,notes:zn,onNotesChange:Me,onNotesBlur:ge,tags:dn,onTagsChange:de,onTagsBlur:Je}};return a.jsxs("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:[!m&&a.jsx("div",{className:"p-3 border-b border-border flex justify-center",children:a.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-border w-[220px] h-[160px] bg-panel select-none",children:[rs&&a.jsx("img",{src:rs,alt:"thumb",className:"block w-full h-full object-contain"}),!!$t&&a.jsx("div",{className:"absolute top-1.5 left-1.5 bg-surface border border-border text-text text-xs px-1.5 py-0.5 rounded-md select-none",children:$t})]})}),uE.filter(le=>le.isVisible(Hi)).map(le=>a.jsx(u.Fragment,{children:le.render(Hi)},le.id)),a.jsx("div",{className:Bt,onPointerDown:l})]})}function FE({open:e,embeddings:t,rejected:n=[],selectedPath:r,embeddingsLoading:s=!1,embeddingsError:i,onClose:o,onSearch:l}){const[c,d]=u.useState(""),[f,p]=u.useState("path"),[h,w]=u.useState(""),[x,S]=u.useState(""),[C,y]=u.useState("50"),[g,v]=u.useState(""),[m,b]=u.useState(null),[E,j]=u.useState(!1),M=u.useRef(null),_=u.useRef(null),P=u.useMemo(()=>t.find(I=>I.name===c)??t[0]??null,[t,c]);u.useEffect(()=>{e&&(b(null),t.length>0&&!t.some(I=>I.name===c)&&d(t[0].name),r?(p("path"),w(r)):(p("vector"),w("")))},[e,t,c,r]),u.useEffect(()=>{if(!e)return;const I=f==="vector"?_.current:M.current,R=window.requestAnimationFrame(()=>I==null?void 0:I.focus());return()=>window.cancelAnimationFrame(R)},[e,f]);const U=u.useCallback(async()=>{if(b(null),!t.length){b("No embeddings available for similarity search.");return}if(!P){b("Select an embedding to search.");return}const I=h.trim(),R=x.trim(),T=Number(C);if(!Number.isFinite(T)||T<=0){b("Top K must be a positive number.");return}const L=Math.min(1e3,Math.max(1,Math.floor(T))),O=g.trim()===""?null:Number(g);if(O!=null&&!Number.isFinite(O)){b("Min score must be a valid number.");return}if(f==="path"&&!I){b("Select an image path for the query.");return}if(f==="vector"&&!R){b("Paste a base64 vector for the query.");return}const Q={embedding:P.name,query_path:f==="path"?I:null,query_vector_b64:f==="vector"?R:null,top_k:L,min_score:O};j(!0);try{await l(Q),o()}catch(V){V instanceof ln||V instanceof Error?b(V.message):b("Failed to run similarity search.")}finally{j(!1)}},[t.length,P,h,x,C,g,f,l,o]);u.useEffect(()=>{if(!e)return;const I=R=>{if(R.key==="Escape"){R.preventDefault(),o();return}(R.ctrlKey||R.metaKey)&&R.key==="Enter"&&(R.preventDefault(),U())};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[e,o,U]);const F=u.useCallback(()=>{var I;r&&(p("path"),w(r),(I=M.current)==null||I.focus())},[r]);if(!e)return null;const q=t.map(I=>({value:I.name,label:I.name})),Z=n.length>0,B=n.slice(0,3);return a.jsx("div",{className:"fixed inset-0 z-[var(--z-overlay)] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",onClick:I=>{I.target===I.currentTarget&&o()},children:a.jsxs("div",{className:"w-full max-w-2xl rounded-lg border border-border bg-panel shadow-[0_20px_50px_rgba(0,0,0,0.55)]",onClick:I=>I.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Find similar",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Find similar"}),a.jsx("div",{className:"text-xs text-muted",children:"Search with embeddings"})]}),a.jsx("button",{className:"btn btn-sm",onClick:o,"aria-label":"Close",children:"Close"})]}),a.jsxs("div",{className:"px-4 py-4 space-y-4",children:[i&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:i}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Embedding"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(lh,{value:(P==null?void 0:P.name)??"",onChange:d,options:q,placeholder:s?"Loading embeddings...":"Select embedding",disabled:!t.length,triggerClassName:"min-w-[180px]"}),P&&a.jsxs("span",{className:"text-xs text-muted",children:[P.dimension," dims, ",P.metric,", ",P.dtype]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Query mode"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:`btn btn-sm ${f==="path"?"btn-active":""}`,onClick:()=>p("path"),"aria-pressed":f==="path",children:"Selected image"}),a.jsx("button",{type:"button",className:`btn btn-sm ${f==="vector"?"btn-active":""}`,onClick:()=>p("vector"),"aria-pressed":f==="vector",children:"Vector input"})]})]}),f==="path"?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Image path"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{ref:M,type:"text",className:"input w-full",value:h,onChange:I=>w(I.target.value),placeholder:r?"Selected image path":"Select an image first"}),a.jsx("button",{type:"button",className:"btn btn-sm",onClick:F,disabled:!r,title:r?"Use selected image":"Select an image first",children:"Use selected"})]})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Vector (base64 float32)"}),a.jsx("textarea",{ref:_,className:"ui-textarea w-full font-mono text-[11px]",rows:5,value:x,onChange:I=>S(I.target.value),placeholder:"Paste base64-encoded float32 vector"}),a.jsx("div",{className:"text-[11px] text-muted",children:"Base64 of little-endian float32. Length must match embedding dimension."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Top K"}),a.jsx("input",{type:"number",min:1,max:1e3,step:1,className:"input ui-number w-full",value:C,onChange:I=>y(I.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Min score"}),a.jsx("input",{type:"number",step:.01,className:"input ui-number w-full",value:g,onChange:I=>v(I.target.value),placeholder:"Optional"})]})]}),Z&&a.jsxs("div",{className:"ui-banner text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Skipped columns"}),a.jsxs("div",{className:"mt-1 space-y-1 text-muted",children:[B.map(I=>a.jsxs("div",{children:[I.name,": ",I.reason]},I.name)),n.length>B.length&&a.jsxs("div",{children:["+",n.length-B.length," more"]})]})]}),m&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:m})]}),a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-border",children:[a.jsx("div",{className:"text-xs text-muted",children:P?`Metric: ${P.metric}`:"Metric: cosine"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:o,disabled:E,children:"Cancel"}),a.jsx("button",{className:"btn btn-sm btn-active",onClick:U,disabled:E||!t.length,children:E?"Searching...":"Find similar"})]})]})]})})}const OE=/^[\/@a-zA-Z0-9._\-\/]{1,512}$/,DE=[".jpg",".jpeg",".png",".webp"];function Pt(e){try{const t=decodeURI(e||""),r=(t.startsWith("/")?t:`/${t}`).replace(/\/{2,}/g,"/"),s=r.length>1?r.replace(/\/$/,""):r;return OE.test(s)?s:"/"}catch{return"/"}}function Hm(){return(window.location.hash||"").replace(/^#/,"")}function Fx(e){const t=Pt(e),n=`#${encodeURI(t)}`;window.location.hash!==n&&(window.location.hash=n)}function Vl(e){const t=Pt(e),n=`#${encodeURI(t)}`;if(window.location.hash!==n){const r=`${window.location.pathname}${window.location.search}${n}`;window.history.replaceState(window.history.state,"",r)}}function zE(e){const n=Pt(e).toLowerCase();return DE.some(r=>n.endsWith(r))}function Ox(e,t){const n=e.replace(/\/+$/,""),r=t.replace(/^\/+/,""),s=[n,r].filter(Boolean).join("/");return s.startsWith("/")?s:`/${s}`}function Qm(e){const n=Pt(e).split("/").filter(Boolean);return n.length<=1?"/":"/"+n.slice(0,-1).join("/")}function mh(e){return Pt(e).split("/").filter(Boolean).pop()||""}function $E(e){return e.endsWith("/_trash_")}const BE=new Set([0,1,2,3,4,5]),gh=new Set(["<","<=",">",">="]),UE=/^\d{4}-\d{2}-\d{2}$/;function VE(e,t){return!t||!t.and.length?e:e.filter(n=>WE(n,t.and))}function WE(e,t){for(const n of t)if(!HE(e,n))return!1;return!0}function HE(e,t){var n,r,s,i,o,l,c;if("stars"in t){const d=t.stars;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsIn"in t){const d=t.starsIn.values;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsNotIn"in t){const d=t.starsNotIn.values;if(!d||!d.length)return!0;const f=e.star??0;return!d.includes(f)}if("nameContains"in t){const d=(n=t.nameContains.value)==null?void 0:n.trim();return d?(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("nameNotContains"in t){const d=(r=t.nameNotContains.value)==null?void 0:r.trim();return d?!(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("commentsContains"in t){const d=(s=t.commentsContains.value)==null?void 0:s.trim();if(!d)return!0;const f=e.comments??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("commentsNotContains"in t){const d=(i=t.commentsNotContains.value)==null?void 0:i.trim();if(!d)return!0;const f=e.comments??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("urlContains"in t){const d=(o=t.urlContains.value)==null?void 0:o.trim();if(!d)return!0;const f=e.source??e.url??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("urlNotContains"in t){const d=(l=t.urlNotContains.value)==null?void 0:l.trim();if(!d)return!0;const f=e.source??e.url??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("dateRange"in t){const{from:d,to:f}=t.dateRange;if(!d&&!f)return!0;if(!e.addedAt)return!1;const p=Date.parse(e.addedAt);if(Number.isNaN(p))return!1;const h=Gm(d,!1),w=Gm(f,!0);return!(h!=null&&p<h||w!=null&&p>w)}if("widthCompare"in t){const{op:d,value:f}=t.widthCompare;if(!Number.isFinite(f))return!0;const p=e.w;return!Number.isFinite(p)||p<=0?!1:Ym(p,d,f)}if("heightCompare"in t){const{op:d,value:f}=t.heightCompare;if(!Number.isFinite(f))return!0;const p=e.h;return!Number.isFinite(p)||p<=0?!1:Ym(p,d,f)}if("metricRange"in t){const{key:d,min:f,max:p}=t.metricRange,h=(c=e.metrics)==null?void 0:c[d];return!(h==null||h<f||h>p)}return!0}function tf(e){if(!e||typeof e!="object")return null;const t=e.and;if(!Array.isArray(t))return null;const n=[];for(const r of t){const s=oN(r);s&&n.push(s)}return{and:n}}function Km(e){var r;const t=e.and.find(s=>"stars"in s),n=e.and.find(s=>"starsIn"in s);return(r=n==null?void 0:n.starsIn)!=null&&r.values?n.starsIn.values:(t==null?void 0:t.stars)??[]}function Rc(e,t){return Dx(e,t)}function QE(e){var n;const t=e.and.find(r=>"starsIn"in r);return((n=t==null?void 0:t.starsIn)==null?void 0:n.values)??[]}function Dx(e,t){const n=No(t),r=e.and.filter(s=>!("starsIn"in s)&&!("stars"in s));return n.length?{and:[{starsIn:{values:n}},...r]}:{and:r}}function KE(e){var n;const t=e.and.find(r=>"starsNotIn"in r);return((n=t==null?void 0:t.starsNotIn)==null?void 0:n.values)??[]}function zx(e,t){const n=No(t),r=e.and.filter(s=>!("starsNotIn"in s));return n.length?{and:[{starsNotIn:{values:n}},...r]}:{and:r}}function qE(e){var n;const t=e.and.find(r=>"nameContains"in r);return((n=t==null?void 0:t.nameContains)==null?void 0:n.value)??null}function $x(e,t){const n=vn(t),r=e.and.filter(s=>!("nameContains"in s));return n?{and:[{nameContains:{value:n}},...r]}:{and:r}}function GE(e){var n;const t=e.and.find(r=>"nameNotContains"in r);return((n=t==null?void 0:t.nameNotContains)==null?void 0:n.value)??null}function Bx(e,t){const n=vn(t),r=e.and.filter(s=>!("nameNotContains"in s));return n?{and:[{nameNotContains:{value:n}},...r]}:{and:r}}function YE(e){var n;const t=e.and.find(r=>"commentsContains"in r);return((n=t==null?void 0:t.commentsContains)==null?void 0:n.value)??null}function Ux(e,t){const n=vn(t),r=e.and.filter(s=>!("commentsContains"in s));return n?{and:[{commentsContains:{value:n}},...r]}:{and:r}}function XE(e){var n;const t=e.and.find(r=>"commentsNotContains"in r);return((n=t==null?void 0:t.commentsNotContains)==null?void 0:n.value)??null}function Vx(e,t){const n=vn(t),r=e.and.filter(s=>!("commentsNotContains"in s));return n?{and:[{commentsNotContains:{value:n}},...r]}:{and:r}}function JE(e){var n;const t=e.and.find(r=>"urlContains"in r);return((n=t==null?void 0:t.urlContains)==null?void 0:n.value)??null}function Wx(e,t){const n=vn(t),r=e.and.filter(s=>!("urlContains"in s));return n?{and:[{urlContains:{value:n}},...r]}:{and:r}}function ZE(e){var n;const t=e.and.find(r=>"urlNotContains"in r);return((n=t==null?void 0:t.urlNotContains)==null?void 0:n.value)??null}function Hx(e,t){const n=vn(t),r=e.and.filter(s=>!("urlNotContains"in s));return n?{and:[{urlNotContains:{value:n}},...r]}:{and:r}}function eN(e){const t=e.and.find(n=>"dateRange"in n);return(t==null?void 0:t.dateRange)??null}function nf(e,t){const n=Xa((t==null?void 0:t.from)??null),r=Xa((t==null?void 0:t.to)??null),s=e.and.filter(i=>!("dateRange"in i));return!n&&!r?{and:s}:{and:[{dateRange:{...n?{from:n}:{},...r?{to:r}:{}}},...s]}}function tN(e){const t=e.and.find(n=>"widthCompare"in n);return(t==null?void 0:t.widthCompare)??null}function ha(e,t){const n=e.and.filter(r=>!("widthCompare"in r));return!t||!Number.isFinite(t.value)||!gh.has(t.op)?{and:n}:{and:[{widthCompare:{op:t.op,value:t.value}},...n]}}function nN(e){const t=e.and.find(n=>"heightCompare"in n);return(t==null?void 0:t.heightCompare)??null}function pa(e,t){const n=e.and.filter(r=>!("heightCompare"in r));return!t||!Number.isFinite(t.value)||!gh.has(t.op)?{and:n}:{and:[{heightCompare:{op:t.op,value:t.value}},...n]}}function rN(e,t){const n=e.and.find(r=>"metricRange"in r&&r.metricRange.key===t);return(n==null?void 0:n.metricRange)??null}function sN(e,t,n){const r=e.and.filter(s=>!("metricRange"in s&&s.metricRange.key===t));return n?{and:[{metricRange:{key:t,min:n.min,max:n.max}},...r]}:{and:r}}function iN(e){const t=tf(e);return t?t.and.length:0}function oN(e){var t,n,r,s,i,o,l,c;if(!e||typeof e!="object")return null;if("stars"in e){const d=No(e.stars);return d.length?{starsIn:{values:d}}:null}if("starsIn"in e){const d=No((t=e.starsIn)==null?void 0:t.values);return d.length?{starsIn:{values:d}}:null}if("starsNotIn"in e){const d=No((n=e.starsNotIn)==null?void 0:n.values);return d.length?{starsNotIn:{values:d}}:null}if("nameContains"in e){const d=vn((r=e.nameContains)==null?void 0:r.value);return d?{nameContains:{value:d}}:null}if("nameNotContains"in e){const d=vn((s=e.nameNotContains)==null?void 0:s.value);return d?{nameNotContains:{value:d}}:null}if("commentsContains"in e){const d=vn((i=e.commentsContains)==null?void 0:i.value);return d?{commentsContains:{value:d}}:null}if("commentsNotContains"in e){const d=vn((o=e.commentsNotContains)==null?void 0:o.value);return d?{commentsNotContains:{value:d}}:null}if("urlContains"in e){const d=vn((l=e.urlContains)==null?void 0:l.value);return d?{urlContains:{value:d}}:null}if("urlNotContains"in e){const d=vn((c=e.urlNotContains)==null?void 0:c.value);return d?{urlNotContains:{value:d}}:null}if("dateRange"in e){const d=e.dateRange,f=Xa((d==null?void 0:d.from)??null),p=Xa((d==null?void 0:d.to)??null);return!f&&!p?null:{dateRange:{...f?{from:f}:{},...p?{to:p}:{}}}}if("widthCompare"in e){const d=e.widthCompare,f=qm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{widthCompare:f}:null}if("heightCompare"in e){const d=e.heightCompare,f=qm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{heightCompare:f}:null}if("metricRange"in e){const d=e.metricRange;if(!d||typeof d!="object")return null;const f=typeof d.key=="string"?d.key:"",p=rf(d.min),h=rf(d.max);return!f||p==null||h==null||p>h?null:{metricRange:{key:f,min:p,max:h}}}return null}function No(e){if(!Array.isArray(e))return[];const t=[],n=new Set;for(const r of e){const s=typeof r=="number"?r:typeof r=="string"?Number(r):NaN;!Number.isInteger(s)||!BE.has(s)||n.has(s)||(n.add(s),t.push(s))}return t}function vn(e){if(typeof e!="string")return null;const t=e.trim();return t||null}function Xa(e){if(typeof e!="string")return null;const t=e.trim();if(!t)return null;const n=Date.parse(t);return Number.isNaN(n)?null:t}function qm(e,t){if(typeof e!="string"||!gh.has(e))return null;const n=rf(t);return n==null?null:{op:e,value:n}}function Gm(e,t){if(!e)return null;const n=e.trim();if(!n)return null;const r=Date.parse(n);return Number.isNaN(r)?null:t&&UE.test(n)?r+24*60*60*1e3-1:r}function Ym(e,t,n){switch(t){case"<":return e<n;case"<=":return e<=n;case">":return e>n;case">=":return e>=n;default:return!0}}function rf(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null}const ps={leftFolders:"leftW.folders",leftMetrics:"leftW.metrics",leftLegacy:"leftW",right:"rightW"},Xm=200,Jm=240,Qx=200;function lN(e){return Number.isFinite(e)&&e>0}function Wl(e){const t=Number(e);return lN(t)?t:null}function Kx(e,t,n){return Math.min(Math.max(e,t),n)}function aN(e){return e==="metrics"?ps.leftMetrics:ps.leftFolders}function uN(e){const t=Wl(e.getItem(ps.leftFolders))??Wl(e.getItem(ps.leftLegacy)),n=Wl(e.getItem(ps.leftMetrics)),r=Wl(e.getItem(ps.right));return{leftFoldersW:t,leftMetricsW:n,rightW:r}}function Zm(e,t,n){e.setItem(t,String(n))}function cN({clientX:e,appLeft:t,appWidth:n,rightWidth:r}){const s=e-t,i=Math.max(Xm,n-r-Qx);return Kx(s,Xm,i)}function dN({clientX:e,appLeft:t,appWidth:n,leftWidth:r}){const s=e-t,i=n-s,o=Math.max(Jm,n-r-Qx);return Kx(i,Jm,o)}function fN(e){return(e.pointerType??"mouse")==="mouse"&&e.button!==0}function hN(e,t){try{e.setPointerCapture(t)}catch{}}function pN(e,t){try{e.releasePointerCapture(t)}catch{}}function mN(e,t){const[n,r]=u.useState(240),[s,i]=u.useState(320),[o,l]=u.useState(240),c=t==="metrics"?s:n,d=u.useRef(c),f=u.useRef(o);u.useEffect(()=>{d.current=c},[c]),u.useEffect(()=>{f.current=o},[o]),u.useEffect(()=>{try{const x=uN(window.localStorage);x.leftFoldersW!==null&&r(x.leftFoldersW),x.leftMetricsW!==null&&i(x.leftMetricsW),x.rightW!==null&&l(x.rightW)}catch{}},[]);const p=(x,S,C)=>{if(fN(x))return;x.preventDefault();const y=x.currentTarget,g=x.pointerId;hN(y,g);const v=E=>{E.pointerId===g&&S(E)};function m(){window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",b),window.removeEventListener("pointercancel",b),pN(y,g)}function b(E){E.pointerId===g&&(m(),C())}window.addEventListener("pointermove",v),window.addEventListener("pointerup",b),window.addEventListener("pointercancel",b)};return{leftW:c,rightW:o,onResizeLeft:x=>{const S=e.current;if(!S)return;const C=S.getBoundingClientRect(),y=aN(t);let g=d.current;p(x,v=>{const m=cN({clientX:v.clientX,appLeft:C.left,appWidth:C.width,rightWidth:f.current});g=m,t==="metrics"?i(m):r(m)},()=>{try{Zm(window.localStorage,y,g)}catch{}})},onResizeRight:x=>{const S=e.current;if(!S)return;const C=S.getBoundingClientRect();let y=f.current;p(x,g=>{const v=dN({clientX:g.clientX,appLeft:C.left,appWidth:C.width,leftWidth:d.current});y=v,f.current=v,l(v)},()=>{try{Zm(window.localStorage,ps.right,y)}catch{}})}}}const qx=1,ma=200,gN=5*6e4,yN=6e4,Gx=(e,t)=>t!=null&&t.recursive?["folder",e,"recursive",t.page??qx,t.pageSize??ma]:["folder",e];function Yx(e){return e[0]!=="folder"||e[2]!=="recursive"||typeof e[1]!="string"||typeof e[3]!="number"||typeof e[4]!="number"?null:e}function vN(e){return Yx(e)!==null}function xN(e,t,n=!0){if(!vN(e))return!0;const r=Yx(e);if(r==null)return!1;const[,s,,i]=r;return i!==qx?!1:!!(s===t||n&&s==="/")}function wN(e,t,n=!0){return!Array.isArray(e)||e[0]!=="folder"?!1:!xN(e,t,n)}const SN=15e3;function bN(e,t){return pe.getFolder(e,t)}function sf(e,t=!1,n){const r=xu(),s={recursive:t,page:n==null?void 0:n.page,pageSize:n==null?void 0:n.pageSize},i=!!s.recursive;return gu({queryKey:Gx(e,s),queryFn:()=>bN(e,s),enabled:(n==null?void 0:n.enabled)??!0,staleTime:1e4,gcTime:i?yN:gN,retry:2,retryDelay:o=>Math.min(1e3*Math.pow(2,o),5e3),refetchOnWindowFocus:!1,refetchInterval:r?SN:!1,refetchIntervalInBackground:r})}const Xx="application/x-lenslet-paths",CN='[role="treeitem"].drop-target';function eg(e){var n;return Array.from(((n=e.dataTransfer)==null?void 0:n.types)||[]).includes(Xx)}function kN(e){document.querySelectorAll(CN).forEach(t=>{t!==e&&t.classList.remove("drop-target")})}function tg(e){kN(e),e.classList.add("drop-target")}function ng(e){return e.startsWith("/")?e:`/${e}`}function EN({path:e,isLeaf:t}){const n=vr(),r=u.useCallback(l=>{eg(l)&&(l.preventDefault(),t&&tg(l.currentTarget))},[t]),s=u.useCallback(l=>{!t||!eg(l)||(l.preventDefault(),tg(l.currentTarget))},[t]),i=u.useCallback(l=>{const c=l.currentTarget,d=document.elementFromPoint(l.clientX,l.clientY);d&&c.contains(d)||c.classList.remove("drop-target")},[]),o=u.useCallback(async l=>{const c=l.dataTransfer;if(!c)return;l.preventDefault(),l.currentTarget.classList.remove("drop-target");const d=c.getData(Xx),p=(d?JSON.parse(d):[]).filter(Boolean);if(!p.length)return;let h=p[0].split("/").slice(0,-1).join("/")||"/";h=ng(h);const w=ng(e);try{for(const x of p)await pe.moveFile(x,w);n.invalidateQueries({queryKey:["folder",h]}),n.invalidateQueries({queryKey:["folder",w]}),n.setQueryData(["folder",h],x=>!x||!Array.isArray(x.items)?x:{...x,items:x.items.filter(S=>!p.includes(S.path))})}catch{}},[e,n]);return{onDragOver:r,onDragEnter:s,onDragLeave:i,onDrop:o}}const NN='[role="tree"] [role="treeitem"]';function jN(){return Array.from(document.querySelectorAll(NN))}function MN(e,t){var i;const n=jN(),r=n.findIndex(o=>o===e);if(r===-1)return;let s=r;t==="ArrowDown"?s=Math.min(n.length-1,r+1):t==="ArrowUp"?s=Math.max(0,r-1):t==="Home"?s=0:t==="End"&&(s=n.length-1),(i=n[s])==null||i.focus()}function PN({path:e,isLeaf:t,isExpanded:n,setExpanded:r,onOpen:s}){return u.useCallback(i=>{if(i.key==="Enter"){i.preventDefault(),s(e);return}if(i.key==="ArrowRight"){!t&&!n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.add(e),l}));return}if(i.key==="ArrowLeft"){!t&&n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.delete(e),l}));return}(i.key==="ArrowDown"||i.key==="ArrowUp"||i.key==="Home"||i.key==="End")&&(i.preventDefault(),MN(i.currentTarget,i.key))},[e,t,n,r,s])}const rg=64,RN=120;function TN(e){const t=e.split("/").filter(Boolean),n=["/"];let r="";for(const s of t)r=r?`${r}/${s}`:`/${s}`,n.push(r);return n}function IN({current:e,roots:t,data:n,onOpen:r,onPullRefresh:s,onResize:i,onContextMenu:o,onOpenActions:l,countVersion:c,className:d,showResizeHandle:f=!0}){const[p,h]=u.useState(new Set(["/"])),w=u.useRef(new Map),x=u.useRef(new Map),[S,C]=u.useState(!1),[y,g]=u.useState(0),v=u.useRef(null),m=u.useRef(!1),b=vr(),E=u.useCallback(()=>{g(0),v.current=null,m.current=!1},[]),j=u.useCallback(async R=>{const T=Pt(R||"/"),L=w.current,O=x.current,Q=L.get(T);if(Q!==void 0)return Q;const V=b.getQueryData(Gx(T,{recursive:!0}));if(V){const W=V.totalItems??V.items.length;return L.set(T,W),W}const A=O.get(T);if(A)return A;const K=(async()=>{try{const W=await pe.getFolder(T,{recursive:!0}),X=W.totalItems??W.items.length;return L.set(T,X),X}finally{O.delete(T)}})();return O.set(T,K),K},[b]);u.useEffect(()=>{w.current.clear(),x.current.clear()},[c]),u.useEffect(()=>{const R=TN(e);h(T=>{const L=new Set(T);for(const O of R)L.add(O);return L})},[e]);const M=u.useCallback(async()=>{if(!(!s||S)){C(!0);try{await s()}catch(R){console.error("Failed to refresh folders:",R)}finally{C(!1),g(0)}}},[s,S]),_=u.useCallback(R=>{!s||S||R.touches.length===1&&(R.currentTarget.scrollTop>0||(v.current=R.touches[0].clientY,m.current=!1))},[s,S]),P=u.useCallback(R=>{if(!s||S||R.touches.length!==1)return;const T=v.current;if(T==null)return;if(R.currentTarget.scrollTop>0){E();return}const L=R.touches[0].clientY-T;if(L<=0){m.current&&g(0);return}!m.current&&L<8||(m.current=!0,R.preventDefault(),g(Math.min(RN,L*.55)))},[S,s,E]),U=u.useCallback(()=>{if(!s||S){E();return}const R=m.current&&y>=rg;if(v.current=null,m.current=!1,R){M();return}g(0)},[M,S,s,y,E]),F=d??"h-full overflow-auto bg-panel scrollbar-thin",q=s?`${F} overscroll-y-contain`:F,Z=!!s&&(S||y>0),B=y>=rg,I=S?28:Math.min(44,y);return a.jsxs("div",{className:q,onTouchStart:s?_:void 0,onTouchMove:s?P:void 0,onTouchEnd:s?U:void 0,onTouchCancel:s?U:void 0,children:[Z&&a.jsx("div",{className:"flex items-end justify-center text-[11px] text-muted select-none transition-[height,opacity] duration-150",style:{height:I,opacity:S||y>8?1:.65},"aria-live":"polite",children:S?"Refreshing":B?"Release to refresh":"Pull to refresh"}),a.jsx("div",{className:"p-1",role:"tree","aria-label":"Folders",children:t.map(R=>a.jsx(Jx,{path:R.path,label:R.label,depth:0,current:e,expanded:p,setExpanded:h,onOpen:r,onContextMenu:o,onOpenActions:l,initial:n,getSubtreeCount:j,countVersion:c},R.path))}),f&&a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 left-[calc(var(--left)-6px)]",onPointerDown:i})]})}function Jx({path:e,label:t,depth:n,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:c,initial:d,getSubtreeCount:f,countVersion:p}){var F;const h=s.has(e),w=r===e,x=e==="/"||h||w,{data:S}=sf(e,!1,{enabled:x}),C=d&&e===d.path?d:S,g=!!C?C.dirs.length===0:!1,[v,m]=u.useState(C?C.items.length:null),b=PN({path:e,isLeaf:g,isExpanded:h,setExpanded:i,onOpen:o}),{onDragOver:E,onDragEnter:j,onDragLeave:M,onDrop:_}=EN({path:e,isLeaf:g}),P=q=>{q.stopPropagation(),!g&&i(Z=>{const B=new Set(Z);return B.has(e)?B.delete(e):B.add(e),B})},U=q=>{if(q.stopPropagation(),!c)return;const Z=q.currentTarget.getBoundingClientRect();c(e,{x:Z.right-4,y:Z.bottom-4})};return u.useEffect(()=>{let q=!1;if(!C){m(null);return}if(m(C.items.length),!!(h&&(n>0||w)))return f(e).then(B=>{q||m(B)}).catch(B=>{q||console.warn(`Failed to compute subtree count for ${e}:`,B)}),()=>{q=!0}},[C,e,f,p,h,n,w]),a.jsxs("div",{children:[a.jsxs("div",{className:`tree-row flex items-center gap-1.5 py-1 px-2 rounded-md cursor-pointer min-h-[40px] outline-none transition-colors duration-75 ${w?"bg-accent/20 text-accent font-medium":"hover:bg-white/5 text-text"}`,role:"treeitem","aria-level":n+1,"aria-expanded":g?void 0:h,"aria-selected":w,tabIndex:w?0:-1,style:{paddingLeft:8+n*14},onClick:()=>o(e),onContextMenu:q=>{q.preventDefault(),q.stopPropagation(),l==null||l(q,e)},onKeyDown:b,onDragOver:E,onDragEnter:j,onDragLeave:M,onDrop:_,children:[a.jsx("button",{type:"button",className:"tree-expand-btn touch-manipulation",onClick:P,"aria-label":g?`No subfolders in ${t}`:`${h?"Collapse":"Expand"} ${t}`,"aria-expanded":g?void 0:h,disabled:g,children:g?"":h?"":""}),a.jsx("span",{className:"flex-1 overflow-hidden truncate text-sm",title:t,children:Ak(t,28)}),v!==null&&a.jsx("span",{className:"text-[10px] opacity-50 bg-white/5 border border-white/5 rounded px-1.5 min-w-[24px] text-center",children:v}),c&&a.jsx("button",{type:"button",className:"tree-row-action-btn touch-manipulation","aria-label":`Open actions for ${t}`,"aria-haspopup":"menu",onPointerDown:q=>q.stopPropagation(),onClick:U,children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]}),h&&((F=C==null?void 0:C.dirs)==null?void 0:F.map(q=>a.jsx(Jx,{path:Ox(e,q.name),label:q.name,depth:n+1,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:c,getSubtreeCount:f,countVersion:p},q.name)))]})}const sg=[5,4,3,2,1],ig=["<","<=",">",">="];function _N({filters:e,onChangeFilters:t}){const n=u.useMemo(()=>QE(e),[e]),r=u.useMemo(()=>KE(e),[e]),s=u.useMemo(()=>qE(e)??"",[e]),i=u.useMemo(()=>GE(e)??"",[e]),o=u.useMemo(()=>YE(e)??"",[e]),l=u.useMemo(()=>XE(e)??"",[e]),c=u.useMemo(()=>JE(e)??"",[e]),d=u.useMemo(()=>ZE(e)??"",[e]),f=u.useMemo(()=>eN(e)??{},[e]),p=u.useMemo(()=>og(f.from),[f.from]),h=u.useMemo(()=>og(f.to),[f.to]),w=u.useMemo(()=>tN(e),[e]),x=u.useMemo(()=>nN(e),[e]),[S,C]=u.useState((w==null?void 0:w.op)??">="),[y,g]=u.useState((x==null?void 0:x.op)??">=");u.useEffect(()=>{w!=null&&w.op&&C(w.op)},[w==null?void 0:w.op]),u.useEffect(()=>{x!=null&&x.op&&g(x.op)},[x==null?void 0:x.op]);const v=(m,b)=>{const E=new Set(n),j=new Set(r);m==="include"?E.has(b)?E.delete(b):(E.add(b),j.delete(b)):j.has(b)?j.delete(b):(j.add(b),E.delete(b));let M=Dx(e,Array.from(E));M=zx(M,Array.from(j)),t(M)};return a.jsxs("div",{className:"ui-card",children:[a.jsx("div",{className:"ui-section-title mb-3",children:"Attributes"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Rating"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Include"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[sg.map(m=>{const b=n.includes(m);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${b?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("include",m),"aria-pressed":b,title:`Include ${m} star${m>1?"s":""}`,children:[m,""]},`stars-in-${m}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${n.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("include",0),"aria-pressed":n.includes(0),title:"Include unrated",children:"None"})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Exclude"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[sg.map(m=>{const b=r.includes(m);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${b?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("exclude",m),"aria-pressed":b,title:`Exclude ${m} star${m>1?"s":""}`,children:[m,""]},`stars-out-${m}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${r.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("exclude",0),"aria-pressed":r.includes(0),title:"Exclude unrated",children:"None"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Filename"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:s,placeholder:"e.g. draft",onChange:m=>t($x(e,m.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:i,placeholder:"e.g. v1",onChange:m=>t(Bx(e,m.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Comments"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:o,placeholder:"e.g. hero",onChange:m=>t(Ux(e,m.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:l,placeholder:"e.g. todo",onChange:m=>t(Vx(e,m.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"URL"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:c,placeholder:"e.g. s3://bucket",onChange:m=>t(Wx(e,m.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:d,placeholder:"e.g. http://",onChange:m=>t(Hx(e,m.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Date Added"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"From"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:p,onChange:m=>t(nf(e,{from:m.target.value||null,to:f.to??null}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"To"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:h,onChange:m=>t(nf(e,{from:f.from??null,to:m.target.value||null}))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Dimensions"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Width"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:S,onChange:m=>{const b=m.target.value;C(b),w&&t(ha(e,{op:b,value:w.value}))},children:ig.map(m=>a.jsx("option",{value:m,children:m},`w-${m}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:w?String(w.value):"",min:0,placeholder:"px",onChange:m=>{const b=m.target.value;if(!b){t(ha(e,null));return}const E=Number(b);Number.isFinite(E)&&t(ha(e,{op:S,value:E}))}})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Height"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:y,onChange:m=>{const b=m.target.value;g(b),x&&t(pa(e,{op:b,value:x.value}))},children:ig.map(m=>a.jsx("option",{value:m,children:m},`h-${m}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:x?String(x.value):"",min:0,placeholder:"px",onChange:m=>{const b=m.target.value;if(!b){t(pa(e,null));return}const E=Number(b);Number.isFinite(E)&&t(pa(e,{op:y,value:E}))}})]})]})]})]})]})]})}function og(e){return e?e.length>=10?e.slice(0,10):e:""}const LN=[];function of(e,t){if(t!=null&&t.length)return AN(e,t);const n=new Map;for(const r of e){const s=r.metrics;if(s)for(const[i,o]of Object.entries(s)){if(o==null||Number.isNaN(o))continue;const l=n.get(i);l?l.push(o):n.set(i,[o])}}return n}function AN(e,t){const n=t.map(s=>({key:s,values:[]}));for(const s of e){const i=s.metrics;if(i)for(const o of n){const l=i[o.key];l==null||Number.isNaN(l)||o.values.push(l)}}const r=new Map;for(const s of n)s.values.length&&r.set(s.key,s.values);return r}function Hs(e,t){return e.get(t)??LN}function Tc(e,t,n){if(!e.length)return null;const r=n?n.min:Math.min(...e);let s=n?n.max:Math.max(...e);r===s&&(s=r+1);const i=new Array(t).fill(0),o=t/(s-r);for(const l of e){const c=Math.max(0,Math.min(t-1,Math.floor((l-r)*o)));i[c]+=1}return{bins:i,min:r,max:s,count:e.length}}function Zx(e,t){return e<t?{min:e,max:t}:{min:t,max:e}}function nn(e){return Nx(e)}function Cr(e){if(!Number.isFinite(e))return"";const t=e.toString();return t.includes("e")?e.toFixed(6):t}function lg(e){const t=e.trim();if(!t)return{value:null,valid:!0};const n=Number(t);return Number.isFinite(n)?{value:n,valid:!0}:{value:null,valid:!1}}function ag(e,t,n){return e<t?t:e>n?n:e}function yh(e){return e<0?0:e>1?1:e}function Qs(e,t){const n=Math.max(1,Math.abs(e),Math.abs(t));return Math.abs(e-t)<=1e-6*n}function FN(e,t,n){const r=yh((e-t.left)/t.width);return n.min+(n.max-n.min)*r}function ON(e,t,n=4){return e==null?!1:Math.abs(t-e)>=n}function e0(e,t){return Zx(e??t,t)}function DN(e,t,n,r){return e&&t!=null?{commitRange:e0(n,t),shouldClear:!1}:{commitRange:null,shouldClear:r!=null}}function zN({metricKey:e,domain:t,activeRange:n,onChangeRange:r}){const[s,i]=u.useState(null),[o,l]=u.useState(!1),c=u.useRef(null),d=u.useRef(null),f=u.useRef(!1),p=u.useRef(null),[h,w]=u.useState(null),x=s??n;u.useEffect(()=>{w(null)},[e,t==null?void 0:t.min,t==null?void 0:t.max]);const S=v=>{var b;if(!t)return null;const m=(b=p.current)==null?void 0:b.getBoundingClientRect();return m?FN(v,{left:m.left,width:m.width},t):null};return{svgRef:p,hoverValue:h,displayRange:x,onPointerDown:v=>{var b;if(!t)return;v.preventDefault();const m=S(v.clientX);m!=null&&(l(!0),i(null),c.current=m,d.current=v.clientX,f.current=!1,w(m),(b=p.current)==null||b.setPointerCapture(v.pointerId))},onPointerMove:v=>{const m=S(v.clientX);if(m==null){o||w(null);return}w(m),o&&(!f.current&&!ON(d.current,v.clientX)||(f.current=!0,i(e0(c.current,m))))},onPointerUp:v=>{var E;if(!o)return;l(!1),(E=p.current)==null||E.releasePointerCapture(v.pointerId);const m=S(v.clientX),b=DN(f.current,m,c.current,n);b.commitRange?(w(m),r(b.commitRange)):b.shouldClear&&r(null),c.current=null,d.current=null,f.current=!1,setTimeout(()=>i(null),0)},onPointerLeave:()=>w(null)}}const ms=40;function ug({metricKey:e,populationValues:t,filteredValues:n,selectedValues:r=[],filters:s,onChangeRange:i,showTitle:o=!1}){const l=u.useMemo(()=>Tc(t,ms),[t]),c=u.useMemo(()=>l?Tc(n,ms,l):null,[n,l]),d=rN(s,e),f=l?{min:l.min,max:l.max}:null,{svgRef:p,hoverValue:h,displayRange:w,onPointerDown:x,onPointerMove:S,onPointerUp:C,onPointerLeave:y}=zN({metricKey:e,domain:f,activeRange:d,onChangeRange:F=>i(e,F)}),[g,v]=u.useState(""),[m,b]=u.useState(""),[E,j]=u.useState(null),M=r.length===1?r[0]:null,_=u.useMemo(()=>!l||r.length<2?null:Tc(r,ms,l),[r,l]);u.useEffect(()=>{if(!d||!f){E!=="min"&&v(d?Cr(d.min):""),E!=="max"&&b(d?Cr(d.max):"");return}if(E!=="min"){const F=Qs(d.min,f.min)?"":Cr(d.min);v(F)}if(E!=="max"){const F=Qs(d.max,f.max)?"":Cr(d.max);b(F)}},[d,f,E]);const P=(F,q)=>{if(!f)return;const Z=lg(F),B=lg(q);if(!Z.valid||!B.valid){Z.valid||v(d?Cr(d.min):""),B.valid||b(d?Cr(d.max):"");return}if(Z.value==null&&B.value==null){i(e,null);return}const I=Z.value??f.min,R=B.value??f.max,T=ag(I,f.min,f.max),L=ag(R,f.min,f.max),O=Zx(T,L);if(Qs(O.min,f.min)&&Qs(O.max,f.max)){i(e,null);return}i(e,O)};if(!l||!f)return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]});const U=r.length;return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mb-2 tabular-nums",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{children:["Population: ",l.count]}),a.jsxs("span",{children:["Filtered: ",(c==null?void 0:c.count)??0]}),U>1&&a.jsxs("span",{className:"text-text",children:["Selected: ",U]})]}),M!=null&&a.jsxs("span",{className:"text-text",children:["Selected: ",nn(M)]})]}),a.jsxs("svg",{ref:p,viewBox:`0 0 ${ms} 100`,preserveAspectRatio:"none",className:"w-full h-28 cursor-crosshair rounded-md bg-surface-inset",onPointerDown:x,onPointerMove:S,onPointerUp:C,onPointerLeave:y,children:[Ic(l.bins,"#2e3a4b"),c&&Ic(c.bins,"#3a8fff"),_&&Ic(_.bins,"#f59e0b",{opacity:.55}),w&&$N(w,f),M!=null&&cg(M,f,{color:"var(--highlight)",strokeWidth:.7}),h!=null&&cg(h,f,{color:"rgba(255,255,255,0.75)",strokeWidth:.5,dashed:!0})]}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mt-2 tabular-nums",children:[a.jsx("span",{children:nn(f.min)}),a.jsxs("div",{className:"flex flex-col items-center text-center leading-tight",children:[w?a.jsx("span",{className:"text-text",children:Qs(w.min,f.min)?` ${nn(w.max)}`:Qs(w.max,f.max)?` ${nn(w.min)}`:`${nn(w.min)}  ${nn(w.max)}`}):h!=null?a.jsxs("span",{className:"text-text",children:["Cursor: ",nn(h)]}):a.jsx("span",{children:"Drag to filter"}),w&&h!=null&&a.jsxs("span",{className:"text-[11px] text-muted",children:["Cursor: ",nn(h)]})]}),a.jsx("span",{children:nn(f.max)})]}),a.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2 mt-3 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Min"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:g,placeholder:Cr(f.min),onFocus:()=>j("min"),onBlur:()=>{j(null),P(g,m)},onChange:F=>v(F.target.value),onKeyDown:F=>{F.key==="Enter"&&F.currentTarget.blur()}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Max"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:m,placeholder:Cr(f.max),onFocus:()=>j("max"),onBlur:()=>{j(null),P(g,m)},onChange:F=>b(F.target.value),onKeyDown:F=>{F.key==="Enter"&&F.currentTarget.blur()}})]}),a.jsx("button",{className:"btn btn-xs btn-ghost text-muted hover:text-text",onClick:()=>i(e,null),children:"Clear"})]})]})}function Ic(e,t,n){const r=Math.max(1,...e),s=(n==null?void 0:n.opacity)??.9;return e.map((i,o)=>{const l=i/r*100;return a.jsx("rect",{x:o+.05,y:100-l,width:.9,height:l,fill:t,opacity:s},`${t}-${o}`)})}function $N(e,t){const n=(e.min-t.min)/(t.max-t.min),r=(e.max-t.min)/(t.max-t.min),s=ms*yh(Math.min(n,r)),i=ms*Math.abs(r-n);return a.jsx("rect",{x:s,y:0,width:Math.max(.5,i),height:100,fill:"rgba(255,255,255,0.08)",stroke:"rgba(255,255,255,0.4)",strokeWidth:.4})}function cg(e,t,n){const r=yh((e-t.min)/(t.max-t.min)),s=ms*r;return a.jsx("line",{x1:s,y1:0,x2:s,y2:100,stroke:n.color,strokeWidth:n.strokeWidth??.5,strokeDasharray:n.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}const BN=new Map;function UN({items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}){const[c,d]=u.useState(!1),f=s&&n.includes(s)?s:n[0],p=u.useMemo(()=>c?n:f?[f]:[],[c,n,f]),h=u.useMemo(()=>of(e,p),[e,p]),w=u.useMemo(()=>of(t,p),[t,p]),x=r??BN;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("label",{className:"ui-label",children:"Metric"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-[11px]",onClick:()=>d(S=>!S),"aria-pressed":c,children:c?"Show one":"Show all"})]}),c?a.jsx("div",{className:"ui-input ui-input-readonly w-full flex items-center text-xs",children:"All metrics"}):a.jsx("select",{className:"ui-select w-full",value:f,onChange:S=>i(S.target.value),children:n.map(S=>a.jsx("option",{value:S,children:S},S))})]}),c?a.jsx("div",{className:"space-y-3",children:n.map(S=>a.jsx(ug,{metricKey:S,populationValues:Hs(h,S),filteredValues:Hs(w,S),selectedValues:Hs(x,S),filters:o,onChangeRange:l,showTitle:!0},S))}):f?a.jsx(ug,{metricKey:f,populationValues:Hs(h,f),filteredValues:Hs(w,f),selectedValues:Hs(x,f),filters:o,onChangeRange:l}):a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]})}const VN=12;function WN({items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l,onChangeFilters:c}){const d=u.useMemo(()=>r!=null&&r.length?of(r,n):null,[r,n]),f=d&&r&&r.length?a.jsx(HN,{selectedValuesByKey:d,totalItems:r.length,metricKeys:n}):null,p=a.jsx(_N,{filters:o,onChangeFilters:c});return n.length?a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,a.jsx(UN,{items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:d,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}),p]}):a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,p,a.jsx("div",{className:"p-4 text-sm text-muted",children:"No metrics found in this dataset."})]})}function HN({selectedValuesByKey:e,totalItems:t,metricKeys:n}){const r=u.useMemo(()=>e.size?{entries:(n.length?n.filter(p=>e.has(p)):Array.from(e.keys()).sort()).map(p=>{const h=e.get(p)??[],w=Math.min(...h),x=Math.max(...h),S=h.reduce((C,y)=>C+y,0)/Math.max(1,h.length);return{key:p,value:h[0],min:w,max:x,avg:S,count:h.length}}),totalItems:t}:null,[e,n,t]);if(!r)return null;const{entries:s,totalItems:i}=r,o=s.slice(0,VN),l=s.length-o.length,c=i>1;return a.jsxs("div",{className:"ui-card",children:[a.jsxs("div",{className:"ui-card-header",children:[a.jsx("div",{className:"ui-section-title",children:"Selected metrics"}),a.jsxs("div",{className:"text-[11px] text-muted",children:[i," item",i===1?"":"s"]})]}),a.jsxs("div",{className:"space-y-1 text-[12px]",children:[o.map(d=>a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-muted w-28 shrink-0 truncate",title:d.key,children:d.key}),a.jsxs("span",{className:"font-mono text-text text-right tabular-nums",children:[c?`${nn(d.min)}  ${nn(d.max)}`:nn(d.value),c&&a.jsxs("span",{className:"text-[11px] text-muted ml-2",children:["avg ",nn(d.avg),d.count!==i?`  ${d.count}/${i}`:""]})]})]},d.key)),l>0&&a.jsxs("div",{className:"text-[11px] text-muted",children:["+",l," more"]})]})]})}const QN=[{label:"Root",path:"/"}],KN="w-11 h-11 rounded-md border border-border flex items-center justify-center transition-colors",qN="bg-accent-muted text-accent",GN="bg-surface text-text hover:bg-surface-hover";function Hl(e){return`${KN} ${e?qN:GN}`}function YN({leftTool:e,onToolChange:t,compareEnabled:n,compareActive:r,onOpenCompare:s,views:i,activeViewId:o,onActivateView:l,onSaveView:c,current:d,data:f,onOpenFolder:p,onOpenFolderActions:h,onPullRefreshFolders:w,onContextMenu:x,countVersion:S,items:C,filteredItems:y,metricKeys:g,selectedItems:v,selectedMetric:m,onSelectMetric:b,filters:E,onChangeRange:j,onChangeFilters:M,onResize:_}){const P=Hl(e==="folders"),U=Hl(e==="metrics"),F=Hl(r),q=`${Hl(!1)} cursor-pointer`;return a.jsxs("div",{className:"app-left-panel col-start-1 row-start-2 relative border-r border-border bg-panel overflow-visible",children:[a.jsxs("div",{className:"absolute inset-y-0 left-0 w-12 border-r border-border flex flex-col items-center gap-2 py-3 bg-surface-overlay",children:[a.jsx("button",{className:P,title:"Folders","aria-label":"Folders","aria-pressed":e==="folders",onClick:()=>t("folders"),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M3 7.5h6l2-2h10a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2z"})})}),a.jsx("button",{className:U,title:"Metrics / Filters","aria-label":"Metrics and Filters","aria-pressed":e==="metrics",onClick:()=>t("metrics"),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]})}),a.jsx("div",{className:"w-6 h-px bg-border/70 my-1"}),a.jsx("button",{className:`${F} ${n?"":"opacity-40 cursor-not-allowed"}`,title:n?"Compare selected images":"Compare (select 2+)","aria-label":"Compare selected images","aria-pressed":r,"aria-disabled":!n,disabled:!n,onClick:()=>{n&&s()},children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("rect",{x:"3",y:"4",width:"8",height:"16",rx:"1"}),a.jsx("rect",{x:"13",y:"4",width:"8",height:"16",rx:"1"})]})}),a.jsx("div",{className:"flex-1"}),a.jsx("a",{className:q,href:"https://github.com/trojblue/lenslet",title:"Lenslet on GitHub","aria-label":"Lenslet on GitHub",target:"_blank",rel:"noreferrer",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:a.jsx("path",{d:"M12 .5C5.73.5.5 5.74.5 12.02c0 5.1 3.29 9.42 7.86 10.95.58.11.79-.25.79-.56v-2.17c-3.2.7-3.88-1.55-3.88-1.55-.53-1.35-1.29-1.71-1.29-1.71-1.05-.72.08-.71.08-.71 1.16.08 1.78 1.2 1.78 1.2 1.03 1.77 2.71 1.26 3.37.96.1-.75.4-1.26.73-1.55-2.55-.29-5.23-1.29-5.23-5.74 0-1.27.45-2.31 1.19-3.13-.12-.29-.52-1.46.11-3.05 0 0 .97-.31 3.18 1.19.92-.26 1.91-.39 2.89-.39.98 0 1.97.13 2.89.39 2.2-1.5 3.18-1.19 3.18-1.19.63 1.59.23 2.76.11 3.05.74.82 1.19 1.86 1.19 3.13 0 4.46-2.69 5.45-5.25 5.73.41.36.78 1.07.78 2.16v3.2c0 .31.21.67.8.56 4.56-1.53 7.85-5.85 7.85-10.95C23.5 5.74 18.27.5 12 .5z"})})})]}),a.jsx("div",{className:"ml-12 h-full overflow-hidden",children:e==="folders"?a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-2 py-2 border-b border-border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Smart Folders"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:c,title:"Save current view as Smart Folder",children:"+ New"})]}),i.length?a.jsx("div",{className:"flex flex-col gap-1",children:i.map(Z=>{const B=Z.id===o;return a.jsx("button",{className:`text-left px-2 py-2 rounded-md text-sm ${B?"bg-accent-muted text-accent":"hover:bg-hover text-text"}`,onClick:()=>l(Z),children:Z.name},Z.id)})}):a.jsx("div",{className:"text-xs text-muted px-1 py-1.5",children:"No saved Smart Folders yet."})]}),a.jsx(IN,{current:d,roots:QN,data:f,onOpen:p,onPullRefresh:w,onContextMenu:x,onOpenActions:h,countVersion:S,className:"flex-1 min-h-0 overflow-auto scrollbar-thin",showResizeHandle:!1})]}):a.jsx(WN,{items:C,filteredItems:y,metricKeys:g,selectedItems:v,selectedMetric:m,onSelectMetric:b,filters:E,onChangeRange:j,onChangeFilters:M})}),a.jsx("div",{className:"toolbar-offset sidebar-resize-handle sidebar-resize-handle-left absolute bottom-0",onPointerDown:_})]})}function XN({persistenceEnabled:e,indexing:t=null,showSwitchToMostRecentBanner:n=!1,onSwitchToMostRecent:r,offViewSummary:s,onRevealOffView:i,canRevealOffView:o=!1,onClearOffView:l,browserZoomPercent:c}){const f=!!(s!=null&&s.names.length)&&s?` (${s.names.join(", ")}${s.extra?` +${s.extra}`:""})`:"",p=o&&i!=null,h=typeof c=="number"?c:null,w=h!==null&&Math.abs(h-100)>=2,x=(t==null?void 0:t.state)==="running",S=(t==null?void 0:t.state)==="error",C=t!=null&&t.scope&&t.scope!=="/"?` (${t.scope})`:"",y=(()=>{if(!x)return null;const m=typeof(t==null?void 0:t.done)=="number"?t.done:null,b=typeof(t==null?void 0:t.total)=="number"?t.total:null;return m===null&&b===null?null:b===null?`${m??0} indexed`:`${Math.min(m??0,b)} / ${b}`})(),g=n&&r!=null;return!e||x||S||g||w||!!s?a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-col gap-2",children:[!e&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Not persisted."})," Workspace is read-only; edits stay in memory until restart."]}),x&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Indexing in progress",C,"."]})," ",y?`${y} complete.`:"Preparing searchable index."]}),S&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Indexing failed."})," ",(t==null?void 0:t.error)||"Open server logs for details."]}),g&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("span",{children:[a.jsx("span",{className:"font-semibold",children:"Indexing complete."})," ","Scan-stable ordering is active for this generation."]}),a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>r==null?void 0:r(),children:"Switch to Most recent"})]}),w&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Browser zoom ",Math.round(h),"%."]})," For best results, set it to 100% so UI elements stay in correct proportions."]}),s&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex items-center justify-between gap-3",children:[a.jsxs("span",{children:["Updates outside current view: ",s.count," item",s.count===1?"":"s",f]}),a.jsxs("div",{className:"flex items-center gap-2",children:[p&&a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>i==null?void 0:i(),"aria-label":"Reveal off-view updates",children:"Reveal"}),a.jsx("button",{className:"text-muted hover:text-text transition-colors text-base leading-none",onClick:l,"aria-label":"Clear off-view updates",children:""})]})]})]})}):null}function JN(e){return e.isOffline?"offline":e.isUnstable?"unstable":e.recentEditActive?"recent":Number.isFinite(e.editingCount)&&e.editingCount>0?"editing":"live"}const ZN=6e3,ej=1e4,tj=24*60*6e4,nj=3e4,rj=350,sj=1400,t0=[-2,-1,1,2],n0=[-2,-1,0,1,2,3];t0.length;n0.length;function ij(e,t,n){return Math.min(Math.max(e,t),n)}function r0(e,t,n){const r=new Set,s=[];for(const i of n){const o=t+i;if(o<0||o>=e.length)continue;const l=e[o];!l||r.has(l)||(r.add(l),s.push(l))}return s}function oj(e,t){if(!t)return[];const n=e.indexOf(t);return n<0?[]:r0(e,n,t0)}function lj(e,t){if(e.length<2)return[];const n=Math.max(0,e.length-2),r=ij(t,0,n);return r0(e,r,n0)}function aj({paths:e,defaultDestination:t,destinations:n,loadingDestinations:r,onClose:s,onSubmit:i}){const[o,l]=u.useState(()=>Pt(t||"/")),[c,d]=u.useState(!1);u.useEffect(()=>{l(Pt(t||"/"))},[t,e]);const f=Pt(o||"/"),p=e.length>0&&!c,h=e.slice(0,3).map(C=>mh(C)||C),w=Math.max(0,e.length-h.length),x=n.filter(C=>C!==f).slice(0,8),S=async C=>{if(C.preventDefault(),!!p){d(!0);try{await i(e,f)}finally{d(!1)}}};return a.jsx("div",{className:"toolbar-offset fixed inset-0 z-overlay bg-black/45 backdrop-blur-[1px] flex items-center justify-center p-3",children:a.jsxs("div",{className:"w-full max-w-[560px] rounded-xl border border-border bg-panel shadow-[0_20px_60px_rgba(0,0,0,0.55)]",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Move to folder"}),a.jsxs("div",{className:"text-xs text-muted",children:[e.length," item(s) selected"]})]}),a.jsx("button",{type:"button",className:"btn btn-icon",onClick:s,"aria-label":"Close move dialog",disabled:c,children:""})]}),a.jsxs("form",{className:"px-4 py-3 flex flex-col gap-3",onSubmit:S,children:[a.jsxs("div",{className:"text-xs text-muted",children:[h.join(", "),w>0?` and ${w} more`:""]}),a.jsxs("label",{className:"text-xs text-muted flex flex-col gap-1.5",children:["Destination folder",a.jsx("input",{value:o,onChange:C=>l(C.target.value),className:"input w-full",list:"move-destination-list",placeholder:"/",autoFocus:!0,disabled:c})]}),a.jsx("datalist",{id:"move-destination-list",children:n.map(C=>a.jsx("option",{value:C},C))}),a.jsx("div",{className:"text-[11px] text-muted",children:r?"Loading folder list":`${n.length.toLocaleString()} destination(s) loaded`}),x.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.map(C=>a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>l(C),disabled:c,children:C},C))}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-border",children:[a.jsx("button",{type:"button",className:"btn",onClick:s,disabled:c,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-active",disabled:!p,children:c?"Moving":"Move"})]})]})]})})}function uj(e){return JSON.stringify(e,null,2)}function cj(e){const t=s=>'"'+s.replaceAll('"','""')+'"',n="path,folder,name,star,type,size,width,height,tags,notes",r=e.map(s=>{const i=(s.tags||[]).join(" "),o=s.notes||"";return[s.path,s.folder,s.name,String(s.star??""),s.type??"",s.size??"",s.width??"",s.height??"",i,o].map(l=>t(String(l))).join(",")});return[n,...r].join(`
`)}function dj(e){return e.map(t=>{const n=t.path.split("/").filter(Boolean);n.pop();const r=n.length?`/${n.join("/")}`:"/";return{path:t.path,folder:r,name:t.name,star:t.star??null,type:t.type,size:t.size,width:t.w,height:t.h}})}function fj({x:e,y:t,items:n}){const r=u.useRef(null),[s,i]=u.useState({x:e,y:t}),[o,l]=u.useState(!1),c=u.useCallback((f,p)=>{p.stopPropagation(),f.disabled||f.onClick()},[]),d=u.useCallback(()=>{const f=r.current,p=fx(),h=f==null?void 0:f.getBoundingClientRect(),w=(h==null?void 0:h.width)??180,x=(h==null?void 0:h.height)??Math.max(40,n.length*36),S=dx({x:e,y:t,menuWidth:w,menuHeight:x,viewport:p});i(C=>C.x===S.x&&C.y===S.y?C:S),l(!0)},[n.length,e,t]);return u.useLayoutEffect(()=>{d()},[d]),u.useEffect(()=>(window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}),[d]),a.jsx("div",{ref:r,className:"dropdown-panel fixed",role:"menu",style:{left:s.x,top:s.y,minWidth:180,visibility:o?"visible":"hidden"},onClick:f=>f.stopPropagation(),children:n.map((f,p)=>a.jsxs("button",{className:`dropdown-item w-full ${f.danger?"text-danger hover:text-danger":""}`,role:"menuitem","aria-disabled":f.disabled,disabled:f.disabled,onClick:h=>c(f,h),children:[f.icon&&a.jsx("span",{className:"shrink-0",children:f.icon}),a.jsx("span",{children:f.label})]},p))})}const dg=500;function fg(e){return e==="csv"?"text/csv;charset=utf-8":"application/json;charset=utf-8"}function hg(e,t){const n=dj(e);return t==="csv"?cj(n):uj(n)}function pg(){return new Date().toISOString().replace(/[:.]/g,"-")}async function hj(e){const t=await pe.getFolder(e,{recursive:!0,page:1,pageSize:dg}),n=new Map(t.items.map(s=>[s.path,s])),r=t.pageCount??1;for(let s=2;s<=r;s+=1){const i=await pe.getFolder(e,{recursive:!0,page:s,pageSize:dg});for(const o of i.items)n.has(o.path)||n.set(o.path,o)}return Array.from(n.values())}function pj({ctx:e,current:t,items:n,setCtx:r,onRefetch:s,onOpenMoveDialog:i,onRefreshFolder:o}){const l=$E(t),[c,d]=u.useState(!1),[f,p]=u.useState(null),h=e.kind==="grid"?e.payload.paths:[],w=u.useMemo(()=>new Map(n.map(j=>[j.path,j])),[n]),x=()=>{r(null)},S=async()=>{const j=e.kind==="tree"?e.payload.path:"/";d(!0);try{await o(j)}catch(M){console.error("Failed to refresh folder:",M)}finally{d(!1),x()}},C=j=>async()=>{p(j);const M=e.kind==="tree"?e.payload.path:t;try{const _=await hj(M),P=hg(_,j),U=fg(j),F=M==="/"?"root":(M.replace(/^\/+/,"")||"root").replace(/\//g,"_");Eo(new Blob([P],{type:U}),`metadata_${F}_${pg()}.${j}`)}catch(_){console.error("Failed to export folder:",_),alert("Failed to export folder. See console for details.")}finally{p(null),x()}},y=j=>async()=>{p(j);try{const M=new Set(h),_=n.filter(F=>M.has(F.path)),P=hg(_,j),U=fg(j);Eo(new Blob([P],{type:U}),`metadata_selection_${pg()}.${j}`)}finally{p(null),x()}},g=async()=>{var j;if(h.length){x();for(const M of h)try{const _=await pe.getFile(M),P=((j=w.get(M))==null?void 0:j.name)||mh(M)||"image";Eo(_,P)}catch(_){console.error(`Failed to download ${M}:`,_)}}},v=async()=>{if(!l){for(const j of h)try{await pe.moveFile(j,"/_trash_")}catch(M){console.error(`Failed to trash ${j}:`,M)}s(),x()}},m=async()=>{if(confirm(`Delete ${h.length} file(s) permanently? This cannot be undone.`)){try{await pe.deleteFiles(h)}catch(j){console.error("Failed to delete files:",j)}s(),x()}},b=async()=>{for(const j of h)try{const _=(await pe.getSidecar(j)).original_position,P=_&&_.split("/").slice(0,-1).join("/")||"/";await pe.moveFile(j,P)}catch(M){console.error(`Failed to recover ${j}:`,M)}s(),x()},E=e.kind==="tree"?[{label:c?"Refreshing":"Refresh",disabled:c,onClick:S},{label:f==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!f||c,onClick:C("csv")},{label:f==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!f||c,onClick:C("json")}]:mj({selectedPaths:h,inTrash:l,exporting:f,onDownloadSelection:g,onMoveSelection:i,onMoveToTrash:v,onPermanentDelete:m,onRecover:b,onExportCsv:y("csv"),onExportJson:y("json")});return a.jsx(fj,{x:e.x,y:e.y,items:E})}function mj({selectedPaths:e,inTrash:t,exporting:n,onDownloadSelection:r,onMoveSelection:s,onMoveToTrash:i,onPermanentDelete:o,onRecover:l,onExportCsv:c,onExportJson:d}){const f=[];return e.length&&f.push({label:e.length>1?`Download (${e.length})`:"Download",onClick:r}),e.length&&f.push({label:"Move to",disabled:t,onClick:()=>{t||s(e)}}),f.push({label:"Move to trash",disabled:t,onClick:i}),t&&(f.push({label:"Permanent delete",danger:!0,onClick:o}),f.push({label:"Recover",onClick:l})),e.length&&(f.push({label:n==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!n,onClick:c}),f.push({label:n==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!n,onClick:d})),f}function Ql(e){const t=u.useRef(e);return t.current=e,t}function gj(e,t){return t?e.some(n=>{var s;const r=(s=n.metrics)==null?void 0:s[t];return r!=null&&!Number.isNaN(r)}):!1}function yj(e,t){const n={0:0,1:0,2:0,3:0,4:0,5:0};for(const r of e){const s=t[r.path]??r.star??0,i=String(s);n[i]=(n[i]||0)+1}return n}function vj(e,t=250){const n=new Set;let r=0;for(const s of e){const i=s.metrics;if(i)for(const o of Object.keys(i))n.add(o);if(r+=1,r>=t&&n.size>0)break}return Array.from(n).sort()}function xj(e,t,n,r){return e||t?n:r}function wj(e,t,n,r,s,i){return e?n:t||i==="/"?r:s}function Sj(e){if(!e)return null;if(e.queryPath){const t=e.queryPath.split("/").filter(Boolean);return t.length?t[t.length-1]:e.queryPath}return e.queryVector?"Vector query":null}function bj(e,t,n,r){return e?t>0?`${n} of ${r}`:`${r}`:null}const Cj=(e,t)=>["search",e,t],kj=2e4,Kl="/";function Ej(e){return e.trim().replace(/\s+/g," ")}function s0(e){const t=e.trim();return!t||t===Kl?Kl:t.startsWith(Kl)?t:`${Kl}${t}`}function vh(e,t){const n=Ej(e);return n?{q:n,path:s0(t)}:null}function Nj(e){return!Array.isArray(e)||e[0]!=="search"||typeof e[1]!="string"||typeof e[2]!="string"?null:vh(e[1],e[2])}function jj(e,t){if(!t)return!1;const n=Nj(e);return n?n.path===t.path:!1}function Mj(e,t){const n=xu(),r=vh(e,t),s=Cj((r==null?void 0:r.q)??"",(r==null?void 0:r.path)??s0(t));return gu({enabled:r!==null,queryKey:s,queryFn:()=>r?pe.search(r.q,r.path):Promise.resolve({items:[]}),staleTime:3e3,gcTime:6e4,placeholderData:(i,o)=>{if(jj(o==null?void 0:o.queryKey,r))return i},retry:1,refetchInterval:n?kj:!1,refetchIntervalInBackground:n})}const Pj=()=>["embeddings"];function Rj(){return gu({queryKey:Pj(),queryFn:pe.getEmbeddings,staleTime:6e4,gcTime:5*6e4,retry:1,refetchOnWindowFocus:!1})}function Tj(e,t=250){const[n,r]=Yr.useState(e);return Yr.useEffect(()=>{const s=window.setTimeout(()=>r(e),Math.max(0,t));return()=>window.clearTimeout(s)},[e,t]),n}function mg(e){return e.addedAt?Date.parse(e.addedAt):0}function Ja(e,t){return e.name.localeCompare(t.name)}function Ij(e,t){const n=mg(e),r=mg(t);return n===r?Ja(e,t):n-r}function _j(e){return(t,n)=>{var i,o;const r=(i=t.metrics)==null?void 0:i[e],s=(o=n.metrics)==null?void 0:o[e];return r==null&&s==null?Ja(t,n):r==null?1:s==null?-1:r===s?Ja(t,n):r-s}}function gg(e,t){return VE(e,t)}function Lj(e){let t=e>>>0;return()=>{t+=1831565813;let n=Math.imul(t^t>>>15,1|t);return n^=n+Math.imul(n^n>>>7,61|n),((n^n>>>14)>>>0)/4294967296}}function Aj(e,t){const n=Lj(t||1),r=[...e];for(let s=r.length-1;s>0;s-=1){const i=Math.floor(n()*(s+1));[r[s],r[i]]=[r[i],r[s]]}return r}function Fj(e,t,n){if(t.kind==="builtin"&&t.key==="random"){const i=n??Date.now();return Aj(e,i)}let r=Ij;t.kind==="metric"?r=_j(t.key):t.key==="name"&&(r=Ja);const s=[...e].sort(r);return t.dir==="desc"?s.reverse():s}function i0(e){if(!e.length)return e;const t=new Set,n=[];for(const r of e)t.has(r.path)||(t.add(r.path),n.push(r));return n}function o0(e){return{...e,items:i0(e.items)}}function Oj(e,t){const n=e.pageCount??1,r=e.pageSize??t,s=(e.page??1)+1;return n<=1||s>n?null:{startPage:s,endPage:n,pageSize:r}}function Dj(e,t){if(e.path!==t.path)return o0(t);const n=i0([...e.items,...t.items]);return{...e,generatedAt:t.generatedAt??e.generatedAt,dirs:e.dirs.length?e.dirs:t.dirs,items:n,page:t.page??e.page,pageSize:t.pageSize??e.pageSize,pageCount:t.pageCount??e.pageCount,totalItems:t.totalItems??e.totalItems}}async function zj(e,t){const n=t.shouldContinue??(()=>!0),r=t.progressiveUpdates??!0,s=Math.max(0,t.interPageDelayMs??0),i=Oj(e,t.defaultPageSize),o=t.skipInitialUpdateIfPaged===!0&&i!==null;let l=o0(e);const c=f=>{var p;(p=t.onProgress)==null||p.call(t,{loadedPages:l.page??(i?i.startPage-1:1),totalPages:l.pageCount??(i==null?void 0:i.endPage)??1,loadedItems:l.items.length,totalItems:l.totalItems??l.items.length,completed:f})};if(o||t.onUpdate(l),c(!1),!i){o&&t.onUpdate(l),c(!0);return}let d=!1;for(let f=i.startPage;f<=i.endPage;f+=1){if(!n())return;let p;try{p=await t.fetchPage(f,i.pageSize)}catch{return}if(!n()||(l=Dj(l,p),d=!0,r&&t.onUpdate(l),c(!1),f<i.endPage&&s>0&&(await new Promise(h=>{setTimeout(h,s)}),!n())))return}!r&&d&&t.onUpdate(l),c(!0)}function $j(e,t){return e?t instanceof ln||t instanceof Error?t.message:"Failed to load embeddings.":null}function Bj({current:e,query:t,similarityState:n,scanStableMode:r=!1,viewState:s,randomSeed:i,localStarOverrides:o,sessionResetToken:l=0,onFolderHydratedSnapshot:c,getCachedHydratedSnapshot:d}){var A,K;const f=vr(),{data:p,refetch:h,isLoading:w,isError:x}=sf(e,!0,{page:1,pageSize:ma}),[S,C]=u.useState(),y=u.useRef(0),g=u.useCallback(()=>h(),[h]),{data:v}=sf("/",!0,{enabled:!1,page:1,pageSize:ma});u.useEffect(()=>{f.removeQueries({predicate:({queryKey:W})=>wN(W,e,!0)})},[e,f]),u.useEffect(()=>{y.current+=1;const W=(d==null?void 0:d(e))??null;C(W??void 0)},[e,d,l]),u.useEffect(()=>()=>{wm()},[e]),u.useEffect(()=>{if(!p)return;const W=++y.current;let X=!1;const ne=((d==null?void 0:d(p.path))??null)!==null,G=D=>{C(D),c==null||c(D.path,D)};return Cb({requestId:W,path:p.path,loadedPages:p.page??1,totalPages:p.pageCount??1,loadedItems:p.items.length,totalItems:p.totalItems??p.items.length}),zj(p,{defaultPageSize:ma,fetchPage:(D,he)=>pe.getFolder(p.path,{recursive:!0,page:D,pageSize:he}),onUpdate:G,onProgress:D=>{kb({requestId:W,path:p.path,loadedPages:D.loadedPages,totalPages:D.totalPages,loadedItems:D.loadedItems,totalItems:D.totalItems})},shouldContinue:()=>!X&&y.current===W,progressiveUpdates:!0,interPageDelayMs:p.path==="/"?40:12,skipInitialUpdateIfPaged:ne}).finally(()=>{X||y.current===W&&Eb(W)}),()=>{X=!0,wm(["folders"])}},[d,c,p]);const m=n!==null,b=Tj(t,250),E=u.useMemo(()=>m?null:vh(b,e),[m,b,e]),j=E!==null,M=(E==null?void 0:E.q)??"",_=Mj((E==null?void 0:E.q)??"",(E==null?void 0:E.path)??e),P=Rj(),U=((A=P.data)==null?void 0:A.embeddings)??[],F=((K=P.data)==null?void 0:K.rejected)??[],q=U.length>0,Z=$j(P.isError,P.error),B=u.useMemo(()=>{var X;return(j?((X=_.data)==null?void 0:X.items)??[]:(S==null?void 0:S.items)??[]).map(ne=>({...ne,star:o[ne.path]!==void 0?o[ne.path]:ne.star}))},[j,_.data,S,o]),I=u.useMemo(()=>{var ne;const W=new Map;for(const G of B)W.set(G.path,G);const X=((ne=_.data)==null?void 0:ne.items)??[];for(const G of X){if(W.has(G.path))continue;const D=o[G.path]!==void 0?o[G.path]:G.star;W.set(G.path,{...G,star:D})}return W},[B,_.data,o]),R=u.useMemo(()=>n?n.items.map(W=>{const X=I.get(W.path);return X||yE(W.path,o[W.path])}):[],[n,I,o]),T=u.useMemo(()=>{if(n)return gg(R,s.filters);const W=gg(B,s.filters);return r?W:Fj(W,s.sort,i)},[n,R,B,r,s.filters,s.sort,i]),L=n?R.length:B.length,O=T.length,Q=(S==null?void 0:S.totalItems)??(S==null?void 0:S.items.length)??L,V=e==="/"?Q:(v==null?void 0:v.totalItems)??(v==null?void 0:v.items.length)??Q;return{data:S,refetch:g,isLoading:w,isError:x,searching:j,normalizedQ:M,similarityActive:m,embeddings:U,embeddingsRejected:F,embeddingsAvailable:q,embeddingsLoading:P.isLoading,embeddingsError:Z,poolItems:B,similarityItems:R,items:T,totalCount:L,filteredCount:O,scopeTotal:Q,rootTotal:V}}function Uj({current:e,itemPaths:t,items:n,selectionPool:r,focusGridCell:s}){const[i,o]=u.useState([]),[l,c]=u.useState(null),[d,f]=u.useState(!1),[p,h]=u.useState(0),[w,x]=u.useState(0),S=u.useRef(!1),C=u.useRef(!1),y=u.useRef(null),g=u.useMemo(()=>new Set(i),[i]),v=u.useMemo(()=>{if(!i.length)return[];const D=new Map(r.map(ie=>[ie.path,ie])),he=new Map(n.map(ie=>[ie.path,ie]));return i.map(ie=>D.get(ie)??he.get(ie)).filter(ie=>!!ie)},[i,r,n]),m=u.useMemo(()=>n.filter(D=>g.has(D.path)),[n,g]),b=u.useMemo(()=>m.map(D=>D.path),[m]),E=Math.max(0,m.length-2),j=Math.min(p,E),M=m[j]??null,_=m[j+1]??null,P=j>0,U=j<m.length-2,F=m.length>=2,q=l!=null||d,Z=l??i[0]??null,B=Z?t.indexOf(Z):-1,I=B>0,R=B>=0&&B<t.length-1;u.useEffect(()=>{h(D=>D>E?E:D)},[E]);const T=u.useCallback(()=>{x(D=>D+1)},[]),L=u.useCallback(D=>{y.current=D},[]),O=u.useCallback(()=>{c(null),S.current=!1},[]),Q=u.useCallback(D=>{if(D){c(D),o([D]);return}O()},[O]),V=u.useCallback(D=>{l&&(c(null),S.current=!1,Vl(D))},[l]),A=u.useCallback(D=>{c(D),S.current=!0,Fx(D)},[]),K=u.useCallback(()=>{c(null),S.current?(S.current=!1,window.history.back()):Vl(e),s(y.current)},[e,s]),W=u.useCallback(()=>{d||!F||(i[0]&&(y.current=i[0]),h(0),f(!0),l&&(c(null),S.current&&(S.current=!1),Vl(e)),C.current||(window.history.pushState({compare:!0},"",window.location.href),C.current=!0))},[d,F,e,i,l]),X=u.useCallback(()=>{f(!1),C.current&&(C.current=!1,window.history.back()),s(y.current??i[0])},[s,i]),ne=u.useCallback(D=>{m.length<2||h(he=>{const ie=Math.max(0,m.length-2);return Math.min(ie,Math.max(0,he+D))})},[m.length]),G=u.useCallback(D=>{if(!t.length)return;const he=l??i[0];if(!he)return;const ie=t.indexOf(he);if(ie===-1)return;const be=Math.min(t.length-1,Math.max(0,ie+D)),Ce=t[be];!Ce||Ce===he||(l&&(c(Ce),Vl(Ce)),o([Ce]))},[t,i,l]);return u.useEffect(()=>{d&&(F||X())},[d,F,X]),u.useEffect(()=>{const D=()=>{l&&(S.current=!1,c(null)),d&&(C.current=!1,f(!1))};return window.addEventListener("popstate",D),()=>window.removeEventListener("popstate",D)},[l,d]),{selectedPaths:i,setSelectedPaths:o,viewer:l,compareOpen:d,restoreGridToSelectionToken:w,bumpRestoreGridToSelectionToken:T,selectedItems:v,compareItems:m,comparePaths:b,compareIndexClamped:j,compareA:M,compareB:_,canComparePrev:P,canCompareNext:U,compareEnabled:F,canPrevImage:I,canNextImage:R,overlayActive:q,rememberFocusedPath:L,openViewer:A,closeViewer:K,openCompare:W,closeCompare:X,handleCompareNavigate:ne,handleNavigate:G,resetViewerState:O,clearViewerForSearch:V,syncHashImageSelection:Q}}const Vj=2048,Wj=6,Hj=10;function l0(e){const t=new Map;for(const n of e)t.set(n.path,n.name);return t}function a0(e,t){return t.get(e)??e.split("/").pop()??e}function yg(e,t){const n=e.filter(r=>!t.has(r.path));return n.length===e.length?e:n}function vg(e,t,n,r,s){const i=e.filter(l=>l.path!==t);return[{path:t,ts:n,kind:r},...i].slice(0,s)}function Qj(e,t){if(!e.length)return null;const n=l0(t),r=new Set,s=[];for(const o of e)r.has(o.path)||(r.add(o.path),s.push(o.path));const i=s.slice(0,2).map(o=>a0(o,n));return{count:s.length,names:i,extra:Math.max(0,s.length-i.length)}}function Kj(e,t,n,r){if(!e.length)return[];const s=l0(t);return e.map(i=>({path:i.path,label:a0(i.path,s),timeLabel:r(i.ts,n)}))}function qj(e){const[t,n]=u.useState([]),[r,s]=u.useState([]),[i,o]=u.useState(new Map),l=u.useRef(new Map),c=u.useRef(new Set),d=u.useRef(new Set),f=u.useRef(new Set);u.useEffect(()=>()=>{for(const C of l.current.values())window.clearTimeout(C);l.current.clear(),c.current.clear()},[]),u.useEffect(()=>{d.current=new Set(e),n(C=>yg(C,f.current))},[e]);const p=u.useCallback((C,y)=>{if(y!=null){if(c.current.has(y))return;if(c.current.add(y),c.current.size>Vj){const E=c.current.values().next().value;E!=null&&c.current.delete(E)}}const g=y!=null?`event:${y}`:`event:${C}:${Date.now()}`;o(E=>{if(E.get(C)===g)return E;const j=new Map(E);return j.set(C,g),j});const v=l.current,m=v.get(C);m!=null&&window.clearTimeout(m);const b=window.setTimeout(()=>{o(E=>{if(E.get(C)!==g)return E;const j=new Map(E);return j.delete(C),j}),v.delete(C)},sj);v.set(C,b)},[]),h=u.useCallback(C=>{f.current=C,n(y=>yg(y,C))},[]),w=u.useCallback((C,y,g)=>{const v=Date.now();d.current.has(C)&&f.current.has(C)||n(b=>vg(b,C,v,y,Wj)),p(C,g)},[p]),x=u.useCallback((C,y,g)=>{const v=Date.now(),m=jx(g)??v;s(b=>vg(b,C,m,y,Hj))},[]),S=u.useCallback(()=>{n([])},[]);return{offViewActivity:t,recentTouches:r,highlightedPaths:i,onVisiblePathsChange:h,markRecentActivity:w,markRecentTouch:x,clearOffViewActivity:S}}function xg(e){if(typeof e!="number"||!Number.isFinite(e))return;const t=Math.trunc(e);return t<0?0:t}function Gj(e){if(typeof e!="string")return;const t=e.trim();return t.length?t:void 0}function Yj(e){if(!e)return null;const t=e.state;if(t!=="idle"&&t!=="running"&&t!=="ready"&&t!=="error")return null;let n=xg(e.done);const r=xg(e.total);return n!==void 0&&r!==void 0&&n>r&&(n=r),{state:t,scope:typeof e.scope=="string"?e.scope:void 0,done:n,total:r,generation:Gj(e.generation),started_at:typeof e.started_at=="string"?e.started_at:void 0,finished_at:typeof e.finished_at=="string"?e.finished_at:void 0,error:typeof e.error=="string"?e.error:void 0}}function Xj(e,t){return e===t?!0:!e||!t?!1:e.state===t.state&&e.scope===t.scope&&e.done===t.done&&e.total===t.total&&e.generation===t.generation&&e.started_at===t.started_at&&e.finished_at===t.finished_at&&e.error===t.error}function Jj(e){return(e==null?void 0:e.state)==="idle"||(e==null?void 0:e.state)==="running"}function Zj(e,t,n){return(e==null?void 0:e.state)==="running"?t:n}const u0=[1],eM={supportedVersions:[...u0],maxPathsV2:null,supportsV2:!1};function tM(e){if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.trunc(e);return t>0?t:null}function nM(e){if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.trunc(e);return t>=2?t:null}function rM(e){let t=[...u0];const n=e==null?void 0:e.supported_versions;if(Array.isArray(n)){const i=Array.from(new Set(n.map(o=>tM(o)).filter(o=>o!==null))).sort((o,l)=>o-l);i.length>0&&(t=i)}const r=nM(e==null?void 0:e.max_paths_v2),s=t.includes(2)&&r!==null&&r>2;return{supportedVersions:t,maxPathsV2:r,supportsV2:s}}function sM(e,t){if(e===t)return!0;if(e.supportsV2!==t.supportsV2||e.maxPathsV2!==t.maxPathsV2||e.supportedVersions.length!==t.supportedVersions.length)return!1;for(let n=0;n<e.supportedVersions.length;n+=1)if(e.supportedVersions[n]!==t.supportedVersions[n])return!1;return!0}const iM=1200,wg=3e3;function oM(e){switch(e){case"live":return"Live";case"reconnecting":return"Reconnecting";case"offline":return"Offline";case"connecting":case"idle":default:return"Connecting"}}function Sg(e){if(!(e instanceof ln))return null;const t=e.body;if(!t||typeof t!="object")return null;const n=t.error;return typeof n=="string"?n:null}function bg(e,t){return t-e<tj?Dk(e,t):zk(e)}function lM({current:e,currentGalleryId:t,itemPaths:n,items:r,queryClient:s,updateItemCaches:i,setLocalStarOverrides:o}){const l=u.useRef(Li()),c=u.useRef(null),d=u.useRef(null),f=u.useRef(null),p=u.useRef(!1),h=u.useRef(null),w=u.useRef("idle"),[x,S]=u.useState("idle"),[C,y]=u.useState({}),[g,v]=u.useState(null),[m,b]=u.useState(null),[E,j]=u.useState(!1),[M,_]=u.useState(()=>Date.now()),[P,U]=u.useState(!0),[F,q]=u.useState(null),[Z,B]=u.useState(eM);u.useEffect(()=>{if(m==null){j(!1);return}j(!0);const re=window.setTimeout(()=>j(!1),ZN);return()=>window.clearTimeout(re)},[m]),u.useEffect(()=>{if(g==null)return;_(Date.now());const re=window.setInterval(()=>_(Date.now()),1e4);return()=>window.clearInterval(re)},[g]);const{offViewActivity:I,recentTouches:R,highlightedPaths:T,onVisiblePathsChange:L,markRecentActivity:O,markRecentTouch:Q,clearOffViewActivity:V}=qj(n),A=u.useCallback(re=>{const se=Date.now(),Me=jx(re)??se,ge=Me>se?se:Me;v(de=>de==null?ge:de>ge?de:ge),b(se),_(se)},[]),K=u.useCallback(re=>{re.length&&y(se=>{let xe=!1;const Me={...se};for(const ge of re){const de=se[ge.gallery_id];de&&de.viewing===ge.viewing&&de.editing===ge.editing||(Me[ge.gallery_id]=ge,xe=!0)}return xe?Me:se})},[]),W=u.useCallback(()=>{h.current!=null&&(window.clearTimeout(h.current),h.current=null)},[]),X=u.useCallback(re=>{re&&y(se=>{if(!(re in se))return se;const xe={...se};return delete xe[re],xe})},[]),ne=u.useCallback(re=>{c.current=re.lease_id,d.current=re.gallery_id,K([re])},[K]),G=u.useCallback(async(re,se=!1)=>{const xe=l.current,Me=se?void 0:c.current??void 0,ge=de=>pe.joinPresence(re,de,xe);try{ne(await ge(Me));return}catch(de){if(!se&&Sg(de)==="invalid_lease"){ne(await ge(void 0));return}throw de}},[ne]),D=u.useCallback(async(re,se)=>{if(re===se){await G(se);return}const xe=c.current;if(!xe){await G(se,!0);return}try{const Me=await pe.movePresence(re,se,xe,l.current);d.current=Me.to_scope.gallery_id,K([Me.from_scope,Me.to_scope]);return}catch(Me){const ge=Sg(Me);if(ge==="invalid_lease"){await G(se,!0);return}if(ge==="scope_mismatch"){await G(se);return}throw Me}},[K,G]),he=u.useCallback(async re=>{const se=d.current;if(!se){await G(re,!0);return}if(se===re){await G(re);return}await D(se,re)},[G,D]),ie=u.useCallback(async()=>{if(p.current)return;const re=f.current;if(re){f.current=null,p.current=!0;try{await he(re)}catch{}finally{p.current=!1;const se=f.current;se&&se!==d.current&&ie()}}},[he]),be=u.useCallback((re,se=!1)=>{if(f.current=re,W(),se||d.current==null){ie();return}h.current=window.setTimeout(()=>{h.current=null,ie()},rj)},[W,ie]),Ce=u.useCallback(()=>{d.current=null,c.current=null,f.current=null,W()},[W]),fe=u.useCallback(re=>{const se=d.current,xe=c.current;!se||!xe||(Xb(se,xe,l.current),re&&X(se),Ce())},[X,Ce]);u.useEffect(()=>{Wb();const re=Qb(xe=>{if(xe.type==="presence"){const de=xe.data;if(!(de!=null&&de.gallery_id))return;K([de]);return}const Me=xe.data;if(!(Me!=null&&Me.path))return;const ge=Me.path;if(xe.type==="item-updated"){const de=xe.data,Je={v:1,tags:de.tags??[],notes:de.notes??"",star:de.star??null,version:de.version??1,updated_at:de.updated_at??"",updated_by:de.updated_by??"server"};s.setQueryData(Qo(ge),Je),i({path:ge,star:de.star??null,metrics:de.metrics,comments:de.notes??""}),jk(ge,Je),O(ge,"item-updated",xe.id),Q(ge,"item-updated",de.updated_at),A(de.updated_at),o(Ze=>{if(Ze[ge]===void 0)return Ze;const bt={...Ze};return delete bt[ge],bt})}else if(xe.type==="metrics-updated"){const de=xe.data;i({path:ge,metrics:de.metrics}),O(ge,"metrics-updated",xe.id),Q(ge,"metrics-updated",de.updated_at),A(de.updated_at)}}),se=Kb(S);return()=>{re(),se(),Hb()}},[K,O,Q,s,o,i,A]),u.useEffect(()=>{const re=d.current;re!==t&&be(t,re==null)},[t,be]),u.useEffect(()=>{const re=window.setInterval(()=>{const se=d.current;se&&G(se)},nj);return()=>{window.clearInterval(re)}},[G]),u.useEffect(()=>{const re=w.current;if(w.current=x,x==="live"&&re!=="live"){be(t,!0);return}(x==="reconnecting"||x==="offline")&&X(d.current)},[X,x,t,be]),u.useEffect(()=>{const re=()=>fe(!0),se=()=>fe(!0),xe=()=>{be(t,!0)};return window.addEventListener("pagehide",re),window.addEventListener("beforeunload",se),window.addEventListener("pageshow",xe),()=>{window.removeEventListener("pagehide",re),window.removeEventListener("beforeunload",se),window.removeEventListener("pageshow",xe),fe(!1)}},[t,be,fe]),u.useEffect(()=>{let re=!1,se=null;const xe=()=>{se!=null&&(window.clearTimeout(se),se=null)},Me=de=>{xe(),se=window.setTimeout(()=>{ge()},de)},ge=async()=>{var de;try{const Je=await pe.getHealth();if(re)return;U(((de=Je==null?void 0:Je.labels)==null?void 0:de.enabled)??!0);const Ze=Yj(Je==null?void 0:Je.indexing);q(Ke=>Xj(Ke,Ze)?Ke:Ze);const bt=rM(Je==null?void 0:Je.compare_export);B(Ke=>sM(Ke,bt)?Ke:bt),Jj(Ze)&&Me(Zj(Ze,iM,wg))}catch{if(re)return;Me(wg)}};return ge(),()=>{re=!0,xe()}},[]);const $e=C[e],St=($e==null?void 0:$e.editing)??0,dt=g!=null,Cn=u.useMemo(()=>oM(x),[x]),dn=u.useMemo(()=>!dt||g==null?"No edits yet.":bg(g,M),[dt,g,M]),zn=u.useMemo(()=>Qj(I,r),[I,r]),fn=u.useMemo(()=>Kj(R,r,M,bg),[r,M,R]);return{connectionStatus:x,connectionLabel:Cn,presence:$e,editingCount:St,recentEditActive:E,hasEdits:dt,lastEditedLabel:dn,persistenceEnabled:P,indexing:F,compareExportCapability:Z,highlightedPaths:T,onVisiblePathsChange:L,offViewSummary:zn,recentTouchesDisplay:fn,clearOffViewActivity:V}}const aM=600;function uM(e){if(!(e instanceof ln))return!1;if(e.status===403||e.status===405)return!0;const t=String(e.message||"").toLowerCase();return t.includes("read-only")||t.includes("no-write")||t.includes("write")}function oo(e,t){return uM(e)?"This workspace is read-only. Upload and move actions are disabled.":e instanceof ln||e instanceof Error&&e.message?e.message:t}function _c(e){return Array.from(new Set(e.filter(Boolean)))}function Cg(e,t){return t.length?t.length===1?t[0]:`${e} failed for ${t.length} item(s). ${t[0]}`:""}async function cM(){const e=["/"],t=new Set,n=new Set(["/"]);for(;e.length>0&&t.size<aM;){const r=e.shift()??"/",s=Pt(r);if(t.has(s))continue;t.add(s);let i=null;try{i=await pe.getFolder(s)}catch{i=null}if(i)for(const o of i.dirs??[]){const l=Pt(Ox(s,o.name));n.has(l)||(n.add(l),e.push(l))}}return Array.from(n).sort((r,s)=>r==="/"?-1:s==="/"?1:r.localeCompare(s))}function dM({appRef:e,uploadInputRef:t,current:n,currentDirCount:r,selectedPaths:s,setSelectedPaths:i,refetch:o,invalidateDerivedCounts:l}){const c=vr(),[d,f]=u.useState(!1),[p,h]=u.useState(null),[w,x]=u.useState(!1),[S,C]=u.useState(null),[y,g]=u.useState(["/"]),[v,m]=u.useState(!1),[b,E]=u.useState(null);u.useEffect(()=>{h(null)},[n]);const j=u.useCallback(I=>{const R=_c(s);return R.includes(I)?R:[I]},[s]),M=u.useCallback((I,R)=>{const T=j(I);i(T),E({x:R.x,y:R.y,kind:"grid",payload:{paths:T}})},[j,i]),_=u.useCallback((I,R)=>{E({x:R.x,y:R.y,kind:"tree",payload:{path:I}})},[]);u.useEffect(()=>{if(!S)return;let I=!1;return m(!0),cM().then(R=>{I||g(R)}).catch(R=>{I||h(oo(R,"Failed to load destination folders."))}).finally(()=>{I||m(!1)}),()=>{I=!0}},[S]);const P=u.useCallback(async(I,R)=>{const T=_c(I);if(!T.length)return!1;const L=Pt(R||"/");h(null);const O=[],Q=[];for(const A of T)try{await pe.moveFile(A,L)}catch(K){O.push(`${mh(A)||A}: ${oo(K,"Move failed.")}`),Q.push(A)}try{await c.invalidateQueries({predicate:({queryKey:A})=>Array.isArray(A)&&A[0]==="folder"}),l(),await o()}catch(A){O.push(oo(A,"Move completed, but refresh failed."))}if(O.length)return h(Cg("Move",O)),i(Q),!1;C(null),E(null);const V=new Set(T);return i(A=>A.filter(K=>!V.has(K))),!0},[l,c,o,i]),U=u.useCallback(I=>{const R=_c(I);R.length&&(h(null),C({paths:R}),E(null))},[]),F=u.useCallback(async I=>{if(!I.length)return;if(!(r===0)){h("Uploads are only allowed into folders without subdirectories.");return}f(!0),h(null);const T=[];try{for(const L of I)try{await pe.uploadFile(n,L)}catch(O){T.push(`${L.name}: ${oo(O,"Upload failed.")}`)}try{await o()}catch(L){T.push(oo(L,"Upload completed, but refresh failed."))}}finally{f(!1)}if(T.length){h(Cg("Upload",T));return}h(null)},[n,r,o]),q=u.useCallback(()=>{var I;d||(I=t.current)==null||I.click()},[t,d]),Z=u.useCallback(async I=>{const R=Array.from(I.target.files??[]);I.target.value="",R.length&&await F(R)},[F]);u.useEffect(()=>{const I=e.current;if(!I)return;const R=O=>{O.dataTransfer&&Array.from(O.dataTransfer.types).includes("Files")&&(O.preventDefault(),x(!0))},T=O=>{const Q=O.relatedTarget;Q&&I.contains(Q)||x(!1)},L=async O=>{var V;O.preventDefault(),x(!1);const Q=Array.from(((V=O.dataTransfer)==null?void 0:V.files)??[]);Q.length&&await F(Q)};return I.addEventListener("dragover",R),I.addEventListener("dragleave",T),I.addEventListener("drop",L),()=>{I.removeEventListener("dragover",R),I.removeEventListener("dragleave",T),I.removeEventListener("drop",L)}},[e,F]),u.useEffect(()=>{const I=()=>E(null),R=T=>{T.key==="Escape"&&E(null)};return window.addEventListener("click",I),window.addEventListener("keydown",R),()=>{window.removeEventListener("click",I),window.removeEventListener("keydown",R)}},[]);const B=u.useCallback(()=>{C(null)},[]);return{uploading:d,actionError:p,isDraggingOver:w,moveDialog:S,moveFolders:y,moveFoldersLoading:v,ctx:b,setCtx:E,closeMoveDialog:B,openUploadPicker:q,handleUploadInputChange:Z,openGridActions:M,openFolderActions:_,openMoveDialogForPaths:U,moveSelectedToFolder:P}}function On(e){const t=e.trim();return!t||t==="/"?"/":t.startsWith("/")?t:`/${t}`}function c0(e,t){const n=On(t),r=e[n];return r||{path:n,hydratedSnapshot:null,hydratedGeneratedAt:null,hydratedItemCount:0,hydratedAtMs:null,topAnchorPath:null}}function lf(e,t){return t==="/"?!0:e===t||e.startsWith(`${t}/`)}function fM(e){for(const t of e)return t;return null}function hM(e,t,n,r){const s=c0(e,t),i={...s,path:On(t),hydratedSnapshot:n,hydratedGeneratedAt:n.generatedAt??null,hydratedItemCount:n.totalItems??n.items.length,hydratedAtMs:r};return s.hydratedSnapshot===i.hydratedSnapshot&&s.hydratedGeneratedAt===i.hydratedGeneratedAt&&s.hydratedItemCount===i.hydratedItemCount&&s.hydratedAtMs===i.hydratedAtMs?e:{...e,[i.path]:i}}function kg(e,t,n){const r=c0(e,t),s=On(t),i=n?On(n):null;return r.topAnchorPath===i&&r.path===s?e:{...e,[s]:{...r,path:s,topAnchorPath:i}}}function d0(e,t){const n=On(t);if(!e[n])return e;const r={...e};return delete r[n],r}function pM(e,t){const n=On(t);let r=!1;const s={...e};for(const i of Object.keys(s))lf(i,n)&&(r=!0,delete s[i]);return r?s:e}function mM(e,t){const n=On(e),r=On(t);return!!(n===r||lf(n,r)||lf(r,n))}function gM(e,t,n){return mM(t,n)?e:d0(e,n)}function yM(){const e=u.useRef({}),t=u.useCallback(p=>e.current[On(p)]??null,[]),n=u.useCallback(p=>{var h;return((h=e.current[On(p)])==null?void 0:h.hydratedSnapshot)??null},[]),r=u.useCallback(p=>{var h;return((h=e.current[On(p)])==null?void 0:h.topAnchorPath)??null},[]),s=u.useCallback((p,h)=>{e.current=hM(e.current,p,h,Date.now())},[]),i=u.useCallback((p,h)=>{e.current=kg(e.current,p,h)},[]),o=u.useCallback((p,h)=>{const w=fM(h);w&&(e.current=kg(e.current,p,w))},[]),l=u.useCallback(p=>{e.current=d0(e.current,p)},[]),c=u.useCallback(p=>{e.current=pM(e.current,p)},[]),d=u.useCallback((p,h)=>{e.current=gM(e.current,p,h)},[]),f=u.useCallback(()=>{e.current={}},[]);return u.useMemo(()=>({getSession:t,getHydratedSnapshot:n,getTopAnchorPath:r,saveHydratedSnapshot:s,saveTopAnchorPath:i,saveTopAnchorFromVisiblePaths:o,invalidatePath:l,invalidateSubtree:c,invalidateForScopeTransition:d,clearAllSessions:f}),[t,n,r,s,i,o,l,c,d,f])}const vM={stars:{read:e=>{const t=e.stars||[];return t.length?{id:"stars",label:`Rating in: ${Pc(t)}`}:null},clear:(e,t)=>t.clearStars()},starsIn:{read:e=>{const t=e.starsIn.values||[];return t.length?{id:"stars-in",label:`Rating in: ${Pc(t)}`}:null},clear:(e,t)=>t.clearStars()},starsNotIn:{read:e=>{const t=e.starsNotIn.values||[];return t.length?{id:"stars-not-in",label:`Rating not in: ${Pc(t)}`}:null},clear:(e,t)=>t.clearStarsNotIn()},nameContains:{read:e=>{var n;const t=(n=e.nameContains.value)==null?void 0:n.trim();return t?{id:"name-contains",label:`Filename contains: ${t}`}:null},clear:(e,t)=>t.clearNameContains()},nameNotContains:{read:e=>{var n;const t=(n=e.nameNotContains.value)==null?void 0:n.trim();return t?{id:"name-not-contains",label:`Filename not: ${t}`}:null},clear:(e,t)=>t.clearNameNotContains()},commentsContains:{read:e=>{var n;const t=(n=e.commentsContains.value)==null?void 0:n.trim();return t?{id:"comments-contains",label:`Comments contain: ${t}`}:null},clear:(e,t)=>t.clearCommentsContains()},commentsNotContains:{read:e=>{var n;const t=(n=e.commentsNotContains.value)==null?void 0:n.trim();return t?{id:"comments-not-contains",label:`Comments not: ${t}`}:null},clear:(e,t)=>t.clearCommentsNotContains()},urlContains:{read:e=>{var n;const t=(n=e.urlContains.value)==null?void 0:n.trim();return t?{id:"url-contains",label:`URL contains: ${t}`}:null},clear:(e,t)=>t.clearUrlContains()},urlNotContains:{read:e=>{var n;const t=(n=e.urlNotContains.value)==null?void 0:n.trim();return t?{id:"url-not-contains",label:`URL not: ${t}`}:null},clear:(e,t)=>t.clearUrlNotContains()},dateRange:{read:e=>{const{from:t,to:n}=e.dateRange;return!t&&!n?null:{id:"date-range",label:`Date: ${fE(t,n)}`}},clear:(e,t)=>t.clearDateRange()},widthCompare:{read:e=>({id:"width-compare",label:`Width ${e.widthCompare.op} ${e.widthCompare.value}`}),clear:(e,t)=>t.clearWidthCompare()},heightCompare:{read:e=>({id:"height-compare",label:`Height ${e.heightCompare.op} ${e.heightCompare.value}`}),clear:(e,t)=>t.clearHeightCompare()},metricRange:{read:e=>({id:`metric:${e.metricRange.key}`,label:`${e.metricRange.key}: ${mE(e.metricRange.min,e.metricRange.max)}`}),clear:(e,t)=>t.clearMetricRange(e.metricRange.key)}};function xM(e,t){if("stars"in e)return t("stars",e);if("starsIn"in e)return t("starsIn",e);if("starsNotIn"in e)return t("starsNotIn",e);if("nameContains"in e)return t("nameContains",e);if("nameNotContains"in e)return t("nameNotContains",e);if("commentsContains"in e)return t("commentsContains",e);if("commentsNotContains"in e)return t("commentsNotContains",e);if("urlContains"in e)return t("urlContains",e);if("urlNotContains"in e)return t("urlNotContains",e);if("dateRange"in e)return t("dateRange",e);if("widthCompare"in e)return t("widthCompare",e);if("heightCompare"in e)return t("heightCompare",e);if("metricRange"in e)return t("metricRange",e)}function wM(e,t){const n=[];for(const r of e.and)xM(r,(s,i)=>{const o=vM[s],l=o.read(i);l&&n.push({id:l.id,label:l.label,onRemove:()=>o.clear(i,t)})});return n}function bu(e){if(typeof e!="string")return null;const t=e.trim();return t.length?t:null}function SM(e,t){const n=bu(t==null?void 0:t.generation);return!n||(t==null?void 0:t.state)!=="idle"&&(t==null?void 0:t.state)!=="running"?e:n}function bM(e,t){const n=bu(e==null?void 0:e.generation),r=n!==null&&t.scanGeneration===n&&t.recentGeneration!==n,s=r&&(e==null?void 0:e.state)==="ready";return{scanStableActive:r,sortLocked:r,showSwitchToMostRecentBanner:s}}const tt={sortKey:"sortKey",sortDir:"sortDir",sortSpec:"sortSpec",starFilters:"starFilters",filterAst:"filterAst",selectedMetric:"selectedMetric",viewMode:"viewMode",gridItemSize:"gridItemSize",leftOpen:"leftOpen",rightOpen:"rightOpen"},ql={scanGeneration:"indexingScanGeneration",recentGeneration:"indexingMostRecentGeneration"};function Eg(e){if(typeof window>"u")return null;try{const t=window.localStorage.getItem(e);return bu(t)}catch{return null}}function Ng(e,t){if(!(typeof window>"u"))try{window.localStorage.setItem(e,t)}catch{}}function jg(e,t){for(const n of e)pe.prefetchFile(n,t),pe.prefetchThumb(n)}function CM(){var Lh;const[e,t]=u.useState("/"),[n,r]=u.useState(""),[s,i]=u.useState(!1),[o,l]=u.useState(null),[c,d]=u.useState(null),[f,p]=u.useState(100),[h,w]=u.useState(null),[x,S]=u.useState(()=>({filters:{and:[]},sort:{kind:"builtin",key:"added",dir:"desc"},selectedMetric:void 0})),[C,y]=u.useState(()=>Date.now()),[g,v]=u.useState("adaptive"),[m,b]=u.useState(220),[E,j]=u.useState(!1),[M,_]=u.useState(!0),[P,U]=u.useState(!0),[F,q]=u.useState(()=>typeof window>"u"?1440:window.innerWidth),Z=ua(aa.narrow),[B,I]=u.useState("folders"),[R,T]=u.useState([]),[L,O]=u.useState(null),[Q,V]=u.useState(0),[A,K]=u.useState(()=>Eg(ql.scanGeneration)),[W,X]=u.useState(()=>Eg(ql.recentGeneration)),[ne,G]=u.useState(!1),[D,he]=u.useState({}),ie=u.useRef(null),be=u.useRef(null),Ce=u.useRef(null),fe=u.useRef(null),$e=u.useRef(null),St=u.useRef(null),dt=u.useRef(!1),{leftW:Cn,rightW:dn,onResizeLeft:zn,onResizeRight:fn}=mN(ie,B),{getHydratedSnapshot:re,getTopAnchorPath:se,saveHydratedSnapshot:xe,saveTopAnchorPath:Me,invalidateSubtree:ge}=yM(),[de,Je]=u.useState(0),[Ze,bt]=u.useState(0),Ke=vr(),Yt=bk(),xr=xu(),kn=kk(),[En,ke]=u.useState(!1),{data:qe,refetch:Xt,searching:Jt,normalizedQ:ns,similarityActive:z,embeddings:Y,embeddingsRejected:ue,embeddingsAvailable:we,embeddingsLoading:Ee,embeddingsError:Pe,poolItems:oe,similarityItems:Ne,items:me,totalCount:it,filteredCount:Fe,scopeTotal:gt,rootTotal:Zt}=Bj({current:e,query:n,similarityState:o,scanStableMode:ne,viewState:x,randomSeed:C,localStarOverrides:D,onFolderHydratedSnapshot:xe,getCachedHydratedSnapshot:re,sessionResetToken:Ze}),Nn=u.useMemo(()=>Pt(e||"/"),[e]),en=u.useMemo(()=>Km(x.filters),[x.filters]),et=u.useMemo(()=>me.map(N=>N.path),[me]),rs=u.useCallback(N=>{if(!N)return;const $=document.getElementById(`cell-${encodeURIComponent(N)}`);$==null||$.focus()},[]),wr=o?Ne:oe,{selectedPaths:$t,setSelectedPaths:rt,viewer:tn,compareOpen:Ct,restoreGridToSelectionToken:ll,bumpRestoreGridToSelectionToken:$n,selectedItems:Fs,compareItems:Yn,comparePaths:$i,compareIndexClamped:Os,compareA:Xn,compareB:Jn,canComparePrev:Cu,canCompareNext:ku,compareEnabled:Eu,canPrevImage:al,canNextImage:Bi,overlayActive:Ds,rememberFocusedPath:Nu,openViewer:ju,closeViewer:ul,openCompare:cl,closeCompare:Ui,handleCompareNavigate:Vi,handleNavigate:zs,resetViewerState:ss,clearViewerForSearch:dl,syncHashImageSelection:Wi}=Uj({current:e,itemPaths:et,items:me,selectionPool:wr,focusGridCell:rs}),fl=Ql(Wi),hl=Ql($n);u.useEffect(()=>{const N=te=>{const ce=Pt(te),_e=zE(ce)?ce:null,kt=_e?Qm(ce):ce,Re=!dt.current;dt.current=!0,fl.current(_e),t(Te=>{const ft=pE(Te,kt,_e,Re);return Te===ft?Te:(hl.current(),ft)})};N(Hm());const $=()=>N(Hm());return window.addEventListener("hashchange",$),()=>window.removeEventListener("hashchange",$)},[hl,fl]);const Mu=wr,$s=o?null:x.sort.kind==="metric"?x.sort.key:null,pl=u.useMemo(()=>gj(me,$s),[me,$s]),Pu=u.useCallback(N=>{const $=Object.prototype.hasOwnProperty.call(N,"star"),te=N.metrics!==void 0,ce=N.comments!==void 0;if(!$&&!te&&!ce)return;const _e=Re=>{if(Re.path!==N.path)return Re;let Te=Re;return $&&Re.star!==N.star&&(Te={...Te,star:N.star??null}),te&&(Te={...Te,metrics:N.metrics??void 0}),ce&&Re.comments!==N.comments&&(Te={...Te,comments:N.comments??""}),Te},kt=Re=>{if(!Re)return Re;let Te=!1;const ft=Re.items.map(hn=>{const Us=_e(hn);return Us!==hn&&(Te=!0),Us});return Te?{...Re,items:ft}:Re};Ke.setQueriesData({predicate:({queryKey:Re})=>Array.isArray(Re)&&Re[0]==="folder"},kt),Ke.setQueriesData({predicate:({queryKey:Re})=>Array.isArray(Re)&&Re[0]==="search"},kt)},[Ke]),{connectionStatus:Bs,connectionLabel:Ru,presence:Tu,editingCount:Iu,recentEditActive:_u,hasEdits:Lu,lastEditedLabel:Au,persistenceEnabled:Fu,indexing:Bt,compareExportCapability:Hi,highlightedPaths:le,onVisiblePathsChange:ye,offViewSummary:Ge,recentTouchesDisplay:Zn,clearOffViewActivity:f0}=lM({current:e,currentGalleryId:Nn,itemPaths:et,items:me,queryClient:Ke,updateItemCaches:Pu,setLocalStarOverrides:he});u.useEffect(()=>{const N=SM(A,Bt);!N||N===A||(K(N),Ng(ql.scanGeneration,N))},[Bt,A]);const Qi=u.useMemo(()=>bM(Bt,{scanGeneration:A,recentGeneration:W}),[Bt,W,A]);u.useEffect(()=>{G(N=>N===Qi.scanStableActive?N:Qi.scanStableActive)},[Qi.scanStableActive]);const h0=u.useCallback(()=>{const N=bu(Bt==null?void 0:Bt.generation);N&&(W!==N&&(X(N),Ng(ql.recentGeneration,N)),S($=>$.sort.kind==="builtin"&&$.sort.key==="added"&&$.sort.dir==="desc"?$:{...$,sort:{kind:"builtin",key:"added",dir:"desc"}}))},[Bt==null?void 0:Bt.generation,W]),p0=u.useCallback(N=>{ye(N)},[ye]),m0=u.useCallback(N=>{N&&Me(e,N)},[e,Me]),g0=u.useMemo(()=>se(e),[e,se]);u.useEffect(()=>{Je(N=>N+1)},[e]);const Ou=u.useCallback(()=>{V(N=>N+1)},[]),xh=u.useCallback(N=>{const $=Pt(N||"/");return $===""?"/":$},[]),wh=u.useCallback(N=>{const $=te=>N==="/"?!0:te===N||te.startsWith(`${N}/`);Ke.invalidateQueries({predicate:({queryKey:te})=>{if(!Array.isArray(te)||te[0]!=="folder")return!1;const ce=typeof te[1]=="string"?te[1]:"";return $(ce)}})},[Ke]),Du=u.useCallback(async N=>{const $=xh(N);await pe.refreshFolder($),wh($),Ou(),ge($),(e===$||e.startsWith($==="/"?"/":`${$}/`))&&(bt(te=>te+1),await Xt()),$d.evictPrefix($),Ks.evictPrefix($)},[e,Ou,ge,wh,xh,Xt]),y0=u.useCallback(async()=>{try{await Du(e)}catch(N){console.error("Failed to refresh folder:",N)}},[e,Du]),v0=u.useMemo(()=>yj(o?Ne:oe,D),[o,Ne,oe,D]),Sr=u.useMemo(()=>vj(o?Ne:oe),[o,Ne,oe]);u.useEffect(()=>{z||Sr.length&&S(N=>{const $=N.selectedMetric&&Sr.includes(N.selectedMetric)?N.selectedMetric:Sr[0];return $===N.selectedMetric?N:{...N,selectedMetric:$}})},[Sr,z]),u.useEffect(()=>{z||x.sort.kind==="metric"&&(Sr.includes(x.sort.key)||S(N=>({...N,sort:{kind:"builtin",key:"added",dir:N.sort.dir}})))},[Sr,x.sort,z]);const ml=u.useMemo(()=>iN(x.filters),[x.filters]),zu=z||Jt||ml>0,x0=Yt.state==="syncing"?"Syncing":Yt.state==="error"?Yt.message?`Not saved  ${Yt.message}`:"Not saved  retry":"All changes saved",w0=kn!=null&&kn>ej,S0=Bs==="offline"||Bs==="connecting"||Bs==="idle",b0=Bs==="reconnecting"||xr||Yt.state==="error"||w0,C0=JN({isOffline:S0,isUnstable:b0,recentEditActive:_u,editingCount:Iu}),k0=xj(z,zu,Fe,gt),E0=wj(z,zu,it,gt,Zt,e),Sh=u.useMemo(()=>Sj(o),[o]),bh=u.useMemo(()=>bj(o!==null,ml,Fe,it),[o,ml,Fe,it]),Tt=u.useCallback(N=>{S($=>({...$,filters:N($.filters)}))},[]),N0=u.useCallback(N=>{S($=>({...$,filters:N}))},[]),$u=u.useCallback(()=>{Tt(N=>Rc(N,[]))},[Tt]),Ch=u.useCallback(()=>{S(N=>({...N,filters:{and:[]}}))},[]),Bu=u.useCallback(()=>{l(null);const N=St.current;St.current=null,N&&N.length?(rt(N),$n()):rt([])},[$n,rt]),j0=u.useCallback(()=>{o&&Bu(),r(""),S(N=>({...N,filters:{and:[]}}))},[Bu,o]),M0=u.useCallback(async N=>{!o&&St.current===null&&(St.current=$t);const $=await pe.searchEmbeddings(N);if(l({embedding:$.embedding,queryPath:N.query_path??null,queryVector:N.query_vector_b64??null,topK:N.top_k??50,minScore:N.min_score??null,items:$.items,createdAt:Date.now()}),$.items.length){const te=N.query_path&&$.items.some(ce=>ce.path===N.query_path)?N.query_path:$.items[0].path;rt([te]),$n()}else rt([])},[$n,$t,rt,o]),Uu=u.useCallback((N,$)=>{Tt(te=>sN(te,N,$))},[Tt]),kh=u.useMemo(()=>wM(x.filters,{clearStars:$u,clearStarsNotIn:()=>Tt(N=>zx(N,[])),clearNameContains:()=>Tt(N=>$x(N,"")),clearNameNotContains:()=>Tt(N=>Bx(N,"")),clearCommentsContains:()=>Tt(N=>Ux(N,"")),clearCommentsNotContains:()=>Tt(N=>Vx(N,"")),clearUrlContains:()=>Tt(N=>Wx(N,"")),clearUrlNotContains:()=>Tt(N=>Hx(N,"")),clearDateRange:()=>Tt(N=>nf(N,null)),clearWidthCompare:()=>Tt(N=>ha(N,null)),clearHeightCompare:()=>Tt(N=>pa(N,null)),clearMetricRange:N=>Uu(N,null)}),[x.filters,$u,Uu,Tt]),P0=u.useCallback(N=>{const $=new Set(en);$.has(N)?$.delete(N):$.add(N),S(te=>({...te,filters:Rc(te.filters,Array.from($))}))},[en]),R0=u.useCallback(()=>{_(!0),I("metrics")},[]),T0=u.useCallback(N=>{S($=>({...$,sort:N})),N.kind==="builtin"&&N.key==="random"&&y(Date.now())},[]),Eh=u.useCallback(N=>{if(N==="/"||N==="")return"Lenslet | Root";const $=N.split("/").filter(Boolean);if(!$.length)return"Lenslet";const te=$.slice(-2).join("/");return`Lenslet | ${$.length>2?`.../${te}`:`/${te}`}`},[]),I0=u.useMemo(()=>hE(e),[e]);u.useEffect(()=>{document.title=Eh(e)},[e,Eh]),u.useEffect(()=>{let N=!0;return pe.getViews().then($=>{N&&T($.views||[])}).catch(()=>{N&&T([])}),()=>{N=!1}},[]),u.useEffect(()=>{Jt&&(rt([]),dl(e))},[dl,e,Jt,rt]),u.useEffect(()=>{const N=ie.current,$=fe.current;if(!N||!$)return;const te=()=>{const _e=Math.max(48,Math.round($.getBoundingClientRect().height));N.style.setProperty("--toolbar-h",`${_e}px`)};te();const ce=window.ResizeObserver;if(ce){const _e=new ce(te);return _e.observe($),()=>_e.disconnect()}return window.addEventListener("resize",te),()=>window.removeEventListener("resize",te)},[]),u.useEffect(()=>{try{const N=localStorage.getItem(tt.sortKey),$=localStorage.getItem(tt.sortDir),te=localStorage.getItem(tt.sortSpec),ce=localStorage.getItem(tt.starFilters),_e=localStorage.getItem(tt.filterAst),kt=localStorage.getItem(tt.selectedMetric),Re=localStorage.getItem(tt.viewMode),Te=localStorage.getItem(tt.gridItemSize),ft=localStorage.getItem(tt.leftOpen),hn=localStorage.getItem(tt.rightOpen),Ah=(Et=>{if(!Et)return null;const ot=Mc(Et);return!ot||typeof ot!="object"?null:ot.kind==="builtin"&&(ot.key==="name"||ot.key==="added"||ot.key==="random")&&(ot.dir==="asc"||ot.dir==="desc")||ot.kind==="metric"&&typeof ot.key=="string"&&ot.key.length>0&&(ot.dir==="asc"||ot.dir==="desc")?ot:null})(te)??{kind:"builtin",key:N==="name"||N==="added"||N==="random"?N:"added",dir:$==="asc"||$==="desc"?$:"desc"};Ah.key==="random"&&y(Date.now());let Wu=(Et=>{if(!Et)return null;const ot=Mc(Et);return tf(ot)})(_e)??{and:[]};if(ce){const Et=Mc(ce);if(Array.isArray(Et)){const ot=Et.filter(Q0=>[0,1,2,3,4,5].includes(Q0));Wu=Rc(Wu,ot)}}if(S(Et=>({...Et,sort:Ah,filters:Wu,selectedMetric:kt||Et.selectedMetric})),(Re==="grid"||Re==="adaptive")&&v(Re),Te){const Et=Number(Te);!isNaN(Et)&&Et>=80&&Et<=500&&b(Et)}(ft==="0"||ft==="false")&&_(!1),(hn==="0"||hn==="false")&&U(!1)}catch{}},[]),u.useEffect(()=>{Z&&(_(!1),U(!1))},[Z]),u.useEffect(()=>{if(typeof window>"u")return;const N=[1,1.25,1.5,1.75,2,3,4],$=_e=>N.reduce((kt,Re)=>Math.abs(Re-_e)<Math.abs(kt-_e)?Re:kt,N[0]),te=()=>{var Us;const _e=window.devicePixelRatio||1,kt=$(_e),Re=((Us=window.visualViewport)==null?void 0:Us.scale)??1,Te=_e*Re/kt;if(!Number.isFinite(Te)){w(null);return}const ft=Math.round(Te*100),hn=Math.min(500,Math.max(25,ft));w(hn)};te(),window.addEventListener("resize",te),window.addEventListener("orientationchange",te);const ce=window.visualViewport;return ce&&ce.addEventListener("resize",te),()=>{window.removeEventListener("resize",te),window.removeEventListener("orientationchange",te),ce&&ce.removeEventListener("resize",te)}},[]),u.useEffect(()=>{try{localStorage.setItem(tt.sortKey,x.sort.kind==="builtin"?x.sort.key:"added"),localStorage.setItem(tt.sortDir,x.sort.dir),localStorage.setItem(tt.sortSpec,JSON.stringify(x.sort));const N=Km(x.filters);localStorage.setItem(tt.starFilters,JSON.stringify(N)),localStorage.setItem(tt.filterAst,JSON.stringify(x.filters)),x.selectedMetric?localStorage.setItem(tt.selectedMetric,x.selectedMetric):localStorage.removeItem(tt.selectedMetric),localStorage.setItem(tt.viewMode,g),localStorage.setItem(tt.gridItemSize,String(m)),localStorage.setItem(tt.leftOpen,M?"1":"0"),localStorage.setItem(tt.rightOpen,P?"1":"0")}catch{}},[x,g,m,M,P]),u.useEffect(()=>{if(typeof window>"u")return;const N=()=>q(window.innerWidth);return N(),window.addEventListener("resize",N),window.addEventListener("orientationchange",N),()=>{window.removeEventListener("resize",N),window.removeEventListener("orientationchange",N)}},[]);const gl=F<=Gr.mobileMax,Nh=Ql(m);u.useEffect(()=>{gl||E&&j(!1)},[gl,E]),u.useEffect(()=>{const N=be.current;if(!N)return;const $=ce=>Math.min(500,Math.max(80,ce)),te=ce=>{ce.ctrlKey&&(tn||Ct||(ce.preventDefault(),b(_e=>$(_e+(ce.deltaY<0?20:-20)))))};return N.addEventListener("wheel",te,{passive:!1}),()=>N.removeEventListener("wheel",te)},[tn,Ct]),u.useEffect(()=>{if(tn||Ct)return;const N=be.current;if(!N)return;const $=Te=>Math.min(500,Math.max(80,Te));let te=null;const ce=Te=>{if(Te.length<2)return 0;const[ft,hn]=[Te[0],Te[1]];return Math.hypot(ft.clientX-hn.clientX,ft.clientY-hn.clientY)},_e=Te=>{if(Te.touches.length!==2)return;const ft=ce(Te.touches);ft&&(te={dist:ft,size:Nh.current})},kt=Te=>{if(!te||Te.touches.length!==2)return;const ft=ce(Te.touches);if(!ft)return;Te.preventDefault();const hn=$(te.size*(ft/te.dist));b(hn)},Re=()=>{te=null};return N.addEventListener("touchstart",_e,{passive:!0}),N.addEventListener("touchmove",kt,{passive:!1}),N.addEventListener("touchend",Re),N.addEventListener("touchcancel",Re),()=>{N.removeEventListener("touchstart",_e),N.removeEventListener("touchmove",kt),N.removeEventListener("touchend",Re),N.removeEventListener("touchcancel",Re)}},[tn,Ct,Nh]),u.useEffect(()=>{jg(oj(et,tn),"viewer")},[tn,et]),u.useEffect(()=>{Ct&&jg(lj($i,Os),"compare")},[Ct,$i,Os]);const Vu=u.useCallback(N=>{ss();const $=Pt(N);t($),Fx($)},[ss]),{uploading:_0,actionError:jh,isDraggingOver:L0,moveDialog:Mh,moveFolders:A0,moveFoldersLoading:F0,ctx:Ph,setCtx:O0,closeMoveDialog:D0,openUploadPicker:z0,handleUploadInputChange:$0,openGridActions:Rh,openFolderActions:Th,openMoveDialogForPaths:B0,moveSelectedToFolder:U0}=dM({appRef:ie,uploadInputRef:$e,current:e,currentDirCount:((Lh=qe==null?void 0:qe.dirs)==null?void 0:Lh.length)??0,selectedPaths:$t,setSelectedPaths:rt,refetch:Xt,invalidateDerivedCounts:Ou}),V0=u.useCallback(async()=>{const N=window.prompt("Save Smart Folder as:","New Smart Folder");if(!N)return;const $=cE(N,R),te={id:$,name:N,pool:{kind:"folder",path:e},view:JSON.parse(JSON.stringify(x))},ce=[...R.filter(_e=>_e.id!==$),te];T(ce),O($);try{await pe.saveViews({version:1,views:ce})}catch(_e){if(_e instanceof ln&&_e.status===403){const kt=new Blob([JSON.stringify({version:1,views:ce},null,2)],{type:"application/json"});Eo(kt,`lenslet-smart-folder-${$}.json`),alert("No-write mode: exported Smart Folder JSON instead of saving.");return}console.error("Failed to save Smart Folder:",_e)}},[e,x,R]);u.useEffect(()=>{if(!L)return;const N=R.find(ce=>ce.id===L);if(!N){O(null);return}const $=N.pool.path===e,te=JSON.stringify(N.view)===JSON.stringify(x);(!$||!te)&&O(null)},[L,R,e,x]);const Ih=Ql({current:e,items:me,selectedPaths:$t,viewer:tn,compareOpen:Ct,mobileSelectMode:E,openFolder:Vu});u.useEffect(()=>{const N=$=>{const te=Ih.current;if(!dh($.target)){if(($.ctrlKey||$.metaKey)&&$.key.toLowerCase()==="b"){$.preventDefault(),$.altKey?U(ce=>!ce):_(ce=>!ce);return}if(!(te.viewer||te.compareOpen)){if($.key==="Backspace"||$.key==="Delete")$.preventDefault(),te.openFolder(Qm(te.current));else if(($.ctrlKey||$.metaKey)&&$.key.toLowerCase()==="a")$.preventDefault(),rt(te.items.map(ce=>ce.path));else if($.key==="Escape"){if(te.selectedPaths.length){$.preventDefault(),rt([]);return}te.mobileSelectMode&&($.preventDefault(),j(!1))}else if($.key==="/"){$.preventDefault();const ce=document.querySelector(".toolbar-right .input");ce==null||ce.focus()}}}};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[Ih,rt]);const _h=u.useMemo(()=>hb({viewportWidth:F,leftOpen:M,rightOpen:P,leftWidth:Cn,rightWidth:dn}),[F,M,P,Cn,dn]),W0=M?`${_h.leftWidth}px`:"0px",H0=P?`${_h.rightWidth}px`:"0px";return a.jsxs("div",{className:"app-shell grid h-full grid-cols-[var(--left)_1fr_var(--right)]",ref:ie,style:{"--left":W0,"--right":H0},children:[a.jsx(gb,{rootRef:fe,onSearch:r,viewerActive:!!tn,onBack:ul,zoomPercent:tn?f:void 0,onZoomPercentChange:N=>d(N),currentLabel:I0,itemCount:k0,totalCount:E0,sortSpec:x.sort,metricKeys:Sr,onSortChange:T0,sortDisabled:z||Qi.sortLocked,filterCount:ml,onOpenFilters:R0,starFilters:en,onToggleStar:P0,onClearStars:$u,onClearFilters:Ch,starCounts:v0,viewMode:g,onViewMode:v,gridItemSize:m,onGridItemSize:b,leftOpen:M,rightOpen:P,onToggleLeft:()=>_(N=>!N),onToggleRight:()=>U(N=>!N),onPrevImage:()=>zs(-1),onNextImage:()=>zs(1),canPrevImage:al,canNextImage:Bi,searchDisabled:z,searchPlaceholder:z?"Exit similarity to search":void 0,onUploadClick:z0,uploadBusy:_0,uploadDisabled:Ct,multiSelectMode:E,selectedCount:$t.length,onToggleMultiSelectMode:gl?()=>j(N=>!N):void 0,syncIndicator:{state:C0,presence:Tu,syncLabel:x0,connectionLabel:Ru,lastEditedLabel:Au,hasEdits:Lu,localTypingActive:En,recentTouches:Zn}}),a.jsx("input",{ref:$e,type:"file",multiple:!0,accept:"image/*",className:"sr-only",onChange:$0}),M&&a.jsx(YN,{leftTool:B,onToolChange:I,compareEnabled:Eu,compareActive:Ct,onOpenCompare:cl,views:R,activeViewId:L,onActivateView:N=>{var te;O(N.id);const $=tf((te=N.view)==null?void 0:te.filters)??{and:[]};S({...N.view,filters:$}),Vu(N.pool.path)},onSaveView:V0,current:e,data:qe,onOpenFolder:N=>{O(null),Vu(N)},onOpenFolderActions:Th,onPullRefreshFolders:y0,onContextMenu:(N,$)=>{N.preventDefault(),Th($,{x:N.clientX,y:N.clientY})},countVersion:Q,items:Mu,filteredItems:me,metricKeys:Sr,selectedItems:Fs,selectedMetric:x.selectedMetric,onSelectMetric:N=>S($=>({...$,selectedMetric:N})),filters:x.filters,onChangeRange:Uu,onChangeFilters:N0,onResize:zn}),a.jsxs("div",{className:"grid-shell col-start-2 row-start-2 relative overflow-hidden flex flex-col",ref:be,children:[a.jsx("div",{"aria-live":"polite",className:"sr-only",children:$t.length?`${$t.length} selected`:""}),a.jsx(XN,{persistenceEnabled:Fu,indexing:Bt,showSwitchToMostRecentBanner:Qi.showSwitchToMostRecentBanner,onSwitchToMostRecent:h0,offViewSummary:Ge,canRevealOffView:zu,onRevealOffView:j0,onClearOffView:f0,browserZoomPercent:h}),jh&&a.jsx("div",{className:"border-b border-border bg-panel px-3 py-2",children:a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",children:jh})}),o&&a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"font-semibold",children:"Similarity mode"}),a.jsxs("span",{className:"text-muted",children:["Embedding: ",o.embedding]}),Sh&&a.jsxs("span",{className:"text-muted",children:["Query: ",Sh]}),bh&&a.jsxs("span",{className:"text-muted",children:["Results: ",bh]}),a.jsxs("span",{className:"text-muted",children:["Top K: ",o.topK]}),o.minScore!=null&&a.jsxs("span",{className:"text-muted",children:["Min score: ",o.minScore]})]}),a.jsx("button",{className:"btn btn-sm",onClick:Bu,children:"Exit similarity"})]})}),kh.length>0&&a.jsx("div",{className:"sticky top-0 z-10 px-3 py-2 bg-panel border-b border-border",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Filters"}),kh.map(N=>a.jsxs("span",{className:"filter-chip",children:[a.jsx("span",{className:"truncate max-w-[240px]",title:N.label,children:N.label}),a.jsx("button",{className:"filter-chip-remove","aria-label":`Clear filter ${N.label}`,onClick:N.onRemove,children:""})]},N.id)),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:Ch,children:"Clear all"})]})}),a.jsxs("div",{className:"flex-1 min-h-0 relative",children:[a.jsx(VC,{items:me,selected:$t,restoreToSelectionToken:ll,restoreToTopAnchorToken:de,restoreToTopAnchorPath:g0,multiSelectMode:gl&&E,onSelectionChange:rt,onOpenViewer:N=>{Nu(N),ju(N),rt([N])},highlight:Jt?ns:"",recentlyUpdated:le,onVisiblePathsChange:p0,onTopAnchorPathChange:m0,suppressSelectionHighlight:Ds,viewMode:g,targetCellSize:m,onContextMenuItem:(N,$)=>{N.preventDefault(),Rh($,{x:N.clientX,y:N.clientY})},onOpenItemActions:Rh,scrollRef:Ce,hideScrollbar:pl}),pl&&$s&&a.jsx(QC,{items:me,metricKey:$s,scrollRef:Ce,sortDir:x.sort.dir})]})]}),P&&a.jsx(AE,{path:$t[0]??null,selectedPaths:$t,items:me,compareActive:Ct,compareA:Xn,compareB:Jn,onOpenCompare:cl,sortSpec:x.sort,onResize:fn,onStarChanged:(N,$)=>{he(te=>{const ce={...te};for(const _e of N)ce[_e]=$;return ce})},onFindSimilar:()=>i(!0),embeddingsAvailable:we,embeddingsLoading:Ee,compareExportSupportsV2:Hi.supportsV2,compareExportMaxPathsV2:Hi.maxPathsV2,onLocalTypingChange:ke}),a.jsx(FE,{open:s,embeddings:Y,rejected:ue,selectedPath:$t[0]??null,embeddingsLoading:Ee,embeddingsError:Pe,onClose:()=>i(!1),onSearch:M0}),tn&&a.jsx(ok,{path:tn,onClose:ul,onZoomChange:N=>p(Math.round(N)),requestedZoomPercent:c,onZoomRequestConsumed:()=>d(null),canPrev:al,canNext:Bi,onNavigate:zs}),Ct&&a.jsx(hk,{aItem:Xn,bItem:Jn,index:Os,total:Yn.length,canPrev:Cu,canNext:ku,onNavigate:Vi,onClose:Ui}),Mh&&a.jsx(aj,{paths:Mh.paths,defaultDestination:e,destinations:A0,loadingDestinations:F0,onClose:D0,onSubmit:U0}),L0&&a.jsx("div",{className:"toolbar-offset fixed inset-0 left-[var(--left)] right-[var(--right)] bg-accent/10 border-2 border-dashed border-accent text-text flex items-center justify-center text-lg z-overlay pointer-events-none",children:"Drop images to upload"}),Ph&&a.jsx(pj,{ctx:Ph,current:e,items:me,setCtx:O0,onRefetch:Xt,onOpenMoveDialog:B0,onRefreshFolder:Du})]})}const kM=new WS({defaultOptions:{queries:{staleTime:1e4,gcTime:5*6e4,retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),1e4),refetchOnWindowFocus:!1,refetchOnReconnect:"always"},mutations:{retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),5e3)}}});function EM(){return a.jsx(HS,{client:kM,children:a.jsx(CM,{})})}Xv(document.getElementById("root")).render(a.jsx(EM,{}));
