var T0=Object.defineProperty;var $h=e=>{throw TypeError(e)};var L0=(e,t,n)=>t in e?T0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var rt=(e,t,n)=>L0(e,typeof t!="symbol"?t+"":t,n),tc=(e,t,n)=>t.has(e)||$h("Cannot "+n);var b=(e,t,n)=>(tc(e,t,"read from private field"),n?n.call(e):t.get(e)),he=(e,t,n)=>t.has(e)?$h("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),re=(e,t,n,r)=>(tc(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),Ce=(e,t,n)=>(tc(e,t,"access private method"),n);var Yl=(e,t,n,r)=>({set _(s){re(e,t,s,n)},get _(){return b(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function _0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ug={exports:{}},wu={},Hg={exports:{}},Ne={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bl=Symbol.for("react.element"),I0=Symbol.for("react.portal"),F0=Symbol.for("react.fragment"),O0=Symbol.for("react.strict_mode"),A0=Symbol.for("react.profiler"),D0=Symbol.for("react.provider"),z0=Symbol.for("react.context"),$0=Symbol.for("react.forward_ref"),B0=Symbol.for("react.suspense"),U0=Symbol.for("react.memo"),H0=Symbol.for("react.lazy"),Bh=Symbol.iterator;function V0(e){return e===null||typeof e!="object"?null:(e=Bh&&e[Bh]||e["@@iterator"],typeof e=="function"?e:null)}var Vg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Wg=Object.assign,Qg={};function so(e,t,n){this.props=e,this.context=t,this.refs=Qg,this.updater=n||Vg}so.prototype.isReactComponent={};so.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};so.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Kg(){}Kg.prototype=so.prototype;function pf(e,t,n){this.props=e,this.context=t,this.refs=Qg,this.updater=n||Vg}var mf=pf.prototype=new Kg;mf.constructor=pf;Wg(mf,so.prototype);mf.isPureReactComponent=!0;var Uh=Array.isArray,Yg=Object.prototype.hasOwnProperty,gf={current:null},Xg={key:!0,ref:!0,__self:!0,__source:!0};function qg(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Yg.call(t,r)&&!Xg.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:bl,type:e,key:i,ref:o,props:s,_owner:gf.current}}function W0(e,t){return{$$typeof:bl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function vf(e){return typeof e=="object"&&e!==null&&e.$$typeof===bl}function Q0(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Hh=/\/+/g;function nc(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Q0(""+e.key):t.toString(36)}function wa(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case bl:case I0:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+nc(o,0):r,Uh(s)?(n="",e!=null&&(n=e.replace(Hh,"$&/")+"/"),wa(s,t,n,"",function(d){return d})):s!=null&&(vf(s)&&(s=W0(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Hh,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",Uh(e))for(var l=0;l<e.length;l++){i=e[l];var u=r+nc(i,l);o+=wa(i,t,n,u,s)}else if(u=V0(e),typeof u=="function")for(e=u.call(e),l=0;!(i=e.next()).done;)i=i.value,u=r+nc(i,l++),o+=wa(i,t,n,u,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Xl(e,t,n){if(e==null)return e;var r=[],s=0;return wa(e,r,"","",function(i){return t.call(n,i,s++)}),r}function K0(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var At={current:null},Sa={transition:null},Y0={ReactCurrentDispatcher:At,ReactCurrentBatchConfig:Sa,ReactCurrentOwner:gf};function Gg(){throw Error("act(...) is not supported in production builds of React.")}Ne.Children={map:Xl,forEach:function(e,t,n){Xl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Xl(e,function(){t++}),t},toArray:function(e){return Xl(e,function(t){return t})||[]},only:function(e){if(!vf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ne.Component=so;Ne.Fragment=F0;Ne.Profiler=A0;Ne.PureComponent=pf;Ne.StrictMode=O0;Ne.Suspense=B0;Ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y0;Ne.act=Gg;Ne.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Wg({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=gf.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)Yg.call(t,u)&&!Xg.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:bl,type:e.type,key:s,ref:i,props:r,_owner:o}};Ne.createContext=function(e){return e={$$typeof:z0,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:D0,_context:e},e.Consumer=e};Ne.createElement=qg;Ne.createFactory=function(e){var t=qg.bind(null,e);return t.type=e,t};Ne.createRef=function(){return{current:null}};Ne.forwardRef=function(e){return{$$typeof:$0,render:e}};Ne.isValidElement=vf;Ne.lazy=function(e){return{$$typeof:H0,_payload:{_status:-1,_result:e},_init:K0}};Ne.memo=function(e,t){return{$$typeof:U0,type:e,compare:t===void 0?null:t}};Ne.startTransition=function(e){var t=Sa.transition;Sa.transition={};try{e()}finally{Sa.transition=t}};Ne.unstable_act=Gg;Ne.useCallback=function(e,t){return At.current.useCallback(e,t)};Ne.useContext=function(e){return At.current.useContext(e)};Ne.useDebugValue=function(){};Ne.useDeferredValue=function(e){return At.current.useDeferredValue(e)};Ne.useEffect=function(e,t){return At.current.useEffect(e,t)};Ne.useId=function(){return At.current.useId()};Ne.useImperativeHandle=function(e,t,n){return At.current.useImperativeHandle(e,t,n)};Ne.useInsertionEffect=function(e,t){return At.current.useInsertionEffect(e,t)};Ne.useLayoutEffect=function(e,t){return At.current.useLayoutEffect(e,t)};Ne.useMemo=function(e,t){return At.current.useMemo(e,t)};Ne.useReducer=function(e,t,n){return At.current.useReducer(e,t,n)};Ne.useRef=function(e){return At.current.useRef(e)};Ne.useState=function(e){return At.current.useState(e)};Ne.useSyncExternalStore=function(e,t,n){return At.current.useSyncExternalStore(e,t,n)};Ne.useTransition=function(){return At.current.useTransition()};Ne.version="18.3.1";Hg.exports=Ne;var c=Hg.exports;const Vh=_0(c);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X0=c,q0=Symbol.for("react.element"),G0=Symbol.for("react.fragment"),J0=Object.prototype.hasOwnProperty,Z0=X0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ew={key:!0,ref:!0,__self:!0,__source:!0};function Jg(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)J0.call(t,r)&&!ew.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:q0,type:e,key:i,ref:o,props:s,_owner:Z0.current}}wu.Fragment=G0;wu.jsx=Jg;wu.jsxs=Jg;Ug.exports=wu;var a=Ug.exports,Zg={exports:{}},dn={},ev={exports:{}},tv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,D){var H=P.length;P.push(D);e:for(;0<H;){var te=H-1>>>1,se=P[te];if(0<s(se,D))P[te]=D,P[H]=se,H=te;else break e}}function n(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var D=P[0],H=P.pop();if(H!==D){P[0]=H;e:for(var te=0,se=P.length,I=se>>>1;te<I;){var U=2*(te+1)-1,Y=P[U],Z=U+1,q=P[Z];if(0>s(Y,H))Z<se&&0>s(q,Y)?(P[te]=q,P[Z]=H,te=Z):(P[te]=Y,P[U]=H,te=U);else if(Z<se&&0>s(q,H))P[te]=q,P[Z]=H,te=Z;else break e}}return D}function s(P,D){var H=P.sortIndex-D.sortIndex;return H!==0?H:P.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],d=[],f=1,h=null,p=3,S=!1,w=!1,E=!1,j=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(P){for(var D=n(d);D!==null;){if(D.callback===null)r(d);else if(D.startTime<=P)r(d),D.sortIndex=D.expirationTime,t(u,D);else break;D=n(d)}}function y(P){if(E=!1,x(P),!w)if(n(u)!==null)w=!0,A(k);else{var D=n(d);D!==null&&_(y,D.startTime-P)}}function k(P,D){w=!1,E&&(E=!1,v(N),N=-1),S=!0;var H=p;try{for(x(D),h=n(u);h!==null&&(!(h.expirationTime>D)||P&&!X());){var te=h.callback;if(typeof te=="function"){h.callback=null,p=h.priorityLevel;var se=te(h.expirationTime<=D);D=e.unstable_now(),typeof se=="function"?h.callback=se:h===n(u)&&r(u),x(D)}else r(u);h=n(u)}if(h!==null)var I=!0;else{var U=n(d);U!==null&&_(y,U.startTime-D),I=!1}return I}finally{h=null,p=H,S=!1}}var R=!1,M=null,N=-1,O=5,T=-1;function X(){return!(e.unstable_now()-T<O)}function J(){if(M!==null){var P=e.unstable_now();T=P;var D=!0;try{D=M(!0,P)}finally{D?z():(R=!1,M=null)}}else R=!1}var z;if(typeof m=="function")z=function(){m(J)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,Q=le.port2;le.port1.onmessage=J,z=function(){Q.postMessage(null)}}else z=function(){j(J,0)};function A(P){M=P,R||(R=!0,z())}function _(P,D){N=j(function(){P(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){w||S||(w=!0,A(k))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(P){switch(p){case 1:case 2:case 3:var D=3;break;default:D=p}var H=p;p=D;try{return P()}finally{p=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,D){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var H=p;p=P;try{return D()}finally{p=H}},e.unstable_scheduleCallback=function(P,D,H){var te=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?te+H:te):H=te,P){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=H+se,P={id:f++,callback:D,priorityLevel:P,startTime:H,expirationTime:se,sortIndex:-1},H>te?(P.sortIndex=H,t(d,P),n(u)===null&&P===n(d)&&(E?(v(N),N=-1):E=!0,_(y,H-te))):(P.sortIndex=se,t(u,P),w||S||(w=!0,A(k))),P},e.unstable_shouldYield=X,e.unstable_wrapCallback=function(P){var D=p;return function(){var H=p;p=D;try{return P.apply(this,arguments)}finally{p=H}}}})(tv);ev.exports=tv;var tw=ev.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nw=c,cn=tw;function W(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var nv=new Set,qo={};function Gs(e,t){qi(e,t),qi(e+"Capture",t)}function qi(e,t){for(qo[e]=t,e=0;e<t.length;e++)nv.add(t[e])}var Er=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vc=Object.prototype.hasOwnProperty,rw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Wh={},Qh={};function sw(e){return Vc.call(Qh,e)?!0:Vc.call(Wh,e)?!1:rw.test(e)?Qh[e]=!0:(Wh[e]=!0,!1)}function iw(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function ow(e,t,n,r){if(t===null||typeof t>"u"||iw(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Dt(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var mt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){mt[e]=new Dt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];mt[t]=new Dt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){mt[e]=new Dt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){mt[e]=new Dt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){mt[e]=new Dt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){mt[e]=new Dt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){mt[e]=new Dt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){mt[e]=new Dt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){mt[e]=new Dt(e,5,!1,e.toLowerCase(),null,!1,!1)});var yf=/[\-:]([a-z])/g;function xf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(yf,xf);mt[t]=new Dt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(yf,xf);mt[t]=new Dt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(yf,xf);mt[t]=new Dt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){mt[e]=new Dt(e,1,!1,e.toLowerCase(),null,!1,!1)});mt.xlinkHref=new Dt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){mt[e]=new Dt(e,1,!1,e.toLowerCase(),null,!0,!0)});function wf(e,t,n,r){var s=mt.hasOwnProperty(t)?mt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(ow(t,n,s,r)&&(n=null),r||s===null?sw(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Rr=nw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ql=Symbol.for("react.element"),gi=Symbol.for("react.portal"),vi=Symbol.for("react.fragment"),Sf=Symbol.for("react.strict_mode"),Wc=Symbol.for("react.profiler"),rv=Symbol.for("react.provider"),sv=Symbol.for("react.context"),bf=Symbol.for("react.forward_ref"),Qc=Symbol.for("react.suspense"),Kc=Symbol.for("react.suspense_list"),Cf=Symbol.for("react.memo"),Ar=Symbol.for("react.lazy"),iv=Symbol.for("react.offscreen"),Kh=Symbol.iterator;function vo(e){return e===null||typeof e!="object"?null:(e=Kh&&e[Kh]||e["@@iterator"],typeof e=="function"?e:null)}var We=Object.assign,rc;function Lo(e){if(rc===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);rc=t&&t[1]||""}return`
`+rc+e}var sc=!1;function ic(e,t){if(!e||sc)return"";sc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=l);break}}}finally{sc=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Lo(e):""}function lw(e){switch(e.tag){case 5:return Lo(e.type);case 16:return Lo("Lazy");case 13:return Lo("Suspense");case 19:return Lo("SuspenseList");case 0:case 2:case 15:return e=ic(e.type,!1),e;case 11:return e=ic(e.type.render,!1),e;case 1:return e=ic(e.type,!0),e;default:return""}}function Yc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case vi:return"Fragment";case gi:return"Portal";case Wc:return"Profiler";case Sf:return"StrictMode";case Qc:return"Suspense";case Kc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case sv:return(e.displayName||"Context")+".Consumer";case rv:return(e._context.displayName||"Context")+".Provider";case bf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Cf:return t=e.displayName||null,t!==null?t:Yc(e.type)||"Memo";case Ar:t=e._payload,e=e._init;try{return Yc(e(t))}catch{}}return null}function aw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Yc(t);case 8:return t===Sf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function as(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ov(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function uw(e){var t=ov(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Gl(e){e._valueTracker||(e._valueTracker=uw(e))}function lv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ov(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function $a(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Xc(e,t){var n=t.checked;return We({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Yh(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=as(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function av(e,t){t=t.checked,t!=null&&wf(e,"checked",t,!1)}function qc(e,t){av(e,t);var n=as(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Gc(e,t.type,n):t.hasOwnProperty("defaultValue")&&Gc(e,t.type,as(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Xh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Gc(e,t,n){(t!=="number"||$a(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var _o=Array.isArray;function Mi(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+as(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Jc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(W(91));return We({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function qh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(W(92));if(_o(n)){if(1<n.length)throw Error(W(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:as(n)}}function uv(e,t){var n=as(t.value),r=as(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Gh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function cv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?cv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Jl,dv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Jl=Jl||document.createElement("div"),Jl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Jl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Go(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Do={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cw=["Webkit","ms","Moz","O"];Object.keys(Do).forEach(function(e){cw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Do[t]=Do[e]})});function fv(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Do.hasOwnProperty(e)&&Do[e]?(""+t).trim():t+"px"}function hv(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=fv(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var dw=We({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ed(e,t){if(t){if(dw[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(W(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(W(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(W(61))}if(t.style!=null&&typeof t.style!="object")throw Error(W(62))}}function td(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nd=null;function kf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var rd=null,Ri=null,Pi=null;function Jh(e){if(e=El(e)){if(typeof rd!="function")throw Error(W(280));var t=e.stateNode;t&&(t=Eu(t),rd(e.stateNode,e.type,t))}}function pv(e){Ri?Pi?Pi.push(e):Pi=[e]:Ri=e}function mv(){if(Ri){var e=Ri,t=Pi;if(Pi=Ri=null,Jh(e),t)for(e=0;e<t.length;e++)Jh(t[e])}}function gv(e,t){return e(t)}function vv(){}var oc=!1;function yv(e,t,n){if(oc)return e(t,n);oc=!0;try{return gv(e,t,n)}finally{oc=!1,(Ri!==null||Pi!==null)&&(vv(),mv())}}function Jo(e,t){var n=e.stateNode;if(n===null)return null;var r=Eu(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(W(231,t,typeof n));return n}var sd=!1;if(Er)try{var yo={};Object.defineProperty(yo,"passive",{get:function(){sd=!0}}),window.addEventListener("test",yo,yo),window.removeEventListener("test",yo,yo)}catch{sd=!1}function fw(e,t,n,r,s,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(f){this.onError(f)}}var zo=!1,Ba=null,Ua=!1,id=null,hw={onError:function(e){zo=!0,Ba=e}};function pw(e,t,n,r,s,i,o,l,u){zo=!1,Ba=null,fw.apply(hw,arguments)}function mw(e,t,n,r,s,i,o,l,u){if(pw.apply(this,arguments),zo){if(zo){var d=Ba;zo=!1,Ba=null}else throw Error(W(198));Ua||(Ua=!0,id=d)}}function Js(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function xv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Zh(e){if(Js(e)!==e)throw Error(W(188))}function gw(e){var t=e.alternate;if(!t){if(t=Js(e),t===null)throw Error(W(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Zh(s),e;if(i===r)return Zh(s),t;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?e:t}function wv(e){return e=gw(e),e!==null?Sv(e):null}function Sv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Sv(e);if(t!==null)return t;e=e.sibling}return null}var bv=cn.unstable_scheduleCallback,ep=cn.unstable_cancelCallback,vw=cn.unstable_shouldYield,yw=cn.unstable_requestPaint,Ge=cn.unstable_now,xw=cn.unstable_getCurrentPriorityLevel,Ef=cn.unstable_ImmediatePriority,Cv=cn.unstable_UserBlockingPriority,Ha=cn.unstable_NormalPriority,ww=cn.unstable_LowPriority,kv=cn.unstable_IdlePriority,Su=null,nr=null;function Sw(e){if(nr&&typeof nr.onCommitFiberRoot=="function")try{nr.onCommitFiberRoot(Su,e,void 0,(e.current.flags&128)===128)}catch{}}var Dn=Math.clz32?Math.clz32:kw,bw=Math.log,Cw=Math.LN2;function kw(e){return e>>>=0,e===0?32:31-(bw(e)/Cw|0)|0}var Zl=64,ea=4194304;function Io(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Va(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Io(l):(i&=o,i!==0&&(r=Io(i)))}else o=n&~s,o!==0?r=Io(o):i!==0&&(r=Io(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Dn(t),s=1<<n,r|=e[n],t&=~s;return r}function Ew(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nw(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Dn(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=Ew(l,t)):u<=t&&(e.expiredLanes|=l),i&=~l}}function od(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Ev(){var e=Zl;return Zl<<=1,!(Zl&4194240)&&(Zl=64),e}function lc(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Cl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Dn(t),e[t]=n}function jw(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Dn(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function Nf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Dn(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Fe=0;function Nv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var jv,jf,Mv,Rv,Pv,ld=!1,ta=[],Jr=null,Zr=null,es=null,Zo=new Map,el=new Map,zr=[],Mw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tp(e,t){switch(e){case"focusin":case"focusout":Jr=null;break;case"dragenter":case"dragleave":Zr=null;break;case"mouseover":case"mouseout":es=null;break;case"pointerover":case"pointerout":Zo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":el.delete(t.pointerId)}}function xo(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=El(t),t!==null&&jf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Rw(e,t,n,r,s){switch(t){case"focusin":return Jr=xo(Jr,e,t,n,r,s),!0;case"dragenter":return Zr=xo(Zr,e,t,n,r,s),!0;case"mouseover":return es=xo(es,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return Zo.set(i,xo(Zo.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,el.set(i,xo(el.get(i)||null,e,t,n,r,s)),!0}return!1}function Tv(e){var t=Ns(e.target);if(t!==null){var n=Js(t);if(n!==null){if(t=n.tag,t===13){if(t=xv(n),t!==null){e.blockedOn=t,Pv(e.priority,function(){Mv(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ba(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=ad(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);nd=r,n.target.dispatchEvent(r),nd=null}else return t=El(n),t!==null&&jf(t),e.blockedOn=n,!1;t.shift()}return!0}function np(e,t,n){ba(e)&&n.delete(t)}function Pw(){ld=!1,Jr!==null&&ba(Jr)&&(Jr=null),Zr!==null&&ba(Zr)&&(Zr=null),es!==null&&ba(es)&&(es=null),Zo.forEach(np),el.forEach(np)}function wo(e,t){e.blockedOn===t&&(e.blockedOn=null,ld||(ld=!0,cn.unstable_scheduleCallback(cn.unstable_NormalPriority,Pw)))}function tl(e){function t(s){return wo(s,e)}if(0<ta.length){wo(ta[0],e);for(var n=1;n<ta.length;n++){var r=ta[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Jr!==null&&wo(Jr,e),Zr!==null&&wo(Zr,e),es!==null&&wo(es,e),Zo.forEach(t),el.forEach(t),n=0;n<zr.length;n++)r=zr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<zr.length&&(n=zr[0],n.blockedOn===null);)Tv(n),n.blockedOn===null&&zr.shift()}var Ti=Rr.ReactCurrentBatchConfig,Wa=!0;function Tw(e,t,n,r){var s=Fe,i=Ti.transition;Ti.transition=null;try{Fe=1,Mf(e,t,n,r)}finally{Fe=s,Ti.transition=i}}function Lw(e,t,n,r){var s=Fe,i=Ti.transition;Ti.transition=null;try{Fe=4,Mf(e,t,n,r)}finally{Fe=s,Ti.transition=i}}function Mf(e,t,n,r){if(Wa){var s=ad(e,t,n,r);if(s===null)vc(e,t,r,Qa,n),tp(e,r);else if(Rw(s,e,t,n,r))r.stopPropagation();else if(tp(e,r),t&4&&-1<Mw.indexOf(e)){for(;s!==null;){var i=El(s);if(i!==null&&jv(i),i=ad(e,t,n,r),i===null&&vc(e,t,r,Qa,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else vc(e,t,r,null,n)}}var Qa=null;function ad(e,t,n,r){if(Qa=null,e=kf(r),e=Ns(e),e!==null)if(t=Js(e),t===null)e=null;else if(n=t.tag,n===13){if(e=xv(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qa=e,null}function Lv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xw()){case Ef:return 1;case Cv:return 4;case Ha:case ww:return 16;case kv:return 536870912;default:return 16}default:return 16}}var qr=null,Rf=null,Ca=null;function _v(){if(Ca)return Ca;var e,t=Rf,n=t.length,r,s="value"in qr?qr.value:qr.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return Ca=s.slice(e,1<r?1-r:void 0)}function ka(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function na(){return!0}function rp(){return!1}function fn(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?na:rp,this.isPropagationStopped=rp,this}return We(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=na)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=na)},persist:function(){},isPersistent:na}),t}var io={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pf=fn(io),kl=We({},io,{view:0,detail:0}),_w=fn(kl),ac,uc,So,bu=We({},kl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==So&&(So&&e.type==="mousemove"?(ac=e.screenX-So.screenX,uc=e.screenY-So.screenY):uc=ac=0,So=e),ac)},movementY:function(e){return"movementY"in e?e.movementY:uc}}),sp=fn(bu),Iw=We({},bu,{dataTransfer:0}),Fw=fn(Iw),Ow=We({},kl,{relatedTarget:0}),cc=fn(Ow),Aw=We({},io,{animationName:0,elapsedTime:0,pseudoElement:0}),Dw=fn(Aw),zw=We({},io,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),$w=fn(zw),Bw=We({},io,{data:0}),ip=fn(Bw),Uw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Vw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ww(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Vw[e])?!!t[e]:!1}function Tf(){return Ww}var Qw=We({},kl,{key:function(e){if(e.key){var t=Uw[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ka(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Hw[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tf,charCode:function(e){return e.type==="keypress"?ka(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ka(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Kw=fn(Qw),Yw=We({},bu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),op=fn(Yw),Xw=We({},kl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tf}),qw=fn(Xw),Gw=We({},io,{propertyName:0,elapsedTime:0,pseudoElement:0}),Jw=fn(Gw),Zw=We({},bu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),e1=fn(Zw),t1=[9,13,27,32],Lf=Er&&"CompositionEvent"in window,$o=null;Er&&"documentMode"in document&&($o=document.documentMode);var n1=Er&&"TextEvent"in window&&!$o,Iv=Er&&(!Lf||$o&&8<$o&&11>=$o),lp=" ",ap=!1;function Fv(e,t){switch(e){case"keyup":return t1.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ov(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var yi=!1;function r1(e,t){switch(e){case"compositionend":return Ov(t);case"keypress":return t.which!==32?null:(ap=!0,lp);case"textInput":return e=t.data,e===lp&&ap?null:e;default:return null}}function s1(e,t){if(yi)return e==="compositionend"||!Lf&&Fv(e,t)?(e=_v(),Ca=Rf=qr=null,yi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Iv&&t.locale!=="ko"?null:t.data;default:return null}}var i1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function up(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!i1[e.type]:t==="textarea"}function Av(e,t,n,r){pv(r),t=Ka(t,"onChange"),0<t.length&&(n=new Pf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Bo=null,nl=null;function o1(e){Yv(e,0)}function Cu(e){var t=Si(e);if(lv(t))return e}function l1(e,t){if(e==="change")return t}var Dv=!1;if(Er){var dc;if(Er){var fc="oninput"in document;if(!fc){var cp=document.createElement("div");cp.setAttribute("oninput","return;"),fc=typeof cp.oninput=="function"}dc=fc}else dc=!1;Dv=dc&&(!document.documentMode||9<document.documentMode)}function dp(){Bo&&(Bo.detachEvent("onpropertychange",zv),nl=Bo=null)}function zv(e){if(e.propertyName==="value"&&Cu(nl)){var t=[];Av(t,nl,e,kf(e)),yv(o1,t)}}function a1(e,t,n){e==="focusin"?(dp(),Bo=t,nl=n,Bo.attachEvent("onpropertychange",zv)):e==="focusout"&&dp()}function u1(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Cu(nl)}function c1(e,t){if(e==="click")return Cu(t)}function d1(e,t){if(e==="input"||e==="change")return Cu(t)}function f1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var $n=typeof Object.is=="function"?Object.is:f1;function rl(e,t){if($n(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Vc.call(t,s)||!$n(e[s],t[s]))return!1}return!0}function fp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hp(e,t){var n=fp(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=fp(n)}}function $v(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?$v(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Bv(){for(var e=window,t=$a();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=$a(e.document)}return t}function _f(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function h1(e){var t=Bv(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&$v(n.ownerDocument.documentElement,n)){if(r!==null&&_f(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=hp(n,i);var o=hp(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var p1=Er&&"documentMode"in document&&11>=document.documentMode,xi=null,ud=null,Uo=null,cd=!1;function pp(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;cd||xi==null||xi!==$a(r)||(r=xi,"selectionStart"in r&&_f(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Uo&&rl(Uo,r)||(Uo=r,r=Ka(ud,"onSelect"),0<r.length&&(t=new Pf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=xi)))}function ra(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wi={animationend:ra("Animation","AnimationEnd"),animationiteration:ra("Animation","AnimationIteration"),animationstart:ra("Animation","AnimationStart"),transitionend:ra("Transition","TransitionEnd")},hc={},Uv={};Er&&(Uv=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);function ku(e){if(hc[e])return hc[e];if(!wi[e])return e;var t=wi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Uv)return hc[e]=t[n];return e}var Hv=ku("animationend"),Vv=ku("animationiteration"),Wv=ku("animationstart"),Qv=ku("transitionend"),Kv=new Map,mp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function cs(e,t){Kv.set(e,t),Gs(t,[e])}for(var pc=0;pc<mp.length;pc++){var mc=mp[pc],m1=mc.toLowerCase(),g1=mc[0].toUpperCase()+mc.slice(1);cs(m1,"on"+g1)}cs(Hv,"onAnimationEnd");cs(Vv,"onAnimationIteration");cs(Wv,"onAnimationStart");cs("dblclick","onDoubleClick");cs("focusin","onFocus");cs("focusout","onBlur");cs(Qv,"onTransitionEnd");qi("onMouseEnter",["mouseout","mouseover"]);qi("onMouseLeave",["mouseout","mouseover"]);qi("onPointerEnter",["pointerout","pointerover"]);qi("onPointerLeave",["pointerout","pointerover"]);Gs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Gs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Gs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Gs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Gs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Gs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),v1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fo));function gp(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,mw(r,t,void 0,e),e.currentTarget=null}function Yv(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;gp(s,l,d),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;gp(s,l,d),i=u}}}if(Ua)throw e=id,Ua=!1,id=null,e}function ze(e,t){var n=t[md];n===void 0&&(n=t[md]=new Set);var r=e+"__bubble";n.has(r)||(Xv(t,e,2,!1),n.add(r))}function gc(e,t,n){var r=0;t&&(r|=4),Xv(n,e,r,t)}var sa="_reactListening"+Math.random().toString(36).slice(2);function sl(e){if(!e[sa]){e[sa]=!0,nv.forEach(function(n){n!=="selectionchange"&&(v1.has(n)||gc(n,!1,e),gc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[sa]||(t[sa]=!0,gc("selectionchange",!1,t))}}function Xv(e,t,n,r){switch(Lv(t)){case 1:var s=Tw;break;case 4:s=Lw;break;default:s=Mf}n=s.bind(null,t,n,e),s=void 0,!sd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function vc(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Ns(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}yv(function(){var d=i,f=kf(n),h=[];e:{var p=Kv.get(e);if(p!==void 0){var S=Pf,w=e;switch(e){case"keypress":if(ka(n)===0)break e;case"keydown":case"keyup":S=Kw;break;case"focusin":w="focus",S=cc;break;case"focusout":w="blur",S=cc;break;case"beforeblur":case"afterblur":S=cc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=sp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=Fw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=qw;break;case Hv:case Vv:case Wv:S=Dw;break;case Qv:S=Jw;break;case"scroll":S=_w;break;case"wheel":S=e1;break;case"copy":case"cut":case"paste":S=$w;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=op}var E=(t&4)!==0,j=!E&&e==="scroll",v=E?p!==null?p+"Capture":null:p;E=[];for(var m=d,x;m!==null;){x=m;var y=x.stateNode;if(x.tag===5&&y!==null&&(x=y,v!==null&&(y=Jo(m,v),y!=null&&E.push(il(m,y,x)))),j)break;m=m.return}0<E.length&&(p=new S(p,w,null,n,f),h.push({event:p,listeners:E}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",S=e==="mouseout"||e==="pointerout",p&&n!==nd&&(w=n.relatedTarget||n.fromElement)&&(Ns(w)||w[Nr]))break e;if((S||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,S?(w=n.relatedTarget||n.toElement,S=d,w=w?Ns(w):null,w!==null&&(j=Js(w),w!==j||w.tag!==5&&w.tag!==6)&&(w=null)):(S=null,w=d),S!==w)){if(E=sp,y="onMouseLeave",v="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(E=op,y="onPointerLeave",v="onPointerEnter",m="pointer"),j=S==null?p:Si(S),x=w==null?p:Si(w),p=new E(y,m+"leave",S,n,f),p.target=j,p.relatedTarget=x,y=null,Ns(f)===d&&(E=new E(v,m+"enter",w,n,f),E.target=x,E.relatedTarget=j,y=E),j=y,S&&w)t:{for(E=S,v=w,m=0,x=E;x;x=fi(x))m++;for(x=0,y=v;y;y=fi(y))x++;for(;0<m-x;)E=fi(E),m--;for(;0<x-m;)v=fi(v),x--;for(;m--;){if(E===v||v!==null&&E===v.alternate)break t;E=fi(E),v=fi(v)}E=null}else E=null;S!==null&&vp(h,p,S,E,!1),w!==null&&j!==null&&vp(h,j,w,E,!0)}}e:{if(p=d?Si(d):window,S=p.nodeName&&p.nodeName.toLowerCase(),S==="select"||S==="input"&&p.type==="file")var k=l1;else if(up(p))if(Dv)k=d1;else{k=u1;var R=a1}else(S=p.nodeName)&&S.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(k=c1);if(k&&(k=k(e,d))){Av(h,k,n,f);break e}R&&R(e,p,d),e==="focusout"&&(R=p._wrapperState)&&R.controlled&&p.type==="number"&&Gc(p,"number",p.value)}switch(R=d?Si(d):window,e){case"focusin":(up(R)||R.contentEditable==="true")&&(xi=R,ud=d,Uo=null);break;case"focusout":Uo=ud=xi=null;break;case"mousedown":cd=!0;break;case"contextmenu":case"mouseup":case"dragend":cd=!1,pp(h,n,f);break;case"selectionchange":if(p1)break;case"keydown":case"keyup":pp(h,n,f)}var M;if(Lf)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else yi?Fv(e,n)&&(N="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(Iv&&n.locale!=="ko"&&(yi||N!=="onCompositionStart"?N==="onCompositionEnd"&&yi&&(M=_v()):(qr=f,Rf="value"in qr?qr.value:qr.textContent,yi=!0)),R=Ka(d,N),0<R.length&&(N=new ip(N,e,null,n,f),h.push({event:N,listeners:R}),M?N.data=M:(M=Ov(n),M!==null&&(N.data=M)))),(M=n1?r1(e,n):s1(e,n))&&(d=Ka(d,"onBeforeInput"),0<d.length&&(f=new ip("onBeforeInput","beforeinput",null,n,f),h.push({event:f,listeners:d}),f.data=M))}Yv(h,t)})}function il(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ka(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Jo(e,n),i!=null&&r.unshift(il(e,i,s)),i=Jo(e,t),i!=null&&r.push(il(e,i,s))),e=e.return}return r}function fi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function vp(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,s?(u=Jo(n,i),u!=null&&o.unshift(il(n,u,l))):s||(u=Jo(n,i),u!=null&&o.push(il(n,u,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var y1=/\r\n?/g,x1=/\u0000|\uFFFD/g;function yp(e){return(typeof e=="string"?e:""+e).replace(y1,`
`).replace(x1,"")}function ia(e,t,n){if(t=yp(t),yp(e)!==t&&n)throw Error(W(425))}function Ya(){}var dd=null,fd=null;function hd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var pd=typeof setTimeout=="function"?setTimeout:void 0,w1=typeof clearTimeout=="function"?clearTimeout:void 0,xp=typeof Promise=="function"?Promise:void 0,S1=typeof queueMicrotask=="function"?queueMicrotask:typeof xp<"u"?function(e){return xp.resolve(null).then(e).catch(b1)}:pd;function b1(e){setTimeout(function(){throw e})}function yc(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),tl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);tl(t)}function ts(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function wp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var oo=Math.random().toString(36).slice(2),tr="__reactFiber$"+oo,ol="__reactProps$"+oo,Nr="__reactContainer$"+oo,md="__reactEvents$"+oo,C1="__reactListeners$"+oo,k1="__reactHandles$"+oo;function Ns(e){var t=e[tr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Nr]||n[tr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=wp(e);e!==null;){if(n=e[tr])return n;e=wp(e)}return t}e=n,n=e.parentNode}return null}function El(e){return e=e[tr]||e[Nr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Si(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(W(33))}function Eu(e){return e[ol]||null}var gd=[],bi=-1;function ds(e){return{current:e}}function $e(e){0>bi||(e.current=gd[bi],gd[bi]=null,bi--)}function Ae(e,t){bi++,gd[bi]=e.current,e.current=t}var us={},Et=ds(us),Yt=ds(!1),Vs=us;function Gi(e,t){var n=e.type.contextTypes;if(!n)return us;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Xt(e){return e=e.childContextTypes,e!=null}function Xa(){$e(Yt),$e(Et)}function Sp(e,t,n){if(Et.current!==us)throw Error(W(168));Ae(Et,t),Ae(Yt,n)}function qv(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(W(108,aw(e)||"Unknown",s));return We({},n,r)}function qa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||us,Vs=Et.current,Ae(Et,e),Ae(Yt,Yt.current),!0}function bp(e,t,n){var r=e.stateNode;if(!r)throw Error(W(169));n?(e=qv(e,t,Vs),r.__reactInternalMemoizedMergedChildContext=e,$e(Yt),$e(Et),Ae(Et,e)):$e(Yt),Ae(Yt,n)}var mr=null,Nu=!1,xc=!1;function Gv(e){mr===null?mr=[e]:mr.push(e)}function E1(e){Nu=!0,Gv(e)}function fs(){if(!xc&&mr!==null){xc=!0;var e=0,t=Fe;try{var n=mr;for(Fe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}mr=null,Nu=!1}catch(s){throw mr!==null&&(mr=mr.slice(e+1)),bv(Ef,fs),s}finally{Fe=t,xc=!1}}return null}var Ci=[],ki=0,Ga=null,Ja=0,bn=[],Cn=0,Ws=null,wr=1,Sr="";function ks(e,t){Ci[ki++]=Ja,Ci[ki++]=Ga,Ga=e,Ja=t}function Jv(e,t,n){bn[Cn++]=wr,bn[Cn++]=Sr,bn[Cn++]=Ws,Ws=e;var r=wr;e=Sr;var s=32-Dn(r)-1;r&=~(1<<s),n+=1;var i=32-Dn(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,wr=1<<32-Dn(t)+s|n<<s|r,Sr=i+e}else wr=1<<i|n<<s|r,Sr=e}function If(e){e.return!==null&&(ks(e,1),Jv(e,1,0))}function Ff(e){for(;e===Ga;)Ga=Ci[--ki],Ci[ki]=null,Ja=Ci[--ki],Ci[ki]=null;for(;e===Ws;)Ws=bn[--Cn],bn[Cn]=null,Sr=bn[--Cn],bn[Cn]=null,wr=bn[--Cn],bn[Cn]=null}var an=null,ln=null,Be=!1,An=null;function Zv(e,t){var n=En(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Cp(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,an=e,ln=ts(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,an=e,ln=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ws!==null?{id:wr,overflow:Sr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=En(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,an=e,ln=null,!0):!1;default:return!1}}function vd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function yd(e){if(Be){var t=ln;if(t){var n=t;if(!Cp(e,t)){if(vd(e))throw Error(W(418));t=ts(n.nextSibling);var r=an;t&&Cp(e,t)?Zv(r,n):(e.flags=e.flags&-4097|2,Be=!1,an=e)}}else{if(vd(e))throw Error(W(418));e.flags=e.flags&-4097|2,Be=!1,an=e}}}function kp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;an=e}function oa(e){if(e!==an)return!1;if(!Be)return kp(e),Be=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!hd(e.type,e.memoizedProps)),t&&(t=ln)){if(vd(e))throw ey(),Error(W(418));for(;t;)Zv(e,t),t=ts(t.nextSibling)}if(kp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(W(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){ln=ts(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}ln=null}}else ln=an?ts(e.stateNode.nextSibling):null;return!0}function ey(){for(var e=ln;e;)e=ts(e.nextSibling)}function Ji(){ln=an=null,Be=!1}function Of(e){An===null?An=[e]:An.push(e)}var N1=Rr.ReactCurrentBatchConfig;function bo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,e))}return e}function la(e,t){throw e=Object.prototype.toString.call(t),Error(W(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ep(e){var t=e._init;return t(e._payload)}function ty(e){function t(v,m){if(e){var x=v.deletions;x===null?(v.deletions=[m],v.flags|=16):x.push(m)}}function n(v,m){if(!e)return null;for(;m!==null;)t(v,m),m=m.sibling;return null}function r(v,m){for(v=new Map;m!==null;)m.key!==null?v.set(m.key,m):v.set(m.index,m),m=m.sibling;return v}function s(v,m){return v=is(v,m),v.index=0,v.sibling=null,v}function i(v,m,x){return v.index=x,e?(x=v.alternate,x!==null?(x=x.index,x<m?(v.flags|=2,m):x):(v.flags|=2,m)):(v.flags|=1048576,m)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,m,x,y){return m===null||m.tag!==6?(m=Nc(x,v.mode,y),m.return=v,m):(m=s(m,x),m.return=v,m)}function u(v,m,x,y){var k=x.type;return k===vi?f(v,m,x.props.children,y,x.key):m!==null&&(m.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ar&&Ep(k)===m.type)?(y=s(m,x.props),y.ref=bo(v,m,x),y.return=v,y):(y=Ta(x.type,x.key,x.props,null,v.mode,y),y.ref=bo(v,m,x),y.return=v,y)}function d(v,m,x,y){return m===null||m.tag!==4||m.stateNode.containerInfo!==x.containerInfo||m.stateNode.implementation!==x.implementation?(m=jc(x,v.mode,y),m.return=v,m):(m=s(m,x.children||[]),m.return=v,m)}function f(v,m,x,y,k){return m===null||m.tag!==7?(m=Hs(x,v.mode,y,k),m.return=v,m):(m=s(m,x),m.return=v,m)}function h(v,m,x){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Nc(""+m,v.mode,x),m.return=v,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case ql:return x=Ta(m.type,m.key,m.props,null,v.mode,x),x.ref=bo(v,null,m),x.return=v,x;case gi:return m=jc(m,v.mode,x),m.return=v,m;case Ar:var y=m._init;return h(v,y(m._payload),x)}if(_o(m)||vo(m))return m=Hs(m,v.mode,x,null),m.return=v,m;la(v,m)}return null}function p(v,m,x,y){var k=m!==null?m.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return k!==null?null:l(v,m,""+x,y);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ql:return x.key===k?u(v,m,x,y):null;case gi:return x.key===k?d(v,m,x,y):null;case Ar:return k=x._init,p(v,m,k(x._payload),y)}if(_o(x)||vo(x))return k!==null?null:f(v,m,x,y,null);la(v,x)}return null}function S(v,m,x,y,k){if(typeof y=="string"&&y!==""||typeof y=="number")return v=v.get(x)||null,l(m,v,""+y,k);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ql:return v=v.get(y.key===null?x:y.key)||null,u(m,v,y,k);case gi:return v=v.get(y.key===null?x:y.key)||null,d(m,v,y,k);case Ar:var R=y._init;return S(v,m,x,R(y._payload),k)}if(_o(y)||vo(y))return v=v.get(x)||null,f(m,v,y,k,null);la(m,y)}return null}function w(v,m,x,y){for(var k=null,R=null,M=m,N=m=0,O=null;M!==null&&N<x.length;N++){M.index>N?(O=M,M=null):O=M.sibling;var T=p(v,M,x[N],y);if(T===null){M===null&&(M=O);break}e&&M&&T.alternate===null&&t(v,M),m=i(T,m,N),R===null?k=T:R.sibling=T,R=T,M=O}if(N===x.length)return n(v,M),Be&&ks(v,N),k;if(M===null){for(;N<x.length;N++)M=h(v,x[N],y),M!==null&&(m=i(M,m,N),R===null?k=M:R.sibling=M,R=M);return Be&&ks(v,N),k}for(M=r(v,M);N<x.length;N++)O=S(M,v,N,x[N],y),O!==null&&(e&&O.alternate!==null&&M.delete(O.key===null?N:O.key),m=i(O,m,N),R===null?k=O:R.sibling=O,R=O);return e&&M.forEach(function(X){return t(v,X)}),Be&&ks(v,N),k}function E(v,m,x,y){var k=vo(x);if(typeof k!="function")throw Error(W(150));if(x=k.call(x),x==null)throw Error(W(151));for(var R=k=null,M=m,N=m=0,O=null,T=x.next();M!==null&&!T.done;N++,T=x.next()){M.index>N?(O=M,M=null):O=M.sibling;var X=p(v,M,T.value,y);if(X===null){M===null&&(M=O);break}e&&M&&X.alternate===null&&t(v,M),m=i(X,m,N),R===null?k=X:R.sibling=X,R=X,M=O}if(T.done)return n(v,M),Be&&ks(v,N),k;if(M===null){for(;!T.done;N++,T=x.next())T=h(v,T.value,y),T!==null&&(m=i(T,m,N),R===null?k=T:R.sibling=T,R=T);return Be&&ks(v,N),k}for(M=r(v,M);!T.done;N++,T=x.next())T=S(M,v,N,T.value,y),T!==null&&(e&&T.alternate!==null&&M.delete(T.key===null?N:T.key),m=i(T,m,N),R===null?k=T:R.sibling=T,R=T);return e&&M.forEach(function(J){return t(v,J)}),Be&&ks(v,N),k}function j(v,m,x,y){if(typeof x=="object"&&x!==null&&x.type===vi&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case ql:e:{for(var k=x.key,R=m;R!==null;){if(R.key===k){if(k=x.type,k===vi){if(R.tag===7){n(v,R.sibling),m=s(R,x.props.children),m.return=v,v=m;break e}}else if(R.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ar&&Ep(k)===R.type){n(v,R.sibling),m=s(R,x.props),m.ref=bo(v,R,x),m.return=v,v=m;break e}n(v,R);break}else t(v,R);R=R.sibling}x.type===vi?(m=Hs(x.props.children,v.mode,y,x.key),m.return=v,v=m):(y=Ta(x.type,x.key,x.props,null,v.mode,y),y.ref=bo(v,m,x),y.return=v,v=y)}return o(v);case gi:e:{for(R=x.key;m!==null;){if(m.key===R)if(m.tag===4&&m.stateNode.containerInfo===x.containerInfo&&m.stateNode.implementation===x.implementation){n(v,m.sibling),m=s(m,x.children||[]),m.return=v,v=m;break e}else{n(v,m);break}else t(v,m);m=m.sibling}m=jc(x,v.mode,y),m.return=v,v=m}return o(v);case Ar:return R=x._init,j(v,m,R(x._payload),y)}if(_o(x))return w(v,m,x,y);if(vo(x))return E(v,m,x,y);la(v,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,m!==null&&m.tag===6?(n(v,m.sibling),m=s(m,x),m.return=v,v=m):(n(v,m),m=Nc(x,v.mode,y),m.return=v,v=m),o(v)):n(v,m)}return j}var Zi=ty(!0),ny=ty(!1),Za=ds(null),eu=null,Ei=null,Af=null;function Df(){Af=Ei=eu=null}function zf(e){var t=Za.current;$e(Za),e._currentValue=t}function xd(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Li(e,t){eu=e,Af=Ei=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Kt=!0),e.firstContext=null)}function jn(e){var t=e._currentValue;if(Af!==e)if(e={context:e,memoizedValue:t,next:null},Ei===null){if(eu===null)throw Error(W(308));Ei=e,eu.dependencies={lanes:0,firstContext:e}}else Ei=Ei.next=e;return t}var js=null;function $f(e){js===null?js=[e]:js.push(e)}function ry(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,$f(t)):(n.next=s.next,s.next=n),t.interleaved=n,jr(e,r)}function jr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Dr=!1;function Bf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sy(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function br(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function ns(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Pe&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,jr(e,n)}return s=r.interleaved,s===null?(t.next=t,$f(r)):(t.next=s.next,s.next=t),r.interleaved=t,jr(e,n)}function Ea(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Nf(e,n)}}function Np(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function tu(e,t,n,r){var s=e.updateQueue;Dr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=u))}if(i!==null){var h=s.baseState;o=0,f=d=u=null,l=i;do{var p=l.lane,S=l.eventTime;if((r&p)===p){f!==null&&(f=f.next={eventTime:S,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var w=e,E=l;switch(p=t,S=n,E.tag){case 1:if(w=E.payload,typeof w=="function"){h=w.call(S,h,p);break e}h=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=E.payload,p=typeof w=="function"?w.call(S,h,p):w,p==null)break e;h=We({},h,p);break e;case 2:Dr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else S={eventTime:S,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=S,u=h):f=f.next=S,o|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(f===null&&(u=h),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Ks|=o,e.lanes=o,e.memoizedState=h}}function jp(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var Nl={},rr=ds(Nl),ll=ds(Nl),al=ds(Nl);function Ms(e){if(e===Nl)throw Error(W(174));return e}function Uf(e,t){switch(Ae(al,t),Ae(ll,e),Ae(rr,Nl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Zc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Zc(t,e)}$e(rr),Ae(rr,t)}function eo(){$e(rr),$e(ll),$e(al)}function iy(e){Ms(al.current);var t=Ms(rr.current),n=Zc(t,e.type);t!==n&&(Ae(ll,e),Ae(rr,n))}function Hf(e){ll.current===e&&($e(rr),$e(ll))}var He=ds(0);function nu(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var wc=[];function Vf(){for(var e=0;e<wc.length;e++)wc[e]._workInProgressVersionPrimary=null;wc.length=0}var Na=Rr.ReactCurrentDispatcher,Sc=Rr.ReactCurrentBatchConfig,Qs=0,Ve=null,st=null,ct=null,ru=!1,Ho=!1,ul=0,j1=0;function St(){throw Error(W(321))}function Wf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!$n(e[n],t[n]))return!1;return!0}function Qf(e,t,n,r,s,i){if(Qs=i,Ve=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Na.current=e===null||e.memoizedState===null?T1:L1,e=n(r,s),Ho){i=0;do{if(Ho=!1,ul=0,25<=i)throw Error(W(301));i+=1,ct=st=null,t.updateQueue=null,Na.current=_1,e=n(r,s)}while(Ho)}if(Na.current=su,t=st!==null&&st.next!==null,Qs=0,ct=st=Ve=null,ru=!1,t)throw Error(W(300));return e}function Kf(){var e=ul!==0;return ul=0,e}function Gn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ct===null?Ve.memoizedState=ct=e:ct=ct.next=e,ct}function Mn(){if(st===null){var e=Ve.alternate;e=e!==null?e.memoizedState:null}else e=st.next;var t=ct===null?Ve.memoizedState:ct.next;if(t!==null)ct=t,st=e;else{if(e===null)throw Error(W(310));st=e,e={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},ct===null?Ve.memoizedState=ct=e:ct=ct.next=e}return ct}function cl(e,t){return typeof t=="function"?t(e):t}function bc(e){var t=Mn(),n=t.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=e;var r=st,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,d=i;do{var f=d.lane;if((Qs&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=h,o=r):u=u.next=h,Ve.lanes|=f,Ks|=f}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=l,$n(r,t.memoizedState)||(Kt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Ve.lanes|=i,Ks|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Cc(e){var t=Mn(),n=t.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);$n(i,t.memoizedState)||(Kt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function oy(){}function ly(e,t){var n=Ve,r=Mn(),s=t(),i=!$n(r.memoizedState,s);if(i&&(r.memoizedState=s,Kt=!0),r=r.queue,Yf(cy.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||ct!==null&&ct.memoizedState.tag&1){if(n.flags|=2048,dl(9,uy.bind(null,n,r,s,t),void 0,null),dt===null)throw Error(W(349));Qs&30||ay(n,t,s)}return s}function ay(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ve.updateQueue,t===null?(t={lastEffect:null,stores:null},Ve.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function uy(e,t,n,r){t.value=n,t.getSnapshot=r,dy(t)&&fy(e)}function cy(e,t,n){return n(function(){dy(t)&&fy(e)})}function dy(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!$n(e,n)}catch{return!0}}function fy(e){var t=jr(e,1);t!==null&&zn(t,e,1,-1)}function Mp(e){var t=Gn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cl,lastRenderedState:e},t.queue=e,e=e.dispatch=P1.bind(null,Ve,e),[t.memoizedState,e]}function dl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ve.updateQueue,t===null?(t={lastEffect:null,stores:null},Ve.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function hy(){return Mn().memoizedState}function ja(e,t,n,r){var s=Gn();Ve.flags|=e,s.memoizedState=dl(1|t,n,void 0,r===void 0?null:r)}function ju(e,t,n,r){var s=Mn();r=r===void 0?null:r;var i=void 0;if(st!==null){var o=st.memoizedState;if(i=o.destroy,r!==null&&Wf(r,o.deps)){s.memoizedState=dl(t,n,i,r);return}}Ve.flags|=e,s.memoizedState=dl(1|t,n,i,r)}function Rp(e,t){return ja(8390656,8,e,t)}function Yf(e,t){return ju(2048,8,e,t)}function py(e,t){return ju(4,2,e,t)}function my(e,t){return ju(4,4,e,t)}function gy(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function vy(e,t,n){return n=n!=null?n.concat([e]):null,ju(4,4,gy.bind(null,t,e),n)}function Xf(){}function yy(e,t){var n=Mn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Wf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function xy(e,t){var n=Mn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Wf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function wy(e,t,n){return Qs&21?($n(n,t)||(n=Ev(),Ve.lanes|=n,Ks|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Kt=!0),e.memoizedState=n)}function M1(e,t){var n=Fe;Fe=n!==0&&4>n?n:4,e(!0);var r=Sc.transition;Sc.transition={};try{e(!1),t()}finally{Fe=n,Sc.transition=r}}function Sy(){return Mn().memoizedState}function R1(e,t,n){var r=ss(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},by(e))Cy(t,n);else if(n=ry(e,t,n,r),n!==null){var s=Ot();zn(n,e,r,s),ky(n,t,r)}}function P1(e,t,n){var r=ss(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(by(e))Cy(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,$n(l,o)){var u=t.interleaved;u===null?(s.next=s,$f(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}n=ry(e,t,s,r),n!==null&&(s=Ot(),zn(n,e,r,s),ky(n,t,r))}}function by(e){var t=e.alternate;return e===Ve||t!==null&&t===Ve}function Cy(e,t){Ho=ru=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ky(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Nf(e,n)}}var su={readContext:jn,useCallback:St,useContext:St,useEffect:St,useImperativeHandle:St,useInsertionEffect:St,useLayoutEffect:St,useMemo:St,useReducer:St,useRef:St,useState:St,useDebugValue:St,useDeferredValue:St,useTransition:St,useMutableSource:St,useSyncExternalStore:St,useId:St,unstable_isNewReconciler:!1},T1={readContext:jn,useCallback:function(e,t){return Gn().memoizedState=[e,t===void 0?null:t],e},useContext:jn,useEffect:Rp,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ja(4194308,4,gy.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ja(4194308,4,e,t)},useInsertionEffect:function(e,t){return ja(4,2,e,t)},useMemo:function(e,t){var n=Gn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Gn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=R1.bind(null,Ve,e),[r.memoizedState,e]},useRef:function(e){var t=Gn();return e={current:e},t.memoizedState=e},useState:Mp,useDebugValue:Xf,useDeferredValue:function(e){return Gn().memoizedState=e},useTransition:function(){var e=Mp(!1),t=e[0];return e=M1.bind(null,e[1]),Gn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ve,s=Gn();if(Be){if(n===void 0)throw Error(W(407));n=n()}else{if(n=t(),dt===null)throw Error(W(349));Qs&30||ay(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Rp(cy.bind(null,r,i,e),[e]),r.flags|=2048,dl(9,uy.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Gn(),t=dt.identifierPrefix;if(Be){var n=Sr,r=wr;n=(r&~(1<<32-Dn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=ul++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=j1++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},L1={readContext:jn,useCallback:yy,useContext:jn,useEffect:Yf,useImperativeHandle:vy,useInsertionEffect:py,useLayoutEffect:my,useMemo:xy,useReducer:bc,useRef:hy,useState:function(){return bc(cl)},useDebugValue:Xf,useDeferredValue:function(e){var t=Mn();return wy(t,st.memoizedState,e)},useTransition:function(){var e=bc(cl)[0],t=Mn().memoizedState;return[e,t]},useMutableSource:oy,useSyncExternalStore:ly,useId:Sy,unstable_isNewReconciler:!1},_1={readContext:jn,useCallback:yy,useContext:jn,useEffect:Yf,useImperativeHandle:vy,useInsertionEffect:py,useLayoutEffect:my,useMemo:xy,useReducer:Cc,useRef:hy,useState:function(){return Cc(cl)},useDebugValue:Xf,useDeferredValue:function(e){var t=Mn();return st===null?t.memoizedState=e:wy(t,st.memoizedState,e)},useTransition:function(){var e=Cc(cl)[0],t=Mn().memoizedState;return[e,t]},useMutableSource:oy,useSyncExternalStore:ly,useId:Sy,unstable_isNewReconciler:!1};function Ln(e,t){if(e&&e.defaultProps){t=We({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function wd(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:We({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Mu={isMounted:function(e){return(e=e._reactInternals)?Js(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ot(),s=ss(e),i=br(r,s);i.payload=t,n!=null&&(i.callback=n),t=ns(e,i,s),t!==null&&(zn(t,e,s,r),Ea(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ot(),s=ss(e),i=br(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=ns(e,i,s),t!==null&&(zn(t,e,s,r),Ea(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ot(),r=ss(e),s=br(n,r);s.tag=2,t!=null&&(s.callback=t),t=ns(e,s,r),t!==null&&(zn(t,e,r,n),Ea(t,e,r))}};function Pp(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!rl(n,r)||!rl(s,i):!0}function Ey(e,t,n){var r=!1,s=us,i=t.contextType;return typeof i=="object"&&i!==null?i=jn(i):(s=Xt(t)?Vs:Et.current,r=t.contextTypes,i=(r=r!=null)?Gi(e,s):us),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Mu,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Tp(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Mu.enqueueReplaceState(t,t.state,null)}function Sd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Bf(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=jn(i):(i=Xt(t)?Vs:Et.current,s.context=Gi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(wd(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Mu.enqueueReplaceState(s,s.state,null),tu(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function to(e,t){try{var n="",r=t;do n+=lw(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function kc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function bd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var I1=typeof WeakMap=="function"?WeakMap:Map;function Ny(e,t,n){n=br(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ou||(ou=!0,Ld=r),bd(e,t)},n}function jy(e,t,n){n=br(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){bd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){bd(e,t),typeof r!="function"&&(rs===null?rs=new Set([this]):rs.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Lp(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new I1;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=Y1.bind(null,e,t,n),t.then(e,e))}function _p(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ip(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=br(-1,1),t.tag=2,ns(n,t,1))),n.lanes|=1),e)}var F1=Rr.ReactCurrentOwner,Kt=!1;function It(e,t,n,r){t.child=e===null?ny(t,null,n,r):Zi(t,e.child,n,r)}function Fp(e,t,n,r,s){n=n.render;var i=t.ref;return Li(t,s),r=Qf(e,t,n,r,i,s),n=Kf(),e!==null&&!Kt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Mr(e,t,s)):(Be&&n&&If(t),t.flags|=1,It(e,t,r,s),t.child)}function Op(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!rh(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,My(e,t,i,r,s)):(e=Ta(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:rl,n(o,r)&&e.ref===t.ref)return Mr(e,t,s)}return t.flags|=1,e=is(i,r),e.ref=t.ref,e.return=t,t.child=e}function My(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(rl(i,r)&&e.ref===t.ref)if(Kt=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Kt=!0);else return t.lanes=e.lanes,Mr(e,t,s)}return Cd(e,t,n,r,s)}function Ry(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ae(ji,on),on|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ae(ji,on),on|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ae(ji,on),on|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ae(ji,on),on|=r;return It(e,t,s,n),t.child}function Py(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Cd(e,t,n,r,s){var i=Xt(n)?Vs:Et.current;return i=Gi(t,i),Li(t,s),n=Qf(e,t,n,r,i,s),r=Kf(),e!==null&&!Kt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Mr(e,t,s)):(Be&&r&&If(t),t.flags|=1,It(e,t,n,s),t.child)}function Ap(e,t,n,r,s){if(Xt(n)){var i=!0;qa(t)}else i=!1;if(Li(t,s),t.stateNode===null)Ma(e,t),Ey(t,n,r),Sd(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=jn(d):(d=Xt(n)?Vs:Et.current,d=Gi(t,d));var f=n.getDerivedStateFromProps,h=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&Tp(t,o,r,d),Dr=!1;var p=t.memoizedState;o.state=p,tu(t,r,o,s),u=t.memoizedState,l!==r||p!==u||Yt.current||Dr?(typeof f=="function"&&(wd(t,n,f,r),u=t.memoizedState),(l=Dr||Pp(t,n,l,r,p,u,d))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,sy(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Ln(t.type,l),o.props=d,h=t.pendingProps,p=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=jn(u):(u=Xt(n)?Vs:Et.current,u=Gi(t,u));var S=n.getDerivedStateFromProps;(f=typeof S=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||p!==u)&&Tp(t,o,r,u),Dr=!1,p=t.memoizedState,o.state=p,tu(t,r,o,s);var w=t.memoizedState;l!==h||p!==w||Yt.current||Dr?(typeof S=="function"&&(wd(t,n,S,r),w=t.memoizedState),(d=Dr||Pp(t,n,d,r,p,w,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,w,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,w,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=w),o.props=r,o.state=w,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return kd(e,t,n,r,i,s)}function kd(e,t,n,r,s,i){Py(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&bp(t,n,!1),Mr(e,t,i);r=t.stateNode,F1.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Zi(t,e.child,null,i),t.child=Zi(t,null,l,i)):It(e,t,l,i),t.memoizedState=r.state,s&&bp(t,n,!0),t.child}function Ty(e){var t=e.stateNode;t.pendingContext?Sp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Sp(e,t.context,!1),Uf(e,t.containerInfo)}function Dp(e,t,n,r,s){return Ji(),Of(s),t.flags|=256,It(e,t,n,r),t.child}var Ed={dehydrated:null,treeContext:null,retryLane:0};function Nd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ly(e,t,n){var r=t.pendingProps,s=He.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Ae(He,s&1),e===null)return yd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Tu(o,r,0,null),e=Hs(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Nd(n),t.memoizedState=Ed,e):qf(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return O1(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=is(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=is(l,i):(i=Hs(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?Nd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=Ed,r}return i=e.child,e=i.sibling,r=is(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function qf(e,t){return t=Tu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function aa(e,t,n,r){return r!==null&&Of(r),Zi(t,e.child,null,n),e=qf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function O1(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=kc(Error(W(422))),aa(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Tu({mode:"visible",children:r.children},s,0,null),i=Hs(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Zi(t,e.child,null,o),t.child.memoizedState=Nd(o),t.memoizedState=Ed,i);if(!(t.mode&1))return aa(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(W(419)),r=kc(i,r,void 0),aa(e,t,o,r)}if(l=(o&e.childLanes)!==0,Kt||l){if(r=dt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,jr(e,s),zn(r,e,s,-1))}return nh(),r=kc(Error(W(421))),aa(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=X1.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,ln=ts(s.nextSibling),an=t,Be=!0,An=null,e!==null&&(bn[Cn++]=wr,bn[Cn++]=Sr,bn[Cn++]=Ws,wr=e.id,Sr=e.overflow,Ws=t),t=qf(t,r.children),t.flags|=4096,t)}function zp(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),xd(e.return,t,n)}function Ec(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function _y(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(It(e,t,r.children,n),r=He.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&zp(e,n,t);else if(e.tag===19)zp(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ae(He,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&nu(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Ec(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&nu(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Ec(t,!0,n,null,i);break;case"together":Ec(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ma(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Mr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ks|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(W(153));if(t.child!==null){for(e=t.child,n=is(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=is(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function A1(e,t,n){switch(t.tag){case 3:Ty(t),Ji();break;case 5:iy(t);break;case 1:Xt(t.type)&&qa(t);break;case 4:Uf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Ae(Za,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ae(He,He.current&1),t.flags|=128,null):n&t.child.childLanes?Ly(e,t,n):(Ae(He,He.current&1),e=Mr(e,t,n),e!==null?e.sibling:null);Ae(He,He.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return _y(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ae(He,He.current),r)break;return null;case 22:case 23:return t.lanes=0,Ry(e,t,n)}return Mr(e,t,n)}var Iy,jd,Fy,Oy;Iy=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};jd=function(){};Fy=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Ms(rr.current);var i=null;switch(n){case"input":s=Xc(e,s),r=Xc(e,r),i=[];break;case"select":s=We({},s,{value:void 0}),r=We({},r,{value:void 0}),i=[];break;case"textarea":s=Jc(e,s),r=Jc(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ya)}ed(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(qo.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(qo.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&ze("scroll",e),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Oy=function(e,t,n,r){n!==r&&(t.flags|=4)};function Co(e,t){if(!Be)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function bt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function D1(e,t,n){var r=t.pendingProps;switch(Ff(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(t),null;case 1:return Xt(t.type)&&Xa(),bt(t),null;case 3:return r=t.stateNode,eo(),$e(Yt),$e(Et),Vf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(oa(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,An!==null&&(Fd(An),An=null))),jd(e,t),bt(t),null;case 5:Hf(t);var s=Ms(al.current);if(n=t.type,e!==null&&t.stateNode!=null)Fy(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(W(166));return bt(t),null}if(e=Ms(rr.current),oa(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[tr]=t,r[ol]=i,e=(t.mode&1)!==0,n){case"dialog":ze("cancel",r),ze("close",r);break;case"iframe":case"object":case"embed":ze("load",r);break;case"video":case"audio":for(s=0;s<Fo.length;s++)ze(Fo[s],r);break;case"source":ze("error",r);break;case"img":case"image":case"link":ze("error",r),ze("load",r);break;case"details":ze("toggle",r);break;case"input":Yh(r,i),ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},ze("invalid",r);break;case"textarea":qh(r,i),ze("invalid",r)}ed(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&ia(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&ia(r.textContent,l,e),s=["children",""+l]):qo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&ze("scroll",r)}switch(n){case"input":Gl(r),Xh(r,i,!0);break;case"textarea":Gl(r),Gh(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ya)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=cv(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[tr]=t,e[ol]=r,Iy(e,t,!1,!1),t.stateNode=e;e:{switch(o=td(n,r),n){case"dialog":ze("cancel",e),ze("close",e),s=r;break;case"iframe":case"object":case"embed":ze("load",e),s=r;break;case"video":case"audio":for(s=0;s<Fo.length;s++)ze(Fo[s],e);s=r;break;case"source":ze("error",e),s=r;break;case"img":case"image":case"link":ze("error",e),ze("load",e),s=r;break;case"details":ze("toggle",e),s=r;break;case"input":Yh(e,r),s=Xc(e,r),ze("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=We({},r,{value:void 0}),ze("invalid",e);break;case"textarea":qh(e,r),s=Jc(e,r),ze("invalid",e);break;default:s=r}ed(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?hv(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&dv(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Go(e,u):typeof u=="number"&&Go(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(qo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&ze("scroll",e):u!=null&&wf(e,i,u,o))}switch(n){case"input":Gl(e),Xh(e,r,!1);break;case"textarea":Gl(e),Gh(e);break;case"option":r.value!=null&&e.setAttribute("value",""+as(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Mi(e,!!r.multiple,i,!1):r.defaultValue!=null&&Mi(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Ya)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return bt(t),null;case 6:if(e&&t.stateNode!=null)Oy(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(W(166));if(n=Ms(al.current),Ms(rr.current),oa(t)){if(r=t.stateNode,n=t.memoizedProps,r[tr]=t,(i=r.nodeValue!==n)&&(e=an,e!==null))switch(e.tag){case 3:ia(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ia(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[tr]=t,t.stateNode=r}return bt(t),null;case 13:if($e(He),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Be&&ln!==null&&t.mode&1&&!(t.flags&128))ey(),Ji(),t.flags|=98560,i=!1;else if(i=oa(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(W(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[tr]=t}else Ji(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;bt(t),i=!1}else An!==null&&(Fd(An),An=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||He.current&1?ot===0&&(ot=3):nh())),t.updateQueue!==null&&(t.flags|=4),bt(t),null);case 4:return eo(),jd(e,t),e===null&&sl(t.stateNode.containerInfo),bt(t),null;case 10:return zf(t.type._context),bt(t),null;case 17:return Xt(t.type)&&Xa(),bt(t),null;case 19:if($e(He),i=t.memoizedState,i===null)return bt(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)Co(i,!1);else{if(ot!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=nu(e),o!==null){for(t.flags|=128,Co(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ae(He,He.current&1|2),t.child}e=e.sibling}i.tail!==null&&Ge()>no&&(t.flags|=128,r=!0,Co(i,!1),t.lanes=4194304)}else{if(!r)if(e=nu(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Co(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Be)return bt(t),null}else 2*Ge()-i.renderingStartTime>no&&n!==1073741824&&(t.flags|=128,r=!0,Co(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Ge(),t.sibling=null,n=He.current,Ae(He,r?n&1|2:n&1),t):(bt(t),null);case 22:case 23:return th(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?on&1073741824&&(bt(t),t.subtreeFlags&6&&(t.flags|=8192)):bt(t),null;case 24:return null;case 25:return null}throw Error(W(156,t.tag))}function z1(e,t){switch(Ff(t),t.tag){case 1:return Xt(t.type)&&Xa(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return eo(),$e(Yt),$e(Et),Vf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Hf(t),null;case 13:if($e(He),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(W(340));Ji()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return $e(He),null;case 4:return eo(),null;case 10:return zf(t.type._context),null;case 22:case 23:return th(),null;case 24:return null;default:return null}}var ua=!1,kt=!1,$1=typeof WeakSet=="function"?WeakSet:Set,ae=null;function Ni(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Xe(e,t,r)}else n.current=null}function Md(e,t,n){try{n()}catch(r){Xe(e,t,r)}}var $p=!1;function B1(e,t){if(dd=Wa,e=Bv(),_f(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,f=0,h=e,p=null;t:for(;;){for(var S;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(u=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(S=h.firstChild)!==null;)p=h,h=S;for(;;){if(h===e)break t;if(p===n&&++d===s&&(l=o),p===i&&++f===r&&(u=o),(S=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=S}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(fd={focusedElem:e,selectionRange:n},Wa=!1,ae=t;ae!==null;)if(t=ae,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ae=e;else for(;ae!==null;){t=ae;try{var w=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var E=w.memoizedProps,j=w.memoizedState,v=t.stateNode,m=v.getSnapshotBeforeUpdate(t.elementType===t.type?E:Ln(t.type,E),j);v.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(y){Xe(t,t.return,y)}if(e=t.sibling,e!==null){e.return=t.return,ae=e;break}ae=t.return}return w=$p,$p=!1,w}function Vo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&Md(t,n,i)}s=s.next}while(s!==r)}}function Ru(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Rd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Ay(e){var t=e.alternate;t!==null&&(e.alternate=null,Ay(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[tr],delete t[ol],delete t[md],delete t[C1],delete t[k1])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Dy(e){return e.tag===5||e.tag===3||e.tag===4}function Bp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Dy(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Pd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ya));else if(r!==4&&(e=e.child,e!==null))for(Pd(e,t,n),e=e.sibling;e!==null;)Pd(e,t,n),e=e.sibling}function Td(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Td(e,t,n),e=e.sibling;e!==null;)Td(e,t,n),e=e.sibling}var ht=null,On=!1;function Ir(e,t,n){for(n=n.child;n!==null;)zy(e,t,n),n=n.sibling}function zy(e,t,n){if(nr&&typeof nr.onCommitFiberUnmount=="function")try{nr.onCommitFiberUnmount(Su,n)}catch{}switch(n.tag){case 5:kt||Ni(n,t);case 6:var r=ht,s=On;ht=null,Ir(e,t,n),ht=r,On=s,ht!==null&&(On?(e=ht,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):ht.removeChild(n.stateNode));break;case 18:ht!==null&&(On?(e=ht,n=n.stateNode,e.nodeType===8?yc(e.parentNode,n):e.nodeType===1&&yc(e,n),tl(e)):yc(ht,n.stateNode));break;case 4:r=ht,s=On,ht=n.stateNode.containerInfo,On=!0,Ir(e,t,n),ht=r,On=s;break;case 0:case 11:case 14:case 15:if(!kt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Md(n,t,o),s=s.next}while(s!==r)}Ir(e,t,n);break;case 1:if(!kt&&(Ni(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Xe(n,t,l)}Ir(e,t,n);break;case 21:Ir(e,t,n);break;case 22:n.mode&1?(kt=(r=kt)||n.memoizedState!==null,Ir(e,t,n),kt=r):Ir(e,t,n);break;default:Ir(e,t,n)}}function Up(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new $1),t.forEach(function(r){var s=q1.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Pn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:ht=l.stateNode,On=!1;break e;case 3:ht=l.stateNode.containerInfo,On=!0;break e;case 4:ht=l.stateNode.containerInfo,On=!0;break e}l=l.return}if(ht===null)throw Error(W(160));zy(i,o,s),ht=null,On=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Xe(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)$y(t,e),t=t.sibling}function $y(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Pn(t,e),qn(e),r&4){try{Vo(3,e,e.return),Ru(3,e)}catch(E){Xe(e,e.return,E)}try{Vo(5,e,e.return)}catch(E){Xe(e,e.return,E)}}break;case 1:Pn(t,e),qn(e),r&512&&n!==null&&Ni(n,n.return);break;case 5:if(Pn(t,e),qn(e),r&512&&n!==null&&Ni(n,n.return),e.flags&32){var s=e.stateNode;try{Go(s,"")}catch(E){Xe(e,e.return,E)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&av(s,i),td(l,o);var d=td(l,i);for(o=0;o<u.length;o+=2){var f=u[o],h=u[o+1];f==="style"?hv(s,h):f==="dangerouslySetInnerHTML"?dv(s,h):f==="children"?Go(s,h):wf(s,f,h,d)}switch(l){case"input":qc(s,i);break;case"textarea":uv(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var S=i.value;S!=null?Mi(s,!!i.multiple,S,!1):p!==!!i.multiple&&(i.defaultValue!=null?Mi(s,!!i.multiple,i.defaultValue,!0):Mi(s,!!i.multiple,i.multiple?[]:"",!1))}s[ol]=i}catch(E){Xe(e,e.return,E)}}break;case 6:if(Pn(t,e),qn(e),r&4){if(e.stateNode===null)throw Error(W(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(E){Xe(e,e.return,E)}}break;case 3:if(Pn(t,e),qn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{tl(t.containerInfo)}catch(E){Xe(e,e.return,E)}break;case 4:Pn(t,e),qn(e);break;case 13:Pn(t,e),qn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Zf=Ge())),r&4&&Up(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(kt=(d=kt)||f,Pn(t,e),kt=d):Pn(t,e),qn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!f&&e.mode&1)for(ae=e,f=e.child;f!==null;){for(h=ae=f;ae!==null;){switch(p=ae,S=p.child,p.tag){case 0:case 11:case 14:case 15:Vo(4,p,p.return);break;case 1:Ni(p,p.return);var w=p.stateNode;if(typeof w.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,w.props=t.memoizedProps,w.state=t.memoizedState,w.componentWillUnmount()}catch(E){Xe(r,n,E)}}break;case 5:Ni(p,p.return);break;case 22:if(p.memoizedState!==null){Vp(h);continue}}S!==null?(S.return=p,ae=S):Vp(h)}f=f.sibling}e:for(f=null,h=e;;){if(h.tag===5){if(f===null){f=h;try{s=h.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,u=h.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=fv("display",o))}catch(E){Xe(e,e.return,E)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(E){Xe(e,e.return,E)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Pn(t,e),qn(e),r&4&&Up(e);break;case 21:break;default:Pn(t,e),qn(e)}}function qn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Dy(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Go(s,""),r.flags&=-33);var i=Bp(e);Td(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Bp(e);Pd(e,l,o);break;default:throw Error(W(161))}}catch(u){Xe(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function U1(e,t,n){ae=e,By(e)}function By(e,t,n){for(var r=(e.mode&1)!==0;ae!==null;){var s=ae,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||ua;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||kt;l=ua;var d=kt;if(ua=o,(kt=u)&&!d)for(ae=s;ae!==null;)o=ae,u=o.child,o.tag===22&&o.memoizedState!==null?Wp(s):u!==null?(u.return=o,ae=u):Wp(s);for(;i!==null;)ae=i,By(i),i=i.sibling;ae=s,ua=l,kt=d}Hp(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ae=i):Hp(e)}}function Hp(e){for(;ae!==null;){var t=ae;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:kt||Ru(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!kt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Ln(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&jp(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}jp(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&tl(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}kt||t.flags&512&&Rd(t)}catch(p){Xe(t,t.return,p)}}if(t===e){ae=null;break}if(n=t.sibling,n!==null){n.return=t.return,ae=n;break}ae=t.return}}function Vp(e){for(;ae!==null;){var t=ae;if(t===e){ae=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ae=n;break}ae=t.return}}function Wp(e){for(;ae!==null;){var t=ae;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ru(4,t)}catch(u){Xe(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(u){Xe(t,s,u)}}var i=t.return;try{Rd(t)}catch(u){Xe(t,i,u)}break;case 5:var o=t.return;try{Rd(t)}catch(u){Xe(t,o,u)}}}catch(u){Xe(t,t.return,u)}if(t===e){ae=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ae=l;break}ae=t.return}}var H1=Math.ceil,iu=Rr.ReactCurrentDispatcher,Gf=Rr.ReactCurrentOwner,Nn=Rr.ReactCurrentBatchConfig,Pe=0,dt=null,Je=null,pt=0,on=0,ji=ds(0),ot=0,fl=null,Ks=0,Pu=0,Jf=0,Wo=null,Qt=null,Zf=0,no=1/0,pr=null,ou=!1,Ld=null,rs=null,ca=!1,Gr=null,lu=0,Qo=0,_d=null,Ra=-1,Pa=0;function Ot(){return Pe&6?Ge():Ra!==-1?Ra:Ra=Ge()}function ss(e){return e.mode&1?Pe&2&&pt!==0?pt&-pt:N1.transition!==null?(Pa===0&&(Pa=Ev()),Pa):(e=Fe,e!==0||(e=window.event,e=e===void 0?16:Lv(e.type)),e):1}function zn(e,t,n,r){if(50<Qo)throw Qo=0,_d=null,Error(W(185));Cl(e,n,r),(!(Pe&2)||e!==dt)&&(e===dt&&(!(Pe&2)&&(Pu|=n),ot===4&&$r(e,pt)),qt(e,r),n===1&&Pe===0&&!(t.mode&1)&&(no=Ge()+500,Nu&&fs()))}function qt(e,t){var n=e.callbackNode;Nw(e,t);var r=Va(e,e===dt?pt:0);if(r===0)n!==null&&ep(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&ep(n),t===1)e.tag===0?E1(Qp.bind(null,e)):Gv(Qp.bind(null,e)),S1(function(){!(Pe&6)&&fs()}),n=null;else{switch(Nv(r)){case 1:n=Ef;break;case 4:n=Cv;break;case 16:n=Ha;break;case 536870912:n=kv;break;default:n=Ha}n=Xy(n,Uy.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Uy(e,t){if(Ra=-1,Pa=0,Pe&6)throw Error(W(327));var n=e.callbackNode;if(_i()&&e.callbackNode!==n)return null;var r=Va(e,e===dt?pt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=au(e,r);else{t=r;var s=Pe;Pe|=2;var i=Vy();(dt!==e||pt!==t)&&(pr=null,no=Ge()+500,Us(e,t));do try{Q1();break}catch(l){Hy(e,l)}while(!0);Df(),iu.current=i,Pe=s,Je!==null?t=0:(dt=null,pt=0,t=ot)}if(t!==0){if(t===2&&(s=od(e),s!==0&&(r=s,t=Id(e,s))),t===1)throw n=fl,Us(e,0),$r(e,r),qt(e,Ge()),n;if(t===6)$r(e,r);else{if(s=e.current.alternate,!(r&30)&&!V1(s)&&(t=au(e,r),t===2&&(i=od(e),i!==0&&(r=i,t=Id(e,i))),t===1))throw n=fl,Us(e,0),$r(e,r),qt(e,Ge()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(W(345));case 2:Es(e,Qt,pr);break;case 3:if($r(e,r),(r&130023424)===r&&(t=Zf+500-Ge(),10<t)){if(Va(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Ot(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=pd(Es.bind(null,e,Qt,pr),t);break}Es(e,Qt,pr);break;case 4:if($r(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-Dn(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=Ge()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*H1(r/1960))-r,10<r){e.timeoutHandle=pd(Es.bind(null,e,Qt,pr),r);break}Es(e,Qt,pr);break;case 5:Es(e,Qt,pr);break;default:throw Error(W(329))}}}return qt(e,Ge()),e.callbackNode===n?Uy.bind(null,e):null}function Id(e,t){var n=Wo;return e.current.memoizedState.isDehydrated&&(Us(e,t).flags|=256),e=au(e,t),e!==2&&(t=Qt,Qt=n,t!==null&&Fd(t)),e}function Fd(e){Qt===null?Qt=e:Qt.push.apply(Qt,e)}function V1(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!$n(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function $r(e,t){for(t&=~Jf,t&=~Pu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Dn(t),r=1<<n;e[n]=-1,t&=~r}}function Qp(e){if(Pe&6)throw Error(W(327));_i();var t=Va(e,0);if(!(t&1))return qt(e,Ge()),null;var n=au(e,t);if(e.tag!==0&&n===2){var r=od(e);r!==0&&(t=r,n=Id(e,r))}if(n===1)throw n=fl,Us(e,0),$r(e,t),qt(e,Ge()),n;if(n===6)throw Error(W(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Es(e,Qt,pr),qt(e,Ge()),null}function eh(e,t){var n=Pe;Pe|=1;try{return e(t)}finally{Pe=n,Pe===0&&(no=Ge()+500,Nu&&fs())}}function Ys(e){Gr!==null&&Gr.tag===0&&!(Pe&6)&&_i();var t=Pe;Pe|=1;var n=Nn.transition,r=Fe;try{if(Nn.transition=null,Fe=1,e)return e()}finally{Fe=r,Nn.transition=n,Pe=t,!(Pe&6)&&fs()}}function th(){on=ji.current,$e(ji)}function Us(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,w1(n)),Je!==null)for(n=Je.return;n!==null;){var r=n;switch(Ff(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Xa();break;case 3:eo(),$e(Yt),$e(Et),Vf();break;case 5:Hf(r);break;case 4:eo();break;case 13:$e(He);break;case 19:$e(He);break;case 10:zf(r.type._context);break;case 22:case 23:th()}n=n.return}if(dt=e,Je=e=is(e.current,null),pt=on=t,ot=0,fl=null,Jf=Pu=Ks=0,Qt=Wo=null,js!==null){for(t=0;t<js.length;t++)if(n=js[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}js=null}return e}function Hy(e,t){do{var n=Je;try{if(Df(),Na.current=su,ru){for(var r=Ve.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}ru=!1}if(Qs=0,ct=st=Ve=null,Ho=!1,ul=0,Gf.current=null,n===null||n.return===null){ot=1,fl=t,Je=null;break}e:{var i=e,o=n.return,l=n,u=t;if(t=pt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=l,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var S=_p(o);if(S!==null){S.flags&=-257,Ip(S,o,l,i,t),S.mode&1&&Lp(i,d,t),t=S,u=d;var w=t.updateQueue;if(w===null){var E=new Set;E.add(u),t.updateQueue=E}else w.add(u);break e}else{if(!(t&1)){Lp(i,d,t),nh();break e}u=Error(W(426))}}else if(Be&&l.mode&1){var j=_p(o);if(j!==null){!(j.flags&65536)&&(j.flags|=256),Ip(j,o,l,i,t),Of(to(u,l));break e}}i=u=to(u,l),ot!==4&&(ot=2),Wo===null?Wo=[i]:Wo.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=Ny(i,u,t);Np(i,v);break e;case 1:l=u;var m=i.type,x=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(rs===null||!rs.has(x)))){i.flags|=65536,t&=-t,i.lanes|=t;var y=jy(i,l,t);Np(i,y);break e}}i=i.return}while(i!==null)}Qy(n)}catch(k){t=k,Je===n&&n!==null&&(Je=n=n.return);continue}break}while(!0)}function Vy(){var e=iu.current;return iu.current=su,e===null?su:e}function nh(){(ot===0||ot===3||ot===2)&&(ot=4),dt===null||!(Ks&268435455)&&!(Pu&268435455)||$r(dt,pt)}function au(e,t){var n=Pe;Pe|=2;var r=Vy();(dt!==e||pt!==t)&&(pr=null,Us(e,t));do try{W1();break}catch(s){Hy(e,s)}while(!0);if(Df(),Pe=n,iu.current=r,Je!==null)throw Error(W(261));return dt=null,pt=0,ot}function W1(){for(;Je!==null;)Wy(Je)}function Q1(){for(;Je!==null&&!vw();)Wy(Je)}function Wy(e){var t=Yy(e.alternate,e,on);e.memoizedProps=e.pendingProps,t===null?Qy(e):Je=t,Gf.current=null}function Qy(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=z1(n,t),n!==null){n.flags&=32767,Je=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ot=6,Je=null;return}}else if(n=D1(n,t,on),n!==null){Je=n;return}if(t=t.sibling,t!==null){Je=t;return}Je=t=e}while(t!==null);ot===0&&(ot=5)}function Es(e,t,n){var r=Fe,s=Nn.transition;try{Nn.transition=null,Fe=1,K1(e,t,n,r)}finally{Nn.transition=s,Fe=r}return null}function K1(e,t,n,r){do _i();while(Gr!==null);if(Pe&6)throw Error(W(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(W(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(jw(e,i),e===dt&&(Je=dt=null,pt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ca||(ca=!0,Xy(Ha,function(){return _i(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Nn.transition,Nn.transition=null;var o=Fe;Fe=1;var l=Pe;Pe|=4,Gf.current=null,B1(e,n),$y(n,e),h1(fd),Wa=!!dd,fd=dd=null,e.current=n,U1(n),yw(),Pe=l,Fe=o,Nn.transition=i}else e.current=n;if(ca&&(ca=!1,Gr=e,lu=s),i=e.pendingLanes,i===0&&(rs=null),Sw(n.stateNode),qt(e,Ge()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ou)throw ou=!1,e=Ld,Ld=null,e;return lu&1&&e.tag!==0&&_i(),i=e.pendingLanes,i&1?e===_d?Qo++:(Qo=0,_d=e):Qo=0,fs(),null}function _i(){if(Gr!==null){var e=Nv(lu),t=Nn.transition,n=Fe;try{if(Nn.transition=null,Fe=16>e?16:e,Gr===null)var r=!1;else{if(e=Gr,Gr=null,lu=0,Pe&6)throw Error(W(331));var s=Pe;for(Pe|=4,ae=e.current;ae!==null;){var i=ae,o=i.child;if(ae.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(ae=d;ae!==null;){var f=ae;switch(f.tag){case 0:case 11:case 15:Vo(8,f,i)}var h=f.child;if(h!==null)h.return=f,ae=h;else for(;ae!==null;){f=ae;var p=f.sibling,S=f.return;if(Ay(f),f===d){ae=null;break}if(p!==null){p.return=S,ae=p;break}ae=S}}}var w=i.alternate;if(w!==null){var E=w.child;if(E!==null){w.child=null;do{var j=E.sibling;E.sibling=null,E=j}while(E!==null)}}ae=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ae=o;else e:for(;ae!==null;){if(i=ae,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Vo(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,ae=v;break e}ae=i.return}}var m=e.current;for(ae=m;ae!==null;){o=ae;var x=o.child;if(o.subtreeFlags&2064&&x!==null)x.return=o,ae=x;else e:for(o=m;ae!==null;){if(l=ae,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ru(9,l)}}catch(k){Xe(l,l.return,k)}if(l===o){ae=null;break e}var y=l.sibling;if(y!==null){y.return=l.return,ae=y;break e}ae=l.return}}if(Pe=s,fs(),nr&&typeof nr.onPostCommitFiberRoot=="function")try{nr.onPostCommitFiberRoot(Su,e)}catch{}r=!0}return r}finally{Fe=n,Nn.transition=t}}return!1}function Kp(e,t,n){t=to(n,t),t=Ny(e,t,1),e=ns(e,t,1),t=Ot(),e!==null&&(Cl(e,1,t),qt(e,t))}function Xe(e,t,n){if(e.tag===3)Kp(e,e,n);else for(;t!==null;){if(t.tag===3){Kp(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(rs===null||!rs.has(r))){e=to(n,e),e=jy(t,e,1),t=ns(t,e,1),e=Ot(),t!==null&&(Cl(t,1,e),qt(t,e));break}}t=t.return}}function Y1(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ot(),e.pingedLanes|=e.suspendedLanes&n,dt===e&&(pt&n)===n&&(ot===4||ot===3&&(pt&130023424)===pt&&500>Ge()-Zf?Us(e,0):Jf|=n),qt(e,t)}function Ky(e,t){t===0&&(e.mode&1?(t=ea,ea<<=1,!(ea&130023424)&&(ea=4194304)):t=1);var n=Ot();e=jr(e,t),e!==null&&(Cl(e,t,n),qt(e,n))}function X1(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Ky(e,n)}function q1(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(t),Ky(e,n)}var Yy;Yy=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Yt.current)Kt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Kt=!1,A1(e,t,n);Kt=!!(e.flags&131072)}else Kt=!1,Be&&t.flags&1048576&&Jv(t,Ja,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ma(e,t),e=t.pendingProps;var s=Gi(t,Et.current);Li(t,n),s=Qf(null,t,r,e,s,n);var i=Kf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Xt(r)?(i=!0,qa(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Bf(t),s.updater=Mu,t.stateNode=s,s._reactInternals=t,Sd(t,r,e,n),t=kd(null,t,r,!0,i,n)):(t.tag=0,Be&&i&&If(t),It(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ma(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=J1(r),e=Ln(r,e),s){case 0:t=Cd(null,t,r,e,n);break e;case 1:t=Ap(null,t,r,e,n);break e;case 11:t=Fp(null,t,r,e,n);break e;case 14:t=Op(null,t,r,Ln(r.type,e),n);break e}throw Error(W(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ln(r,s),Cd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ln(r,s),Ap(e,t,r,s,n);case 3:e:{if(Ty(t),e===null)throw Error(W(387));r=t.pendingProps,i=t.memoizedState,s=i.element,sy(e,t),tu(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=to(Error(W(423)),t),t=Dp(e,t,r,n,s);break e}else if(r!==s){s=to(Error(W(424)),t),t=Dp(e,t,r,n,s);break e}else for(ln=ts(t.stateNode.containerInfo.firstChild),an=t,Be=!0,An=null,n=ny(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ji(),r===s){t=Mr(e,t,n);break e}It(e,t,r,n)}t=t.child}return t;case 5:return iy(t),e===null&&yd(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,hd(r,s)?o=null:i!==null&&hd(r,i)&&(t.flags|=32),Py(e,t),It(e,t,o,n),t.child;case 6:return e===null&&yd(t),null;case 13:return Ly(e,t,n);case 4:return Uf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Zi(t,null,r,n):It(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ln(r,s),Fp(e,t,r,s,n);case 7:return It(e,t,t.pendingProps,n),t.child;case 8:return It(e,t,t.pendingProps.children,n),t.child;case 12:return It(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Ae(Za,r._currentValue),r._currentValue=o,i!==null)if($n(i.value,o)){if(i.children===s.children&&!Yt.current){t=Mr(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=br(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),xd(i.return,n,t),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),xd(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}It(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Li(t,n),s=jn(s),r=r(s),t.flags|=1,It(e,t,r,n),t.child;case 14:return r=t.type,s=Ln(r,t.pendingProps),s=Ln(r.type,s),Op(e,t,r,s,n);case 15:return My(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ln(r,s),Ma(e,t),t.tag=1,Xt(r)?(e=!0,qa(t)):e=!1,Li(t,n),Ey(t,r,s),Sd(t,r,s,n),kd(null,t,r,!0,e,n);case 19:return _y(e,t,n);case 22:return Ry(e,t,n)}throw Error(W(156,t.tag))};function Xy(e,t){return bv(e,t)}function G1(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function En(e,t,n,r){return new G1(e,t,n,r)}function rh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function J1(e){if(typeof e=="function")return rh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===bf)return 11;if(e===Cf)return 14}return 2}function is(e,t){var n=e.alternate;return n===null?(n=En(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ta(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")rh(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case vi:return Hs(n.children,s,i,t);case Sf:o=8,s|=8;break;case Wc:return e=En(12,n,t,s|2),e.elementType=Wc,e.lanes=i,e;case Qc:return e=En(13,n,t,s),e.elementType=Qc,e.lanes=i,e;case Kc:return e=En(19,n,t,s),e.elementType=Kc,e.lanes=i,e;case iv:return Tu(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case rv:o=10;break e;case sv:o=9;break e;case bf:o=11;break e;case Cf:o=14;break e;case Ar:o=16,r=null;break e}throw Error(W(130,e==null?e:typeof e,""))}return t=En(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function Hs(e,t,n,r){return e=En(7,e,r,t),e.lanes=n,e}function Tu(e,t,n,r){return e=En(22,e,r,t),e.elementType=iv,e.lanes=n,e.stateNode={isHidden:!1},e}function Nc(e,t,n){return e=En(6,e,null,t),e.lanes=n,e}function jc(e,t,n){return t=En(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Z1(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=lc(0),this.expirationTimes=lc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=lc(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function sh(e,t,n,r,s,i,o,l,u){return e=new Z1(e,t,n,l,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=En(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bf(i),e}function eS(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gi,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function qy(e){if(!e)return us;e=e._reactInternals;e:{if(Js(e)!==e||e.tag!==1)throw Error(W(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Xt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(W(171))}if(e.tag===1){var n=e.type;if(Xt(n))return qv(e,n,t)}return t}function Gy(e,t,n,r,s,i,o,l,u){return e=sh(n,r,!0,e,s,i,o,l,u),e.context=qy(null),n=e.current,r=Ot(),s=ss(n),i=br(r,s),i.callback=t??null,ns(n,i,s),e.current.lanes=s,Cl(e,s,r),qt(e,r),e}function Lu(e,t,n,r){var s=t.current,i=Ot(),o=ss(s);return n=qy(n),t.context===null?t.context=n:t.pendingContext=n,t=br(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=ns(s,t,o),e!==null&&(zn(e,s,o,i),Ea(e,s,o)),o}function uu(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Yp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function ih(e,t){Yp(e,t),(e=e.alternate)&&Yp(e,t)}function tS(){return null}var Jy=typeof reportError=="function"?reportError:function(e){console.error(e)};function oh(e){this._internalRoot=e}_u.prototype.render=oh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(W(409));Lu(e,t,null,null)};_u.prototype.unmount=oh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ys(function(){Lu(null,e,null,null)}),t[Nr]=null}};function _u(e){this._internalRoot=e}_u.prototype.unstable_scheduleHydration=function(e){if(e){var t=Rv();e={blockedOn:null,target:e,priority:t};for(var n=0;n<zr.length&&t!==0&&t<zr[n].priority;n++);zr.splice(n,0,e),n===0&&Tv(e)}};function lh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Iu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Xp(){}function nS(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=uu(o);i.call(d)}}var o=Gy(t,r,e,0,null,!1,!1,"",Xp);return e._reactRootContainer=o,e[Nr]=o.current,sl(e.nodeType===8?e.parentNode:e),Ys(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=uu(u);l.call(d)}}var u=sh(e,0,!1,null,null,!1,!1,"",Xp);return e._reactRootContainer=u,e[Nr]=u.current,sl(e.nodeType===8?e.parentNode:e),Ys(function(){Lu(t,u,n,r)}),u}function Fu(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=uu(o);l.call(u)}}Lu(t,o,e,s)}else o=nS(n,t,e,s,r);return uu(o)}jv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Io(t.pendingLanes);n!==0&&(Nf(t,n|1),qt(t,Ge()),!(Pe&6)&&(no=Ge()+500,fs()))}break;case 13:Ys(function(){var r=jr(e,1);if(r!==null){var s=Ot();zn(r,e,1,s)}}),ih(e,1)}};jf=function(e){if(e.tag===13){var t=jr(e,134217728);if(t!==null){var n=Ot();zn(t,e,134217728,n)}ih(e,134217728)}};Mv=function(e){if(e.tag===13){var t=ss(e),n=jr(e,t);if(n!==null){var r=Ot();zn(n,e,t,r)}ih(e,t)}};Rv=function(){return Fe};Pv=function(e,t){var n=Fe;try{return Fe=e,t()}finally{Fe=n}};rd=function(e,t,n){switch(t){case"input":if(qc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Eu(r);if(!s)throw Error(W(90));lv(r),qc(r,s)}}}break;case"textarea":uv(e,n);break;case"select":t=n.value,t!=null&&Mi(e,!!n.multiple,t,!1)}};gv=eh;vv=Ys;var rS={usingClientEntryPoint:!1,Events:[El,Si,Eu,pv,mv,eh]},ko={findFiberByHostInstance:Ns,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sS={bundleType:ko.bundleType,version:ko.version,rendererPackageName:ko.rendererPackageName,rendererConfig:ko.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Rr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=wv(e),e===null?null:e.stateNode},findFiberByHostInstance:ko.findFiberByHostInstance||tS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var da=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!da.isDisabled&&da.supportsFiber)try{Su=da.inject(sS),nr=da}catch{}}dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rS;dn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lh(t))throw Error(W(200));return eS(e,t,null,n)};dn.createRoot=function(e,t){if(!lh(e))throw Error(W(299));var n=!1,r="",s=Jy;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=sh(e,1,!1,null,null,n,!1,r,s),e[Nr]=t.current,sl(e.nodeType===8?e.parentNode:e),new oh(t)};dn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(W(188)):(e=Object.keys(e).join(","),Error(W(268,e)));return e=wv(t),e=e===null?null:e.stateNode,e};dn.flushSync=function(e){return Ys(e)};dn.hydrate=function(e,t,n){if(!Iu(t))throw Error(W(200));return Fu(null,e,t,!0,n)};dn.hydrateRoot=function(e,t,n){if(!lh(e))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Jy;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Gy(t,null,e,1,n??null,s,!1,i,o),e[Nr]=t.current,sl(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new _u(t)};dn.render=function(e,t,n){if(!Iu(t))throw Error(W(200));return Fu(null,e,t,!1,n)};dn.unmountComponentAtNode=function(e){if(!Iu(e))throw Error(W(40));return e._reactRootContainer?(Ys(function(){Fu(null,null,e,!1,function(){e._reactRootContainer=null,e[Nr]=null})}),!0):!1};dn.unstable_batchedUpdates=eh;dn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Iu(n))throw Error(W(200));if(e==null||e._reactInternals===void 0)throw Error(W(38));return Fu(e,t,n,!1,r)};dn.version="18.3.1-next-f1338f8080-20240426";function Zy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Zy)}catch(e){console.error(e)}}Zy(),Zg.exports=dn;var Ou=Zg.exports,ex,qp=Ou;ex=qp.createRoot,qp.hydrateRoot;var lo=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},iS={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Br,hf,Tg,oS=(Tg=class{constructor(){he(this,Br,iS);he(this,hf,!1)}setTimeoutProvider(e){re(this,Br,e)}setTimeout(e,t){return b(this,Br).setTimeout(e,t)}clearTimeout(e){b(this,Br).clearTimeout(e)}setInterval(e,t){return b(this,Br).setInterval(e,t)}clearInterval(e){b(this,Br).clearInterval(e)}},Br=new WeakMap,hf=new WeakMap,Tg),Rs=new oS;function lS(e){setTimeout(e,0)}var Xs=typeof window>"u"||"Deno"in globalThis;function Ft(){}function aS(e,t){return typeof e=="function"?e(t):e}function Od(e){return typeof e=="number"&&e>=0&&e!==1/0}function tx(e,t){return Math.max(e+(t||0)-Date.now(),0)}function os(e,t){return typeof e=="function"?e(t):e}function Sn(e,t){return typeof e=="function"?e(t):e}function Gp(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(r){if(t.queryHash!==ah(o,t.options))return!1}else if(!hl(t.queryKey,o))return!1}if(n!=="all"){const u=t.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function Jp(e,t){const{exact:n,status:r,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(qs(t.options.mutationKey)!==qs(i))return!1}else if(!hl(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function ah(e,t){return((t==null?void 0:t.queryKeyHashFn)||qs)(e)}function qs(e){return JSON.stringify(e,(t,n)=>Ad(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function hl(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>hl(e[n],t[n])):!1}var uS=Object.prototype.hasOwnProperty;function nx(e,t){if(e===t)return e;const n=Zp(e)&&Zp(t);if(!n&&!(Ad(e)&&Ad(t)))return t;const s=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),o=i.length,l=n?new Array(o):{};let u=0;for(let d=0;d<o;d++){const f=n?d:i[d],h=e[f],p=t[f];if(h===p){l[f]=h,(n?d<s:uS.call(e,f))&&u++;continue}if(h===null||p===null||typeof h!="object"||typeof p!="object"){l[f]=p;continue}const S=nx(h,p);l[f]=S,S===h&&u++}return s===o&&u===s?e:l}function cu(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function Zp(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Ad(e){if(!em(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!em(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function em(e){return Object.prototype.toString.call(e)==="[object Object]"}function cS(e){return new Promise(t=>{Rs.setTimeout(t,e)})}function Dd(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?nx(e,t):t}function dS(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function fS(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var uh=Symbol();function rx(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===uh?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function sx(e,t){return typeof e=="function"?e(...t):!!e}function hS(e,t,n){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=t()),r||(r=!0,s.aborted?n():s.addEventListener("abort",n,{once:!0})),s)}),e}var _s,Ur,Di,Lg,pS=(Lg=class extends lo{constructor(){super();he(this,_s);he(this,Ur);he(this,Di);re(this,Di,t=>{if(!Xs&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){b(this,Ur)||this.setEventListener(b(this,Di))}onUnsubscribe(){var t;this.hasListeners()||((t=b(this,Ur))==null||t.call(this),re(this,Ur,void 0))}setEventListener(t){var n;re(this,Di,t),(n=b(this,Ur))==null||n.call(this),re(this,Ur,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){b(this,_s)!==t&&(re(this,_s,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof b(this,_s)=="boolean"?b(this,_s):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},_s=new WeakMap,Ur=new WeakMap,Di=new WeakMap,Lg),ch=new pS;function zd(){let e,t;const n=new Promise((s,i)=>{e=s,t=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}var mS=lS;function gS(){let e=[],t=0,n=l=>{l()},r=l=>{l()},s=mS;const i=l=>{t?e.push(l):s(()=>{n(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{r(()=>{l.forEach(u=>{n(u)})})})};return{batch:l=>{let u;t++;try{u=l()}finally{t--,t||o()}return u},batchCalls:l=>(...u)=>{i(()=>{l(...u)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var it=gS(),zi,Hr,$i,_g,vS=(_g=class extends lo{constructor(){super();he(this,zi,!0);he(this,Hr);he(this,$i);re(this,$i,t=>{if(!Xs&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){b(this,Hr)||this.setEventListener(b(this,$i))}onUnsubscribe(){var t;this.hasListeners()||((t=b(this,Hr))==null||t.call(this),re(this,Hr,void 0))}setEventListener(t){var n;re(this,$i,t),(n=b(this,Hr))==null||n.call(this),re(this,Hr,t(this.setOnline.bind(this)))}setOnline(t){b(this,zi)!==t&&(re(this,zi,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return b(this,zi)}},zi=new WeakMap,Hr=new WeakMap,$i=new WeakMap,_g),du=new vS;function yS(e){return Math.min(1e3*2**e,3e4)}function ix(e){return(e??"online")==="online"?du.isOnline():!0}var $d=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function ox(e){let t=!1,n=0,r;const s=zd(),i=()=>s.status!=="pending",o=E=>{var j;if(!i()){const v=new $d(E);p(v),(j=e.onCancel)==null||j.call(e,v)}},l=()=>{t=!0},u=()=>{t=!1},d=()=>ch.isFocused()&&(e.networkMode==="always"||du.isOnline())&&e.canRun(),f=()=>ix(e.networkMode)&&e.canRun(),h=E=>{i()||(r==null||r(),s.resolve(E))},p=E=>{i()||(r==null||r(),s.reject(E))},S=()=>new Promise(E=>{var j;r=v=>{(i()||d())&&E(v)},(j=e.onPause)==null||j.call(e)}).then(()=>{var E;r=void 0,i()||(E=e.onContinue)==null||E.call(e)}),w=()=>{if(i())return;let E;const j=n===0?e.initialPromise:void 0;try{E=j??e.fn()}catch(v){E=Promise.reject(v)}Promise.resolve(E).then(h).catch(v=>{var R;if(i())return;const m=e.retry??(Xs?0:3),x=e.retryDelay??yS,y=typeof x=="function"?x(n,v):x,k=m===!0||typeof m=="number"&&n<m||typeof m=="function"&&m(n,v);if(t||!k){p(v);return}n++,(R=e.onFail)==null||R.call(e,n,v),cS(y).then(()=>d()?void 0:S()).then(()=>{t?p(v):w()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:l,continueRetry:u,canStart:f,start:()=>(f()?w():S().then(w),s)}}var Is,Ig,lx=(Ig=class{constructor(){he(this,Is)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Od(this.gcTime)&&re(this,Is,Rs.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Xs?1/0:5*60*1e3))}clearGcTimeout(){b(this,Is)&&(Rs.clearTimeout(b(this,Is)),re(this,Is,void 0))}},Is=new WeakMap,Ig),Fs,Bi,wn,Os,ut,vl,As,In,hr,Fg,xS=(Fg=class extends lx{constructor(t){super();he(this,In);he(this,Fs);he(this,Bi);he(this,wn);he(this,Os);he(this,ut);he(this,vl);he(this,As);re(this,As,!1),re(this,vl,t.defaultOptions),this.setOptions(t.options),this.observers=[],re(this,Os,t.client),re(this,wn,b(this,Os).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,re(this,Fs,nm(this.options)),this.state=t.state??b(this,Fs),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=b(this,ut))==null?void 0:t.promise}setOptions(t){if(this.options={...b(this,vl),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=nm(this.options);n.data!==void 0&&(this.setState(tm(n.data,n.dataUpdatedAt)),re(this,Fs,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&b(this,wn).remove(this)}setData(t,n){const r=Dd(this.state.data,t,this.options);return Ce(this,In,hr).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){Ce(this,In,hr).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=b(this,ut))==null?void 0:r.promise;return(s=b(this,ut))==null||s.cancel(t),n?n.then(Ft).catch(Ft):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(b(this,Fs))}isActive(){return this.observers.some(t=>Sn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===uh||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>os(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!tx(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=b(this,ut))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=b(this,ut))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),b(this,wn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(b(this,ut)&&(b(this,As)?b(this,ut).cancel({revert:!0}):b(this,ut).cancelRetry()),this.scheduleGc()),b(this,wn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ce(this,In,hr).call(this,{type:"invalidate"})}async fetch(t,n){var u,d,f,h,p,S,w,E,j,v,m,x;if(this.state.fetchStatus!=="idle"&&((u=b(this,ut))==null?void 0:u.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(b(this,ut))return b(this,ut).continueRetry(),b(this,ut).promise}if(t&&this.setOptions(t),!this.options.queryFn){const y=this.observers.find(k=>k.options.queryFn);y&&this.setOptions(y.options)}const r=new AbortController,s=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(re(this,As,!0),r.signal)})},i=()=>{const y=rx(this.options,n),R=(()=>{const M={client:b(this,Os),queryKey:this.queryKey,meta:this.meta};return s(M),M})();return re(this,As,!1),this.options.persister?this.options.persister(y,R,this):y(R)},l=(()=>{const y={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:b(this,Os),state:this.state,fetchFn:i};return s(y),y})();(d=this.options.behavior)==null||d.onFetch(l,this),re(this,Bi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&Ce(this,In,hr).call(this,{type:"fetch",meta:(h=l.fetchOptions)==null?void 0:h.meta}),re(this,ut,ox({initialPromise:n==null?void 0:n.initialPromise,fn:l.fetchFn,onCancel:y=>{y instanceof $d&&y.revert&&this.setState({...b(this,Bi),fetchStatus:"idle"}),r.abort()},onFail:(y,k)=>{Ce(this,In,hr).call(this,{type:"failed",failureCount:y,error:k})},onPause:()=>{Ce(this,In,hr).call(this,{type:"pause"})},onContinue:()=>{Ce(this,In,hr).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const y=await b(this,ut).start();if(y===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(y),(S=(p=b(this,wn).config).onSuccess)==null||S.call(p,y,this),(E=(w=b(this,wn).config).onSettled)==null||E.call(w,y,this.state.error,this),y}catch(y){if(y instanceof $d){if(y.silent)return b(this,ut).promise;if(y.revert){if(this.state.data===void 0)throw y;return this.state.data}}throw Ce(this,In,hr).call(this,{type:"error",error:y}),(v=(j=b(this,wn).config).onError)==null||v.call(j,y,this),(x=(m=b(this,wn).config).onSettled)==null||x.call(m,this.state.data,y,this),y}finally{this.scheduleGc()}}},Fs=new WeakMap,Bi=new WeakMap,wn=new WeakMap,Os=new WeakMap,ut=new WeakMap,vl=new WeakMap,As=new WeakMap,In=new WeakSet,hr=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...ax(r.data,this.options),fetchMeta:t.meta??null};case"success":const s={...r,...tm(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return re(this,Bi,t.manual?s:void 0),s;case"error":const i=t.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),it.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),b(this,wn).notify({query:this,type:"updated",action:t})})},Fg);function ax(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ix(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function tm(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function nm(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Vt,Re,yl,Lt,Ds,Ui,gr,Vr,xl,Hi,Vi,zs,$s,Wr,Wi,_e,Oo,Bd,Ud,Hd,Vd,Wd,Qd,Kd,ux,Og,wS=(Og=class extends lo{constructor(t,n){super();he(this,_e);he(this,Vt);he(this,Re);he(this,yl);he(this,Lt);he(this,Ds);he(this,Ui);he(this,gr);he(this,Vr);he(this,xl);he(this,Hi);he(this,Vi);he(this,zs);he(this,$s);he(this,Wr);he(this,Wi,new Set);this.options=n,re(this,Vt,t),re(this,Vr,null),re(this,gr,zd()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(b(this,Re).addObserver(this),rm(b(this,Re),this.options)?Ce(this,_e,Oo).call(this):this.updateResult(),Ce(this,_e,Vd).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Yd(b(this,Re),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Yd(b(this,Re),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Ce(this,_e,Wd).call(this),Ce(this,_e,Qd).call(this),b(this,Re).removeObserver(this)}setOptions(t){const n=this.options,r=b(this,Re);if(this.options=b(this,Vt).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Sn(this.options.enabled,b(this,Re))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Ce(this,_e,Kd).call(this),b(this,Re).setOptions(this.options),n._defaulted&&!cu(this.options,n)&&b(this,Vt).getQueryCache().notify({type:"observerOptionsUpdated",query:b(this,Re),observer:this});const s=this.hasListeners();s&&sm(b(this,Re),r,this.options,n)&&Ce(this,_e,Oo).call(this),this.updateResult(),s&&(b(this,Re)!==r||Sn(this.options.enabled,b(this,Re))!==Sn(n.enabled,b(this,Re))||os(this.options.staleTime,b(this,Re))!==os(n.staleTime,b(this,Re)))&&Ce(this,_e,Bd).call(this);const i=Ce(this,_e,Ud).call(this);s&&(b(this,Re)!==r||Sn(this.options.enabled,b(this,Re))!==Sn(n.enabled,b(this,Re))||i!==b(this,Wr))&&Ce(this,_e,Hd).call(this,i)}getOptimisticResult(t){const n=b(this,Vt).getQueryCache().build(b(this,Vt),t),r=this.createResult(n,t);return bS(this,r)&&(re(this,Lt,r),re(this,Ui,this.options),re(this,Ds,b(this,Re).state)),r}getCurrentResult(){return b(this,Lt)}trackResult(t,n){return new Proxy(t,{get:(r,s)=>(this.trackProp(s),n==null||n(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&b(this,gr).status==="pending"&&b(this,gr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(t){b(this,Wi).add(t)}getCurrentQuery(){return b(this,Re)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=b(this,Vt).defaultQueryOptions(t),r=b(this,Vt).getQueryCache().build(b(this,Vt),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return Ce(this,_e,Oo).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),b(this,Lt)))}createResult(t,n){var O;const r=b(this,Re),s=this.options,i=b(this,Lt),o=b(this,Ds),l=b(this,Ui),d=t!==r?t.state:b(this,yl),{state:f}=t;let h={...f},p=!1,S;if(n._optimisticResults){const T=this.hasListeners(),X=!T&&rm(t,n),J=T&&sm(t,r,n,s);(X||J)&&(h={...h,...ax(f.data,t.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:w,errorUpdatedAt:E,status:j}=h;S=h.data;let v=!1;if(n.placeholderData!==void 0&&S===void 0&&j==="pending"){let T;i!=null&&i.isPlaceholderData&&n.placeholderData===(l==null?void 0:l.placeholderData)?(T=i.data,v=!0):T=typeof n.placeholderData=="function"?n.placeholderData((O=b(this,Vi))==null?void 0:O.state.data,b(this,Vi)):n.placeholderData,T!==void 0&&(j="success",S=Dd(i==null?void 0:i.data,T,n),p=!0)}if(n.select&&S!==void 0&&!v)if(i&&S===(o==null?void 0:o.data)&&n.select===b(this,xl))S=b(this,Hi);else try{re(this,xl,n.select),S=n.select(S),S=Dd(i==null?void 0:i.data,S,n),re(this,Hi,S),re(this,Vr,null)}catch(T){re(this,Vr,T)}b(this,Vr)&&(w=b(this,Vr),S=b(this,Hi),E=Date.now(),j="error");const m=h.fetchStatus==="fetching",x=j==="pending",y=j==="error",k=x&&m,R=S!==void 0,N={status:j,fetchStatus:h.fetchStatus,isPending:x,isSuccess:j==="success",isError:y,isInitialLoading:k,isLoading:k,data:S,dataUpdatedAt:h.dataUpdatedAt,error:w,errorUpdatedAt:E,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>d.dataUpdateCount||h.errorUpdateCount>d.errorUpdateCount,isFetching:m,isRefetching:m&&!x,isLoadingError:y&&!R,isPaused:h.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:y&&R,isStale:dh(t,n),refetch:this.refetch,promise:b(this,gr),isEnabled:Sn(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const T=z=>{N.status==="error"?z.reject(N.error):N.data!==void 0&&z.resolve(N.data)},X=()=>{const z=re(this,gr,N.promise=zd());T(z)},J=b(this,gr);switch(J.status){case"pending":t.queryHash===r.queryHash&&T(J);break;case"fulfilled":(N.status==="error"||N.data!==J.value)&&X();break;case"rejected":(N.status!=="error"||N.error!==J.reason)&&X();break}}return N}updateResult(){const t=b(this,Lt),n=this.createResult(b(this,Re),this.options);if(re(this,Ds,b(this,Re).state),re(this,Ui,this.options),b(this,Ds).data!==void 0&&re(this,Vi,b(this,Re)),cu(n,t))return;re(this,Lt,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!b(this,Wi).size)return!0;const o=new Set(i??b(this,Wi));return this.options.throwOnError&&o.add("error"),Object.keys(b(this,Lt)).some(l=>{const u=l;return b(this,Lt)[u]!==t[u]&&o.has(u)})};Ce(this,_e,ux).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Ce(this,_e,Vd).call(this)}},Vt=new WeakMap,Re=new WeakMap,yl=new WeakMap,Lt=new WeakMap,Ds=new WeakMap,Ui=new WeakMap,gr=new WeakMap,Vr=new WeakMap,xl=new WeakMap,Hi=new WeakMap,Vi=new WeakMap,zs=new WeakMap,$s=new WeakMap,Wr=new WeakMap,Wi=new WeakMap,_e=new WeakSet,Oo=function(t){Ce(this,_e,Kd).call(this);let n=b(this,Re).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Ft)),n},Bd=function(){Ce(this,_e,Wd).call(this);const t=os(this.options.staleTime,b(this,Re));if(Xs||b(this,Lt).isStale||!Od(t))return;const r=tx(b(this,Lt).dataUpdatedAt,t)+1;re(this,zs,Rs.setTimeout(()=>{b(this,Lt).isStale||this.updateResult()},r))},Ud=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(b(this,Re)):this.options.refetchInterval)??!1},Hd=function(t){Ce(this,_e,Qd).call(this),re(this,Wr,t),!(Xs||Sn(this.options.enabled,b(this,Re))===!1||!Od(b(this,Wr))||b(this,Wr)===0)&&re(this,$s,Rs.setInterval(()=>{(this.options.refetchIntervalInBackground||ch.isFocused())&&Ce(this,_e,Oo).call(this)},b(this,Wr)))},Vd=function(){Ce(this,_e,Bd).call(this),Ce(this,_e,Hd).call(this,Ce(this,_e,Ud).call(this))},Wd=function(){b(this,zs)&&(Rs.clearTimeout(b(this,zs)),re(this,zs,void 0))},Qd=function(){b(this,$s)&&(Rs.clearInterval(b(this,$s)),re(this,$s,void 0))},Kd=function(){const t=b(this,Vt).getQueryCache().build(b(this,Vt),this.options);if(t===b(this,Re))return;const n=b(this,Re);re(this,Re,t),re(this,yl,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},ux=function(t){it.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(b(this,Lt))}),b(this,Vt).getQueryCache().notify({query:b(this,Re),type:"observerResultsUpdated"})})},Og);function SS(e,t){return Sn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function rm(e,t){return SS(e,t)||e.state.data!==void 0&&Yd(e,t,t.refetchOnMount)}function Yd(e,t,n){if(Sn(t.enabled,e)!==!1&&os(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&dh(e,t)}return!1}function sm(e,t,n,r){return(e!==t||Sn(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&dh(e,n)}function dh(e,t){return Sn(t.enabled,e)!==!1&&e.isStaleByTime(os(t.staleTime,e))}function bS(e,t){return!cu(e.getCurrentResult(),t)}function im(e){return{onFetch:(t,n)=>{var f,h,p,S,w;const r=t.options,s=(p=(h=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:h.fetchMore)==null?void 0:p.direction,i=((S=t.state.data)==null?void 0:S.pages)||[],o=((w=t.state.data)==null?void 0:w.pageParams)||[];let l={pages:[],pageParams:[]},u=0;const d=async()=>{let E=!1;const j=x=>{hS(x,()=>t.signal,()=>E=!0)},v=rx(t.options,t.fetchOptions),m=async(x,y,k)=>{if(E)return Promise.reject();if(y==null&&x.pages.length)return Promise.resolve(x);const M=(()=>{const X={client:t.client,queryKey:t.queryKey,pageParam:y,direction:k?"backward":"forward",meta:t.options.meta};return j(X),X})(),N=await v(M),{maxPages:O}=t.options,T=k?fS:dS;return{pages:T(x.pages,N,O),pageParams:T(x.pageParams,y,O)}};if(s&&i.length){const x=s==="backward",y=x?CS:om,k={pages:i,pageParams:o},R=y(r,k);l=await m(k,R,x)}else{const x=e??i.length;do{const y=u===0?o[0]??r.initialPageParam:om(r,l);if(u>0&&y==null)break;l=await m(l,y),u++}while(u<x)}return l};t.options.persister?t.fetchFn=()=>{var E,j;return(j=(E=t.options).persister)==null?void 0:j.call(E,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=d}}}function om(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function CS(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var wl,Jn,_t,Bs,Zn,Or,Ag,kS=(Ag=class extends lx{constructor(t){super();he(this,Zn);he(this,wl);he(this,Jn);he(this,_t);he(this,Bs);re(this,wl,t.client),this.mutationId=t.mutationId,re(this,_t,t.mutationCache),re(this,Jn,[]),this.state=t.state||cx(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){b(this,Jn).includes(t)||(b(this,Jn).push(t),this.clearGcTimeout(),b(this,_t).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){re(this,Jn,b(this,Jn).filter(n=>n!==t)),this.scheduleGc(),b(this,_t).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){b(this,Jn).length||(this.state.status==="pending"?this.scheduleGc():b(this,_t).remove(this))}continue(){var t;return((t=b(this,Bs))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,u,d,f,h,p,S,w,E,j,v,m,x,y,k,R,M,N,O;const n=()=>{Ce(this,Zn,Or).call(this,{type:"continue"})},r={client:b(this,wl),meta:this.options.meta,mutationKey:this.options.mutationKey};re(this,Bs,ox({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(T,X)=>{Ce(this,Zn,Or).call(this,{type:"failed",failureCount:T,error:X})},onPause:()=>{Ce(this,Zn,Or).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>b(this,_t).canRun(this)}));const s=this.state.status==="pending",i=!b(this,Bs).canStart();try{if(s)n();else{Ce(this,Zn,Or).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(o=b(this,_t).config).onMutate)==null?void 0:l.call(o,t,this,r));const X=await((d=(u=this.options).onMutate)==null?void 0:d.call(u,t,r));X!==this.state.context&&Ce(this,Zn,Or).call(this,{type:"pending",context:X,variables:t,isPaused:i})}const T=await b(this,Bs).start();return await((h=(f=b(this,_t).config).onSuccess)==null?void 0:h.call(f,T,t,this.state.context,this,r)),await((S=(p=this.options).onSuccess)==null?void 0:S.call(p,T,t,this.state.context,r)),await((E=(w=b(this,_t).config).onSettled)==null?void 0:E.call(w,T,null,this.state.variables,this.state.context,this,r)),await((v=(j=this.options).onSettled)==null?void 0:v.call(j,T,null,t,this.state.context,r)),Ce(this,Zn,Or).call(this,{type:"success",data:T}),T}catch(T){try{await((x=(m=b(this,_t).config).onError)==null?void 0:x.call(m,T,t,this.state.context,this,r))}catch(X){Promise.reject(X)}try{await((k=(y=this.options).onError)==null?void 0:k.call(y,T,t,this.state.context,r))}catch(X){Promise.reject(X)}try{await((M=(R=b(this,_t).config).onSettled)==null?void 0:M.call(R,void 0,T,this.state.variables,this.state.context,this,r))}catch(X){Promise.reject(X)}try{await((O=(N=this.options).onSettled)==null?void 0:O.call(N,void 0,T,t,this.state.context,r))}catch(X){Promise.reject(X)}throw Ce(this,Zn,Or).call(this,{type:"error",error:T}),T}finally{b(this,_t).runNext(this)}}},wl=new WeakMap,Jn=new WeakMap,_t=new WeakMap,Bs=new WeakMap,Zn=new WeakSet,Or=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),it.batch(()=>{b(this,Jn).forEach(r=>{r.onMutationUpdate(t)}),b(this,_t).notify({mutation:this,type:"updated",action:t})})},Ag);function cx(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var vr,Fn,Sl,Dg,ES=(Dg=class extends lo{constructor(t={}){super();he(this,vr);he(this,Fn);he(this,Sl);this.config=t,re(this,vr,new Set),re(this,Fn,new Map),re(this,Sl,0)}build(t,n,r){const s=new kS({client:t,mutationCache:this,mutationId:++Yl(this,Sl)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){b(this,vr).add(t);const n=fa(t);if(typeof n=="string"){const r=b(this,Fn).get(n);r?r.push(t):b(this,Fn).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(b(this,vr).delete(t)){const n=fa(t);if(typeof n=="string"){const r=b(this,Fn).get(n);if(r)if(r.length>1){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}else r[0]===t&&b(this,Fn).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=fa(t);if(typeof n=="string"){const r=b(this,Fn).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var r;const n=fa(t);if(typeof n=="string"){const s=(r=b(this,Fn).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){it.batch(()=>{b(this,vr).forEach(t=>{this.notify({type:"removed",mutation:t})}),b(this,vr).clear(),b(this,Fn).clear()})}getAll(){return Array.from(b(this,vr))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Jp(n,r))}findAll(t={}){return this.getAll().filter(n=>Jp(t,n))}notify(t){it.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return it.batch(()=>Promise.all(t.map(n=>n.continue().catch(Ft))))}},vr=new WeakMap,Fn=new WeakMap,Sl=new WeakMap,Dg);function fa(e){var t;return(t=e.options.scope)==null?void 0:t.id}var yr,Qr,Wt,xr,kr,La,Xd,zg,NS=(zg=class extends lo{constructor(n,r){super();he(this,kr);he(this,yr);he(this,Qr);he(this,Wt);he(this,xr);re(this,yr,n),this.setOptions(r),this.bindMethods(),Ce(this,kr,La).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var s;const r=this.options;this.options=b(this,yr).defaultMutationOptions(n),cu(this.options,r)||b(this,yr).getMutationCache().notify({type:"observerOptionsUpdated",mutation:b(this,Wt),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&qs(r.mutationKey)!==qs(this.options.mutationKey)?this.reset():((s=b(this,Wt))==null?void 0:s.state.status)==="pending"&&b(this,Wt).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=b(this,Wt))==null||n.removeObserver(this)}onMutationUpdate(n){Ce(this,kr,La).call(this),Ce(this,kr,Xd).call(this,n)}getCurrentResult(){return b(this,Qr)}reset(){var n;(n=b(this,Wt))==null||n.removeObserver(this),re(this,Wt,void 0),Ce(this,kr,La).call(this),Ce(this,kr,Xd).call(this)}mutate(n,r){var s;return re(this,xr,r),(s=b(this,Wt))==null||s.removeObserver(this),re(this,Wt,b(this,yr).getMutationCache().build(b(this,yr),this.options)),b(this,Wt).addObserver(this),b(this,Wt).execute(n)}},yr=new WeakMap,Qr=new WeakMap,Wt=new WeakMap,xr=new WeakMap,kr=new WeakSet,La=function(){var r;const n=((r=b(this,Wt))==null?void 0:r.state)??cx();re(this,Qr,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Xd=function(n){it.batch(()=>{var r,s,i,o,l,u,d,f;if(b(this,xr)&&this.hasListeners()){const h=b(this,Qr).variables,p=b(this,Qr).context,S={client:b(this,yr),meta:this.options.meta,mutationKey:this.options.mutationKey};if((n==null?void 0:n.type)==="success"){try{(s=(r=b(this,xr)).onSuccess)==null||s.call(r,n.data,h,p,S)}catch(w){Promise.reject(w)}try{(o=(i=b(this,xr)).onSettled)==null||o.call(i,n.data,null,h,p,S)}catch(w){Promise.reject(w)}}else if((n==null?void 0:n.type)==="error"){try{(u=(l=b(this,xr)).onError)==null||u.call(l,n.error,h,p,S)}catch(w){Promise.reject(w)}try{(f=(d=b(this,xr)).onSettled)==null||f.call(d,void 0,n.error,h,p,S)}catch(w){Promise.reject(w)}}}this.listeners.forEach(h=>{h(b(this,Qr))})})},zg),er,$g,jS=($g=class extends lo{constructor(t={}){super();he(this,er);this.config=t,re(this,er,new Map)}build(t,n,r){const s=n.queryKey,i=n.queryHash??ah(s,n);let o=this.get(i);return o||(o=new xS({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){b(this,er).has(t.queryHash)||(b(this,er).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=b(this,er).get(t.queryHash);n&&(t.destroy(),n===t&&b(this,er).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){it.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return b(this,er).get(t)}getAll(){return[...b(this,er).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Gp(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>Gp(t,r)):n}notify(t){it.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){it.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){it.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},er=new WeakMap,$g),Ye,Kr,Yr,Qi,Ki,Xr,Yi,Xi,Bg,MS=(Bg=class{constructor(e={}){he(this,Ye);he(this,Kr);he(this,Yr);he(this,Qi);he(this,Ki);he(this,Xr);he(this,Yi);he(this,Xi);re(this,Ye,e.queryCache||new jS),re(this,Kr,e.mutationCache||new ES),re(this,Yr,e.defaultOptions||{}),re(this,Qi,new Map),re(this,Ki,new Map),re(this,Xr,0)}mount(){Yl(this,Xr)._++,b(this,Xr)===1&&(re(this,Yi,ch.subscribe(async e=>{e&&(await this.resumePausedMutations(),b(this,Ye).onFocus())})),re(this,Xi,du.subscribe(async e=>{e&&(await this.resumePausedMutations(),b(this,Ye).onOnline())})))}unmount(){var e,t;Yl(this,Xr)._--,b(this,Xr)===0&&((e=b(this,Yi))==null||e.call(this),re(this,Yi,void 0),(t=b(this,Xi))==null||t.call(this),re(this,Xi,void 0))}isFetching(e){return b(this,Ye).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return b(this,Kr).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=b(this,Ye).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=b(this,Ye).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(os(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return b(this,Ye).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=b(this,Ye).get(r.queryHash),i=s==null?void 0:s.state.data,o=aS(t,i);if(o!==void 0)return b(this,Ye).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return it.batch(()=>b(this,Ye).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=b(this,Ye).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=b(this,Ye);it.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=b(this,Ye);return it.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=it.batch(()=>b(this,Ye).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(Ft).catch(Ft)}invalidateQueries(e,t={}){return it.batch(()=>(b(this,Ye).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=it.batch(()=>b(this,Ye).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(Ft)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Ft)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=b(this,Ye).build(this,t);return n.isStaleByTime(os(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ft).catch(Ft)}fetchInfiniteQuery(e){return e.behavior=im(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ft).catch(Ft)}ensureInfiniteQueryData(e){return e.behavior=im(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return du.isOnline()?b(this,Kr).resumePausedMutations():Promise.resolve()}getQueryCache(){return b(this,Ye)}getMutationCache(){return b(this,Kr)}getDefaultOptions(){return b(this,Yr)}setDefaultOptions(e){re(this,Yr,e)}setQueryDefaults(e,t){b(this,Qi).set(qs(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...b(this,Qi).values()],n={};return t.forEach(r=>{hl(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){b(this,Ki).set(qs(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...b(this,Ki).values()],n={};return t.forEach(r=>{hl(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...b(this,Yr).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=ah(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===uh&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...b(this,Yr).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){b(this,Ye).clear(),b(this,Kr).clear()}},Ye=new WeakMap,Kr=new WeakMap,Yr=new WeakMap,Qi=new WeakMap,Ki=new WeakMap,Xr=new WeakMap,Yi=new WeakMap,Xi=new WeakMap,Bg),dx=c.createContext(void 0),Zs=e=>{const t=c.useContext(dx);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},RS=({client:e,children:t})=>(c.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(dx.Provider,{value:e,children:t})),fx=c.createContext(!1),PS=()=>c.useContext(fx);fx.Provider;function TS(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var LS=c.createContext(TS()),_S=()=>c.useContext(LS),IS=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},FS=e=>{c.useEffect(()=>{e.clearReset()},[e])},OS=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||sx(n,[e.error,r])),AS=e=>{if(e.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},DS=(e,t)=>e.isLoading&&e.isFetching&&!t,zS=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,lm=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function $S(e,t,n){var h,p,S,w,E;const r=PS(),s=_S(),i=Zs(),o=i.defaultQueryOptions(e);(p=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||p.call(h,o),o._optimisticResults=r?"isRestoring":"optimistic",AS(o),IS(o,s),FS(s);const l=!i.getQueryCache().get(o.queryHash),[u]=c.useState(()=>new t(i,o)),d=u.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(c.useSyncExternalStore(c.useCallback(j=>{const v=f?u.subscribe(it.batchCalls(j)):Ft;return u.updateResult(),v},[u,f]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),c.useEffect(()=>{u.setOptions(o)},[o,u]),zS(o,d))throw lm(o,u,s);if(OS({result:d,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((w=(S=i.getDefaultOptions().queries)==null?void 0:S._experimental_afterQuery)==null||w.call(S,o,d),o.experimental_prefetchInRender&&!Xs&&DS(d,r)){const j=l?lm(o,u,s):(E=i.getQueryCache().get(o.queryHash))==null?void 0:E.promise;j==null||j.catch(Ft).finally(()=>{u.updateResult()})}return o.notifyOnChangeProps?d:u.trackResult(d)}function Au(e,t){return $S(e,wS)}function BS(e,t){const n=Zs(),[r]=c.useState(()=>new NS(n,e));c.useEffect(()=>{r.setOptions(e)},[r,e]);const s=c.useSyncExternalStore(c.useCallback(o=>r.subscribe(it.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=c.useCallback((o,l)=>{r.mutate(o,l).catch(Ft)},[r]);if(s.error&&sx(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}const hx=8,US=6;function am(e,t,n){return n<t?t:Math.min(n,Math.max(t,e))}function px({x:e,y:t,menuWidth:n,menuHeight:r,viewport:s,margin:i=hx}){const o=i,l=i,u=s.width-Math.max(0,n)-i,d=s.height-Math.max(0,r)-i;return{x:am(e,o,u),y:am(t,l,d)}}function HS({anchorRect:e,menuSize:t,viewport:n,align:r="left",margin:s=hx,sideOffset:i=US}){const o=r==="right"?e.right-t.width:e.left,l=e.bottom+i,u=e.top-t.height-i,d=l+t.height+s<=n.height,f=u>=s;return px({x:o,y:!d&&f?u:l,menuWidth:t.width,menuHeight:t.height,viewport:n,margin:s})}function mx(){return typeof window>"u"?{width:1024,height:768}:{width:window.innerWidth,height:window.innerHeight}}function um(e){return e.length>0&&"options"in e[0]}function cm(){return{x:0,y:0,ready:!1}}function fh({value:e,onChange:t,options:n,placeholder:r="Select...",trigger:s,triggerClassName:i="",panelClassName:o="",align:l="left",width:u="auto",showChevron:d=!0,title:f,disabled:h=!1,"aria-label":p}){var z,le;const[S,w]=c.useState(!1),E=c.useRef(null),j=c.useRef(null),v=c.useRef(null),[m,x]=c.useState(cm),k=c.useCallback(()=>{const Q=A=>{const _=A.find(P=>P.value===e);return _?_.label:null};if(um(n))for(const A of n){const _=Q(A.options);if(_)return _}else{const A=Q(n);if(A)return A}return r},[e,n,r])(),R=((z=E.current)==null?void 0:z.getBoundingClientRect().width)??((le=j.current)==null?void 0:le.offsetWidth)??0,M=u==="trigger"?R:u==="auto"?void 0:u,N=c.useCallback(()=>{if(!S)return;const Q=E.current,A=v.current;if(!Q||!A)return;const _=Q.getBoundingClientRect(),P=A.getBoundingClientRect(),D=M??P.width??180,H=P.height||A.scrollHeight||1,te=HS({anchorRect:_,menuSize:{width:D,height:H},viewport:mx(),align:l});x(se=>se.x===te.x&&se.y===te.y&&se.ready?se:{x:te.x,y:te.y,ready:!0})},[l,M,S]);c.useLayoutEffect(()=>{if(!S){x(cm());return}N()},[S,N,n,e]),c.useEffect(()=>{if(!S)return;const Q=P=>{var H,te;const D=P.target;(H=E.current)!=null&&H.contains(D)||(te=v.current)!=null&&te.contains(D)||w(!1)},A=P=>{var D;P.key==="Escape"&&(w(!1),(D=j.current)==null||D.focus())},_=()=>N();return window.addEventListener("click",Q),window.addEventListener("keydown",A),window.addEventListener("resize",_),window.addEventListener("scroll",_,!0),()=>{window.removeEventListener("click",Q),window.removeEventListener("keydown",A),window.removeEventListener("resize",_),window.removeEventListener("scroll",_,!0)}},[S,N]);const O=Q=>{var A;t(Q),w(!1),(A=j.current)==null||A.focus()},T=Q=>Q.map(A=>a.jsxs("button",{className:"dropdown-item","data-active":A.value===e,disabled:A.disabled,onClick:()=>!A.disabled&&O(A.value),role:"menuitem",children:[A.icon&&a.jsx("span",{className:"shrink-0",children:A.icon}),a.jsx("span",{className:"flex-1 truncate",children:A.label}),A.value===e&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0 text-accent",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})]},A.value)),X=c.useMemo(()=>({position:"fixed",left:m.x,top:m.y,visibility:m.ready?"visible":"hidden",...M?{width:M,minWidth:M}:{}}),[M,m]),J=S?a.jsx("div",{ref:v,className:`dropdown-panel ${o}`,style:X,role:"listbox","aria-label":p,children:um(n)?n.map((Q,A)=>a.jsxs("div",{children:[Q.label&&a.jsx("div",{className:"dropdown-label",children:Q.label}),T(Q.options),A<n.length-1&&a.jsx("div",{className:"dropdown-divider"})]},Q.label||A)):T(n)}):null;return a.jsxs("div",{ref:E,className:"relative",children:[s?a.jsx("div",{onClick:()=>!h&&w(Q=>!Q),children:s}):a.jsxs("button",{ref:j,type:"button",className:`dropdown-trigger ${i}`,onClick:()=>w(Q=>!Q),disabled:h,title:f,"aria-label":p,"aria-haspopup":"listbox","aria-expanded":S,children:[a.jsx("span",{className:"truncate",children:k}),d&&a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`shrink-0 opacity-60 transition-transform ${S?"rotate-180":""}`,children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),J&&typeof document<"u"?Ou.createPortal(J,document.body):J]})}const VS={offline:"sync-dot-offline",unstable:"sync-dot-unstable",recent:"sync-dot-recent",editing:"sync-dot-editing",live:"sync-dot-live"};function WS({state:e,presence:t,syncLabel:n,connectionLabel:r,lastEditedLabel:s,hasEdits:i,localTypingActive:o,recentTouches:l,isNarrow:u}){const[d,f]=c.useState(!1),[h,p]=c.useState(null),S=c.useRef(null),w=c.useRef(null),E=c.useRef(null),j=t?`${t.viewing} viewing  ${t.editing} editing`:"- viewing  - editing",v=t?String(t.viewing):"-",m=c.useCallback(()=>{E.current&&(window.clearTimeout(E.current),E.current=null)},[]),x=c.useCallback((k,R)=>{var M;R&&((M=navigator.clipboard)==null||M.writeText(R).then(()=>{p(k),m(),E.current=window.setTimeout(()=>{p(N=>N===k?null:N)},1e3)}).catch(()=>{}))},[m]),y=c.useCallback(()=>{f(!1),window.requestAnimationFrame(()=>{var k;return(k=w.current)==null?void 0:k.focus()})},[]);return c.useEffect(()=>{if(!d)return;const k=M=>{!S.current||S.current.contains(M.target)||y()},R=M=>{M.key==="Escape"&&y()};return window.addEventListener("mousedown",k),window.addEventListener("keydown",R),()=>{window.removeEventListener("mousedown",k),window.removeEventListener("keydown",R)}},[d,y]),c.useEffect(()=>()=>{m()},[m]),a.jsxs("div",{ref:S,className:"sync-indicator",children:[a.jsxs("button",{ref:w,type:"button",className:"sync-indicator-button",onClick:()=>d?y():f(!0),"aria-haspopup":"dialog","aria-expanded":d,"aria-label":"Sync status",title:j,children:[a.jsx("span",{className:`sync-indicator-dot ${VS[e]}`,"aria-hidden":"true"}),!u&&a.jsx("span",{className:"sync-indicator-count tabular-nums",children:v}),!u&&o&&a.jsx("span",{className:"sync-indicator-local",children:"typing"})]}),d&&a.jsxs("div",{role:"dialog","aria-label":"Sync status",className:"sync-indicator-card select-text",children:[a.jsx("div",{className:"sync-indicator-line sync-indicator-primary",children:n}),a.jsx("div",{className:"sync-indicator-line",children:r}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:j}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:i?`Last edited: ${s}`:"No edits yet."}),o&&a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:"Local typing in progress (saved on blur)."}),a.jsxs("div",{className:"sync-indicator-section",children:[a.jsx("div",{className:"sync-indicator-section-title",children:"Recently touched files"}),l.length>0?a.jsx("div",{className:"sync-indicator-list",children:l.map(k=>a.jsxs("div",{className:"sync-indicator-item",children:[a.jsx("button",{type:"button",className:"sync-indicator-item-name",title:`Copy filename: ${k.label}`,onClick:()=>x(k.path,k.label),children:k.label}),a.jsx("span",{className:"sync-indicator-item-time tabular-nums",children:h===k.path?"Copied":k.timeLabel})]},k.path))}):a.jsx("div",{className:"sync-indicator-empty",children:"No recent touches."})]})]})]})}const ls={phoneMax:480,mobileMax:767,narrowMax:900,tabletMax:1024,mediumMax:1180},_a={phone:`(max-width: ${ls.phoneMax}px)`,narrow:`(max-width: ${ls.narrowMax}px)`,toolbarCompact:`(max-width: ${ls.mediumMax}px)`},dm=200,fm=240,QS=320,KS=360,YS=420;function hm(e,t,n){return Math.min(Math.max(e,t),n)}function XS(e){return e<=ls.tabletMax?QS:e<=ls.mediumMax?KS:YS}function qS(e){return e<=ls.tabletMax?360:e<=ls.mediumMax?420:520}function GS({viewportWidth:e,leftOpen:t,rightOpen:n,leftWidth:r,rightWidth:s}){const i=XS(e);let o=t?hm(r,dm,i):0,l=n?hm(s,fm,i):0;const u=Math.max(0,e-qS(e));if(o+l>u){let d=o+l-u;if(l>0){const f=Math.max(0,l-fm),h=Math.min(f,d);l-=h,d-=h}if(d>0&&o>0){const f=Math.max(0,o-dm),h=Math.min(f,d);o-=h,d-=h}d>0&&l>0&&(l=Math.max(0,u-o)),o+l>u&&(o=Math.max(0,u-l))}return{leftWidth:Number(o.toFixed(2)),rightWidth:Number(l.toFixed(2))}}function Ia(e,t=!1){const[n,r]=c.useState(t);return c.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;const s=window.matchMedia(e),i=s,o=()=>r(s.matches);if(o(),typeof s.addEventListener=="function")return s.addEventListener("change",o),()=>s.removeEventListener("change",o);if(typeof i.addListener=="function"&&typeof i.removeListener=="function")return i.addListener(o),()=>{var l;return(l=i.removeListener)==null?void 0:l.call(i,o)}},[e]),n}function gx({isRandom:e,dir:t}){return e?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),a.jsx("path",{d:"M21 3v5h-5"})]}):t==="desc"?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 5v14"}),a.jsx("path",{d:"M19 12l-7 7-7-7"})]}):a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 19V5"}),a.jsx("path",{d:"M5 12l7-7 7 7"})]})}function JS({viewerActive:e,filtersOpen:t,filtersRef:n,totalFilterCount:r,filterCount:s,starFilterList:i,starCounts:o,onToggleFilters:l,onOpenFilters:u,onToggleStar:d,onClearFilters:f,onClearStars:h}){return a.jsxs("div",{ref:n,className:`toolbar-filter relative ${e?"opacity-40 pointer-events-none":""}`,children:[a.jsxs("button",{className:`btn ${r>0?"btn-active":""}`,onClick:l,"aria-haspopup":"dialog","aria-expanded":t,title:"Filters","aria-disabled":e,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),a.jsx("span",{className:"toolbar-filters-label",children:"Filters"}),r>0&&a.jsx("span",{className:"toolbar-filters-count px-1.5 py-0.5 text-[11px] rounded-full bg-accent-strong text-text",children:r})]}),t&&a.jsxs("div",{role:"dialog","aria-label":"Filters",className:"dropdown-panel w-[240px]",style:{top:"38px",left:0},children:[a.jsx("div",{className:"dropdown-label",children:"Rating"}),a.jsxs("div",{className:"px-1",children:[[5,4,3,2,1].map(p=>{const S=i.includes(p),w=(o==null?void 0:o[String(p)])??0;return a.jsxs("button",{onClick:()=>d==null?void 0:d(p),className:`dropdown-item justify-between ${S?"bg-accent-muted":""}`,children:[a.jsxs("span",{className:S?"text-star-active":"text-text",children:["".repeat(p),"".repeat(5-p)]}),a.jsx("span",{className:"text-xs text-muted",children:w})]},p)}),a.jsxs("button",{onClick:()=>d==null?void 0:d(0),className:`dropdown-item justify-between ${i.includes(0)?"bg-accent-muted":""}`,children:[a.jsx("span",{className:"text-text",children:"Unrated"}),a.jsx("span",{className:"text-xs text-muted",children:(o==null?void 0:o["0"])??0})]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("div",{className:"dropdown-label",children:"Metrics"}),a.jsxs("button",{className:"dropdown-item",onClick:()=>{l(),u==null||u()},children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]}),a.jsx("span",{children:"Open Metrics Panel"}),(s||0)>0&&a.jsxs("span",{className:"ml-auto text-xs text-muted",children:[s," active"]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("button",{className:"dropdown-item text-muted hover:text-text",onClick:()=>{f?f():h==null||h()},disabled:r===0,children:"Clear all filters"})]})]})}function ZS({viewMode:e,currentSort:t,sortOnlyOptions:n,sortDisabled:r,sortControlsDisabled:s,sortDir:i,isRandom:o,showSelectModeToggle:l,multiSelectMode:u,selectModeLabel:d,uploadBusy:f,uploadDisabled:h,onViewMode:p,onSortChange:S,onToggleSortDir:w,onToggleMultiSelectMode:E,onUploadClick:j}){return a.jsx("div",{className:"mobile-drawer",children:a.jsxs("div",{className:"mobile-drawer-row",children:[a.jsxs("div",{className:"mobile-pill-group",children:[a.jsx("button",{className:`mobile-pill ${e==="grid"?"is-active":""}`,onClick:()=>p==null?void 0:p("grid"),"aria-pressed":e==="grid",children:"Grid"}),a.jsx("button",{className:`mobile-pill ${e==="adaptive"?"is-active":""}`,onClick:()=>p==null?void 0:p("adaptive"),"aria-pressed":e==="adaptive",children:"Masonry"})]}),a.jsx(fh,{value:t,onChange:v=>S==null?void 0:S(v),options:n,"aria-label":"Sort",triggerClassName:"mobile-pill mobile-pill-dropdown",panelClassName:"mobile-drawer-panel",disabled:r}),a.jsx("button",{className:`mobile-pill mobile-pill-icon ${s?"opacity-50 cursor-not-allowed":""}`,onClick:w,title:r?"Sorting disabled":o?"Shuffle":`Sort ${i==="desc"?"descending":"ascending"}`,"aria-label":o?"Shuffle":"Toggle sort direction","aria-disabled":s,disabled:s,children:a.jsx(gx,{isRandom:o,dir:i})}),l&&a.jsx("button",{className:`mobile-pill ${u?"is-active":""}`,onClick:()=>E==null?void 0:E(),"aria-pressed":u,title:u?"Exit select mode":"Enter select mode",children:d}),j&&a.jsx("button",{className:`mobile-pill ${h||f?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!h&&!f&&j(),disabled:h||f,children:f?"Uploading":"Upload"})]})})}function eb({rootRef:e,onSearch:t,viewerActive:n,onBack:r,zoomPercent:s,onZoomPercentChange:i,currentLabel:o,itemCount:l,totalCount:u,sortSpec:d,metricKeys:f,onSortChange:h,sortDisabled:p=!1,filterCount:S,onOpenFilters:w,starFilters:E,onToggleStar:j,onClearStars:v,onClearFilters:m,starCounts:x,viewMode:y,onViewMode:k,gridItemSize:R,onGridItemSize:M,leftOpen:N,rightOpen:O,onToggleLeft:T,onToggleRight:X,onPrevImage:J,onNextImage:z,canPrevImage:le,canNextImage:Q,searchDisabled:A=!1,searchPlaceholder:_,onUploadClick:P,uploadBusy:D=!1,uploadDisabled:H=!1,multiSelectMode:te=!1,selectedCount:se=0,onToggleMultiSelectMode:I,syncIndicator:U}){const[Y,Z]=c.useState(!1),[q,ne]=c.useState(!1),fe=c.useRef(null),je=c.useRef(null),xe=Ia(_a.narrow),De=Ia(_a.phone),be=Ia(_a.toolbarCompact);c.useEffect(()=>{if(!Y)return;const K=me=>{fe.current&&!fe.current.contains(me.target)&&Z(!1)};return window.addEventListener("click",K),()=>window.removeEventListener("click",K)},[Y]),c.useEffect(()=>{if(A){ne(!1);return}if(!xe||n){ne(!1);return}if(!q)return;const K=window.requestAnimationFrame(()=>{var me;return(me=je.current)==null?void 0:me.focus()});return()=>window.cancelAnimationFrame(K)},[xe,q,n,A]);const Ie=d??{kind:"builtin",key:"added",dir:"desc"},lt=Ie.dir,gt=Ie.kind==="builtin"&&Ie.key==="random",hn=n||p,Bn=f!=null&&f.length?f.map(K=>({value:`metric:${K}`,label:K,disabled:p})):[],Gt=[{value:"builtin:added",label:"Date added",disabled:p},{value:"builtin:name",label:"Filename",disabled:p},{value:"builtin:random",label:"Random",disabled:p},...Bn],Ze=[{label:"Layout",options:[{value:"layout:grid",label:"Grid"},{value:"layout:masonry",label:"Masonry"}]},{label:"Sort by",options:Gt}],Jt=Ie.kind==="metric"?`metric:${Ie.key}`:`builtin:${Ie.key}`,zt=[{label:"Sort by",options:Gt}],pn=xe&&!n,Hn=!(!!n&&be),$t=!!n&&!De,Qe=pn&&!!I,Nt=te?se>0?`Done (${se})`:"Done":"Select",mn=K=>{if(K.startsWith("layout:")){const me=K==="layout:masonry"?"adaptive":"grid";k==null||k(me)}else{if(p)return;h==null||h(pm(K,Ie))}},Zt=()=>{!h||p||h(gt?Ie:{...Ie,dir:lt==="desc"?"asc":"desc"})},en=E??[],gn=en.length,Vn=nb(S,gn),$=tb(l,u),ee=o||"Root";return a.jsxs("div",{ref:e,className:`toolbar-shell ${n?"toolbar-shell-viewer":""} ${De?"toolbar-shell-phone":""} ${be?"toolbar-shell-compact":""} fixed top-0 left-0 right-0 h-12 grid grid-cols-[minmax(0,1fr)_minmax(0,1fr)_auto] items-center px-3 gap-3 bg-panel border-b border-border z-[var(--z-toolbar)] col-span-full row-start-1 select-none`,children:[a.jsxs("div",{className:"toolbar-left flex items-center gap-4 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope flex items-center gap-3 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope-text flex flex-col min-w-0 leading-tight",children:[a.jsx("span",{className:"toolbar-scope-label text-[10px] uppercase tracking-widest text-muted",children:"Scope"}),a.jsx("span",{className:"text-sm font-medium text-text truncate",title:ee,children:ee})]}),$&&a.jsx("span",{className:"toolbar-count text-xs text-muted whitespace-nowrap tabular-nums",children:$})]}),n&&a.jsxs("button",{className:"toolbar-back-btn btn btn-sm",onClick:r,title:"Back to grid",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]}),Hn&&a.jsxs("div",{className:"toolbar-sort flex items-center gap-2",children:[a.jsxs("div",{className:`toolbar-sort-controls flex items-center gap-2 ${n?"opacity-40 pointer-events-none":""}`,children:[a.jsx(fh,{value:Jt,onChange:mn,options:Ze,title:"Sort and layout options","aria-label":"Sort and layout",triggerClassName:"min-w-[110px]"}),a.jsx("button",{className:"toolbar-sort-dir btn btn-icon",onClick:Zt,title:p?"Sorting disabled":gt?"Shuffle":`Sort ${lt==="desc"?"descending":"ascending"}`,"aria-label":gt?"Shuffle":"Toggle sort direction","aria-disabled":hn,disabled:hn,children:a.jsx(gx,{isRandom:gt,dir:lt})})]}),a.jsx(JS,{viewerActive:!!n,filtersOpen:Y,filtersRef:fe,totalFilterCount:Vn,filterCount:S,starFilterList:en,starCounts:x,onToggleFilters:()=>Z(K=>!K),onOpenFilters:w,onToggleStar:j,onClearFilters:m,onClearStars:v})]})]}),a.jsx("div",{className:"toolbar-center flex items-center gap-3 justify-center min-w-0",children:n?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"range",min:5,max:800,step:1,value:Math.round(Math.max(5,Math.min(800,s??100))),onChange:K=>i==null?void 0:i(Number(K.target.value)),className:"zoom-slider","aria-label":"Zoom level"}),a.jsxs("span",{className:"text-xs text-muted min-w-[42px] text-right",children:[Math.round(s??100),"%"]})]}):M&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-muted",children:"Size"}),a.jsx("input",{type:"range",min:80,max:500,step:10,value:R??220,onChange:K=>M(Number(K.target.value)),className:"w-28 h-1.5 bg-border rounded-full appearance-none cursor-pointer hover:bg-hover transition-colors [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-text [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-text [&::-moz-range-thumb]:border-0","aria-label":"Thumbnail size"})]})}),a.jsxs("div",{className:"toolbar-right flex items-center gap-2 justify-end",children:[$t&&a.jsxs("div",{className:"toolbar-nav flex items-center gap-1 mr-1",children:[a.jsx("button",{className:`btn btn-icon ${le?"":"opacity-40 cursor-not-allowed"}`,title:"Previous image (A / )",onClick:()=>le&&(J==null?void 0:J()),"aria-label":"Previous image","aria-disabled":!le,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("button",{className:`btn btn-icon ${Q?"":"opacity-40 cursor-not-allowed"}`,title:"Next image (D / )",onClick:()=>Q&&(z==null?void 0:z()),"aria-label":"Next image","aria-disabled":!Q,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 6l6 6-6 6"})})})]}),a.jsxs("div",{className:"toolbar-panels flex items-center gap-1",children:[a.jsx("button",{className:`btn btn-icon ${N?"":"opacity-50"}`,title:N?"Hide left panel (Ctrl+B)":"Show left panel (Ctrl+B)",onClick:T,"aria-pressed":N,"aria-label":"Toggle left panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"11",y:"5",width:"10",height:"14",rx:"1.5"})]})}),a.jsx("button",{className:`btn btn-icon ${O?"":"opacity-50"}`,title:O?"Hide right panel (Ctrl+Alt+B)":"Show right panel (Ctrl+Alt+B)",onClick:X,"aria-pressed":O,"aria-label":"Toggle right panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"15",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"3",y:"5",width:"10",height:"14",rx:"1.5"})]})})]}),!n&&P&&a.jsxs("button",{className:`btn ${H?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!H&&P(),"aria-label":"Upload images",title:D?"Uploading":"Upload images","aria-disabled":H||D,disabled:H||D,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M12 16V5"}),a.jsx("path",{d:"M7 10l5-5 5 5"}),a.jsx("path",{d:"M4 19h16"})]}),a.jsx("span",{children:D?"Uploading":"Upload"})]}),U&&a.jsx(WS,{...U,isNarrow:xe||be}),!n&&xe&&a.jsx("button",{className:`btn btn-icon ${q?"btn-active":""} ${A?"opacity-50 cursor-not-allowed":""}`,"aria-label":q?"Close search":"Open search",title:A?"Search disabled":q?"Close search":"Search",onClick:()=>!A&&ne(K=>!K),disabled:A,children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"11",cy:"11",r:"7"}),a.jsx("path",{d:"M21 21l-4.35-4.35"})]})}),!n&&!xe?a.jsx("div",{className:"toolbar-search toolbar-search-desktop w-[240px]",children:a.jsx("input",{ref:je,"aria-label":"Search filename, tags, notes",placeholder:A?_??"Search disabled":"Search...",onChange:K=>t(K.target.value),className:"toolbar-search-input input w-full focus:w-full transition-all duration-200 select-text",disabled:A})}):null]}),!n&&xe&&q&&!A&&a.jsx("div",{className:"toolbar-search-row",children:a.jsx("input",{ref:je,"aria-label":"Search filename, tags, notes",placeholder:_??"Search...",onChange:K=>t(K.target.value),className:"toolbar-search-input-mobile input input-lg w-full select-text"})}),pn&&a.jsx(ZS,{viewMode:y,currentSort:Jt,sortOnlyOptions:zt,sortDisabled:p,sortControlsDisabled:hn,sortDir:lt,isRandom:gt,showSelectModeToggle:Qe,multiSelectMode:te,selectModeLabel:Nt,uploadBusy:D,uploadDisabled:H,onViewMode:k,onSortChange:K=>h==null?void 0:h(pm(K,Ie)),onToggleSortDir:Zt,onToggleMultiSelectMode:I,onUploadClick:P})]})}function tb(e,t){if(typeof e!="number")return null;const n=e.toLocaleString();if(typeof t!="number")return`${n} items`;const r=t.toLocaleString();return t===e?`${n} items`:`${n} / ${r} items`}function nb(e,t){return typeof e=="number"?e:t>0?1:0}function pm(e,t){if(e.startsWith("metric:")){const n=e.slice(7);return n?{kind:"metric",key:n,dir:t.dir}:t}if(e.startsWith("builtin:")){const n=e.slice(8);if(n==="name"||n==="added"||n==="random")return{kind:"builtin",key:n,dir:t.dir}}return t}class un extends Error{constructor(n,r,s,i){super(r);rt(this,"status");rt(this,"url");rt(this,"body");this.name="FetchError",this.status=n,this.url=s,this.body=i}}function rb(e){const t=e.trim();return t.startsWith("{")||t.startsWith("[")}function vx(e,t,n){if(t&&typeof t=="object"){const r=t,s=typeof r.error=="string"?r.error:null,i=typeof r.message=="string"?r.message:null;if(s&&i)return`${s}: ${i}`;if(s)return s;if(i)return i}return typeof t=="string"&&t?t:`HTTP ${e} for ${n}`}function ft(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{let u=null;const d=await l.text().catch(()=>"");if(d)if((l.headers.get("content-type")||"").includes("application/json")||rb(d))try{u=JSON.parse(d)}catch{u=d}else u=d;if(!l.ok)throw new un(l.status,vx(l.status,u,e),e,u);return u}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}function Eo(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{if(!l.ok){const u=await l.text().catch(()=>""),d=u||null;throw new un(l.status,vx(l.status,d,e),e,d)}return l.blob()}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}class yx{constructor(t){rt(this,"store",new Map);rt(this,"inflight",new Map);rt(this,"totalBytes",0);this.maxBytes=t}getMaxBytes(){return this.maxBytes}getTotalBytes(){return this.totalBytes}getSize(){return this.store.size}has(t){return this.store.has(t)}isInflight(t){return this.inflight.has(t)}get(t){const n=this.store.get(t);if(n)return this.store.delete(t),this.store.set(t,n),n.blob}evictIfNeeded(t){for(;this.totalBytes+t>this.maxBytes&&this.store.size>0;){const n=this.store.keys().next().value;if(n==null)break;const r=this.store.get(n);r&&(this.totalBytes-=r.size),this.store.delete(n)}}set(t,n){const r=n.size||0;if(!(r>this.maxBytes)){if(this.store.has(t)){const s=this.store.get(t);this.totalBytes-=s.size,this.store.delete(t)}this.evictIfNeeded(r),this.store.set(t,{blob:n,size:r}),this.totalBytes+=r}}async getOrFetch(t,n){const r=this.get(t);if(r)return r;const s=this.inflight.get(t);if(s)return s.promise;const i=n(),o=typeof i=="object"&&"promise"in i,l=o?i.promise:i,u=o?i.abort:void 0,d=l.then(f=>(this.set(t,f),f)).finally(()=>{this.inflight.delete(t)});return this.inflight.set(t,{promise:d,abort:u}),d}prefetch(t,n){if(this.store.has(t)||this.inflight.has(t))return;const r=n(),s=typeof r=="object"&&"promise"in r,i=s?r.promise:r,o=s?r.abort:void 0,l=i.then(u=>(this.set(t,u),u)).catch(()=>new Blob).finally(()=>{this.inflight.delete(t)});this.inflight.set(t,{promise:l,abort:o})}cancelPrefetch(t){const n=this.inflight.get(t);if(n!=null&&n.abort)try{n.abort()}catch{}this.inflight.delete(t)}clear(){for(const[t,n]of this.inflight)if(n.abort)try{n.abort()}catch{}this.inflight.clear(),this.store.clear(),this.totalBytes=0}evictPrefix(t){const n=(()=>{const s=t?`/${t.replace(/^\/+/,"")}`:"/";return s==="/"?"/":s.replace(/\/+$/,"")})(),r=s=>{const i=s.startsWith("/")?s.replace(/\/+$/,""):`/${s.replace(/\/+$/,"")}`;return n==="/"?!0:i===n||i.startsWith(`${n}/`)};for(const[s,i]of Array.from(this.store.entries()))r(s)&&(this.totalBytes-=i.size,this.store.delete(s));for(const[s,i]of Array.from(this.inflight.entries()))if(r(s)){if(i.abort)try{i.abort()}catch{}this.inflight.delete(s)}this.totalBytes<0&&(this.totalBytes=0)}}const mi=new yx(60*1024*1024),qd=new yx(20*1024*1024),Mc={};function sb(){const e=Mc==null?void 0:Mc.VITE_API_BASE,t=typeof window<"u",n=t?window.location.origin:"http://localhost",r=t?window.location.hostname:"localhost",s=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\]|.+\.localhost)$/i.test(r);if(!e)return"";let i;try{i=new URL(e,n)}catch{return""}const o=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\])$/i.test(i.hostname);return s?i.origin:o?"":i.origin}const Ue=sb();const ib=40*1024*1024;function ob(e){return e==="viewer"||e==="compare"}function mm(e){return`${Ue}/thumb?path=${encodeURIComponent(e)}`}function gm(e){return`${Ue}/file?path=${encodeURIComponent(e)}`}const Rc="lenslet.client_id",vm="lenslet.client_id.session",xx="lenslet.last_event_id",lb=1e3,ab=3e4,ub=5;let Gd=null,Fa=null,ym=0,Ii=null,Fi=0,Du=!0,fu=!1;function wx(){return typeof window<"u"&&typeof EventSource<"u"}function xm(e,t){if(!e)return null;try{return e.getItem(t)}catch{return null}}function wm(e,t,n){if(e)try{e.setItem(t,n)}catch{}}function cb(e,t){if(e)try{e.removeItem(t)}catch{}}function db(){if(typeof navigator>"u")return"server";const e=navigator.userAgent||"",t=navigator.language||"",n=navigator.platform||"",r=typeof Intl<"u"&&Intl.DateTimeFormat().resolvedOptions().timeZone||"",s=typeof screen<"u"?`${screen.width}x${screen.height}x${screen.colorDepth}`:"";return[e,t,n,r,s].join("|")}function fb(e){let t=2166136261;for(let n=0;n<e.length;n+=1)t^=e.charCodeAt(n),t=t*16777619>>>0;return t.toString(16).padStart(8,"0")}function Sm(){return typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`client_${Math.random().toString(36).slice(2,10)}_${Date.now()}`}function No(e){return Gd=e,e}function hu(e){if(typeof window>"u")return null;try{return e==="local"?window.localStorage:window.sessionStorage}catch{return null}}function ro(){if(Gd)return Gd;const e=hu("local"),t=hu("session"),n=xm(t,vm);if(n)return No(n);const r=xm(e,Rc);if(t){const i=Sm();return wm(t,vm,i),r&&cb(e,Rc),No(i)}if(r)return No(r);if(e){const i=Sm();return wm(e,Rc,i),No(i)}const s=`fp_${fb(db())}_${Math.random().toString(36).slice(2,8)}`;return No(s)}function pl(e="lenslet"){ym+=1;const t=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`nonce_${Math.random().toString(36).slice(2,10)}_${Date.now()}_${ym}`;return`${e}:${ro()}:${t}`}function hb(){if(Fa!=null)return Fa;if(typeof window>"u")return null;const e=hu("local");if(!e)return null;try{const t=e.getItem(xx);if(!t)return null;const n=Number(t);return!Number.isFinite(n)||n<=0?null:(Fa=n,n)}catch{return null}}function pb(e){if(!Number.isFinite(e)||e<=0||(Fa=e,typeof window>"u"))return;const t=hu("local");if(t)try{t.setItem(xx,String(e))}catch{}}function mb(){if(typeof window>"u")return`${Ue}/events`;const e=new URL(`${Ue}/events`,window.location.origin),t=hb();return t!=null&&Number.isFinite(t)&&e.searchParams.set("last_event_id",String(t)),e.toString()}function gb(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}let _n=null,Sx="idle";const Jd=new Set,Zd=new Set,ef=new Set;function Oi(e){Sx=e;for(const t of Zd)t(e)}function hh(e){if(fu!==e){fu=e;for(const t of ef)t(e)}}function ph(){Ii!=null&&(window.clearTimeout(Ii),Ii=null)}function vb(){Fi=0,ph()}function yb(){if(!Du||Ii!=null)return;Fi+=1;const e=Math.min(lb*Math.pow(2,Fi-1),ab);Fi>=ub?(Oi("offline"),hh(!0)):Oi("reconnecting"),Ii=window.setTimeout(()=>{Ii=null,bx()},e)}function bx(){if(!Du||!wx()||(_n&&_n.readyState===EventSource.CLOSED&&(_n.close(),_n=null),_n))return;Fi>0?Oi("reconnecting"):Oi("connecting");const e=new EventSource(mb());_n=e;const t=n=>r=>{const s=gb(r.data);if(!s)return;const i=r.lastEventId?Number(r.lastEventId):null,o=i!=null&&Number.isFinite(i)?i:null;o!=null&&pb(o);for(const l of Jd)l({type:n,id:o,data:s})};e.addEventListener("item-updated",t("item-updated")),e.addEventListener("metrics-updated",t("metrics-updated")),e.addEventListener("presence",t("presence")),e.onopen=()=>{vb(),hh(!1),Oi("live")},e.onerror=()=>{_n===e&&(e.close(),_n=null,yb())}}function xb(){Du=!0,wx()&&(ph(),bx())}function wb(){Du=!1,ph(),Fi=0,_n&&(_n.close(),_n=null),hh(!1),Oi("offline")}function Sb(e){return Jd.add(e),()=>{Jd.delete(e)}}function bb(e){return Zd.add(e),e(Sx),()=>{Zd.delete(e)}}function Cb(e){return ef.add(e),e(fu),()=>{ef.delete(e)}}function kb(){return fu}function Eb(e,t){const n=JSON.stringify(t),r=`${Ue}${e}`;if(typeof navigator<"u"&&typeof navigator.sendBeacon=="function")try{if(navigator.sendBeacon(r,new Blob([n],{type:"application/json"})))return!0}catch{}if(typeof fetch!="function")return!1;try{return fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0}),!0}catch{return!1}}function Nb(e,t,n){return Eb("/presence/leave",{gallery_id:e,lease_id:t,client_id:n??ro()})}function ha(e){return e??ro()}function pa(e,t){return ft(`${Ue}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).promise}function jb(e,t){const n=new URLSearchParams({path:e});return(t==null?void 0:t.page)!=null&&n.set("page",String(t.page)),(t==null?void 0:t.pageSize)!=null&&n.set("page_size",String(t.pageSize)),t!=null&&t.recursive&&n.set("recursive","1"),t!=null&&t.legacyRecursive&&n.set("legacy_recursive","1"),n.toString()}const Se={getFolder:(e,t)=>ft(`${Ue}/folders?${jb(e,t)}`).promise,search:(e,t)=>{const n=new URLSearchParams;return e&&n.set("q",e),t&&n.set("path",t),ft(`${Ue}/search?${n}`).promise},getEmbeddings:()=>ft(`${Ue}/embeddings`).promise,searchEmbeddings:e=>ft(`${Ue}/embeddings/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,refreshFolder:e=>{const t=new URLSearchParams({path:e});return ft(`${Ue}/refresh?${t}`,{method:"POST"}).promise},getSidecar:e=>ft(`${Ue}/item?path=${encodeURIComponent(e)}`).promise,patchSidecar:(e,t,n)=>{const s={"Content-Type":"application/json","Idempotency-Key":(n==null?void 0:n.idempotencyKey)??pl("patch"),"x-client-id":ro(),"x-updated-by":"web"};return(n==null?void 0:n.ifMatch)!=null&&(s["If-Match"]=String(n.ifMatch)),ft(`${Ue}/item?path=${encodeURIComponent(e)}`,{method:"PATCH",headers:s,body:JSON.stringify(t)}).promise},getMetadata:e=>ft(`${Ue}/metadata?path=${encodeURIComponent(e)}`).promise,putSidecar:(e,t)=>ft(`${Ue}/item?path=${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json","x-client-id":ro(),"x-updated-by":"web"},body:JSON.stringify(t)}).promise,getHealth:()=>ft(`${Ue}/health`).promise,joinPresence:(e,t,n)=>pa("/presence/join",{gallery_id:e,client_id:ha(n),lease_id:t}),movePresence:(e,t,n,r)=>pa("/presence/move",{from_gallery_id:e,to_gallery_id:t,client_id:ha(r),lease_id:n}),leavePresence:(e,t,n)=>pa("/presence/leave",{gallery_id:e,client_id:ha(n),lease_id:t}),postPresence:(e,t,n)=>pa("/presence",{gallery_id:e,client_id:ha(n),lease_id:t}),getThumb:e=>qd.getOrFetch(e,()=>Eo(mm(e))),prefetchThumb:e=>{qd.prefetch(e,()=>Eo(mm(e)))},getFile:e=>mi.getOrFetch(e,()=>Eo(gm(e))),exportComparison:e=>Eo(`${Ue}/export-comparison`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,prefetchFile:async(e,t)=>{if(ob(t)&&!(mi.has(e)||mi.isInflight(e)))try{const n=await Eo(gm(e),{headers:{"x-lenslet-prefetch":t}}).promise;n.size<=ib&&mi.set(e,n)}catch{}},cancelPrefetch:e=>{mi.cancelPrefetch(e)},uploadFile:async(e,t)=>{const n=new FormData;return n.append("dest",e),n.append("file",t),ft(`${Ue}/file`,{method:"POST",body:n,timeoutMs:6e4}).promise},moveFile:async(e,t)=>{const n=new FormData;return n.append("src",e),n.append("dest",t),ft(`${Ue}/move`,{method:"POST",body:n}).promise},deleteFiles:async e=>ft(`${Ue}/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paths:e})}).promise,exportIntent:async e=>{const t=new FormData;return t.append("path",e),ft(`${Ue}/export-intent`,{method:"POST",body:t}).promise},getViews:()=>ft(`${Ue}/views`).promise,saveViews:e=>ft(`${Ue}/views`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise};class Mb{constructor(t=400){rt(this,"cache",new Map);rt(this,"maxSize");this.maxSize=t,typeof window<"u"&&window.addEventListener("beforeunload",()=>this.clear(),{once:!0})}get(t){const n=this.cache.get(t);return n&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){for(this.cache.has(t)&&this.cache.delete(t);this.cache.size>=this.maxSize;){const r=this.cache.keys().next().value;if(r===void 0)break;const s=this.cache.get(r);if(this.cache.delete(r),s)try{URL.revokeObjectURL(s)}catch{}}this.cache.set(t,n)}clear(){for(const t of this.cache.values())try{URL.revokeObjectURL(t)}catch{}this.cache.clear()}}const Pc=new Mb(400);function Rb({path:e,name:t,onClick:n,selected:r,highlighted:s,highlightKey:i,displayW:o,displayH:l,ioRoot:u,isScrolling:d,priority:f}){const h=c.useRef(null),[p,S]=c.useState(()=>Pc.get(e)??null),[w,E]=c.useState(!1),[j,v]=c.useState(()=>!!p);c.useEffect(()=>{const x=h.current;if(!x)return;const y=new IntersectionObserver(k=>{for(const R of k)R.target===x&&E(R.isIntersecting||R.intersectionRatio>0)},{root:u??null,rootMargin:"200px 0px",threshold:.01});return y.observe(x),()=>{y.unobserve(x),y.disconnect()}},[u]),c.useEffect(()=>{if(p||!(w&&!d||f))return;let x=!0;return Se.getThumb(e).then(y=>{if(!x)return;const k=URL.createObjectURL(y);Pc.set(e,k),S(k)}).catch(()=>{}),()=>{x=!1}},[e,p,w,d,f]),c.useEffect(()=>{var y;if(!p){v(!1);return}const x=(y=h.current)==null?void 0:y.querySelector("img");x&&x.complete&&x.naturalWidth>0?v(!0):v(!1)},[p]),c.useEffect(()=>{S(Pc.get(e)??null)},[e]);const m=["absolute inset-0 relative bg-hover border border-border rounded-lg overflow-hidden select-none",r?"outline-2 outline-accent":"",s?"thumb-updated-ring":"","hover:outline hover:outline-1 hover:outline-accent"].filter(Boolean).join(" ");return a.jsx("div",{ref:h,"data-highlight-key":i??void 0,className:m,onClick:n,children:p?a.jsx("img",{className:`w-full h-full object-cover block pointer-events-none select-none opacity-0 transition-opacity duration-[160ms] ${j?"opacity-100":""}`,src:p,alt:t,loading:"lazy",decoding:"async",onLoad:()=>v(!0),width:o?Math.round(o):void 0,height:l?Math.round(l):void 0}):null})}function hi(e,t,n){let r=n.initialDeps??[],s,i=!0;function o(){var l,u,d;let f;n.key&&((l=n.debug)!=null&&l.call(n))&&(f=Date.now());const h=e();if(!(h.length!==r.length||h.some((w,E)=>r[E]!==w)))return s;r=h;let S;if(n.key&&((u=n.debug)!=null&&u.call(n))&&(S=Date.now()),s=t(...h),n.key&&((d=n.debug)!=null&&d.call(n))){const w=Math.round((Date.now()-f)*100)/100,E=Math.round((Date.now()-S)*100)/100,j=E/16,v=(m,x)=>{for(m=String(m);m.length<x;)m=" "+m;return m};console.info(`%c ${v(E,5)} /${v(w,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*j,120))}deg 100% 31%);`,n==null?void 0:n.key)}return n!=null&&n.onChange&&!(i&&n.skipInitialOnChange)&&n.onChange(s),i=!1,s}return o.updateDeps=l=>{r=l},o}function bm(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const Pb=(e,t)=>Math.abs(e-t)<1.01,Tb=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},Cm=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},Lb=e=>e,_b=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},Ib=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=o=>{const{width:l,height:u}=o;t({width:Math.round(l),height:Math.round(u)})};if(s(Cm(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(o=>{const l=()=>{const u=o[0];if(u!=null&&u.borderBoxSize){const d=u.borderBoxSize[0];if(d){s({width:d.inlineSize,height:d.blockSize});return}}s(Cm(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},km={passive:!0},Em=typeof window>"u"?!0:"onscrollend"in window,Fb=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&Em?()=>{}:Tb(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),o=f=>()=>{const{horizontal:h,isRtl:p}=e.options;s=h?n.scrollLeft*(p&&-1||1):n.scrollTop,i(),t(s,f)},l=o(!0),u=o(!1);u(),n.addEventListener("scroll",l,km);const d=e.options.useScrollendEvent&&Em;return d&&n.addEventListener("scrollend",u,km),()=>{n.removeEventListener("scroll",l),d&&n.removeEventListener("scrollend",u)}},Ob=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},Ab=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const o=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class Db{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Lb,rangeExtractor:_b,onChange:()=>{},measureElement:Ob,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=hi(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let o=r-1;o>=0;o--){const l=n[o];if(s.has(l.lane))continue;const u=i.get(l.lane);if(u==null||l.end>u.end?i.set(l.lane,l):l.end<u.end&&s.set(l.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=hi(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(n,r,s,i,o,l)=>(this.prevLanes!==void 0&&this.prevLanes!==l&&(this.lanesChangedFlag=!0),this.prevLanes=l,this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=hi(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l},u)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>n)for(const p of this.laneAssignments.keys())p>=n&&this.laneAssignments.delete(p);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(p=>{this.itemSizeCache.set(p.key,p.size)}));const d=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===n&&(this.lanesSettling=!1);const f=this.measurementsCache.slice(0,d),h=new Array(l).fill(void 0);for(let p=0;p<d;p++){const S=f[p];S&&(h[S.lane]=p)}for(let p=d;p<n;p++){const S=i(p),w=this.laneAssignments.get(p);let E,j;if(w!==void 0&&this.options.lanes>1){E=w;const y=h[E],k=y!==void 0?f[y]:void 0;j=k?k.end+this.options.gap:r+s}else{const y=this.options.lanes===1?f[p-1]:this.getFurthestMeasurement(f,p);j=y?y.end+this.options.gap:r+s,E=y?y.lane:p%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(p,E)}const v=u.get(S),m=typeof v=="number"?v:this.options.estimateSize(p),x=j+m;f[p]={index:p,start:j,size:m,end:x,key:S,lane:E},h[E]=p}return this.measurementsCache=f,f},{key:!1,debug:()=>this.options.debug}),this.calculateRange=hi(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?zb({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=hi(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,o)=>i===null||o===null?[]:n({startIndex:i,endIndex:o,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==n&&(l&&this.observer.unobserve(l),this.observer.observe(n),this.elementsCache.set(o,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,o=r-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,o,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=hi(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,o=n.length;i<o;i++){const l=n[i],u=r[l];s.push(u)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return bm(r[Cx(0,r.length-1,s=>bm(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),o=this.getScrollOffset();r==="auto"&&(r=n>=o+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),o=this.getScrollOffset();if(r==="auto")if(s.end>=o+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=o+this.options.scrollPaddingStart)r="start";else return[o,r];const l=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),n=Math.max(0,Math.min(n,this.options.count-1));let i=0;const o=10,l=d=>{if(!this.targetWindow)return;const f=this.getOffsetForIndex(n,d);if(!f){console.warn("Failed to get offset for index:",n);return}const[h,p]=f;this._scrollToOffset(h,{adjustments:void 0,behavior:s}),this.targetWindow.requestAnimationFrame(()=>{const S=this.getScrollOffset(),w=this.getOffsetForIndex(n,p);if(!w){console.warn("Failed to get offset for index:",n);return}Pb(w[0],S)||u(p)})},u=d=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(d)):console.warn(`Failed to scroll to index ${n} after ${o} attempts.`))};l(r)},this.scrollBy=(n,{behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=r.length-1;for(;o>=0&&i.some(l=>l===null);){const l=r[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}s=Math.max(...i.filter(l=>l!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(t)}}const Cx=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function zb({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=u=>e[u].start;if(e.length<=r)return{startIndex:0,endIndex:s};let o=Cx(0,s,i,n),l=o;if(r===1)for(;l<s&&e[l].end<n+t;)l++;else if(r>1){const u=Array(r).fill(0);for(;l<s&&u.some(f=>f<n+t);){const f=e[l];u[f.lane]=f.end,l++}const d=Array(r).fill(n+t);for(;o>=0&&d.some(f=>f>=n);){const f=e[o];d[f.lane]=f.start,o--}o=Math.max(0,o-o%r),l=Math.min(s,l+(r-1-l%r))}return{startIndex:o,endIndex:l}}const Nm=typeof document<"u"?c.useLayoutEffect:c.useEffect;function $b(e){const t=c.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var o;i?Ou.flushSync(t):t(),(o=e.onChange)==null||o.call(e,s,i)}},[r]=c.useState(()=>new Db(n));return r.setOptions(n),Nm(()=>r._didMount(),[]),Nm(()=>r._willUpdate()),r}function Bb(e){return $b({observeElementRect:Ib,observeElementOffset:Fb,scrollToFn:Ab,...e})}function Ub({containerW:e,gap:t,targetCell:n,aspect:r,captionH:s}){const i=Math.max(1,Math.floor((e+t)/(n+t))),o=(e-t*(i-1))/i,l=o*r.h/r.w,u=l+s+t;return{columns:i,cellW:o,mediaH:l,rowH:u}}const Hb=1.333;function Vb({items:e,containerWidth:t,targetHeight:n,gap:r,captionH:s}){if(t<=0)return[];const i=[];let o=[],l=0;const u=(d,f)=>({index:i.length,height:f+s+r,imageH:f,items:d.map(h=>({item:h.item,displayW:h.aspect*f,displayH:f,originalIndex:h.originalIndex}))});for(let d=0;d<e.length;d++){const f=e[d],h=f.w>0&&f.h>0?f.w/f.h:Hb;o.push({item:f,aspect:h,originalIndex:d}),l+=h;const p=(o.length-1)*r;if(l*n+p>=t){const w=(t-p)/l;i.push(u(o,w)),o=[],l=0}}return o.length>0&&i.push(u(o,n)),i}function Wb(e,t,n){return{mode:"adaptive",rows:Vb({items:t,containerWidth:e,targetHeight:n.targetCell,gap:n.gap,captionH:n.captionH})}}function Qb(e,t,n){const{columns:r,cellW:s,mediaH:i,rowH:o}=Ub({containerW:e,gap:n.gap,targetCell:n.targetCell,aspect:n.aspect,captionH:n.captionH}),l=Math.ceil(t.length/Math.max(1,r));return{mode:"grid",columns:r,cellW:s,mediaH:i,rowH:o,rowCount:l}}function Kb(e,t,n){const[r,s]=c.useState(0);c.useLayoutEffect(()=>{const u=e.current;if(!u)return;const d=()=>{const h=getComputedStyle(u),p=u.clientWidth-parseFloat(h.paddingLeft)-parseFloat(h.paddingRight);s(p)},f=new ResizeObserver(d);return f.observe(u),d(),()=>f.disconnect()},[]);const i=c.useMemo(()=>n.viewMode==="adaptive"?Wb(r,t,n):Qb(r,t,n),[r,t,n.viewMode,n.gap,n.targetCell,n.aspect.w,n.aspect.h,n.captionH]),o=Bb({count:i.mode==="adaptive"?i.rows.length:i.rowCount,getScrollElement:()=>e.current,estimateSize:u=>i.mode==="adaptive"?i.rows[u].height:i.rowH,overscan:8}),l=o.getVirtualItems();return c.useEffect(()=>{o.measure()},[i,o]),{width:r,layout:i,rowVirtualizer:o,virtualRows:l}}function Yb(e,t,n,r){if(!e.length)return null;const s=n?e.findIndex(l=>l.path===n):0,i=Math.max(1,t);let o=s;if(r.key==="ArrowRight"||r.key==="d")o=Math.min(e.length-1,s+1);else if(r.key==="ArrowLeft"||r.key==="a")o=Math.max(0,s-1);else if(r.key==="ArrowDown"||r.key==="s")o=Math.min(e.length-1,s+i);else if(r.key==="ArrowUp"||r.key==="w")o=Math.max(0,s-i);else return r.key==="Enter"&&n?"open":null;return o}function Xb(e,t,n){const r=[];for(const s of e){if(t.mode==="adaptive"){const l=t.rows[s.index];if(!l)continue;for(const u of l.items)r.push(u.item.path);continue}const i=s.index*t.columns,o=n.slice(i,i+t.columns);for(const l of o)r.push(l.path)}return Array.from(new Set(r))}const qb=500,Gb=450,Jb=600,Zb=8;function eC(e){return Math.max(Gb,Math.min(Jb,e))}class tC{constructor(t){rt(this,"delayMs");rt(this,"moveTolerancePx");rt(this,"onLongPress");rt(this,"onCancel");rt(this,"timerId",null);rt(this,"activePointerId",null);rt(this,"startX",0);rt(this,"startY",0);rt(this,"lastEvent",null);rt(this,"fired",!1);this.delayMs=eC(t.delayMs??qb),this.moveTolerancePx=Math.max(0,t.moveTolerancePx??Zb),this.onLongPress=t.onLongPress,this.onCancel=t.onCancel}pointerDown(t){return(t.pointerType??"mouse")==="mouse"?!1:t.isPrimary===!1?(this.cancel("multitouch"),!1):this.activePointerId!=null&&this.activePointerId!==t.pointerId?(this.cancel("multitouch"),!1):(this.activePointerId=t.pointerId,this.startX=t.clientX,this.startY=t.clientY,this.lastEvent=t,this.fired=!1,this.clearTimer(),this.timerId=setTimeout(()=>{this.activePointerId==null||this.fired||this.lastEvent==null||(this.fired=!0,this.clearTimer(),this.onLongPress(this.lastEvent))},this.delayMs),!0)}pointerMove(t){if(!this.matchesPointer(t.pointerId)||this.fired)return;this.lastEvent=t;const n=t.clientX-this.startX,r=t.clientY-this.startY;Math.hypot(n,r)>this.moveTolerancePx&&this.cancel("movement")}pointerUp(t){if(!(t!=null&&!this.matchesPointer(t))){if(!this.fired){this.cancel("pointerup");return}this.reset()}}pointerCancel(t){t!=null&&!this.matchesPointer(t)||this.cancel("pointercancel")}cancelFromScroll(){this.cancel("scroll")}destroy(){this.cancel("cleanup")}matchesPointer(t){return this.activePointerId!=null&&this.activePointerId===t}clearTimer(){this.timerId!=null&&(clearTimeout(this.timerId),this.timerId=null)}reset(){this.clearTimer(),this.activePointerId=null,this.lastEvent=null,this.fired=!1}cancel(t){var r;const n=this.timerId!=null&&!this.fired&&t!=="cleanup";this.reset(),n&&((r=this.onCancel)==null||r.call(this,t))}}function nC(e){return e==="touch"||e==="pen"}function rC(e){return e.multiSelectMode||e.isShift||e.isToggle||!nC(e.pointerType)?!1:e.selectedPaths.length===1&&e.selectedPaths[0]===e.path}function jm(e,t){return e.includes(t)?e.filter(n=>n!==t):[...e,t]}const fr=12,sC=44,iC={w:4,h:3},oC=350,lC=120;function aC(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Mm(e){return{pointerId:e.pointerId,pointerType:e.pointerType,clientX:e.clientX,clientY:e.clientY,isPrimary:e.isPrimary}}function uC(e,t){var s,i;let n=0,r=e.length-1;for(;n<=r;){const o=n+r>>1,l=e[o],u=((s=l.items[0])==null?void 0:s.originalIndex)??-1,d=((i=l.items[l.items.length-1])==null?void 0:i.originalIndex)??-1;if(t>=u&&t<=d)return o;t<u?r=o-1:n=o+1}return 0}function cC(e,t){const n=(t??"").trim();if(!n)return e;const r=e.toLowerCase().indexOf(n.toLowerCase());if(r===-1)return e;const s=e.slice(0,r),i=e.slice(r,r+n.length),o=e.slice(r+n.length);return a.jsxs(a.Fragment,{children:[s,a.jsx("mark",{className:"bg-accent/20 text-inherit rounded px-0.5",children:i}),o]})}function dC({items:e,selected:t,restoreToSelectionToken:n,multiSelectMode:r=!1,onSelectionChange:s,onOpenViewer:i,onContextMenuItem:o,onOpenItemActions:l,highlight:u,recentlyUpdated:d,onVisiblePathsChange:f,suppressSelectionHighlight:h=!1,viewMode:p="grid",targetCellSize:S=220,scrollRef:w,hideScrollbar:E=!1}){const[j,v]=c.useState(null),[m,x]=c.useState(null),[y,k]=c.useState(!1),[R,M]=c.useState(null),[N,O]=c.useState(null),T=c.useRef(null),X=c.useRef(null),J=c.useRef(null),z=w??J,le=c.useRef(null),Q=c.useRef(new Set),A=c.useRef(null),_=c.useRef(null),P=c.useRef(null),D=c.useRef(null),H=c.useRef({path:null,pointerType:null}),te=S,{width:se,layout:I,rowVirtualizer:U,virtualRows:Y}=Kb(z,e,{gap:fr,targetCell:te,aspect:iC,captionH:sC,viewMode:p}),Z=c.useMemo(()=>{const $=new Map;for(let ee=0;ee<e.length;ee++)$.set(e[ee].path,ee);return $},[e]),q=c.useMemo(()=>{if(I.mode!=="adaptive")return null;const $=new Map;return I.rows.forEach((ee,K)=>{let me=0;ee.items.forEach((ve,ge)=>{const pe=me+ve.displayW/2;$.set(ve.item.path,{row:K,center:pe,order:ge}),me+=ve.displayW+fr})}),$},[I]);c.useEffect(()=>{if(!t.length)return;const $=t[0];R!==$&&M($)},[t,R]);const ne=c.useMemo(()=>{if(I.mode!=="adaptive")return null;let $=0;return I.rows.map(ee=>{const K=$;return $+=ee.height,{start:K,height:ee.height}})},[I]),fe=c.useRef(null),je=($,ee)=>{try{if(fe.current!=null){try{cancelAnimationFrame(fe.current)}catch{}fe.current=null}const K=$.scrollTop,me=ee-K;if(Math.abs(me)<1){$.scrollTop=ee;return}const ve=140,ge=performance.now(),pe=we=>1-Math.pow(1-we,3),ke=we=>{const at=Math.min(1,(we-ge)/ve),Oe=pe(at);$.scrollTop=K+me*Oe,at<1?fe.current=requestAnimationFrame(ke):fe.current=null};fe.current=requestAnimationFrame(ke)}catch{$.scrollTop=ee}},[xe,De]=c.useState(!1);c.useEffect(()=>{const $=z.current;if(!$)return;let ee=0;const K=()=>{var me;(me=A.current)==null||me.cancelFromScroll(),De(!0),window.clearTimeout(ee),ee=window.setTimeout(()=>De(!1),lC)};return $.addEventListener("scroll",K,{passive:!0}),()=>$.removeEventListener("scroll",K)},[]),c.useEffect(()=>{const $=new tC({onLongPress:ee=>{const K=_.current;if(!K||!l)return;const me=P.current??{x:ee.clientX,y:ee.clientY};l(K,me),D.current={path:K,untilMs:Date.now()+700}}});return A.current=$,()=>{$.destroy(),A.current===$&&(A.current=null)}},[l]);const be=()=>{X.current!=null&&(window.clearTimeout(X.current),X.current=null)},Ie=()=>{if(be(),k(!1),v(null),T.current){try{URL.revokeObjectURL(T.current)}catch{}T.current=null}x(null)},lt=$=>{xe||(be(),v($),k(!1),X.current=window.setTimeout(async()=>{X.current=null;try{const ee=await Se.getFile($),K=URL.createObjectURL(ee);if(T.current)try{URL.revokeObjectURL(T.current)}catch{}T.current=K,x(K),k(!0)}catch{}},oC))},gt=I.mode==="grid"?I.columns:Math.max(1,Math.floor(se/(te+fr))),hn=($,ee)=>{if(I.mode!=="adaptive")return null;const K=I.rows[$];if(!K)return null;let me=0,ve=null;for(const ge of K.items){const pe=me+ge.displayW/2,ke=Math.abs(pe-ee);(!ve||ke<ve.dist)&&(ve={path:ge.item.path,dist:ke}),me+=ge.displayW+fr}return ve?ve.path:null},Bn=($,ee)=>{var Oe,Me,jt,vn;if(!e.length)return null;const K=$??e[0].path;if(I.mode!=="adaptive"){const Rn=Yb(e,gt,K,ee);return Rn==="open"||Rn==null?Rn:((Oe=e[Rn])==null?void 0:Oe.path)??null}const me=q==null?void 0:q.get(K);if(!me)return K;const ve=Z.get(K)??0,ge=ee.key;if(ge==="Enter")return"open";if(ge==="ArrowRight"||ge==="d")return((Me=e[Math.min(e.length-1,ve+1)])==null?void 0:Me.path)??K;if(ge==="ArrowLeft"||ge==="a")return((jt=e[Math.max(0,ve-1)])==null?void 0:jt.path)??K;const pe=ge==="ArrowDown"||ge==="s"?1:ge==="ArrowUp"||ge==="w"?-1:0;if(pe===0)return null;const ke=me.row+pe;if(ke<0||ke>=(((vn=I.rows)==null?void 0:vn.length)??0))return K;const we=me.center;return hn(ke,we)??K},Gt=$=>{var ee;try{(ee=document.getElementById(`cell-${encodeURIComponent($)}`))==null||ee.focus()}catch{}},Ze=c.useCallback($=>{try{Se.prefetchThumb($)}catch{}},[]),Jt=c.useCallback(($,ee)=>{l==null||l($,ee)},[l]),zt=()=>{_.current=null,P.current=null},pn=($,ee)=>{var K;ee.target.closest("[data-grid-action]")||(H.current={path:$,pointerType:ee.pointerType},!r&&(_.current=$,P.current={x:ee.clientX,y:ee.clientY},(K=A.current)==null||K.pointerDown(Mm(ee))))},Un=$=>{var ee;r||(P.current={x:$.clientX,y:$.clientY},(ee=A.current)==null||ee.pointerMove(Mm($)))},Hn=$=>{var ee;r||((ee=A.current)==null||ee.pointerUp($.pointerId),zt())},$t=$=>{var ee;r||((ee=A.current)==null||ee.pointerCancel($.pointerId),zt())},Qe=($,ee)=>{const K=D.current;if(K&&K.path===$&&K.untilMs>Date.now()){D.current=null,Gt($);return}K&&K.untilMs<=Date.now()&&(D.current=null),M($),O($);const me=!!ee.shiftKey,ve=!!(ee.ctrlKey||ee.metaKey);if(r)s(jm(t,$)),le.current=$;else if(rC({pointerType:H.current.path===$?H.current.pointerType:null,multiSelectMode:r,isShift:me,isToggle:ve,selectedPaths:t,path:$}))s([$]),le.current=$,i($);else if(me){const ge=le.current??R??t[0]??$,pe=Z.get(ge)??e.findIndex(we=>we.path===ge),ke=Z.get($)??e.findIndex(we=>we.path===$);if(pe!==-1&&ke!==-1){const we=Math.min(pe,ke),at=Math.max(pe,ke),Oe=e.slice(we,at+1).map(Me=>Me.path);if(ve){const Me=new Set(t);for(const jt of Oe)Me.add(jt);s(Array.from(Me))}else s(Oe)}else s([$])}else ve?(s(jm(t,$)),le.current=$):(s([$]),le.current=$);xe||Ze($),Gt($)},Nt=($,ee)=>{var K,me;try{const ve=mn.has($)&&t.length>0?t:[$];(K=ee.dataTransfer)==null||K.setData("application/x-lenslet-paths",JSON.stringify(ve)),ee.dataTransfer&&(ee.dataTransfer.effectAllowed="copyMove");try{document.body.classList.add("drag-active")}catch{}const pe=ee.currentTarget.querySelector(".cell-content img"),ke=document.createElement("div");ke.className="drag-ghost";const we=document.createElement("img");we.draggable=!1,we.alt="drag",pe&&pe.src&&(we.src=pe.src),ke.appendChild(we),document.body.appendChild(ke);const at=ke.getBoundingClientRect().width||150;(me=ee.dataTransfer)==null||me.setDragImage(ke,Math.round(at/2),0);const Oe=()=>{try{ke.remove()}catch{}try{document.body.classList.remove("drag-active")}catch{}window.removeEventListener("dragend",Oe),window.removeEventListener("pointerup",Oe),document.removeEventListener("visibilitychange",Oe)};window.addEventListener("dragend",Oe),window.addEventListener("pointerup",Oe),document.addEventListener("visibilitychange",Oe)}catch{}};c.useEffect(()=>{const $=z.current;if(!$)return;const ee=K=>{var Oe,Me,jt;const me=Bn(N,K);if(me==null)return;if(K.preventDefault(),me==="open"){N&&i(N);return}const ve=e.find(vn=>vn.path===me);if(!ve)return;O(ve.path),M(ve.path),s([ve.path]),le.current=ve.path;const ge=I.mode==="grid"?Math.floor((Z.get(ve.path)??0)/Math.max(1,I.columns)):((Oe=q==null?void 0:q.get(ve.path))==null?void 0:Oe.row)??0,pe=$.scrollTop,ke=pe+$.clientHeight,we=I.mode==="adaptive"?((Me=ne==null?void 0:ne[ge])==null?void 0:Me.start)??0:ge*I.rowH,at=I.mode==="adaptive"?we+(((jt=ne==null?void 0:ne[ge])==null?void 0:jt.height)??0):we+I.rowH;(we<pe||at>ke)&&je($,we),Gt(ve.path)};return $.addEventListener("keydown",ee),()=>{$.removeEventListener("keydown",ee)}},[e,N,gt,i,I,q,ne,Z]),c.useLayoutEffect(()=>{var ge;const $=z.current;if(!$||!n||t.length===0)return;const ee=t[0],K=Z.get(ee);if(K==null||K<0)return;const me=I.mode==="grid"?Math.floor(K/Math.max(1,I.columns)):uC(I.rows,K),ve=I.mode==="adaptive"?((ge=ne==null?void 0:ne[me])==null?void 0:ge.start)??0:me*I.rowH;try{$.scrollTop=ve}catch{}},[n,I,ne]);const mn=c.useMemo(()=>new Set(t),[t]),Zt=!!(j&&m&&y),en=c.useMemo(()=>Xb(Y,I,e),[e,I,Y]);c.useEffect(()=>{if(!(xe||en.length===0))for(const $ of en)Ze($)},[xe,en,Ze]),c.useEffect(()=>{var $;($=z.current)==null||$.focus()},[]),c.useEffect(()=>{var $;if(h){try{($=z.current)==null||$.blur()}catch{}O(null)}},[h]);const gn=c.useMemo(()=>{const $=new Set;for(const ee of Y){if(I.mode==="adaptive"){const ve=I.rows[ee.index];if(!ve)continue;for(const ge of ve.items)$.add(ge.item.path);continue}const K=ee.index*I.columns,me=Math.min(e.length,K+I.columns);for(let ve=K;ve<me;ve+=1){const ge=e[ve];ge&&$.add(ge.path)}}return $},[e,I,Y]);c.useEffect(()=>{f&&(aC(Q.current,gn)||(Q.current=gn,f(gn)))},[f,gn]);const Vn=N?`cell-${encodeURIComponent(N)}`:void 0;return a.jsx("div",{role:"grid","aria-label":"Gallery",className:`relative h-full overflow-auto p-3 outline-none ${E?"scrollbar-hidden pr-4":"scrollbar-thin"} ${Zt?"cursor-zoom-in":""}`,ref:z,tabIndex:0,"aria-activedescendant":Vn,onMouseDown:()=>{var $;return($=z.current)==null?void 0:$.focus()},style:{"--gap":`${fr}px`},children:a.jsxs("div",{className:"relative w-full",style:{height:U.getTotalSize()},children:[Y.map($=>{var ge;let ee=[],K={},me="";if(I.mode==="adaptive"){const pe=I.rows[$.index];if(!pe)return null;ee=pe.items,K={height:pe.height,transform:`translate3d(0, ${$.start}px, 0)`,display:"flex",gap:fr,paddingBottom:fr},me="absolute top-0 left-0 right-0 w-full will-change-transform"}else{const pe=$.index*I.columns;ee=e.slice(pe,pe+I.columns).map(we=>({item:we,displayW:I.cellW,displayH:I.mediaH})),K={transform:`translate3d(0, ${$.start}px, 0)`,gridTemplateColumns:`repeat(${I.columns}, minmax(0, 1fr))`,gap:fr,paddingBottom:fr},me="absolute top-0 left-0 right-0 w-full grid will-change-transform"}const ve=$.index===((ge=Y[0])==null?void 0:ge.index);return a.jsx("div",{className:me,role:"row",style:K,children:ee.map(({item:pe,displayW:ke,displayH:we})=>{const at=!h&&(R===pe.path||mn.has(pe.path)),Oe=(d==null?void 0:d.get(pe.path))??null,Me=Oe!=null,jt=I.mode==="adaptive"?{width:ke}:{},vn=I.mode==="adaptive"?{height:we}:{},Rn=I.mode==="adaptive"?"relative rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group shrink-0":"relative aspect-[4/3] rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group";return a.jsxs("div",{id:`cell-${encodeURIComponent(pe.path)}`,className:`relative min-w-0 ${at?"outline outline-2 outline-accent outline-offset-2 rounded-[10px]":""}`,role:"gridcell","aria-selected":at,tabIndex:N===pe.path?0:-1,onFocus:()=>O(pe.path),draggable:!0,style:jt,onDragStart:Te=>Nt(pe.path,Te),onPointerDown:Te=>pn(pe.path,Te),onPointerMove:Un,onPointerUp:Hn,onPointerCancel:$t,onContextMenu:Te=>{Te.preventDefault(),Te.stopPropagation(),o==null||o(Te,pe.path)},children:[a.jsxs("div",{className:Rn,style:vn,onDoubleClick:()=>{r||i(pe.path)},onMouseLeave:Ie,children:[a.jsx("button",{type:"button",className:"grid-item-action-btn touch-manipulation","data-grid-action":"1","aria-label":`Open actions for ${pe.name}`,"aria-haspopup":"menu",onPointerDown:Te=>Te.stopPropagation(),onClick:Te=>{Te.stopPropagation();const vt=Te.currentTarget.getBoundingClientRect();Jt(pe.path,{x:vt.right-4,y:vt.bottom-4})},children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})}),a.jsx("div",{className:"cell-content absolute inset-0",children:a.jsx(Rb,{path:pe.path,name:pe.name,selected:at,highlighted:Me,highlightKey:Oe,displayW:ke,displayH:we,ioRoot:z.current,isScrolling:xe,priority:ve,onClick:Te=>Qe(pe.path,Te)})}),a.jsx("div",{className:"absolute right-0 bottom-0 w-7 h-7 cursor-zoom-in",onMouseEnter:()=>lt(pe.path),onMouseLeave:Ie,children:a.jsx("div",{className:"grid-item-preview-corner absolute right-0 bottom-0 h-[18px] w-[18px] flex items-center justify-center text-text select-none",style:{clipPath:'path("M0 9C0 4.02944 4.02944 0 9 0H18V18H0V9Z")',background:"linear-gradient(135deg, rgba(18,18,18,0.9) 0%, rgba(34,34,34,0.9) 60%, rgba(22,22,22,0.9) 100%)",borderTop:"1px solid rgba(255,255,255,0.08)",borderLeft:"1px solid rgba(255,255,255,0.08)",boxShadow:"0 1px 2px rgba(0,0,0,0.45)",backdropFilter:"blur(1px)"},children:a.jsxs("svg",{width:"11",height:"11",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round",className:"text-[#d9dce2]","aria-hidden":"true",style:{transform:"translate(0px,0px)"},children:[a.jsx("circle",{cx:"11",cy:"11",r:"5.4"}),a.jsx("path",{d:"M15.5 15.5 L19 19"})]})})})]}),a.jsxs("div",{className:"flex flex-col items-center text-center gap-0 mt-1 px-0.5 text-white/90",children:[a.jsx("div",{className:"text-sm leading-[18px] thumb-filename line-clamp-2 break-words hyphens-auto text-center",title:pe.name,children:cC(pe.name,u)}),a.jsxs("div",{className:"text-[11px] leading-[15px] opacity-70",children:[pe.w,"  ",pe.h]})]})]},pe.path)})},$.key)}),j&&m&&y&&Ou.createPortal(a.jsx("div",{className:"toolbar-offset fixed inset-0 z-[999] flex items-center justify-center pointer-events-none bg-black/20 opacity-100",children:a.jsx("img",{src:m,alt:"preview",className:"max-w-[80vw] max-h-[80vh] object-contain opacity-[0.98]"})}),document.body)]},`${p}-${gt}`)})}const fC=48,hC=[.1,.24,.5,.74,.9];function pC({items:e,metricKey:t,scrollRef:n,sortDir:r}){const{orderedValues:s,numericValues:i}=c.useMemo(()=>{var T;const N=[],O=[];for(const X of e){const J=(T=X.metrics)==null?void 0:T[t],z=J==null||Number.isNaN(J)?null:J;N.push(z),z!=null&&O.push(z)}return{orderedValues:N,numericValues:O}},[e,t]),o=c.useMemo(()=>mC(i,fC),[i]),l=c.useMemo(()=>gC(i,hC),[i]),[u,d]=c.useState(0),[f,h]=c.useState(null),[p,S]=c.useState(!1),w=c.useRef(null);if(c.useEffect(()=>{const N=n.current;if(!N)return;const O=()=>{const T=Math.max(1,N.scrollHeight-N.clientHeight),X=Ps(T>0?N.scrollTop/T:0);d(X)};return O(),N.addEventListener("scroll",O,{passive:!0}),window.addEventListener("resize",O),()=>{N.removeEventListener("scroll",O),window.removeEventListener("resize",O)}},[n,e.length]),c.useEffect(()=>{h(null)},[t,e.length]),!o)return null;const E={min:o.min,max:o.max},j=f!=null?Pm(f):null,v=Pm(u),m=r==="desc",x=c.useMemo(()=>f==null?null:xC(s,f),[s,f]);function y(N){h(Ps(N))}function k(){h(null)}function R(N){const O=n.current;if(!O)return;const T=Math.max(0,O.scrollHeight-O.clientHeight);O.scrollTop=Ps(N)*T}function M(N){var T;const O=(T=w.current)==null?void 0:T.getBoundingClientRect();return O?Ps((N.clientY-O.top)/O.height):null}return a.jsxs("div",{className:"absolute right-0 top-3 bottom-3 w-[14px] flex items-stretch pointer-events-auto",children:[a.jsxs("svg",{ref:w,viewBox:"0 0 10 100",preserveAspectRatio:"none",className:"w-full h-full rounded bg-surface-inset border border-border/60 cursor-ns-resize",onPointerDown:N=>{var T;N.preventDefault();const O=M(N);O!=null&&(S(!0),y(O),R(O),(T=w.current)==null||T.setPointerCapture(N.pointerId))},onPointerMove:N=>{const O=M(N);if(O==null){p||k();return}y(O),p&&R(O)},onPointerUp:N=>{var O;S(!1),(O=w.current)==null||O.releasePointerCapture(N.pointerId)},onPointerLeave:()=>{p||k()},children:[vC(o.bins,"var(--border-strong)",{flip:m}),yC(l,E,{flip:m,color:"var(--muted)"}),Rm(v,{color:"var(--highlight)",strokeWidth:.8}),j!=null&&Rm(j,{color:"var(--text-secondary)",strokeWidth:.6,dashed:!0})]}),x!=null&&f!=null&&a.jsx("div",{className:"pointer-events-none absolute right-full mr-2 px-1.5 py-0.5 rounded border border-border bg-surface text-[10px] text-text shadow",style:{top:`calc(${(f*100).toFixed(2)}% - 8px)`},children:SC(x)})]})}function mC(e,t){if(!e.length)return null;const n=Math.min(...e);let r=Math.max(...e);n===r&&(r=n+1);const s=new Array(t).fill(0),i=t/(r-n);for(const o of e){const l=Math.max(0,Math.min(t-1,Math.floor((o-n)*i)));s[l]+=1}return{bins:s,min:n,max:r}}function gC(e,t){if(!e.length)return[];const n=[...e].sort((s,i)=>s-i),r=n.length-1;return t.map(s=>{const i=r*s,o=Math.floor(i),l=Math.ceil(i);if(o===l)return n[o];const u=i-o;return n[o]+(n[l]-n[o])*u})}function vC(e,t,n){const r=Math.max(1,...e),s=100/e.length,i=(n==null?void 0:n.flip)??!1;return e.map((o,l)=>{const u=Math.max(.8,o/r*10),d=(i?e.length-1-l:l)*s;return a.jsx("rect",{x:10-u,y:d,width:u,height:Math.max(.2,s-.2),fill:t,opacity:.9},`sb-${l}`)})}function yC(e,t,n){const r=(n==null?void 0:n.flip)??!1,s=n==null?void 0:n.color;return e.map((i,o)=>{const l=wC(i,t,r),u=o===2;return a.jsx("line",{x1:0,y1:l,x2:10,y2:l,stroke:s,strokeWidth:u?.8:.5,opacity:u?.9:.6,vectorEffect:"non-scaling-stroke"},`qt-${o}-${i}`)})}function Rm(e,t){return a.jsx("line",{x1:0,y1:e,x2:10,y2:e,stroke:t.color,strokeWidth:t.strokeWidth??.6,strokeDasharray:t.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}function xC(e,t){if(!e.length)return null;const n=Math.round(Ps(t)*(e.length-1)),r=e[n];if(r!=null)return r;for(let s=1;s<e.length;s++){const i=n-s;if(i>=0&&e[i]!=null)return e[i];const o=n+s;if(o<e.length&&e[o]!=null)return e[o]}return null}function wC(e,t,n){const r=t.max-t.min;if(r===0)return 0;const s=Ps((e-t.min)/r);return(n?1-s:s)*100}function Pm(e){return Ps(e)*100}function Ps(e){return e<0?0:e>1?1:e}function SC(e){if(e==null||Number.isNaN(e))return"-";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function Ts(e,t){const[n,r]=c.useState(null),s=c.useRef(null);return c.useEffect(()=>{if(!e){if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}r(null);return}let i=!0;return e().then(o=>{if(!i)return;const l=URL.createObjectURL(o);if(s.current)try{URL.revokeObjectURL(s.current)}catch{}s.current=l,r(l)}).catch(()=>{}),()=>{i=!1}},t),c.useEffect(()=>()=>{if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}},[]),n}const bC=1.2,CC=.05,kC=8;function Tc(e){return Number(Math.min(kC,Math.max(CC,e)).toFixed(4))}function Tm(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Lm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function EC(e,t){try{e.setPointerCapture(t)}catch{}}function NC(e,t){try{e.releasePointerCapture(t)}catch{}}function jC(){const[e,t]=c.useState(1),[n,r]=c.useState(0),[s,i]=c.useState(0),[o,l]=c.useState(1),[u,d]=c.useState(!1),[f,h]=c.useState(!1),[p,S]=c.useState(!1),w=c.useRef(null),E=c.useRef(null),j=c.useRef(1),v=c.useRef(0),m=c.useRef(0),x=c.useRef(new Map),y=c.useRef(null),k=c.useRef(null),R=(_,P)=>{v.current=_,m.current=P,r(_),i(P)},M=_=>{const P=Tc(_);j.current=P,t(P)},N=(_,P)=>{y.current={pointerId:_,startX:P.x,startY:P.y,startTx:v.current,startTy:m.current},k.current=null,h(!0)},O=()=>{const _=Array.from(x.current.entries());if(_.length<2)return;const[P,D]=_,[H,te]=P,[se,I]=D,U=Tm(te,I);!Number.isFinite(U)||U<=2||(k.current={pointerIds:[H,se],startDistance:U,startCenter:Lm(te,I),startScale:j.current,startTx:v.current,startTy:m.current},y.current=null,h(!0))},T=()=>{const _=w.current,P=E.current;if(!_||!P||!P.naturalWidth||!P.naturalHeight)return;const D=_.getBoundingClientRect(),H=D.width/P.naturalWidth,te=D.height/P.naturalHeight,se=Math.min(1,Math.min(H,te));l(se);const I=P.naturalWidth*se,U=P.naturalHeight*se;R((D.width-I)/2,(D.height-U)/2),M(1)};c.useEffect(()=>{const _=w.current;if(!_)return;const P=new ResizeObserver(()=>{try{requestAnimationFrame(()=>T())}catch{T()}});return P.observe(_),()=>P.disconnect()},[]),c.useEffect(()=>{j.current=e,v.current=n,m.current=s},[e,n,s]),c.useEffect(()=>()=>{x.current.clear(),y.current=null,k.current=null},[]);const X=_=>{_.preventDefault();const P=_.deltaY>0?-1:1,D=w.current;if(!D)return;const H=D.getBoundingClientRect(),te=_.clientX-H.left,se=_.clientY-H.top,I=j.current,U=Tc(I*Math.pow(bC,P));if(U===I)return;const Y=U/I,Z=te-Y*(te-v.current),q=se-Y*(se-m.current);M(U),R(Z,q)},J=_=>{if((_.pointerType??"mouse")==="mouse"&&_.button!==0)return;const D=x.current,H=E.current;if(!H||D.size===0&&_.target!==H)return;const te=_.currentTarget,se=te.getBoundingClientRect();if(!(_.clientX<se.left||_.clientX>se.right||_.clientY<se.top||_.clientY>se.bottom)){if(_.preventDefault(),_.stopPropagation(),D.set(_.pointerId,{x:_.clientX,y:_.clientY}),EC(te,_.pointerId),D.size>=2){O();return}N(_.pointerId,{x:_.clientX,y:_.clientY})}},z=_=>{const P=x.current;if(!P.has(_.pointerId))return;P.set(_.pointerId,{x:_.clientX,y:_.clientY});const D=k.current;if(D){const I=P.get(D.pointerIds[0]),U=P.get(D.pointerIds[1]);if(I&&U){const Y=Tm(I,U);if(Y>2){const Z=Lm(I,U),q=Tc(D.startScale*(Y/D.startDistance)),ne=q/D.startScale,fe=Z.x-ne*(D.startCenter.x-D.startTx),je=Z.y-ne*(D.startCenter.y-D.startTy);M(q),R(fe,je)}}return}const H=y.current;if(!H||H.pointerId!==_.pointerId)return;const te=_.clientX-H.startX,se=_.clientY-H.startY;R(H.startTx+te,H.startTy+se)},le=(_,P)=>{const D=x.current;if(!D.has(_))return;if(D.delete(_),NC(P,_),D.size===0){y.current=null,k.current=null,h(!1);return}if(D.size>=2){O();return}const[H,te]=D.entries().next().value;N(H,te)};return{scale:e,setScale:t,tx:n,setTx:r,ty:s,setTy:i,base:o,setBase:l,ready:u,setReady:d,dragging:f,setDragging:h,visible:p,setVisible:S,containerRef:w,imgRef:E,fitAndCenter:T,handleWheel:X,handlePointerDown:J,handlePointerMove:z,handlePointerUp:_=>{le(_.pointerId,_.currentTarget)},handlePointerCancel:_=>{le(_.pointerId,_.currentTarget)}}}function MC({path:e,onClose:t,onNavigate:n,canPrev:r=!1,canNext:s=!1,onZoomChange:i,requestedZoomPercent:o,onZoomRequestConsumed:l}){const{scale:u,setScale:d,tx:f,setTx:h,ty:p,setTy:S,base:w,ready:E,setReady:j,dragging:v,visible:m,setVisible:x,containerRef:y,imgRef:k,fitAndCenter:R,handleWheel:M,handlePointerDown:N,handlePointerMove:O,handlePointerUp:T,handlePointerCancel:X}=jC(),J=Ts(()=>Se.getFile(e),[e]),z=Ts(()=>Se.getThumb(e),[e]),le=c.useCallback(()=>{x(!1),window.setTimeout(t,110)},[t,x]);return c.useEffect(()=>{requestAnimationFrame(()=>{var Q;x(!0),(Q=y.current)==null||Q.focus()})},[e]),c.useEffect(()=>{const Q=A=>{A.key==="Escape"?le():(A.key==="ArrowRight"||A.key==="d")&&n?n(1):(A.key==="ArrowLeft"||A.key==="a")&&n&&n(-1)};return window.addEventListener("keydown",Q),()=>window.removeEventListener("keydown",Q)},[le,n]),c.useEffect(()=>{j(!1)},[J]),c.useEffect(()=>{i&&i(w*u*100)},[w,u,i]),c.useEffect(()=>{if(o==null)return;const Q=y.current;if(!Q){l&&l();return}const A=Math.max(.05,Math.min(8,o/100/Math.max(1e-6,w))),_=Q.getBoundingClientRect(),P=_.width/2,D=_.height/2;d(H=>{const te=A/H;return h(se=>P-te*(P-se)),S(se=>D-te*(D-se)),Number(A.toFixed(4))}),l&&l()},[o,w,l]),a.jsxs("div",{ref:y,role:"dialog","aria-modal":!0,"aria-label":"Image viewer",tabIndex:-1,className:`toolbar-offset touch-none absolute inset-0 left-[var(--left)] right-[var(--right)] flex items-start justify-start bg-panel z-viewer overflow-hidden transition-opacity duration-[110ms] ease-out cursor-grab focus:outline-none focus-visible:outline-none ${v?"cursor-grabbing select-none":""} ${m?"opacity-100":"opacity-0"}`,style:{outline:"none"},onClick:le,onWheel:M,onPointerDown:N,onPointerMove:O,onPointerUp:T,onPointerCancel:X,onKeyDown:Q=>{Q.key==="Tab"&&Q.preventDefault()},children:[a.jsxs("button",{"aria-label":"Close",onClick:Q=>{Q.stopPropagation(),le()},className:"btn btn-sm absolute top-3 right-3 z-10",title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]}),z&&a.jsx("img",{src:z,alt:"thumb",className:"absolute top-0 left-0 max-w-none max-h-none object-contain pointer-events-none transition-opacity duration-[110ms] ease-out",draggable:!1,onDragStart:Q=>Q.preventDefault(),style:{transform:`translate(${f}px, ${p}px) scale(${w})`,transformOrigin:"0 0",opacity:E?0:.5,filter:"blur(0.25px)"}}),J&&a.jsx("img",{ref:k,src:J,alt:"viewer",className:"max-w-none max-h-none object-contain transition-opacity duration-[110ms] ease-out will-change-transform select-none",draggable:!1,onDragStart:Q=>{Q.preventDefault()},onLoad:Q=>{R(),d(1);try{requestAnimationFrame(()=>j(!0))}catch{j(!0)}},onClick:Q=>Q.stopPropagation(),style:{transform:`translate(${f}px, ${p}px) scale(${w*u})`,transformOrigin:"0 0",opacity:E?.99:0,WebkitUserDrag:"none"}}),n&&a.jsxs("div",{className:"viewer-mobile-nav",onClick:Q=>Q.stopPropagation(),children:[a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${r?"":"is-disabled"}`,onClick:()=>r&&n(-1),"aria-label":"Previous image","aria-disabled":!r,disabled:!r,children:"Prev"}),a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${s?"":"is-disabled"}`,onClick:()=>s&&n(1),"aria-label":"Next image","aria-disabled":!s,disabled:!s,children:"Next"})]})]})}function mh(e){return!e||!(e instanceof HTMLElement)?!1:e.closest('input, textarea, [contenteditable="true"]')!==null}const RC=1.2,PC=.05,TC=8;function Lc(e){return Number(Math.min(TC,Math.max(PC,e)).toFixed(4))}function _m(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Im(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function LC(e,t){try{e.setPointerCapture(t)}catch{}}function _C(e,t){try{e.releasePointerCapture(t)}catch{}}function IC(){const[e,t]=c.useState(1),[n,r]=c.useState(0),[s,i]=c.useState(0),[o,l]=c.useState(0),[u,d]=c.useState(0),[f,h]=c.useState(1),[p,S]=c.useState(1),[w,E]=c.useState(!1),j=c.useRef(null),v=c.useRef(null),m=c.useRef(null),x=c.useRef(1),y=c.useRef(0),k=c.useRef(0),R=c.useRef(0),M=c.useRef(0),N=c.useRef(new Map),O=c.useRef(null),T=c.useRef(null),X=c.useCallback(I=>{y.current=I.txA,k.current=I.tyA,R.current=I.txB,M.current=I.tyB,r(I.txA),i(I.tyA),l(I.txB),d(I.tyB)},[]),J=c.useCallback(I=>{const U=Lc(I);x.current=U,t(U)},[]),z=c.useCallback((I,U)=>{O.current={pointerId:I,startX:U.x,startY:U.y,startTxA:y.current,startTyA:k.current,startTxB:R.current,startTyB:M.current},T.current=null,E(!0)},[]),le=c.useCallback(()=>{const I=Array.from(N.current.entries());if(I.length<2)return;const[U,Y]=I,[Z,q]=U,[ne,fe]=Y,je=_m(q,fe);!Number.isFinite(je)||je<=2||(T.current={pointerIds:[Z,ne],startDistance:je,startCenter:Im(q,fe),startScale:x.current,startTxA:y.current,startTyA:k.current,startTxB:R.current,startTyB:M.current},O.current=null,E(!0))},[]),Q=c.useCallback((I,U)=>{const Y=N.current;if(!Y.has(I))return;if(Y.delete(I),_C(U,I),Y.size===0){O.current=null,T.current=null,E(!1);return}if(Y.size>=2){le();return}const[Z,q]=Y.entries().next().value;z(Z,q)},[z,le]),A=c.useCallback(()=>{const I=j.current;if(!I)return;const U=I.getBoundingClientRect(),Y=ne=>{if(!ne||!ne.naturalWidth||!ne.naturalHeight)return;const fe=U.width/ne.naturalWidth,je=U.height/ne.naturalHeight,xe=Math.min(1,Math.min(fe,je)),De=ne.naturalWidth*xe,be=ne.naturalHeight*xe;return{base:xe,tx:(U.width-De)/2,ty:(U.height-be)/2}},Z=Y(v.current);Z&&(h(Z.base),y.current=Z.tx,k.current=Z.ty,r(Z.tx),i(Z.ty));const q=Y(m.current);q&&(S(q.base),R.current=q.tx,M.current=q.ty,l(q.tx),d(q.ty))},[]);c.useEffect(()=>{const I=j.current;if(!I)return;const U=new ResizeObserver(()=>{try{requestAnimationFrame(()=>A())}catch{A()}});return U.observe(I),()=>U.disconnect()},[A]);const _=c.useCallback(()=>{J(1),A()},[A,J]);c.useEffect(()=>{x.current=e,y.current=n,k.current=s,R.current=o,M.current=u},[e,n,s,o,u]),c.useEffect(()=>()=>{N.current.clear(),O.current=null,T.current=null},[]);const P=c.useCallback(I=>{I.preventDefault();const U=I.deltaY>0?-1:1,Y=j.current;if(!Y)return;const Z=Y.getBoundingClientRect(),q=I.clientX-Z.left,ne=I.clientY-Z.top,fe=x.current,je=Lc(fe*Math.pow(RC,U));if(je===fe)return;const xe=je/fe;J(je),X({txA:q-xe*(q-y.current),tyA:ne-xe*(ne-k.current),txB:q-xe*(q-R.current),tyB:ne-xe*(ne-M.current)})},[X,J]),D=c.useCallback(I=>{if((I.pointerType??"mouse")==="mouse"&&I.button!==0)return;const Y=I.currentTarget;if(I.preventDefault(),N.current.set(I.pointerId,{x:I.clientX,y:I.clientY}),LC(Y,I.pointerId),N.current.size>=2){le();return}z(I.pointerId,{x:I.clientX,y:I.clientY})},[z,le]),H=c.useCallback(I=>{const U=N.current;if(!U.has(I.pointerId))return;U.set(I.pointerId,{x:I.clientX,y:I.clientY});const Y=T.current;if(Y){const fe=U.get(Y.pointerIds[0]),je=U.get(Y.pointerIds[1]);if(fe&&je){const xe=_m(fe,je);if(xe>2){const De=Im(fe,je),be=Lc(Y.startScale*(xe/Y.startDistance)),Ie=be/Y.startScale;J(be),X({txA:De.x-Ie*(Y.startCenter.x-Y.startTxA),tyA:De.y-Ie*(Y.startCenter.y-Y.startTyA),txB:De.x-Ie*(Y.startCenter.x-Y.startTxB),tyB:De.y-Ie*(Y.startCenter.y-Y.startTyB)})}}return}const Z=O.current;if(!Z||Z.pointerId!==I.pointerId)return;const q=I.clientX-Z.startX,ne=I.clientY-Z.startY;X({txA:Z.startTxA+q,tyA:Z.startTyA+ne,txB:Z.startTxB+q,tyB:Z.startTyB+ne})},[X,J]),te=c.useCallback(I=>{Q(I.pointerId,I.currentTarget)},[Q]),se=c.useCallback(I=>{Q(I.pointerId,I.currentTarget)},[Q]);return{scale:e,baseA:f,baseB:p,txA:n,tyA:s,txB:o,tyB:u,dragging:w,containerRef:j,imgARef:v,imgBRef:m,fitAndCenter:A,resetView:_,handleWheel:P,handlePointerDown:D,handlePointerMove:H,handlePointerUp:te,handlePointerCancel:se}}function FC({aItem:e,bItem:t,index:n,total:r,canPrev:s,canNext:i,onNavigate:o,onClose:l}){const u=c.useRef(null),[d,f]=c.useState(50),[h,p]=c.useState(!1),[S,w]=c.useState(!1),{scale:E,baseA:j,baseB:v,txA:m,tyA:x,txB:y,tyB:k,dragging:R,containerRef:M,imgARef:N,imgBRef:O,fitAndCenter:T,resetView:X,handleWheel:J,handlePointerDown:z,handlePointerMove:le,handlePointerUp:Q,handlePointerCancel:A}=IC(),_=(e==null?void 0:e.path)??null,P=(t==null?void 0:t.path)??null,D=(e==null?void 0:e.name)??_??"Select an image",H=(t==null?void 0:t.name)??P??"Select another image";c.useEffect(()=>{requestAnimationFrame(()=>{var ne;return(ne=u.current)==null?void 0:ne.focus()})},[_,P]),c.useEffect(()=>{X(),p(!1),w(!1)},[_,P,X]),c.useEffect(()=>{const ne=fe=>{if(!mh(fe.target)){if(fe.key==="Escape"){fe.preventDefault(),l();return}if((fe.key==="ArrowRight"||fe.key==="d")&&i){fe.preventDefault(),o(1);return}(fe.key==="ArrowLeft"||fe.key==="a")&&s&&(fe.preventDefault(),o(-1))}};return window.addEventListener("keydown",ne),()=>window.removeEventListener("keydown",ne)},[l,o,s,i]);const te=Ts(_?()=>Se.getFile(_):null,[_]),se=Ts(P?()=>Se.getFile(P):null,[P]),I=Ts(_?()=>Se.getThumb(_):null,[_]),U=Ts(P?()=>Se.getThumb(P):null,[P]),Y=c.useCallback(ne=>Math.min(95,Math.max(5,ne)),[]),Z=c.useCallback(ne=>{const fe=ne.target;fe!=null&&fe.closest(".compare-label")||fe!=null&&fe.closest(".compare-divider-hit")||z(ne)},[z]),q=c.useCallback(ne=>{const fe=M.current;if(!fe)return;ne.preventDefault(),ne.stopPropagation();const je=fe.getBoundingClientRect(),xe=ne.currentTarget;xe.setPointerCapture(ne.pointerId);const De=Ie=>{const lt=(Ie.clientX-je.left)/je.width*100;f(Y(lt))},be=Ie=>{try{xe.releasePointerCapture(Ie.pointerId)}catch{}window.removeEventListener("pointermove",De),window.removeEventListener("pointerup",be),window.removeEventListener("pointercancel",be)};window.addEventListener("pointermove",De),window.addEventListener("pointerup",be),window.addEventListener("pointercancel",be)},[Y]);return a.jsxs("div",{ref:u,role:"dialog","aria-modal":!0,"aria-label":"Compare images",tabIndex:-1,className:"toolbar-offset absolute inset-0 left-[var(--left)] right-[var(--right)] bg-panel z-viewer flex flex-col overflow-hidden focus:outline-none",onKeyDown:ne=>{ne.key==="Tab"&&ne.preventDefault()},children:[a.jsxs("div",{className:"compare-header flex items-center gap-3 px-3 py-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Compare"}),a.jsx("div",{className:"text-xs text-muted",children:r>=2?`${n+1}-${Math.min(n+2,r)} of ${r}`:"Select 2 images"}),a.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(-1),disabled:!s,title:"Previous (Left Arrow or A)",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Prev"]}),a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(1),disabled:!i,title:"Next (Right Arrow or D)",children:["Next",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"btn btn-sm",onClick:l,title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]})]})]}),a.jsx("div",{className:"flex-1 min-h-0 p-3 bg-panel",children:a.jsx("div",{ref:M,className:`compare-stage ${R?"is-dragging":""}`,onWheel:J,onPointerDown:Z,onPointerMove:le,onPointerUp:Q,onPointerCancel:A,children:!e||!t?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-sm text-muted",children:"Select 2 images to compare."}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"compare-label left-3",children:[a.jsx("span",{className:"compare-label-tag",children:"A"}),a.jsx("span",{className:"truncate",title:e.path,children:D})]}),a.jsxs("div",{className:"compare-label right-3",children:[a.jsx("span",{className:"compare-label-tag",children:"B"}),a.jsx("span",{className:"truncate",title:t.path,children:H})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 ${100-d}% 0 0)`},children:[I&&a.jsx("img",{src:I,alt:"thumb A",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:ne=>ne.preventDefault(),style:{transform:`translate(${m}px, ${x}px) scale(${j})`,transformOrigin:"0 0",opacity:h?0:.5}}),te&&a.jsx("img",{ref:N,src:te,alt:"compare A",className:"compare-image",draggable:!1,onDragStart:ne=>ne.preventDefault(),onLoad:()=>{T();try{requestAnimationFrame(()=>p(!0))}catch{p(!0)}},style:{transform:`translate(${m}px, ${x}px) scale(${j*E})`,transformOrigin:"0 0",opacity:h?.99:0}})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 0 0 ${d}%)`},children:[U&&a.jsx("img",{src:U,alt:"thumb B",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:ne=>ne.preventDefault(),style:{transform:`translate(${y}px, ${k}px) scale(${v})`,transformOrigin:"0 0",opacity:S?0:.5}}),se&&a.jsx("img",{ref:O,src:se,alt:"compare B",className:"compare-image",draggable:!1,onDragStart:ne=>ne.preventDefault(),onLoad:()=>{T();try{requestAnimationFrame(()=>w(!0))}catch{w(!0)}},style:{transform:`translate(${y}px, ${k}px) scale(${v*E})`,transformOrigin:"0 0",opacity:S?.99:0}})]}),a.jsxs("div",{className:"compare-divider-hit",style:{left:`${d}%`},onPointerDown:q,children:[a.jsx("div",{className:"compare-divider-line"}),a.jsx("div",{className:"compare-divider-handle"})]})]})})})]})}function zu(){const[e,t]=c.useState(kb());return c.useEffect(()=>Cb(t),[]),e}const ml=e=>["item",e],OC={v:1,tags:[],notes:"",version:1,updated_at:"",updated_by:"web"},Tn=new Map,Oa=new Map,tf=new Map,gh=new Map;let Fm=0;const sr=new Map,Ao=new Map,AC=12e3,nf=new Set,rf=new Set;let vh={state:"idle"},gl=null,sf=0;function ma(e){vh=e;for(const t of nf)t(e)}function Cr(){const e=sr.size>0,t=Tn.size+Oa.size+sf;if(e){ma({state:"error",message:"Conflict detected"});return}if(gl){ma({state:"error",message:gl});return}if(t>0){ma({state:"syncing"});return}ma({state:"idle"})}function yh(){let e=null;for(const t of tf.values())e=e==null?t:Math.min(e,t);for(const t of gh.values())e=e==null?t:Math.min(e,t);return e}function pu(){const e=yh();for(const t of rf)t(e)}function mu(e){gl=e,Cr()}function kx(){gl&&(gl=null,Cr())}function Om(e){sf=Math.max(0,sf+e),Cr()}function DC(){Fm+=1;const e=Fm;return gh.set(e,Date.now()),pu(),e}function zC(e){e!=null&&gh.delete(e)&&pu()}function $u(e){const t=Ao.get(e);if(!t||!t.size)return;const n=sr.get(e)??null;for(const r of t)r(n)}function Am(e){return sr.get(e)??null}function Bu(e){sr.delete(e)&&($u(e),Cr())}function $C(e,t){sr.set(e,t),$u(e),Cr()}function BC(e,t){const n=Ao.get(e)??new Set;return n.add(t),Ao.set(e,n),t(sr.get(e)??null),()=>{const r=Ao.get(e);r&&(r.delete(t),r.size||Ao.delete(e))}}function UC(e){const[t,n]=c.useState(()=>e?Am(e):null);return c.useEffect(()=>{if(!e){n(null);return}return n(Am(e)),BC(e,n)},[e]),t}function HC(e){return nf.add(e),e(vh),()=>{nf.delete(e)}}function VC(){const[e,t]=c.useState(vh);return c.useEffect(()=>HC(t),[]),e}function WC(e){return rf.add(e),e(yh()),()=>{rf.delete(e)}}function QC(){const[e,t]=c.useState(()=>yh()),[n,r]=c.useState(()=>e==null?null:Date.now()-e);return c.useEffect(()=>WC(t),[]),c.useEffect(()=>{if(e==null){r(null);return}r(Date.now()-e);const s=window.setInterval(()=>{r(Date.now()-e)},1e3);return()=>window.clearInterval(s)},[e]),n}function of(e){const t={};return Object.prototype.hasOwnProperty.call(e,"star")&&(t.set_star=e.star??null),Object.prototype.hasOwnProperty.call(e,"notes")&&(t.set_notes=e.notes??""),Object.prototype.hasOwnProperty.call(e,"tags")&&(t.set_tags=Array.isArray(e.tags)?e.tags:[]),t}function lf(e){var t,n;return e.set_star!==void 0||e.set_notes!==void 0||e.set_tags!==void 0||(((t=e.add_tags)==null?void 0:t.length)??0)>0||(((n=e.remove_tags)==null?void 0:n.length)??0)>0}function jo(e){const t=[],n=new Set;for(const r of e??[]){if(typeof r!="string")continue;const s=r.trim();!s||n.has(s)||(n.add(s),t.push(s))}return t}function KC(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function YC(e,t){if(e.set_star!==void 0&&(t.star??null)!==e.set_star||e.set_notes!==void 0&&(t.notes??"")!==(e.set_notes??""))return!1;if(e.set_tags!==void 0){const r=jo(e.set_tags),s=jo(t.tags);return KC(r,s)}const n=jo(t.tags);for(const r of jo(e.add_tags))if(!n.includes(r))return!1;for(const r of jo(e.remove_tags))if(n.includes(r))return!1;return!0}function Ex(e,t,n){if(n instanceof un&&n.status===409){const r=n.body;if(r!=null&&r.current)return $C(e,{path:e,current:r.current,pending:t,receivedAt:new Date().toISOString()}),!0}return!1}function XC(e,t){const n=sr.get(e);if(n){if(YC(n.pending,t)){Bu(e);return}sr.set(e,{...n,current:t}),$u(e),Cr()}}function qC(e){const t=zu();return Au({queryKey:ml(e),queryFn:()=>Se.getSidecar(e),enabled:!!e,staleTime:3e4,gcTime:5*6e4,retry:2,refetchInterval:t?AC:!1,refetchIntervalInBackground:t})}function GC(e){const t=Zs();return BS({mutationFn:async({patch:n,baseVersion:r,idempotencyKey:s})=>{const i=of(n);if(!lf(i))return t.getQueryData(ml(e))??OC;const o={...i,base_version:r};try{return await Se.patchSidecar(e,o,{idempotencyKey:s??pl("patch"),ifMatch:r})}catch(l){throw Ex(e,i,l),l}},retry:(n,r)=>r instanceof un&&r.status===409?!1:n<2,retryDelay:n=>Math.min(1e3*Math.pow(2,n),4e3),onMutate:()=>(kx(),Om(1),{inflightId:DC()}),onSuccess:n=>{Bu(e),t.setQueryData(ml(e),n)},onError:n=>{n instanceof un&&n.status===409||(n instanceof un?mu(n.message):mu("Failed to save"))},onSettled:(n,r,s,i)=>{Om(-1),zC(i==null?void 0:i.inflightId)}})}const JC=6;async function Dm(e,t){if(!e.length)return;let n=0;const r=[],s=async()=>{for(;n<e.length;){const o=n++,l=e[o];try{await Nx(l,t)}catch(u){r.push({path:l,error:u}),console.error(`[bulkUpdateSidecars] Failed for ${l}:`,u)}}},i=Array.from({length:Math.min(JC,e.length)},()=>s());if(await Promise.all(i),r.length===e.length)throw new Error(`All ${e.length} sidecar updates failed`)}async function Nx(e,t){const n=Tn.get(e)||{};Tn.set(e,{...n,...t}),kx(),Cr();const r=Oa.get(e);if(r)return r;tf.set(e,Date.now()),pu();const s=(async()=>{try{for(;Tn.has(e);){const i=Tn.get(e);if(!i)break;const o=of(i);if(!lf(o)){Tn.get(e)===i&&Tn.delete(e);continue}let l=1;try{l=(await Se.getSidecar(e)).version??1}catch{l=1}const u={...o,base_version:l};try{await Se.patchSidecar(e,u,{idempotencyKey:pl("patch"),ifMatch:l}),Bu(e),Tn.get(e)===i&&Tn.delete(e)}catch(d){if(Ex(e,o,d)){const h=Tn.get(e);if(h&&h!==i){const p=of(h);if(lf(p)){const S=sr.get(e);S&&(sr.set(e,{...S,pending:p}),$u(e))}}Tn.delete(e)}else d instanceof un?mu(d.message):mu("Failed to save");throw d}}}finally{Oa.delete(e),tf.delete(e),pu(),Cr()}})();return Oa.set(e,s),Cr(),s}function _c(e){const t=["B","KB","MB","GB","TB"];let n=0,r=e;for(;r>=1024&&n<t.length-1;)r/=1024,n+=1;return`${r.toFixed(1)} ${t[n]}`}function Ic(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function ZC(e,t=28){if(e.length<=t)return e;const n=Math.max(4,Math.floor((t-1)/2));return`${e.slice(0,n)}${e.slice(-n)}`}const ek=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"});function tk(e){const t=e.trim();return!t||/[zZ]|[+-]\d{2}:?\d{2}$/.test(t)?t:`${t.includes("T")?t:t.replace(" ","T")}Z`}function jx(e){if(!e)return null;const t=Date.parse(tk(e));return Number.isFinite(t)?t:null}function nk(e,t=Date.now()){const n=Math.max(0,t-e),r=Math.max(1,Math.floor(n/1e3));if(r<60)return`${r} second${r===1?"":"s"} ago`;const s=Math.floor(r/60);if(s<60)return`${s} minute${s===1?"":"s"} ago`;const i=Math.floor(s/60);return`${i} hour${i===1?"":"s"} ago`}function rk(e){return ek.format(new Date(e))}function sk(e,t){const n=ik(e)||"view",r=new Set(t.map(i=>i.id));if(!r.has(n))return n;let s=2;for(;r.has(`${n}-${s}`);)s+=1;return`${n}-${s}`}function ik(e){return e.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function Fc(e){const t=e.filter(s=>s>0).sort((s,i)=>i-s),n=e.includes(0),r=[...t.map(s=>String(s))];return n&&r.push("None"),r.join(", ")}function ok(e,t){return e&&t?`${e} to ${t}`:e?`from ${e}`:t?`to ${t}`:""}function lk(e){if(e==="/"||e==="")return"Root";const t=e.split("/").filter(Boolean);return t.length?t.length<=2?`/${t.join("/")}`:`.../${t.slice(-2).join("/")}`:"Root"}function ak(e,t,n,r){return!n||r?t:e==="/"||e===""?e||"/":n===e||n.startsWith(`${e}/`)?e:t}function uk(e,t){return`${zm(e)}${zm(t)}`}function zm(e){const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function ck(e){const t=e.toLowerCase();return t.endsWith(".png")?"image/png":t.endsWith(".webp")?"image/webp":"image/jpeg"}function dk(e,t){const n=e.split("/").pop()??e;return{path:e,name:n,type:ck(e),w:0,h:0,size:0,hasThumb:!0,hasMeta:!1,star:t??null}}function Ko(e,t){const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}const $m=2,Bm=120,Um=!0;function fk(e){return e.replace(/[\u0000-\u001f\u007f]/g,"").trim()}function hk(e){const n=e.replace(/\r\n?/g,`
`).replace(/\n+$/g,"");return n?n.split(`
`):[]}function pk(e){const{pathA:t,pathB:n,labelsText:r,embedMetadata:s,reverseOrder:i}=e;if(!t||!n)return{ok:!1,message:"Comparison export requires both A and B image paths."};const o=hk(r);if(o.length>$m)return{ok:!1,message:`Enter at most ${$m} label lines (line 1 = A, line 2 = B).`};const l=o.map(h=>fk(h));if(l.some(h=>h.length>Bm))return{ok:!1,message:`Each label must be at most ${Bm} characters.`};const d=l.some(h=>h.length>0)?l:void 0,f={v:1,paths:[t,n],embed_metadata:s,reverse_order:i};return d&&(f.labels=d),{ok:!0,payload:f}}function Mo(e){return String(e).padStart(2,"0")}function mk(e,t=new Date){const n=t.getUTCFullYear(),r=Mo(t.getUTCMonth()+1),s=Mo(t.getUTCDate()),i=Mo(t.getUTCHours()),o=Mo(t.getUTCMinutes()),l=Mo(t.getUTCSeconds());return`comparison${e?"_reverse":""}_${n}${r}${s}_${i}${o}${l}.png`}function Ai(e){if(Array.isArray(e))return e.map(Ai);if(e&&typeof e=="object")return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,Ai(n)]));if(typeof e=="string"){const t=e.trim();if(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]")||t.startsWith('"')&&t.endsWith('"'))try{const r=JSON.parse(t);return Ai(r)}catch{return e}}return e}function Ro(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function gk(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function Hm(e){return e.split(",").map(t=>t.trim()).filter(Boolean)}const ga=2;function Yo(e,t,n){if(e===null)return'<span style="color:var(--json-literal)">null</span>';if(e===void 0)return'<span style="color:var(--json-fallback)">undefined</span>';if(typeof e=="string")return`<span style="color:var(--json-string)">${Ro(JSON.stringify(e))}</span>`;if(typeof e=="number")return`<span style="color:var(--json-number)">${Ro(String(e))}</span>`;if(typeof e=="boolean")return`<span style="color:var(--json-literal)">${e?"true":"false"}</span>`;if(Array.isArray(e)){if(e.length===0)return"[]";const r=" ".repeat(n),s=" ".repeat(n+ga);let i=`[
`;return e.forEach((o,l)=>{const u=Yo(o,[...t,l],n+ga);i+=`${s}${u}${l<e.length-1?",":""}
`}),i+=`${r}]`,i}if(Uu(e)){const r=Object.keys(e);if(!r.length)return"{}";const s=" ".repeat(n),i=" ".repeat(n+ga);let o=`{
`;return r.forEach((l,u)=>{const d=Ro(JSON.stringify([...t,l])),f=Ro(JSON.stringify(l)),h=`<span class="ui-json-key" data-json-path='${d}' style="color:var(--json-key)">${f}</span>`,p=Yo(e[l],[...t,l],n+ga);o+=`${i}${h}: ${p}${u<r.length-1?",":""}
`}),o+=`${s}}`,o}return`<span style="color:var(--json-fallback)">${Ro(String(e))}</span>`}function Oc(e,t){if(!e)return null;const n=Ai(e);if(!t&&Uu(n)&&"pil_info"in n){const r={};for(const[s,i]of Object.entries(n))r[s]=s==="pil_info"?"Hidden (toggle Show PIL info to expand)":i;return r}return n}function gu(e){return e==null?String(e):typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):Array.isArray(e)?`[${e.map(gu).join(",")}]`:typeof e=="object"?`{${Object.entries(e).sort(([n],[r])=>n.localeCompare(r)).map(([n,r])=>`${n}:${gu(r)}`).join(",")}}`:String(e)}function va(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return String(e);try{return JSON.stringify(e,null,1)}catch{return String(e)}}function Uu(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function Mx(e){return e==="pil_info"||e.startsWith("pil_info.")||e.startsWith("pil_info[")}function af(e,t){if(typeof t=="number")return e?`${e}[${t}]`:`[${t}]`;const n=/^[A-Za-z0-9_$-]+$/.test(t);return e?n?`${e}.${t}`:`${e}["${t}"]`:n?t:`["${t}"]`}function Ac(e){let t="";for(const n of e)t=af(t,n);return t||"(root)"}function Dc(e,t){let n=e;for(const r of t){if(typeof r=="number"){if(!Array.isArray(n))return;n=n[r];continue}if(!Uu(n))return;n=n[r]}return n}function Vm(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e;try{return JSON.stringify(e,null,1)}catch{return String(e)}}function vu(e,t,n,r,s){if(s.skipPilInfo&&Mx(t))return;const i=t||"(root)";if(r>=s.maxDepth){n.set(i,e);return}if(Array.isArray(e)){if(!e.length){n.set(i,[]);return}if(e.length>s.maxArray){n.set(i,e);return}e.forEach((o,l)=>vu(o,af(t,l),n,r+1,s));return}if(Uu(e)){const o=Object.keys(e).sort((l,u)=>l.localeCompare(u));if(!o.length){n.set(t||"(root)",{});return}for(const l of o)s.skipPilInfo&&!t&&l==="pil_info"||vu(e[l],af(t,l),n,r+1,s);return}n.set(i,e)}const vk=["overview","compare","basics","metadata","notes"],Wm="lenslet.inspector.sections",Qm="lenslet.inspector.metricsExpanded",zc=12,Km=120,yk=8,xk=80,wk={overview:!0,compare:!0,metadata:!0,basics:!0,notes:!0};function Po({title:e,open:t,onToggle:n,actions:r,children:s,contentClassName:i}){const[o,l]=c.useState(t),[u,d]=c.useState(t?"open":"closed");return c.useEffect(()=>{if(t){l(!0);const h=window.requestAnimationFrame(()=>d("open"));return()=>window.cancelAnimationFrame(h)}d("closing");const f=window.setTimeout(()=>{l(!1),d("closed")},140);return()=>window.clearTimeout(f)},[t]),a.jsxs("div",{className:"border-b border-border/60",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[a.jsxs("button",{type:"button",onClick:n,"aria-expanded":t,className:"flex items-center gap-2 inspector-section-title hover:text-text transition-colors",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`transition-transform ${t?"rotate-90":""}`,"aria-hidden":"true",children:a.jsx("path",{d:"m9 18 6-6-6-6"})}),a.jsx("span",{children:e})]}),r]}),o&&a.jsx("div",{className:"inspector-section-body","data-state":u,"aria-hidden":!t,children:a.jsx("div",{className:i??"px-3 pb-3",children:s})})]})}function Sk({path:e,selectedPaths:t=[],items:n=[],compareActive:r=!1,compareA:s=null,compareB:i=null,onResize:o,onStarChanged:l,sortSpec:u,onFindSimilar:d,embeddingsAvailable:f=!1,embeddingsLoading:h=!1,onLocalTypingChange:p}){const S=!!e,{data:w,isLoading:E}=qC(e??""),j=GC(e??""),v=Zs(),[m,x]=c.useState(wk),y=c.useCallback(F=>{x(ie=>({...ie,[F]:!ie[F]}))},[]),[k,R]=c.useState(!1),M=t.length>1,N=!!d&&f&&!M,O=d?f?M?"Select a single image to search.":null:h?"Loading embeddings...":"No embeddings detected.":null,[T,X]=c.useState(""),[J,z]=c.useState(""),[le,Q]=c.useState(null),[A,_]=c.useState(null),[P,D]=c.useState("idle"),[H,te]=c.useState(!1),[se,I]=c.useState(null),U=c.useRef(null),[Y,Z]=c.useState(!1),[q,ne]=c.useState("idle"),[fe,je]=c.useState(null),[xe,De]=c.useState(null),[be,Ie]=c.useState(null),[lt,gt]=c.useState(!1),[hn,Bn]=c.useState(!1),[Gt,Ze]=c.useState(!1),[Jt,zt]=c.useState(null),[pn,Un]=c.useState(null),[Hn,$t]=c.useState(null),Qe=c.useRef(null),Nt=c.useRef(0),[mn,Zt]=c.useState(""),[en,gn]=c.useState(Um),[Vn,$]=c.useState(null),[ee,K]=c.useState(null),[me,ve]=c.useState(null),[ge,pe]=c.useState({}),ke=c.useRef(!1),we=c.useCallback(F=>{ke.current!==F&&(ke.current=F,p==null||p(F))},[p]),Oe=c.useMemo(()=>{var ie;return((ie=n.find(de=>de.path===e))==null?void 0:ie.star)??null},[n,e])??(w==null?void 0:w.star)??null,Me=UC(M?null:e),jt={tags:!!(Me!=null&&Me.pending.set_tags),notes:(Me==null?void 0:Me.pending.set_notes)!==void 0,star:(Me==null?void 0:Me.pending.set_star)!==void 0},vn=c.useMemo(()=>{const F=new Set(t);return n.filter(ie=>F.has(ie.path))},[n,t]),Rn=c.useMemo(()=>vn.reduce((F,ie)=>F+(ie.size||0),0),[vn]);c.useEffect(()=>{w&&(X((w.tags||[]).join(", ")),z(w.notes||"")),Q(null),_(null),D("idle"),te(!1),I(null),U.current&&(window.clearTimeout(U.current),U.current=null),Z(!1),we(!1)},[w==null?void 0:w.updated_at,we,e]),c.useEffect(()=>()=>{U.current&&(window.clearTimeout(U.current),U.current=null),Qe.current&&(window.clearTimeout(Qe.current),Qe.current=null),we(!1)},[we]);const Te=c.useCallback(F=>{if(M&&t.length){Dm(t,F);return}if(!e)return;const ie=(w==null?void 0:w.version)??1;j.mutate({patch:F,baseVersion:ie,idempotencyKey:pl("patch")})},[M,t,e,w==null?void 0:w.version,j]),vt=c.useCallback(F=>{z(F),we(!0)},[we]),hs=c.useCallback(()=>{Te({notes:J}),we(!1)},[Te,J,we]),Hu=c.useCallback(F=>{X(F),we(!0)},[we]),jl=c.useCallback(()=>{Te({tags:Hm(T)}),we(!1)},[Te,we,T]),tn=c.useCallback(()=>{if(!Me||!e)return;const F={};Me.pending.set_tags!==void 0&&(F.tags=Hm(T)),Me.pending.set_notes!==void 0&&(F.notes=J),Me.pending.set_star!==void 0&&(F.star=Oe??null);const ie=Me.current.version??1;j.mutate({patch:F,baseVersion:ie,idempotencyKey:pl("patch")})},[Me,e,T,J,Oe,j]),Ml=c.useCallback(()=>{if(!Me||!e)return;const F=Me.current;X((F.tags||[]).join(", ")),z(F.notes||""),v.setQueryData(ml(e),F),Bu(e),l==null||l([e],F.star??null)},[Me,e,v,l]);c.useEffect(()=>{if(!e)return;const F=ie=>{if(mh(ie.target))return;const de=ie.key;if(!/^[0-5]$/.test(de))return;ie.preventDefault();const ue=de==="0"?null:Number(de);if(M&&t.length){Te({star:ue}),l==null||l(t,ue);return}Te({star:ue}),l==null||l([e],ue)};return window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[e,M,t,Te,l]);const Rl=Ts(e?()=>Se.getThumb(e):null,[e]),ir=e?e.split("/").pop()||e:"",or=c.useMemo(()=>{var ie;if(ir.includes("."))return ir.slice(ir.lastIndexOf(".")+1).toUpperCase();const F=n.find(de=>de.path===e);return(ie=F==null?void 0:F.type)!=null&&ie.includes("/")?F.type.split("/")[1].toUpperCase():""},[ir,n,e]),yt=c.useMemo(()=>n.find(F=>F.path===e),[n,e]),ps=c.useMemo(()=>e?(yt==null?void 0:yt.source)??e:"",[yt,e]),nn=(s==null?void 0:s.path)??null,rn=(i==null?void 0:i.path)??null,lr=r&&!!nn&&!!rn,ms=(s==null?void 0:s.name)??nn??"A",ei=(i==null?void 0:i.name)??rn??"B",Vu=c.useCallback(async()=>{if(e){D("loading"),_(null);try{const F=await Se.getMetadata(e);Q(F.meta),D("loaded")}catch(F){const ie=F instanceof Error?F.message:"Failed to load metadata";Q(null),_(ie),D("error")}}},[e]),ti=c.useCallback(async(F,ie)=>{const de=Nt.current+1;Nt.current=de,ne("loading"),je(null);try{const[ue,Le]=await Promise.all([Se.getMetadata(F),Se.getMetadata(ie)]);if(Nt.current!==de)return;De(ue.meta),Ie(Le.meta),ne("loaded")}catch(ue){if(Nt.current!==de)return;const Le=ue instanceof Error?ue.message:"Failed to load metadata";De(null),Ie(null),je(Le),ne("error")}},[]);c.useEffect(()=>{if(!lr||!nn||!rn){Nt.current+=1,ne("idle"),je(null),De(null),Ie(null),Bn(!1),Ze(!1),zt(null),Un(null),$t(null),Zt(""),gn(Um),$(null),K(null);return}gt(!1),Bn(!1),Ze(!1),zt(null),Un(null),$t(null),$(null),K(null),ti(nn,rn)},[lr,nn,rn,ti]);const ni=c.useMemo(()=>{if(!le)return"";try{return JSON.stringify(le,null,1)}catch{return""}},[le]),ar=c.useMemo(()=>Oc(le,Y),[le,Y]),gs=c.useMemo(()=>{if(!xe)return"";try{return JSON.stringify(xe,null,1)}catch{return""}},[xe]),ao=c.useMemo(()=>{if(!be)return"";try{return JSON.stringify(be,null,1)}catch{return""}},[be]),vs=c.useMemo(()=>Oc(xe,hn),[xe,hn]),ys=c.useMemo(()=>Oc(be,Gt),[be,Gt]),et=c.useCallback(()=>{var F;ni&&((F=navigator.clipboard)==null||F.writeText(ni).then(()=>{te(!0),setTimeout(()=>te(!1),1200)}).catch(ie=>{const de=ie instanceof Error?ie.message:"Copy failed";_(de)}))},[ni]),Pl=c.useMemo(()=>ar?Yo(ar,[],0):"",[ar]),ri=c.useMemo(()=>vs?Yo(vs,[],0):"",[vs]),Wn=c.useMemo(()=>ys?Yo(ys,[],0):"",[ys]),ur=c.useCallback(F=>{I(F),U.current&&window.clearTimeout(U.current),U.current=window.setTimeout(()=>{I(null),U.current=null},900)},[]),Bt=c.useCallback((F,ie)=>{var ue;const de=Vm(ie);(ue=navigator.clipboard)==null||ue.writeText(de).then(()=>{ur(F)}).catch(()=>{})},[ur]),Qn=c.useCallback((F,ie)=>{F==="A"?Un(ie):$t(ie),Qe.current&&window.clearTimeout(Qe.current),Qe.current=window.setTimeout(()=>{Un(null),$t(null),Qe.current=null},900)},[]),xs=c.useCallback((F,ie,de)=>{var Le;const ue=Vm(de);(Le=navigator.clipboard)==null||Le.writeText(ue).then(()=>{Qn(F,ie)}).catch(()=>{})},[Qn]),Tl=c.useCallback(F=>{if(!ar)return;const ie=F.target;if(!ie)return;const de=ie.closest("[data-json-path]");if(!de)return;const ue=de.getAttribute("data-json-path");if(!ue)return;let Le;try{Le=JSON.parse(ue)}catch{return}const Mt=Dc(ar,Le);Bt(Ac(Le),Mt)},[ar,Bt]),si=c.useCallback(F=>{if(!vs)return;const ie=F.target;if(!ie)return;const de=ie.closest("[data-json-path]");if(!de)return;const ue=de.getAttribute("data-json-path");if(!ue)return;let Le;try{Le=JSON.parse(ue)}catch{return}const Mt=Dc(vs,Le);xs("A",Ac(Le),Mt)},[vs,xs]),Pr=c.useCallback(F=>{if(!ys)return;const ie=F.target;if(!ie)return;const de=ie.closest("[data-json-path]");if(!de)return;const ue=de.getAttribute("data-json-path");if(!ue)return;let Le;try{Le=JSON.parse(ue)}catch{return}const Mt=Dc(ys,Le);xs("B",Ac(Le),Mt)},[ys,xs]),uo=c.useCallback(F=>{var de;const ie=F==="A"?gs:ao;ie&&((de=navigator.clipboard)==null||de.writeText(ie).then(()=>{zt(F),setTimeout(()=>zt(ue=>ue===F?null:ue),1200)}).catch(()=>{}))},[gs,ao]);let co=ar?"":"PNG metadata not loaded yet.";P==="loading"?co="Loading metadata":P==="error"&&A&&(co=A);let ii="Metadata not loaded yet.";q==="loading"?ii="Loading metadata":q==="error"&&fe&&(ii=fe);const Ll=P==="loading",Ut=P==="loaded"&&!!ni,fo=Ut?"h-48":"h-24";let xt="Load meta";Ll?xt="Loading":Ut&&(xt=H?"Copied":"Copy");const _l=Ut?et:Vu,yn=!!le&&typeof le=="object"&&!Array.isArray(le)&&"pil_info"in le,Ke=!!xe&&typeof xe=="object"&&!Array.isArray(xe)&&"pil_info"in xe,ws=!!be&&typeof be=="object"&&!Array.isArray(be)&&"pil_info"in be,ho=M?null:a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[Ut&&yn&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:()=>Z(F=>!F),disabled:!Ut,children:Y?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[78px]",onClick:_l,disabled:!e||Ll,children:xt})]}),xn=c.useCallback(()=>{!nn||!rn||ti(nn,rn)},[nn,rn,ti]),cr=Vn!==null,po=c.useCallback(async F=>{if(!nn||!rn){K("Comparison export requires two selected images.");return}if(cr)return;const ie=pk({pathA:nn,pathB:rn,labelsText:mn,embedMetadata:en,reverseOrder:F});if(!ie.ok){K(ie.message);return}$(F?"reverse":"normal"),K(null);try{const de=await Se.exportComparison(ie.payload);Ko(de,mk(F))}catch(de){const ue=de instanceof Error?de.message:"Failed to export comparison.";K(ue)}finally{$(null)}},[nn,rn,cr,en,mn]),Kn=c.useMemo(()=>{if(!xe||!be)return null;const F=Ai(xe),ie=Ai(be),de=new Map,ue=new Map,Le={maxDepth:yk,maxArray:xk,skipPilInfo:!lt};vu(F,"",de,0,Le),vu(ie,"",ue,0,Le);const Mt=new Set([...de.keys(),...ue.keys()]),Rt=[];let Ss=0,bs=0,tt=0;const dr=Array.from(Mt).sort((Pt,Lr)=>Pt.localeCompare(Lr)),Yn=!lt;for(const Pt of dr){if(Yn&&Mx(Pt))continue;const Lr=de.has(Pt),ui=ue.has(Pt);if(!Lr&&ui){bs+=1,Rt.push({key:Pt,kind:"onlyB",aText:"",bText:va(ue.get(Pt))});continue}if(Lr&&!ui){Ss+=1,Rt.push({key:Pt,kind:"onlyA",aText:va(de.get(Pt)),bText:""});continue}const Cs=de.get(Pt),mo=ue.get(Pt),Fl=gu(Cs),go=gu(mo);Fl!==go&&(tt+=1,Rt.push({key:Pt,kind:"different",aText:va(Cs),bText:va(mo)}))}const Il=Math.max(0,Rt.length-Km);return{entries:Il?Rt.slice(0,Km):Rt,onlyA:Ss,onlyB:bs,different:tt,truncatedCount:Il}},[xe,be,lt]);c.useEffect(()=>{try{const F=localStorage.getItem(Wm);if(!F)return;const ie=JSON.parse(F);if(!ie||typeof ie!="object")return;const de={};for(const ue of vk)typeof ie[ue]=="boolean"&&(de[ue]=ie[ue]);Object.keys(de).length>0&&x(ue=>({...ue,...de}))}catch{}},[]),c.useEffect(()=>{try{localStorage.setItem(Wm,JSON.stringify(m))}catch{}},[m]),c.useEffect(()=>{try{const F=localStorage.getItem(Qm);F==="1"||F==="true"?R(!0):(F==="0"||F==="false")&&R(!1)}catch{}},[]),c.useEffect(()=>{try{localStorage.setItem(Qm,k?"1":"0")}catch{}},[k]);const oi=c.useCallback((F,ie)=>{var de;ie&&((de=navigator.clipboard)==null||de.writeText(ie).then(()=>{ve(F),setTimeout(()=>ve(ue=>ue===F?null:ue),1e3)}).catch(()=>{}))},[]),Tr=c.useCallback((F,ie)=>{if(ie&&!ge[F]){const de=ie.offsetHeight;de&&pe(ue=>ue[F]?ue:{...ue,[F]:de})}},[ge]),li="toolbar-offset sidebar-resize-handle absolute bottom-0 left-0";return S?a.jsxs("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:[!M&&a.jsx("div",{className:"p-3 border-b border-border flex justify-center",children:a.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-border w-[220px] h-[160px] bg-panel select-none",children:[Rl&&a.jsx("img",{src:Rl,alt:"thumb",className:"block w-full h-full object-contain"}),!!or&&a.jsx("div",{className:"absolute top-1.5 left-1.5 bg-surface border border-border text-text text-xs px-1.5 py-0.5 rounded-md select-none",children:or})]})}),a.jsxs(Po,{title:M?"Selection":"Item",open:m.overview,onToggle:()=>y("overview"),contentClassName:"px-3 pb-3 space-y-2",actions:d&&a.jsx("button",{type:"button",className:"btn btn-sm",onClick:d,disabled:!N,title:O??"Find similar",children:"Find similar"}),children:[M?a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Selected"}),a.jsxs("div",{className:"inspector-field-value",children:[t.length," files"]})]}),a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Total size"}),a.jsx("div",{className:"inspector-field-value",children:_c(Rn)})]})]}):a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Filename"}),a.jsx("div",{className:"inspector-field-value break-all",title:ir,children:ir})]}),O&&a.jsx("div",{className:"text-[11px] text-muted",children:O})]}),r&&lr&&a.jsx(Po,{title:"Compare Metadata",open:m.compare,onToggle:()=>y("compare"),actions:a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:xn,disabled:q==="loading",children:q==="loading"?"Loading":"Reload"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:()=>gt(F=>!F),disabled:q!=="loaded",children:lt?"Hide PIL info":"Include PIL info"})]}),children:a.jsxs("div",{className:"space-y-2 text-[11px]",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] text-muted",children:[a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"A"}),a.jsx("div",{className:"text-text break-all",title:ms,children:ms})]}),a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"B"}),a.jsx("div",{className:"text-text break-all",title:ei,children:ei})]})]}),q==="loading"&&a.jsx("div",{className:"text-muted",children:"Loading metadata"}),q==="error"&&fe&&a.jsx("div",{className:"text-danger break-words",children:fe}),q==="loaded"&&Kn&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-muted",children:[a.jsxs("span",{children:[Kn.different," different  ",Kn.onlyA," only A  ",Kn.onlyB," only B"]}),a.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:"Deep paths"})]}),Kn.entries.length===0?a.jsx("div",{className:"text-muted",children:"No differences found."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2 text-[10px] uppercase tracking-wide text-muted",children:[a.jsx("div",{children:"Path"}),a.jsx("div",{children:"A"}),a.jsx("div",{children:"B"})]}),Kn.entries.map(F=>a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2",children:[a.jsx("div",{className:"text-[11px] text-muted font-mono break-all",children:F.key}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:F.aText}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:F.bText})]},F.key)),Kn.truncatedCount>0&&a.jsxs("div",{className:"text-muted text-[11px]",children:["+",Kn.truncatedCount," more differences not shown."]})]})]}),a.jsxs("div",{className:"grid gap-3 pt-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Metadata A"}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[Ke&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:()=>Bn(F=>!F),disabled:q!=="loaded",children:hn?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:()=>uo("A"),disabled:q!=="loaded",children:Jt==="A"?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[pn&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value: ",pn]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",onClick:si,children:q==="loaded"&&ri?a.jsx("code",{className:"block whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:ri}}):ii})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Metadata B"}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[ws&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:()=>Ze(F=>!F),disabled:q!=="loaded",children:Gt?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:()=>uo("B"),disabled:q!=="loaded",children:Jt==="B"?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[Hn&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value: ",Hn]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",onClick:Pr,children:q==="loaded"&&Wn?a.jsx("code",{className:"block whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:Wn}}):ii})]})]})]}),a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Export Comparison"}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full h-20 scrollbar-thin",placeholder:`Label for A
Label for B`,value:mn,onChange:F=>{Zt(F.target.value),K(null)},disabled:cr,"aria-label":"Comparison export labels"}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-[11px] text-muted",children:[a.jsx("input",{type:"checkbox",checked:en,onChange:F=>gn(F.target.checked),disabled:cr}),a.jsx("span",{children:"Embed metadata"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>{po(!1)},disabled:!lr||cr,children:Vn==="normal"?"Exporting":"Export comparison"}),a.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",onClick:()=>{po(!0)},disabled:!lr||cr,children:Vn==="reverse"?"Exporting":"Export (reverse order)"})]}),ee&&a.jsx("div",{className:"text-danger break-words",children:ee})]})]})}),a.jsxs(Po,{title:"Basics",open:m.basics,onToggle:()=>y("basics"),children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs mb-1",role:"radiogroup","aria-label":"Star rating",children:[a.jsx("span",{className:"ui-kv-label w-16 shrink-0",children:M?"Rating (all)":"Rating"}),a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(F=>{const ie=(Oe??0)>=F;return a.jsx("button",{className:`w-6 h-6 flex items-center justify-center rounded-lg border border-border/60 bg-transparent text-[13px] ${ie?"text-star-active":"text-star-inactive"} hover:border-border hover:text-star-hover transition-colors`,onClick:()=>{const de=Oe===F&&!M?null:F;M&&t.length?(l==null||l(t,de),Dm(t,{star:de})):e&&(l==null||l([e],de),Nx(e,{star:de}))},title:`${F} star${F>1?"s":""} (key ${F})`,"aria-label":`${F} star${F>1?"s":""}`,"aria-pressed":Oe===F,children:ie?"":""},F)})})]}),!M&&Me&&jt.star&&a.jsxs("div",{className:"ui-banner ui-banner-danger mt-2 text-[11px] flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Rating conflict."}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:tn,children:"Apply again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:Ml,children:"Keep theirs"})]})]}),!M&&yt&&a.jsxs("div",{className:"text-[12px] space-y-1.5 leading-relaxed",children:[a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>oi("dimensions",`${yt.w}${yt.h}`),children:"Dimensions"}),a.jsx("span",{className:"ui-kv-value inline-block text-right min-w-[80px]",ref:F=>Tr("dimensions",F),style:ge.dimensions?{minHeight:ge.dimensions}:void 0,children:me==="dimensions"?"Copied":`${yt.w}${yt.h}`})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>oi("size",_c(yt.size)),children:"Size"}),a.jsx("span",{className:"ui-kv-value inline-block text-right min-w-[80px]",ref:F=>Tr("size",F),style:ge.size?{minHeight:ge.size}:void 0,children:me==="size"?"Copied":_c(yt.size)})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>oi("type",yt.type),children:"Type"}),a.jsx("span",{className:"ui-kv-value break-all text-right inline-block min-w-[80px]",ref:F=>Tr("type",F),style:ge.type?{minHeight:ge.type}:void 0,children:me==="type"?"Copied":yt.type})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>ps&&oi("source",ps),children:"Source"}),a.jsx("span",{className:"ui-kv-value inspector-value-clamp break-words text-right max-w-[70%] inline-block min-w-[80px]",ref:F=>Tr("source",F),style:ge.source?{minHeight:ge.source}:void 0,title:ps,children:me==="source"?"Copied":ps})]}),(()=>{const F=yt.metrics||null;if(!F)return null;const ie=Object.entries(F).filter(([,tt])=>tt!=null);if(!ie.length)return null;const de=(u==null?void 0:u.kind)==="metric"?u.key:null,ue=[...ie].sort(([tt],[dr])=>tt.localeCompare(dr));let Le=ue;if(de){const tt=ue.findIndex(([dr])=>dr===de);tt>0&&(Le=[ue[tt],...ue.slice(0,tt),...ue.slice(tt+1)])}const Mt=Le.length>zc,Ss=k||!Mt?Le:Le.slice(0,zc),bs=Le.length-zc;return a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"ui-subsection-title mb-1",children:"Metrics"}),a.jsxs("div",{className:"space-y-1",children:[Ss.map(([tt,dr])=>{const Yn=de===tt;return a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:`w-24 shrink-0 ${Yn?"text-accent font-medium":"ui-kv-label"}`,children:tt}),a.jsx("span",{className:`ui-kv-value text-right ${Yn?"text-accent font-medium":""}`,children:gk(dr)})]},tt)}),Mt&&a.jsx("button",{type:"button",className:"text-[11px] text-muted underline underline-offset-2 hover:text-text",onClick:()=>R(tt=>!tt),"aria-expanded":k,children:k?"Show less":`+${bs} more`})]})]})})()]})]}),!M&&a.jsxs(Po,{title:"Metadata",open:m.metadata,onToggle:()=>y("metadata"),actions:ho,children:[a.jsxs("div",{className:"relative",children:[se&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value: ",se]}),a.jsx("pre",{className:`ui-code-block ui-code-block-resizable ${fo} overflow-auto whitespace-pre-wrap`,onClick:Tl,children:Ut?a.jsx("code",{className:"block whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:Pl}}):co})]}),A&&a.jsx("div",{className:"text-[11px] text-danger mt-1 break-words",children:A})]}),a.jsxs(Po,{title:"Notes & Tags",open:m.notes,onToggle:()=>y("notes"),contentClassName:"px-3 pb-3 space-y-2",children:[!M&&Me&&(jt.tags||jt.notes)&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Conflicting edits detected."}),a.jsx("div",{className:"text-[11px] text-muted mt-0.5",children:"Your changes were not saved because this item was updated elsewhere."}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:tn,children:"Apply my changes again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:Ml,children:"Keep theirs"})]})]}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full scrollbar-thin",placeholder:"Add notes",value:J,onChange:F=>vt(F.target.value),onBlur:hs,"aria-label":M?"Notes for selected items":"Notes"}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:M?"Tags (apply to all, comma-separated)":"Tags (comma-separated)"}),a.jsx("input",{className:"ui-input inspector-input w-full",placeholder:"tag1, tag2",value:T,onChange:F=>Hu(F.target.value),onBlur:jl,"aria-label":M?"Tags for selected items":"Tags"})]})]}),a.jsx("div",{className:li,onPointerDown:o})]}):a.jsx("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:a.jsx("div",{className:li,onPointerDown:o})})}function bk({open:e,embeddings:t,rejected:n=[],selectedPath:r,embeddingsLoading:s=!1,embeddingsError:i,onClose:o,onSearch:l}){const[u,d]=c.useState(""),[f,h]=c.useState("path"),[p,S]=c.useState(""),[w,E]=c.useState(""),[j,v]=c.useState("50"),[m,x]=c.useState(""),[y,k]=c.useState(null),[R,M]=c.useState(!1),N=c.useRef(null),O=c.useRef(null),T=c.useMemo(()=>t.find(A=>A.name===u)??t[0]??null,[t,u]);c.useEffect(()=>{e&&(k(null),t.length>0&&!t.some(A=>A.name===u)&&d(t[0].name),r?(h("path"),S(r)):(h("vector"),S("")))},[e,t,u,r]),c.useEffect(()=>{if(!e)return;const A=f==="vector"?O.current:N.current,_=window.requestAnimationFrame(()=>A==null?void 0:A.focus());return()=>window.cancelAnimationFrame(_)},[e,f]);const X=c.useCallback(async()=>{if(k(null),!t.length){k("No embeddings available for similarity search.");return}if(!T){k("Select an embedding to search.");return}const A=p.trim(),_=w.trim(),P=Number(j);if(!Number.isFinite(P)||P<=0){k("Top K must be a positive number.");return}const D=Math.min(1e3,Math.max(1,Math.floor(P))),H=m.trim()===""?null:Number(m);if(H!=null&&!Number.isFinite(H)){k("Min score must be a valid number.");return}if(f==="path"&&!A){k("Select an image path for the query.");return}if(f==="vector"&&!_){k("Paste a base64 vector for the query.");return}const te={embedding:T.name,query_path:f==="path"?A:null,query_vector_b64:f==="vector"?_:null,top_k:D,min_score:H};M(!0);try{await l(te),o()}catch(se){se instanceof un||se instanceof Error?k(se.message):k("Failed to run similarity search.")}finally{M(!1)}},[t.length,T,p,w,j,m,f,l,o]);c.useEffect(()=>{if(!e)return;const A=_=>{if(_.key==="Escape"){_.preventDefault(),o();return}(_.ctrlKey||_.metaKey)&&_.key==="Enter"&&(_.preventDefault(),X())};return window.addEventListener("keydown",A),()=>window.removeEventListener("keydown",A)},[e,o,X]);const J=c.useCallback(()=>{var A;r&&(h("path"),S(r),(A=N.current)==null||A.focus())},[r]);if(!e)return null;const z=t.map(A=>({value:A.name,label:A.name})),le=n.length>0,Q=n.slice(0,3);return a.jsx("div",{className:"fixed inset-0 z-[var(--z-overlay)] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",onClick:A=>{A.target===A.currentTarget&&o()},children:a.jsxs("div",{className:"w-full max-w-2xl rounded-lg border border-border bg-panel shadow-[0_20px_50px_rgba(0,0,0,0.55)]",onClick:A=>A.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Find similar",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Find similar"}),a.jsx("div",{className:"text-xs text-muted",children:"Search with embeddings"})]}),a.jsx("button",{className:"btn btn-sm",onClick:o,"aria-label":"Close",children:"Close"})]}),a.jsxs("div",{className:"px-4 py-4 space-y-4",children:[i&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:i}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Embedding"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(fh,{value:(T==null?void 0:T.name)??"",onChange:d,options:z,placeholder:s?"Loading embeddings...":"Select embedding",disabled:!t.length,triggerClassName:"min-w-[180px]"}),T&&a.jsxs("span",{className:"text-xs text-muted",children:[T.dimension," dims, ",T.metric,", ",T.dtype]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Query mode"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:`btn btn-sm ${f==="path"?"btn-active":""}`,onClick:()=>h("path"),"aria-pressed":f==="path",children:"Selected image"}),a.jsx("button",{type:"button",className:`btn btn-sm ${f==="vector"?"btn-active":""}`,onClick:()=>h("vector"),"aria-pressed":f==="vector",children:"Vector input"})]})]}),f==="path"?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Image path"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{ref:N,type:"text",className:"input w-full",value:p,onChange:A=>S(A.target.value),placeholder:r?"Selected image path":"Select an image first"}),a.jsx("button",{type:"button",className:"btn btn-sm",onClick:J,disabled:!r,title:r?"Use selected image":"Select an image first",children:"Use selected"})]})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Vector (base64 float32)"}),a.jsx("textarea",{ref:O,className:"ui-textarea w-full font-mono text-[11px]",rows:5,value:w,onChange:A=>E(A.target.value),placeholder:"Paste base64-encoded float32 vector"}),a.jsx("div",{className:"text-[11px] text-muted",children:"Base64 of little-endian float32. Length must match embedding dimension."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Top K"}),a.jsx("input",{type:"number",min:1,max:1e3,step:1,className:"input ui-number w-full",value:j,onChange:A=>v(A.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Min score"}),a.jsx("input",{type:"number",step:.01,className:"input ui-number w-full",value:m,onChange:A=>x(A.target.value),placeholder:"Optional"})]})]}),le&&a.jsxs("div",{className:"ui-banner text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Skipped columns"}),a.jsxs("div",{className:"mt-1 space-y-1 text-muted",children:[Q.map(A=>a.jsxs("div",{children:[A.name,": ",A.reason]},A.name)),n.length>Q.length&&a.jsxs("div",{children:["+",n.length-Q.length," more"]})]})]}),y&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:y})]}),a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-border",children:[a.jsx("div",{className:"text-xs text-muted",children:T?`Metric: ${T.metric}`:"Metric: cosine"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:o,disabled:R,children:"Cancel"}),a.jsx("button",{className:"btn btn-sm btn-active",onClick:X,disabled:R||!t.length,children:R?"Searching...":"Find similar"})]})]})]})})}const Rx=1,Aa=200,Ck=5*6e4,kk=6e4,Px=(e,t)=>t!=null&&t.recursive?["folder",e,"recursive",t.page??Rx,t.pageSize??Aa]:["folder",e];function Tx(e){return e[0]!=="folder"||e[2]!=="recursive"||typeof e[1]!="string"||typeof e[3]!="number"||typeof e[4]!="number"?null:e}function Ek(e){return Tx(e)!==null}function Nk(e,t,n=!0){if(!Ek(e))return!0;const r=Tx(e);if(r==null)return!1;const[,s,,i]=r;return i!==Rx?!1:!!(s===t||n&&s==="/")}function jk(e,t,n=!0){return!Array.isArray(e)||e[0]!=="folder"?!1:!Nk(e,t,n)}const Mk=15e3;function Rk(e,t){return Se.getFolder(e,t)}function uf(e,t=!1,n){const r=zu(),s={recursive:t,page:n==null?void 0:n.page,pageSize:n==null?void 0:n.pageSize,legacyRecursive:n==null?void 0:n.legacyRecursive},i=!!s.recursive;return Au({queryKey:Px(e,s),queryFn:()=>Rk(e,s),enabled:(n==null?void 0:n.enabled)??!0,staleTime:1e4,gcTime:i?kk:Ck,retry:2,retryDelay:o=>Math.min(1e3*Math.pow(2,o),5e3),refetchOnWindowFocus:!1,refetchInterval:r?Mk:!1,refetchIntervalInBackground:r})}const Pk=(e,t)=>["search",e,t],Tk=2e4;function Lk(e,t){const n=zu();return Au({enabled:!!e.trim(),queryKey:Pk(e,t),queryFn:()=>Se.search(e,t),staleTime:3e3,gcTime:6e4,placeholderData:r=>r,retry:1,refetchInterval:n?Tk:!1,refetchIntervalInBackground:n})}const _k=()=>["embeddings"];function Ik(){return Au({queryKey:_k(),queryFn:Se.getEmbeddings,staleTime:6e4,gcTime:5*6e4,retry:1,refetchOnWindowFocus:!1})}const Fk=/^[\/@a-zA-Z0-9._\-\/]{1,512}$/,Ok=[".jpg",".jpeg",".png",".webp"];function Ct(e){try{const t=decodeURI(e||""),r=(t.startsWith("/")?t:`/${t}`).replace(/\/{2,}/g,"/"),s=r.length>1?r.replace(/\/$/,""):r;return Fk.test(s)?s:"/"}catch{return"/"}}function Ym(){return(window.location.hash||"").replace(/^#/,"")}function Xm(e){const t=Ct(e),n=`#${encodeURI(t)}`;window.location.hash!==n&&(window.location.hash=n)}function ya(e){const t=Ct(e),n=`#${encodeURI(t)}`;if(window.location.hash!==n){const r=`${window.location.pathname}${window.location.search}${n}`;window.history.replaceState(window.history.state,"",r)}}function Ak(e){const n=Ct(e).toLowerCase();return Ok.some(r=>n.endsWith(r))}function Lx(e,t){const n=e.replace(/\/+$/,""),r=t.replace(/^\/+/,""),s=[n,r].filter(Boolean).join("/");return s.startsWith("/")?s:`/${s}`}function qm(e){const n=Ct(e).split("/").filter(Boolean);return n.length<=1?"/":"/"+n.slice(0,-1).join("/")}function xh(e){return Ct(e).split("/").filter(Boolean).pop()||""}function Dk(e){return e.endsWith("/_trash_")}const zk=new Set([0,1,2,3,4,5]),wh=new Set(["<","<=",">",">="]),$k=/^\d{4}-\d{2}-\d{2}$/;function Bk(e,t){return!t||!t.and.length?e:e.filter(n=>Uk(n,t.and))}function Uk(e,t){for(const n of t)if(!Hk(e,n))return!1;return!0}function Hk(e,t){var n,r,s,i,o,l,u;if("stars"in t){const d=t.stars;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsIn"in t){const d=t.starsIn.values;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsNotIn"in t){const d=t.starsNotIn.values;if(!d||!d.length)return!0;const f=e.star??0;return!d.includes(f)}if("nameContains"in t){const d=(n=t.nameContains.value)==null?void 0:n.trim();return d?(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("nameNotContains"in t){const d=(r=t.nameNotContains.value)==null?void 0:r.trim();return d?!(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("commentsContains"in t){const d=(s=t.commentsContains.value)==null?void 0:s.trim();if(!d)return!0;const f=e.comments??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("commentsNotContains"in t){const d=(i=t.commentsNotContains.value)==null?void 0:i.trim();if(!d)return!0;const f=e.comments??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("urlContains"in t){const d=(o=t.urlContains.value)==null?void 0:o.trim();if(!d)return!0;const f=e.source??e.url??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("urlNotContains"in t){const d=(l=t.urlNotContains.value)==null?void 0:l.trim();if(!d)return!0;const f=e.source??e.url??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("dateRange"in t){const{from:d,to:f}=t.dateRange;if(!d&&!f)return!0;if(!e.addedAt)return!1;const h=Date.parse(e.addedAt);if(Number.isNaN(h))return!1;const p=Zm(d,!1),S=Zm(f,!0);return!(p!=null&&h<p||S!=null&&h>S)}if("widthCompare"in t){const{op:d,value:f}=t.widthCompare;if(!Number.isFinite(f))return!0;const h=e.w;return!Number.isFinite(h)||h<=0?!1:eg(h,d,f)}if("heightCompare"in t){const{op:d,value:f}=t.heightCompare;if(!Number.isFinite(f))return!0;const h=e.h;return!Number.isFinite(h)||h<=0?!1:eg(h,d,f)}if("metricRange"in t){const{key:d,min:f,max:h}=t.metricRange,p=(u=e.metrics)==null?void 0:u[d];return!(p==null||p<f||p>h)}return!0}function cf(e){if(!e||typeof e!="object")return null;const t=e.and;if(!Array.isArray(t))return null;const n=[];for(const r of t){const s=sE(r);s&&n.push(s)}return{and:n}}function Gm(e){var r;const t=e.and.find(s=>"stars"in s),n=e.and.find(s=>"starsIn"in s);return(r=n==null?void 0:n.starsIn)!=null&&r.values?n.starsIn.values:(t==null?void 0:t.stars)??[]}function $c(e,t){return _x(e,t)}function Vk(e){var n;const t=e.and.find(r=>"starsIn"in r);return((n=t==null?void 0:t.starsIn)==null?void 0:n.values)??[]}function _x(e,t){const n=Xo(t),r=e.and.filter(s=>!("starsIn"in s)&&!("stars"in s));return n.length?{and:[{starsIn:{values:n}},...r]}:{and:r}}function Wk(e){var n;const t=e.and.find(r=>"starsNotIn"in r);return((n=t==null?void 0:t.starsNotIn)==null?void 0:n.values)??[]}function Ix(e,t){const n=Xo(t),r=e.and.filter(s=>!("starsNotIn"in s));return n.length?{and:[{starsNotIn:{values:n}},...r]}:{and:r}}function Qk(e){var n;const t=e.and.find(r=>"nameContains"in r);return((n=t==null?void 0:t.nameContains)==null?void 0:n.value)??null}function Fx(e,t){const n=kn(t),r=e.and.filter(s=>!("nameContains"in s));return n?{and:[{nameContains:{value:n}},...r]}:{and:r}}function Kk(e){var n;const t=e.and.find(r=>"nameNotContains"in r);return((n=t==null?void 0:t.nameNotContains)==null?void 0:n.value)??null}function Ox(e,t){const n=kn(t),r=e.and.filter(s=>!("nameNotContains"in s));return n?{and:[{nameNotContains:{value:n}},...r]}:{and:r}}function Yk(e){var n;const t=e.and.find(r=>"commentsContains"in r);return((n=t==null?void 0:t.commentsContains)==null?void 0:n.value)??null}function Ax(e,t){const n=kn(t),r=e.and.filter(s=>!("commentsContains"in s));return n?{and:[{commentsContains:{value:n}},...r]}:{and:r}}function Xk(e){var n;const t=e.and.find(r=>"commentsNotContains"in r);return((n=t==null?void 0:t.commentsNotContains)==null?void 0:n.value)??null}function Dx(e,t){const n=kn(t),r=e.and.filter(s=>!("commentsNotContains"in s));return n?{and:[{commentsNotContains:{value:n}},...r]}:{and:r}}function qk(e){var n;const t=e.and.find(r=>"urlContains"in r);return((n=t==null?void 0:t.urlContains)==null?void 0:n.value)??null}function zx(e,t){const n=kn(t),r=e.and.filter(s=>!("urlContains"in s));return n?{and:[{urlContains:{value:n}},...r]}:{and:r}}function Gk(e){var n;const t=e.and.find(r=>"urlNotContains"in r);return((n=t==null?void 0:t.urlNotContains)==null?void 0:n.value)??null}function $x(e,t){const n=kn(t),r=e.and.filter(s=>!("urlNotContains"in s));return n?{and:[{urlNotContains:{value:n}},...r]}:{and:r}}function Jk(e){const t=e.and.find(n=>"dateRange"in n);return(t==null?void 0:t.dateRange)??null}function df(e,t){const n=yu((t==null?void 0:t.from)??null),r=yu((t==null?void 0:t.to)??null),s=e.and.filter(i=>!("dateRange"in i));return!n&&!r?{and:s}:{and:[{dateRange:{...n?{from:n}:{},...r?{to:r}:{}}},...s]}}function Zk(e){const t=e.and.find(n=>"widthCompare"in n);return(t==null?void 0:t.widthCompare)??null}function Da(e,t){const n=e.and.filter(r=>!("widthCompare"in r));return!t||!Number.isFinite(t.value)||!wh.has(t.op)?{and:n}:{and:[{widthCompare:{op:t.op,value:t.value}},...n]}}function eE(e){const t=e.and.find(n=>"heightCompare"in n);return(t==null?void 0:t.heightCompare)??null}function za(e,t){const n=e.and.filter(r=>!("heightCompare"in r));return!t||!Number.isFinite(t.value)||!wh.has(t.op)?{and:n}:{and:[{heightCompare:{op:t.op,value:t.value}},...n]}}function tE(e,t){const n=e.and.find(r=>"metricRange"in r&&r.metricRange.key===t);return(n==null?void 0:n.metricRange)??null}function nE(e,t,n){const r=e.and.filter(s=>!("metricRange"in s&&s.metricRange.key===t));return n?{and:[{metricRange:{key:t,min:n.min,max:n.max}},...r]}:{and:r}}function rE(e){const t=cf(e);return t?t.and.length:0}function sE(e){var t,n,r,s,i,o,l,u;if(!e||typeof e!="object")return null;if("stars"in e){const d=Xo(e.stars);return d.length?{starsIn:{values:d}}:null}if("starsIn"in e){const d=Xo((t=e.starsIn)==null?void 0:t.values);return d.length?{starsIn:{values:d}}:null}if("starsNotIn"in e){const d=Xo((n=e.starsNotIn)==null?void 0:n.values);return d.length?{starsNotIn:{values:d}}:null}if("nameContains"in e){const d=kn((r=e.nameContains)==null?void 0:r.value);return d?{nameContains:{value:d}}:null}if("nameNotContains"in e){const d=kn((s=e.nameNotContains)==null?void 0:s.value);return d?{nameNotContains:{value:d}}:null}if("commentsContains"in e){const d=kn((i=e.commentsContains)==null?void 0:i.value);return d?{commentsContains:{value:d}}:null}if("commentsNotContains"in e){const d=kn((o=e.commentsNotContains)==null?void 0:o.value);return d?{commentsNotContains:{value:d}}:null}if("urlContains"in e){const d=kn((l=e.urlContains)==null?void 0:l.value);return d?{urlContains:{value:d}}:null}if("urlNotContains"in e){const d=kn((u=e.urlNotContains)==null?void 0:u.value);return d?{urlNotContains:{value:d}}:null}if("dateRange"in e){const d=e.dateRange,f=yu((d==null?void 0:d.from)??null),h=yu((d==null?void 0:d.to)??null);return!f&&!h?null:{dateRange:{...f?{from:f}:{},...h?{to:h}:{}}}}if("widthCompare"in e){const d=e.widthCompare,f=Jm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{widthCompare:f}:null}if("heightCompare"in e){const d=e.heightCompare,f=Jm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{heightCompare:f}:null}if("metricRange"in e){const d=e.metricRange;if(!d||typeof d!="object")return null;const f=typeof d.key=="string"?d.key:"",h=ff(d.min),p=ff(d.max);return!f||h==null||p==null||h>p?null:{metricRange:{key:f,min:h,max:p}}}return null}function Xo(e){if(!Array.isArray(e))return[];const t=[],n=new Set;for(const r of e){const s=typeof r=="number"?r:typeof r=="string"?Number(r):NaN;!Number.isInteger(s)||!zk.has(s)||n.has(s)||(n.add(s),t.push(s))}return t}function kn(e){if(typeof e!="string")return null;const t=e.trim();return t||null}function yu(e){if(typeof e!="string")return null;const t=e.trim();if(!t)return null;const n=Date.parse(t);return Number.isNaN(n)?null:t}function Jm(e,t){if(typeof e!="string"||!wh.has(e))return null;const n=ff(t);return n==null?null:{op:e,value:n}}function Zm(e,t){if(!e)return null;const n=e.trim();if(!n)return null;const r=Date.parse(n);return Number.isNaN(r)?null:t&&$k.test(n)?r+24*60*60*1e3-1:r}function eg(e,t,n){switch(t){case"<":return e<n;case"<=":return e<=n;case">":return e>n;case">=":return e>=n;default:return!0}}function ff(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null}function tg(e){return e.addedAt?Date.parse(e.addedAt):0}function xu(e,t){return e.name.localeCompare(t.name)}function iE(e,t){const n=tg(e),r=tg(t);return n===r?xu(e,t):n-r}function oE(e){return(t,n)=>{var i,o;const r=(i=t.metrics)==null?void 0:i[e],s=(o=n.metrics)==null?void 0:o[e];return r==null&&s==null?xu(t,n):r==null?1:s==null?-1:r===s?xu(t,n):r-s}}function ng(e,t){return Bk(e,t)}function lE(e){let t=e>>>0;return()=>{t+=1831565813;let n=Math.imul(t^t>>>15,1|t);return n^=n+Math.imul(n^n>>>7,61|n),((n^n>>>14)>>>0)/4294967296}}function aE(e,t){const n=lE(t||1),r=[...e];for(let s=r.length-1;s>0;s-=1){const i=Math.floor(n()*(s+1));[r[s],r[i]]=[r[i],r[s]]}return r}function uE(e,t,n){if(t.kind==="builtin"&&t.key==="random"){const i=n??Date.now();return aE(e,i)}let r=iE;t.kind==="metric"?r=oE(t.key):t.key==="name"&&(r=xu);const s=[...e].sort(r);return t.dir==="desc"?s.reverse():s}const rg="leftW.folders",sg="leftW.metrics",cE="leftW",ig="rightW",og=200,lg=240,ag=200;function dE(e){return(e.pointerType??"mouse")==="mouse"&&e.button!==0}function fE(e,t){try{e.setPointerCapture(t)}catch{}}function hE(e,t){try{e.releasePointerCapture(t)}catch{}}function pE(e,t){const[n,r]=c.useState(240),[s,i]=c.useState(320),[o,l]=c.useState(240),u=t==="metrics"?s:n,d=c.useRef(u),f=c.useRef(o);c.useEffect(()=>{d.current=u},[u]),c.useEffect(()=>{f.current=o},[o]),c.useEffect(()=>{try{const w=window.localStorage,E=Number(w.getItem(rg)??w.getItem(cE));Number.isFinite(E)&&E>0&&r(E);const j=Number(w.getItem(sg));Number.isFinite(j)&&j>0&&i(j);const v=Number(w.getItem(ig));Number.isFinite(v)&&v>0&&l(v)}catch{}},[]);const h=(w,E,j)=>{if(dE(w))return;w.preventDefault();const v=w.currentTarget,m=w.pointerId;fE(v,m);const x=R=>{R.pointerId===m&&E(R)};function y(){window.removeEventListener("pointermove",x),window.removeEventListener("pointerup",k),window.removeEventListener("pointercancel",k),hE(v,m)}function k(R){R.pointerId===m&&(y(),j())}window.addEventListener("pointermove",x),window.addEventListener("pointerup",k),window.addEventListener("pointercancel",k)};return{leftW:u,rightW:o,onResizeLeft:w=>{const E=e.current;if(!E)return;const j=E.getBoundingClientRect(),v=t==="metrics"?sg:rg;let m=d.current;h(w,x=>{const y=x.clientX-j.left,k=Math.max(og,j.width-f.current-ag),R=Math.min(Math.max(y,og),k);m=R,t==="metrics"?i(R):r(R)},()=>{try{window.localStorage.setItem(v,String(m))}catch{}})},onResizeRight:w=>{const E=e.current;if(!E)return;const j=E.getBoundingClientRect();let v=f.current;h(w,m=>{const x=m.clientX-j.left,y=j.width-x,k=Math.max(lg,j.width-d.current-ag),R=Math.min(Math.max(y,lg),k);v=R,f.current=R,l(R)},()=>{try{window.localStorage.setItem(ig,String(v))}catch{}})}}}function mE(e,t=250){const[n,r]=Vh.useState(e);return Vh.useEffect(()=>{const s=window.setTimeout(()=>r(e),Math.max(0,t));return()=>window.clearTimeout(s)},[e,t]),n}const Bx="application/x-lenslet-paths",gE='[role="treeitem"].drop-target';function ug(e){var n;return Array.from(((n=e.dataTransfer)==null?void 0:n.types)||[]).includes(Bx)}function vE(e){document.querySelectorAll(gE).forEach(t=>{t!==e&&t.classList.remove("drop-target")})}function cg(e){vE(e),e.classList.add("drop-target")}function dg(e){return e.startsWith("/")?e:`/${e}`}function yE({path:e,isLeaf:t}){const n=Zs(),r=c.useCallback(l=>{ug(l)&&(l.preventDefault(),t&&cg(l.currentTarget))},[t]),s=c.useCallback(l=>{!t||!ug(l)||(l.preventDefault(),cg(l.currentTarget))},[t]),i=c.useCallback(l=>{const u=l.currentTarget,d=document.elementFromPoint(l.clientX,l.clientY);d&&u.contains(d)||u.classList.remove("drop-target")},[]),o=c.useCallback(async l=>{const u=l.dataTransfer;if(!u)return;l.preventDefault(),l.currentTarget.classList.remove("drop-target");const d=u.getData(Bx),h=(d?JSON.parse(d):[]).filter(Boolean);if(!h.length)return;let p=h[0].split("/").slice(0,-1).join("/")||"/";p=dg(p);const S=dg(e);try{for(const w of h)await Se.moveFile(w,S);n.invalidateQueries({queryKey:["folder",p]}),n.invalidateQueries({queryKey:["folder",S]}),n.setQueryData(["folder",p],w=>!w||!Array.isArray(w.items)?w:{...w,items:w.items.filter(E=>!h.includes(E.path))})}catch{}},[e,n]);return{onDragOver:r,onDragEnter:s,onDragLeave:i,onDrop:o}}const xE='[role="tree"] [role="treeitem"]';function wE(){return Array.from(document.querySelectorAll(xE))}function SE(e,t){var i;const n=wE(),r=n.findIndex(o=>o===e);if(r===-1)return;let s=r;t==="ArrowDown"?s=Math.min(n.length-1,r+1):t==="ArrowUp"?s=Math.max(0,r-1):t==="Home"?s=0:t==="End"&&(s=n.length-1),(i=n[s])==null||i.focus()}function bE({path:e,isLeaf:t,isExpanded:n,setExpanded:r,onOpen:s}){return c.useCallback(i=>{if(i.key==="Enter"){i.preventDefault(),s(e);return}if(i.key==="ArrowRight"){!t&&!n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.add(e),l}));return}if(i.key==="ArrowLeft"){!t&&n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.delete(e),l}));return}(i.key==="ArrowDown"||i.key==="ArrowUp"||i.key==="Home"||i.key==="End")&&(i.preventDefault(),SE(i.currentTarget,i.key))},[e,t,n,r,s])}const fg=64,CE=120;function kE(e){const t=e.split("/").filter(Boolean),n=["/"];let r="";for(const s of t)r=r?`${r}/${s}`:`/${s}`,n.push(r);return n}function EE({current:e,roots:t,data:n,onOpen:r,onPullRefresh:s,onResize:i,onContextMenu:o,onOpenActions:l,countVersion:u,className:d,showResizeHandle:f=!0}){const[h,p]=c.useState(new Set(["/"])),S=c.useRef(new Map),w=c.useRef(new Map),[E,j]=c.useState(!1),[v,m]=c.useState(0),x=c.useRef(null),y=c.useRef(!1),k=Zs(),R=c.useCallback(()=>{m(0),x.current=null,y.current=!1},[]),M=c.useCallback(async _=>{const P=Ct(_||"/"),D=S.current,H=w.current,te=D.get(P);if(te!==void 0)return te;const se=k.getQueryData(Px(P,{recursive:!0}));if(se){const Y=se.totalItems??se.items.length;return D.set(P,Y),Y}const I=H.get(P);if(I)return I;const U=(async()=>{try{const Y=await Se.getFolder(P,{recursive:!0}),Z=Y.totalItems??Y.items.length;return D.set(P,Z),Z}finally{H.delete(P)}})();return H.set(P,U),U},[k]);c.useEffect(()=>{S.current.clear(),w.current.clear()},[u]),c.useEffect(()=>{const _=kE(e);p(P=>{const D=new Set(P);for(const H of _)D.add(H);return D})},[e]);const N=c.useCallback(async()=>{if(!(!s||E)){j(!0);try{await s()}catch(_){console.error("Failed to refresh folders:",_)}finally{j(!1),m(0)}}},[s,E]),O=c.useCallback(_=>{!s||E||_.touches.length===1&&(_.currentTarget.scrollTop>0||(x.current=_.touches[0].clientY,y.current=!1))},[s,E]),T=c.useCallback(_=>{if(!s||E||_.touches.length!==1)return;const P=x.current;if(P==null)return;if(_.currentTarget.scrollTop>0){R();return}const D=_.touches[0].clientY-P;if(D<=0){y.current&&m(0);return}!y.current&&D<8||(y.current=!0,_.preventDefault(),m(Math.min(CE,D*.55)))},[E,s,R]),X=c.useCallback(()=>{if(!s||E){R();return}const _=y.current&&v>=fg;if(x.current=null,y.current=!1,_){N();return}m(0)},[N,E,s,v,R]),J=d??"h-full overflow-auto bg-panel scrollbar-thin",z=s?`${J} overscroll-y-contain`:J,le=!!s&&(E||v>0),Q=v>=fg,A=E?28:Math.min(44,v);return a.jsxs("div",{className:z,onTouchStart:s?O:void 0,onTouchMove:s?T:void 0,onTouchEnd:s?X:void 0,onTouchCancel:s?X:void 0,children:[le&&a.jsx("div",{className:"flex items-end justify-center text-[11px] text-muted select-none transition-[height,opacity] duration-150",style:{height:A,opacity:E||v>8?1:.65},"aria-live":"polite",children:E?"Refreshing":Q?"Release to refresh":"Pull to refresh"}),a.jsx("div",{className:"p-1",role:"tree","aria-label":"Folders",children:t.map(_=>a.jsx(Ux,{path:_.path,label:_.label,depth:0,current:e,expanded:h,setExpanded:p,onOpen:r,onContextMenu:o,onOpenActions:l,initial:n,getSubtreeCount:M,countVersion:u},_.path))}),f&&a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 left-[calc(var(--left)-6px)]",onPointerDown:i})]})}function Ux({path:e,label:t,depth:n,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:u,initial:d,getSubtreeCount:f,countVersion:h}){var J;const p=s.has(e),S=r===e,w=e==="/"||p||S,{data:E}=uf(e,!1,{enabled:w}),j=d&&e===d.path?d:E,m=!!j?j.dirs.length===0:!1,[x,y]=c.useState(j?j.items.length:null),k=bE({path:e,isLeaf:m,isExpanded:p,setExpanded:i,onOpen:o}),{onDragOver:R,onDragEnter:M,onDragLeave:N,onDrop:O}=yE({path:e,isLeaf:m}),T=z=>{z.stopPropagation(),!m&&i(le=>{const Q=new Set(le);return Q.has(e)?Q.delete(e):Q.add(e),Q})},X=z=>{if(z.stopPropagation(),!u)return;const le=z.currentTarget.getBoundingClientRect();u(e,{x:le.right-4,y:le.bottom-4})};return c.useEffect(()=>{let z=!1;if(!j){y(null);return}if(y(j.items.length),!!(p&&(n>0||S)))return f(e).then(Q=>{z||y(Q)}).catch(Q=>{z||console.warn(`Failed to compute subtree count for ${e}:`,Q)}),()=>{z=!0}},[j,e,f,h,p,n,S]),a.jsxs("div",{children:[a.jsxs("div",{className:`tree-row flex items-center gap-1.5 py-1 px-2 rounded-md cursor-pointer min-h-[40px] outline-none transition-colors duration-75 ${S?"bg-accent/20 text-accent font-medium":"hover:bg-white/5 text-text"}`,role:"treeitem","aria-level":n+1,"aria-expanded":m?void 0:p,"aria-selected":S,tabIndex:S?0:-1,style:{paddingLeft:8+n*14},onClick:()=>o(e),onContextMenu:z=>{z.preventDefault(),z.stopPropagation(),l==null||l(z,e)},onKeyDown:k,onDragOver:R,onDragEnter:M,onDragLeave:N,onDrop:O,children:[a.jsx("button",{type:"button",className:"tree-expand-btn touch-manipulation",onClick:T,"aria-label":m?`No subfolders in ${t}`:`${p?"Collapse":"Expand"} ${t}`,"aria-expanded":m?void 0:p,disabled:m,children:m?"":p?"":""}),a.jsx("span",{className:"flex-1 overflow-hidden truncate text-sm",title:t,children:ZC(t,28)}),x!==null&&a.jsx("span",{className:"text-[10px] opacity-50 bg-white/5 border border-white/5 rounded px-1.5 min-w-[24px] text-center",children:x}),u&&a.jsx("button",{type:"button",className:"tree-row-action-btn touch-manipulation","aria-label":`Open actions for ${t}`,"aria-haspopup":"menu",onPointerDown:z=>z.stopPropagation(),onClick:X,children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]}),p&&((J=j==null?void 0:j.dirs)==null?void 0:J.map(z=>a.jsx(Ux,{path:Lx(e,z.name),label:z.name,depth:n+1,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:u,getSubtreeCount:f,countVersion:h},z.name)))]})}const Ls=40,NE=12,hg=[5,4,3,2,1],pg=["<","<=",">",">="];function jE({items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l,onChangeFilters:u}){const d=r&&r.length?a.jsx(ME,{selectedItems:r,metricKeys:n}):null,f=a.jsx(RE,{filters:o,onChangeFilters:u});return n.length?a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[d,a.jsx(PE,{items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}),f]}):a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[d,f,a.jsx("div",{className:"p-4 text-sm text-muted",children:"No metrics found in this dataset."})]})}function ME({selectedItems:e,metricKeys:t}){const n=c.useMemo(()=>{if(!e.length)return null;const u=new Map;for(const h of e){const p=h.metrics;if(p)for(const[S,w]of Object.entries(p)){if(w==null||Number.isNaN(w))continue;const E=u.get(S);E?E.push(w):u.set(S,[w])}}return u.size?{entries:(t.length?t.filter(h=>u.has(h)):Array.from(u.keys()).sort()).map(h=>{const p=u.get(h)??[],S=Math.min(...p),w=Math.max(...p),E=p.reduce((j,v)=>j+v,0)/Math.max(1,p.length);return{key:h,value:p[0],min:S,max:w,avg:E,count:p.length}}),totalItems:e.length}:null},[e,t]);if(!n)return null;const{entries:r,totalItems:s}=n,i=r.slice(0,NE),o=r.length-i.length,l=s>1;return a.jsxs("div",{className:"ui-card",children:[a.jsxs("div",{className:"ui-card-header",children:[a.jsx("div",{className:"ui-section-title",children:"Selected metrics"}),a.jsxs("div",{className:"text-[11px] text-muted",children:[s," item",s===1?"":"s"]})]}),a.jsxs("div",{className:"space-y-1 text-[12px]",children:[i.map(u=>a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-muted w-28 shrink-0 truncate",title:u.key,children:u.key}),a.jsxs("span",{className:"font-mono text-text text-right tabular-nums",children:[l?`${sn(u.min)}  ${sn(u.max)}`:sn(u.value),l&&a.jsxs("span",{className:"text-[11px] text-muted ml-2",children:["avg ",sn(u.avg),u.count!==s?`  ${u.count}/${s}`:""]})]})]},u.key)),o>0&&a.jsxs("div",{className:"text-[11px] text-muted",children:["+",o," more"]})]})]})}function RE({filters:e,onChangeFilters:t}){const n=c.useMemo(()=>Vk(e),[e]),r=c.useMemo(()=>Wk(e),[e]),s=c.useMemo(()=>Qk(e)??"",[e]),i=c.useMemo(()=>Kk(e)??"",[e]),o=c.useMemo(()=>Yk(e)??"",[e]),l=c.useMemo(()=>Xk(e)??"",[e]),u=c.useMemo(()=>qk(e)??"",[e]),d=c.useMemo(()=>Gk(e)??"",[e]),f=c.useMemo(()=>Jk(e)??{},[e]),h=c.useMemo(()=>Sg(f.from),[f.from]),p=c.useMemo(()=>Sg(f.to),[f.to]),S=c.useMemo(()=>Zk(e),[e]),w=c.useMemo(()=>eE(e),[e]),[E,j]=c.useState((S==null?void 0:S.op)??">="),[v,m]=c.useState((w==null?void 0:w.op)??">=");c.useEffect(()=>{S!=null&&S.op&&j(S.op)},[S==null?void 0:S.op]),c.useEffect(()=>{w!=null&&w.op&&m(w.op)},[w==null?void 0:w.op]);const x=(y,k)=>{const R=new Set(n),M=new Set(r);y==="include"?R.has(k)?R.delete(k):(R.add(k),M.delete(k)):M.has(k)?M.delete(k):(M.add(k),R.delete(k));let N=_x(e,Array.from(R));N=Ix(N,Array.from(M)),t(N)};return a.jsxs("div",{className:"ui-card",children:[a.jsx("div",{className:"ui-section-title mb-3",children:"Attributes"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Rating"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Include"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[hg.map(y=>{const k=n.includes(y);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${k?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>x("include",y),"aria-pressed":k,title:`Include ${y} star${y>1?"s":""}`,children:[y,""]},`stars-in-${y}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${n.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>x("include",0),"aria-pressed":n.includes(0),title:"Include unrated",children:"None"})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Exclude"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[hg.map(y=>{const k=r.includes(y);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${k?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>x("exclude",y),"aria-pressed":k,title:`Exclude ${y} star${y>1?"s":""}`,children:[y,""]},`stars-out-${y}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${r.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>x("exclude",0),"aria-pressed":r.includes(0),title:"Exclude unrated",children:"None"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Filename"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:s,placeholder:"e.g. draft",onChange:y=>t(Fx(e,y.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:i,placeholder:"e.g. v1",onChange:y=>t(Ox(e,y.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Comments"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:o,placeholder:"e.g. hero",onChange:y=>t(Ax(e,y.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:l,placeholder:"e.g. todo",onChange:y=>t(Dx(e,y.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"URL"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:u,placeholder:"e.g. s3://bucket",onChange:y=>t(zx(e,y.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:d,placeholder:"e.g. http://",onChange:y=>t($x(e,y.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Date Added"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"From"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:h,onChange:y=>t(df(e,{from:y.target.value||null,to:f.to??null}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"To"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:p,onChange:y=>t(df(e,{from:f.from??null,to:y.target.value||null}))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Dimensions"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Width"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:E,onChange:y=>{const k=y.target.value;j(k),S&&t(Da(e,{op:k,value:S.value}))},children:pg.map(y=>a.jsx("option",{value:y,children:y},`w-${y}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:S?String(S.value):"",min:0,placeholder:"px",onChange:y=>{const k=y.target.value;if(!k){t(Da(e,null));return}const R=Number(k);Number.isFinite(R)&&t(Da(e,{op:E,value:R}))}})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Height"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:v,onChange:y=>{const k=y.target.value;m(k),w&&t(za(e,{op:k,value:w.value}))},children:pg.map(y=>a.jsx("option",{value:y,children:y},`h-${y}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:w?String(w.value):"",min:0,placeholder:"px",onChange:y=>{const k=y.target.value;if(!k){t(za(e,null));return}const R=Number(k);Number.isFinite(R)&&t(za(e,{op:v,value:R}))}})]})]})]})]})]})]})}function PE({items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}){const[u,d]=c.useState(!1),f=s&&n.includes(s)?s:n[0];return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("label",{className:"ui-label",children:"Metric"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-[11px]",onClick:()=>d(h=>!h),"aria-pressed":u,children:u?"Show one":"Show all"})]}),u?a.jsx("div",{className:"ui-input ui-input-readonly w-full flex items-center text-xs",children:"All metrics"}):a.jsx("select",{className:"ui-select w-full",value:f,onChange:h=>i(h.target.value),children:n.map(h=>a.jsx("option",{value:h,children:h},h))})]}),u?a.jsx("div",{className:"space-y-3",children:n.map(h=>a.jsx(mg,{metricKey:h,items:e,filteredItems:t,selectedItems:r,filters:o,onChangeRange:l,showTitle:!0},h))}):f?a.jsx(mg,{metricKey:f,items:e,filteredItems:t,selectedItems:r,filters:o,onChangeRange:l}):a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]})}function mg({items:e,filteredItems:t,metricKey:n,selectedItems:r,filters:s,onChangeRange:i,showTitle:o=!1}){const l=c.useMemo(()=>gg(e,n),[e,n]),u=c.useMemo(()=>Bc(l,Ls),[l]),d=c.useMemo(()=>gg(t,n),[t,n]),f=c.useMemo(()=>u?Bc(d,Ls,u):null,[d,u]),h=tE(s,n),[p,S]=c.useState(null),[w,E]=c.useState(!1),j=c.useRef(null),v=c.useRef(null),m=c.useRef(!1),x=c.useRef(null),[y,k]=c.useState(null),[R,M]=c.useState(""),[N,O]=c.useState(""),[T,X]=c.useState(null),J=p??h,z=u?{min:u.min,max:u.max}:null,le=c.useMemo(()=>{var Y;if(!(r!=null&&r.length))return[];const U=[];for(const Z of r){const q=(Y=Z.metrics)==null?void 0:Y[n];q==null||Number.isNaN(q)||U.push(q)}return U},[r,n]),Q=le.length===1?le[0]:null,A=c.useMemo(()=>!u||le.length<2?null:Bc(le,Ls,u),[le,u]);c.useEffect(()=>{if(!h||!z){T!=="min"&&M(h?Fr(h.min):""),T!=="max"&&O(h?Fr(h.max):"");return}if(T!=="min"){const U=pi(h.min,z.min)?"":Fr(h.min);M(U)}if(T!=="max"){const U=pi(h.max,z.max)?"":Fr(h.max);O(U)}},[h,z,T]),c.useEffect(()=>{k(null)},[n,z==null?void 0:z.min,z==null?void 0:z.max]);const _=U=>{var q;if(!z)return null;const Y=(q=x.current)==null?void 0:q.getBoundingClientRect();if(!Y)return null;const Z=Sh((U.clientX-Y.left)/Y.width);return z.min+(z.max-z.min)*Z},P=(U,Y)=>{if(!z)return;const Z=j.current??U,q=yg(Z,U);S(q),Y&&i(n,q)},D=U=>{var Z;if(!z)return;U.preventDefault();const Y=_(U);Y!=null&&(E(!0),S(null),j.current=Y,v.current=U.clientX,m.current=!1,k(Y),(Z=x.current)==null||Z.setPointerCapture(U.pointerId))},H=U=>{const Y=_(U);if(Y==null){w||k(null);return}if(k(Y),w){const Z=v.current;if(!m.current&&Z!=null){if(Math.abs(U.clientX-Z)<4)return;m.current=!0}m.current&&P(Y,!1)}},te=U=>{var Z;if(!w)return;E(!1),(Z=x.current)==null||Z.releasePointerCapture(U.pointerId);const Y=_(U);m.current&&Y!=null?(k(Y),P(Y,!0)):h&&i(n,null),j.current=null,v.current=null,m.current=!1,setTimeout(()=>S(null),0)},se=(U,Y)=>{if(!z)return;const Z=xg(U),q=xg(Y);if(!Z.valid||!q.valid){Z.valid||M(h?Fr(h.min):""),q.valid||O(h?Fr(h.max):"");return}if(Z.value==null&&q.value==null){i(n,null);return}const ne=Z.value??z.min,fe=q.value??z.max,je=wg(ne,z.min,z.max),xe=wg(fe,z.min,z.max),De=yg(je,xe);if(pi(De.min,z.min)&&pi(De.max,z.max)){i(n,null);return}i(n,De)};if(!u||!z)return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:n}),a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]});const I=le.length;return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:n}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mb-2 tabular-nums",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{children:["Population: ",u.count]}),a.jsxs("span",{children:["Filtered: ",(f==null?void 0:f.count)??0]}),I>1&&a.jsxs("span",{className:"text-text",children:["Selected: ",I]})]}),Q!=null&&a.jsxs("span",{className:"text-text",children:["Selected: ",sn(Q)]})]}),a.jsxs("svg",{ref:x,viewBox:`0 0 ${Ls} 100`,preserveAspectRatio:"none",className:"w-full h-28 cursor-crosshair rounded-md bg-surface-inset",onPointerDown:D,onPointerMove:H,onPointerUp:te,onPointerLeave:()=>k(null),children:[Uc(u.bins,"#2e3a4b"),f&&Uc(f.bins,"#3a8fff"),A&&Uc(A.bins,"#f59e0b",{opacity:.55}),J&&TE(J,z),Q!=null&&vg(Q,z,{color:"var(--highlight)",strokeWidth:.7}),y!=null&&vg(y,z,{color:"rgba(255,255,255,0.75)",strokeWidth:.5,dashed:!0})]}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mt-2 tabular-nums",children:[a.jsx("span",{children:sn(z==null?void 0:z.min)}),a.jsxs("div",{className:"flex flex-col items-center text-center leading-tight",children:[J?a.jsx("span",{className:"text-text",children:pi(J.min,z.min)?` ${sn(J.max)}`:pi(J.max,z.max)?` ${sn(J.min)}`:`${sn(J.min)}  ${sn(J.max)}`}):y!=null?a.jsxs("span",{className:"text-text",children:["Cursor: ",sn(y)]}):a.jsx("span",{children:"Drag to filter"}),J&&y!=null&&a.jsxs("span",{className:"text-[11px] text-muted",children:["Cursor: ",sn(y)]})]}),a.jsx("span",{children:sn(z==null?void 0:z.max)})]}),a.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2 mt-3 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Min"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:R,placeholder:Fr(z.min),onFocus:()=>X("min"),onBlur:()=>{X(null),se(R,N)},onChange:U=>M(U.target.value),onKeyDown:U=>{U.key==="Enter"&&U.currentTarget.blur()}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Max"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:N,placeholder:Fr(z.max),onFocus:()=>X("max"),onBlur:()=>{X(null),se(R,N)},onChange:U=>O(U.target.value),onKeyDown:U=>{U.key==="Enter"&&U.currentTarget.blur()}})]}),a.jsx("button",{className:"btn btn-xs btn-ghost text-muted hover:text-text",onClick:()=>i(n,null),children:"Clear"})]})]})}function Bc(e,t,n){if(!e.length)return null;const r=n?n.min:Math.min(...e);let s=n?n.max:Math.max(...e);r===s&&(s=r+1);const i=new Array(t).fill(0),o=t/(s-r);for(const l of e){const u=Math.max(0,Math.min(t-1,Math.floor((l-r)*o)));i[u]+=1}return{bins:i,min:r,max:s,count:e.length}}function gg(e,t){var r;const n=[];for(const s of e){const i=(r=s.metrics)==null?void 0:r[t];i==null||Number.isNaN(i)||n.push(i)}return n}function Uc(e,t,n){const r=Math.max(1,...e),s=(n==null?void 0:n.opacity)??.9;return e.map((i,o)=>{const l=i/r*100;return a.jsx("rect",{x:o+.05,y:100-l,width:.9,height:l,fill:t,opacity:s},`${t}-${o}`)})}function TE(e,t){const n=(e.min-t.min)/(t.max-t.min),r=(e.max-t.min)/(t.max-t.min),s=Ls*Sh(Math.min(n,r)),i=Ls*Math.abs(r-n);return a.jsx("rect",{x:s,y:0,width:Math.max(.5,i),height:100,fill:"rgba(255,255,255,0.08)",stroke:"rgba(255,255,255,0.4)",strokeWidth:.4})}function vg(e,t,n){const r=Sh((e-t.min)/(t.max-t.min)),s=Ls*r;return a.jsx("line",{x1:s,y1:0,x2:s,y2:100,stroke:n.color,strokeWidth:n.strokeWidth??.5,strokeDasharray:n.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}function yg(e,t){return e<t?{min:e,max:t}:{min:t,max:e}}function Sh(e){return e<0?0:e>1?1:e}function sn(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function Fr(e){if(!Number.isFinite(e))return"";const t=e.toString();return t.includes("e")?e.toFixed(6):t}function xg(e){const t=e.trim();if(!t)return{value:null,valid:!0};const n=Number(t);return Number.isFinite(n)?{value:n,valid:!0}:{value:null,valid:!1}}function wg(e,t,n){return e<t?t:e>n?n:e}function pi(e,t){const n=Math.max(1,Math.abs(e),Math.abs(t));return Math.abs(e-t)<=1e-6*n}function Sg(e){return e?e.length>=10?e.slice(0,10):e:""}const LE=[{label:"Root",path:"/"}],_E="w-11 h-11 rounded-md border border-border flex items-center justify-center transition-colors",IE="bg-accent-muted text-accent",FE="bg-surface text-text hover:bg-surface-hover";function xa(e){return`${_E} ${e?IE:FE}`}function OE({leftTool:e,onToolChange:t,compareEnabled:n,compareActive:r,onOpenCompare:s,views:i,activeViewId:o,onActivateView:l,onSaveView:u,current:d,data:f,onOpenFolder:h,onOpenFolderActions:p,onPullRefreshFolders:S,onContextMenu:w,countVersion:E,items:j,filteredItems:v,metricKeys:m,selectedItems:x,selectedMetric:y,onSelectMetric:k,filters:R,onChangeRange:M,onChangeFilters:N,onResize:O}){const T=xa(e==="folders"),X=xa(e==="metrics"),J=xa(r),z=`${xa(!1)} cursor-pointer`;return a.jsxs("div",{className:"app-left-panel col-start-1 row-start-2 relative border-r border-border bg-panel overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-y-0 left-0 w-12 border-r border-border flex flex-col items-center gap-2 py-3 bg-surface-overlay",children:[a.jsx("button",{className:T,title:"Folders","aria-label":"Folders","aria-pressed":e==="folders",onClick:()=>t("folders"),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M3 7.5h6l2-2h10a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2z"})})}),a.jsx("button",{className:X,title:"Metrics / Filters","aria-label":"Metrics and Filters","aria-pressed":e==="metrics",onClick:()=>t("metrics"),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]})}),a.jsx("div",{className:"w-6 h-px bg-border/70 my-1"}),a.jsx("button",{className:`${J} ${n?"":"opacity-40 cursor-not-allowed"}`,title:n?"Compare selected images":"Compare (select 2+)","aria-label":"Compare selected images","aria-pressed":r,"aria-disabled":!n,disabled:!n,onClick:()=>{n&&s()},children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("rect",{x:"3",y:"4",width:"8",height:"16",rx:"1"}),a.jsx("rect",{x:"13",y:"4",width:"8",height:"16",rx:"1"})]})}),a.jsx("div",{className:"flex-1"}),a.jsx("a",{className:z,href:"https://github.com/trojblue/lenslet",title:"Lenslet on GitHub","aria-label":"Lenslet on GitHub",target:"_blank",rel:"noreferrer",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:a.jsx("path",{d:"M12 .5C5.73.5.5 5.74.5 12.02c0 5.1 3.29 9.42 7.86 10.95.58.11.79-.25.79-.56v-2.17c-3.2.7-3.88-1.55-3.88-1.55-.53-1.35-1.29-1.71-1.29-1.71-1.05-.72.08-.71.08-.71 1.16.08 1.78 1.2 1.78 1.2 1.03 1.77 2.71 1.26 3.37.96.1-.75.4-1.26.73-1.55-2.55-.29-5.23-1.29-5.23-5.74 0-1.27.45-2.31 1.19-3.13-.12-.29-.52-1.46.11-3.05 0 0 .97-.31 3.18 1.19.92-.26 1.91-.39 2.89-.39.98 0 1.97.13 2.89.39 2.2-1.5 3.18-1.19 3.18-1.19.63 1.59.23 2.76.11 3.05.74.82 1.19 1.86 1.19 3.13 0 4.46-2.69 5.45-5.25 5.73.41.36.78 1.07.78 2.16v3.2c0 .31.21.67.8.56 4.56-1.53 7.85-5.85 7.85-10.95C23.5 5.74 18.27.5 12 .5z"})})})]}),a.jsx("div",{className:"ml-12 h-full",children:e==="folders"?a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-2 py-2 border-b border-border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Smart Folders"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:u,title:"Save current view as Smart Folder",children:"+ New"})]}),i.length?a.jsx("div",{className:"flex flex-col gap-1",children:i.map(le=>{const Q=le.id===o;return a.jsx("button",{className:`text-left px-2 py-2 rounded-md text-sm ${Q?"bg-accent-muted text-accent":"hover:bg-hover text-text"}`,onClick:()=>l(le),children:le.name},le.id)})}):a.jsx("div",{className:"text-xs text-muted px-1 py-1.5",children:"No saved Smart Folders yet."})]}),a.jsx(EE,{current:d,roots:LE,data:f,onOpen:h,onPullRefresh:S,onContextMenu:w,onOpenActions:p,countVersion:E,className:"flex-1 min-h-0 overflow-auto scrollbar-thin",showResizeHandle:!1})]}):a.jsx(jE,{items:j,filteredItems:v,metricKeys:m,selectedItems:x,selectedMetric:y,onSelectMetric:k,filters:R,onChangeRange:M,onChangeFilters:N})}),a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 right-0",onPointerDown:O})]})}function AE({persistenceEnabled:e,offViewSummary:t,onRevealOffView:n,canRevealOffView:r=!1,onClearOffView:s,browserZoomPercent:i}){const l=!!(t!=null&&t.names.length)&&t?` (${t.names.join(", ")}${t.extra?` +${t.extra}`:""})`:"",u=r&&n!=null,d=typeof i=="number"?i:null,f=d!==null&&Math.abs(d-100)>=2;return!e||f||!!t?a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-col gap-2",children:[!e&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Not persisted."})," Workspace is read-only; edits stay in memory until restart."]}),f&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Browser zoom ",Math.round(d),"%."]})," For best results, set it to 100% so UI elements stay in correct proportions."]}),t&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex items-center justify-between gap-3",children:[a.jsxs("span",{children:["Updates outside current view: ",t.count," item",t.count===1?"":"s",l]}),a.jsxs("div",{className:"flex items-center gap-2",children:[u&&a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>n==null?void 0:n(),"aria-label":"Reveal off-view updates",children:"Reveal"}),a.jsx("button",{className:"text-muted hover:text-text transition-colors text-base leading-none",onClick:s,"aria-label":"Clear off-view updates",children:""})]})]})]})}):null}const DE=6e3,zE=1e4,$E=24*60*6e4,BE=3e4,UE=350,HE=1400,VE=2048,WE=6,QE=10;function Hx(e){const t=new Map;for(const n of e)t.set(n.path,n.name);return t}function Vx(e,t){return t.get(e)??e.split("/").pop()??e}function bg(e,t){const n=e.filter(r=>!t.has(r.path));return n.length===e.length?e:n}function Cg(e,t,n,r,s){const i=e.filter(l=>l.path!==t);return[{path:t,ts:n,kind:r},...i].slice(0,s)}function KE(e,t){if(!e.length)return null;const n=Hx(t),r=new Set,s=[];for(const o of e)r.has(o.path)||(r.add(o.path),s.push(o.path));const i=s.slice(0,2).map(o=>Vx(o,n));return{count:s.length,names:i,extra:Math.max(0,s.length-i.length)}}function YE(e,t,n,r){if(!e.length)return[];const s=Hx(t);return e.map(i=>({path:i.path,label:Vx(i.path,s),timeLabel:r(i.ts,n)}))}function XE(e){const[t,n]=c.useState([]),[r,s]=c.useState([]),[i,o]=c.useState(new Map),l=c.useRef(new Map),u=c.useRef(new Set),d=c.useRef(new Set),f=c.useRef(new Set);c.useEffect(()=>()=>{for(const j of l.current.values())window.clearTimeout(j);l.current.clear(),u.current.clear()},[]),c.useEffect(()=>{d.current=new Set(e),n(j=>bg(j,f.current))},[e]);const h=c.useCallback((j,v)=>{if(v!=null){if(u.current.has(v))return;if(u.current.add(v),u.current.size>VE){const R=u.current.values().next().value;R!=null&&u.current.delete(R)}}const m=v!=null?`event:${v}`:`event:${j}:${Date.now()}`;o(R=>{if(R.get(j)===m)return R;const M=new Map(R);return M.set(j,m),M});const x=l.current,y=x.get(j);y!=null&&window.clearTimeout(y);const k=window.setTimeout(()=>{o(R=>{if(R.get(j)!==m)return R;const M=new Map(R);return M.delete(j),M}),x.delete(j)},HE);x.set(j,k)},[]),p=c.useCallback(j=>{f.current=j,n(v=>bg(v,j))},[]),S=c.useCallback((j,v,m)=>{const x=Date.now();d.current.has(j)&&f.current.has(j)||n(k=>Cg(k,j,x,v,WE)),h(j,m)},[h]),w=c.useCallback((j,v,m)=>{const x=Date.now(),y=jx(m)??x;s(k=>Cg(k,j,y,v,QE))},[]),E=c.useCallback(()=>{n([])},[]);return{offViewActivity:t,recentTouches:r,highlightedPaths:i,onVisiblePathsChange:p,markRecentActivity:S,markRecentTouch:w,clearOffViewActivity:E}}function qE(e){return e.isOffline?"offline":e.isUnstable?"unstable":e.recentEditActive?"recent":Number.isFinite(e.editingCount)&&e.editingCount>0?"editing":"live"}function Wx(e){if(!e.length)return e;const t=new Set,n=[];for(const r of e)t.has(r.path)||(t.add(r.path),n.push(r));return n}function Qx(e){return{...e,items:Wx(e.items)}}function GE(e,t){const n=e.pageCount??1,r=e.pageSize??t,s=(e.page??1)+1;return n<=1||s>n?null:{startPage:s,endPage:n,pageSize:r}}function JE(e,t){if(e.path!==t.path)return Qx(t);const n=Wx([...e.items,...t.items]);return{...e,generatedAt:t.generatedAt??e.generatedAt,dirs:e.dirs.length?e.dirs:t.dirs,items:n,page:t.page??e.page,pageSize:t.pageSize??e.pageSize,pageCount:t.pageCount??e.pageCount,totalItems:t.totalItems??e.totalItems}}async function ZE(e,t){const n=t.shouldContinue??(()=>!0);let r=Qx(e);t.onUpdate(r);const s=GE(e,t.defaultPageSize);if(s)for(let i=s.startPage;i<=s.endPage;i+=1){let o;try{o=await t.fetchPage(i,s.pageSize)}catch{return}if(!n())return;r=JE(r,o),t.onUpdate(r)}}const Kx=[-2,-1,1,2],Yx=[-2,-1,0,1,2,3];Kx.length;Yx.length;function eN(e,t,n){return Math.min(Math.max(e,t),n)}function Xx(e,t,n){const r=new Set,s=[];for(const i of n){const o=t+i;if(o<0||o>=e.length)continue;const l=e[o];!l||r.has(l)||(r.add(l),s.push(l))}return s}function tN(e,t){if(!t)return[];const n=e.indexOf(t);return n<0?[]:Xx(e,n,Kx)}function nN(e,t){if(e.length<2)return[];const n=Math.max(0,e.length-2),r=eN(t,0,n);return Xx(e,r,Yx)}function rN({paths:e,defaultDestination:t,destinations:n,loadingDestinations:r,onClose:s,onSubmit:i}){const[o,l]=c.useState(()=>Ct(t||"/")),[u,d]=c.useState(!1);c.useEffect(()=>{l(Ct(t||"/"))},[t,e]);const f=Ct(o||"/"),h=e.length>0&&!u,p=e.slice(0,3).map(j=>xh(j)||j),S=Math.max(0,e.length-p.length),w=n.filter(j=>j!==f).slice(0,8),E=async j=>{if(j.preventDefault(),!!h){d(!0);try{await i(e,f)}finally{d(!1)}}};return a.jsx("div",{className:"toolbar-offset fixed inset-0 z-overlay bg-black/45 backdrop-blur-[1px] flex items-center justify-center p-3",children:a.jsxs("div",{className:"w-full max-w-[560px] rounded-xl border border-border bg-panel shadow-[0_20px_60px_rgba(0,0,0,0.55)]",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Move to folder"}),a.jsxs("div",{className:"text-xs text-muted",children:[e.length," item(s) selected"]})]}),a.jsx("button",{type:"button",className:"btn btn-icon",onClick:s,"aria-label":"Close move dialog",disabled:u,children:""})]}),a.jsxs("form",{className:"px-4 py-3 flex flex-col gap-3",onSubmit:E,children:[a.jsxs("div",{className:"text-xs text-muted",children:[p.join(", "),S>0?` and ${S} more`:""]}),a.jsxs("label",{className:"text-xs text-muted flex flex-col gap-1.5",children:["Destination folder",a.jsx("input",{value:o,onChange:j=>l(j.target.value),className:"input w-full",list:"move-destination-list",placeholder:"/",autoFocus:!0,disabled:u})]}),a.jsx("datalist",{id:"move-destination-list",children:n.map(j=>a.jsx("option",{value:j},j))}),a.jsx("div",{className:"text-[11px] text-muted",children:r?"Loading folder list":`${n.length.toLocaleString()} destination(s) loaded`}),w.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5",children:w.map(j=>a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>l(j),disabled:u,children:j},j))}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-border",children:[a.jsx("button",{type:"button",className:"btn",onClick:s,disabled:u,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-active",disabled:!h,children:u?"Moving":"Move"})]})]})]})})}function sN(e){return JSON.stringify(e,null,2)}function iN(e){const t=s=>'"'+s.replaceAll('"','""')+'"',n="path,folder,name,star,type,size,width,height,tags,notes",r=e.map(s=>{const i=(s.tags||[]).join(" "),o=s.notes||"";return[s.path,s.folder,s.name,String(s.star??""),s.type??"",s.size??"",s.width??"",s.height??"",i,o].map(l=>t(String(l))).join(",")});return[n,...r].join(`
`)}function oN(e){return e.map(t=>{const n=t.path.split("/").filter(Boolean);n.pop();const r=n.length?`/${n.join("/")}`:"/";return{path:t.path,folder:r,name:t.name,star:t.star??null,type:t.type,size:t.size,width:t.w,height:t.h}})}function lN({x:e,y:t,items:n}){const r=c.useRef(null),[s,i]=c.useState({x:e,y:t}),[o,l]=c.useState(!1),u=c.useCallback((f,h)=>{h.stopPropagation(),f.disabled||f.onClick()},[]),d=c.useCallback(()=>{const f=r.current,h=mx(),p=f==null?void 0:f.getBoundingClientRect(),S=(p==null?void 0:p.width)??180,w=(p==null?void 0:p.height)??Math.max(40,n.length*36),E=px({x:e,y:t,menuWidth:S,menuHeight:w,viewport:h});i(j=>j.x===E.x&&j.y===E.y?j:E),l(!0)},[n.length,e,t]);return c.useLayoutEffect(()=>{d()},[d]),c.useEffect(()=>(window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}),[d]),a.jsx("div",{ref:r,className:"dropdown-panel fixed",role:"menu",style:{left:s.x,top:s.y,minWidth:180,visibility:o?"visible":"hidden"},onClick:f=>f.stopPropagation(),children:n.map((f,h)=>a.jsxs("button",{className:`dropdown-item w-full ${f.danger?"text-danger hover:text-danger":""}`,role:"menuitem","aria-disabled":f.disabled,disabled:f.disabled,onClick:p=>u(f,p),children:[f.icon&&a.jsx("span",{className:"shrink-0",children:f.icon}),a.jsx("span",{children:f.label})]},h))})}function kg(e){return e==="csv"?"text/csv;charset=utf-8":"application/json;charset=utf-8"}function Eg(e,t){const n=oN(e);return t==="csv"?iN(n):sN(n)}function Ng(){return new Date().toISOString().replace(/[:.]/g,"-")}function aN({ctx:e,current:t,items:n,setCtx:r,onRefetch:s,onOpenMoveDialog:i,onRefreshFolder:o}){const l=Dk(t),[u,d]=c.useState(!1),[f,h]=c.useState(null),p=e.kind==="grid"?e.payload.paths:[],S=c.useMemo(()=>new Map(n.map(M=>[M.path,M])),[n]),w=()=>{r(null)},E=async()=>{const M=e.kind==="tree"?e.payload.path:"/";d(!0);try{await o(M)}catch(N){console.error("Failed to refresh folder:",N)}finally{d(!1),w()}},j=M=>async()=>{h(M);const N=e.kind==="tree"?e.payload.path:t;try{const O=await Se.getFolder(N,{recursive:!0,legacyRecursive:!0}),T=Eg(O.items,M),X=kg(M),J=N==="/"?"root":(N.replace(/^\/+/,"")||"root").replace(/\//g,"_");Ko(new Blob([T],{type:X}),`metadata_${J}_${Ng()}.${M}`)}catch(O){console.error("Failed to export folder:",O),alert("Failed to export folder. See console for details.")}finally{h(null),w()}},v=M=>async()=>{h(M);try{const N=new Set(p),O=n.filter(J=>N.has(J.path)),T=Eg(O,M),X=kg(M);Ko(new Blob([T],{type:X}),`metadata_selection_${Ng()}.${M}`)}finally{h(null),w()}},m=async()=>{var M;if(p.length){w();for(const N of p)try{const O=await Se.getFile(N),T=((M=S.get(N))==null?void 0:M.name)||xh(N)||"image";Ko(O,T)}catch(O){console.error(`Failed to download ${N}:`,O)}}},x=async()=>{if(!l){for(const M of p)try{await Se.moveFile(M,"/_trash_")}catch(N){console.error(`Failed to trash ${M}:`,N)}s(),w()}},y=async()=>{if(confirm(`Delete ${p.length} file(s) permanently? This cannot be undone.`)){try{await Se.deleteFiles(p)}catch(M){console.error("Failed to delete files:",M)}s(),w()}},k=async()=>{for(const M of p)try{const O=(await Se.getSidecar(M)).original_position,T=O&&O.split("/").slice(0,-1).join("/")||"/";await Se.moveFile(M,T)}catch(N){console.error(`Failed to recover ${M}:`,N)}s(),w()},R=e.kind==="tree"?[{label:u?"Refreshing":"Refresh",disabled:u,onClick:E},{label:f==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!f||u,onClick:j("csv")},{label:f==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!f||u,onClick:j("json")}]:uN({selectedPaths:p,inTrash:l,exporting:f,onDownloadSelection:m,onMoveSelection:i,onMoveToTrash:x,onPermanentDelete:y,onRecover:k,onExportCsv:v("csv"),onExportJson:v("json")});return a.jsx(lN,{x:e.x,y:e.y,items:R})}function uN({selectedPaths:e,inTrash:t,exporting:n,onDownloadSelection:r,onMoveSelection:s,onMoveToTrash:i,onPermanentDelete:o,onRecover:l,onExportCsv:u,onExportJson:d}){const f=[];return e.length&&f.push({label:e.length>1?`Download (${e.length})`:"Download",onClick:r}),e.length&&f.push({label:"Move to",disabled:t,onClick:()=>{t||s(e)}}),f.push({label:"Move to trash",disabled:t,onClick:i}),t&&(f.push({label:"Permanent delete",danger:!0,onClick:o}),f.push({label:"Recover",onClick:l})),e.length&&(f.push({label:n==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!n,onClick:u}),f.push({label:n==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!n,onClick:d})),f}const qe={sortKey:"sortKey",sortDir:"sortDir",sortSpec:"sortSpec",starFilters:"starFilters",filterAst:"filterAst",selectedMetric:"selectedMetric",viewMode:"viewMode",gridItemSize:"gridItemSize",leftOpen:"leftOpen",rightOpen:"rightOpen"},cN=600;function dN(e){switch(e){case"live":return"Live";case"reconnecting":return"Reconnecting";case"offline":return"Offline";case"connecting":case"idle":default:return"Connecting"}}function jg(e){if(!(e instanceof un))return null;const t=e.body;if(!t||typeof t!="object")return null;const n=t.error;return typeof n=="string"?n:null}function Mg(e,t){for(const n of e)Se.prefetchFile(n,t),Se.prefetchThumb(n)}function Rg(e,t){return t-e<$E?nk(e,t):rk(e)}function fN(e,t){return e?t instanceof un||t instanceof Error?t.message:"Failed to load embeddings.":null}function hN(e,t,n,r){return e||t?n:r}function pN(e,t,n,r,s,i){return e?n:t||i==="/"?r:s}function mN(e){if(!(e instanceof un))return!1;if(e.status===403||e.status===405)return!0;const t=String(e.message||"").toLowerCase();return t.includes("read-only")||t.includes("no-write")||t.includes("write")}function To(e,t){return mN(e)?"This workspace is read-only. Upload and move actions are disabled.":e instanceof un||e instanceof Error&&e.message?e.message:t}function Hc(e){return Array.from(new Set(e.filter(Boolean)))}function Pg(e,t){return t.length?t.length===1?t[0]:`${e} failed for ${t.length} item(s). ${t[0]}`:""}function gN(){var Oh,Ah,Dh;const[e,t]=c.useState("/"),[n,r]=c.useState(""),[s,i]=c.useState([]),[o,l]=c.useState(!1),[u,d]=c.useState(null),[f,h]=c.useState(null),[p,S]=c.useState(!1),[w,E]=c.useState(0),[j,v]=c.useState(0),[m,x]=c.useState(null),[y,k]=c.useState(100),[R,M]=c.useState(null),[N,O]=c.useState(()=>({filters:{and:[]},sort:{kind:"builtin",key:"added",dir:"desc"},selectedMetric:void 0})),[T,X]=c.useState(()=>Date.now()),[J,z]=c.useState("adaptive"),[le,Q]=c.useState(220),[A,_]=c.useState(!1),[P,D]=c.useState(!0),[H,te]=c.useState(!0),[se,I]=c.useState(()=>typeof window>"u"?1440:window.innerWidth),U=Ia(_a.narrow),[Y,Z]=c.useState("folders"),[q,ne]=c.useState([]),[fe,je]=c.useState(null),[xe,De]=c.useState(0),[be,Ie]=c.useState({}),lt=c.useRef(null),gt=c.useRef(null),hn=c.useRef(null),Bn=c.useRef(null),Gt=c.useRef(null),Ze=c.useRef(!1),Jt=c.useRef(!1),zt=c.useRef(null),pn=c.useRef(null),Un=c.useRef(!1),Hn=c.useRef(ro()),$t=c.useRef(null),Qe=c.useRef(null),Nt=c.useRef(null),mn=c.useRef(!1),Zt=c.useRef(null),en=c.useRef("idle"),{leftW:gn,rightW:Vn,onResizeLeft:$,onResizeRight:ee}=pE(lt,Y),[K,me]=c.useState(!1),[ve,ge]=c.useState(!1),[pe,ke]=c.useState(null),[we,at]=c.useState(null),[Oe,Me]=c.useState(["/"]),[jt,vn]=c.useState(!1),[Rn,Te]=c.useState(null),vt=Zs(),hs=VC(),Hu=zu(),jl=QC(),[tn,Ml]=c.useState("idle"),[Rl,ir]=c.useState({}),[or,yt]=c.useState(null),[ps,nn]=c.useState(null),[rn,lr]=c.useState(!1),[ms,ei]=c.useState(()=>Date.now()),[Vu,ti]=c.useState(!0),[ni,ar]=c.useState(!1);c.useEffect(()=>{const g=L=>{const B=Ct(L),V=Ak(B)?B:null,oe=V?qm(B):B,ye=!Un.current;Un.current=!0,V?(h(V),i([V])):(h(null),Ze.current=!1),t(G=>{const ce=ak(G,oe,V,ye);return G===ce?G:(v(Ee=>Ee+1),ce)})};g(Ym());const C=()=>g(Ym());return window.addEventListener("hashchange",C),()=>window.removeEventListener("hashchange",C)},[]),c.useEffect(()=>{if(ps==null){lr(!1);return}lr(!0);const g=window.setTimeout(()=>lr(!1),DE);return()=>window.clearTimeout(g)},[ps]),c.useEffect(()=>{if(or==null)return;ei(Date.now());const g=window.setInterval(()=>ei(Date.now()),1e4);return()=>window.clearInterval(g)},[or]);const{data:gs,refetch:ao,isLoading:vs,isError:ys}=uf(e,!0,{page:1,pageSize:Aa}),[et,Pl]=c.useState(),ri=c.useRef(0),Wn=c.useCallback(()=>ao(),[ao]),{data:ur}=uf("/",!0,{enabled:!1,page:1,pageSize:Aa});c.useEffect(()=>{vt.removeQueries({predicate:({queryKey:g})=>jk(g,e,!0)})},[e,vt]),c.useEffect(()=>{ri.current+=1,Pl(void 0),ke(null)},[e]),c.useEffect(()=>{if(!gs)return;const g=++ri.current;let C=!1;return ZE(gs,{defaultPageSize:Aa,fetchPage:(L,B)=>Se.getFolder(gs.path,{recursive:!0,page:L,pageSize:B}),onUpdate:Pl,shouldContinue:()=>!C&&ri.current===g}),()=>{C=!0}},[gs]);const Bt=u!==null,Qn=!Bt&&n.trim().length>0,xs=mE(n,250),Tl=c.useMemo(()=>xs.trim().replace(/\s+/g," "),[xs]),si=Lk(Qn?Tl:"",e),Pr=Ik(),uo=((Oh=Pr.data)==null?void 0:Oh.embeddings)??[],co=((Ah=Pr.data)==null?void 0:Ah.rejected)??[],ii=uo.length>0,Ll=fN(Pr.isError,Pr.error),Ut=c.useMemo(()=>Ct(e||"/"),[e]),fo=c.useMemo(()=>Gm(N.filters),[N.filters]),xt=c.useMemo(()=>{var C;return(Qn?((C=si.data)==null?void 0:C.items)??[]:(et==null?void 0:et.items)??[]).map(L=>({...L,star:be[L.path]!==void 0?be[L.path]:L.star}))},[Qn,si.data,et,be]),_l=c.useMemo(()=>{var L;const g=new Map;for(const B of xt)g.set(B.path,B);const C=((L=si.data)==null?void 0:L.items)??[];for(const B of C){if(g.has(B.path))continue;const V=be[B.path]!==void 0?be[B.path]:B.star;g.set(B.path,{...B,star:V})}return g},[xt,si.data,be]),yn=c.useMemo(()=>u?u.items.map(g=>{const C=_l.get(g.path);return C||dk(g.path,be[g.path])}):[],[u,_l,be]),Ke=c.useMemo(()=>{if(u)return ng(yn,N.filters);const g=ng(xt,N.filters);return uE(g,N.sort,T)},[u,yn,xt,N.filters,N.sort,T]),ws=u?yn.length:xt.length,ho=Ke.length,xn=c.useMemo(()=>Ke.map(g=>g.path),[Ke]),{offViewActivity:cr,recentTouches:po,highlightedPaths:Kn,onVisiblePathsChange:oi,markRecentActivity:Tr,markRecentTouch:li,clearOffViewActivity:F}=XE(xn),ie=c.useMemo(()=>new Set(s),[s]),de=c.useMemo(()=>{if(!s.length)return[];const g=u?yn:xt,C=new Map(g.map(B=>[B.path,B])),L=new Map(Ke.map(B=>[B.path,B]));return s.map(B=>C.get(B)??L.get(B)).filter(B=>!!B)},[s,u,yn,xt,Ke]),ue=c.useMemo(()=>Ke.filter(g=>ie.has(g.path)),[Ke,ie]),Le=c.useMemo(()=>ue.map(g=>g.path),[ue]),Mt=Math.max(0,ue.length-2),Rt=Math.min(w,Mt),Ss=ue[Rt]??null,bs=ue[Rt+1]??null,tt=Rt>0,dr=Rt<ue.length-2,Yn=ue.length>=2,Il=u?yn:xt,ai=u?null:N.sort.kind==="metric"?N.sort.key:null,Pt=c.useMemo(()=>ai?Ke.some(g=>{var L;const C=(L=g.metrics)==null?void 0:L[ai];return C!=null&&!Number.isNaN(C)}):!1,[Ke,ai]);c.useEffect(()=>{E(g=>g>Mt?Mt:g)},[Mt]);const Lr=c.useCallback(g=>{const C=Date.now(),B=jx(g)??C,V=B>C?C:B;yt(oe=>oe==null?V:oe>V?oe:V),nn(C),ei(C)},[]),ui=c.useCallback(g=>{const C=Object.prototype.hasOwnProperty.call(g,"star"),L=g.metrics!==void 0,B=g.comments!==void 0;if(!C&&!L&&!B)return;const V=ye=>{if(ye.path!==g.path)return ye;let G=ye;return C&&ye.star!==g.star&&(G={...G,star:g.star??null}),L&&(G={...G,metrics:g.metrics??null}),B&&ye.comments!==g.comments&&(G={...G,comments:g.comments??""}),G},oe=ye=>{if(!ye)return ye;let G=!1;const ce=ye.items.map(Ee=>{const Ht=V(Ee);return Ht!==Ee&&(G=!0),Ht});return G?{...ye,items:ce}:ye};vt.setQueriesData({predicate:({queryKey:ye})=>Array.isArray(ye)&&ye[0]==="folder"},oe),vt.setQueriesData({predicate:({queryKey:ye})=>Array.isArray(ye)&&ye[0]==="search"},oe)},[vt]),Cs=c.useCallback(()=>{De(g=>g+1)},[]),mo=c.useCallback(g=>{const C=Ct(g||"/");return C===""?"/":C},[]),Fl=c.useCallback(g=>{const C=L=>g==="/"?!0:L===g||L.startsWith(`${g}/`);vt.invalidateQueries({predicate:({queryKey:L})=>{if(!Array.isArray(L)||L[0]!=="folder")return!1;const B=typeof L[1]=="string"?L[1]:"";return C(B)}})},[vt]),go=c.useCallback(async g=>{const C=mo(g);await Se.refreshFolder(C),Fl(C),Cs(),(e===C||e.startsWith(C==="/"?"/":`${C}/`))&&await Wn(),qd.evictPrefix(C),mi.evictPrefix(C)},[e,Cs,Fl,mo,Wn]),qx=c.useCallback(async()=>{try{await go(e)}catch(g){console.error("Failed to refresh folder:",g)}},[e,go]),ci=c.useCallback(g=>{g.length&&ir(C=>{let L=!1;const B={...C};for(const V of g){const oe=C[V.gallery_id];oe&&oe.viewing===V.viewing&&oe.editing===V.editing||(B[V.gallery_id]=V,L=!0)}return L?B:C})},[]),Ol=c.useCallback(()=>{Zt.current!=null&&(window.clearTimeout(Zt.current),Zt.current=null)},[]),Al=c.useCallback(g=>{g&&ir(C=>{if(!(g in C))return C;const L={...C};return delete L[g],L})},[]),Wu=c.useCallback(g=>{$t.current=g.lease_id,Qe.current=g.gallery_id,ci([g])},[ci]),Xn=c.useCallback(async(g,C=!1)=>{const L=Hn.current,B=C?void 0:$t.current??void 0,V=oe=>Se.joinPresence(g,oe,L);try{Wu(await V(B));return}catch(oe){if(!C&&jg(oe)==="invalid_lease"){Wu(await V(void 0));return}throw oe}},[Wu]),bh=c.useCallback(async(g,C)=>{if(g===C){await Xn(C);return}const L=$t.current;if(!L){await Xn(C,!0);return}try{const B=await Se.movePresence(g,C,L,Hn.current);Qe.current=B.to_scope.gallery_id,ci([B.from_scope,B.to_scope]);return}catch(B){const V=jg(B);if(V==="invalid_lease"){await Xn(C,!0);return}if(V==="scope_mismatch"){await Xn(C);return}throw B}},[ci,Xn]),Ch=c.useCallback(async g=>{const C=Qe.current;if(!C){await Xn(g,!0);return}if(C===g){await Xn(g);return}await bh(C,g)},[Xn,bh]),Dl=c.useCallback(async()=>{if(mn.current)return;const g=Nt.current;if(g){Nt.current=null,mn.current=!0;try{await Ch(g)}catch{}finally{mn.current=!1;const C=Nt.current;C&&C!==Qe.current&&Dl()}}},[Ch]),di=c.useCallback((g,C=!1)=>{if(Nt.current=g,Ol(),C||Qe.current==null){Dl();return}Zt.current=window.setTimeout(()=>{Zt.current=null,Dl()},UE)},[Ol,Dl]),kh=c.useCallback(()=>{Qe.current=null,$t.current=null,Nt.current=null,Ol()},[Ol]),zl=c.useCallback(g=>{const C=Qe.current,L=$t.current;!C||!L||(Nb(C,L,Hn.current),g&&Al(C),kh())},[Al,kh]);c.useEffect(()=>{xb();const g=Sb(L=>{if(L.type==="presence"){const oe=L.data;if(!(oe!=null&&oe.gallery_id))return;ci([oe]);return}const B=L.data;if(!(B!=null&&B.path))return;const V=B.path;if(L.type==="item-updated"){const oe=L.data,ye={v:1,tags:oe.tags??[],notes:oe.notes??"",star:oe.star??null,version:oe.version??1,updated_at:oe.updated_at??"",updated_by:oe.updated_by??"server"};vt.setQueryData(ml(V),ye),ui({path:V,star:oe.star??null,metrics:oe.metrics,comments:oe.notes??""}),XC(V,ye),Tr(V,"item-updated",L.id),li(V,"item-updated",oe.updated_at),Lr(oe.updated_at),Ie(G=>{if(G[V]===void 0)return G;const ce={...G};return delete ce[V],ce})}else if(L.type==="metrics-updated"){const oe=L.data;ui({path:V,metrics:oe.metrics}),Tr(V,"metrics-updated",L.id),li(V,"metrics-updated",oe.updated_at),Lr(oe.updated_at)}}),C=bb(Ml);return()=>{g(),C(),wb()}},[ci,Tr,li,vt,ui,Lr]),c.useEffect(()=>{const g=Qe.current;g!==Ut&&di(Ut,g==null)},[Ut,di]),c.useEffect(()=>{const g=window.setInterval(()=>{const C=Qe.current;C&&Xn(C)},BE);return()=>{window.clearInterval(g)}},[Xn]),c.useEffect(()=>{const g=en.current;if(en.current=tn,tn==="live"&&g!=="live"){di(Ut,!0);return}(tn==="reconnecting"||tn==="offline")&&Al(Qe.current)},[Al,tn,Ut,di]),c.useEffect(()=>{const g=()=>zl(!0),C=()=>zl(!0),L=()=>{di(Ut,!0)};return window.addEventListener("pagehide",g),window.addEventListener("beforeunload",C),window.addEventListener("pageshow",L),()=>{window.removeEventListener("pagehide",g),window.removeEventListener("beforeunload",C),window.removeEventListener("pageshow",L),zl(!1)}},[Ut,di,zl]),c.useEffect(()=>{let g=!1;return Se.getHealth().then(C=>{var B;if(g)return;const L=((B=C==null?void 0:C.labels)==null?void 0:B.enabled)??!0;ti(L)}).catch(()=>{}),()=>{g=!0}},[]);const Gx=c.useMemo(()=>{const g=u?yn:xt,C={0:0,1:0,2:0,3:0,4:0,5:0};for(const L of g){const B=be[L.path]??L.star??0;C[String(B)]=(C[String(B)]||0)+1}return C},[u,yn,xt,be]),_r=c.useMemo(()=>{const g=new Set;let C=0;const L=u?yn:xt;for(const B of L){const V=B.metrics;if(V)for(const oe of Object.keys(V))g.add(oe);if(C+=1,C>=250&&g.size>0)break}return Array.from(g).sort()},[u,yn,xt]);c.useEffect(()=>{Bt||_r.length&&O(g=>{const C=g.selectedMetric&&_r.includes(g.selectedMetric)?g.selectedMetric:_r[0];return C===g.selectedMetric?g:{...g,selectedMetric:C}})},[_r,Bt]),c.useEffect(()=>{Bt||N.sort.kind==="metric"&&(_r.includes(N.sort.key)||O(g=>({...g,sort:{kind:"builtin",key:"added",dir:g.sort.dir}})))},[_r,N.sort,Bt]);const $l=c.useMemo(()=>rE(N.filters),[N.filters]),Bl=(et==null?void 0:et.totalItems)??(et==null?void 0:et.items.length)??ws,Jx=e==="/"?Bl:(ur==null?void 0:ur.totalItems)??(ur==null?void 0:ur.items.length)??Bl,Qu=Bt||Qn||$l>0,Ul=Rl[e],Zx=hs.state==="syncing"?"Syncing":hs.state==="error"?hs.message?`Not saved  ${hs.message}`:"Not saved  retry":"All changes saved",e0=dN(tn),Ku=or!=null,t0=c.useMemo(()=>!Ku||or==null?"No edits yet.":Rg(or,ms),[Ku,or,ms]),n0=(Ul==null?void 0:Ul.editing)??0,r0=jl!=null&&jl>zE,s0=tn==="offline"||tn==="connecting"||tn==="idle",i0=tn==="reconnecting"||Hu||hs.state==="error"||r0,o0=qE({isOffline:s0,isUnstable:i0,recentEditActive:rn,editingCount:n0}),l0=c.useMemo(()=>KE(cr,Ke),[cr,Ke]),a0=c.useMemo(()=>YE(po,Ke,ms,Rg),[Ke,ms,po]),u0=hN(Bt,Qu,ho,Bl),c0=pN(Bt,Qu,ws,Bl,Jx,e),Eh=c.useMemo(()=>{if(!u)return null;if(u.queryPath){const g=u.queryPath.split("/").filter(Boolean);return g.length?g[g.length-1]:u.queryPath}return u.queryVector?"Vector query":null},[u]),Nh=c.useMemo(()=>u?$l>0?`${ho} of ${ws}`:`${ws}`:null,[u,$l,ho,ws]),Tt=c.useCallback(g=>{O(C=>({...C,filters:g(C.filters)}))},[]),d0=c.useCallback(g=>{O(C=>({...C,filters:g}))},[]),Hl=c.useCallback(()=>{Tt(g=>$c(g,[]))},[Tt]),jh=c.useCallback(()=>{O(g=>({...g,filters:{and:[]}}))},[]),Yu=c.useCallback(()=>{d(null);const g=pn.current;pn.current=null,g&&g.length?(i(g),v(C=>C+1)):i([])},[]),f0=c.useCallback(()=>{u&&Yu(),r(""),O(g=>({...g,filters:{and:[]}}))},[Yu,u]),h0=c.useCallback(async g=>{!u&&pn.current===null&&(pn.current=s);const C=await Se.searchEmbeddings(g);if(d({embedding:C.embedding,queryPath:g.query_path??null,queryVector:g.query_vector_b64??null,topK:g.top_k??50,minScore:g.min_score??null,items:C.items,createdAt:Date.now()}),C.items.length){const L=g.query_path&&C.items.some(B=>B.path===g.query_path)?g.query_path:C.items[0].path;i([L]),v(B=>B+1)}else i([])},[u,s]),Xu=c.useCallback((g,C)=>{Tt(L=>nE(L,g,C))},[Tt]),Mh=c.useMemo(()=>{var C,L,B,V,oe,ye;const g=[];for(const G of N.filters.and)if("stars"in G){const ce=G.stars||[];if(!ce.length)continue;g.push({id:"stars",label:`Rating in: ${Fc(ce)}`,onRemove:()=>Hl()})}else if("starsIn"in G){const ce=G.starsIn.values||[];if(!ce.length)continue;g.push({id:"stars-in",label:`Rating in: ${Fc(ce)}`,onRemove:()=>Hl()})}else if("starsNotIn"in G){const ce=G.starsNotIn.values||[];if(!ce.length)continue;g.push({id:"stars-not-in",label:`Rating not in: ${Fc(ce)}`,onRemove:()=>Tt(Ee=>Ix(Ee,[]))})}else if("nameContains"in G){const ce=(C=G.nameContains.value)==null?void 0:C.trim();if(!ce)continue;g.push({id:"name-contains",label:`Filename contains: ${ce}`,onRemove:()=>Tt(Ee=>Fx(Ee,""))})}else if("nameNotContains"in G){const ce=(L=G.nameNotContains.value)==null?void 0:L.trim();if(!ce)continue;g.push({id:"name-not-contains",label:`Filename not: ${ce}`,onRemove:()=>Tt(Ee=>Ox(Ee,""))})}else if("commentsContains"in G){const ce=(B=G.commentsContains.value)==null?void 0:B.trim();if(!ce)continue;g.push({id:"comments-contains",label:`Comments contain: ${ce}`,onRemove:()=>Tt(Ee=>Ax(Ee,""))})}else if("commentsNotContains"in G){const ce=(V=G.commentsNotContains.value)==null?void 0:V.trim();if(!ce)continue;g.push({id:"comments-not-contains",label:`Comments not: ${ce}`,onRemove:()=>Tt(Ee=>Dx(Ee,""))})}else if("urlContains"in G){const ce=(oe=G.urlContains.value)==null?void 0:oe.trim();if(!ce)continue;g.push({id:"url-contains",label:`URL contains: ${ce}`,onRemove:()=>Tt(Ee=>zx(Ee,""))})}else if("urlNotContains"in G){const ce=(ye=G.urlNotContains.value)==null?void 0:ye.trim();if(!ce)continue;g.push({id:"url-not-contains",label:`URL not: ${ce}`,onRemove:()=>Tt(Ee=>$x(Ee,""))})}else if("dateRange"in G){const{from:ce,to:Ee}=G.dateRange;if(!ce&&!Ee)continue;g.push({id:"date-range",label:`Date: ${ok(ce,Ee)}`,onRemove:()=>Tt(Ht=>df(Ht,null))})}else if("widthCompare"in G){const{op:ce,value:Ee}=G.widthCompare;g.push({id:"width-compare",label:`Width ${ce} ${Ee}`,onRemove:()=>Tt(Ht=>Da(Ht,null))})}else if("heightCompare"in G){const{op:ce,value:Ee}=G.heightCompare;g.push({id:"height-compare",label:`Height ${ce} ${Ee}`,onRemove:()=>Tt(Ht=>za(Ht,null))})}else if("metricRange"in G){const{key:ce,min:Ee,max:Ht}=G.metricRange;g.push({id:`metric:${ce}`,label:`${ce}: ${uk(Ee,Ht)}`,onRemove:()=>Xu(ce,null)})}return g},[N.filters,Hl,Xu,Tt]),p0=c.useCallback(g=>{const C=new Set(fo);C.has(g)?C.delete(g):C.add(g),O(L=>({...L,filters:$c(L.filters,Array.from(C))}))},[fo]),m0=c.useCallback(()=>{D(!0),Z("metrics")},[]),g0=c.useCallback(g=>{O(C=>({...C,sort:g})),g.kind==="builtin"&&g.key==="random"&&X(Date.now())},[]),Rh=c.useCallback(g=>{if(g==="/"||g==="")return"Lenslet | Root";const C=g.split("/").filter(Boolean);if(!C.length)return"Lenslet";const L=C.slice(-2).join("/");return`Lenslet | ${C.length>2?`.../${L}`:`/${L}`}`},[]),v0=c.useMemo(()=>lk(e),[e]);c.useEffect(()=>{document.title=Rh(e)},[e,Rh]),c.useEffect(()=>{let g=!0;return Se.getViews().then(C=>{g&&ne(C.views||[])}).catch(()=>{g&&ne([])}),()=>{g=!1}},[]),c.useEffect(()=>{Qn&&(i([]),f&&(h(null),Ze.current=!1,ya(e)))},[Qn,f,e]),c.useEffect(()=>{const g=lt.current,C=Bn.current;if(!g||!C)return;const L=()=>{const B=Math.max(48,Math.round(C.getBoundingClientRect().height));g.style.setProperty("--toolbar-h",`${B}px`)};if(L(),"ResizeObserver"in window){const B=new ResizeObserver(L);return B.observe(C),()=>B.disconnect()}return window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[]),c.useEffect(()=>{try{const g=localStorage.getItem(qe.sortKey),C=localStorage.getItem(qe.sortDir),L=localStorage.getItem(qe.sortSpec),B=localStorage.getItem(qe.starFilters),V=localStorage.getItem(qe.filterAst),oe=localStorage.getItem(qe.selectedMetric),ye=localStorage.getItem(qe.viewMode),G=localStorage.getItem(qe.gridItemSize),ce=localStorage.getItem(qe.leftOpen),Ee=localStorage.getItem(qe.rightOpen),zh=(wt=>{if(!wt)return null;const nt=Ic(wt);return!nt||typeof nt!="object"?null:nt.kind==="builtin"&&(nt.key==="name"||nt.key==="added"||nt.key==="random")&&(nt.dir==="asc"||nt.dir==="desc")||nt.kind==="metric"&&typeof nt.key=="string"&&nt.key.length>0&&(nt.dir==="asc"||nt.dir==="desc")?nt:null})(L)??{kind:"builtin",key:g==="name"||g==="added"||g==="random"?g:"added",dir:C==="asc"||C==="desc"?C:"desc"};zh.key==="random"&&X(Date.now());let ec=(wt=>{if(!wt)return null;const nt=Ic(wt);return cf(nt)})(V)??{and:[]};if(B){const wt=Ic(B);if(Array.isArray(wt)){const nt=wt.filter(P0=>[0,1,2,3,4,5].includes(P0));ec=$c(ec,nt)}}if(O(wt=>({...wt,sort:zh,filters:ec,selectedMetric:oe||wt.selectedMetric})),(ye==="grid"||ye==="adaptive")&&z(ye),G){const wt=Number(G);!isNaN(wt)&&wt>=80&&wt<=500&&Q(wt)}(ce==="0"||ce==="false")&&D(!1),(Ee==="0"||Ee==="false")&&te(!1)}catch{}},[]),c.useEffect(()=>{U&&(D(!1),te(!1))},[U]),c.useEffect(()=>{if(typeof window>"u")return;const g=[1,1.25,1.5,1.75,2,3,4],C=V=>g.reduce((oe,ye)=>Math.abs(ye-V)<Math.abs(oe-V)?ye:oe,g[0]),L=()=>{var Ht;const V=window.devicePixelRatio||1,oe=C(V),ye=((Ht=window.visualViewport)==null?void 0:Ht.scale)??1,G=V*ye/oe;if(!Number.isFinite(G)){M(null);return}const ce=Math.round(G*100),Ee=Math.min(500,Math.max(25,ce));M(Ee)};L(),window.addEventListener("resize",L),window.addEventListener("orientationchange",L);const B=window.visualViewport;return B&&B.addEventListener("resize",L),()=>{window.removeEventListener("resize",L),window.removeEventListener("orientationchange",L),B&&B.removeEventListener("resize",L)}},[]),c.useEffect(()=>{try{localStorage.setItem(qe.sortKey,N.sort.kind==="builtin"?N.sort.key:"added"),localStorage.setItem(qe.sortDir,N.sort.dir),localStorage.setItem(qe.sortSpec,JSON.stringify(N.sort));const g=Gm(N.filters);localStorage.setItem(qe.starFilters,JSON.stringify(g)),localStorage.setItem(qe.filterAst,JSON.stringify(N.filters)),N.selectedMetric?localStorage.setItem(qe.selectedMetric,N.selectedMetric):localStorage.removeItem(qe.selectedMetric),localStorage.setItem(qe.viewMode,J),localStorage.setItem(qe.gridItemSize,String(le)),localStorage.setItem(qe.leftOpen,P?"1":"0"),localStorage.setItem(qe.rightOpen,H?"1":"0")}catch{}},[N,J,le,P,H]),c.useEffect(()=>{if(typeof window>"u")return;const g=()=>I(window.innerWidth);return g(),window.addEventListener("resize",g),window.addEventListener("orientationchange",g),()=>{window.removeEventListener("resize",g),window.removeEventListener("orientationchange",g)}},[]);const Vl=se<=ls.mobileMax;c.useEffect(()=>{Vl||A&&_(!1)},[Vl,A]),c.useEffect(()=>{const g=gt.current;if(!g)return;const C=B=>Math.min(500,Math.max(80,B)),L=B=>{B.ctrlKey&&(f||p||(B.preventDefault(),Q(V=>C(V+(B.deltaY<0?20:-20)))))};return g.addEventListener("wheel",L,{passive:!1}),()=>g.removeEventListener("wheel",L)},[f,p]),c.useEffect(()=>{if(f||p)return;const g=gt.current;if(!g)return;const C=G=>Math.min(500,Math.max(80,G));let L=null;const B=G=>{if(G.length<2)return 0;const[ce,Ee]=[G[0],G[1]];return Math.hypot(ce.clientX-Ee.clientX,ce.clientY-Ee.clientY)},V=G=>{if(G.touches.length!==2)return;const ce=B(G.touches);ce&&(L={dist:ce,size:le})},oe=G=>{if(!L||G.touches.length!==2)return;const ce=B(G.touches);if(!ce)return;G.preventDefault();const Ee=C(L.size*(ce/L.dist));Q(Ee)},ye=()=>{L=null};return g.addEventListener("touchstart",V,{passive:!0}),g.addEventListener("touchmove",oe,{passive:!1}),g.addEventListener("touchend",ye),g.addEventListener("touchcancel",ye),()=>{g.removeEventListener("touchstart",V),g.removeEventListener("touchmove",oe),g.removeEventListener("touchend",ye),g.removeEventListener("touchcancel",ye)}},[f,p,le]),c.useEffect(()=>{Mg(tN(xn,f),"viewer")},[f,xn]),c.useEffect(()=>{p&&Mg(nN(Le,Rt),"compare")},[p,Le,Rt]);const Wl=c.useCallback(g=>{h(null),Ze.current=!1;const C=Ct(g);t(C),Xm(C)},[]),qu=c.useCallback(g=>{const C=Hc(s);return C.includes(g)?C:[g]},[s]),y0=c.useCallback((g,C)=>{const L=qu(g);i(L),Te({x:C.x,y:C.y,kind:"grid",payload:{paths:L}})},[qu]),x0=c.useCallback((g,C)=>{Te({x:C.x,y:C.y,kind:"tree",payload:{path:g}})},[]),Ph=c.useCallback(async()=>{const g=["/"],C=new Set,L=new Set(["/"]);for(;g.length>0&&C.size<cN;){const B=g.shift()??"/",V=Ct(B);if(C.has(V))continue;C.add(V);let oe=null;try{oe=await Se.getFolder(V)}catch{oe=null}if(oe)for(const ye of oe.dirs??[]){const G=Ct(Lx(V,ye.name));L.has(G)||(L.add(G),g.push(G))}}return Array.from(L).sort((B,V)=>B==="/"?-1:V==="/"?1:B.localeCompare(V))},[]);c.useEffect(()=>{if(!we)return;let g=!1;return vn(!0),Ph().then(C=>{g||Me(C)}).catch(C=>{g||ke(To(C,"Failed to load destination folders."))}).finally(()=>{g||vn(!1)}),()=>{g=!0}},[Ph,we]);const w0=c.useCallback(async(g,C)=>{const L=Hc(g);if(!L.length)return!1;const B=Ct(C||"/");ke(null);const V=[],oe=[];for(const G of L)try{await Se.moveFile(G,B)}catch(ce){V.push(`${xh(G)||G}: ${To(ce,"Move failed.")}`),oe.push(G)}try{await vt.invalidateQueries({predicate:({queryKey:G})=>Array.isArray(G)&&G[0]==="folder"}),Cs(),await Wn()}catch(G){V.push(To(G,"Move completed, but refresh failed."))}if(V.length)return ke(Pg("Move",V)),i(oe),!1;at(null),Te(null);const ye=new Set(L);return i(G=>G.filter(ce=>!ye.has(ce))),!0},[Cs,vt,Wn]),S0=c.useCallback(g=>{const C=Hc(g);C.length&&(ke(null),at({paths:C}),Te(null))},[]),Ql=c.useCallback(async g=>{var B;if(!g.length)return;if(!((((B=et==null?void 0:et.dirs)==null?void 0:B.length)??0)===0)){ke("Uploads are only allowed into folders without subdirectories.");return}ge(!0),ke(null);const L=[];try{for(const V of g)try{await Se.uploadFile(e,V)}catch(oe){L.push(`${V.name}: ${To(oe,"Upload failed.")}`)}try{await Wn()}catch(V){L.push(To(V,"Upload completed, but refresh failed."))}}finally{ge(!1)}if(L.length){ke(Pg("Upload",L));return}ke(null)},[e,(Dh=et==null?void 0:et.dirs)==null?void 0:Dh.length,Wn]),b0=c.useCallback(()=>{var g;ve||(g=Gt.current)==null||g.click()},[ve]),C0=c.useCallback(async g=>{const C=Array.from(g.target.files??[]);g.target.value="",C.length&&await Ql(C)},[Ql]),k0=c.useCallback(async()=>{const g=window.prompt("Save Smart Folder as:","New Smart Folder");if(!g)return;const C=sk(g,q),L={id:C,name:g,pool:{kind:"folder",path:e},view:JSON.parse(JSON.stringify(N))},B=[...q.filter(V=>V.id!==C),L];ne(B),je(C);try{await Se.saveViews({version:1,views:B})}catch(V){if(V instanceof un&&V.status===403){const oe=new Blob([JSON.stringify({version:1,views:B},null,2)],{type:"application/json"});Ko(oe,`lenslet-smart-folder-${C}.json`),alert("No-write mode: exported Smart Folder JSON instead of saving.");return}console.error("Failed to save Smart Folder:",V)}},[e,N,q]);c.useEffect(()=>{if(!fe)return;const g=q.find(B=>B.id===fe);if(!g){je(null);return}const C=g.pool.path===e,L=JSON.stringify(g.view)===JSON.stringify(N);(!C||!L)&&je(null)},[fe,q,e,N]);const Kl=c.useCallback(g=>{if(!g)return;const C=document.getElementById(`cell-${encodeURIComponent(g)}`);C==null||C.focus()},[]),E0=c.useCallback(g=>{h(g),Ze.current=!0,Xm(g)},[]),Th=c.useCallback(()=>{h(null),Ze.current?(Ze.current=!1,window.history.back()):ya(e),Kl(zt.current)},[Kl]),N0=c.useCallback(()=>{p||!Yn||(s[0]&&(zt.current=s[0]),E(0),S(!0),f&&(h(null),Ze.current&&(Ze.current=!1),ya(e)),Jt.current||(window.history.pushState({compare:!0},"",window.location.href),Jt.current=!0))},[p,Yn,s,f,e]),Gu=c.useCallback(()=>{S(!1),Jt.current&&(Jt.current=!1,window.history.back()),Kl(zt.current??s[0])},[Kl,s]),j0=c.useCallback(g=>{ue.length<2||E(C=>{const L=Math.max(0,ue.length-2);return Math.min(L,Math.max(0,C+g))})},[ue.length]);c.useEffect(()=>{p&&(Yn||Gu())},[p,Yn,Gu]),c.useEffect(()=>{const g=()=>{f&&(Ze.current=!1,h(null)),p&&(Jt.current=!1,S(!1))};return window.addEventListener("popstate",g),()=>window.removeEventListener("popstate",g)},[f,p]),c.useEffect(()=>{const g=lt.current;if(!g)return;const C=V=>{V.dataTransfer&&Array.from(V.dataTransfer.types).includes("Files")&&(V.preventDefault(),me(!0))},L=V=>{const oe=V.relatedTarget;oe&&g.contains(oe)||me(!1)},B=async V=>{var ye;V.preventDefault(),me(!1);const oe=Array.from(((ye=V.dataTransfer)==null?void 0:ye.files)??[]);oe.length&&await Ql(oe)};return g.addEventListener("dragover",C),g.addEventListener("dragleave",L),g.addEventListener("drop",B),()=>{g.removeEventListener("dragover",C),g.removeEventListener("dragleave",L),g.removeEventListener("drop",B)}},[Ql]),c.useEffect(()=>{const g=()=>Te(null),C=L=>{L.key==="Escape"&&Te(null)};return window.addEventListener("click",g),window.addEventListener("keydown",C),()=>{window.removeEventListener("click",g),window.removeEventListener("keydown",C)}},[]),c.useEffect(()=>{const g=C=>{if(!mh(C.target)){if((C.ctrlKey||C.metaKey)&&C.key.toLowerCase()==="b"){C.preventDefault(),C.altKey?te(L=>!L):D(L=>!L);return}if(!(f||p)){if(C.key==="Backspace"||C.key==="Delete")C.preventDefault(),Wl(qm(e));else if((C.ctrlKey||C.metaKey)&&C.key.toLowerCase()==="a")C.preventDefault(),i(Ke.map(L=>L.path));else if(C.key==="Escape"){if(s.length){C.preventDefault(),i([]);return}A&&(C.preventDefault(),_(!1))}else if(C.key==="/"){C.preventDefault();const L=document.querySelector(".toolbar-right .input");L==null||L.focus()}}}};return window.addEventListener("keydown",g),()=>window.removeEventListener("keydown",g)},[e,Ke,s,f,p,Wl,A]);const Lh=c.useMemo(()=>GS({viewportWidth:se,leftOpen:P,rightOpen:H,leftWidth:gn,rightWidth:Vn}),[se,P,H,gn,Vn]),M0=P?`${Lh.leftWidth}px`:"0px",R0=H?`${Lh.rightWidth}px`:"0px",_h=f??s[0]??null,Ju=_h?xn.indexOf(_h):-1,Ih=Ju>0,Fh=Ju>=0&&Ju<xn.length-1,Zu=c.useCallback(g=>{if(!xn.length)return;const C=f??s[0];if(!C)return;const L=xn.indexOf(C);if(L===-1)return;const B=Math.min(xn.length-1,Math.max(0,L+g)),V=xn[B];!V||V===C||(f&&(h(V),ya(V)),i([V]))},[xn,f,s]);return a.jsxs("div",{className:"app-shell grid h-full grid-cols-[var(--left)_1fr_var(--right)]",ref:lt,style:{"--left":M0,"--right":R0},children:[a.jsx(eb,{rootRef:Bn,onSearch:r,viewerActive:!!f,onBack:Th,zoomPercent:f?y:void 0,onZoomPercentChange:g=>x(g),currentLabel:v0,itemCount:u0,totalCount:c0,sortSpec:N.sort,metricKeys:_r,onSortChange:g0,sortDisabled:Bt,filterCount:$l,onOpenFilters:m0,starFilters:fo,onToggleStar:p0,onClearStars:Hl,onClearFilters:jh,starCounts:Gx,viewMode:J,onViewMode:z,gridItemSize:le,onGridItemSize:Q,leftOpen:P,rightOpen:H,onToggleLeft:()=>D(g=>!g),onToggleRight:()=>te(g=>!g),onPrevImage:()=>Zu(-1),onNextImage:()=>Zu(1),canPrevImage:Ih,canNextImage:Fh,searchDisabled:Bt,searchPlaceholder:Bt?"Exit similarity to search":void 0,onUploadClick:b0,uploadBusy:ve,uploadDisabled:p,multiSelectMode:A,selectedCount:s.length,onToggleMultiSelectMode:Vl?()=>_(g=>!g):void 0,syncIndicator:{state:o0,presence:Ul,syncLabel:Zx,connectionLabel:e0,lastEditedLabel:t0,hasEdits:Ku,localTypingActive:ni,recentTouches:a0}}),a.jsx("input",{ref:Gt,type:"file",multiple:!0,accept:"image/*",className:"sr-only",onChange:C0}),P&&a.jsx(OE,{leftTool:Y,onToolChange:Z,compareEnabled:Yn,compareActive:p,onOpenCompare:N0,views:q,activeViewId:fe,onActivateView:g=>{var L;je(g.id);const C=cf((L=g.view)==null?void 0:L.filters)??{and:[]};O({...g.view,filters:C}),Wl(g.pool.path)},onSaveView:k0,current:e,data:et,onOpenFolder:g=>{je(null),Wl(g)},onOpenFolderActions:x0,onPullRefreshFolders:qx,onContextMenu:(g,C)=>{g.preventDefault(),Te({x:g.clientX,y:g.clientY,kind:"tree",payload:{path:C}})},countVersion:xe,items:Il,filteredItems:Ke,metricKeys:_r,selectedItems:de,selectedMetric:N.selectedMetric,onSelectMetric:g=>O(C=>({...C,selectedMetric:g})),filters:N.filters,onChangeRange:Xu,onChangeFilters:d0,onResize:$}),a.jsxs("div",{className:"grid-shell col-start-2 row-start-2 relative overflow-hidden flex flex-col",ref:gt,children:[a.jsx("div",{"aria-live":"polite",className:"sr-only",children:s.length?`${s.length} selected`:""}),a.jsx(AE,{persistenceEnabled:Vu,offViewSummary:l0,canRevealOffView:Qu,onRevealOffView:f0,onClearOffView:F,browserZoomPercent:R}),pe&&a.jsx("div",{className:"border-b border-border bg-panel px-3 py-2",children:a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",children:pe})}),u&&a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"font-semibold",children:"Similarity mode"}),a.jsxs("span",{className:"text-muted",children:["Embedding: ",u.embedding]}),Eh&&a.jsxs("span",{className:"text-muted",children:["Query: ",Eh]}),Nh&&a.jsxs("span",{className:"text-muted",children:["Results: ",Nh]}),a.jsxs("span",{className:"text-muted",children:["Top K: ",u.topK]}),u.minScore!=null&&a.jsxs("span",{className:"text-muted",children:["Min score: ",u.minScore]})]}),a.jsx("button",{className:"btn btn-sm",onClick:Yu,children:"Exit similarity"})]})}),Mh.length>0&&a.jsx("div",{className:"sticky top-0 z-10 px-3 py-2 bg-panel border-b border-border",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Filters"}),Mh.map(g=>a.jsxs("span",{className:"filter-chip",children:[a.jsx("span",{className:"truncate max-w-[240px]",title:g.label,children:g.label}),a.jsx("button",{className:"filter-chip-remove","aria-label":`Clear filter ${g.label}`,onClick:g.onRemove,children:""})]},g.id)),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:jh,children:"Clear all"})]})}),!1,a.jsxs("div",{className:"flex-1 min-h-0 relative",children:[a.jsx(dC,{items:Ke,selected:s,restoreToSelectionToken:j,multiSelectMode:Vl&&A,onSelectionChange:i,onOpenViewer:g=>{try{zt.current=g}catch{}E0(g),i([g])},highlight:Qn?Tl:"",recentlyUpdated:Kn,onVisiblePathsChange:oi,suppressSelectionHighlight:!!f||p,viewMode:J,targetCellSize:le,onContextMenuItem:(g,C)=>{g.preventDefault();const L=qu(C);i(L),Te({x:g.clientX,y:g.clientY,kind:"grid",payload:{paths:L}})},onOpenItemActions:y0,scrollRef:hn,hideScrollbar:Pt}),Pt&&ai&&a.jsx(pC,{items:Ke,metricKey:ai,scrollRef:hn,sortDir:N.sort.dir})]})]}),H&&a.jsx(Sk,{path:s[0]??null,selectedPaths:s,items:Ke,compareActive:p,compareA:Ss,compareB:bs,sortSpec:N.sort,onResize:ee,onStarChanged:(g,C)=>{Ie(L=>{const B={...L};for(const V of g)B[V]=C;return B})},onFindSimilar:()=>l(!0),embeddingsAvailable:ii,embeddingsLoading:Pr.isLoading,onLocalTypingChange:ar}),a.jsx(bk,{open:o,embeddings:uo,rejected:co,selectedPath:s[0]??null,embeddingsLoading:Pr.isLoading,embeddingsError:Ll,onClose:()=>l(!1),onSearch:h0}),f&&a.jsx(MC,{path:f,onClose:Th,onZoomChange:g=>k(Math.round(g)),requestedZoomPercent:m,onZoomRequestConsumed:()=>x(null),canPrev:Ih,canNext:Fh,onNavigate:Zu}),p&&a.jsx(FC,{aItem:Ss,bItem:bs,index:Rt,total:ue.length,canPrev:tt,canNext:dr,onNavigate:j0,onClose:Gu}),we&&a.jsx(rN,{paths:we.paths,defaultDestination:e,destinations:Oe,loadingDestinations:jt,onClose:()=>at(null),onSubmit:w0}),K&&a.jsx("div",{className:"toolbar-offset fixed inset-0 left-[var(--left)] right-[var(--right)] bg-accent/10 border-2 border-dashed border-accent text-text flex items-center justify-center text-lg z-overlay pointer-events-none",children:"Drop images to upload"}),Rn&&a.jsx(aN,{ctx:Rn,current:e,items:Ke,setCtx:Te,onRefetch:Wn,onOpenMoveDialog:S0,onRefreshFolder:go})]})}const vN=new MS({defaultOptions:{queries:{staleTime:1e4,gcTime:5*6e4,retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),1e4),refetchOnWindowFocus:!1,refetchOnReconnect:"always"},mutations:{retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),5e3)}}});function yN(){return a.jsx(RS,{client:vN,children:a.jsx(gN,{})})}ex(document.getElementById("root")).render(a.jsx(yN,{}));
