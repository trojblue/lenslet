var K0=Object.defineProperty;var Fh=e=>{throw TypeError(e)};var q0=(e,t,n)=>t in e?K0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var lt=(e,t,n)=>q0(e,typeof t!="symbol"?t+"":t,n),Hu=(e,t,n)=>t.has(e)||Fh("Cannot "+n);var k=(e,t,n)=>(Hu(e,t,"read from private field"),n?n.call(e):t.get(e)),ue=(e,t,n)=>t.has(e)?Fh("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Z=(e,t,n,r)=>(Hu(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),xe=(e,t,n)=>(Hu(e,t,"access private method"),n);var gl=(e,t,n,r)=>({set _(s){Z(e,t,s,n)},get _(){return k(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function G0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Dg={exports:{}},Xa={},zg={exports:{}},ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jo=Symbol.for("react.element"),Y0=Symbol.for("react.portal"),X0=Symbol.for("react.fragment"),J0=Symbol.for("react.strict_mode"),Z0=Symbol.for("react.profiler"),ew=Symbol.for("react.provider"),tw=Symbol.for("react.context"),nw=Symbol.for("react.forward_ref"),rw=Symbol.for("react.suspense"),sw=Symbol.for("react.memo"),iw=Symbol.for("react.lazy"),Oh=Symbol.iterator;function ow(e){return e===null||typeof e!="object"?null:(e=Oh&&e[Oh]||e["@@iterator"],typeof e=="function"?e:null)}var $g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Bg=Object.assign,Ug={};function Fi(e,t,n){this.props=e,this.context=t,this.refs=Ug,this.updater=n||$g}Fi.prototype.isReactComponent={};Fi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Fi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Vg(){}Vg.prototype=Fi.prototype;function uf(e,t,n){this.props=e,this.context=t,this.refs=Ug,this.updater=n||$g}var cf=uf.prototype=new Vg;cf.constructor=uf;Bg(cf,Fi.prototype);cf.isPureReactComponent=!0;var Dh=Array.isArray,Wg=Object.prototype.hasOwnProperty,df={current:null},Hg={key:!0,ref:!0,__self:!0,__source:!0};function Qg(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Wg.call(t,r)&&!Hg.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Jo,type:e,key:i,ref:o,props:s,_owner:df.current}}function lw(e,t){return{$$typeof:Jo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ff(e){return typeof e=="object"&&e!==null&&e.$$typeof===Jo}function aw(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var zh=/\/+/g;function Qu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?aw(""+e.key):t.toString(36)}function ql(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Jo:case Y0:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+Qu(o,0):r,Dh(s)?(n="",e!=null&&(n=e.replace(zh,"$&/")+"/"),ql(s,t,n,"",function(d){return d})):s!=null&&(ff(s)&&(s=lw(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(zh,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",Dh(e))for(var l=0;l<e.length;l++){i=e[l];var c=r+Qu(i,l);o+=ql(i,t,n,c,s)}else if(c=ow(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=r+Qu(i,l++),o+=ql(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function yl(e,t,n){if(e==null)return e;var r=[],s=0;return ql(e,r,"","",function(i){return t.call(n,i,s++)}),r}function uw(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var zt={current:null},Gl={transition:null},cw={ReactCurrentDispatcher:zt,ReactCurrentBatchConfig:Gl,ReactCurrentOwner:df};function Kg(){throw Error("act(...) is not supported in production builds of React.")}ke.Children={map:yl,forEach:function(e,t,n){yl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return yl(e,function(){t++}),t},toArray:function(e){return yl(e,function(t){return t})||[]},only:function(e){if(!ff(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ke.Component=Fi;ke.Fragment=X0;ke.Profiler=Z0;ke.PureComponent=uf;ke.StrictMode=J0;ke.Suspense=rw;ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cw;ke.act=Kg;ke.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Bg({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=df.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Wg.call(t,c)&&!Hg.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Jo,type:e.type,key:s,ref:i,props:r,_owner:o}};ke.createContext=function(e){return e={$$typeof:tw,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ew,_context:e},e.Consumer=e};ke.createElement=Qg;ke.createFactory=function(e){var t=Qg.bind(null,e);return t.type=e,t};ke.createRef=function(){return{current:null}};ke.forwardRef=function(e){return{$$typeof:nw,render:e}};ke.isValidElement=ff;ke.lazy=function(e){return{$$typeof:iw,_payload:{_status:-1,_result:e},_init:uw}};ke.memo=function(e,t){return{$$typeof:sw,type:e,compare:t===void 0?null:t}};ke.startTransition=function(e){var t=Gl.transition;Gl.transition={};try{e()}finally{Gl.transition=t}};ke.unstable_act=Kg;ke.useCallback=function(e,t){return zt.current.useCallback(e,t)};ke.useContext=function(e){return zt.current.useContext(e)};ke.useDebugValue=function(){};ke.useDeferredValue=function(e){return zt.current.useDeferredValue(e)};ke.useEffect=function(e,t){return zt.current.useEffect(e,t)};ke.useId=function(){return zt.current.useId()};ke.useImperativeHandle=function(e,t,n){return zt.current.useImperativeHandle(e,t,n)};ke.useInsertionEffect=function(e,t){return zt.current.useInsertionEffect(e,t)};ke.useLayoutEffect=function(e,t){return zt.current.useLayoutEffect(e,t)};ke.useMemo=function(e,t){return zt.current.useMemo(e,t)};ke.useReducer=function(e,t,n){return zt.current.useReducer(e,t,n)};ke.useRef=function(e){return zt.current.useRef(e)};ke.useState=function(e){return zt.current.useState(e)};ke.useSyncExternalStore=function(e,t,n){return zt.current.useSyncExternalStore(e,t,n)};ke.useTransition=function(){return zt.current.useTransition()};ke.version="18.3.1";zg.exports=ke;var u=zg.exports;const Jr=G0(u);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dw=u,fw=Symbol.for("react.element"),hw=Symbol.for("react.fragment"),pw=Object.prototype.hasOwnProperty,mw=dw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gw={key:!0,ref:!0,__self:!0,__source:!0};function qg(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)pw.call(t,r)&&!gw.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:fw,type:e,key:i,ref:o,props:s,_owner:mw.current}}Xa.Fragment=hw;Xa.jsx=qg;Xa.jsxs=qg;Dg.exports=Xa;var a=Dg.exports,Gg={exports:{}},un={},Yg={exports:{}},Xg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,A){var O=P.length;P.push(A);e:for(;0<O;){var K=O-1>>>1,U=P[K];if(0<s(U,A))P[K]=A,P[O]=U,O=K;else break e}}function n(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var A=P[0],O=P.pop();if(O!==A){P[0]=O;e:for(var K=0,U=P.length,_=U>>>1;K<_;){var G=2*(K+1)-1,V=P[G],J=G+1,se=P[J];if(0>s(V,O))J<U&&0>s(se,V)?(P[K]=se,P[J]=O,K=J):(P[K]=V,P[G]=O,K=G);else if(J<U&&0>s(se,O))P[K]=se,P[J]=O,K=J;else break e}}return A}function s(P,A){var O=P.sortIndex-A.sortIndex;return O!==0?O:P.id-A.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],f=1,p=null,h=3,w=!1,x=!1,b=!1,C=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(P){for(var A=n(d);A!==null;){if(A.callback===null)r(d);else if(A.startTime<=P)r(d),A.sortIndex=A.expirationTime,t(c,A);else break;A=n(d)}}function g(P){if(b=!1,v(P),!x)if(n(c)!==null)x=!0,L(S);else{var A=n(d);A!==null&&R(g,A.startTime-P)}}function S(P,A){x=!1,b&&(b=!1,y(j),j=-1),w=!0;var O=h;try{for(v(A),p=n(c);p!==null&&(!(p.expirationTime>A)||P&&!B());){var K=p.callback;if(typeof K=="function"){p.callback=null,h=p.priorityLevel;var U=K(p.expirationTime<=A);A=e.unstable_now(),typeof U=="function"?p.callback=U:p===n(c)&&r(c),v(A)}else r(c);p=n(c)}if(p!==null)var _=!0;else{var G=n(d);G!==null&&R(g,G.startTime-A),_=!1}return _}finally{p=null,h=O,w=!1}}var E=!1,T=null,j=-1,I=5,M=-1;function B(){return!(e.unstable_now()-M<I)}function F(){if(T!==null){var P=e.unstable_now();M=P;var A=!0;try{A=T(!0,P)}finally{A?Q():(E=!1,T=null)}}else E=!1}var Q;if(typeof m=="function")Q=function(){m(F)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,z=ee.port2;ee.port1.onmessage=F,Q=function(){z.postMessage(null)}}else Q=function(){C(F,0)};function L(P){T=P,E||(E=!0,Q())}function R(P,A){j=C(function(){P(e.unstable_now())},A)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){x||w||(x=!0,L(S))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(P){switch(h){case 1:case 2:case 3:var A=3;break;default:A=h}var O=h;h=A;try{return P()}finally{h=O}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,A){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var O=h;h=P;try{return A()}finally{h=O}},e.unstable_scheduleCallback=function(P,A,O){var K=e.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?K+O:K):O=K,P){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=O+U,P={id:f++,callback:A,priorityLevel:P,startTime:O,expirationTime:U,sortIndex:-1},O>K?(P.sortIndex=O,t(d,P),n(c)===null&&P===n(d)&&(b?(y(j),j=-1):b=!0,R(g,O-K))):(P.sortIndex=U,t(c,P),x||w||(x=!0,L(S))),P},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(P){var A=h;return function(){var O=h;h=A;try{return P.apply(this,arguments)}finally{h=O}}}})(Xg);Yg.exports=Xg;var yw=Yg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vw=u,an=yw;function W(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Jg=new Set,No={};function _s(e,t){Mi(e,t),Mi(e+"Capture",t)}function Mi(e,t){for(No[e]=t,e=0;e<t.length;e++)Jg.add(t[e])}var mr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_c=Object.prototype.hasOwnProperty,xw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$h={},Bh={};function ww(e){return _c.call(Bh,e)?!0:_c.call($h,e)?!1:xw.test(e)?Bh[e]=!0:($h[e]=!0,!1)}function bw(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Sw(e,t,n,r){if(t===null||typeof t>"u"||bw(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function $t(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){bt[e]=new $t(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];bt[t]=new $t(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){bt[e]=new $t(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){bt[e]=new $t(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){bt[e]=new $t(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){bt[e]=new $t(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){bt[e]=new $t(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){bt[e]=new $t(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){bt[e]=new $t(e,5,!1,e.toLowerCase(),null,!1,!1)});var hf=/[\-:]([a-z])/g;function pf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(hf,pf);bt[t]=new $t(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(hf,pf);bt[t]=new $t(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(hf,pf);bt[t]=new $t(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){bt[e]=new $t(e,1,!1,e.toLowerCase(),null,!1,!1)});bt.xlinkHref=new $t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){bt[e]=new $t(e,1,!1,e.toLowerCase(),null,!0,!0)});function mf(e,t,n,r){var s=bt.hasOwnProperty(t)?bt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Sw(t,n,s,r)&&(n=null),r||s===null?ww(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var xr=vw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,vl=Symbol.for("react.element"),Gs=Symbol.for("react.portal"),Ys=Symbol.for("react.fragment"),gf=Symbol.for("react.strict_mode"),Ac=Symbol.for("react.profiler"),Zg=Symbol.for("react.provider"),ey=Symbol.for("react.context"),yf=Symbol.for("react.forward_ref"),Fc=Symbol.for("react.suspense"),Oc=Symbol.for("react.suspense_list"),vf=Symbol.for("react.memo"),Nr=Symbol.for("react.lazy"),ty=Symbol.for("react.offscreen"),Uh=Symbol.iterator;function qi(e){return e===null||typeof e!="object"?null:(e=Uh&&e[Uh]||e["@@iterator"],typeof e=="function"?e:null)}var qe=Object.assign,Ku;function lo(e){if(Ku===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ku=t&&t[1]||""}return`
`+Ku+e}var qu=!1;function Gu(e,t){if(!e||qu)return"";qu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{qu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?lo(e):""}function Cw(e){switch(e.tag){case 5:return lo(e.type);case 16:return lo("Lazy");case 13:return lo("Suspense");case 19:return lo("SuspenseList");case 0:case 2:case 15:return e=Gu(e.type,!1),e;case 11:return e=Gu(e.type.render,!1),e;case 1:return e=Gu(e.type,!0),e;default:return""}}function Dc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ys:return"Fragment";case Gs:return"Portal";case Ac:return"Profiler";case gf:return"StrictMode";case Fc:return"Suspense";case Oc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case ey:return(e.displayName||"Context")+".Consumer";case Zg:return(e._context.displayName||"Context")+".Provider";case yf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case vf:return t=e.displayName||null,t!==null?t:Dc(e.type)||"Memo";case Nr:t=e._payload,e=e._init;try{return Dc(e(t))}catch{}}return null}function kw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dc(t);case 8:return t===gf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Zr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ny(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ew(e){var t=ny(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function xl(e){e._valueTracker||(e._valueTracker=Ew(e))}function ry(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=ny(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function pa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function zc(e,t){var n=t.checked;return qe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Vh(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Zr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function sy(e,t){t=t.checked,t!=null&&mf(e,"checked",t,!1)}function $c(e,t){sy(e,t);var n=Zr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Bc(e,t.type,n):t.hasOwnProperty("defaultValue")&&Bc(e,t.type,Zr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Wh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Bc(e,t,n){(t!=="number"||pa(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ao=Array.isArray;function li(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Zr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Uc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(W(91));return qe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Hh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(W(92));if(ao(n)){if(1<n.length)throw Error(W(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Zr(n)}}function iy(e,t){var n=Zr(t.value),r=Zr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Qh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function oy(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?oy(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var wl,ly=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(wl=wl||document.createElement("div"),wl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=wl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function jo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var po={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nw=["Webkit","ms","Moz","O"];Object.keys(po).forEach(function(e){Nw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),po[t]=po[e]})});function ay(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||po.hasOwnProperty(e)&&po[e]?(""+t).trim():t+"px"}function uy(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=ay(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var jw=qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wc(e,t){if(t){if(jw[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(W(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(W(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(W(61))}if(t.style!=null&&typeof t.style!="object")throw Error(W(62))}}function Hc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qc=null;function xf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Kc=null,ai=null,ui=null;function Kh(e){if(e=tl(e)){if(typeof Kc!="function")throw Error(W(280));var t=e.stateNode;t&&(t=nu(t),Kc(e.stateNode,e.type,t))}}function cy(e){ai?ui?ui.push(e):ui=[e]:ai=e}function dy(){if(ai){var e=ai,t=ui;if(ui=ai=null,Kh(e),t)for(e=0;e<t.length;e++)Kh(t[e])}}function fy(e,t){return e(t)}function hy(){}var Yu=!1;function py(e,t,n){if(Yu)return e(t,n);Yu=!0;try{return fy(e,t,n)}finally{Yu=!1,(ai!==null||ui!==null)&&(hy(),dy())}}function Mo(e,t){var n=e.stateNode;if(n===null)return null;var r=nu(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(W(231,t,typeof n));return n}var qc=!1;if(mr)try{var Gi={};Object.defineProperty(Gi,"passive",{get:function(){qc=!0}}),window.addEventListener("test",Gi,Gi),window.removeEventListener("test",Gi,Gi)}catch{qc=!1}function Mw(e,t,n,r,s,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(f){this.onError(f)}}var mo=!1,ma=null,ga=!1,Gc=null,Rw={onError:function(e){mo=!0,ma=e}};function Pw(e,t,n,r,s,i,o,l,c){mo=!1,ma=null,Mw.apply(Rw,arguments)}function Tw(e,t,n,r,s,i,o,l,c){if(Pw.apply(this,arguments),mo){if(mo){var d=ma;mo=!1,ma=null}else throw Error(W(198));ga||(ga=!0,Gc=d)}}function As(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function my(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function qh(e){if(As(e)!==e)throw Error(W(188))}function Iw(e){var t=e.alternate;if(!t){if(t=As(e),t===null)throw Error(W(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return qh(s),e;if(i===r)return qh(s),t;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?e:t}function gy(e){return e=Iw(e),e!==null?yy(e):null}function yy(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=yy(e);if(t!==null)return t;e=e.sibling}return null}var vy=an.unstable_scheduleCallback,Gh=an.unstable_cancelCallback,Lw=an.unstable_shouldYield,_w=an.unstable_requestPaint,nt=an.unstable_now,Aw=an.unstable_getCurrentPriorityLevel,wf=an.unstable_ImmediatePriority,xy=an.unstable_UserBlockingPriority,ya=an.unstable_NormalPriority,Fw=an.unstable_LowPriority,wy=an.unstable_IdlePriority,Ja=null,Yn=null;function Ow(e){if(Yn&&typeof Yn.onCommitFiberRoot=="function")try{Yn.onCommitFiberRoot(Ja,e,void 0,(e.current.flags&128)===128)}catch{}}var _n=Math.clz32?Math.clz32:$w,Dw=Math.log,zw=Math.LN2;function $w(e){return e>>>=0,e===0?32:31-(Dw(e)/zw|0)|0}var bl=64,Sl=4194304;function uo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function va(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=uo(l):(i&=o,i!==0&&(r=uo(i)))}else o=n&~s,o!==0?r=uo(o):i!==0&&(r=uo(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-_n(t),s=1<<n,r|=e[n],t&=~s;return r}function Bw(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Uw(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-_n(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=Bw(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Yc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function by(){var e=bl;return bl<<=1,!(bl&4194240)&&(bl=64),e}function Xu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Zo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-_n(t),e[t]=n}function Vw(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-_n(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function bf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-_n(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Ae=0;function Sy(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Cy,Sf,ky,Ey,Ny,Xc=!1,Cl=[],Br=null,Ur=null,Vr=null,Ro=new Map,Po=new Map,Mr=[],Ww="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yh(e,t){switch(e){case"focusin":case"focusout":Br=null;break;case"dragenter":case"dragleave":Ur=null;break;case"mouseover":case"mouseout":Vr=null;break;case"pointerover":case"pointerout":Ro.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Po.delete(t.pointerId)}}function Yi(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=tl(t),t!==null&&Sf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Hw(e,t,n,r,s){switch(t){case"focusin":return Br=Yi(Br,e,t,n,r,s),!0;case"dragenter":return Ur=Yi(Ur,e,t,n,r,s),!0;case"mouseover":return Vr=Yi(Vr,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return Ro.set(i,Yi(Ro.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Po.set(i,Yi(Po.get(i)||null,e,t,n,r,s)),!0}return!1}function jy(e){var t=as(e.target);if(t!==null){var n=As(t);if(n!==null){if(t=n.tag,t===13){if(t=my(n),t!==null){e.blockedOn=t,Ny(e.priority,function(){ky(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Yl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Qc=r,n.target.dispatchEvent(r),Qc=null}else return t=tl(n),t!==null&&Sf(t),e.blockedOn=n,!1;t.shift()}return!0}function Xh(e,t,n){Yl(e)&&n.delete(t)}function Qw(){Xc=!1,Br!==null&&Yl(Br)&&(Br=null),Ur!==null&&Yl(Ur)&&(Ur=null),Vr!==null&&Yl(Vr)&&(Vr=null),Ro.forEach(Xh),Po.forEach(Xh)}function Xi(e,t){e.blockedOn===t&&(e.blockedOn=null,Xc||(Xc=!0,an.unstable_scheduleCallback(an.unstable_NormalPriority,Qw)))}function To(e){function t(s){return Xi(s,e)}if(0<Cl.length){Xi(Cl[0],e);for(var n=1;n<Cl.length;n++){var r=Cl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Br!==null&&Xi(Br,e),Ur!==null&&Xi(Ur,e),Vr!==null&&Xi(Vr,e),Ro.forEach(t),Po.forEach(t),n=0;n<Mr.length;n++)r=Mr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Mr.length&&(n=Mr[0],n.blockedOn===null);)jy(n),n.blockedOn===null&&Mr.shift()}var ci=xr.ReactCurrentBatchConfig,xa=!0;function Kw(e,t,n,r){var s=Ae,i=ci.transition;ci.transition=null;try{Ae=1,Cf(e,t,n,r)}finally{Ae=s,ci.transition=i}}function qw(e,t,n,r){var s=Ae,i=ci.transition;ci.transition=null;try{Ae=4,Cf(e,t,n,r)}finally{Ae=s,ci.transition=i}}function Cf(e,t,n,r){if(xa){var s=Jc(e,t,n,r);if(s===null)lc(e,t,r,wa,n),Yh(e,r);else if(Hw(s,e,t,n,r))r.stopPropagation();else if(Yh(e,r),t&4&&-1<Ww.indexOf(e)){for(;s!==null;){var i=tl(s);if(i!==null&&Cy(i),i=Jc(e,t,n,r),i===null&&lc(e,t,r,wa,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else lc(e,t,r,null,n)}}var wa=null;function Jc(e,t,n,r){if(wa=null,e=xf(r),e=as(e),e!==null)if(t=As(e),t===null)e=null;else if(n=t.tag,n===13){if(e=my(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return wa=e,null}function My(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Aw()){case wf:return 1;case xy:return 4;case ya:case Fw:return 16;case wy:return 536870912;default:return 16}default:return 16}}var zr=null,kf=null,Xl=null;function Ry(){if(Xl)return Xl;var e,t=kf,n=t.length,r,s="value"in zr?zr.value:zr.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return Xl=s.slice(e,1<r?1-r:void 0)}function Jl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function kl(){return!0}function Jh(){return!1}function cn(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?kl:Jh,this.isPropagationStopped=Jh,this}return qe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=kl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=kl)},persist:function(){},isPersistent:kl}),t}var Oi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ef=cn(Oi),el=qe({},Oi,{view:0,detail:0}),Gw=cn(el),Ju,Zu,Ji,Za=qe({},el,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ji&&(Ji&&e.type==="mousemove"?(Ju=e.screenX-Ji.screenX,Zu=e.screenY-Ji.screenY):Zu=Ju=0,Ji=e),Ju)},movementY:function(e){return"movementY"in e?e.movementY:Zu}}),Zh=cn(Za),Yw=qe({},Za,{dataTransfer:0}),Xw=cn(Yw),Jw=qe({},el,{relatedTarget:0}),ec=cn(Jw),Zw=qe({},Oi,{animationName:0,elapsedTime:0,pseudoElement:0}),e1=cn(Zw),t1=qe({},Oi,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),n1=cn(t1),r1=qe({},Oi,{data:0}),ep=cn(r1),s1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},o1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function l1(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=o1[e])?!!t[e]:!1}function Nf(){return l1}var a1=qe({},el,{key:function(e){if(e.key){var t=s1[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Jl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?i1[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nf,charCode:function(e){return e.type==="keypress"?Jl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Jl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),u1=cn(a1),c1=qe({},Za,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tp=cn(c1),d1=qe({},el,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nf}),f1=cn(d1),h1=qe({},Oi,{propertyName:0,elapsedTime:0,pseudoElement:0}),p1=cn(h1),m1=qe({},Za,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),g1=cn(m1),y1=[9,13,27,32],jf=mr&&"CompositionEvent"in window,go=null;mr&&"documentMode"in document&&(go=document.documentMode);var v1=mr&&"TextEvent"in window&&!go,Py=mr&&(!jf||go&&8<go&&11>=go),np=" ",rp=!1;function Ty(e,t){switch(e){case"keyup":return y1.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Iy(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Xs=!1;function x1(e,t){switch(e){case"compositionend":return Iy(t);case"keypress":return t.which!==32?null:(rp=!0,np);case"textInput":return e=t.data,e===np&&rp?null:e;default:return null}}function w1(e,t){if(Xs)return e==="compositionend"||!jf&&Ty(e,t)?(e=Ry(),Xl=kf=zr=null,Xs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Py&&t.locale!=="ko"?null:t.data;default:return null}}var b1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!b1[e.type]:t==="textarea"}function Ly(e,t,n,r){cy(r),t=ba(t,"onChange"),0<t.length&&(n=new Ef("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var yo=null,Io=null;function S1(e){Wy(e,0)}function eu(e){var t=ei(e);if(ry(t))return e}function C1(e,t){if(e==="change")return t}var _y=!1;if(mr){var tc;if(mr){var nc="oninput"in document;if(!nc){var ip=document.createElement("div");ip.setAttribute("oninput","return;"),nc=typeof ip.oninput=="function"}tc=nc}else tc=!1;_y=tc&&(!document.documentMode||9<document.documentMode)}function op(){yo&&(yo.detachEvent("onpropertychange",Ay),Io=yo=null)}function Ay(e){if(e.propertyName==="value"&&eu(Io)){var t=[];Ly(t,Io,e,xf(e)),py(S1,t)}}function k1(e,t,n){e==="focusin"?(op(),yo=t,Io=n,yo.attachEvent("onpropertychange",Ay)):e==="focusout"&&op()}function E1(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return eu(Io)}function N1(e,t){if(e==="click")return eu(t)}function j1(e,t){if(e==="input"||e==="change")return eu(t)}function M1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var On=typeof Object.is=="function"?Object.is:M1;function Lo(e,t){if(On(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!_c.call(t,s)||!On(e[s],t[s]))return!1}return!0}function lp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ap(e,t){var n=lp(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=lp(n)}}function Fy(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Fy(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Oy(){for(var e=window,t=pa();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=pa(e.document)}return t}function Mf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function R1(e){var t=Oy(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Fy(n.ownerDocument.documentElement,n)){if(r!==null&&Mf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=ap(n,i);var o=ap(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var P1=mr&&"documentMode"in document&&11>=document.documentMode,Js=null,Zc=null,vo=null,ed=!1;function up(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ed||Js==null||Js!==pa(r)||(r=Js,"selectionStart"in r&&Mf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),vo&&Lo(vo,r)||(vo=r,r=ba(Zc,"onSelect"),0<r.length&&(t=new Ef("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Js)))}function El(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Zs={animationend:El("Animation","AnimationEnd"),animationiteration:El("Animation","AnimationIteration"),animationstart:El("Animation","AnimationStart"),transitionend:El("Transition","TransitionEnd")},rc={},Dy={};mr&&(Dy=document.createElement("div").style,"AnimationEvent"in window||(delete Zs.animationend.animation,delete Zs.animationiteration.animation,delete Zs.animationstart.animation),"TransitionEvent"in window||delete Zs.transitionend.transition);function tu(e){if(rc[e])return rc[e];if(!Zs[e])return e;var t=Zs[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Dy)return rc[e]=t[n];return e}var zy=tu("animationend"),$y=tu("animationiteration"),By=tu("animationstart"),Uy=tu("transitionend"),Vy=new Map,cp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ts(e,t){Vy.set(e,t),_s(t,[e])}for(var sc=0;sc<cp.length;sc++){var ic=cp[sc],T1=ic.toLowerCase(),I1=ic[0].toUpperCase()+ic.slice(1);ts(T1,"on"+I1)}ts(zy,"onAnimationEnd");ts($y,"onAnimationIteration");ts(By,"onAnimationStart");ts("dblclick","onDoubleClick");ts("focusin","onFocus");ts("focusout","onBlur");ts(Uy,"onTransitionEnd");Mi("onMouseEnter",["mouseout","mouseover"]);Mi("onMouseLeave",["mouseout","mouseover"]);Mi("onPointerEnter",["pointerout","pointerover"]);Mi("onPointerLeave",["pointerout","pointerover"]);_s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));_s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));_s("onBeforeInput",["compositionend","keypress","textInput","paste"]);_s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));_s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var co="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),L1=new Set("cancel close invalid load scroll toggle".split(" ").concat(co));function dp(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Tw(r,t,void 0,e),e.currentTarget=null}function Wy(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;dp(s,l,d),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;dp(s,l,d),i=c}}}if(ga)throw e=Gc,ga=!1,Gc=null,e}function $e(e,t){var n=t[id];n===void 0&&(n=t[id]=new Set);var r=e+"__bubble";n.has(r)||(Hy(t,e,2,!1),n.add(r))}function oc(e,t,n){var r=0;t&&(r|=4),Hy(n,e,r,t)}var Nl="_reactListening"+Math.random().toString(36).slice(2);function _o(e){if(!e[Nl]){e[Nl]=!0,Jg.forEach(function(n){n!=="selectionchange"&&(L1.has(n)||oc(n,!1,e),oc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Nl]||(t[Nl]=!0,oc("selectionchange",!1,t))}}function Hy(e,t,n,r){switch(My(t)){case 1:var s=Kw;break;case 4:s=qw;break;default:s=Cf}n=s.bind(null,t,n,e),s=void 0,!qc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function lc(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=as(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}py(function(){var d=i,f=xf(n),p=[];e:{var h=Vy.get(e);if(h!==void 0){var w=Ef,x=e;switch(e){case"keypress":if(Jl(n)===0)break e;case"keydown":case"keyup":w=u1;break;case"focusin":x="focus",w=ec;break;case"focusout":x="blur",w=ec;break;case"beforeblur":case"afterblur":w=ec;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Zh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=Xw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=f1;break;case zy:case $y:case By:w=e1;break;case Uy:w=p1;break;case"scroll":w=Gw;break;case"wheel":w=g1;break;case"copy":case"cut":case"paste":w=n1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=tp}var b=(t&4)!==0,C=!b&&e==="scroll",y=b?h!==null?h+"Capture":null:h;b=[];for(var m=d,v;m!==null;){v=m;var g=v.stateNode;if(v.tag===5&&g!==null&&(v=g,y!==null&&(g=Mo(m,y),g!=null&&b.push(Ao(m,g,v)))),C)break;m=m.return}0<b.length&&(h=new w(h,x,null,n,f),p.push({event:h,listeners:b}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",h&&n!==Qc&&(x=n.relatedTarget||n.fromElement)&&(as(x)||x[gr]))break e;if((w||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,w?(x=n.relatedTarget||n.toElement,w=d,x=x?as(x):null,x!==null&&(C=As(x),x!==C||x.tag!==5&&x.tag!==6)&&(x=null)):(w=null,x=d),w!==x)){if(b=Zh,g="onMouseLeave",y="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(b=tp,g="onPointerLeave",y="onPointerEnter",m="pointer"),C=w==null?h:ei(w),v=x==null?h:ei(x),h=new b(g,m+"leave",w,n,f),h.target=C,h.relatedTarget=v,g=null,as(f)===d&&(b=new b(y,m+"enter",x,n,f),b.target=v,b.relatedTarget=C,g=b),C=g,w&&x)t:{for(b=w,y=x,m=0,v=b;v;v=Vs(v))m++;for(v=0,g=y;g;g=Vs(g))v++;for(;0<m-v;)b=Vs(b),m--;for(;0<v-m;)y=Vs(y),v--;for(;m--;){if(b===y||y!==null&&b===y.alternate)break t;b=Vs(b),y=Vs(y)}b=null}else b=null;w!==null&&fp(p,h,w,b,!1),x!==null&&C!==null&&fp(p,C,x,b,!0)}}e:{if(h=d?ei(d):window,w=h.nodeName&&h.nodeName.toLowerCase(),w==="select"||w==="input"&&h.type==="file")var S=C1;else if(sp(h))if(_y)S=j1;else{S=E1;var E=k1}else(w=h.nodeName)&&w.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=N1);if(S&&(S=S(e,d))){Ly(p,S,n,f);break e}E&&E(e,h,d),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&Bc(h,"number",h.value)}switch(E=d?ei(d):window,e){case"focusin":(sp(E)||E.contentEditable==="true")&&(Js=E,Zc=d,vo=null);break;case"focusout":vo=Zc=Js=null;break;case"mousedown":ed=!0;break;case"contextmenu":case"mouseup":case"dragend":ed=!1,up(p,n,f);break;case"selectionchange":if(P1)break;case"keydown":case"keyup":up(p,n,f)}var T;if(jf)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else Xs?Ty(e,n)&&(j="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(j="onCompositionStart");j&&(Py&&n.locale!=="ko"&&(Xs||j!=="onCompositionStart"?j==="onCompositionEnd"&&Xs&&(T=Ry()):(zr=f,kf="value"in zr?zr.value:zr.textContent,Xs=!0)),E=ba(d,j),0<E.length&&(j=new ep(j,e,null,n,f),p.push({event:j,listeners:E}),T?j.data=T:(T=Iy(n),T!==null&&(j.data=T)))),(T=v1?x1(e,n):w1(e,n))&&(d=ba(d,"onBeforeInput"),0<d.length&&(f=new ep("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=T))}Wy(p,t)})}function Ao(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ba(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Mo(e,n),i!=null&&r.unshift(Ao(e,i,s)),i=Mo(e,t),i!=null&&r.push(Ao(e,i,s))),e=e.return}return r}function Vs(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function fp(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,s?(c=Mo(n,i),c!=null&&o.unshift(Ao(n,c,l))):s||(c=Mo(n,i),c!=null&&o.push(Ao(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var _1=/\r\n?/g,A1=/\u0000|\uFFFD/g;function hp(e){return(typeof e=="string"?e:""+e).replace(_1,`
`).replace(A1,"")}function jl(e,t,n){if(t=hp(t),hp(e)!==t&&n)throw Error(W(425))}function Sa(){}var td=null,nd=null;function rd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var sd=typeof setTimeout=="function"?setTimeout:void 0,F1=typeof clearTimeout=="function"?clearTimeout:void 0,pp=typeof Promise=="function"?Promise:void 0,O1=typeof queueMicrotask=="function"?queueMicrotask:typeof pp<"u"?function(e){return pp.resolve(null).then(e).catch(D1)}:sd;function D1(e){setTimeout(function(){throw e})}function ac(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),To(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);To(t)}function Wr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function mp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Di=Math.random().toString(36).slice(2),Gn="__reactFiber$"+Di,Fo="__reactProps$"+Di,gr="__reactContainer$"+Di,id="__reactEvents$"+Di,z1="__reactListeners$"+Di,$1="__reactHandles$"+Di;function as(e){var t=e[Gn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[gr]||n[Gn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=mp(e);e!==null;){if(n=e[Gn])return n;e=mp(e)}return t}e=n,n=e.parentNode}return null}function tl(e){return e=e[Gn]||e[gr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ei(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(W(33))}function nu(e){return e[Fo]||null}var od=[],ti=-1;function ns(e){return{current:e}}function Be(e){0>ti||(e.current=od[ti],od[ti]=null,ti--)}function De(e,t){ti++,od[ti]=e.current,e.current=t}var es={},Pt=ns(es),Jt=ns(!1),js=es;function Ri(e,t){var n=e.type.contextTypes;if(!n)return es;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Zt(e){return e=e.childContextTypes,e!=null}function Ca(){Be(Jt),Be(Pt)}function gp(e,t,n){if(Pt.current!==es)throw Error(W(168));De(Pt,t),De(Jt,n)}function Qy(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(W(108,kw(e)||"Unknown",s));return qe({},n,r)}function ka(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||es,js=Pt.current,De(Pt,e),De(Jt,Jt.current),!0}function yp(e,t,n){var r=e.stateNode;if(!r)throw Error(W(169));n?(e=Qy(e,t,js),r.__reactInternalMemoizedMergedChildContext=e,Be(Jt),Be(Pt),De(Pt,e)):Be(Jt),De(Jt,n)}var ir=null,ru=!1,uc=!1;function Ky(e){ir===null?ir=[e]:ir.push(e)}function B1(e){ru=!0,Ky(e)}function rs(){if(!uc&&ir!==null){uc=!0;var e=0,t=Ae;try{var n=ir;for(Ae=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}ir=null,ru=!1}catch(s){throw ir!==null&&(ir=ir.slice(e+1)),vy(wf,rs),s}finally{Ae=t,uc=!1}}return null}var ni=[],ri=0,Ea=null,Na=0,gn=[],yn=0,Ms=null,cr=1,dr="";function is(e,t){ni[ri++]=Na,ni[ri++]=Ea,Ea=e,Na=t}function qy(e,t,n){gn[yn++]=cr,gn[yn++]=dr,gn[yn++]=Ms,Ms=e;var r=cr;e=dr;var s=32-_n(r)-1;r&=~(1<<s),n+=1;var i=32-_n(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,cr=1<<32-_n(t)+s|n<<s|r,dr=i+e}else cr=1<<i|n<<s|r,dr=e}function Rf(e){e.return!==null&&(is(e,1),qy(e,1,0))}function Pf(e){for(;e===Ea;)Ea=ni[--ri],ni[ri]=null,Na=ni[--ri],ni[ri]=null;for(;e===Ms;)Ms=gn[--yn],gn[yn]=null,dr=gn[--yn],gn[yn]=null,cr=gn[--yn],gn[yn]=null}var on=null,sn=null,We=!1,Ln=null;function Gy(e,t){var n=xn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function vp(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,on=e,sn=Wr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,on=e,sn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ms!==null?{id:cr,overflow:dr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=xn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,on=e,sn=null,!0):!1;default:return!1}}function ld(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ad(e){if(We){var t=sn;if(t){var n=t;if(!vp(e,t)){if(ld(e))throw Error(W(418));t=Wr(n.nextSibling);var r=on;t&&vp(e,t)?Gy(r,n):(e.flags=e.flags&-4097|2,We=!1,on=e)}}else{if(ld(e))throw Error(W(418));e.flags=e.flags&-4097|2,We=!1,on=e}}}function xp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;on=e}function Ml(e){if(e!==on)return!1;if(!We)return xp(e),We=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!rd(e.type,e.memoizedProps)),t&&(t=sn)){if(ld(e))throw Yy(),Error(W(418));for(;t;)Gy(e,t),t=Wr(t.nextSibling)}if(xp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(W(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){sn=Wr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}sn=null}}else sn=on?Wr(e.stateNode.nextSibling):null;return!0}function Yy(){for(var e=sn;e;)e=Wr(e.nextSibling)}function Pi(){sn=on=null,We=!1}function Tf(e){Ln===null?Ln=[e]:Ln.push(e)}var U1=xr.ReactCurrentBatchConfig;function Zi(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,e))}return e}function Rl(e,t){throw e=Object.prototype.toString.call(t),Error(W(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function wp(e){var t=e._init;return t(e._payload)}function Xy(e){function t(y,m){if(e){var v=y.deletions;v===null?(y.deletions=[m],y.flags|=16):v.push(m)}}function n(y,m){if(!e)return null;for(;m!==null;)t(y,m),m=m.sibling;return null}function r(y,m){for(y=new Map;m!==null;)m.key!==null?y.set(m.key,m):y.set(m.index,m),m=m.sibling;return y}function s(y,m){return y=qr(y,m),y.index=0,y.sibling=null,y}function i(y,m,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<m?(y.flags|=2,m):v):(y.flags|=2,m)):(y.flags|=1048576,m)}function o(y){return e&&y.alternate===null&&(y.flags|=2),y}function l(y,m,v,g){return m===null||m.tag!==6?(m=gc(v,y.mode,g),m.return=y,m):(m=s(m,v),m.return=y,m)}function c(y,m,v,g){var S=v.type;return S===Ys?f(y,m,v.props.children,g,v.key):m!==null&&(m.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Nr&&wp(S)===m.type)?(g=s(m,v.props),g.ref=Zi(y,m,v),g.return=y,g):(g=ia(v.type,v.key,v.props,null,y.mode,g),g.ref=Zi(y,m,v),g.return=y,g)}function d(y,m,v,g){return m===null||m.tag!==4||m.stateNode.containerInfo!==v.containerInfo||m.stateNode.implementation!==v.implementation?(m=yc(v,y.mode,g),m.return=y,m):(m=s(m,v.children||[]),m.return=y,m)}function f(y,m,v,g,S){return m===null||m.tag!==7?(m=Ns(v,y.mode,g,S),m.return=y,m):(m=s(m,v),m.return=y,m)}function p(y,m,v){if(typeof m=="string"&&m!==""||typeof m=="number")return m=gc(""+m,y.mode,v),m.return=y,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case vl:return v=ia(m.type,m.key,m.props,null,y.mode,v),v.ref=Zi(y,null,m),v.return=y,v;case Gs:return m=yc(m,y.mode,v),m.return=y,m;case Nr:var g=m._init;return p(y,g(m._payload),v)}if(ao(m)||qi(m))return m=Ns(m,y.mode,v,null),m.return=y,m;Rl(y,m)}return null}function h(y,m,v,g){var S=m!==null?m.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return S!==null?null:l(y,m,""+v,g);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case vl:return v.key===S?c(y,m,v,g):null;case Gs:return v.key===S?d(y,m,v,g):null;case Nr:return S=v._init,h(y,m,S(v._payload),g)}if(ao(v)||qi(v))return S!==null?null:f(y,m,v,g,null);Rl(y,v)}return null}function w(y,m,v,g,S){if(typeof g=="string"&&g!==""||typeof g=="number")return y=y.get(v)||null,l(m,y,""+g,S);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case vl:return y=y.get(g.key===null?v:g.key)||null,c(m,y,g,S);case Gs:return y=y.get(g.key===null?v:g.key)||null,d(m,y,g,S);case Nr:var E=g._init;return w(y,m,v,E(g._payload),S)}if(ao(g)||qi(g))return y=y.get(v)||null,f(m,y,g,S,null);Rl(m,g)}return null}function x(y,m,v,g){for(var S=null,E=null,T=m,j=m=0,I=null;T!==null&&j<v.length;j++){T.index>j?(I=T,T=null):I=T.sibling;var M=h(y,T,v[j],g);if(M===null){T===null&&(T=I);break}e&&T&&M.alternate===null&&t(y,T),m=i(M,m,j),E===null?S=M:E.sibling=M,E=M,T=I}if(j===v.length)return n(y,T),We&&is(y,j),S;if(T===null){for(;j<v.length;j++)T=p(y,v[j],g),T!==null&&(m=i(T,m,j),E===null?S=T:E.sibling=T,E=T);return We&&is(y,j),S}for(T=r(y,T);j<v.length;j++)I=w(T,y,j,v[j],g),I!==null&&(e&&I.alternate!==null&&T.delete(I.key===null?j:I.key),m=i(I,m,j),E===null?S=I:E.sibling=I,E=I);return e&&T.forEach(function(B){return t(y,B)}),We&&is(y,j),S}function b(y,m,v,g){var S=qi(v);if(typeof S!="function")throw Error(W(150));if(v=S.call(v),v==null)throw Error(W(151));for(var E=S=null,T=m,j=m=0,I=null,M=v.next();T!==null&&!M.done;j++,M=v.next()){T.index>j?(I=T,T=null):I=T.sibling;var B=h(y,T,M.value,g);if(B===null){T===null&&(T=I);break}e&&T&&B.alternate===null&&t(y,T),m=i(B,m,j),E===null?S=B:E.sibling=B,E=B,T=I}if(M.done)return n(y,T),We&&is(y,j),S;if(T===null){for(;!M.done;j++,M=v.next())M=p(y,M.value,g),M!==null&&(m=i(M,m,j),E===null?S=M:E.sibling=M,E=M);return We&&is(y,j),S}for(T=r(y,T);!M.done;j++,M=v.next())M=w(T,y,j,M.value,g),M!==null&&(e&&M.alternate!==null&&T.delete(M.key===null?j:M.key),m=i(M,m,j),E===null?S=M:E.sibling=M,E=M);return e&&T.forEach(function(F){return t(y,F)}),We&&is(y,j),S}function C(y,m,v,g){if(typeof v=="object"&&v!==null&&v.type===Ys&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case vl:e:{for(var S=v.key,E=m;E!==null;){if(E.key===S){if(S=v.type,S===Ys){if(E.tag===7){n(y,E.sibling),m=s(E,v.props.children),m.return=y,y=m;break e}}else if(E.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Nr&&wp(S)===E.type){n(y,E.sibling),m=s(E,v.props),m.ref=Zi(y,E,v),m.return=y,y=m;break e}n(y,E);break}else t(y,E);E=E.sibling}v.type===Ys?(m=Ns(v.props.children,y.mode,g,v.key),m.return=y,y=m):(g=ia(v.type,v.key,v.props,null,y.mode,g),g.ref=Zi(y,m,v),g.return=y,y=g)}return o(y);case Gs:e:{for(E=v.key;m!==null;){if(m.key===E)if(m.tag===4&&m.stateNode.containerInfo===v.containerInfo&&m.stateNode.implementation===v.implementation){n(y,m.sibling),m=s(m,v.children||[]),m.return=y,y=m;break e}else{n(y,m);break}else t(y,m);m=m.sibling}m=yc(v,y.mode,g),m.return=y,y=m}return o(y);case Nr:return E=v._init,C(y,m,E(v._payload),g)}if(ao(v))return x(y,m,v,g);if(qi(v))return b(y,m,v,g);Rl(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,m!==null&&m.tag===6?(n(y,m.sibling),m=s(m,v),m.return=y,y=m):(n(y,m),m=gc(v,y.mode,g),m.return=y,y=m),o(y)):n(y,m)}return C}var Ti=Xy(!0),Jy=Xy(!1),ja=ns(null),Ma=null,si=null,If=null;function Lf(){If=si=Ma=null}function _f(e){var t=ja.current;Be(ja),e._currentValue=t}function ud(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function di(e,t){Ma=e,If=si=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Xt=!0),e.firstContext=null)}function bn(e){var t=e._currentValue;if(If!==e)if(e={context:e,memoizedValue:t,next:null},si===null){if(Ma===null)throw Error(W(308));si=e,Ma.dependencies={lanes:0,firstContext:e}}else si=si.next=e;return t}var us=null;function Af(e){us===null?us=[e]:us.push(e)}function Zy(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Af(t)):(n.next=s.next,s.next=n),t.interleaved=n,yr(e,r)}function yr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var jr=!1;function Ff(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ev(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function fr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Hr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Pe&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,yr(e,n)}return s=r.interleaved,s===null?(t.next=t,Af(r)):(t.next=s.next,s.next=t),r.interleaved=t,yr(e,n)}function Zl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,bf(e,n)}}function bp(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ra(e,t,n,r){var s=e.updateQueue;jr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=c))}if(i!==null){var p=s.baseState;o=0,f=d=c=null,l=i;do{var h=l.lane,w=l.eventTime;if((r&h)===h){f!==null&&(f=f.next={eventTime:w,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,b=l;switch(h=t,w=n,b.tag){case 1:if(x=b.payload,typeof x=="function"){p=x.call(w,p,h);break e}p=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=b.payload,h=typeof x=="function"?x.call(w,p,h):x,h==null)break e;p=qe({},p,h);break e;case 2:jr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else w={eventTime:w,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=w,c=p):f=f.next=w,o|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(f===null&&(c=p),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Ps|=o,e.lanes=o,e.memoizedState=p}}function Sp(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var nl={},Xn=ns(nl),Oo=ns(nl),Do=ns(nl);function cs(e){if(e===nl)throw Error(W(174));return e}function Of(e,t){switch(De(Do,t),De(Oo,e),De(Xn,nl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Vc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Vc(t,e)}Be(Xn),De(Xn,t)}function Ii(){Be(Xn),Be(Oo),Be(Do)}function tv(e){cs(Do.current);var t=cs(Xn.current),n=Vc(t,e.type);t!==n&&(De(Oo,e),De(Xn,n))}function Df(e){Oo.current===e&&(Be(Xn),Be(Oo))}var Qe=ns(0);function Pa(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var cc=[];function zf(){for(var e=0;e<cc.length;e++)cc[e]._workInProgressVersionPrimary=null;cc.length=0}var ea=xr.ReactCurrentDispatcher,dc=xr.ReactCurrentBatchConfig,Rs=0,Ke=null,at=null,pt=null,Ta=!1,xo=!1,zo=0,V1=0;function Nt(){throw Error(W(321))}function $f(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!On(e[n],t[n]))return!1;return!0}function Bf(e,t,n,r,s,i){if(Rs=i,Ke=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ea.current=e===null||e.memoizedState===null?K1:q1,e=n(r,s),xo){i=0;do{if(xo=!1,zo=0,25<=i)throw Error(W(301));i+=1,pt=at=null,t.updateQueue=null,ea.current=G1,e=n(r,s)}while(xo)}if(ea.current=Ia,t=at!==null&&at.next!==null,Rs=0,pt=at=Ke=null,Ta=!1,t)throw Error(W(300));return e}function Uf(){var e=zo!==0;return zo=0,e}function Hn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pt===null?Ke.memoizedState=pt=e:pt=pt.next=e,pt}function Sn(){if(at===null){var e=Ke.alternate;e=e!==null?e.memoizedState:null}else e=at.next;var t=pt===null?Ke.memoizedState:pt.next;if(t!==null)pt=t,at=e;else{if(e===null)throw Error(W(310));at=e,e={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},pt===null?Ke.memoizedState=pt=e:pt=pt.next=e}return pt}function $o(e,t){return typeof t=="function"?t(e):t}function fc(e){var t=Sn(),n=t.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=e;var r=at,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,d=i;do{var f=d.lane;if((Rs&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,Ke.lanes|=f,Ps|=f}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=l,On(r,t.memoizedState)||(Xt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Ke.lanes|=i,Ps|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function hc(e){var t=Sn(),n=t.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);On(i,t.memoizedState)||(Xt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function nv(){}function rv(e,t){var n=Ke,r=Sn(),s=t(),i=!On(r.memoizedState,s);if(i&&(r.memoizedState=s,Xt=!0),r=r.queue,Vf(ov.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||pt!==null&&pt.memoizedState.tag&1){if(n.flags|=2048,Bo(9,iv.bind(null,n,r,s,t),void 0,null),mt===null)throw Error(W(349));Rs&30||sv(n,t,s)}return s}function sv(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ke.updateQueue,t===null?(t={lastEffect:null,stores:null},Ke.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function iv(e,t,n,r){t.value=n,t.getSnapshot=r,lv(t)&&av(e)}function ov(e,t,n){return n(function(){lv(t)&&av(e)})}function lv(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!On(e,n)}catch{return!0}}function av(e){var t=yr(e,1);t!==null&&An(t,e,1,-1)}function Cp(e){var t=Hn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$o,lastRenderedState:e},t.queue=e,e=e.dispatch=Q1.bind(null,Ke,e),[t.memoizedState,e]}function Bo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ke.updateQueue,t===null?(t={lastEffect:null,stores:null},Ke.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function uv(){return Sn().memoizedState}function ta(e,t,n,r){var s=Hn();Ke.flags|=e,s.memoizedState=Bo(1|t,n,void 0,r===void 0?null:r)}function su(e,t,n,r){var s=Sn();r=r===void 0?null:r;var i=void 0;if(at!==null){var o=at.memoizedState;if(i=o.destroy,r!==null&&$f(r,o.deps)){s.memoizedState=Bo(t,n,i,r);return}}Ke.flags|=e,s.memoizedState=Bo(1|t,n,i,r)}function kp(e,t){return ta(8390656,8,e,t)}function Vf(e,t){return su(2048,8,e,t)}function cv(e,t){return su(4,2,e,t)}function dv(e,t){return su(4,4,e,t)}function fv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function hv(e,t,n){return n=n!=null?n.concat([e]):null,su(4,4,fv.bind(null,t,e),n)}function Wf(){}function pv(e,t){var n=Sn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&$f(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function mv(e,t){var n=Sn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&$f(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function gv(e,t,n){return Rs&21?(On(n,t)||(n=by(),Ke.lanes|=n,Ps|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Xt=!0),e.memoizedState=n)}function W1(e,t){var n=Ae;Ae=n!==0&&4>n?n:4,e(!0);var r=dc.transition;dc.transition={};try{e(!1),t()}finally{Ae=n,dc.transition=r}}function yv(){return Sn().memoizedState}function H1(e,t,n){var r=Kr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},vv(e))xv(t,n);else if(n=Zy(e,t,n,r),n!==null){var s=Dt();An(n,e,r,s),wv(n,t,r)}}function Q1(e,t,n){var r=Kr(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(vv(e))xv(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,On(l,o)){var c=t.interleaved;c===null?(s.next=s,Af(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Zy(e,t,s,r),n!==null&&(s=Dt(),An(n,e,r,s),wv(n,t,r))}}function vv(e){var t=e.alternate;return e===Ke||t!==null&&t===Ke}function xv(e,t){xo=Ta=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function wv(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,bf(e,n)}}var Ia={readContext:bn,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useInsertionEffect:Nt,useLayoutEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useMutableSource:Nt,useSyncExternalStore:Nt,useId:Nt,unstable_isNewReconciler:!1},K1={readContext:bn,useCallback:function(e,t){return Hn().memoizedState=[e,t===void 0?null:t],e},useContext:bn,useEffect:kp,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ta(4194308,4,fv.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ta(4194308,4,e,t)},useInsertionEffect:function(e,t){return ta(4,2,e,t)},useMemo:function(e,t){var n=Hn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Hn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=H1.bind(null,Ke,e),[r.memoizedState,e]},useRef:function(e){var t=Hn();return e={current:e},t.memoizedState=e},useState:Cp,useDebugValue:Wf,useDeferredValue:function(e){return Hn().memoizedState=e},useTransition:function(){var e=Cp(!1),t=e[0];return e=W1.bind(null,e[1]),Hn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ke,s=Hn();if(We){if(n===void 0)throw Error(W(407));n=n()}else{if(n=t(),mt===null)throw Error(W(349));Rs&30||sv(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,kp(ov.bind(null,r,i,e),[e]),r.flags|=2048,Bo(9,iv.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Hn(),t=mt.identifierPrefix;if(We){var n=dr,r=cr;n=(r&~(1<<32-_n(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=zo++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=V1++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},q1={readContext:bn,useCallback:pv,useContext:bn,useEffect:Vf,useImperativeHandle:hv,useInsertionEffect:cv,useLayoutEffect:dv,useMemo:mv,useReducer:fc,useRef:uv,useState:function(){return fc($o)},useDebugValue:Wf,useDeferredValue:function(e){var t=Sn();return gv(t,at.memoizedState,e)},useTransition:function(){var e=fc($o)[0],t=Sn().memoizedState;return[e,t]},useMutableSource:nv,useSyncExternalStore:rv,useId:yv,unstable_isNewReconciler:!1},G1={readContext:bn,useCallback:pv,useContext:bn,useEffect:Vf,useImperativeHandle:hv,useInsertionEffect:cv,useLayoutEffect:dv,useMemo:mv,useReducer:hc,useRef:uv,useState:function(){return hc($o)},useDebugValue:Wf,useDeferredValue:function(e){var t=Sn();return at===null?t.memoizedState=e:gv(t,at.memoizedState,e)},useTransition:function(){var e=hc($o)[0],t=Sn().memoizedState;return[e,t]},useMutableSource:nv,useSyncExternalStore:rv,useId:yv,unstable_isNewReconciler:!1};function Mn(e,t){if(e&&e.defaultProps){t=qe({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function cd(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:qe({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var iu={isMounted:function(e){return(e=e._reactInternals)?As(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Dt(),s=Kr(e),i=fr(r,s);i.payload=t,n!=null&&(i.callback=n),t=Hr(e,i,s),t!==null&&(An(t,e,s,r),Zl(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Dt(),s=Kr(e),i=fr(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Hr(e,i,s),t!==null&&(An(t,e,s,r),Zl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Dt(),r=Kr(e),s=fr(n,r);s.tag=2,t!=null&&(s.callback=t),t=Hr(e,s,r),t!==null&&(An(t,e,r,n),Zl(t,e,r))}};function Ep(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!Lo(n,r)||!Lo(s,i):!0}function bv(e,t,n){var r=!1,s=es,i=t.contextType;return typeof i=="object"&&i!==null?i=bn(i):(s=Zt(t)?js:Pt.current,r=t.contextTypes,i=(r=r!=null)?Ri(e,s):es),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=iu,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Np(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&iu.enqueueReplaceState(t,t.state,null)}function dd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Ff(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=bn(i):(i=Zt(t)?js:Pt.current,s.context=Ri(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(cd(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&iu.enqueueReplaceState(s,s.state,null),Ra(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Li(e,t){try{var n="",r=t;do n+=Cw(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function pc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function fd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Y1=typeof WeakMap=="function"?WeakMap:Map;function Sv(e,t,n){n=fr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){_a||(_a=!0,Sd=r),fd(e,t)},n}function Cv(e,t,n){n=fr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){fd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){fd(e,t),typeof r!="function"&&(Qr===null?Qr=new Set([this]):Qr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function jp(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Y1;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=cb.bind(null,e,t,n),t.then(e,e))}function Mp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Rp(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=fr(-1,1),t.tag=2,Hr(n,t,1))),n.lanes|=1),e)}var X1=xr.ReactCurrentOwner,Xt=!1;function Ft(e,t,n,r){t.child=e===null?Jy(t,null,n,r):Ti(t,e.child,n,r)}function Pp(e,t,n,r,s){n=n.render;var i=t.ref;return di(t,s),r=Bf(e,t,n,r,i,s),n=Uf(),e!==null&&!Xt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,vr(e,t,s)):(We&&n&&Rf(t),t.flags|=1,Ft(e,t,r,s),t.child)}function Tp(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!Jf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,kv(e,t,i,r,s)):(e=ia(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Lo,n(o,r)&&e.ref===t.ref)return vr(e,t,s)}return t.flags|=1,e=qr(i,r),e.ref=t.ref,e.return=t,t.child=e}function kv(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(Lo(i,r)&&e.ref===t.ref)if(Xt=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Xt=!0);else return t.lanes=e.lanes,vr(e,t,s)}return hd(e,t,n,r,s)}function Ev(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(oi,rn),rn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,De(oi,rn),rn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,De(oi,rn),rn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,De(oi,rn),rn|=r;return Ft(e,t,s,n),t.child}function Nv(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function hd(e,t,n,r,s){var i=Zt(n)?js:Pt.current;return i=Ri(t,i),di(t,s),n=Bf(e,t,n,r,i,s),r=Uf(),e!==null&&!Xt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,vr(e,t,s)):(We&&r&&Rf(t),t.flags|=1,Ft(e,t,n,s),t.child)}function Ip(e,t,n,r,s){if(Zt(n)){var i=!0;ka(t)}else i=!1;if(di(t,s),t.stateNode===null)na(e,t),bv(t,n,r),dd(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=bn(d):(d=Zt(n)?js:Pt.current,d=Ri(t,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&Np(t,o,r,d),jr=!1;var h=t.memoizedState;o.state=h,Ra(t,r,o,s),c=t.memoizedState,l!==r||h!==c||Jt.current||jr?(typeof f=="function"&&(cd(t,n,f,r),c=t.memoizedState),(l=jr||Ep(t,n,l,r,h,c,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ev(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Mn(t.type,l),o.props=d,p=t.pendingProps,h=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=bn(c):(c=Zt(n)?js:Pt.current,c=Ri(t,c));var w=n.getDerivedStateFromProps;(f=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||h!==c)&&Np(t,o,r,c),jr=!1,h=t.memoizedState,o.state=h,Ra(t,r,o,s);var x=t.memoizedState;l!==p||h!==x||Jt.current||jr?(typeof w=="function"&&(cd(t,n,w,r),x=t.memoizedState),(d=jr||Ep(t,n,d,r,h,x,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=x),o.props=r,o.state=x,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return pd(e,t,n,r,i,s)}function pd(e,t,n,r,s,i){Nv(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&yp(t,n,!1),vr(e,t,i);r=t.stateNode,X1.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Ti(t,e.child,null,i),t.child=Ti(t,null,l,i)):Ft(e,t,l,i),t.memoizedState=r.state,s&&yp(t,n,!0),t.child}function jv(e){var t=e.stateNode;t.pendingContext?gp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&gp(e,t.context,!1),Of(e,t.containerInfo)}function Lp(e,t,n,r,s){return Pi(),Tf(s),t.flags|=256,Ft(e,t,n,r),t.child}var md={dehydrated:null,treeContext:null,retryLane:0};function gd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Mv(e,t,n){var r=t.pendingProps,s=Qe.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),De(Qe,s&1),e===null)return ad(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=au(o,r,0,null),e=Ns(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=gd(n),t.memoizedState=md,e):Hf(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return J1(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=qr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=qr(l,i):(i=Ns(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?gd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=md,r}return i=e.child,e=i.sibling,r=qr(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Hf(e,t){return t=au({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Pl(e,t,n,r){return r!==null&&Tf(r),Ti(t,e.child,null,n),e=Hf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function J1(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=pc(Error(W(422))),Pl(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=au({mode:"visible",children:r.children},s,0,null),i=Ns(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Ti(t,e.child,null,o),t.child.memoizedState=gd(o),t.memoizedState=md,i);if(!(t.mode&1))return Pl(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(W(419)),r=pc(i,r,void 0),Pl(e,t,o,r)}if(l=(o&e.childLanes)!==0,Xt||l){if(r=mt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,yr(e,s),An(r,e,s,-1))}return Xf(),r=pc(Error(W(421))),Pl(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=db.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,sn=Wr(s.nextSibling),on=t,We=!0,Ln=null,e!==null&&(gn[yn++]=cr,gn[yn++]=dr,gn[yn++]=Ms,cr=e.id,dr=e.overflow,Ms=t),t=Hf(t,r.children),t.flags|=4096,t)}function _p(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ud(e.return,t,n)}function mc(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Rv(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(Ft(e,t,r.children,n),r=Qe.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&_p(e,n,t);else if(e.tag===19)_p(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(De(Qe,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Pa(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),mc(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Pa(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}mc(t,!0,n,null,i);break;case"together":mc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function na(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function vr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ps|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(W(153));if(t.child!==null){for(e=t.child,n=qr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=qr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Z1(e,t,n){switch(t.tag){case 3:jv(t),Pi();break;case 5:tv(t);break;case 1:Zt(t.type)&&ka(t);break;case 4:Of(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;De(ja,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(De(Qe,Qe.current&1),t.flags|=128,null):n&t.child.childLanes?Mv(e,t,n):(De(Qe,Qe.current&1),e=vr(e,t,n),e!==null?e.sibling:null);De(Qe,Qe.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Rv(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),De(Qe,Qe.current),r)break;return null;case 22:case 23:return t.lanes=0,Ev(e,t,n)}return vr(e,t,n)}var Pv,yd,Tv,Iv;Pv=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};yd=function(){};Tv=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,cs(Xn.current);var i=null;switch(n){case"input":s=zc(e,s),r=zc(e,r),i=[];break;case"select":s=qe({},s,{value:void 0}),r=qe({},r,{value:void 0}),i=[];break;case"textarea":s=Uc(e,s),r=Uc(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Sa)}Wc(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(No.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(No.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&$e("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Iv=function(e,t,n,r){n!==r&&(t.flags|=4)};function eo(e,t){if(!We)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function eb(e,t,n){var r=t.pendingProps;switch(Pf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(t),null;case 1:return Zt(t.type)&&Ca(),jt(t),null;case 3:return r=t.stateNode,Ii(),Be(Jt),Be(Pt),zf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Ml(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Ln!==null&&(Ed(Ln),Ln=null))),yd(e,t),jt(t),null;case 5:Df(t);var s=cs(Do.current);if(n=t.type,e!==null&&t.stateNode!=null)Tv(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(W(166));return jt(t),null}if(e=cs(Xn.current),Ml(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Gn]=t,r[Fo]=i,e=(t.mode&1)!==0,n){case"dialog":$e("cancel",r),$e("close",r);break;case"iframe":case"object":case"embed":$e("load",r);break;case"video":case"audio":for(s=0;s<co.length;s++)$e(co[s],r);break;case"source":$e("error",r);break;case"img":case"image":case"link":$e("error",r),$e("load",r);break;case"details":$e("toggle",r);break;case"input":Vh(r,i),$e("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},$e("invalid",r);break;case"textarea":Hh(r,i),$e("invalid",r)}Wc(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&jl(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&jl(r.textContent,l,e),s=["children",""+l]):No.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&$e("scroll",r)}switch(n){case"input":xl(r),Wh(r,i,!0);break;case"textarea":xl(r),Qh(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Sa)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=oy(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Gn]=t,e[Fo]=r,Pv(e,t,!1,!1),t.stateNode=e;e:{switch(o=Hc(n,r),n){case"dialog":$e("cancel",e),$e("close",e),s=r;break;case"iframe":case"object":case"embed":$e("load",e),s=r;break;case"video":case"audio":for(s=0;s<co.length;s++)$e(co[s],e);s=r;break;case"source":$e("error",e),s=r;break;case"img":case"image":case"link":$e("error",e),$e("load",e),s=r;break;case"details":$e("toggle",e),s=r;break;case"input":Vh(e,r),s=zc(e,r),$e("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=qe({},r,{value:void 0}),$e("invalid",e);break;case"textarea":Hh(e,r),s=Uc(e,r),$e("invalid",e);break;default:s=r}Wc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?uy(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ly(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&jo(e,c):typeof c=="number"&&jo(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(No.hasOwnProperty(i)?c!=null&&i==="onScroll"&&$e("scroll",e):c!=null&&mf(e,i,c,o))}switch(n){case"input":xl(e),Wh(e,r,!1);break;case"textarea":xl(e),Qh(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Zr(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?li(e,!!r.multiple,i,!1):r.defaultValue!=null&&li(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Sa)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return jt(t),null;case 6:if(e&&t.stateNode!=null)Iv(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(W(166));if(n=cs(Do.current),cs(Xn.current),Ml(t)){if(r=t.stateNode,n=t.memoizedProps,r[Gn]=t,(i=r.nodeValue!==n)&&(e=on,e!==null))switch(e.tag){case 3:jl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&jl(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Gn]=t,t.stateNode=r}return jt(t),null;case 13:if(Be(Qe),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(We&&sn!==null&&t.mode&1&&!(t.flags&128))Yy(),Pi(),t.flags|=98560,i=!1;else if(i=Ml(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(W(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Gn]=t}else Pi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;jt(t),i=!1}else Ln!==null&&(Ed(Ln),Ln=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Qe.current&1?ct===0&&(ct=3):Xf())),t.updateQueue!==null&&(t.flags|=4),jt(t),null);case 4:return Ii(),yd(e,t),e===null&&_o(t.stateNode.containerInfo),jt(t),null;case 10:return _f(t.type._context),jt(t),null;case 17:return Zt(t.type)&&Ca(),jt(t),null;case 19:if(Be(Qe),i=t.memoizedState,i===null)return jt(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)eo(i,!1);else{if(ct!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Pa(e),o!==null){for(t.flags|=128,eo(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return De(Qe,Qe.current&1|2),t.child}e=e.sibling}i.tail!==null&&nt()>_i&&(t.flags|=128,r=!0,eo(i,!1),t.lanes=4194304)}else{if(!r)if(e=Pa(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),eo(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!We)return jt(t),null}else 2*nt()-i.renderingStartTime>_i&&n!==1073741824&&(t.flags|=128,r=!0,eo(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=nt(),t.sibling=null,n=Qe.current,De(Qe,r?n&1|2:n&1),t):(jt(t),null);case 22:case 23:return Yf(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?rn&1073741824&&(jt(t),t.subtreeFlags&6&&(t.flags|=8192)):jt(t),null;case 24:return null;case 25:return null}throw Error(W(156,t.tag))}function tb(e,t){switch(Pf(t),t.tag){case 1:return Zt(t.type)&&Ca(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ii(),Be(Jt),Be(Pt),zf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Df(t),null;case 13:if(Be(Qe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(W(340));Pi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Be(Qe),null;case 4:return Ii(),null;case 10:return _f(t.type._context),null;case 22:case 23:return Yf(),null;case 24:return null;default:return null}}var Tl=!1,Mt=!1,nb=typeof WeakSet=="function"?WeakSet:Set,ne=null;function ii(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ze(e,t,r)}else n.current=null}function vd(e,t,n){try{n()}catch(r){Ze(e,t,r)}}var Ap=!1;function rb(e,t){if(td=xa,e=Oy(),Mf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,f=0,p=e,h=null;t:for(;;){for(var w;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(w=p.firstChild)!==null;)h=p,p=w;for(;;){if(p===e)break t;if(h===n&&++d===s&&(l=o),h===i&&++f===r&&(c=o),(w=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=w}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(nd={focusedElem:e,selectionRange:n},xa=!1,ne=t;ne!==null;)if(t=ne,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ne=e;else for(;ne!==null;){t=ne;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var b=x.memoizedProps,C=x.memoizedState,y=t.stateNode,m=y.getSnapshotBeforeUpdate(t.elementType===t.type?b:Mn(t.type,b),C);y.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(g){Ze(t,t.return,g)}if(e=t.sibling,e!==null){e.return=t.return,ne=e;break}ne=t.return}return x=Ap,Ap=!1,x}function wo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&vd(t,n,i)}s=s.next}while(s!==r)}}function ou(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function xd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Lv(e){var t=e.alternate;t!==null&&(e.alternate=null,Lv(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gn],delete t[Fo],delete t[id],delete t[z1],delete t[$1])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function _v(e){return e.tag===5||e.tag===3||e.tag===4}function Fp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||_v(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function wd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Sa));else if(r!==4&&(e=e.child,e!==null))for(wd(e,t,n),e=e.sibling;e!==null;)wd(e,t,n),e=e.sibling}function bd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(bd(e,t,n),e=e.sibling;e!==null;)bd(e,t,n),e=e.sibling}var xt=null,In=!1;function Cr(e,t,n){for(n=n.child;n!==null;)Av(e,t,n),n=n.sibling}function Av(e,t,n){if(Yn&&typeof Yn.onCommitFiberUnmount=="function")try{Yn.onCommitFiberUnmount(Ja,n)}catch{}switch(n.tag){case 5:Mt||ii(n,t);case 6:var r=xt,s=In;xt=null,Cr(e,t,n),xt=r,In=s,xt!==null&&(In?(e=xt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):xt.removeChild(n.stateNode));break;case 18:xt!==null&&(In?(e=xt,n=n.stateNode,e.nodeType===8?ac(e.parentNode,n):e.nodeType===1&&ac(e,n),To(e)):ac(xt,n.stateNode));break;case 4:r=xt,s=In,xt=n.stateNode.containerInfo,In=!0,Cr(e,t,n),xt=r,In=s;break;case 0:case 11:case 14:case 15:if(!Mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&vd(n,t,o),s=s.next}while(s!==r)}Cr(e,t,n);break;case 1:if(!Mt&&(ii(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ze(n,t,l)}Cr(e,t,n);break;case 21:Cr(e,t,n);break;case 22:n.mode&1?(Mt=(r=Mt)||n.memoizedState!==null,Cr(e,t,n),Mt=r):Cr(e,t,n);break;default:Cr(e,t,n)}}function Op(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new nb),t.forEach(function(r){var s=fb.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Nn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:xt=l.stateNode,In=!1;break e;case 3:xt=l.stateNode.containerInfo,In=!0;break e;case 4:xt=l.stateNode.containerInfo,In=!0;break e}l=l.return}if(xt===null)throw Error(W(160));Av(i,o,s),xt=null,In=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Ze(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Fv(t,e),t=t.sibling}function Fv(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Nn(t,e),Wn(e),r&4){try{wo(3,e,e.return),ou(3,e)}catch(b){Ze(e,e.return,b)}try{wo(5,e,e.return)}catch(b){Ze(e,e.return,b)}}break;case 1:Nn(t,e),Wn(e),r&512&&n!==null&&ii(n,n.return);break;case 5:if(Nn(t,e),Wn(e),r&512&&n!==null&&ii(n,n.return),e.flags&32){var s=e.stateNode;try{jo(s,"")}catch(b){Ze(e,e.return,b)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&sy(s,i),Hc(l,o);var d=Hc(l,i);for(o=0;o<c.length;o+=2){var f=c[o],p=c[o+1];f==="style"?uy(s,p):f==="dangerouslySetInnerHTML"?ly(s,p):f==="children"?jo(s,p):mf(s,f,p,d)}switch(l){case"input":$c(s,i);break;case"textarea":iy(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?li(s,!!i.multiple,w,!1):h!==!!i.multiple&&(i.defaultValue!=null?li(s,!!i.multiple,i.defaultValue,!0):li(s,!!i.multiple,i.multiple?[]:"",!1))}s[Fo]=i}catch(b){Ze(e,e.return,b)}}break;case 6:if(Nn(t,e),Wn(e),r&4){if(e.stateNode===null)throw Error(W(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(b){Ze(e,e.return,b)}}break;case 3:if(Nn(t,e),Wn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{To(t.containerInfo)}catch(b){Ze(e,e.return,b)}break;case 4:Nn(t,e),Wn(e);break;case 13:Nn(t,e),Wn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(qf=nt())),r&4&&Op(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(Mt=(d=Mt)||f,Nn(t,e),Mt=d):Nn(t,e),Wn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!f&&e.mode&1)for(ne=e,f=e.child;f!==null;){for(p=ne=f;ne!==null;){switch(h=ne,w=h.child,h.tag){case 0:case 11:case 14:case 15:wo(4,h,h.return);break;case 1:ii(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(b){Ze(r,n,b)}}break;case 5:ii(h,h.return);break;case 22:if(h.memoizedState!==null){zp(p);continue}}w!==null?(w.return=h,ne=w):zp(p)}f=f.sibling}e:for(f=null,p=e;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=ay("display",o))}catch(b){Ze(e,e.return,b)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(b){Ze(e,e.return,b)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Nn(t,e),Wn(e),r&4&&Op(e);break;case 21:break;default:Nn(t,e),Wn(e)}}function Wn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(_v(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(jo(s,""),r.flags&=-33);var i=Fp(e);bd(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Fp(e);wd(e,l,o);break;default:throw Error(W(161))}}catch(c){Ze(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function sb(e,t,n){ne=e,Ov(e)}function Ov(e,t,n){for(var r=(e.mode&1)!==0;ne!==null;){var s=ne,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Tl;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Mt;l=Tl;var d=Mt;if(Tl=o,(Mt=c)&&!d)for(ne=s;ne!==null;)o=ne,c=o.child,o.tag===22&&o.memoizedState!==null?$p(s):c!==null?(c.return=o,ne=c):$p(s);for(;i!==null;)ne=i,Ov(i),i=i.sibling;ne=s,Tl=l,Mt=d}Dp(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ne=i):Dp(e)}}function Dp(e){for(;ne!==null;){var t=ne;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Mt||ou(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Mt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Mn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Sp(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Sp(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&To(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}Mt||t.flags&512&&xd(t)}catch(h){Ze(t,t.return,h)}}if(t===e){ne=null;break}if(n=t.sibling,n!==null){n.return=t.return,ne=n;break}ne=t.return}}function zp(e){for(;ne!==null;){var t=ne;if(t===e){ne=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ne=n;break}ne=t.return}}function $p(e){for(;ne!==null;){var t=ne;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ou(4,t)}catch(c){Ze(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){Ze(t,s,c)}}var i=t.return;try{xd(t)}catch(c){Ze(t,i,c)}break;case 5:var o=t.return;try{xd(t)}catch(c){Ze(t,o,c)}}}catch(c){Ze(t,t.return,c)}if(t===e){ne=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ne=l;break}ne=t.return}}var ib=Math.ceil,La=xr.ReactCurrentDispatcher,Qf=xr.ReactCurrentOwner,wn=xr.ReactCurrentBatchConfig,Pe=0,mt=null,st=null,wt=0,rn=0,oi=ns(0),ct=0,Uo=null,Ps=0,lu=0,Kf=0,bo=null,Yt=null,qf=0,_i=1/0,sr=null,_a=!1,Sd=null,Qr=null,Il=!1,$r=null,Aa=0,So=0,Cd=null,ra=-1,sa=0;function Dt(){return Pe&6?nt():ra!==-1?ra:ra=nt()}function Kr(e){return e.mode&1?Pe&2&&wt!==0?wt&-wt:U1.transition!==null?(sa===0&&(sa=by()),sa):(e=Ae,e!==0||(e=window.event,e=e===void 0?16:My(e.type)),e):1}function An(e,t,n,r){if(50<So)throw So=0,Cd=null,Error(W(185));Zo(e,n,r),(!(Pe&2)||e!==mt)&&(e===mt&&(!(Pe&2)&&(lu|=n),ct===4&&Rr(e,wt)),en(e,r),n===1&&Pe===0&&!(t.mode&1)&&(_i=nt()+500,ru&&rs()))}function en(e,t){var n=e.callbackNode;Uw(e,t);var r=va(e,e===mt?wt:0);if(r===0)n!==null&&Gh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Gh(n),t===1)e.tag===0?B1(Bp.bind(null,e)):Ky(Bp.bind(null,e)),O1(function(){!(Pe&6)&&rs()}),n=null;else{switch(Sy(r)){case 1:n=wf;break;case 4:n=xy;break;case 16:n=ya;break;case 536870912:n=wy;break;default:n=ya}n=Hv(n,Dv.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Dv(e,t){if(ra=-1,sa=0,Pe&6)throw Error(W(327));var n=e.callbackNode;if(fi()&&e.callbackNode!==n)return null;var r=va(e,e===mt?wt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Fa(e,r);else{t=r;var s=Pe;Pe|=2;var i=$v();(mt!==e||wt!==t)&&(sr=null,_i=nt()+500,Es(e,t));do try{ab();break}catch(l){zv(e,l)}while(!0);Lf(),La.current=i,Pe=s,st!==null?t=0:(mt=null,wt=0,t=ct)}if(t!==0){if(t===2&&(s=Yc(e),s!==0&&(r=s,t=kd(e,s))),t===1)throw n=Uo,Es(e,0),Rr(e,r),en(e,nt()),n;if(t===6)Rr(e,r);else{if(s=e.current.alternate,!(r&30)&&!ob(s)&&(t=Fa(e,r),t===2&&(i=Yc(e),i!==0&&(r=i,t=kd(e,i))),t===1))throw n=Uo,Es(e,0),Rr(e,r),en(e,nt()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(W(345));case 2:os(e,Yt,sr);break;case 3:if(Rr(e,r),(r&130023424)===r&&(t=qf+500-nt(),10<t)){if(va(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Dt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=sd(os.bind(null,e,Yt,sr),t);break}os(e,Yt,sr);break;case 4:if(Rr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-_n(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=nt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ib(r/1960))-r,10<r){e.timeoutHandle=sd(os.bind(null,e,Yt,sr),r);break}os(e,Yt,sr);break;case 5:os(e,Yt,sr);break;default:throw Error(W(329))}}}return en(e,nt()),e.callbackNode===n?Dv.bind(null,e):null}function kd(e,t){var n=bo;return e.current.memoizedState.isDehydrated&&(Es(e,t).flags|=256),e=Fa(e,t),e!==2&&(t=Yt,Yt=n,t!==null&&Ed(t)),e}function Ed(e){Yt===null?Yt=e:Yt.push.apply(Yt,e)}function ob(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!On(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Rr(e,t){for(t&=~Kf,t&=~lu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-_n(t),r=1<<n;e[n]=-1,t&=~r}}function Bp(e){if(Pe&6)throw Error(W(327));fi();var t=va(e,0);if(!(t&1))return en(e,nt()),null;var n=Fa(e,t);if(e.tag!==0&&n===2){var r=Yc(e);r!==0&&(t=r,n=kd(e,r))}if(n===1)throw n=Uo,Es(e,0),Rr(e,t),en(e,nt()),n;if(n===6)throw Error(W(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,os(e,Yt,sr),en(e,nt()),null}function Gf(e,t){var n=Pe;Pe|=1;try{return e(t)}finally{Pe=n,Pe===0&&(_i=nt()+500,ru&&rs())}}function Ts(e){$r!==null&&$r.tag===0&&!(Pe&6)&&fi();var t=Pe;Pe|=1;var n=wn.transition,r=Ae;try{if(wn.transition=null,Ae=1,e)return e()}finally{Ae=r,wn.transition=n,Pe=t,!(Pe&6)&&rs()}}function Yf(){rn=oi.current,Be(oi)}function Es(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,F1(n)),st!==null)for(n=st.return;n!==null;){var r=n;switch(Pf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ca();break;case 3:Ii(),Be(Jt),Be(Pt),zf();break;case 5:Df(r);break;case 4:Ii();break;case 13:Be(Qe);break;case 19:Be(Qe);break;case 10:_f(r.type._context);break;case 22:case 23:Yf()}n=n.return}if(mt=e,st=e=qr(e.current,null),wt=rn=t,ct=0,Uo=null,Kf=lu=Ps=0,Yt=bo=null,us!==null){for(t=0;t<us.length;t++)if(n=us[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}us=null}return e}function zv(e,t){do{var n=st;try{if(Lf(),ea.current=Ia,Ta){for(var r=Ke.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Ta=!1}if(Rs=0,pt=at=Ke=null,xo=!1,zo=0,Qf.current=null,n===null||n.return===null){ct=1,Uo=t,st=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=wt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var w=Mp(o);if(w!==null){w.flags&=-257,Rp(w,o,l,i,t),w.mode&1&&jp(i,d,t),t=w,c=d;var x=t.updateQueue;if(x===null){var b=new Set;b.add(c),t.updateQueue=b}else x.add(c);break e}else{if(!(t&1)){jp(i,d,t),Xf();break e}c=Error(W(426))}}else if(We&&l.mode&1){var C=Mp(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Rp(C,o,l,i,t),Tf(Li(c,l));break e}}i=c=Li(c,l),ct!==4&&(ct=2),bo===null?bo=[i]:bo.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var y=Sv(i,c,t);bp(i,y);break e;case 1:l=c;var m=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Qr===null||!Qr.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var g=Cv(i,l,t);bp(i,g);break e}}i=i.return}while(i!==null)}Uv(n)}catch(S){t=S,st===n&&n!==null&&(st=n=n.return);continue}break}while(!0)}function $v(){var e=La.current;return La.current=Ia,e===null?Ia:e}function Xf(){(ct===0||ct===3||ct===2)&&(ct=4),mt===null||!(Ps&268435455)&&!(lu&268435455)||Rr(mt,wt)}function Fa(e,t){var n=Pe;Pe|=2;var r=$v();(mt!==e||wt!==t)&&(sr=null,Es(e,t));do try{lb();break}catch(s){zv(e,s)}while(!0);if(Lf(),Pe=n,La.current=r,st!==null)throw Error(W(261));return mt=null,wt=0,ct}function lb(){for(;st!==null;)Bv(st)}function ab(){for(;st!==null&&!Lw();)Bv(st)}function Bv(e){var t=Wv(e.alternate,e,rn);e.memoizedProps=e.pendingProps,t===null?Uv(e):st=t,Qf.current=null}function Uv(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=tb(n,t),n!==null){n.flags&=32767,st=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ct=6,st=null;return}}else if(n=eb(n,t,rn),n!==null){st=n;return}if(t=t.sibling,t!==null){st=t;return}st=t=e}while(t!==null);ct===0&&(ct=5)}function os(e,t,n){var r=Ae,s=wn.transition;try{wn.transition=null,Ae=1,ub(e,t,n,r)}finally{wn.transition=s,Ae=r}return null}function ub(e,t,n,r){do fi();while($r!==null);if(Pe&6)throw Error(W(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(W(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(Vw(e,i),e===mt&&(st=mt=null,wt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Il||(Il=!0,Hv(ya,function(){return fi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=wn.transition,wn.transition=null;var o=Ae;Ae=1;var l=Pe;Pe|=4,Qf.current=null,rb(e,n),Fv(n,e),R1(nd),xa=!!td,nd=td=null,e.current=n,sb(n),_w(),Pe=l,Ae=o,wn.transition=i}else e.current=n;if(Il&&(Il=!1,$r=e,Aa=s),i=e.pendingLanes,i===0&&(Qr=null),Ow(n.stateNode),en(e,nt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(_a)throw _a=!1,e=Sd,Sd=null,e;return Aa&1&&e.tag!==0&&fi(),i=e.pendingLanes,i&1?e===Cd?So++:(So=0,Cd=e):So=0,rs(),null}function fi(){if($r!==null){var e=Sy(Aa),t=wn.transition,n=Ae;try{if(wn.transition=null,Ae=16>e?16:e,$r===null)var r=!1;else{if(e=$r,$r=null,Aa=0,Pe&6)throw Error(W(331));var s=Pe;for(Pe|=4,ne=e.current;ne!==null;){var i=ne,o=i.child;if(ne.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(ne=d;ne!==null;){var f=ne;switch(f.tag){case 0:case 11:case 15:wo(8,f,i)}var p=f.child;if(p!==null)p.return=f,ne=p;else for(;ne!==null;){f=ne;var h=f.sibling,w=f.return;if(Lv(f),f===d){ne=null;break}if(h!==null){h.return=w,ne=h;break}ne=w}}}var x=i.alternate;if(x!==null){var b=x.child;if(b!==null){x.child=null;do{var C=b.sibling;b.sibling=null,b=C}while(b!==null)}}ne=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ne=o;else e:for(;ne!==null;){if(i=ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:wo(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,ne=y;break e}ne=i.return}}var m=e.current;for(ne=m;ne!==null;){o=ne;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,ne=v;else e:for(o=m;ne!==null;){if(l=ne,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ou(9,l)}}catch(S){Ze(l,l.return,S)}if(l===o){ne=null;break e}var g=l.sibling;if(g!==null){g.return=l.return,ne=g;break e}ne=l.return}}if(Pe=s,rs(),Yn&&typeof Yn.onPostCommitFiberRoot=="function")try{Yn.onPostCommitFiberRoot(Ja,e)}catch{}r=!0}return r}finally{Ae=n,wn.transition=t}}return!1}function Up(e,t,n){t=Li(n,t),t=Sv(e,t,1),e=Hr(e,t,1),t=Dt(),e!==null&&(Zo(e,1,t),en(e,t))}function Ze(e,t,n){if(e.tag===3)Up(e,e,n);else for(;t!==null;){if(t.tag===3){Up(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Qr===null||!Qr.has(r))){e=Li(n,e),e=Cv(t,e,1),t=Hr(t,e,1),e=Dt(),t!==null&&(Zo(t,1,e),en(t,e));break}}t=t.return}}function cb(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Dt(),e.pingedLanes|=e.suspendedLanes&n,mt===e&&(wt&n)===n&&(ct===4||ct===3&&(wt&130023424)===wt&&500>nt()-qf?Es(e,0):Kf|=n),en(e,t)}function Vv(e,t){t===0&&(e.mode&1?(t=Sl,Sl<<=1,!(Sl&130023424)&&(Sl=4194304)):t=1);var n=Dt();e=yr(e,t),e!==null&&(Zo(e,t,n),en(e,n))}function db(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Vv(e,n)}function fb(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(t),Vv(e,n)}var Wv;Wv=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Jt.current)Xt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Xt=!1,Z1(e,t,n);Xt=!!(e.flags&131072)}else Xt=!1,We&&t.flags&1048576&&qy(t,Na,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;na(e,t),e=t.pendingProps;var s=Ri(t,Pt.current);di(t,n),s=Bf(null,t,r,e,s,n);var i=Uf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Zt(r)?(i=!0,ka(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ff(t),s.updater=iu,t.stateNode=s,s._reactInternals=t,dd(t,r,e,n),t=pd(null,t,r,!0,i,n)):(t.tag=0,We&&i&&Rf(t),Ft(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(na(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=pb(r),e=Mn(r,e),s){case 0:t=hd(null,t,r,e,n);break e;case 1:t=Ip(null,t,r,e,n);break e;case 11:t=Pp(null,t,r,e,n);break e;case 14:t=Tp(null,t,r,Mn(r.type,e),n);break e}throw Error(W(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Mn(r,s),hd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Mn(r,s),Ip(e,t,r,s,n);case 3:e:{if(jv(t),e===null)throw Error(W(387));r=t.pendingProps,i=t.memoizedState,s=i.element,ev(e,t),Ra(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Li(Error(W(423)),t),t=Lp(e,t,r,n,s);break e}else if(r!==s){s=Li(Error(W(424)),t),t=Lp(e,t,r,n,s);break e}else for(sn=Wr(t.stateNode.containerInfo.firstChild),on=t,We=!0,Ln=null,n=Jy(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Pi(),r===s){t=vr(e,t,n);break e}Ft(e,t,r,n)}t=t.child}return t;case 5:return tv(t),e===null&&ad(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,rd(r,s)?o=null:i!==null&&rd(r,i)&&(t.flags|=32),Nv(e,t),Ft(e,t,o,n),t.child;case 6:return e===null&&ad(t),null;case 13:return Mv(e,t,n);case 4:return Of(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ti(t,null,r,n):Ft(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Mn(r,s),Pp(e,t,r,s,n);case 7:return Ft(e,t,t.pendingProps,n),t.child;case 8:return Ft(e,t,t.pendingProps.children,n),t.child;case 12:return Ft(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,De(ja,r._currentValue),r._currentValue=o,i!==null)if(On(i.value,o)){if(i.children===s.children&&!Jt.current){t=vr(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=fr(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),ud(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ud(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ft(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,di(t,n),s=bn(s),r=r(s),t.flags|=1,Ft(e,t,r,n),t.child;case 14:return r=t.type,s=Mn(r,t.pendingProps),s=Mn(r.type,s),Tp(e,t,r,s,n);case 15:return kv(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Mn(r,s),na(e,t),t.tag=1,Zt(r)?(e=!0,ka(t)):e=!1,di(t,n),bv(t,r,s),dd(t,r,s,n),pd(null,t,r,!0,e,n);case 19:return Rv(e,t,n);case 22:return Ev(e,t,n)}throw Error(W(156,t.tag))};function Hv(e,t){return vy(e,t)}function hb(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(e,t,n,r){return new hb(e,t,n,r)}function Jf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function pb(e){if(typeof e=="function")return Jf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===yf)return 11;if(e===vf)return 14}return 2}function qr(e,t){var n=e.alternate;return n===null?(n=xn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ia(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")Jf(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ys:return Ns(n.children,s,i,t);case gf:o=8,s|=8;break;case Ac:return e=xn(12,n,t,s|2),e.elementType=Ac,e.lanes=i,e;case Fc:return e=xn(13,n,t,s),e.elementType=Fc,e.lanes=i,e;case Oc:return e=xn(19,n,t,s),e.elementType=Oc,e.lanes=i,e;case ty:return au(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Zg:o=10;break e;case ey:o=9;break e;case yf:o=11;break e;case vf:o=14;break e;case Nr:o=16,r=null;break e}throw Error(W(130,e==null?e:typeof e,""))}return t=xn(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function Ns(e,t,n,r){return e=xn(7,e,r,t),e.lanes=n,e}function au(e,t,n,r){return e=xn(22,e,r,t),e.elementType=ty,e.lanes=n,e.stateNode={isHidden:!1},e}function gc(e,t,n){return e=xn(6,e,null,t),e.lanes=n,e}function yc(e,t,n){return t=xn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function mb(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Xu(0),this.expirationTimes=Xu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Xu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Zf(e,t,n,r,s,i,o,l,c){return e=new mb(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=xn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ff(i),e}function gb(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gs,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Qv(e){if(!e)return es;e=e._reactInternals;e:{if(As(e)!==e||e.tag!==1)throw Error(W(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Zt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(W(171))}if(e.tag===1){var n=e.type;if(Zt(n))return Qy(e,n,t)}return t}function Kv(e,t,n,r,s,i,o,l,c){return e=Zf(n,r,!0,e,s,i,o,l,c),e.context=Qv(null),n=e.current,r=Dt(),s=Kr(n),i=fr(r,s),i.callback=t??null,Hr(n,i,s),e.current.lanes=s,Zo(e,s,r),en(e,r),e}function uu(e,t,n,r){var s=t.current,i=Dt(),o=Kr(s);return n=Qv(n),t.context===null?t.context=n:t.pendingContext=n,t=fr(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Hr(s,t,o),e!==null&&(An(e,s,o,i),Zl(e,s,o)),o}function Oa(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Vp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function eh(e,t){Vp(e,t),(e=e.alternate)&&Vp(e,t)}function yb(){return null}var qv=typeof reportError=="function"?reportError:function(e){console.error(e)};function th(e){this._internalRoot=e}cu.prototype.render=th.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(W(409));uu(e,t,null,null)};cu.prototype.unmount=th.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ts(function(){uu(null,e,null,null)}),t[gr]=null}};function cu(e){this._internalRoot=e}cu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ey();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Mr.length&&t!==0&&t<Mr[n].priority;n++);Mr.splice(n,0,e),n===0&&jy(e)}};function nh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function du(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Wp(){}function vb(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Oa(o);i.call(d)}}var o=Kv(t,r,e,0,null,!1,!1,"",Wp);return e._reactRootContainer=o,e[gr]=o.current,_o(e.nodeType===8?e.parentNode:e),Ts(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=Oa(c);l.call(d)}}var c=Zf(e,0,!1,null,null,!1,!1,"",Wp);return e._reactRootContainer=c,e[gr]=c.current,_o(e.nodeType===8?e.parentNode:e),Ts(function(){uu(t,c,n,r)}),c}function fu(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Oa(o);l.call(c)}}uu(t,o,e,s)}else o=vb(n,t,e,s,r);return Oa(o)}Cy=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=uo(t.pendingLanes);n!==0&&(bf(t,n|1),en(t,nt()),!(Pe&6)&&(_i=nt()+500,rs()))}break;case 13:Ts(function(){var r=yr(e,1);if(r!==null){var s=Dt();An(r,e,1,s)}}),eh(e,1)}};Sf=function(e){if(e.tag===13){var t=yr(e,134217728);if(t!==null){var n=Dt();An(t,e,134217728,n)}eh(e,134217728)}};ky=function(e){if(e.tag===13){var t=Kr(e),n=yr(e,t);if(n!==null){var r=Dt();An(n,e,t,r)}eh(e,t)}};Ey=function(){return Ae};Ny=function(e,t){var n=Ae;try{return Ae=e,t()}finally{Ae=n}};Kc=function(e,t,n){switch(t){case"input":if($c(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=nu(r);if(!s)throw Error(W(90));ry(r),$c(r,s)}}}break;case"textarea":iy(e,n);break;case"select":t=n.value,t!=null&&li(e,!!n.multiple,t,!1)}};fy=Gf;hy=Ts;var xb={usingClientEntryPoint:!1,Events:[tl,ei,nu,cy,dy,Gf]},to={findFiberByHostInstance:as,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wb={bundleType:to.bundleType,version:to.version,rendererPackageName:to.rendererPackageName,rendererConfig:to.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=gy(e),e===null?null:e.stateNode},findFiberByHostInstance:to.findFiberByHostInstance||yb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ll=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ll.isDisabled&&Ll.supportsFiber)try{Ja=Ll.inject(wb),Yn=Ll}catch{}}un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xb;un.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nh(t))throw Error(W(200));return gb(e,t,null,n)};un.createRoot=function(e,t){if(!nh(e))throw Error(W(299));var n=!1,r="",s=qv;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Zf(e,1,!1,null,null,n,!1,r,s),e[gr]=t.current,_o(e.nodeType===8?e.parentNode:e),new th(t)};un.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(W(188)):(e=Object.keys(e).join(","),Error(W(268,e)));return e=gy(t),e=e===null?null:e.stateNode,e};un.flushSync=function(e){return Ts(e)};un.hydrate=function(e,t,n){if(!du(t))throw Error(W(200));return fu(null,e,t,!0,n)};un.hydrateRoot=function(e,t,n){if(!nh(e))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=qv;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Kv(t,null,e,1,n??null,s,!1,i,o),e[gr]=t.current,_o(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new cu(t)};un.render=function(e,t,n){if(!du(t))throw Error(W(200));return fu(null,e,t,!1,n)};un.unmountComponentAtNode=function(e){if(!du(e))throw Error(W(40));return e._reactRootContainer?(Ts(function(){fu(null,null,e,!1,function(){e._reactRootContainer=null,e[gr]=null})}),!0):!1};un.unstable_batchedUpdates=Gf;un.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!du(n))throw Error(W(200));if(e==null||e._reactInternals===void 0)throw Error(W(38));return fu(e,t,n,!1,r)};un.version="18.3.1-next-f1338f8080-20240426";function Gv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Gv)}catch(e){console.error(e)}}Gv(),Gg.exports=un;var hu=Gg.exports,Yv,Hp=hu;Yv=Hp.createRoot,Hp.hydrateRoot;var zi=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},bb={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Pr,af,jg,Sb=(jg=class{constructor(){ue(this,Pr,bb);ue(this,af,!1)}setTimeoutProvider(e){Z(this,Pr,e)}setTimeout(e,t){return k(this,Pr).setTimeout(e,t)}clearTimeout(e){k(this,Pr).clearTimeout(e)}setInterval(e,t){return k(this,Pr).setInterval(e,t)}clearInterval(e){k(this,Pr).clearInterval(e)}},Pr=new WeakMap,af=new WeakMap,jg),ds=new Sb;function Cb(e){setTimeout(e,0)}var Is=typeof window>"u"||"Deno"in globalThis;function Ot(){}function kb(e,t){return typeof e=="function"?e(t):e}function Nd(e){return typeof e=="number"&&e>=0&&e!==1/0}function Xv(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Gr(e,t){return typeof e=="function"?e(t):e}function mn(e,t){return typeof e=="function"?e(t):e}function Qp(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(r){if(t.queryHash!==rh(o,t.options))return!1}else if(!Vo(t.queryKey,o))return!1}if(n!=="all"){const c=t.isActive();if(n==="active"&&!c||n==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function Kp(e,t){const{exact:n,status:r,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(Ls(t.options.mutationKey)!==Ls(i))return!1}else if(!Vo(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function rh(e,t){return((t==null?void 0:t.queryKeyHashFn)||Ls)(e)}function Ls(e){return JSON.stringify(e,(t,n)=>jd(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function Vo(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Vo(e[n],t[n])):!1}var Eb=Object.prototype.hasOwnProperty;function Jv(e,t){if(e===t)return e;const n=qp(e)&&qp(t);if(!n&&!(jd(e)&&jd(t)))return t;const s=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),o=i.length,l=n?new Array(o):{};let c=0;for(let d=0;d<o;d++){const f=n?d:i[d],p=e[f],h=t[f];if(p===h){l[f]=p,(n?d<s:Eb.call(e,f))&&c++;continue}if(p===null||h===null||typeof p!="object"||typeof h!="object"){l[f]=h;continue}const w=Jv(p,h);l[f]=w,w===p&&c++}return s===o&&c===s?e:l}function Da(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function qp(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function jd(e){if(!Gp(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!Gp(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Gp(e){return Object.prototype.toString.call(e)==="[object Object]"}function Nb(e){return new Promise(t=>{ds.setTimeout(t,e)})}function Md(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?Jv(e,t):t}function jb(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function Mb(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var sh=Symbol();function Zv(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===sh?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function ex(e,t){return typeof e=="function"?e(...t):!!e}function Rb(e,t,n){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=t()),r||(r=!0,s.aborted?n():s.addEventListener("abort",n,{once:!0})),s)}),e}var gs,Tr,gi,Mg,Pb=(Mg=class extends zi{constructor(){super();ue(this,gs);ue(this,Tr);ue(this,gi);Z(this,gi,t=>{if(!Is&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){k(this,Tr)||this.setEventListener(k(this,gi))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,Tr))==null||t.call(this),Z(this,Tr,void 0))}setEventListener(t){var n;Z(this,gi,t),(n=k(this,Tr))==null||n.call(this),Z(this,Tr,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){k(this,gs)!==t&&(Z(this,gs,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof k(this,gs)=="boolean"?k(this,gs):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},gs=new WeakMap,Tr=new WeakMap,gi=new WeakMap,Mg),ih=new Pb;function Rd(){let e,t;const n=new Promise((s,i)=>{e=s,t=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}var Tb=Cb;function Ib(){let e=[],t=0,n=l=>{l()},r=l=>{l()},s=Tb;const i=l=>{t?e.push(l):s(()=>{n(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{r(()=>{l.forEach(c=>{n(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var ut=Ib(),yi,Ir,vi,Rg,Lb=(Rg=class extends zi{constructor(){super();ue(this,yi,!0);ue(this,Ir);ue(this,vi);Z(this,vi,t=>{if(!Is&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){k(this,Ir)||this.setEventListener(k(this,vi))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,Ir))==null||t.call(this),Z(this,Ir,void 0))}setEventListener(t){var n;Z(this,vi,t),(n=k(this,Ir))==null||n.call(this),Z(this,Ir,t(this.setOnline.bind(this)))}setOnline(t){k(this,yi)!==t&&(Z(this,yi,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return k(this,yi)}},yi=new WeakMap,Ir=new WeakMap,vi=new WeakMap,Rg),za=new Lb;function _b(e){return Math.min(1e3*2**e,3e4)}function tx(e){return(e??"online")==="online"?za.isOnline():!0}var Pd=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function nx(e){let t=!1,n=0,r;const s=Rd(),i=()=>s.status!=="pending",o=b=>{var C;if(!i()){const y=new Pd(b);h(y),(C=e.onCancel)==null||C.call(e,y)}},l=()=>{t=!0},c=()=>{t=!1},d=()=>ih.isFocused()&&(e.networkMode==="always"||za.isOnline())&&e.canRun(),f=()=>tx(e.networkMode)&&e.canRun(),p=b=>{i()||(r==null||r(),s.resolve(b))},h=b=>{i()||(r==null||r(),s.reject(b))},w=()=>new Promise(b=>{var C;r=y=>{(i()||d())&&b(y)},(C=e.onPause)==null||C.call(e)}).then(()=>{var b;r=void 0,i()||(b=e.onContinue)==null||b.call(e)}),x=()=>{if(i())return;let b;const C=n===0?e.initialPromise:void 0;try{b=C??e.fn()}catch(y){b=Promise.reject(y)}Promise.resolve(b).then(p).catch(y=>{var E;if(i())return;const m=e.retry??(Is?0:3),v=e.retryDelay??_b,g=typeof v=="function"?v(n,y):v,S=m===!0||typeof m=="number"&&n<m||typeof m=="function"&&m(n,y);if(t||!S){h(y);return}n++,(E=e.onFail)==null||E.call(e,n,y),Nb(g).then(()=>d()?void 0:w()).then(()=>{t?h(y):x()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:l,continueRetry:c,canStart:f,start:()=>(f()?x():w().then(x),s)}}var ys,Pg,rx=(Pg=class{constructor(){ue(this,ys)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Nd(this.gcTime)&&Z(this,ys,ds.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Is?1/0:5*60*1e3))}clearGcTimeout(){k(this,ys)&&(ds.clearTimeout(k(this,ys)),Z(this,ys,void 0))}},ys=new WeakMap,Pg),vs,xi,pn,xs,ht,Ko,ws,Pn,rr,Tg,Ab=(Tg=class extends rx{constructor(t){super();ue(this,Pn);ue(this,vs);ue(this,xi);ue(this,pn);ue(this,xs);ue(this,ht);ue(this,Ko);ue(this,ws);Z(this,ws,!1),Z(this,Ko,t.defaultOptions),this.setOptions(t.options),this.observers=[],Z(this,xs,t.client),Z(this,pn,k(this,xs).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Z(this,vs,Xp(this.options)),this.state=t.state??k(this,vs),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=k(this,ht))==null?void 0:t.promise}setOptions(t){if(this.options={...k(this,Ko),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Xp(this.options);n.data!==void 0&&(this.setState(Yp(n.data,n.dataUpdatedAt)),Z(this,vs,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&k(this,pn).remove(this)}setData(t,n){const r=Md(this.state.data,t,this.options);return xe(this,Pn,rr).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){xe(this,Pn,rr).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=k(this,ht))==null?void 0:r.promise;return(s=k(this,ht))==null||s.cancel(t),n?n.then(Ot).catch(Ot):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(k(this,vs))}isActive(){return this.observers.some(t=>mn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===sh||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Gr(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Xv(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,ht))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,ht))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),k(this,pn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(k(this,ht)&&(k(this,ws)?k(this,ht).cancel({revert:!0}):k(this,ht).cancelRetry()),this.scheduleGc()),k(this,pn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||xe(this,Pn,rr).call(this,{type:"invalidate"})}async fetch(t,n){var c,d,f,p,h,w,x,b,C,y,m,v;if(this.state.fetchStatus!=="idle"&&((c=k(this,ht))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(k(this,ht))return k(this,ht).continueRetry(),k(this,ht).promise}if(t&&this.setOptions(t),!this.options.queryFn){const g=this.observers.find(S=>S.options.queryFn);g&&this.setOptions(g.options)}const r=new AbortController,s=g=>{Object.defineProperty(g,"signal",{enumerable:!0,get:()=>(Z(this,ws,!0),r.signal)})},i=()=>{const g=Zv(this.options,n),E=(()=>{const T={client:k(this,xs),queryKey:this.queryKey,meta:this.meta};return s(T),T})();return Z(this,ws,!1),this.options.persister?this.options.persister(g,E,this):g(E)},l=(()=>{const g={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:k(this,xs),state:this.state,fetchFn:i};return s(g),g})();(d=this.options.behavior)==null||d.onFetch(l,this),Z(this,xi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&xe(this,Pn,rr).call(this,{type:"fetch",meta:(p=l.fetchOptions)==null?void 0:p.meta}),Z(this,ht,nx({initialPromise:n==null?void 0:n.initialPromise,fn:l.fetchFn,onCancel:g=>{g instanceof Pd&&g.revert&&this.setState({...k(this,xi),fetchStatus:"idle"}),r.abort()},onFail:(g,S)=>{xe(this,Pn,rr).call(this,{type:"failed",failureCount:g,error:S})},onPause:()=>{xe(this,Pn,rr).call(this,{type:"pause"})},onContinue:()=>{xe(this,Pn,rr).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const g=await k(this,ht).start();if(g===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(g),(w=(h=k(this,pn).config).onSuccess)==null||w.call(h,g,this),(b=(x=k(this,pn).config).onSettled)==null||b.call(x,g,this.state.error,this),g}catch(g){if(g instanceof Pd){if(g.silent)return k(this,ht).promise;if(g.revert){if(this.state.data===void 0)throw g;return this.state.data}}throw xe(this,Pn,rr).call(this,{type:"error",error:g}),(y=(C=k(this,pn).config).onError)==null||y.call(C,g,this),(v=(m=k(this,pn).config).onSettled)==null||v.call(m,this.state.data,g,this),g}finally{this.scheduleGc()}}},vs=new WeakMap,xi=new WeakMap,pn=new WeakMap,xs=new WeakMap,ht=new WeakMap,Ko=new WeakMap,ws=new WeakMap,Pn=new WeakSet,rr=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...sx(r.data,this.options),fetchMeta:t.meta??null};case"success":const s={...r,...Yp(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Z(this,xi,t.manual?s:void 0),s;case"error":const i=t.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),ut.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),k(this,pn).notify({query:this,type:"updated",action:t})})},Tg);function sx(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:tx(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Yp(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Xp(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var qt,je,qo,_t,bs,wi,or,Lr,Go,bi,Si,Ss,Cs,_r,Ci,_e,fo,Td,Id,Ld,_d,Ad,Fd,Od,ix,Ig,Fb=(Ig=class extends zi{constructor(t,n){super();ue(this,_e);ue(this,qt);ue(this,je);ue(this,qo);ue(this,_t);ue(this,bs);ue(this,wi);ue(this,or);ue(this,Lr);ue(this,Go);ue(this,bi);ue(this,Si);ue(this,Ss);ue(this,Cs);ue(this,_r);ue(this,Ci,new Set);this.options=n,Z(this,qt,t),Z(this,Lr,null),Z(this,or,Rd()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(k(this,je).addObserver(this),Jp(k(this,je),this.options)?xe(this,_e,fo).call(this):this.updateResult(),xe(this,_e,_d).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Dd(k(this,je),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Dd(k(this,je),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,xe(this,_e,Ad).call(this),xe(this,_e,Fd).call(this),k(this,je).removeObserver(this)}setOptions(t){const n=this.options,r=k(this,je);if(this.options=k(this,qt).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof mn(this.options.enabled,k(this,je))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");xe(this,_e,Od).call(this),k(this,je).setOptions(this.options),n._defaulted&&!Da(this.options,n)&&k(this,qt).getQueryCache().notify({type:"observerOptionsUpdated",query:k(this,je),observer:this});const s=this.hasListeners();s&&Zp(k(this,je),r,this.options,n)&&xe(this,_e,fo).call(this),this.updateResult(),s&&(k(this,je)!==r||mn(this.options.enabled,k(this,je))!==mn(n.enabled,k(this,je))||Gr(this.options.staleTime,k(this,je))!==Gr(n.staleTime,k(this,je)))&&xe(this,_e,Td).call(this);const i=xe(this,_e,Id).call(this);s&&(k(this,je)!==r||mn(this.options.enabled,k(this,je))!==mn(n.enabled,k(this,je))||i!==k(this,_r))&&xe(this,_e,Ld).call(this,i)}getOptimisticResult(t){const n=k(this,qt).getQueryCache().build(k(this,qt),t),r=this.createResult(n,t);return Db(this,r)&&(Z(this,_t,r),Z(this,wi,this.options),Z(this,bs,k(this,je).state)),r}getCurrentResult(){return k(this,_t)}trackResult(t,n){return new Proxy(t,{get:(r,s)=>(this.trackProp(s),n==null||n(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&k(this,or).status==="pending"&&k(this,or).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(t){k(this,Ci).add(t)}getCurrentQuery(){return k(this,je)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=k(this,qt).defaultQueryOptions(t),r=k(this,qt).getQueryCache().build(k(this,qt),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return xe(this,_e,fo).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),k(this,_t)))}createResult(t,n){var I;const r=k(this,je),s=this.options,i=k(this,_t),o=k(this,bs),l=k(this,wi),d=t!==r?t.state:k(this,qo),{state:f}=t;let p={...f},h=!1,w;if(n._optimisticResults){const M=this.hasListeners(),B=!M&&Jp(t,n),F=M&&Zp(t,r,n,s);(B||F)&&(p={...p,...sx(f.data,t.options)}),n._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:x,errorUpdatedAt:b,status:C}=p;w=p.data;let y=!1;if(n.placeholderData!==void 0&&w===void 0&&C==="pending"){let M;i!=null&&i.isPlaceholderData&&n.placeholderData===(l==null?void 0:l.placeholderData)?(M=i.data,y=!0):M=typeof n.placeholderData=="function"?n.placeholderData((I=k(this,Si))==null?void 0:I.state.data,k(this,Si)):n.placeholderData,M!==void 0&&(C="success",w=Md(i==null?void 0:i.data,M,n),h=!0)}if(n.select&&w!==void 0&&!y)if(i&&w===(o==null?void 0:o.data)&&n.select===k(this,Go))w=k(this,bi);else try{Z(this,Go,n.select),w=n.select(w),w=Md(i==null?void 0:i.data,w,n),Z(this,bi,w),Z(this,Lr,null)}catch(M){Z(this,Lr,M)}k(this,Lr)&&(x=k(this,Lr),w=k(this,bi),b=Date.now(),C="error");const m=p.fetchStatus==="fetching",v=C==="pending",g=C==="error",S=v&&m,E=w!==void 0,j={status:C,fetchStatus:p.fetchStatus,isPending:v,isSuccess:C==="success",isError:g,isInitialLoading:S,isLoading:S,data:w,dataUpdatedAt:p.dataUpdatedAt,error:x,errorUpdatedAt:b,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:m,isRefetching:m&&!v,isLoadingError:g&&!E,isPaused:p.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:g&&E,isStale:oh(t,n),refetch:this.refetch,promise:k(this,or),isEnabled:mn(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const M=Q=>{j.status==="error"?Q.reject(j.error):j.data!==void 0&&Q.resolve(j.data)},B=()=>{const Q=Z(this,or,j.promise=Rd());M(Q)},F=k(this,or);switch(F.status){case"pending":t.queryHash===r.queryHash&&M(F);break;case"fulfilled":(j.status==="error"||j.data!==F.value)&&B();break;case"rejected":(j.status!=="error"||j.error!==F.reason)&&B();break}}return j}updateResult(){const t=k(this,_t),n=this.createResult(k(this,je),this.options);if(Z(this,bs,k(this,je).state),Z(this,wi,this.options),k(this,bs).data!==void 0&&Z(this,Si,k(this,je)),Da(n,t))return;Z(this,_t,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!k(this,Ci).size)return!0;const o=new Set(i??k(this,Ci));return this.options.throwOnError&&o.add("error"),Object.keys(k(this,_t)).some(l=>{const c=l;return k(this,_t)[c]!==t[c]&&o.has(c)})};xe(this,_e,ix).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&xe(this,_e,_d).call(this)}},qt=new WeakMap,je=new WeakMap,qo=new WeakMap,_t=new WeakMap,bs=new WeakMap,wi=new WeakMap,or=new WeakMap,Lr=new WeakMap,Go=new WeakMap,bi=new WeakMap,Si=new WeakMap,Ss=new WeakMap,Cs=new WeakMap,_r=new WeakMap,Ci=new WeakMap,_e=new WeakSet,fo=function(t){xe(this,_e,Od).call(this);let n=k(this,je).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Ot)),n},Td=function(){xe(this,_e,Ad).call(this);const t=Gr(this.options.staleTime,k(this,je));if(Is||k(this,_t).isStale||!Nd(t))return;const r=Xv(k(this,_t).dataUpdatedAt,t)+1;Z(this,Ss,ds.setTimeout(()=>{k(this,_t).isStale||this.updateResult()},r))},Id=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(k(this,je)):this.options.refetchInterval)??!1},Ld=function(t){xe(this,_e,Fd).call(this),Z(this,_r,t),!(Is||mn(this.options.enabled,k(this,je))===!1||!Nd(k(this,_r))||k(this,_r)===0)&&Z(this,Cs,ds.setInterval(()=>{(this.options.refetchIntervalInBackground||ih.isFocused())&&xe(this,_e,fo).call(this)},k(this,_r)))},_d=function(){xe(this,_e,Td).call(this),xe(this,_e,Ld).call(this,xe(this,_e,Id).call(this))},Ad=function(){k(this,Ss)&&(ds.clearTimeout(k(this,Ss)),Z(this,Ss,void 0))},Fd=function(){k(this,Cs)&&(ds.clearInterval(k(this,Cs)),Z(this,Cs,void 0))},Od=function(){const t=k(this,qt).getQueryCache().build(k(this,qt),this.options);if(t===k(this,je))return;const n=k(this,je);Z(this,je,t),Z(this,qo,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},ix=function(t){ut.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(k(this,_t))}),k(this,qt).getQueryCache().notify({query:k(this,je),type:"observerResultsUpdated"})})},Ig);function Ob(e,t){return mn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Jp(e,t){return Ob(e,t)||e.state.data!==void 0&&Dd(e,t,t.refetchOnMount)}function Dd(e,t,n){if(mn(t.enabled,e)!==!1&&Gr(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&oh(e,t)}return!1}function Zp(e,t,n,r){return(e!==t||mn(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&oh(e,n)}function oh(e,t){return mn(t.enabled,e)!==!1&&e.isStaleByTime(Gr(t.staleTime,e))}function Db(e,t){return!Da(e.getCurrentResult(),t)}function em(e){return{onFetch:(t,n)=>{var f,p,h,w,x;const r=t.options,s=(h=(p=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:p.fetchMore)==null?void 0:h.direction,i=((w=t.state.data)==null?void 0:w.pages)||[],o=((x=t.state.data)==null?void 0:x.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let b=!1;const C=v=>{Rb(v,()=>t.signal,()=>b=!0)},y=Zv(t.options,t.fetchOptions),m=async(v,g,S)=>{if(b)return Promise.reject();if(g==null&&v.pages.length)return Promise.resolve(v);const T=(()=>{const B={client:t.client,queryKey:t.queryKey,pageParam:g,direction:S?"backward":"forward",meta:t.options.meta};return C(B),B})(),j=await y(T),{maxPages:I}=t.options,M=S?Mb:jb;return{pages:M(v.pages,j,I),pageParams:M(v.pageParams,g,I)}};if(s&&i.length){const v=s==="backward",g=v?zb:tm,S={pages:i,pageParams:o},E=g(r,S);l=await m(S,E,v)}else{const v=e??i.length;do{const g=c===0?o[0]??r.initialPageParam:tm(r,l);if(c>0&&g==null)break;l=await m(l,g),c++}while(c<v)}return l};t.options.persister?t.fetchFn=()=>{var b,C;return(C=(b=t.options).persister)==null?void 0:C.call(b,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=d}}}function tm(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function zb(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var Yo,Qn,At,ks,Kn,Er,Lg,$b=(Lg=class extends rx{constructor(t){super();ue(this,Kn);ue(this,Yo);ue(this,Qn);ue(this,At);ue(this,ks);Z(this,Yo,t.client),this.mutationId=t.mutationId,Z(this,At,t.mutationCache),Z(this,Qn,[]),this.state=t.state||ox(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){k(this,Qn).includes(t)||(k(this,Qn).push(t),this.clearGcTimeout(),k(this,At).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Z(this,Qn,k(this,Qn).filter(n=>n!==t)),this.scheduleGc(),k(this,At).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){k(this,Qn).length||(this.state.status==="pending"?this.scheduleGc():k(this,At).remove(this))}continue(){var t;return((t=k(this,ks))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,c,d,f,p,h,w,x,b,C,y,m,v,g,S,E,T,j,I;const n=()=>{xe(this,Kn,Er).call(this,{type:"continue"})},r={client:k(this,Yo),meta:this.options.meta,mutationKey:this.options.mutationKey};Z(this,ks,nx({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(M,B)=>{xe(this,Kn,Er).call(this,{type:"failed",failureCount:M,error:B})},onPause:()=>{xe(this,Kn,Er).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>k(this,At).canRun(this)}));const s=this.state.status==="pending",i=!k(this,ks).canStart();try{if(s)n();else{xe(this,Kn,Er).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(o=k(this,At).config).onMutate)==null?void 0:l.call(o,t,this,r));const B=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t,r));B!==this.state.context&&xe(this,Kn,Er).call(this,{type:"pending",context:B,variables:t,isPaused:i})}const M=await k(this,ks).start();return await((p=(f=k(this,At).config).onSuccess)==null?void 0:p.call(f,M,t,this.state.context,this,r)),await((w=(h=this.options).onSuccess)==null?void 0:w.call(h,M,t,this.state.context,r)),await((b=(x=k(this,At).config).onSettled)==null?void 0:b.call(x,M,null,this.state.variables,this.state.context,this,r)),await((y=(C=this.options).onSettled)==null?void 0:y.call(C,M,null,t,this.state.context,r)),xe(this,Kn,Er).call(this,{type:"success",data:M}),M}catch(M){try{await((v=(m=k(this,At).config).onError)==null?void 0:v.call(m,M,t,this.state.context,this,r))}catch(B){Promise.reject(B)}try{await((S=(g=this.options).onError)==null?void 0:S.call(g,M,t,this.state.context,r))}catch(B){Promise.reject(B)}try{await((T=(E=k(this,At).config).onSettled)==null?void 0:T.call(E,void 0,M,this.state.variables,this.state.context,this,r))}catch(B){Promise.reject(B)}try{await((I=(j=this.options).onSettled)==null?void 0:I.call(j,void 0,M,t,this.state.context,r))}catch(B){Promise.reject(B)}throw xe(this,Kn,Er).call(this,{type:"error",error:M}),M}finally{k(this,At).runNext(this)}}},Yo=new WeakMap,Qn=new WeakMap,At=new WeakMap,ks=new WeakMap,Kn=new WeakSet,Er=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),ut.batch(()=>{k(this,Qn).forEach(r=>{r.onMutationUpdate(t)}),k(this,At).notify({mutation:this,type:"updated",action:t})})},Lg);function ox(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var lr,Tn,Xo,_g,Bb=(_g=class extends zi{constructor(t={}){super();ue(this,lr);ue(this,Tn);ue(this,Xo);this.config=t,Z(this,lr,new Set),Z(this,Tn,new Map),Z(this,Xo,0)}build(t,n,r){const s=new $b({client:t,mutationCache:this,mutationId:++gl(this,Xo)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){k(this,lr).add(t);const n=_l(t);if(typeof n=="string"){const r=k(this,Tn).get(n);r?r.push(t):k(this,Tn).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(k(this,lr).delete(t)){const n=_l(t);if(typeof n=="string"){const r=k(this,Tn).get(n);if(r)if(r.length>1){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}else r[0]===t&&k(this,Tn).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=_l(t);if(typeof n=="string"){const r=k(this,Tn).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var r;const n=_l(t);if(typeof n=="string"){const s=(r=k(this,Tn).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){ut.batch(()=>{k(this,lr).forEach(t=>{this.notify({type:"removed",mutation:t})}),k(this,lr).clear(),k(this,Tn).clear()})}getAll(){return Array.from(k(this,lr))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Kp(n,r))}findAll(t={}){return this.getAll().filter(n=>Kp(t,n))}notify(t){ut.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return ut.batch(()=>Promise.all(t.map(n=>n.continue().catch(Ot))))}},lr=new WeakMap,Tn=new WeakMap,Xo=new WeakMap,_g);function _l(e){var t;return(t=e.options.scope)==null?void 0:t.id}var ar,Ar,Gt,ur,pr,oa,zd,Ag,Ub=(Ag=class extends zi{constructor(n,r){super();ue(this,pr);ue(this,ar);ue(this,Ar);ue(this,Gt);ue(this,ur);Z(this,ar,n),this.setOptions(r),this.bindMethods(),xe(this,pr,oa).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var s;const r=this.options;this.options=k(this,ar).defaultMutationOptions(n),Da(this.options,r)||k(this,ar).getMutationCache().notify({type:"observerOptionsUpdated",mutation:k(this,Gt),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Ls(r.mutationKey)!==Ls(this.options.mutationKey)?this.reset():((s=k(this,Gt))==null?void 0:s.state.status)==="pending"&&k(this,Gt).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=k(this,Gt))==null||n.removeObserver(this)}onMutationUpdate(n){xe(this,pr,oa).call(this),xe(this,pr,zd).call(this,n)}getCurrentResult(){return k(this,Ar)}reset(){var n;(n=k(this,Gt))==null||n.removeObserver(this),Z(this,Gt,void 0),xe(this,pr,oa).call(this),xe(this,pr,zd).call(this)}mutate(n,r){var s;return Z(this,ur,r),(s=k(this,Gt))==null||s.removeObserver(this),Z(this,Gt,k(this,ar).getMutationCache().build(k(this,ar),this.options)),k(this,Gt).addObserver(this),k(this,Gt).execute(n)}},ar=new WeakMap,Ar=new WeakMap,Gt=new WeakMap,ur=new WeakMap,pr=new WeakSet,oa=function(){var r;const n=((r=k(this,Gt))==null?void 0:r.state)??ox();Z(this,Ar,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},zd=function(n){ut.batch(()=>{var r,s,i,o,l,c,d,f;if(k(this,ur)&&this.hasListeners()){const p=k(this,Ar).variables,h=k(this,Ar).context,w={client:k(this,ar),meta:this.options.meta,mutationKey:this.options.mutationKey};if((n==null?void 0:n.type)==="success"){try{(s=(r=k(this,ur)).onSuccess)==null||s.call(r,n.data,p,h,w)}catch(x){Promise.reject(x)}try{(o=(i=k(this,ur)).onSettled)==null||o.call(i,n.data,null,p,h,w)}catch(x){Promise.reject(x)}}else if((n==null?void 0:n.type)==="error"){try{(c=(l=k(this,ur)).onError)==null||c.call(l,n.error,p,h,w)}catch(x){Promise.reject(x)}try{(f=(d=k(this,ur)).onSettled)==null||f.call(d,void 0,n.error,p,h,w)}catch(x){Promise.reject(x)}}}this.listeners.forEach(p=>{p(k(this,Ar))})})},Ag),qn,Fg,Vb=(Fg=class extends zi{constructor(t={}){super();ue(this,qn);this.config=t,Z(this,qn,new Map)}build(t,n,r){const s=n.queryKey,i=n.queryHash??rh(s,n);let o=this.get(i);return o||(o=new Ab({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){k(this,qn).has(t.queryHash)||(k(this,qn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=k(this,qn).get(t.queryHash);n&&(t.destroy(),n===t&&k(this,qn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ut.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return k(this,qn).get(t)}getAll(){return[...k(this,qn).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Qp(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>Qp(t,r)):n}notify(t){ut.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){ut.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ut.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},qn=new WeakMap,Fg),Je,Fr,Or,ki,Ei,Dr,Ni,ji,Og,Wb=(Og=class{constructor(e={}){ue(this,Je);ue(this,Fr);ue(this,Or);ue(this,ki);ue(this,Ei);ue(this,Dr);ue(this,Ni);ue(this,ji);Z(this,Je,e.queryCache||new Vb),Z(this,Fr,e.mutationCache||new Bb),Z(this,Or,e.defaultOptions||{}),Z(this,ki,new Map),Z(this,Ei,new Map),Z(this,Dr,0)}mount(){gl(this,Dr)._++,k(this,Dr)===1&&(Z(this,Ni,ih.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,Je).onFocus())})),Z(this,ji,za.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,Je).onOnline())})))}unmount(){var e,t;gl(this,Dr)._--,k(this,Dr)===0&&((e=k(this,Ni))==null||e.call(this),Z(this,Ni,void 0),(t=k(this,ji))==null||t.call(this),Z(this,ji,void 0))}isFetching(e){return k(this,Je).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return k(this,Fr).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,Je).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=k(this,Je).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Gr(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return k(this,Je).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=k(this,Je).get(r.queryHash),i=s==null?void 0:s.state.data,o=kb(t,i);if(o!==void 0)return k(this,Je).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return ut.batch(()=>k(this,Je).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,Je).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=k(this,Je);ut.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=k(this,Je);return ut.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=ut.batch(()=>k(this,Je).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(Ot).catch(Ot)}invalidateQueries(e,t={}){return ut.batch(()=>(k(this,Je).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=ut.batch(()=>k(this,Je).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(Ot)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Ot)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=k(this,Je).build(this,t);return n.isStaleByTime(Gr(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ot).catch(Ot)}fetchInfiniteQuery(e){return e.behavior=em(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ot).catch(Ot)}ensureInfiniteQueryData(e){return e.behavior=em(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return za.isOnline()?k(this,Fr).resumePausedMutations():Promise.resolve()}getQueryCache(){return k(this,Je)}getMutationCache(){return k(this,Fr)}getDefaultOptions(){return k(this,Or)}setDefaultOptions(e){Z(this,Or,e)}setQueryDefaults(e,t){k(this,ki).set(Ls(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...k(this,ki).values()],n={};return t.forEach(r=>{Vo(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){k(this,Ei).set(Ls(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...k(this,Ei).values()],n={};return t.forEach(r=>{Vo(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...k(this,Or).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=rh(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===sh&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...k(this,Or).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){k(this,Je).clear(),k(this,Fr).clear()}},Je=new WeakMap,Fr=new WeakMap,Or=new WeakMap,ki=new WeakMap,Ei=new WeakMap,Dr=new WeakMap,Ni=new WeakMap,ji=new WeakMap,Og),lx=u.createContext(void 0),wr=e=>{const t=u.useContext(lx);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Hb=({client:e,children:t})=>(u.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(lx.Provider,{value:e,children:t})),ax=u.createContext(!1),Qb=()=>u.useContext(ax);ax.Provider;function Kb(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var qb=u.createContext(Kb()),Gb=()=>u.useContext(qb),Yb=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Xb=e=>{u.useEffect(()=>{e.clearReset()},[e])},Jb=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||ex(n,[e.error,r])),Zb=e=>{if(e.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},eS=(e,t)=>e.isLoading&&e.isFetching&&!t,tS=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,nm=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function nS(e,t,n){var p,h,w,x,b;const r=Qb(),s=Gb(),i=wr(),o=i.defaultQueryOptions(e);(h=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||h.call(p,o),o._optimisticResults=r?"isRestoring":"optimistic",Zb(o),Yb(o,s),Xb(s);const l=!i.getQueryCache().get(o.queryHash),[c]=u.useState(()=>new t(i,o)),d=c.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(u.useSyncExternalStore(u.useCallback(C=>{const y=f?c.subscribe(ut.batchCalls(C)):Ot;return c.updateResult(),y},[c,f]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),u.useEffect(()=>{c.setOptions(o)},[o,c]),tS(o,d))throw nm(o,c,s);if(Jb({result:d,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((x=(w=i.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||x.call(w,o,d),o.experimental_prefetchInRender&&!Is&&eS(d,r)){const C=l?nm(o,c,s):(b=i.getQueryCache().get(o.queryHash))==null?void 0:b.promise;C==null||C.catch(Ot).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?d:c.trackResult(d)}function pu(e,t){return nS(e,Fb)}function rS(e,t){const n=wr(),[r]=u.useState(()=>new Ub(n,e));u.useEffect(()=>{r.setOptions(e)},[r,e]);const s=u.useSyncExternalStore(u.useCallback(o=>r.subscribe(ut.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=u.useCallback((o,l)=>{r.mutate(o,l).catch(Ot)},[r]);if(s.error&&ex(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}const ux=8,sS=6;function rm(e,t,n){return n<t?t:Math.min(n,Math.max(t,e))}function cx({x:e,y:t,menuWidth:n,menuHeight:r,viewport:s,margin:i=ux}){const o=i,l=i,c=s.width-Math.max(0,n)-i,d=s.height-Math.max(0,r)-i;return{x:rm(e,o,c),y:rm(t,l,d)}}function iS({anchorRect:e,menuSize:t,viewport:n,align:r="left",margin:s=ux,sideOffset:i=sS}){const o=r==="right"?e.right-t.width:e.left,l=e.bottom+i,c=e.top-t.height-i,d=l+t.height+s<=n.height,f=c>=s;return cx({x:o,y:!d&&f?c:l,menuWidth:t.width,menuHeight:t.height,viewport:n,margin:s})}function dx(){return typeof window>"u"?{width:1024,height:768}:{width:window.innerWidth,height:window.innerHeight}}function sm(e){return e.length>0&&"options"in e[0]}function im(){return{x:0,y:0,ready:!1}}function lh({value:e,onChange:t,options:n,placeholder:r="Select...",trigger:s,triggerClassName:i="",panelClassName:o="",align:l="left",width:c="auto",showChevron:d=!0,title:f,disabled:p=!1,"aria-label":h}){var Q,ee;const[w,x]=u.useState(!1),b=u.useRef(null),C=u.useRef(null),y=u.useRef(null),[m,v]=u.useState(im),S=u.useCallback(()=>{const z=L=>{const R=L.find(P=>P.value===e);return R?R.label:null};if(sm(n))for(const L of n){const R=z(L.options);if(R)return R}else{const L=z(n);if(L)return L}return r},[e,n,r])(),E=((Q=b.current)==null?void 0:Q.getBoundingClientRect().width)??((ee=C.current)==null?void 0:ee.offsetWidth)??0,T=c==="trigger"?E:c==="auto"?void 0:c,j=u.useCallback(()=>{if(!w)return;const z=b.current,L=y.current;if(!z||!L)return;const R=z.getBoundingClientRect(),P=L.getBoundingClientRect(),A=T??P.width??180,O=P.height||L.scrollHeight||1,K=iS({anchorRect:R,menuSize:{width:A,height:O},viewport:dx(),align:l});v(U=>U.x===K.x&&U.y===K.y&&U.ready?U:{x:K.x,y:K.y,ready:!0})},[l,T,w]);u.useLayoutEffect(()=>{if(!w){v(im());return}j()},[w,j,n,e]),u.useEffect(()=>{if(!w)return;const z=P=>{var O,K;const A=P.target;(O=b.current)!=null&&O.contains(A)||(K=y.current)!=null&&K.contains(A)||x(!1)},L=P=>{var A;P.key==="Escape"&&(x(!1),(A=C.current)==null||A.focus())},R=()=>j();return window.addEventListener("click",z),window.addEventListener("keydown",L),window.addEventListener("resize",R),window.addEventListener("scroll",R,!0),()=>{window.removeEventListener("click",z),window.removeEventListener("keydown",L),window.removeEventListener("resize",R),window.removeEventListener("scroll",R,!0)}},[w,j]);const I=z=>{var L;t(z),x(!1),(L=C.current)==null||L.focus()},M=z=>z.map(L=>a.jsxs("button",{className:"dropdown-item","data-active":L.value===e,disabled:L.disabled,onClick:()=>!L.disabled&&I(L.value),role:"menuitem",children:[L.icon&&a.jsx("span",{className:"shrink-0",children:L.icon}),a.jsx("span",{className:"flex-1 truncate",children:L.label}),L.value===e&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0 text-accent",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})]},L.value)),B=u.useMemo(()=>({position:"fixed",left:m.x,top:m.y,visibility:m.ready?"visible":"hidden",...T?{width:T,minWidth:T}:{}}),[T,m]),F=w?a.jsx("div",{ref:y,className:`dropdown-panel ${o}`,style:B,role:"listbox","aria-label":h,children:sm(n)?n.map((z,L)=>a.jsxs("div",{children:[z.label&&a.jsx("div",{className:"dropdown-label",children:z.label}),M(z.options),L<n.length-1&&a.jsx("div",{className:"dropdown-divider"})]},z.label||L)):M(n)}):null;return a.jsxs("div",{ref:b,className:"relative",children:[s?a.jsx("div",{onClick:()=>!p&&x(z=>!z),children:s}):a.jsxs("button",{ref:C,type:"button",className:`dropdown-trigger ${i}`,onClick:()=>x(z=>!z),disabled:p,title:f,"aria-label":h,"aria-haspopup":"listbox","aria-expanded":w,children:[a.jsx("span",{className:"truncate",children:S}),d&&a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`shrink-0 opacity-60 transition-transform ${w?"rotate-180":""}`,children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),F&&typeof document<"u"?hu.createPortal(F,document.body):F]})}const oS={offline:"sync-dot-offline",unstable:"sync-dot-unstable",recent:"sync-dot-recent",editing:"sync-dot-editing",live:"sync-dot-live"};function lS({state:e,presence:t,syncLabel:n,connectionLabel:r,lastEditedLabel:s,hasEdits:i,localTypingActive:o,recentTouches:l,isNarrow:c}){const[d,f]=u.useState(!1),[p,h]=u.useState(null),w=u.useRef(null),x=u.useRef(null),b=u.useRef(null),C=t?`${t.viewing} viewing  ${t.editing} editing`:"- viewing  - editing",y=t?String(t.viewing):"-",m=u.useCallback(()=>{b.current&&(window.clearTimeout(b.current),b.current=null)},[]),v=u.useCallback((S,E)=>{var T;E&&((T=navigator.clipboard)==null||T.writeText(E).then(()=>{h(S),m(),b.current=window.setTimeout(()=>{h(j=>j===S?null:j)},1e3)}).catch(()=>{}))},[m]),g=u.useCallback(()=>{f(!1),window.requestAnimationFrame(()=>{var S;return(S=x.current)==null?void 0:S.focus()})},[]);return u.useEffect(()=>{if(!d)return;const S=T=>{!w.current||w.current.contains(T.target)||g()},E=T=>{T.key==="Escape"&&g()};return window.addEventListener("mousedown",S),window.addEventListener("keydown",E),()=>{window.removeEventListener("mousedown",S),window.removeEventListener("keydown",E)}},[d,g]),u.useEffect(()=>()=>{m()},[m]),a.jsxs("div",{ref:w,className:"sync-indicator",children:[a.jsxs("button",{ref:x,type:"button",className:"sync-indicator-button",onClick:()=>d?g():f(!0),"aria-haspopup":"dialog","aria-expanded":d,"aria-label":"Sync status",title:C,children:[a.jsx("span",{className:`sync-indicator-dot ${oS[e]}`,"aria-hidden":"true"}),!c&&a.jsx("span",{className:"sync-indicator-count tabular-nums",children:y}),!c&&o&&a.jsx("span",{className:"sync-indicator-local",children:"typing"})]}),d&&a.jsxs("div",{role:"dialog","aria-label":"Sync status",className:"sync-indicator-card select-text",children:[a.jsx("div",{className:"sync-indicator-line sync-indicator-primary",children:n}),a.jsx("div",{className:"sync-indicator-line",children:r}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:C}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:i?`Last edited: ${s}`:"No edits yet."}),o&&a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:"Local typing in progress (saved on blur)."}),a.jsxs("div",{className:"sync-indicator-section",children:[a.jsx("div",{className:"sync-indicator-section-title",children:"Recently touched files"}),l.length>0?a.jsx("div",{className:"sync-indicator-list",children:l.map(S=>a.jsxs("div",{className:"sync-indicator-item",children:[a.jsx("button",{type:"button",className:"sync-indicator-item-name",title:`Copy filename: ${S.label}`,onClick:()=>v(S.path,S.label),children:S.label}),a.jsx("span",{className:"sync-indicator-item-time tabular-nums",children:p===S.path?"Copied":S.timeLabel})]},S.path))}):a.jsx("div",{className:"sync-indicator-empty",children:"No recent touches."})]})]})]})}const Yr={phoneMax:480,mobileMax:767,narrowMax:900,tabletMax:1024,mediumMax:1180},la={phone:`(max-width: ${Yr.phoneMax}px)`,narrow:`(max-width: ${Yr.narrowMax}px)`,toolbarCompact:`(max-width: ${Yr.mediumMax}px)`},om=200,lm=240,aS=320,uS=360,cS=420;function am(e,t,n){return Math.min(Math.max(e,t),n)}function dS(e){return e<=Yr.tabletMax?aS:e<=Yr.mediumMax?uS:cS}function fS(e){return e<=Yr.tabletMax?360:e<=Yr.mediumMax?420:520}function hS({viewportWidth:e,leftOpen:t,rightOpen:n,leftWidth:r,rightWidth:s}){const i=dS(e);let o=t?am(r,om,i):0,l=n?am(s,lm,i):0;const c=Math.max(0,e-fS(e));if(o+l>c){let d=o+l-c;if(l>0){const f=Math.max(0,l-lm),p=Math.min(f,d);l-=p,d-=p}if(d>0&&o>0){const f=Math.max(0,o-om),p=Math.min(f,d);o-=p,d-=p}d>0&&l>0&&(l=Math.max(0,c-o)),o+l>c&&(o=Math.max(0,c-l))}return{leftWidth:Number(o.toFixed(2)),rightWidth:Number(l.toFixed(2))}}function aa(e,t=!1){const[n,r]=u.useState(t);return u.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;const s=window.matchMedia(e),i=s,o=()=>r(s.matches);if(o(),typeof s.addEventListener=="function")return s.addEventListener("change",o),()=>s.removeEventListener("change",o);if(typeof i.addListener=="function"&&typeof i.removeListener=="function")return i.addListener(o),()=>{var l;return(l=i.removeListener)==null?void 0:l.call(i,o)}},[e]),n}function fx({isRandom:e,dir:t}){return e?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),a.jsx("path",{d:"M21 3v5h-5"})]}):t==="desc"?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 5v14"}),a.jsx("path",{d:"M19 12l-7 7-7-7"})]}):a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 19V5"}),a.jsx("path",{d:"M5 12l7-7 7 7"})]})}function pS({viewerActive:e,filtersOpen:t,filtersRef:n,totalFilterCount:r,filterCount:s,starFilterList:i,starCounts:o,onToggleFilters:l,onOpenFilters:c,onToggleStar:d,onClearFilters:f,onClearStars:p}){return a.jsxs("div",{ref:n,className:`toolbar-filter relative ${e?"opacity-40 pointer-events-none":""}`,children:[a.jsxs("button",{className:`btn ${r>0?"btn-active":""}`,onClick:l,"aria-haspopup":"dialog","aria-expanded":t,title:"Filters","aria-disabled":e,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),a.jsx("span",{className:"toolbar-filters-label",children:"Filters"}),r>0&&a.jsx("span",{className:"toolbar-filters-count px-1.5 py-0.5 text-[11px] rounded-full bg-accent-strong text-text",children:r})]}),t&&a.jsxs("div",{role:"dialog","aria-label":"Filters",className:"dropdown-panel w-[240px]",style:{top:"38px",left:0},children:[a.jsx("div",{className:"dropdown-label",children:"Rating"}),a.jsxs("div",{className:"px-1",children:[[5,4,3,2,1].map(h=>{const w=i.includes(h),x=(o==null?void 0:o[String(h)])??0;return a.jsxs("button",{onClick:()=>d==null?void 0:d(h),className:`dropdown-item justify-between ${w?"bg-accent-muted":""}`,children:[a.jsxs("span",{className:w?"text-star-active":"text-text",children:["".repeat(h),"".repeat(5-h)]}),a.jsx("span",{className:"text-xs text-muted",children:x})]},h)}),a.jsxs("button",{onClick:()=>d==null?void 0:d(0),className:`dropdown-item justify-between ${i.includes(0)?"bg-accent-muted":""}`,children:[a.jsx("span",{className:"text-text",children:"Unrated"}),a.jsx("span",{className:"text-xs text-muted",children:(o==null?void 0:o["0"])??0})]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("div",{className:"dropdown-label",children:"Metrics"}),a.jsxs("button",{className:"dropdown-item",onClick:()=>{l(),c==null||c()},children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]}),a.jsx("span",{children:"Open Metrics Panel"}),(s||0)>0&&a.jsxs("span",{className:"ml-auto text-xs text-muted",children:[s," active"]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("button",{className:"dropdown-item text-muted hover:text-text",onClick:()=>{f?f():p==null||p()},disabled:r===0,children:"Clear all filters"})]})]})}function mS({viewMode:e,currentSort:t,sortOnlyOptions:n,sortDisabled:r,sortControlsDisabled:s,sortDir:i,isRandom:o,showSelectModeToggle:l,multiSelectMode:c,selectModeLabel:d,uploadBusy:f,uploadDisabled:p,onViewMode:h,onSortChange:w,onToggleSortDir:x,onToggleMultiSelectMode:b,onUploadClick:C}){return a.jsx("div",{className:"mobile-drawer",children:a.jsxs("div",{className:"mobile-drawer-row",children:[a.jsxs("div",{className:"mobile-pill-group",children:[a.jsx("button",{className:`mobile-pill ${e==="grid"?"is-active":""}`,onClick:()=>h==null?void 0:h("grid"),"aria-pressed":e==="grid",children:"Grid"}),a.jsx("button",{className:`mobile-pill ${e==="adaptive"?"is-active":""}`,onClick:()=>h==null?void 0:h("adaptive"),"aria-pressed":e==="adaptive",children:"Masonry"})]}),a.jsx(lh,{value:t,onChange:y=>w==null?void 0:w(y),options:n,"aria-label":"Sort",triggerClassName:"mobile-pill mobile-pill-dropdown",panelClassName:"mobile-drawer-panel",disabled:r}),a.jsx("button",{className:`mobile-pill mobile-pill-icon ${s?"opacity-50 cursor-not-allowed":""}`,onClick:x,title:r?"Sorting disabled":o?"Shuffle":`Sort ${i==="desc"?"descending":"ascending"}`,"aria-label":o?"Shuffle":"Toggle sort direction","aria-disabled":s,disabled:s,children:a.jsx(fx,{isRandom:o,dir:i})}),l&&a.jsx("button",{className:`mobile-pill ${c?"is-active":""}`,onClick:()=>b==null?void 0:b(),"aria-pressed":c,title:c?"Exit select mode":"Enter select mode",children:d}),C&&a.jsx("button",{className:`mobile-pill ${p||f?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!p&&!f&&C(),disabled:p||f,children:f?"Uploading":"Upload"})]})})}function gS({rootRef:e,onSearch:t,viewerActive:n,onBack:r,zoomPercent:s,onZoomPercentChange:i,currentLabel:o,itemCount:l,totalCount:c,sortSpec:d,metricKeys:f,onSortChange:p,sortDisabled:h=!1,filterCount:w,onOpenFilters:x,starFilters:b,onToggleStar:C,onClearStars:y,onClearFilters:m,starCounts:v,viewMode:g,onViewMode:S,gridItemSize:E,onGridItemSize:T,leftOpen:j,rightOpen:I,onToggleLeft:M,onToggleRight:B,onPrevImage:F,onNextImage:Q,canPrevImage:ee,canNextImage:z,searchDisabled:L=!1,searchPlaceholder:R,onUploadClick:P,uploadBusy:A=!1,uploadDisabled:O=!1,multiSelectMode:K=!1,selectedCount:U=0,onToggleMultiSelectMode:_,syncIndicator:G}){const[V,J]=u.useState(!1),[se,Y]=u.useState(!1),q=u.useRef(null),H=u.useRef(null),fe=aa(la.narrow),Te=aa(la.phone),we=aa(la.toolbarCompact);u.useEffect(()=>{if(!V)return;const Ce=rt=>{q.current&&!q.current.contains(rt.target)&&J(!1)};return window.addEventListener("click",Ce),()=>window.removeEventListener("click",Ce)},[V]),u.useEffect(()=>{if(L){Y(!1);return}if(!fe||n){Y(!1);return}if(!se)return;const Ce=window.requestAnimationFrame(()=>{var rt;return(rt=H.current)==null?void 0:rt.focus()});return()=>window.cancelAnimationFrame(Ce)},[fe,se,n,L]);const he=d??{kind:"builtin",key:"added",dir:"desc"},ze=he.dir,Ue=he.kind==="builtin"&&he.key==="random",Tt=n||h,Bt=f!=null&&f.length?f.map(Ce=>({value:`metric:${Ce}`,label:Ce,disabled:h})):[],Ut=[{value:"builtin:added",label:"Date added",disabled:h},{value:"builtin:name",label:"Filename",disabled:h},{value:"builtin:random",label:"Random",disabled:h},...Bt],Dn=[{label:"Layout",options:[{value:"layout:grid",label:"Grid"},{value:"layout:masonry",label:"Masonry"}]},{label:"Sort by",options:Ut}],tn=he.kind==="metric"?`metric:${he.key}`:`builtin:${he.key}`,Cn=[{label:"Sort by",options:Ut}],Vt=fe&&!n,oe=!(!!n&&we),ge=!!n&&!Te,Ie=Vt&&!!_,Se=K?U>0?`Done (${U})`:"Done":"Select",ce=Ce=>{if(Ce.startsWith("layout:")){const rt=Ce==="layout:masonry"?"adaptive":"grid";S==null||S(rt)}else{if(h)return;p==null||p(um(Ce,he))}},Fe=()=>{!p||h||p(Ue?he:{...he,dir:ze==="desc"?"asc":"desc"})},Ge=b??[],et=Ge.length,kn=vS(w,et),gt=yS(l,c),zn=o||"Root";return a.jsxs("div",{ref:e,className:`toolbar-shell ${n?"toolbar-shell-viewer":""} ${Te?"toolbar-shell-phone":""} ${we?"toolbar-shell-compact":""} fixed top-0 left-0 right-0 h-12 grid grid-cols-[minmax(0,1fr)_minmax(0,1fr)_auto] items-center px-3 gap-3 bg-panel border-b border-border z-[var(--z-toolbar)] col-span-full row-start-1 select-none`,children:[a.jsxs("div",{className:"toolbar-left flex items-center gap-4 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope flex items-center gap-3 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope-text flex flex-col min-w-0 leading-tight",children:[a.jsx("span",{className:"toolbar-scope-label text-[10px] uppercase tracking-widest text-muted",children:"Scope"}),a.jsx("span",{className:"text-sm font-medium text-text truncate",title:zn,children:zn})]}),gt&&a.jsx("span",{className:"toolbar-count text-xs text-muted whitespace-nowrap tabular-nums",children:gt})]}),n&&a.jsxs("button",{className:"toolbar-back-btn btn btn-sm",onClick:r,title:"Back to grid",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]}),oe&&a.jsxs("div",{className:"toolbar-sort flex items-center gap-2",children:[a.jsxs("div",{className:`toolbar-sort-controls flex items-center gap-2 ${n?"opacity-40 pointer-events-none":""}`,children:[a.jsx(lh,{value:tn,onChange:ce,options:Dn,title:"Sort and layout options","aria-label":"Sort and layout",triggerClassName:"min-w-[110px]"}),a.jsx("button",{className:"toolbar-sort-dir btn btn-icon",onClick:Fe,title:h?"Sorting disabled":Ue?"Shuffle":`Sort ${ze==="desc"?"descending":"ascending"}`,"aria-label":Ue?"Shuffle":"Toggle sort direction","aria-disabled":Tt,disabled:Tt,children:a.jsx(fx,{isRandom:Ue,dir:ze})})]}),a.jsx(pS,{viewerActive:!!n,filtersOpen:V,filtersRef:q,totalFilterCount:kn,filterCount:w,starFilterList:Ge,starCounts:v,onToggleFilters:()=>J(Ce=>!Ce),onOpenFilters:x,onToggleStar:C,onClearFilters:m,onClearStars:y})]})]}),a.jsx("div",{className:"toolbar-center flex items-center gap-3 justify-center min-w-0",children:n?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"range",min:5,max:800,step:1,value:Math.round(Math.max(5,Math.min(800,s??100))),onChange:Ce=>i==null?void 0:i(Number(Ce.target.value)),className:"zoom-slider","aria-label":"Zoom level"}),a.jsxs("span",{className:"text-xs text-muted min-w-[42px] text-right",children:[Math.round(s??100),"%"]})]}):T&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-muted",children:"Size"}),a.jsx("input",{type:"range",min:80,max:500,step:10,value:E??220,onChange:Ce=>T(Number(Ce.target.value)),className:"w-28 h-1.5 bg-border rounded-full appearance-none cursor-pointer hover:bg-hover transition-colors [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-text [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-text [&::-moz-range-thumb]:border-0","aria-label":"Thumbnail size"})]})}),a.jsxs("div",{className:"toolbar-right flex items-center gap-2 justify-end",children:[ge&&a.jsxs("div",{className:"toolbar-nav flex items-center gap-1 mr-1",children:[a.jsx("button",{className:`btn btn-icon ${ee?"":"opacity-40 cursor-not-allowed"}`,title:"Previous image (A / )",onClick:()=>ee&&(F==null?void 0:F()),"aria-label":"Previous image","aria-disabled":!ee,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("button",{className:`btn btn-icon ${z?"":"opacity-40 cursor-not-allowed"}`,title:"Next image (D / )",onClick:()=>z&&(Q==null?void 0:Q()),"aria-label":"Next image","aria-disabled":!z,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 6l6 6-6 6"})})})]}),a.jsxs("div",{className:"toolbar-panels flex items-center gap-1",children:[a.jsx("button",{className:`btn btn-icon ${j?"":"opacity-50"}`,title:j?"Hide left panel (Ctrl+B)":"Show left panel (Ctrl+B)",onClick:M,"aria-pressed":j,"aria-label":"Toggle left panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"11",y:"5",width:"10",height:"14",rx:"1.5"})]})}),a.jsx("button",{className:`btn btn-icon ${I?"":"opacity-50"}`,title:I?"Hide right panel (Ctrl+Alt+B)":"Show right panel (Ctrl+Alt+B)",onClick:B,"aria-pressed":I,"aria-label":"Toggle right panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"15",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"3",y:"5",width:"10",height:"14",rx:"1.5"})]})})]}),!n&&P&&a.jsxs("button",{className:`btn ${O?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!O&&P(),"aria-label":"Upload images",title:A?"Uploading":"Upload images","aria-disabled":O||A,disabled:O||A,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M12 16V5"}),a.jsx("path",{d:"M7 10l5-5 5 5"}),a.jsx("path",{d:"M4 19h16"})]}),a.jsx("span",{children:A?"Uploading":"Upload"})]}),G&&a.jsx(lS,{...G,isNarrow:fe||we}),!n&&fe&&a.jsx("button",{className:`btn btn-icon ${se?"btn-active":""} ${L?"opacity-50 cursor-not-allowed":""}`,"aria-label":se?"Close search":"Open search",title:L?"Search disabled":se?"Close search":"Search",onClick:()=>!L&&Y(Ce=>!Ce),disabled:L,children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"11",cy:"11",r:"7"}),a.jsx("path",{d:"M21 21l-4.35-4.35"})]})}),!n&&!fe?a.jsx("div",{className:"toolbar-search toolbar-search-desktop w-[240px]",children:a.jsx("input",{ref:H,"aria-label":"Search filename, tags, notes",placeholder:L?R??"Search disabled":"Search...",onChange:Ce=>t(Ce.target.value),className:"toolbar-search-input input w-full focus:w-full transition-all duration-200 select-text",disabled:L})}):null]}),!n&&fe&&se&&!L&&a.jsx("div",{className:"toolbar-search-row",children:a.jsx("input",{ref:H,"aria-label":"Search filename, tags, notes",placeholder:R??"Search...",onChange:Ce=>t(Ce.target.value),className:"toolbar-search-input-mobile input input-lg w-full select-text"})}),Vt&&a.jsx(mS,{viewMode:g,currentSort:tn,sortOnlyOptions:Cn,sortDisabled:h,sortControlsDisabled:Tt,sortDir:ze,isRandom:Ue,showSelectModeToggle:Ie,multiSelectMode:K,selectModeLabel:Se,uploadBusy:A,uploadDisabled:O,onViewMode:S,onSortChange:Ce=>p==null?void 0:p(um(Ce,he)),onToggleSortDir:Fe,onToggleMultiSelectMode:_,onUploadClick:P})]})}function yS(e,t){if(typeof e!="number")return null;const n=e.toLocaleString();if(typeof t!="number")return`${n} items`;const r=t.toLocaleString();return t===e?`${n} items`:`${n} / ${r} items`}function vS(e,t){return typeof e=="number"?e:t>0?1:0}function um(e,t){if(e.startsWith("metric:")){const n=e.slice(7);return n?{kind:"metric",key:n,dir:t.dir}:t}if(e.startsWith("builtin:")){const n=e.slice(8);if(n==="name"||n==="added"||n==="random")return{kind:"builtin",key:n,dir:t.dir}}return t}class ln extends Error{constructor(n,r,s,i){super(r);lt(this,"status");lt(this,"url");lt(this,"body");this.name="FetchError",this.status=n,this.url=s,this.body=i}}function xS(e){const t=e.trim();return t.startsWith("{")||t.startsWith("[")}function hx(e,t,n){if(t&&typeof t=="object"){const r=t,s=typeof r.error=="string"?r.error:null,i=typeof r.message=="string"?r.message:null;if(s&&i)return`${s}: ${i}`;if(s)return s;if(i)return i}return typeof t=="string"&&t?t:`HTTP ${e} for ${n}`}function ft(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{let c=null;const d=await l.text().catch(()=>"");if(d)if((l.headers.get("content-type")||"").includes("application/json")||xS(d))try{c=JSON.parse(d)}catch{c=d}else c=d;if(!l.ok)throw new ln(l.status,hx(l.status,c,e),e,c);return c}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}function no(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{if(!l.ok){const c=await l.text().catch(()=>""),d=c||null;throw new ln(l.status,hx(l.status,d,e),e,d)}return l.blob()}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}class px{constructor(t){lt(this,"store",new Map);lt(this,"inflight",new Map);lt(this,"totalBytes",0);this.maxBytes=t}getMaxBytes(){return this.maxBytes}getTotalBytes(){return this.totalBytes}getSize(){return this.store.size}has(t){return this.store.has(t)}isInflight(t){return this.inflight.has(t)}get(t){const n=this.store.get(t);if(n)return this.store.delete(t),this.store.set(t,n),n.blob}evictIfNeeded(t){for(;this.totalBytes+t>this.maxBytes&&this.store.size>0;){const n=this.store.keys().next().value;if(n==null)break;const r=this.store.get(n);r&&(this.totalBytes-=r.size),this.store.delete(n)}}set(t,n){const r=n.size||0;if(!(r>this.maxBytes)){if(this.store.has(t)){const s=this.store.get(t);this.totalBytes-=s.size,this.store.delete(t)}this.evictIfNeeded(r),this.store.set(t,{blob:n,size:r}),this.totalBytes+=r}}async getOrFetch(t,n){const r=this.get(t);if(r)return r;const s=this.inflight.get(t);if(s)return s.promise;const i=n(),o=typeof i=="object"&&"promise"in i,l=o?i.promise:i,c=o?i.abort:void 0,d=l.then(f=>(this.set(t,f),f)).finally(()=>{this.inflight.delete(t)});return this.inflight.set(t,{promise:d,abort:c}),d}prefetch(t,n){if(this.store.has(t)||this.inflight.has(t))return;const r=n(),s=typeof r=="object"&&"promise"in r,i=s?r.promise:r,o=s?r.abort:void 0,l=i.then(c=>(this.set(t,c),c)).catch(()=>new Blob).finally(()=>{this.inflight.delete(t)});this.inflight.set(t,{promise:l,abort:o})}cancelPrefetch(t){const n=this.inflight.get(t);if(n!=null&&n.abort)try{n.abort()}catch{}this.inflight.delete(t)}clear(){for(const[t,n]of this.inflight)if(n.abort)try{n.abort()}catch{}this.inflight.clear(),this.store.clear(),this.totalBytes=0}evictPrefix(t){const n=(()=>{const s=t?`/${t.replace(/^\/+/,"")}`:"/";return s==="/"?"/":s.replace(/\/+$/,"")})(),r=s=>{const i=s.startsWith("/")?s.replace(/\/+$/,""):`/${s.replace(/\/+$/,"")}`;return n==="/"?!0:i===n||i.startsWith(`${n}/`)};for(const[s,i]of Array.from(this.store.entries()))r(s)&&(this.totalBytes-=i.size,this.store.delete(s));for(const[s,i]of Array.from(this.inflight.entries()))if(r(s)){if(i.abort)try{i.abort()}catch{}this.inflight.delete(s)}this.totalBytes<0&&(this.totalBytes=0)}}const qs=new px(60*1024*1024),$d=new px(20*1024*1024),Xr={browseStart:e=>`lenslet:browse:load:start:${e}`,browseComplete:e=>`lenslet:browse:load:complete:${e}`,firstGrid:e=>`lenslet:browse:first-grid:${e}`,firstGridLatency:e=>`lenslet:browse:first-grid-latency:${e}`,firstThumb:e=>`lenslet:browse:first-thumb:${e}`,firstThumbLatency:e=>`lenslet:browse:first-thumb-latency:${e}`},He={activeRequestId:null,activeLoadStartedAtMs:null,firstGridItemLatencyMs:null,firstGridItemPath:null,firstThumbnailLatencyMs:null,firstThumbnailPath:null,requestBudget:null};function ah(){return typeof performance<"u"&&typeof performance.now=="function"?performance.now():Date.now()}function mu(e){if(!(typeof performance>"u"||typeof performance.mark!="function"))try{performance.mark(e)}catch{}}function mx(e,t,n){if(!(typeof performance>"u"||typeof performance.measure!="function"))try{performance.measure(e,t,n)}catch{}}function $i(){typeof window>"u"||(window.__lensletBrowseHotpath=gx())}function gx(){return{firstGridItemLatencyMs:He.firstGridItemLatencyMs,firstGridItemPath:He.firstGridItemPath,firstThumbnailLatencyMs:He.firstThumbnailLatencyMs,firstThumbnailPath:He.firstThumbnailPath,requestBudget:He.requestBudget?{...He.requestBudget}:null}}function wS(e){He.requestBudget={...e},$i()}function bS(e){He.activeRequestId=e.requestId,He.activeLoadStartedAtMs=ah(),He.firstGridItemLatencyMs=null,He.firstGridItemPath=null,He.firstThumbnailLatencyMs=null,He.firstThumbnailPath=null,mu(Xr.browseStart(e.requestId)),$i()}function SS(e){He.activeRequestId===e&&(mu(Xr.browseComplete(e)),$i())}function CS(e){const t=He.activeRequestId,n=He.activeLoadStartedAtMs;if(t==null||n==null||He.firstGridItemLatencyMs!=null)return;const r=Math.max(0,ah()-n);He.firstGridItemLatencyMs=Math.round(r),He.firstGridItemPath=e;const s=Xr.firstGrid(t);mu(s),mx(Xr.firstGridLatency(t),Xr.browseStart(t),s),$i()}function cm(e){const t=He.activeRequestId,n=He.activeLoadStartedAtMs;if(t==null||n==null||He.firstThumbnailLatencyMs!=null)return;const r=Math.max(0,ah()-n);He.firstThumbnailLatencyMs=Math.round(r),He.firstThumbnailPath=e;const s=Xr.firstThumb(t);mu(s),mx(Xr.firstThumbLatency(t),Xr.browseStart(t),s),$i()}$i();const kS=["folders","thumb","file"],vc={folders:2,thumb:6,file:3};let dm=1;const Lt={folders:{limit:vc.folders,inflight:new Map,queued:[],peakInflight:0},thumb:{limit:vc.thumb,inflight:new Map,queued:[],peakInflight:0},file:{limit:vc.file,inflight:new Map,queued:[],peakInflight:0}};function $a(){if(typeof DOMException<"u")return new DOMException("request aborted","AbortError");const e=new Error("request aborted");return e.name="AbortError",e}function ES(){return{limits:{folders:Lt.folders.limit,thumb:Lt.thumb.limit,file:Lt.file.limit},inflight:{folders:Lt.folders.inflight.size,thumb:Lt.thumb.inflight.size,file:Lt.file.inflight.size},queued:{folders:Lt.folders.queued.length,thumb:Lt.thumb.queued.length,file:Lt.file.queued.length},peakInflight:{folders:Lt.folders.peakInflight,thumb:Lt.thumb.peakInflight,file:Lt.file.peakInflight},updatedAtMs:Date.now()}}function ls(){wS(ES())}function fm(e){const t=Lt[e];for(;t.inflight.size<t.limit&&t.queued.length>0;){const n=t.queued.shift();if(!n)break;n.start()}}function Ws(e,t){const n=Lt[e],r=dm;dm+=1;let s=!1,i=!1,o=null;return{promise:new Promise((d,f)=>{const p=()=>{i&&(i=!1,n.inflight.delete(r),fm(e),ls())},h=()=>{if(s||i)return;i=!0;let w;try{w=t()}catch(x){s=!0,p(),f(x);return}o={abort:w.abort,reject:f},n.inflight.set(r,o),n.peakInflight=Math.max(n.peakInflight,n.inflight.size),ls(),w.promise.then(x=>{s||(s=!0,p(),d(x))},x=>{s||(s=!0,p(),f(x))})};if(n.inflight.size<n.limit){h();return}n.queued.push({id:r,start:h,reject:f}),ls()}),abort:()=>{if(s)return;if(s=!0,i){if(n.inflight.delete(r),o!=null&&o.abort)try{o.abort()}catch{}o==null||o.reject($a()),fm(e),ls();return}const d=n.queued.findIndex(f=>f.id===r);if(d>=0){const[f]=n.queued.splice(d,1);f.reject($a()),ls()}}}}function NS(e=kS){for(const t of e){const n=Lt[t];for(const s of Array.from(n.inflight.values())){if(s.abort)try{s.abort()}catch{}s.reject($a())}n.inflight.clear();const r=n.queued.splice(0,n.queued.length);for(const s of r)s.reject($a())}ls()}ls();const xc={};function jS(){const e=xc==null?void 0:xc.VITE_API_BASE,t=typeof window<"u",n=t?window.location.origin:"http://localhost",r=t?window.location.hostname:"localhost",s=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\]|.+\.localhost)$/i.test(r);if(!e)return"";let i;try{i=new URL(e,n)}catch{return""}const o=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\])$/i.test(i.hostname);return s?i.origin:o?"":i.origin}const Ve=jS();const MS=40*1024*1024;function RS(e){return e==="viewer"||e==="compare"}function hm(e){return`${Ve}/thumb?path=${encodeURIComponent(e)}`}function pm(e){return`${Ve}/file?path=${encodeURIComponent(e)}`}const wc="lenslet.client_id",mm="lenslet.client_id.session",yx="lenslet.last_event_id",PS=1e3,TS=3e4,IS=5;let Bd=null,ua=null,gm=0,hi=null,pi=0,gu=!0,Ba=!1;function vx(){return typeof window<"u"&&typeof EventSource<"u"}function ym(e,t){if(!e)return null;try{return e.getItem(t)}catch{return null}}function vm(e,t,n){if(e)try{e.setItem(t,n)}catch{}}function LS(e,t){if(e)try{e.removeItem(t)}catch{}}function _S(){if(typeof navigator>"u")return"server";const e=navigator.userAgent||"",t=navigator.language||"",n=navigator.platform||"",r=typeof Intl<"u"&&Intl.DateTimeFormat().resolvedOptions().timeZone||"",s=typeof screen<"u"?`${screen.width}x${screen.height}x${screen.colorDepth}`:"";return[e,t,n,r,s].join("|")}function AS(e){let t=2166136261;for(let n=0;n<e.length;n+=1)t^=e.charCodeAt(n),t=t*16777619>>>0;return t.toString(16).padStart(8,"0")}function xm(){return typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`client_${Math.random().toString(36).slice(2,10)}_${Date.now()}`}function ro(e){return Bd=e,e}function Ua(e){if(typeof window>"u")return null;try{return e==="local"?window.localStorage:window.sessionStorage}catch{return null}}function Ai(){if(Bd)return Bd;const e=Ua("local"),t=Ua("session"),n=ym(t,mm);if(n)return ro(n);const r=ym(e,wc);if(t){const i=xm();return vm(t,mm,i),r&&LS(e,wc),ro(i)}if(r)return ro(r);if(e){const i=xm();return vm(e,wc,i),ro(i)}const s=`fp_${AS(_S())}_${Math.random().toString(36).slice(2,8)}`;return ro(s)}function yu(e="lenslet"){gm+=1;const t=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`nonce_${Math.random().toString(36).slice(2,10)}_${Date.now()}_${gm}`;return`${e}:${Ai()}:${t}`}function FS(){if(ua!=null)return ua;if(typeof window>"u")return null;const e=Ua("local");if(!e)return null;try{const t=e.getItem(yx);if(!t)return null;const n=Number(t);return!Number.isFinite(n)||n<=0?null:(ua=n,n)}catch{return null}}function OS(e){if(!Number.isFinite(e)||e<=0||(ua=e,typeof window>"u"))return;const t=Ua("local");if(t)try{t.setItem(yx,String(e))}catch{}}function DS(){if(typeof window>"u")return`${Ve}/events`;const e=new URL(`${Ve}/events`,window.location.origin),t=FS();return t!=null&&Number.isFinite(t)&&e.searchParams.set("last_event_id",String(t)),e.toString()}function zS(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}let Rn=null,xx="idle";const Ud=new Set,Vd=new Set,Wd=new Set;function mi(e){xx=e;for(const t of Vd)t(e)}function uh(e){if(Ba!==e){Ba=e;for(const t of Wd)t(e)}}function ch(){hi!=null&&(window.clearTimeout(hi),hi=null)}function $S(){pi=0,ch()}function BS(){if(!gu||hi!=null)return;pi+=1;const e=Math.min(PS*Math.pow(2,pi-1),TS);pi>=IS?(mi("offline"),uh(!0)):mi("reconnecting"),hi=window.setTimeout(()=>{hi=null,wx()},e)}function wx(){if(!gu||!vx()||(Rn&&Rn.readyState===EventSource.CLOSED&&(Rn.close(),Rn=null),Rn))return;pi>0?mi("reconnecting"):mi("connecting");const e=new EventSource(DS());Rn=e;const t=n=>r=>{const s=zS(r.data);if(!s)return;const i=r.lastEventId?Number(r.lastEventId):null,o=i!=null&&Number.isFinite(i)?i:null;o!=null&&OS(o);for(const l of Ud)l({type:n,id:o,data:s})};e.addEventListener("item-updated",t("item-updated")),e.addEventListener("metrics-updated",t("metrics-updated")),e.addEventListener("presence",t("presence")),e.onopen=()=>{$S(),uh(!1),mi("live")},e.onerror=()=>{Rn===e&&(e.close(),Rn=null,BS())}}function US(){gu=!0,vx()&&(ch(),wx())}function VS(){gu=!1,ch(),pi=0,Rn&&(Rn.close(),Rn=null),uh(!1),mi("offline")}function WS(e){return Ud.add(e),()=>{Ud.delete(e)}}function HS(e){return Vd.add(e),e(xx),()=>{Vd.delete(e)}}function QS(e){return Wd.add(e),e(Ba),()=>{Wd.delete(e)}}function KS(){return Ba}function qS(e){NS(e)}function GS(e,t){const n=JSON.stringify(t),r=`${Ve}${e}`;if(typeof navigator<"u"&&typeof navigator.sendBeacon=="function")try{if(navigator.sendBeacon(r,new Blob([n],{type:"application/json"})))return!0}catch{}if(typeof fetch!="function")return!1;try{return fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0}),!0}catch{return!1}}function YS(e,t,n){return GS("/presence/leave",{gallery_id:e,lease_id:t,client_id:n??Ai()})}function Al(e){return e??Ai()}function Fl(e,t){return ft(`${Ve}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).promise}function wm(e,t){const n=new URLSearchParams({path:e});return t!=null&&t.recursive&&n.set("recursive","1"),t!=null&&t.countOnly&&n.set("count_only","1"),n.toString()}const me={getFolder:(e,t)=>Ws("folders",()=>ft(`${Ve}/folders?${wm(e,t)}`)).promise,getFolderCount:e=>Ws("folders",()=>ft(`${Ve}/folders?${wm(e,{recursive:!0,countOnly:!0})}`)).promise,search:(e,t)=>{const n=new URLSearchParams;return e&&n.set("q",e),t&&n.set("path",t),ft(`${Ve}/search?${n}`).promise},getEmbeddings:()=>ft(`${Ve}/embeddings`).promise,searchEmbeddings:e=>ft(`${Ve}/embeddings/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,refreshFolder:e=>{const t=new URLSearchParams({path:e});return ft(`${Ve}/refresh?${t}`,{method:"POST"}).promise},getSidecar:e=>ft(`${Ve}/item?path=${encodeURIComponent(e)}`).promise,patchSidecar:(e,t,n)=>{const s={"Content-Type":"application/json","Idempotency-Key":(n==null?void 0:n.idempotencyKey)??yu("patch"),"x-client-id":Ai(),"x-updated-by":"web"};return(n==null?void 0:n.ifMatch)!=null&&(s["If-Match"]=String(n.ifMatch)),ft(`${Ve}/item?path=${encodeURIComponent(e)}`,{method:"PATCH",headers:s,body:JSON.stringify(t)}).promise},getMetadata:e=>ft(`${Ve}/metadata?path=${encodeURIComponent(e)}`).promise,putSidecar:(e,t)=>ft(`${Ve}/item?path=${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json","x-client-id":Ai(),"x-updated-by":"web"},body:JSON.stringify(t)}).promise,getHealth:()=>ft(`${Ve}/health`).promise,joinPresence:(e,t,n)=>Fl("/presence/join",{gallery_id:e,client_id:Al(n),lease_id:t}),movePresence:(e,t,n,r)=>Fl("/presence/move",{from_gallery_id:e,to_gallery_id:t,client_id:Al(r),lease_id:n}),leavePresence:(e,t,n)=>Fl("/presence/leave",{gallery_id:e,client_id:Al(n),lease_id:t}),postPresence:(e,t,n)=>Fl("/presence",{gallery_id:e,client_id:Al(n),lease_id:t}),getThumb:e=>$d.getOrFetch(e,()=>Ws("thumb",()=>no(hm(e)))),prefetchThumb:e=>{$d.prefetch(e,()=>Ws("thumb",()=>no(hm(e))))},getFile:e=>qs.getOrFetch(e,()=>Ws("file",()=>no(pm(e)))),exportComparison:e=>no(`${Ve}/export-comparison`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,prefetchFile:async(e,t)=>{if(RS(t)&&!(qs.has(e)||qs.isInflight(e)))try{const n=await Ws("file",()=>no(pm(e),{headers:{"x-lenslet-prefetch":t}})).promise;n.size<=MS&&qs.set(e,n)}catch{}},cancelPrefetch:e=>{qs.cancelPrefetch(e)},uploadFile:async(e,t)=>{const n=new FormData;return n.append("dest",e),n.append("file",t),ft(`${Ve}/file`,{method:"POST",body:n,timeoutMs:6e4}).promise},moveFile:async(e,t)=>{const n=new FormData;return n.append("src",e),n.append("dest",t),ft(`${Ve}/move`,{method:"POST",body:n}).promise},deleteFiles:async e=>ft(`${Ve}/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paths:e})}).promise,exportIntent:async e=>{const t=new FormData;return t.append("path",e),ft(`${Ve}/export-intent`,{method:"POST",body:t}).promise},getViews:()=>ft(`${Ve}/views`).promise,saveViews:e=>ft(`${Ve}/views`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise};class XS{constructor(t=400){lt(this,"cache",new Map);lt(this,"maxSize");this.maxSize=t,typeof window<"u"&&window.addEventListener("beforeunload",()=>this.clear(),{once:!0})}get(t){const n=this.cache.get(t);return n&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){for(this.cache.has(t)&&this.cache.delete(t);this.cache.size>=this.maxSize;){const r=this.cache.keys().next().value;if(r===void 0)break;const s=this.cache.get(r);if(this.cache.delete(r),s)try{URL.revokeObjectURL(s)}catch{}}this.cache.set(t,n)}clear(){for(const t of this.cache.values())try{URL.revokeObjectURL(t)}catch{}this.cache.clear()}}const bc=new XS(400);function JS({path:e,name:t,onClick:n,selected:r,highlighted:s,highlightKey:i,displayW:o,displayH:l,ioRoot:c,isScrolling:d,priority:f}){const p=u.useRef(null),[h,w]=u.useState(()=>bc.get(e)??null),[x,b]=u.useState(!1),[C,y]=u.useState(()=>!!h);u.useEffect(()=>{const v=p.current;if(!v)return;const g=new IntersectionObserver(S=>{for(const E of S)E.target===v&&b(E.isIntersecting||E.intersectionRatio>0)},{root:c??null,rootMargin:"200px 0px",threshold:.01});return g.observe(v),()=>{g.unobserve(v),g.disconnect()}},[c]),u.useEffect(()=>{if(h||!(x&&!d||f))return;let v=!0;return me.getThumb(e).then(g=>{if(!v)return;const S=URL.createObjectURL(g);bc.set(e,S),w(S)}).catch(()=>{}),()=>{v=!1}},[e,h,x,d,f]),u.useEffect(()=>{var g;if(!h){y(!1);return}const v=(g=p.current)==null?void 0:g.querySelector("img");v&&v.complete&&v.naturalWidth>0?(y(!0),cm(e)):y(!1)},[h]),u.useEffect(()=>{w(bc.get(e)??null)},[e]);const m=["absolute inset-0 relative bg-hover border border-border rounded-lg overflow-hidden select-none",r?"outline-2 outline-accent":"",s?"thumb-updated-ring":"","hover:outline hover:outline-1 hover:outline-accent"].filter(Boolean).join(" ");return a.jsx("div",{ref:p,"data-highlight-key":i??void 0,className:m,onClick:n,children:h?a.jsx("img",{className:`w-full h-full object-cover block pointer-events-none select-none opacity-0 transition-opacity duration-[160ms] ${C?"opacity-100":""}`,src:h,alt:t,loading:"lazy",decoding:"async",onLoad:()=>{y(!0),cm(e)},width:o?Math.round(o):void 0,height:l?Math.round(l):void 0}):null})}function Hs(e,t,n){let r=n.initialDeps??[],s,i=!0;function o(){var l,c,d;let f;n.key&&((l=n.debug)!=null&&l.call(n))&&(f=Date.now());const p=e();if(!(p.length!==r.length||p.some((x,b)=>r[b]!==x)))return s;r=p;let w;if(n.key&&((c=n.debug)!=null&&c.call(n))&&(w=Date.now()),s=t(...p),n.key&&((d=n.debug)!=null&&d.call(n))){const x=Math.round((Date.now()-f)*100)/100,b=Math.round((Date.now()-w)*100)/100,C=b/16,y=(m,v)=>{for(m=String(m);m.length<v;)m=" "+m;return m};console.info(`%c ${y(b,5)} /${y(x,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*C,120))}deg 100% 31%);`,n==null?void 0:n.key)}return n!=null&&n.onChange&&!(i&&n.skipInitialOnChange)&&n.onChange(s),i=!1,s}return o.updateDeps=l=>{r=l},o}function bm(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const ZS=(e,t)=>Math.abs(e-t)<1.01,eC=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},Sm=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},tC=e=>e,nC=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},rC=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=o=>{const{width:l,height:c}=o;t({width:Math.round(l),height:Math.round(c)})};if(s(Sm(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(o=>{const l=()=>{const c=o[0];if(c!=null&&c.borderBoxSize){const d=c.borderBoxSize[0];if(d){s({width:d.inlineSize,height:d.blockSize});return}}s(Sm(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},Cm={passive:!0},km=typeof window>"u"?!0:"onscrollend"in window,sC=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&km?()=>{}:eC(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),o=f=>()=>{const{horizontal:p,isRtl:h}=e.options;s=p?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,f)},l=o(!0),c=o(!1);c(),n.addEventListener("scroll",l,Cm);const d=e.options.useScrollendEvent&&km;return d&&n.addEventListener("scrollend",c,Cm),()=>{n.removeEventListener("scroll",l),d&&n.removeEventListener("scrollend",c)}},iC=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},oC=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const o=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class lC{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:tC,rangeExtractor:nC,onChange:()=>{},measureElement:iC,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=Hs(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let o=r-1;o>=0;o--){const l=n[o];if(s.has(l.lane))continue;const c=i.get(l.lane);if(c==null||l.end>c.end?i.set(l.lane,l):l.end<c.end&&s.set(l.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=Hs(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(n,r,s,i,o,l)=>(this.prevLanes!==void 0&&this.prevLanes!==l&&(this.lanesChangedFlag=!0),this.prevLanes=l,this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=Hs(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l},c)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>n)for(const h of this.laneAssignments.keys())h>=n&&this.laneAssignments.delete(h);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(h=>{this.itemSizeCache.set(h.key,h.size)}));const d=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===n&&(this.lanesSettling=!1);const f=this.measurementsCache.slice(0,d),p=new Array(l).fill(void 0);for(let h=0;h<d;h++){const w=f[h];w&&(p[w.lane]=h)}for(let h=d;h<n;h++){const w=i(h),x=this.laneAssignments.get(h);let b,C;if(x!==void 0&&this.options.lanes>1){b=x;const g=p[b],S=g!==void 0?f[g]:void 0;C=S?S.end+this.options.gap:r+s}else{const g=this.options.lanes===1?f[h-1]:this.getFurthestMeasurement(f,h);C=g?g.end+this.options.gap:r+s,b=g?g.lane:h%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(h,b)}const y=c.get(w),m=typeof y=="number"?y:this.options.estimateSize(h),v=C+m;f[h]={index:h,start:C,size:m,end:v,key:w,lane:b},p[b]=h}return this.measurementsCache=f,f},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Hs(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?aC({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=Hs(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,o)=>i===null||o===null?[]:n({startIndex:i,endIndex:o,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==n&&(l&&this.observer.unobserve(l),this.observer.observe(n),this.elementsCache.set(o,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,o=r-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,o,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=Hs(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,o=n.length;i<o;i++){const l=n[i],c=r[l];s.push(c)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return bm(r[bx(0,r.length-1,s=>bm(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),o=this.getScrollOffset();r==="auto"&&(r=n>=o+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),o=this.getScrollOffset();if(r==="auto")if(s.end>=o+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=o+this.options.scrollPaddingStart)r="start";else return[o,r];const l=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),n=Math.max(0,Math.min(n,this.options.count-1));let i=0;const o=10,l=d=>{if(!this.targetWindow)return;const f=this.getOffsetForIndex(n,d);if(!f){console.warn("Failed to get offset for index:",n);return}const[p,h]=f;this._scrollToOffset(p,{adjustments:void 0,behavior:s}),this.targetWindow.requestAnimationFrame(()=>{const w=this.getScrollOffset(),x=this.getOffsetForIndex(n,h);if(!x){console.warn("Failed to get offset for index:",n);return}ZS(x[0],w)||c(h)})},c=d=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(d)):console.warn(`Failed to scroll to index ${n} after ${o} attempts.`))};l(r)},this.scrollBy=(n,{behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=r.length-1;for(;o>=0&&i.some(l=>l===null);){const l=r[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}s=Math.max(...i.filter(l=>l!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(t)}}const bx=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function aC({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=c=>e[c].start;if(e.length<=r)return{startIndex:0,endIndex:s};let o=bx(0,s,i,n),l=o;if(r===1)for(;l<s&&e[l].end<n+t;)l++;else if(r>1){const c=Array(r).fill(0);for(;l<s&&c.some(f=>f<n+t);){const f=e[l];c[f.lane]=f.end,l++}const d=Array(r).fill(n+t);for(;o>=0&&d.some(f=>f>=n);){const f=e[o];d[f.lane]=f.start,o--}o=Math.max(0,o-o%r),l=Math.min(s,l+(r-1-l%r))}return{startIndex:o,endIndex:l}}const Em=typeof document<"u"?u.useLayoutEffect:u.useEffect;function uC(e){const t=u.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var o;i?hu.flushSync(t):t(),(o=e.onChange)==null||o.call(e,s,i)}},[r]=u.useState(()=>new lC(n));return r.setOptions(n),Em(()=>r._didMount(),[]),Em(()=>r._willUpdate()),r}function cC(e){return uC({observeElementRect:rC,observeElementOffset:sC,scrollToFn:oC,...e})}function dC({containerW:e,gap:t,targetCell:n,aspect:r,captionH:s}){const i=Math.max(1,Math.floor((e+t)/(n+t))),o=(e-t*(i-1))/i,l=o*r.h/r.w,c=l+s+t;return{columns:i,cellW:o,mediaH:l,rowH:c}}const fC=1.333;function hC({items:e,containerWidth:t,targetHeight:n,gap:r,captionH:s}){if(t<=0)return[];const i=[];let o=[],l=0;const c=(d,f)=>({index:i.length,height:f+s+r,imageH:f,items:d.map(p=>({item:p.item,displayW:p.aspect*f,displayH:f,originalIndex:p.originalIndex}))});for(let d=0;d<e.length;d++){const f=e[d],p=f.w>0&&f.h>0?f.w/f.h:fC;o.push({item:f,aspect:p,originalIndex:d}),l+=p;const h=(o.length-1)*r;if(l*n+h>=t){const x=(t-h)/l;i.push(c(o,x)),o=[],l=0}}return o.length>0&&i.push(c(o,n)),i}function pC(e,t,n){return{mode:"adaptive",rows:hC({items:t,containerWidth:e,targetHeight:n.targetCell,gap:n.gap,captionH:n.captionH})}}function mC(e,t,n){const{columns:r,cellW:s,mediaH:i,rowH:o}=dC({containerW:e,gap:n.gap,targetCell:n.targetCell,aspect:n.aspect,captionH:n.captionH}),l=Math.ceil(t.length/Math.max(1,r));return{mode:"grid",columns:r,cellW:s,mediaH:i,rowH:o,rowCount:l}}function gC(e,t,n){const[r,s]=u.useState(0);u.useLayoutEffect(()=>{const c=e.current;if(!c)return;const d=()=>{const p=getComputedStyle(c),h=c.clientWidth-parseFloat(p.paddingLeft)-parseFloat(p.paddingRight);s(h)},f=new ResizeObserver(d);return f.observe(c),d(),()=>f.disconnect()},[]);const i=u.useMemo(()=>n.viewMode==="adaptive"?pC(r,t,n):mC(r,t,n),[r,t,n.viewMode,n.gap,n.targetCell,n.aspect.w,n.aspect.h,n.captionH]),o=cC({count:i.mode==="adaptive"?i.rows.length:i.rowCount,getScrollElement:()=>e.current,estimateSize:c=>i.mode==="adaptive"?i.rows[c].height:i.rowH,overscan:8}),l=o.getVirtualItems();return u.useEffect(()=>{o.measure()},[i,o]),{width:r,layout:i,rowVirtualizer:o,virtualRows:l}}function yC(e,t,n,r){if(!e.length)return null;const s=n?e.findIndex(l=>l.path===n):0,i=Math.max(1,t);let o=s;if(r.key==="ArrowRight"||r.key==="d")o=Math.min(e.length-1,s+1);else if(r.key==="ArrowLeft"||r.key==="a")o=Math.max(0,s-1);else if(r.key==="ArrowDown"||r.key==="s")o=Math.min(e.length-1,s+i);else if(r.key==="ArrowUp"||r.key==="w")o=Math.max(0,s-i);else return r.key==="Enter"&&n?"open":null;return o}function vC(e,t,n){if(e.length===0)return[];const r=Array.from(new Set(e.map(d=>d.index))).sort((d,f)=>d-f),s=r[0],i=r[r.length-1],o=t.mode==="adaptive"?Math.max(0,t.rows.length-1):Math.max(0,Math.ceil(n.length/Math.max(1,t.columns))-1),l=[s-1,i+1].filter(d=>d>=0&&d<=o);if(l.length===0)return[];const c=[];for(const d of l){if(t.mode==="adaptive"){const h=t.rows[d];if(!h)continue;for(const w of h.items)c.push(w.item.path);continue}const f=d*t.columns,p=n.slice(f,f+t.columns);for(const h of p)c.push(h.path)}return Array.from(new Set(c))}function xC(e,t){var s,i;let n=0,r=e.length-1;for(;n<=r;){const o=n+r>>1,l=e[o],c=((s=l.items[0])==null?void 0:s.originalIndex)??-1,d=((i=l.items[l.items.length-1])==null?void 0:i.originalIndex)??-1;if(t>=c&&t<=d)return o;t<c?r=o-1:n=o+1}return 0}function wC(e,t,n){const r=new Set;for(const s of n){if(t.mode==="adaptive"){const l=t.rows[s.index];if(!l)continue;for(const c of l.items)r.add(c.item.path);continue}const i=s.index*t.columns,o=Math.min(e.length,i+t.columns);for(let l=i;l<o;l+=1){const c=e[l];c&&r.add(c.path)}}return r}function bC(e,t,n,r){var o,l,c;const s=SC(n,r);if(!s)return null;if(t.mode==="adaptive")return((l=(o=t.rows[s.index])==null?void 0:o.items[0])==null?void 0:l.item.path)??null;const i=s.index*t.columns;return((c=e[i])==null?void 0:c.path)??null}function SC(e,t){if(e.length===0)return null;const n=Math.max(0,t);for(const r of e){const s=r.start??0;if((r.end??s+(r.size??0))>n)return r}return e[0]}function CC({selectionToken:e,appliedSelectionToken:t,selectedPath:n,topAnchorToken:r,appliedTopAnchorToken:s,topAnchorPath:i,hasPath:o}){const l=e??0;if(l>0&&l!==t&&n&&o(n))return{source:"selection",path:n,token:l};const c=r??0;return c>0&&c!==s&&i&&o(i)?{source:"top-anchor",path:i,token:c}:null}function kC({path:e,pathToIndex:t,layout:n,adaptiveRowMeta:r}){var o;const s=t.get(e);if(s==null||s<0)return null;const i=n.mode==="grid"?Math.floor(s/Math.max(1,n.columns)):xC(n.rows,s);return n.mode==="grid"?i*n.rowH:((o=r==null?void 0:r[i])==null?void 0:o.start)??0}const EC=500,NC=450,jC=600,MC=8;function RC(e){return Math.max(NC,Math.min(jC,e))}class PC{constructor(t){lt(this,"delayMs");lt(this,"moveTolerancePx");lt(this,"onLongPress");lt(this,"onCancel");lt(this,"timerId",null);lt(this,"activePointerId",null);lt(this,"startX",0);lt(this,"startY",0);lt(this,"lastEvent",null);lt(this,"fired",!1);this.delayMs=RC(t.delayMs??EC),this.moveTolerancePx=Math.max(0,t.moveTolerancePx??MC),this.onLongPress=t.onLongPress,this.onCancel=t.onCancel}pointerDown(t){return(t.pointerType??"mouse")==="mouse"?!1:t.isPrimary===!1?(this.cancel("multitouch"),!1):this.activePointerId!=null&&this.activePointerId!==t.pointerId?(this.cancel("multitouch"),!1):(this.activePointerId=t.pointerId,this.startX=t.clientX,this.startY=t.clientY,this.lastEvent=t,this.fired=!1,this.clearTimer(),this.timerId=setTimeout(()=>{this.activePointerId==null||this.fired||this.lastEvent==null||(this.fired=!0,this.clearTimer(),this.onLongPress(this.lastEvent))},this.delayMs),!0)}pointerMove(t){if(!this.matchesPointer(t.pointerId)||this.fired)return;this.lastEvent=t;const n=t.clientX-this.startX,r=t.clientY-this.startY;Math.hypot(n,r)>this.moveTolerancePx&&this.cancel("movement")}pointerUp(t){if(!(t!=null&&!this.matchesPointer(t))){if(!this.fired){this.cancel("pointerup");return}this.reset()}}pointerCancel(t){t!=null&&!this.matchesPointer(t)||this.cancel("pointercancel")}cancelFromScroll(){this.cancel("scroll")}destroy(){this.cancel("cleanup")}matchesPointer(t){return this.activePointerId!=null&&this.activePointerId===t}clearTimer(){this.timerId!=null&&(clearTimeout(this.timerId),this.timerId=null)}reset(){this.clearTimer(),this.activePointerId=null,this.lastEvent=null,this.fired=!1}cancel(t){var r;const n=this.timerId!=null&&!this.fired&&t!=="cleanup";this.reset(),n&&((r=this.onCancel)==null||r.call(this,t))}}function TC(e){return e==="touch"||e==="pen"}function IC(e){return e.multiSelectMode||e.isShift||e.isToggle||!TC(e.pointerType)?!1:e.selectedPaths.length===1&&e.selectedPaths[0]===e.path}function Nm(e,t){return e.includes(t)?e.filter(n=>n!==t):[...e,t]}const nr=12,LC=44,_C={w:4,h:3},AC=350,FC=120;function OC(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function jm(e){return{pointerId:e.pointerId,pointerType:e.pointerType,clientX:e.clientX,clientY:e.clientY,isPrimary:e.isPrimary}}function DC(e,t){const n=(t??"").trim();if(!n)return e;const r=e.toLowerCase().indexOf(n.toLowerCase());if(r===-1)return e;const s=e.slice(0,r),i=e.slice(r,r+n.length),o=e.slice(r+n.length);return a.jsxs(a.Fragment,{children:[s,a.jsx("mark",{className:"bg-accent/20 text-inherit rounded px-0.5",children:i}),o]})}function zC({items:e,selected:t,restoreToSelectionToken:n,restoreToTopAnchorToken:r,restoreToTopAnchorPath:s,multiSelectMode:i=!1,onSelectionChange:o,onOpenViewer:l,onContextMenuItem:c,onOpenItemActions:d,highlight:f,recentlyUpdated:p,onVisiblePathsChange:h,onTopAnchorPathChange:w,suppressSelectionHighlight:x=!1,viewMode:b="grid",targetCellSize:C=220,scrollRef:y,hideScrollbar:m=!1,isLoading:v=!1}){const[g,S]=u.useState(null),[E,T]=u.useState(null),[j,I]=u.useState(!1),[M,B]=u.useState(null),[F,Q]=u.useState(null),ee=u.useRef(null),z=u.useRef(null),L=u.useRef(null),R=y??L,P=u.useRef(null),A=u.useRef(0),O=u.useRef(0),K=u.useRef(new Set),U=u.useRef(null),_=u.useRef(null),G=u.useRef(null),V=u.useRef(null),J=u.useRef(null),se=u.useRef({path:null,pointerType:null}),Y=C,{width:q,layout:H,rowVirtualizer:fe,virtualRows:Te}=gC(R,e,{gap:nr,targetCell:Y,aspect:_C,captionH:LC,viewMode:b}),we=u.useMemo(()=>{const D=new Map;for(let X=0;X<e.length;X++)D.set(e[X].path,X);return D},[e]),he=u.useMemo(()=>{if(H.mode!=="adaptive")return null;const D=new Map;return H.rows.forEach((X,ae)=>{let ye=0;X.items.forEach((be,Ee)=>{const ie=ye+be.displayW/2;D.set(be.item.path,{row:ae,center:ie,order:Ee}),ye+=be.displayW+nr})}),D},[H]);u.useEffect(()=>{if(!t.length)return;const D=t[0];M!==D&&B(D)},[t,M]);const ze=u.useMemo(()=>{if(H.mode!=="adaptive")return null;let D=0;return H.rows.map(X=>{const ae=D;return D+=X.height,{start:ae,height:X.height}})},[H]),Ue=u.useRef(null),Tt=(D,X)=>{try{if(Ue.current!=null){try{cancelAnimationFrame(Ue.current)}catch{}Ue.current=null}const ae=D.scrollTop,ye=X-ae;if(Math.abs(ye)<1){D.scrollTop=X;return}const be=140,Ee=performance.now(),ie=pe=>1-Math.pow(1-pe,3),Ne=pe=>{const it=Math.min(1,(pe-Ee)/be),Oe=ie(it);D.scrollTop=ae+ye*Oe,it<1?Ue.current=requestAnimationFrame(Ne):Ue.current=null};Ue.current=requestAnimationFrame(Ne)}catch{D.scrollTop=X}},[Bt,Ut]=u.useState(!1);u.useEffect(()=>{const D=R.current;if(!D)return;let X=0;const ae=()=>{var ye;(ye=_.current)==null||ye.cancelFromScroll(),Ut(!0),window.clearTimeout(X),X=window.setTimeout(()=>Ut(!1),FC)};return D.addEventListener("scroll",ae,{passive:!0}),()=>D.removeEventListener("scroll",ae)},[]),u.useEffect(()=>{const D=new PC({onLongPress:X=>{const ae=G.current;if(!ae||!d)return;const ye=V.current??{x:X.clientX,y:X.clientY};d(ae,ye),J.current={path:ae,untilMs:Date.now()+700}}});return _.current=D,()=>{D.destroy(),_.current===D&&(_.current=null)}},[d]);const Dn=()=>{z.current!=null&&(window.clearTimeout(z.current),z.current=null)},tn=()=>{if(Dn(),I(!1),S(null),ee.current){try{URL.revokeObjectURL(ee.current)}catch{}ee.current=null}T(null)},Cn=D=>{Bt||(Dn(),S(D),I(!1),z.current=window.setTimeout(async()=>{z.current=null;try{const X=await me.getFile(D),ae=URL.createObjectURL(X);if(ee.current)try{URL.revokeObjectURL(ee.current)}catch{}ee.current=ae,T(ae),I(!0)}catch{}},AC))},Vt=H.mode==="grid"?H.columns:Math.max(1,Math.floor(q/(Y+nr))),le=(D,X)=>{if(H.mode!=="adaptive")return null;const ae=H.rows[D];if(!ae)return null;let ye=0,be=null;for(const Ee of ae.items){const ie=ye+Ee.displayW/2,Ne=Math.abs(ie-X);(!be||Ne<be.dist)&&(be={path:Ee.item.path,dist:Ne}),ye+=Ee.displayW+nr}return be?be.path:null},oe=(D,X)=>{var Oe,yt,Ht,En;if(!e.length)return null;const ae=D??e[0].path;if(H.mode!=="adaptive"){const fn=yC(e,Vt,ae,X);return fn==="open"||fn==null?fn:((Oe=e[fn])==null?void 0:Oe.path)??null}const ye=he==null?void 0:he.get(ae);if(!ye)return ae;const be=we.get(ae)??0,Ee=X.key;if(Ee==="Enter")return"open";if(Ee==="ArrowRight"||Ee==="d")return((yt=e[Math.min(e.length-1,be+1)])==null?void 0:yt.path)??ae;if(Ee==="ArrowLeft"||Ee==="a")return((Ht=e[Math.max(0,be-1)])==null?void 0:Ht.path)??ae;const ie=Ee==="ArrowDown"||Ee==="s"?1:Ee==="ArrowUp"||Ee==="w"?-1:0;if(ie===0)return null;const Ne=ye.row+ie;if(Ne<0||Ne>=(((En=H.rows)==null?void 0:En.length)??0))return ae;const pe=ye.center;return le(Ne,pe)??ae},ge=D=>{var X;try{(X=document.getElementById(`cell-${encodeURIComponent(D)}`))==null||X.focus()}catch{}},Ie=u.useCallback(D=>{try{me.prefetchThumb(D)}catch{}},[]),Se=u.useCallback((D,X)=>{d==null||d(D,X)},[d]),ce=()=>{G.current=null,V.current=null},Fe=(D,X)=>{var ae;X.target.closest("[data-grid-action]")||(se.current={path:D,pointerType:X.pointerType},!i&&(G.current=D,V.current={x:X.clientX,y:X.clientY},(ae=_.current)==null||ae.pointerDown(jm(X))))},Ge=D=>{var X;i||(V.current={x:D.clientX,y:D.clientY},(X=_.current)==null||X.pointerMove(jm(D)))},et=D=>{var X;i||((X=_.current)==null||X.pointerUp(D.pointerId),ce())},kn=D=>{var X;i||((X=_.current)==null||X.pointerCancel(D.pointerId),ce())},gt=(D,X)=>{const ae=J.current;if(ae&&ae.path===D&&ae.untilMs>Date.now()){J.current=null,ge(D);return}ae&&ae.untilMs<=Date.now()&&(J.current=null),B(D),Q(D);const ye=!!X.shiftKey,be=!!(X.ctrlKey||X.metaKey);if(i)o(Nm(t,D)),P.current=D;else if(IC({pointerType:se.current.path===D?se.current.pointerType:null,multiSelectMode:i,isShift:ye,isToggle:be,selectedPaths:t,path:D}))o([D]),P.current=D,l(D);else if(ye){const Ee=P.current??M??t[0]??D,ie=we.get(Ee)??e.findIndex(pe=>pe.path===Ee),Ne=we.get(D)??e.findIndex(pe=>pe.path===D);if(ie!==-1&&Ne!==-1){const pe=Math.min(ie,Ne),it=Math.max(ie,Ne),Oe=e.slice(pe,it+1).map(yt=>yt.path);if(be){const yt=new Set(t);for(const Ht of Oe)yt.add(Ht);o(Array.from(yt))}else o(Oe)}else o([D])}else be?(o(Nm(t,D)),P.current=D):(o([D]),P.current=D);Bt||Ie(D),ge(D)},zn=(D,X)=>{var ae,ye;try{const be=Ce.has(D)&&t.length>0?t:[D];(ae=X.dataTransfer)==null||ae.setData("application/x-lenslet-paths",JSON.stringify(be)),X.dataTransfer&&(X.dataTransfer.effectAllowed="copyMove");try{document.body.classList.add("drag-active")}catch{}const ie=X.currentTarget.querySelector(".cell-content img"),Ne=document.createElement("div");Ne.className="drag-ghost";const pe=document.createElement("img");pe.draggable=!1,pe.alt="drag",ie&&ie.src&&(pe.src=ie.src),Ne.appendChild(pe),document.body.appendChild(Ne);const it=Ne.getBoundingClientRect().width||150;(ye=X.dataTransfer)==null||ye.setDragImage(Ne,Math.round(it/2),0);const Oe=()=>{try{Ne.remove()}catch{}try{document.body.classList.remove("drag-active")}catch{}window.removeEventListener("dragend",Oe),window.removeEventListener("pointerup",Oe),document.removeEventListener("visibilitychange",Oe)};window.addEventListener("dragend",Oe),window.addEventListener("pointerup",Oe),document.addEventListener("visibilitychange",Oe)}catch{}};u.useEffect(()=>{const D=R.current;if(!D)return;const X=ae=>{var Oe,yt,Ht;const ye=oe(F,ae);if(ye==null)return;if(ae.preventDefault(),ye==="open"){F&&l(F);return}const be=e.find(En=>En.path===ye);if(!be)return;Q(be.path),B(be.path),o([be.path]),P.current=be.path;const Ee=H.mode==="grid"?Math.floor((we.get(be.path)??0)/Math.max(1,H.columns)):((Oe=he==null?void 0:he.get(be.path))==null?void 0:Oe.row)??0,ie=D.scrollTop,Ne=ie+D.clientHeight,pe=H.mode==="adaptive"?((yt=ze==null?void 0:ze[Ee])==null?void 0:yt.start)??0:Ee*H.rowH,it=H.mode==="adaptive"?pe+(((Ht=ze==null?void 0:ze[Ee])==null?void 0:Ht.height)??0):pe+H.rowH;(pe<ie||it>Ne)&&Tt(D,pe),ge(be.path)};return D.addEventListener("keydown",X),()=>{D.removeEventListener("keydown",X)}},[e,F,Vt,l,H,he,ze,we]),u.useLayoutEffect(()=>{const D=R.current;if(!D)return;const X=CC({selectionToken:n,appliedSelectionToken:A.current,selectedPath:t[0]??null,topAnchorToken:r,appliedTopAnchorToken:O.current,topAnchorPath:s??null,hasPath:ye=>we.has(ye)});if(!X)return;const ae=kC({path:X.path,pathToIndex:we,layout:H,adaptiveRowMeta:ze});if(ae!=null){try{D.scrollTop=ae}catch{}if(X.source==="selection"){A.current=X.token;return}O.current=X.token}},[n,r,s,t,we,H,ze]);const Ce=u.useMemo(()=>new Set(t),[t]),rt=!!(g&&E&&j),dn=u.useMemo(()=>vC(Te,H,e),[e,H,Te]);u.useEffect(()=>{if(!(Bt||dn.length===0))for(const D of dn)Ie(D)},[Bt,dn,Ie]),u.useEffect(()=>{var D;(D=R.current)==null||D.focus()},[]),u.useEffect(()=>{var D;if(x){try{(D=R.current)==null||D.blur()}catch{}Q(null)}},[x]);const $n=u.useMemo(()=>wC(e,H,Te),[e,H,Te]),Wt=u.useMemo(()=>{var D;return bC(e,H,Te,((D=R.current)==null?void 0:D.scrollTop)??0)},[e,H,Te,R]);u.useEffect(()=>{h&&(OC(K.current,$n)||(K.current=$n,h($n)))},[h,$n]),u.useEffect(()=>{w&&U.current!==Wt&&(U.current=Wt,w(Wt))},[w,Wt]);const Bi=F?`cell-${encodeURIComponent(F)}`:void 0;return u.useEffect(()=>{if(!e.length||gx().firstGridItemLatencyMs!=null)return;const D=R.current;if(!D)return;const X=D.querySelector('[role="gridcell"][id^="cell-"]');if(!X)return;const ae=D.getBoundingClientRect(),ye=X.getBoundingClientRect();if(!(ye.bottom>=ae.top&&ye.top<=ae.bottom))return;const Ee=X.id.startsWith("cell-")?X.id.slice(5):"";let ie=e[0].path;if(Ee)try{ie=decodeURIComponent(Ee)}catch{ie=e[0].path}CS(ie)},[e,R]),a.jsxs("div",{role:"grid","aria-label":"Gallery",className:`relative h-full overflow-auto p-3 outline-none ${m?"scrollbar-hidden pr-4":"scrollbar-thin"} ${rt?"cursor-zoom-in":""}`,ref:R,tabIndex:0,"aria-activedescendant":Bi,"aria-busy":v||void 0,onMouseDown:()=>{var D;return(D=R.current)==null?void 0:D.focus()},style:{"--gap":`${nr}px`},children:[a.jsxs("div",{className:"relative w-full",style:{height:fe.getTotalSize()},children:[Te.map(D=>{var Ee;let X=[],ae={},ye="";if(H.mode==="adaptive"){const ie=H.rows[D.index];if(!ie)return null;X=ie.items,ae={height:ie.height,transform:`translate3d(0, ${D.start}px, 0)`,display:"flex",gap:nr,paddingBottom:nr},ye="absolute top-0 left-0 right-0 w-full will-change-transform"}else{const ie=D.index*H.columns;X=e.slice(ie,ie+H.columns).map(pe=>({item:pe,displayW:H.cellW,displayH:H.mediaH})),ae={transform:`translate3d(0, ${D.start}px, 0)`,gridTemplateColumns:`repeat(${H.columns}, minmax(0, 1fr))`,gap:nr,paddingBottom:nr},ye="absolute top-0 left-0 right-0 w-full grid will-change-transform"}const be=D.index===((Ee=Te[0])==null?void 0:Ee.index);return a.jsx("div",{className:ye,role:"row",style:ae,children:X.map(({item:ie,displayW:Ne,displayH:pe})=>{const it=!x&&(M===ie.path||Ce.has(ie.path)),Oe=(p==null?void 0:p.get(ie.path))??null,yt=Oe!=null,Ht=H.mode==="adaptive"?{width:Ne}:{},En=H.mode==="adaptive"?{height:pe}:{},fn=H.mode==="adaptive"?"relative rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group shrink-0":"relative aspect-[4/3] rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group";return a.jsxs("div",{id:`cell-${encodeURIComponent(ie.path)}`,className:`relative min-w-0 ${it?"outline outline-2 outline-accent outline-offset-2 rounded-[10px]":""}`,role:"gridcell","aria-selected":it,tabIndex:F===ie.path?0:-1,onFocus:()=>Q(ie.path),draggable:!0,style:Ht,onDragStart:Ye=>zn(ie.path,Ye),onPointerDown:Ye=>Fe(ie.path,Ye),onPointerMove:Ge,onPointerUp:et,onPointerCancel:kn,onContextMenu:Ye=>{Ye.preventDefault(),Ye.stopPropagation(),c==null||c(Ye,ie.path)},children:[a.jsxs("div",{className:fn,style:En,onDoubleClick:()=>{i||l(ie.path)},onMouseLeave:tn,children:[a.jsx("button",{type:"button",className:"grid-item-action-btn touch-manipulation","data-grid-action":"1","aria-label":`Open actions for ${ie.name}`,"aria-haspopup":"menu",onPointerDown:Ye=>Ye.stopPropagation(),onClick:Ye=>{Ye.stopPropagation();const Bn=Ye.currentTarget.getBoundingClientRect();Se(ie.path,{x:Bn.right-4,y:Bn.bottom-4})},children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})}),a.jsx("div",{className:"cell-content absolute inset-0",children:a.jsx(JS,{path:ie.path,name:ie.name,selected:it,highlighted:yt,highlightKey:Oe,displayW:Ne,displayH:pe,ioRoot:R.current,isScrolling:Bt,priority:be,onClick:Ye=>gt(ie.path,Ye)})}),a.jsx("div",{className:"absolute right-0 bottom-0 w-7 h-7 cursor-zoom-in",onMouseEnter:()=>Cn(ie.path),onMouseLeave:tn,children:a.jsx("div",{className:"grid-item-preview-corner absolute right-0 bottom-0 h-[18px] w-[18px] flex items-center justify-center text-text select-none",style:{clipPath:'path("M0 9C0 4.02944 4.02944 0 9 0H18V18H0V9Z")',background:"linear-gradient(135deg, rgba(18,18,18,0.9) 0%, rgba(34,34,34,0.9) 60%, rgba(22,22,22,0.9) 100%)",borderTop:"1px solid rgba(255,255,255,0.08)",borderLeft:"1px solid rgba(255,255,255,0.08)",boxShadow:"0 1px 2px rgba(0,0,0,0.45)",backdropFilter:"blur(1px)"},children:a.jsxs("svg",{width:"11",height:"11",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round",className:"text-[#d9dce2]","aria-hidden":"true",style:{transform:"translate(0px,0px)"},children:[a.jsx("circle",{cx:"11",cy:"11",r:"5.4"}),a.jsx("path",{d:"M15.5 15.5 L19 19"})]})})})]}),a.jsxs("div",{className:"flex flex-col items-center text-center gap-0 mt-1 px-0.5 text-white/90",children:[a.jsx("div",{className:"text-sm leading-[18px] thumb-filename line-clamp-2 break-words hyphens-auto text-center",title:ie.name,children:DC(ie.name,f)}),a.jsxs("div",{className:"text-[11px] leading-[15px] opacity-70",children:[ie.w,"  ",ie.h]})]})]},ie.path)})},D.key)}),g&&E&&j&&hu.createPortal(a.jsx("div",{className:"toolbar-offset fixed inset-0 z-[999] flex items-center justify-center pointer-events-none bg-black/20 opacity-100",children:a.jsx("img",{src:E,alt:"preview",className:"max-w-[80vw] max-h-[80vh] object-contain opacity-[0.98]"})}),document.body)]},`${b}-${Vt}`),v&&e.length===0&&a.jsx("div",{className:"pointer-events-none absolute inset-3 z-20 flex items-center justify-center",children:a.jsxs("div",{className:"w-full max-w-[580px] rounded-lg border border-border bg-panel/95 px-4 py-3 shadow-lg",children:[a.jsx("div",{className:"flex items-center justify-between gap-3 text-xs text-text",children:a.jsx("span",{className:"font-semibold",children:"Loading gallery"})}),a.jsx("div",{className:"mt-2 text-[11px] text-muted",children:"Preparing gallery"})]})})]})}const $C=48,BC=[.1,.24,.5,.74,.9];function UC({items:e,metricKey:t,scrollRef:n,sortDir:r}){const{orderedValues:s,numericValues:i}=u.useMemo(()=>{var M;const j=[],I=[];for(const B of e){const F=(M=B.metrics)==null?void 0:M[t],Q=F==null||Number.isNaN(F)?null:F;j.push(Q),Q!=null&&I.push(Q)}return{orderedValues:j,numericValues:I}},[e,t]),o=u.useMemo(()=>VC(i,$C),[i]),l=u.useMemo(()=>WC(i,BC),[i]),[c,d]=u.useState(0),[f,p]=u.useState(null),[h,w]=u.useState(!1),x=u.useRef(null);if(u.useEffect(()=>{const j=n.current;if(!j)return;const I=()=>{const M=Math.max(1,j.scrollHeight-j.clientHeight),B=fs(M>0?j.scrollTop/M:0);d(B)};return I(),j.addEventListener("scroll",I,{passive:!0}),window.addEventListener("resize",I),()=>{j.removeEventListener("scroll",I),window.removeEventListener("resize",I)}},[n,e.length]),u.useEffect(()=>{p(null)},[t,e.length]),!o)return null;const b={min:o.min,max:o.max},C=f!=null?Rm(f):null,y=Rm(c),m=r==="desc",v=u.useMemo(()=>f==null?null:KC(s,f),[s,f]);function g(j){p(fs(j))}function S(){p(null)}function E(j){const I=n.current;if(!I)return;const M=Math.max(0,I.scrollHeight-I.clientHeight);I.scrollTop=fs(j)*M}function T(j){var M;const I=(M=x.current)==null?void 0:M.getBoundingClientRect();return I?fs((j.clientY-I.top)/I.height):null}return a.jsxs("div",{className:"absolute right-0 top-3 bottom-3 w-[14px] flex items-stretch pointer-events-auto",children:[a.jsxs("svg",{ref:x,viewBox:"0 0 10 100",preserveAspectRatio:"none",className:"w-full h-full rounded bg-surface-inset border border-border/60 cursor-ns-resize",onPointerDown:j=>{var M;j.preventDefault();const I=T(j);I!=null&&(w(!0),g(I),E(I),(M=x.current)==null||M.setPointerCapture(j.pointerId))},onPointerMove:j=>{const I=T(j);if(I==null){h||S();return}g(I),h&&E(I)},onPointerUp:j=>{var I;w(!1),(I=x.current)==null||I.releasePointerCapture(j.pointerId)},onPointerLeave:()=>{h||S()},children:[HC(o.bins,"var(--border-strong)",{flip:m}),QC(l,b,{flip:m,color:"var(--muted)"}),Mm(y,{color:"var(--highlight)",strokeWidth:.8}),C!=null&&Mm(C,{color:"var(--text-secondary)",strokeWidth:.6,dashed:!0})]}),v!=null&&f!=null&&a.jsx("div",{className:"pointer-events-none absolute right-full mr-2 px-1.5 py-0.5 rounded border border-border bg-surface text-[10px] text-text shadow",style:{top:`calc(${(f*100).toFixed(2)}% - 8px)`},children:GC(v)})]})}function VC(e,t){if(!e.length)return null;const n=Math.min(...e);let r=Math.max(...e);n===r&&(r=n+1);const s=new Array(t).fill(0),i=t/(r-n);for(const o of e){const l=Math.max(0,Math.min(t-1,Math.floor((o-n)*i)));s[l]+=1}return{bins:s,min:n,max:r}}function WC(e,t){if(!e.length)return[];const n=[...e].sort((s,i)=>s-i),r=n.length-1;return t.map(s=>{const i=r*s,o=Math.floor(i),l=Math.ceil(i);if(o===l)return n[o];const c=i-o;return n[o]+(n[l]-n[o])*c})}function HC(e,t,n){const r=Math.max(1,...e),s=100/e.length,i=(n==null?void 0:n.flip)??!1;return e.map((o,l)=>{const c=Math.max(.8,o/r*10),d=(i?e.length-1-l:l)*s;return a.jsx("rect",{x:10-c,y:d,width:c,height:Math.max(.2,s-.2),fill:t,opacity:.9},`sb-${l}`)})}function QC(e,t,n){const r=(n==null?void 0:n.flip)??!1,s=n==null?void 0:n.color;return e.map((i,o)=>{const l=qC(i,t,r),c=o===2;return a.jsx("line",{x1:0,y1:l,x2:10,y2:l,stroke:s,strokeWidth:c?.8:.5,opacity:c?.9:.6,vectorEffect:"non-scaling-stroke"},`qt-${o}-${i}`)})}function Mm(e,t){return a.jsx("line",{x1:0,y1:e,x2:10,y2:e,stroke:t.color,strokeWidth:t.strokeWidth??.6,strokeDasharray:t.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}function KC(e,t){if(!e.length)return null;const n=Math.round(fs(t)*(e.length-1)),r=e[n];if(r!=null)return r;for(let s=1;s<e.length;s++){const i=n-s;if(i>=0&&e[i]!=null)return e[i];const o=n+s;if(o<e.length&&e[o]!=null)return e[o]}return null}function qC(e,t,n){const r=t.max-t.min;if(r===0)return 0;const s=fs((e-t.min)/r);return(n?1-s:s)*100}function Rm(e){return fs(e)*100}function fs(e){return e<0?0:e>1?1:e}function GC(e){if(e==null||Number.isNaN(e))return"-";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function hs(e,t){const[n,r]=u.useState(null),s=u.useRef(null);return u.useEffect(()=>{if(!e){if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}r(null);return}let i=!0;return e().then(o=>{if(!i)return;const l=URL.createObjectURL(o);if(s.current)try{URL.revokeObjectURL(s.current)}catch{}s.current=l,r(l)}).catch(()=>{}),()=>{i=!1}},t),u.useEffect(()=>()=>{if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}},[]),n}const YC=1.2,XC=.05,JC=8;function Sc(e){return Number(Math.min(JC,Math.max(XC,e)).toFixed(4))}function Pm(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Tm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function ZC(e,t){try{e.setPointerCapture(t)}catch{}}function ek(e,t){try{e.releasePointerCapture(t)}catch{}}function tk(){const[e,t]=u.useState(1),[n,r]=u.useState(0),[s,i]=u.useState(0),[o,l]=u.useState(1),[c,d]=u.useState(!1),[f,p]=u.useState(!1),[h,w]=u.useState(!1),x=u.useRef(null),b=u.useRef(null),C=u.useRef(1),y=u.useRef(0),m=u.useRef(0),v=u.useRef(new Map),g=u.useRef(null),S=u.useRef(null),E=(R,P)=>{y.current=R,m.current=P,r(R),i(P)},T=R=>{const P=Sc(R);C.current=P,t(P)},j=(R,P)=>{g.current={pointerId:R,startX:P.x,startY:P.y,startTx:y.current,startTy:m.current},S.current=null,p(!0)},I=()=>{const R=Array.from(v.current.entries());if(R.length<2)return;const[P,A]=R,[O,K]=P,[U,_]=A,G=Pm(K,_);!Number.isFinite(G)||G<=2||(S.current={pointerIds:[O,U],startDistance:G,startCenter:Tm(K,_),startScale:C.current,startTx:y.current,startTy:m.current},g.current=null,p(!0))},M=()=>{const R=x.current,P=b.current;if(!R||!P||!P.naturalWidth||!P.naturalHeight)return;const A=R.getBoundingClientRect(),O=A.width/P.naturalWidth,K=A.height/P.naturalHeight,U=Math.min(1,Math.min(O,K));l(U);const _=P.naturalWidth*U,G=P.naturalHeight*U;E((A.width-_)/2,(A.height-G)/2),T(1)};u.useEffect(()=>{const R=x.current;if(!R)return;const P=new ResizeObserver(()=>{try{requestAnimationFrame(()=>M())}catch{M()}});return P.observe(R),()=>P.disconnect()},[]),u.useEffect(()=>{C.current=e,y.current=n,m.current=s},[e,n,s]),u.useEffect(()=>()=>{v.current.clear(),g.current=null,S.current=null},[]);const B=R=>{R.preventDefault();const P=R.deltaY>0?-1:1,A=x.current;if(!A)return;const O=A.getBoundingClientRect(),K=R.clientX-O.left,U=R.clientY-O.top,_=C.current,G=Sc(_*Math.pow(YC,P));if(G===_)return;const V=G/_,J=K-V*(K-y.current),se=U-V*(U-m.current);T(G),E(J,se)},F=R=>{if((R.pointerType??"mouse")==="mouse"&&R.button!==0)return;const A=v.current,O=b.current;if(!O||A.size===0&&R.target!==O)return;const K=R.currentTarget,U=K.getBoundingClientRect();if(!(R.clientX<U.left||R.clientX>U.right||R.clientY<U.top||R.clientY>U.bottom)){if(R.preventDefault(),R.stopPropagation(),A.set(R.pointerId,{x:R.clientX,y:R.clientY}),ZC(K,R.pointerId),A.size>=2){I();return}j(R.pointerId,{x:R.clientX,y:R.clientY})}},Q=R=>{const P=v.current;if(!P.has(R.pointerId))return;P.set(R.pointerId,{x:R.clientX,y:R.clientY});const A=S.current;if(A){const _=P.get(A.pointerIds[0]),G=P.get(A.pointerIds[1]);if(_&&G){const V=Pm(_,G);if(V>2){const J=Tm(_,G),se=Sc(A.startScale*(V/A.startDistance)),Y=se/A.startScale,q=J.x-Y*(A.startCenter.x-A.startTx),H=J.y-Y*(A.startCenter.y-A.startTy);T(se),E(q,H)}}return}const O=g.current;if(!O||O.pointerId!==R.pointerId)return;const K=R.clientX-O.startX,U=R.clientY-O.startY;E(O.startTx+K,O.startTy+U)},ee=(R,P)=>{const A=v.current;if(!A.has(R))return;if(A.delete(R),ek(P,R),A.size===0){g.current=null,S.current=null,p(!1);return}if(A.size>=2){I();return}const[O,K]=A.entries().next().value;j(O,K)};return{scale:e,setScale:t,tx:n,setTx:r,ty:s,setTy:i,base:o,setBase:l,ready:c,setReady:d,dragging:f,setDragging:p,visible:h,setVisible:w,containerRef:x,imgRef:b,fitAndCenter:M,handleWheel:B,handlePointerDown:F,handlePointerMove:Q,handlePointerUp:R=>{ee(R.pointerId,R.currentTarget)},handlePointerCancel:R=>{ee(R.pointerId,R.currentTarget)}}}function nk({path:e,onClose:t,onNavigate:n,canPrev:r=!1,canNext:s=!1,onZoomChange:i,requestedZoomPercent:o,onZoomRequestConsumed:l}){const{scale:c,setScale:d,tx:f,setTx:p,ty:h,setTy:w,base:x,ready:b,setReady:C,dragging:y,visible:m,setVisible:v,containerRef:g,imgRef:S,fitAndCenter:E,handleWheel:T,handlePointerDown:j,handlePointerMove:I,handlePointerUp:M,handlePointerCancel:B}=tk(),F=hs(()=>me.getFile(e),[e]),Q=hs(()=>me.getThumb(e),[e]),ee=u.useCallback(()=>{v(!1),window.setTimeout(t,110)},[t,v]);return u.useEffect(()=>{requestAnimationFrame(()=>{var z;v(!0),(z=g.current)==null||z.focus()})},[e]),u.useEffect(()=>{const z=L=>{L.key==="Escape"?ee():(L.key==="ArrowRight"||L.key==="d")&&n?n(1):(L.key==="ArrowLeft"||L.key==="a")&&n&&n(-1)};return window.addEventListener("keydown",z),()=>window.removeEventListener("keydown",z)},[ee,n]),u.useEffect(()=>{C(!1)},[F]),u.useEffect(()=>{i&&i(x*c*100)},[x,c,i]),u.useEffect(()=>{if(o==null)return;const z=g.current;if(!z){l&&l();return}const L=Math.max(.05,Math.min(8,o/100/Math.max(1e-6,x))),R=z.getBoundingClientRect(),P=R.width/2,A=R.height/2;d(O=>{const K=L/O;return p(U=>P-K*(P-U)),w(U=>A-K*(A-U)),Number(L.toFixed(4))}),l&&l()},[o,x,l]),a.jsxs("div",{ref:g,role:"dialog","aria-modal":!0,"aria-label":"Image viewer",tabIndex:-1,className:`toolbar-offset touch-none absolute inset-0 left-[var(--left)] right-[var(--right)] flex items-start justify-start bg-panel z-viewer overflow-hidden transition-opacity duration-[110ms] ease-out cursor-grab focus:outline-none focus-visible:outline-none ${y?"cursor-grabbing select-none":""} ${m?"opacity-100":"opacity-0"}`,style:{outline:"none"},onClick:ee,onWheel:T,onPointerDown:j,onPointerMove:I,onPointerUp:M,onPointerCancel:B,onKeyDown:z=>{z.key==="Tab"&&z.preventDefault()},children:[a.jsxs("button",{"aria-label":"Close",onClick:z=>{z.stopPropagation(),ee()},className:"btn btn-sm absolute top-3 right-3 z-10",title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]}),Q&&a.jsx("img",{src:Q,alt:"thumb",className:"absolute top-0 left-0 max-w-none max-h-none object-contain pointer-events-none transition-opacity duration-[110ms] ease-out",draggable:!1,onDragStart:z=>z.preventDefault(),style:{transform:`translate(${f}px, ${h}px) scale(${x})`,transformOrigin:"0 0",opacity:b?0:.5,filter:"blur(0.25px)"}}),F&&a.jsx("img",{ref:S,src:F,alt:"viewer",className:"max-w-none max-h-none object-contain transition-opacity duration-[110ms] ease-out will-change-transform select-none",draggable:!1,onDragStart:z=>{z.preventDefault()},onLoad:z=>{E(),d(1);try{requestAnimationFrame(()=>C(!0))}catch{C(!0)}},onClick:z=>z.stopPropagation(),style:{transform:`translate(${f}px, ${h}px) scale(${x*c})`,transformOrigin:"0 0",opacity:b?.99:0,WebkitUserDrag:"none"}}),n&&a.jsxs("div",{className:"viewer-mobile-nav",onClick:z=>z.stopPropagation(),children:[a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${r?"":"is-disabled"}`,onClick:()=>r&&n(-1),"aria-label":"Previous image","aria-disabled":!r,disabled:!r,children:"Prev"}),a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${s?"":"is-disabled"}`,onClick:()=>s&&n(1),"aria-label":"Next image","aria-disabled":!s,disabled:!s,children:"Next"})]})]})}function dh(e){return!e||!(e instanceof HTMLElement)?!1:e.closest('input, textarea, [contenteditable="true"]')!==null}const rk=1.2,sk=.05,ik=8;function Cc(e){return Number(Math.min(ik,Math.max(sk,e)).toFixed(4))}function Im(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Lm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function ok(e,t){try{e.setPointerCapture(t)}catch{}}function lk(e,t){try{e.releasePointerCapture(t)}catch{}}function ak(){const[e,t]=u.useState(1),[n,r]=u.useState(0),[s,i]=u.useState(0),[o,l]=u.useState(0),[c,d]=u.useState(0),[f,p]=u.useState(1),[h,w]=u.useState(1),[x,b]=u.useState(!1),C=u.useRef(null),y=u.useRef(null),m=u.useRef(null),v=u.useRef(1),g=u.useRef(0),S=u.useRef(0),E=u.useRef(0),T=u.useRef(0),j=u.useRef(new Map),I=u.useRef(null),M=u.useRef(null),B=u.useCallback(_=>{g.current=_.txA,S.current=_.tyA,E.current=_.txB,T.current=_.tyB,r(_.txA),i(_.tyA),l(_.txB),d(_.tyB)},[]),F=u.useCallback(_=>{const G=Cc(_);v.current=G,t(G)},[]),Q=u.useCallback((_,G)=>{I.current={pointerId:_,startX:G.x,startY:G.y,startTxA:g.current,startTyA:S.current,startTxB:E.current,startTyB:T.current},M.current=null,b(!0)},[]),ee=u.useCallback(()=>{const _=Array.from(j.current.entries());if(_.length<2)return;const[G,V]=_,[J,se]=G,[Y,q]=V,H=Im(se,q);!Number.isFinite(H)||H<=2||(M.current={pointerIds:[J,Y],startDistance:H,startCenter:Lm(se,q),startScale:v.current,startTxA:g.current,startTyA:S.current,startTxB:E.current,startTyB:T.current},I.current=null,b(!0))},[]),z=u.useCallback((_,G)=>{const V=j.current;if(!V.has(_))return;if(V.delete(_),lk(G,_),V.size===0){I.current=null,M.current=null,b(!1);return}if(V.size>=2){ee();return}const[J,se]=V.entries().next().value;Q(J,se)},[Q,ee]),L=u.useCallback(()=>{const _=C.current;if(!_)return;const G=_.getBoundingClientRect(),V=Y=>{if(!Y||!Y.naturalWidth||!Y.naturalHeight)return;const q=G.width/Y.naturalWidth,H=G.height/Y.naturalHeight,fe=Math.min(1,Math.min(q,H)),Te=Y.naturalWidth*fe,we=Y.naturalHeight*fe;return{base:fe,tx:(G.width-Te)/2,ty:(G.height-we)/2}},J=V(y.current);J&&(p(J.base),g.current=J.tx,S.current=J.ty,r(J.tx),i(J.ty));const se=V(m.current);se&&(w(se.base),E.current=se.tx,T.current=se.ty,l(se.tx),d(se.ty))},[]);u.useEffect(()=>{const _=C.current;if(!_)return;const G=new ResizeObserver(()=>{try{requestAnimationFrame(()=>L())}catch{L()}});return G.observe(_),()=>G.disconnect()},[L]);const R=u.useCallback(()=>{F(1),L()},[L,F]);u.useEffect(()=>{v.current=e,g.current=n,S.current=s,E.current=o,T.current=c},[e,n,s,o,c]),u.useEffect(()=>()=>{j.current.clear(),I.current=null,M.current=null},[]);const P=u.useCallback(_=>{_.preventDefault();const G=_.deltaY>0?-1:1,V=C.current;if(!V)return;const J=V.getBoundingClientRect(),se=_.clientX-J.left,Y=_.clientY-J.top,q=v.current,H=Cc(q*Math.pow(rk,G));if(H===q)return;const fe=H/q;F(H),B({txA:se-fe*(se-g.current),tyA:Y-fe*(Y-S.current),txB:se-fe*(se-E.current),tyB:Y-fe*(Y-T.current)})},[B,F]),A=u.useCallback(_=>{if((_.pointerType??"mouse")==="mouse"&&_.button!==0)return;const V=_.currentTarget;if(_.preventDefault(),j.current.set(_.pointerId,{x:_.clientX,y:_.clientY}),ok(V,_.pointerId),j.current.size>=2){ee();return}Q(_.pointerId,{x:_.clientX,y:_.clientY})},[Q,ee]),O=u.useCallback(_=>{const G=j.current;if(!G.has(_.pointerId))return;G.set(_.pointerId,{x:_.clientX,y:_.clientY});const V=M.current;if(V){const q=G.get(V.pointerIds[0]),H=G.get(V.pointerIds[1]);if(q&&H){const fe=Im(q,H);if(fe>2){const Te=Lm(q,H),we=Cc(V.startScale*(fe/V.startDistance)),he=we/V.startScale;F(we),B({txA:Te.x-he*(V.startCenter.x-V.startTxA),tyA:Te.y-he*(V.startCenter.y-V.startTyA),txB:Te.x-he*(V.startCenter.x-V.startTxB),tyB:Te.y-he*(V.startCenter.y-V.startTyB)})}}return}const J=I.current;if(!J||J.pointerId!==_.pointerId)return;const se=_.clientX-J.startX,Y=_.clientY-J.startY;B({txA:J.startTxA+se,tyA:J.startTyA+Y,txB:J.startTxB+se,tyB:J.startTyB+Y})},[B,F]),K=u.useCallback(_=>{z(_.pointerId,_.currentTarget)},[z]),U=u.useCallback(_=>{z(_.pointerId,_.currentTarget)},[z]);return{scale:e,baseA:f,baseB:h,txA:n,tyA:s,txB:o,tyB:c,dragging:x,containerRef:C,imgARef:y,imgBRef:m,fitAndCenter:L,resetView:R,handleWheel:P,handlePointerDown:A,handlePointerMove:O,handlePointerUp:K,handlePointerCancel:U}}function uk({aItem:e,bItem:t,index:n,total:r,canPrev:s,canNext:i,onNavigate:o,onClose:l}){const c=u.useRef(null),[d,f]=u.useState(50),[p,h]=u.useState(!1),[w,x]=u.useState(!1),{scale:b,baseA:C,baseB:y,txA:m,tyA:v,txB:g,tyB:S,dragging:E,containerRef:T,imgARef:j,imgBRef:I,fitAndCenter:M,resetView:B,handleWheel:F,handlePointerDown:Q,handlePointerMove:ee,handlePointerUp:z,handlePointerCancel:L}=ak(),R=(e==null?void 0:e.path)??null,P=(t==null?void 0:t.path)??null,A=(e==null?void 0:e.name)??R??"Select an image",O=(t==null?void 0:t.name)??P??"Select another image";u.useEffect(()=>{requestAnimationFrame(()=>{var Y;return(Y=c.current)==null?void 0:Y.focus()})},[R,P]),u.useEffect(()=>{B(),h(!1),x(!1)},[R,P,B]),u.useEffect(()=>{const Y=q=>{if(!dh(q.target)){if(q.key==="Escape"){q.preventDefault(),l();return}if((q.key==="ArrowRight"||q.key==="d")&&i){q.preventDefault(),o(1);return}(q.key==="ArrowLeft"||q.key==="a")&&s&&(q.preventDefault(),o(-1))}};return window.addEventListener("keydown",Y),()=>window.removeEventListener("keydown",Y)},[l,o,s,i]);const K=hs(R?()=>me.getFile(R):null,[R]),U=hs(P?()=>me.getFile(P):null,[P]),_=hs(R?()=>me.getThumb(R):null,[R]),G=hs(P?()=>me.getThumb(P):null,[P]),V=u.useCallback(Y=>Math.min(95,Math.max(5,Y)),[]),J=u.useCallback(Y=>{const q=Y.target;q!=null&&q.closest(".compare-label")||q!=null&&q.closest(".compare-divider-hit")||Q(Y)},[Q]),se=u.useCallback(Y=>{const q=T.current;if(!q)return;Y.preventDefault(),Y.stopPropagation();const H=q.getBoundingClientRect(),fe=Y.currentTarget;fe.setPointerCapture(Y.pointerId);const Te=he=>{const ze=(he.clientX-H.left)/H.width*100;f(V(ze))},we=he=>{try{fe.releasePointerCapture(he.pointerId)}catch{}window.removeEventListener("pointermove",Te),window.removeEventListener("pointerup",we),window.removeEventListener("pointercancel",we)};window.addEventListener("pointermove",Te),window.addEventListener("pointerup",we),window.addEventListener("pointercancel",we)},[V]);return a.jsxs("div",{ref:c,role:"dialog","aria-modal":!0,"aria-label":"Compare images",tabIndex:-1,className:"toolbar-offset absolute inset-0 left-[var(--left)] right-[var(--right)] bg-panel z-viewer flex flex-col overflow-hidden focus:outline-none",onKeyDown:Y=>{Y.key==="Tab"&&Y.preventDefault()},children:[a.jsxs("div",{className:"compare-header flex items-center gap-3 px-3 py-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Compare"}),a.jsx("div",{className:"text-xs text-muted",children:r>=2?`${n+1}-${Math.min(n+2,r)} of ${r}`:"Select 2 images"}),a.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(-1),disabled:!s,title:"Previous (Left Arrow or A)",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Prev"]}),a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(1),disabled:!i,title:"Next (Right Arrow or D)",children:["Next",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"btn btn-sm",onClick:l,title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]})]})]}),a.jsx("div",{className:"flex-1 min-h-0 p-3 bg-panel",children:a.jsx("div",{ref:T,className:`compare-stage ${E?"is-dragging":""}`,onWheel:F,onPointerDown:J,onPointerMove:ee,onPointerUp:z,onPointerCancel:L,children:!e||!t?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-sm text-muted",children:"Select 2 images to compare."}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"compare-label left-3",children:[a.jsx("span",{className:"compare-label-tag",children:"A"}),a.jsx("span",{className:"truncate",title:e.path,children:A})]}),a.jsxs("div",{className:"compare-label right-3",children:[a.jsx("span",{className:"compare-label-tag",children:"B"}),a.jsx("span",{className:"truncate",title:t.path,children:O})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 ${100-d}% 0 0)`},children:[_&&a.jsx("img",{src:_,alt:"thumb A",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:Y=>Y.preventDefault(),style:{transform:`translate(${m}px, ${v}px) scale(${C})`,transformOrigin:"0 0",opacity:p?0:.5}}),K&&a.jsx("img",{ref:j,src:K,alt:"compare A",className:"compare-image",draggable:!1,onDragStart:Y=>Y.preventDefault(),onLoad:()=>{M();try{requestAnimationFrame(()=>h(!0))}catch{h(!0)}},style:{transform:`translate(${m}px, ${v}px) scale(${C*b})`,transformOrigin:"0 0",opacity:p?.99:0}})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 0 0 ${d}%)`},children:[G&&a.jsx("img",{src:G,alt:"thumb B",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:Y=>Y.preventDefault(),style:{transform:`translate(${g}px, ${S}px) scale(${y})`,transformOrigin:"0 0",opacity:w?0:.5}}),U&&a.jsx("img",{ref:I,src:U,alt:"compare B",className:"compare-image",draggable:!1,onDragStart:Y=>Y.preventDefault(),onLoad:()=>{M();try{requestAnimationFrame(()=>x(!0))}catch{x(!0)}},style:{transform:`translate(${g}px, ${S}px) scale(${y*b})`,transformOrigin:"0 0",opacity:w?.99:0}})]}),a.jsxs("div",{className:"compare-divider-hit",style:{left:`${d}%`},onPointerDown:se,children:[a.jsx("div",{className:"compare-divider-line"}),a.jsx("div",{className:"compare-divider-handle"})]})]})})})]})}function vu(){const[e,t]=u.useState(KS());return u.useEffect(()=>QS(t),[]),e}const Wo=e=>["item",e],ck={v:1,tags:[],notes:"",version:1,updated_at:"",updated_by:"web"},jn=new Map,ca=new Map,Hd=new Map,fh=new Map;let _m=0;const Jn=new Map,ho=new Map,dk=12e3,Qd=new Set,Kd=new Set;let hh={state:"idle"},Ho=null,qd=0;function Ol(e){hh=e;for(const t of Qd)t(e)}function hr(){const e=Jn.size>0,t=jn.size+ca.size+qd;if(e){Ol({state:"error",message:"Conflict detected"});return}if(Ho){Ol({state:"error",message:Ho});return}if(t>0){Ol({state:"syncing"});return}Ol({state:"idle"})}function ph(){let e=null;for(const t of Hd.values())e=e==null?t:Math.min(e,t);for(const t of fh.values())e=e==null?t:Math.min(e,t);return e}function Va(){const e=ph();for(const t of Kd)t(e)}function Wa(e){Ho=e,hr()}function Sx(){Ho&&(Ho=null,hr())}function Am(e){qd=Math.max(0,qd+e),hr()}function fk(){_m+=1;const e=_m;return fh.set(e,Date.now()),Va(),e}function hk(e){e!=null&&fh.delete(e)&&Va()}function xu(e){const t=ho.get(e);if(!t||!t.size)return;const n=Jn.get(e)??null;for(const r of t)r(n)}function Fm(e){return Jn.get(e)??null}function wu(e){Jn.delete(e)&&(xu(e),hr())}function pk(e,t){Jn.set(e,t),xu(e),hr()}function mk(e,t){const n=ho.get(e)??new Set;return n.add(t),ho.set(e,n),t(Jn.get(e)??null),()=>{const r=ho.get(e);r&&(r.delete(t),r.size||ho.delete(e))}}function gk(e){const[t,n]=u.useState(()=>e?Fm(e):null);return u.useEffect(()=>{if(!e){n(null);return}return n(Fm(e)),mk(e,n)},[e]),t}function yk(e){return Qd.add(e),e(hh),()=>{Qd.delete(e)}}function vk(){const[e,t]=u.useState(hh);return u.useEffect(()=>yk(t),[]),e}function xk(e){return Kd.add(e),e(ph()),()=>{Kd.delete(e)}}function wk(){const[e,t]=u.useState(()=>ph()),[n,r]=u.useState(()=>e==null?null:Date.now()-e);return u.useEffect(()=>xk(t),[]),u.useEffect(()=>{if(e==null){r(null);return}r(Date.now()-e);const s=window.setInterval(()=>{r(Date.now()-e)},1e3);return()=>window.clearInterval(s)},[e]),n}function Gd(e){const t={};return Object.prototype.hasOwnProperty.call(e,"star")&&(t.set_star=e.star??null),Object.prototype.hasOwnProperty.call(e,"notes")&&(t.set_notes=e.notes??""),Object.prototype.hasOwnProperty.call(e,"tags")&&(t.set_tags=Array.isArray(e.tags)?e.tags:[]),t}function Yd(e){var t,n;return e.set_star!==void 0||e.set_notes!==void 0||e.set_tags!==void 0||(((t=e.add_tags)==null?void 0:t.length)??0)>0||(((n=e.remove_tags)==null?void 0:n.length)??0)>0}function so(e){const t=[],n=new Set;for(const r of e??[]){if(typeof r!="string")continue;const s=r.trim();!s||n.has(s)||(n.add(s),t.push(s))}return t}function bk(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function Sk(e,t){if(e.set_star!==void 0&&(t.star??null)!==e.set_star||e.set_notes!==void 0&&(t.notes??"")!==(e.set_notes??""))return!1;if(e.set_tags!==void 0){const r=so(e.set_tags),s=so(t.tags);return bk(r,s)}const n=so(t.tags);for(const r of so(e.add_tags))if(!n.includes(r))return!1;for(const r of so(e.remove_tags))if(n.includes(r))return!1;return!0}function Cx(e,t,n){if(n instanceof ln&&n.status===409){const r=n.body;if(r!=null&&r.current)return pk(e,{path:e,current:r.current,pending:t,receivedAt:new Date().toISOString()}),!0}return!1}function Ck(e,t){const n=Jn.get(e);if(n){if(Sk(n.pending,t)){wu(e);return}Jn.set(e,{...n,current:t}),xu(e),hr()}}function kk(e){const t=vu();return pu({queryKey:Wo(e),queryFn:()=>me.getSidecar(e),enabled:!!e,staleTime:3e4,gcTime:5*6e4,retry:2,refetchInterval:t?dk:!1,refetchIntervalInBackground:t})}function Ek(e){const t=wr();return rS({mutationFn:async({patch:n,baseVersion:r,idempotencyKey:s})=>{const i=Gd(n);if(!Yd(i))return t.getQueryData(Wo(e))??ck;const o={...i,base_version:r};try{return await me.patchSidecar(e,o,{idempotencyKey:s??yu("patch"),ifMatch:r})}catch(l){throw Cx(e,i,l),l}},retry:(n,r)=>r instanceof ln&&r.status===409?!1:n<2,retryDelay:n=>Math.min(1e3*Math.pow(2,n),4e3),onMutate:()=>(Sx(),Am(1),{inflightId:fk()}),onSuccess:n=>{wu(e),t.setQueryData(Wo(e),n)},onError:n=>{n instanceof ln&&n.status===409||(n instanceof ln?Wa(n.message):Wa("Failed to save"))},onSettled:(n,r,s,i)=>{Am(-1),hk(i==null?void 0:i.inflightId)}})}const Nk=6;async function kx(e,t){if(!e.length)return;let n=0;const r=[],s=async()=>{for(;n<e.length;){const o=n++,l=e[o];try{await Ex(l,t)}catch(c){r.push({path:l,error:c}),console.error(`[bulkUpdateSidecars] Failed for ${l}:`,c)}}},i=Array.from({length:Math.min(Nk,e.length)},()=>s());if(await Promise.all(i),r.length===e.length)throw new Error(`All ${e.length} sidecar updates failed`)}async function Ex(e,t){const n=jn.get(e)||{};jn.set(e,{...n,...t}),Sx(),hr();const r=ca.get(e);if(r)return r;Hd.set(e,Date.now()),Va();const s=(async()=>{try{for(;jn.has(e);){const i=jn.get(e);if(!i)break;const o=Gd(i);if(!Yd(o)){jn.get(e)===i&&jn.delete(e);continue}let l=1;try{l=(await me.getSidecar(e)).version??1}catch{l=1}const c={...o,base_version:l};try{await me.patchSidecar(e,c,{idempotencyKey:yu("patch"),ifMatch:l}),wu(e),jn.get(e)===i&&jn.delete(e)}catch(d){if(Cx(e,o,d)){const p=jn.get(e);if(p&&p!==i){const h=Gd(p);if(Yd(h)){const w=Jn.get(e);w&&(Jn.set(e,{...w,pending:h}),xu(e))}}jn.delete(e)}else d instanceof ln?Wa(d.message):Wa("Failed to save");throw d}}}finally{ca.delete(e),Hd.delete(e),Va(),hr()}})();return ca.set(e,s),hr(),s}function rl(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function Nx(e){return e==="pil_info"||e.startsWith("pil_info.")||e.startsWith("pil_info[")}function Xd(e,t){if(typeof t=="number")return e?`${e}[${t}]`:`[${t}]`;const n=/^[A-Za-z0-9_$-]+$/.test(t);return e?n?`${e}.${t}`:`${e}["${t}"]`:n?t:`["${t}"]`}function Ha(e){return e==null?String(e):typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):Array.isArray(e)?`[${e.map(Ha).join(",")}]`:typeof e=="object"?`{${Object.entries(e).sort(([n],[r])=>n.localeCompare(r)).map(([n,r])=>`${n}:${Ha(r)}`).join(",")}}`:String(e)}function Dl(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return String(e);try{return JSON.stringify(e,null,1)}catch{return String(e)}}function Qa(e,t,n,r,s){if(s.skipPilInfo&&Nx(t))return;const i=t||"(root)";if(r>=s.maxDepth){n.set(i,e);return}if(Array.isArray(e)){if(!e.length){n.set(i,[]);return}if(e.length>s.maxArray){n.set(i,e);return}e.forEach((o,l)=>Qa(o,Xd(t,l),n,r+1,s));return}if(rl(e)){const o=Object.keys(e).sort((l,c)=>l.localeCompare(c));if(!o.length){n.set(t||"(root)",{});return}for(const l of o)s.skipPilInfo&&!t&&l==="pil_info"||Qa(e[l],Xd(t,l),n,r+1,s);return}n.set(i,e)}function da(e){if(Array.isArray(e))return e.map(da);if(e&&typeof e=="object")return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,da(n)]));if(typeof e=="string"){const t=e.trim();if(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]")||t.startsWith('"')&&t.endsWith('"'))try{const r=JSON.parse(t);return da(r)}catch{return e}}return e}function kc(e){return e?da(e):null}function Ec(e,t){if(!e)return null;if(!t&&rl(e)&&"pil_info"in e){const n={};for(const[r,s]of Object.entries(e))n[r]=r==="pil_info"?"Hidden (toggle Show PIL info to expand)":s;return n}return e}function Co(e,t=[]){return e===null?{kind:"null",text:"null"}:e===void 0?{kind:"undefined",text:"undefined"}:typeof e=="string"?{kind:"string",text:JSON.stringify(e)}:typeof e=="number"?{kind:"number",text:String(e)}:typeof e=="boolean"?{kind:"boolean",text:e?"true":"false"}:Array.isArray(e)?{kind:"array",items:e.map((n,r)=>Co(n,[...t,r]))}:rl(e)?{kind:"object",entries:Object.keys(e).map(n=>{const r=[...t,n];return{key:n,path:r,value:Co(e[n],r)}})}:{kind:"fallback",text:String(e)}}function jk(e){let t="";for(const n of e)t=Xd(t,n);return t||"(root)"}function Mk(e,t){let n=e;for(const r of t){if(typeof r=="number"){if(!Array.isArray(n))return;n=n[r];continue}if(!rl(n))return;n=n[r]}return n}function Rk(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e;try{return JSON.stringify(e,null,1)}catch{return String(e)}}function Nc(e,t){const n=Mk(e,t);return{pathLabel:jk(t),copyText:Rk(n)}}function jc(e){return!!e&&rl(e)&&"pil_info"in e}function Pk(e,t,n){if(e==null||t==null)return null;const r=new Map,s=new Map,i={maxDepth:n.maxDepth,maxArray:n.maxArray,skipPilInfo:!n.includePilInfo};Qa(e,"",r,0,i),Qa(t,"",s,0,i);const o=new Set([...r.keys(),...s.keys()]),l=[];let c=0,d=0,f=0;const p=Array.from(o).sort((b,C)=>b.localeCompare(C)),h=!n.includePilInfo;for(const b of p){if(h&&Nx(b))continue;const C=r.has(b),y=s.has(b);if(!C&&y){d+=1,l.push({key:b,kind:"onlyB",aText:"",bText:Dl(s.get(b))});continue}if(C&&!y){c+=1,l.push({key:b,kind:"onlyA",aText:Dl(r.get(b)),bText:""});continue}const m=r.get(b),v=s.get(b),g=Ha(m),S=Ha(v);g!==S&&(f+=1,l.push({key:b,kind:"different",aText:Dl(m),bText:Dl(v)}))}const w=Math.max(0,l.length-n.limit);return{entries:w?l.slice(0,n.limit):l,onlyA:c,onlyB:d,different:f,truncatedCount:w}}function Jd(e){const t=["B","KB","MB","GB","TB"];let n=0,r=e;for(;r>=1024&&n<t.length-1;)r/=1024,n+=1;return`${r.toFixed(1)} ${t[n]}`}function jx(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function Mc(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function Tk(e,t=28){if(e.length<=t)return e;const n=Math.max(4,Math.floor((t-1)/2));return`${e.slice(0,n)}${e.slice(-n)}`}const Ik=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"});function Lk(e){const t=e.trim();return!t||/[zZ]|[+-]\d{2}:?\d{2}$/.test(t)?t:`${t.includes("T")?t:t.replace(" ","T")}Z`}function Mx(e){if(!e)return null;const t=Date.parse(Lk(e));return Number.isFinite(t)?t:null}function _k(e,t=Date.now()){const n=Math.max(0,t-e),r=Math.max(1,Math.floor(n/1e3));if(r<60)return`${r} second${r===1?"":"s"} ago`;const s=Math.floor(r/60);if(s<60)return`${s} minute${s===1?"":"s"} ago`;const i=Math.floor(s/60);return`${i} hour${i===1?"":"s"} ago`}function Ak(e){return Ik.format(new Date(e))}function sl({title:e,open:t,onToggle:n,actions:r,children:s,contentClassName:i}){const[o,l]=u.useState(t),[c,d]=u.useState(t?"open":"closed");return u.useEffect(()=>{if(t){l(!0);const p=window.requestAnimationFrame(()=>d("open"));return()=>window.cancelAnimationFrame(p)}d("closing");const f=window.setTimeout(()=>{l(!1),d("closed")},140);return()=>window.clearTimeout(f)},[t]),a.jsxs("div",{className:"border-b border-border/60",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[a.jsxs("button",{type:"button",onClick:n,"aria-expanded":t,className:"flex items-center gap-2 inspector-section-title hover:text-text transition-colors",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`transition-transform ${t?"rotate-90":""}`,"aria-hidden":"true",children:a.jsx("path",{d:"m9 18 6-6-6-6"})}),a.jsx("span",{children:e})]}),r]}),o&&a.jsx("div",{className:"inspector-section-body","data-state":c,"aria-hidden":!t,children:a.jsx("div",{className:i??"px-3 pb-3",children:s})})]})}function zl({copied:e,value:t,className:n="",title:r}){return a.jsxs("span",{className:`ui-kv-value relative inline-block text-right min-w-[80px] ${n}`.trim(),title:r,children:[a.jsx("span",{className:e?"invisible block":"block",children:t}),e&&a.jsx("span",{className:"absolute inset-0 text-right",children:"Copied"})]})}function Fk({open:e,onToggle:t,multi:n,star:r,onSelectStar:s,hasStarConflict:i,onApplyConflict:o,onKeepTheirs:l,currentItem:c,sourceValue:d,sortSpec:f,copiedField:p,onCopyInfo:h,metricsExpanded:w,onToggleMetricsExpanded:x,metricsPreviewLimit:b}){return a.jsxs(sl,{title:"Basics",open:e,onToggle:t,children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs mb-1",role:"radiogroup","aria-label":"Star rating",children:[a.jsx("span",{className:"ui-kv-label w-16 shrink-0",children:n?"Rating (all)":"Rating"}),a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(C=>{const y=(r??0)>=C;return a.jsx("button",{className:`w-6 h-6 flex items-center justify-center rounded-lg border border-border/60 bg-transparent text-[13px] ${y?"text-star-active":"text-star-inactive"} hover:border-border hover:text-star-hover transition-colors`,onClick:()=>{s(r===C&&!n?null:C)},title:`${C} star${C>1?"s":""} (key ${C})`,"aria-label":`${C} star${C>1?"s":""}`,"aria-pressed":r===C,children:y?"":""},C)})})]}),i&&a.jsxs("div",{className:"ui-banner ui-banner-danger mt-2 text-[11px] flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Rating conflict."}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:o,children:"Apply again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:l,children:"Keep theirs"})]})]}),!n&&c&&a.jsxs("div",{className:"text-[12px] space-y-1.5 leading-relaxed",children:[a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("dimensions",`${c.w}${c.h}`),children:"Dimensions"}),a.jsx(zl,{copied:p==="dimensions",value:`${c.w}${c.h}`})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("size",Jd(c.size)),children:"Size"}),a.jsx(zl,{copied:p==="size",value:Jd(c.size)})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("type",c.type),children:"Type"}),a.jsx(zl,{copied:p==="type",value:c.type,className:"break-all"})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>d&&h("source",d),children:"Source"}),a.jsx(zl,{copied:p==="source",value:d,className:"inspector-value-clamp break-words max-w-[70%]",title:d})]}),(()=>{const C=c.metrics||null;if(!C)return null;const y=Object.entries(C).filter(([,I])=>I!=null);if(!y.length)return null;const m=(f==null?void 0:f.kind)==="metric"?f.key:null,v=[...y].sort(([I],[M])=>I.localeCompare(M));let g=v;if(m){const I=v.findIndex(([M])=>M===m);I>0&&(g=[v[I],...v.slice(0,I),...v.slice(I+1)])}const S=g.length>b,T=w||!S?g:g.slice(0,b),j=g.length-b;return a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"ui-subsection-title mb-1",children:"Metrics"}),a.jsxs("div",{className:"space-y-1",children:[T.map(([I,M])=>{const B=m===I;return a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:`w-24 shrink-0 ${B?"text-accent font-medium":"ui-kv-label"}`,children:I}),a.jsx("span",{className:`ui-kv-value text-right ${B?"text-accent font-medium":""}`,children:jx(M)})]},I)}),S&&a.jsx("button",{type:"button",className:"text-[11px] text-muted underline underline-offset-2 hover:text-text",onClick:x,"aria-expanded":w,children:w?"Show less":`+${j} more`})]})]})})()]})]})}const $l=2,Ok={color:"var(--json-string)"},Dk={color:"var(--json-number)"},zk={color:"var(--json-literal)"},$k={color:"var(--json-fallback)"},Bk={color:"var(--json-key)"};function Zd(e,t,n){switch(e.kind){case"null":case"boolean":return a.jsx("span",{style:zk,children:e.text});case"undefined":case"fallback":return a.jsx("span",{style:$k,children:e.text});case"string":return a.jsx("span",{style:Ok,children:e.text});case"number":return a.jsx("span",{style:Dk,children:e.text});case"array":return e.items.length===0?"[]":a.jsxs(a.Fragment,{children:[`[
`,e.items.map((r,s)=>a.jsxs(Jr.Fragment,{children:[" ".repeat(t+$l),Zd(r,t+$l,n),s<e.items.length-1?",":"",`
`]},s))," ".repeat(t),"]"]});case"object":return e.entries.length===0?"{}":a.jsxs(a.Fragment,{children:[`{
`,e.entries.map((r,s)=>a.jsxs(Jr.Fragment,{children:[" ".repeat(t+$l),a.jsx("span",{className:"ui-json-key",style:Bk,onClick:n?i=>{i.stopPropagation(),n(r.path)}:void 0,children:JSON.stringify(r.key)}),": ",Zd(r.value,t+$l,n),s<e.entries.length-1?",":"",`
`]},JSON.stringify(r.path)))," ".repeat(t),"}"]})}}function Rx({node:e,onPathClick:t}){return a.jsx("code",{className:"block whitespace-pre-wrap",children:Zd(e,0,t)})}const Px=Jr.memo(function({compareDiff:t}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-muted",children:[a.jsxs("span",{children:[t.different," ","different"," ",""," ",t.onlyA," ","only A"," ",""," ",t.onlyB," ","only B"]}),a.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:"Deep paths"})]}),t.entries.length===0?a.jsx("div",{className:"text-muted",children:"No differences found."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2 text-[10px] uppercase tracking-wide text-muted",children:[a.jsx("div",{children:"Path"}),a.jsx("div",{children:"A"}),a.jsx("div",{children:"B"})]}),t.entries.map(n=>a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2",children:[a.jsx("div",{className:"text-[11px] text-muted font-mono break-all",children:n.key}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.aText}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.bText})]},n.key)),t.truncatedCount>0&&a.jsxs("div",{className:"text-muted text-[11px]",children:["+",t.truncatedCount," ","more differences not shown."]})]})]})});Px.displayName="CompareDiffTable";const ef=Jr.memo(function({side:t,compareMetaLoaded:n,hasPilInfo:r,showPilInfo:s,onToggleShowPilInfo:i,copied:o,onCopy:l,copiedPath:c,displayNode:d,compareMetaContent:f,onMetaPathCopy:p}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:["Metadata"," ",t]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[r&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:i,disabled:!n,children:s?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:l,disabled:!n,children:o?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[c&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",c]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",children:n&&d?a.jsx(Rx,{node:d,onPathClick:p}):f})]})]})});ef.displayName="CompareMetadataPane";function Uk({open:e,onToggle:t,compareMetaState:n,compareMetaError:r,compareLabelA:s,compareLabelB:i,compareIncludePilInfo:o,onToggleCompareIncludePilInfo:l,onReload:c,compareDiff:d,compareHasPilInfoA:f,compareHasPilInfoB:p,compareShowPilInfoA:h,compareShowPilInfoB:w,onToggleCompareShowPilInfoA:x,onToggleCompareShowPilInfoB:b,compareMetaCopied:C,onCopyCompareMetadata:y,compareValueCopiedPathA:m,compareValueCopiedPathB:v,compareDisplayNodeA:g,compareDisplayNodeB:S,compareMetaContent:E,onCompareMetaPathCopyA:T,onCompareMetaPathCopyB:j}){const I=n==="loaded";return a.jsx(sl,{title:"Compare Metadata",open:e,onToggle:t,actions:a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:c,disabled:n==="loading",children:n==="loading"?"Loading":"Reload"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:l,disabled:!I,children:o?"Hide PIL info":"Include PIL info"})]}),children:a.jsxs("div",{className:"space-y-2 text-[11px]",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] text-muted",children:[a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"A"}),a.jsx("div",{className:"text-text break-all",title:s,children:s})]}),a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"B"}),a.jsx("div",{className:"text-text break-all",title:i,children:i})]})]}),n==="loading"&&a.jsx("div",{className:"text-muted",children:"Loading metadata"}),n==="error"&&r&&a.jsx("div",{className:"text-danger break-words",children:r}),I&&d&&a.jsx(Px,{compareDiff:d}),a.jsxs("div",{className:"grid gap-3 pt-2",children:[a.jsx(ef,{side:"A",compareMetaLoaded:I,hasPilInfo:f,showPilInfo:h,onToggleShowPilInfo:x,copied:C==="A",onCopy:()=>y("A"),copiedPath:m,displayNode:g,compareMetaContent:E,onMetaPathCopy:T}),a.jsx(ef,{side:"B",compareMetaLoaded:I,hasPilInfo:p,showPilInfo:w,onToggleShowPilInfo:b,copied:C==="B",onCopy:()=>y("B"),copiedPath:v,displayNode:S,compareMetaContent:E,onMetaPathCopy:j})]})]})})}const Tx=Jr.memo(Uk);Tx.displayName="CompareMetadataSection";function Vk({open:e,onToggle:t,metadataLoading:n,metadataActionLabel:r,onMetadataAction:s,metadataActionDisabled:i,hasPilInfo:o,showPilInfo:l,onToggleShowPilInfo:c,metaValueCopiedPath:d,metaHeightClass:f,metaLoaded:p,metaDisplayNode:h,metaContent:w,metaError:x,onMetaPathCopy:b}){const C=a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[p&&o&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:c,disabled:!p,children:l?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[78px]",onClick:s,disabled:i||n,children:r})]});return a.jsxs(sl,{title:"Metadata",open:e,onToggle:t,actions:C,children:[a.jsxs("div",{className:"relative",children:[d&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",d]}),a.jsx("pre",{className:`ui-code-block ui-code-block-resizable ${f} overflow-auto whitespace-pre-wrap`,children:p&&h?a.jsx(Rx,{node:h,onPathClick:b}):w})]}),x&&a.jsx("div",{className:"text-[11px] text-danger mt-1 break-words",children:x})]})}const Ix=Jr.memo(Vk);Ix.displayName="MetadataSection";function Wk({open:e,onToggle:t,multi:n,showConflictBanner:r,onApplyConflict:s,onKeepTheirs:i,notes:o,onNotesChange:l,onNotesBlur:c,tags:d,onTagsChange:f,onTagsBlur:p}){return a.jsxs(sl,{title:"Notes & Tags",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",children:[r&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Conflicting edits detected."}),a.jsx("div",{className:"text-[11px] text-muted mt-0.5",children:"Your changes were not saved because this item was updated elsewhere."}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:s,children:"Apply my changes again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:i,children:"Keep theirs"})]})]}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full scrollbar-thin",placeholder:"Add notes",value:o,onChange:h=>l(h.target.value),onBlur:c,"aria-label":n?"Notes for selected items":"Notes"}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:n?"Tags (apply to all, comma-separated)":"Tags (comma-separated)"}),a.jsx("input",{className:"ui-input inspector-input w-full",placeholder:"tag1, tag2",value:d,onChange:h=>f(h.target.value),onBlur:p,"aria-label":n?"Tags for selected items":"Tags"})]})]})}function Hk(e){return e===2?null:e>2?`Side-by-side view supports exactly 2 selections (selected ${e}).`:"Select exactly 2 images to open side-by-side view."}function Qk({selectedCount:e,compareActive:t,onOpenCompare:n}){const r=Hk(e),s=!n||t||r!==null,i=t?"Side-by-side viewer is already open.":r??"Open side by side to compare selected images.";return a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Selection Actions"}),a.jsx("div",{className:"flex flex-wrap items-center gap-2",children:a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>n==null?void 0:n(),disabled:s,children:"Side by side view"})}),a.jsx("div",{className:"text-[11px] text-muted",children:i})]})}const Om=2,Lx=12,Dm=120,zm=!0,Qo="Comparison export (v1) requires exactly 2 selected images.",Kk=`Comparison export (v2) requires between 2 and ${Lx} selected images.`,_x="Comparison export for more than 2 selections is unavailable on this server.";function Ax(e,t){return`Comparison export (v2) supports up to ${e} selections (selected ${t}).`}function qk(e){return e.replace(/[\u0000-\u001f\u007f]/g,"").trim()}function Gk(e){const n=e.replace(/\r\n?/g,`
`).replace(/\n+$/g,"");return n?n.split(`
`):[]}function Yk(e){if(e.length!==0)return e.length===1?[e[0]]:[e[0],e[1]]}function Xk(e){return e.map(t=>t.trim()).filter(t=>t.length>0)}function Fx(e,t){const{maxLines:n,tooManyLinesMessage:r}=t,s=Gk(e);if(s.length>n)return{ok:!1,message:r};const i=s.map(l=>qk(l));return i.some(l=>l.length>Dm)?{ok:!1,message:`Each label must be at most ${Dm} characters.`}:i.some(l=>l.length>0)?{ok:!0,labels:i}:{ok:!0,labels:void 0}}function Jk(e){const{pathA:t,pathB:n,labelsText:r,embedMetadata:s,reverseOrder:i}=e;if(!t||!n)return{ok:!1,message:Qo};const o=Fx(r,{maxLines:Om,tooManyLinesMessage:`Enter at most ${Om} label lines (line 1 = A, line 2 = B).`});if(!o.ok)return o;const l={v:1,paths:[t,n],embed_metadata:s,reverse_order:i};return o.labels&&(l.labels=Yk(o.labels)),{ok:!0,payload:l}}function Zk(e){const{paths:t,labelsText:n,embedMetadata:r,reverseOrder:s}=e,i=Xk(t);if(i.length!==t.length||i.length<2||i.length>Lx)return{ok:!1,message:Kk};const o=Fx(n,{maxLines:i.length,tooManyLinesMessage:`Enter at most ${i.length} label lines (one per selected image).`});if(!o.ok)return o;const l={v:2,paths:i,embed_metadata:r,reverse_order:s};return o.labels&&(l.labels=o.labels),{ok:!0,payload:l}}function io(e){return String(e).padStart(2,"0")}function eE(e,t=new Date){const n=t.getUTCFullYear(),r=io(t.getUTCMonth()+1),s=io(t.getUTCDate()),i=io(t.getUTCHours()),o=io(t.getUTCMinutes()),l=io(t.getUTCSeconds());return`comparison${e?"_reverse":""}_${n}${r}${s}_${i}${o}${l}.png`}function tE({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r}){return e<2?`Comparison export requires at least 2 selections (selected ${e}).`:e===2?t?null:Qo:!n||r===null?_x:e>r?Ax(r,e):null}function nE({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r,compareExportLabelsText:s,onCompareExportLabelsTextChange:i,compareExportEmbedMetadata:o,onCompareExportEmbedMetadataChange:l,compareExportBusy:c,compareExportMode:d,onComparisonExport:f,compareExportError:p}){const h=tE({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r}),w=c||h!==null,x=e>2?`Label for image 1
Label for image 2
...`:`Label for A
Label for B`;return a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Selection Export"}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full h-20 scrollbar-thin",placeholder:x,value:s,onChange:b=>i(b.target.value),disabled:w,"aria-label":"Selection export labels"}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-[11px] text-muted",children:[a.jsx("input",{type:"checkbox",checked:o,onChange:b=>l(b.target.checked),disabled:w}),a.jsx("span",{children:"Embed metadata"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>f(!1),disabled:w,children:d==="normal"?"Exporting":"Export comparison"}),a.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",onClick:()=>f(!0),disabled:w,children:d==="reverse"?"Exporting":"Export (reverse order)"})]}),h&&a.jsx("div",{className:"text-[11px] text-muted",children:h}),p&&a.jsx("div",{className:"text-danger break-words",children:p})]})}const rE=[{id:"selectionActions",isVisible:()=>!0,render:({selectionActionsProps:e})=>a.jsx(Qk,{...e})},{id:"selectionExport",isVisible:({compareActive:e})=>!e,render:({selectionExportProps:e})=>a.jsx(nE,{...e})}];function sE({open:e,onToggle:t,multi:n,selectedCount:r,totalSize:s,filename:i,compareActive:o,compareReady:l,onOpenCompare:c,compareExportSupportsV2:d,compareExportMaxPathsV2:f,compareExportLabelsText:p,onCompareExportLabelsTextChange:h,compareExportEmbedMetadata:w,onCompareExportEmbedMetadataChange:x,compareExportBusy:b,compareExportMode:C,onComparisonExport:y,compareExportError:m,onFindSimilar:v,canFindSimilar:g,findSimilarDisabledReason:S}){const E={compareActive:o,selectionActionsProps:{selectedCount:r,compareActive:o,onOpenCompare:c},selectionExportProps:{selectedCount:r,compareReady:l,compareExportSupportsV2:d,compareExportMaxPathsV2:f,compareExportLabelsText:p,onCompareExportLabelsTextChange:h,compareExportEmbedMetadata:w,onCompareExportEmbedMetadataChange:x,compareExportBusy:b,compareExportMode:C,onComparisonExport:y,compareExportError:m}};return a.jsxs(sl,{title:n?"Selection":"Item",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",actions:v&&a.jsx("button",{type:"button",className:"btn btn-sm",onClick:v,disabled:!g,title:S??"Find similar",children:"Find similar"}),children:[n?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Selected"}),a.jsxs("div",{className:"inspector-field-value",children:[r," files"]})]}),a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Total size"}),a.jsx("div",{className:"inspector-field-value",children:Jd(s)})]})]}),rE.filter(T=>T.isVisible(E)).map(T=>a.jsx(u.Fragment,{children:T.render(E)},T.id))]}):a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Filename"}),a.jsx("div",{className:"inspector-field-value break-all",title:i,children:i})]}),S&&a.jsx("div",{className:"text-[11px] text-muted",children:S})]})}const iE=[{id:"overview",isVisible:()=>!0,render:({overviewProps:e})=>a.jsx(sE,{...e})},{id:"compareMetadata",isVisible:({compareActive:e,compareReady:t})=>e&&t,render:({compareMetadataProps:e})=>a.jsx(Tx,{...e})},{id:"basics",isVisible:()=>!0,render:({basicsProps:e})=>a.jsx(Fk,{...e})},{id:"metadata",isVisible:({multi:e})=>!e,render:({metadataProps:e})=>a.jsx(Ix,{...e})},{id:"notes",isVisible:()=>!0,render:({notesProps:e})=>a.jsx(Wk,{...e})}];function oE(e,t){const n=lE(e)||"view",r=new Set(t.map(i=>i.id));if(!r.has(n))return n;let s=2;for(;r.has(`${n}-${s}`);)s+=1;return`${n}-${s}`}function lE(e){return e.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function Rc(e){const t=e.filter(s=>s>0).sort((s,i)=>i-s),n=e.includes(0),r=[...t.map(s=>String(s))];return n&&r.push("None"),r.join(", ")}function aE(e,t){return e&&t?`${e} to ${t}`:e?`from ${e}`:t?`to ${t}`:""}function uE(e){if(e==="/"||e==="")return"Root";const t=e.split("/").filter(Boolean);return t.length?t.length<=2?`/${t.join("/")}`:`.../${t.slice(-2).join("/")}`:"Root"}function cE(e,t,n,r){return!n||r?t:e==="/"||e===""?e||"/":n===e||n.startsWith(`${e}/`)?e:t}function dE(e,t){return`${$m(e)}${$m(t)}`}function $m(e){const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function fE(e){const t=e.toLowerCase();return t.endsWith(".png")?"image/png":t.endsWith(".webp")?"image/webp":"image/jpeg"}function hE(e,t){const n=e.split("/").pop()??e;return{path:e,name:n,type:fE(e),w:0,h:0,size:0,hasThumb:!0,hasMeta:!1,star:t??null}}function ko(e,t){const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}function pE({selectedPaths:e,comparePathA:t,comparePathB:n}){if(e.length!==2)return null;if(t&&n)return[t,n];const[r,s]=e;return!r||!s?null:[r,s]}function mE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s,labelsText:i,embedMetadata:o,reverseOrder:l}){const c=e.length;if(c<2)return{ok:!1,message:Qo};if(c===2){const d=pE({selectedPaths:e,comparePathA:t,comparePathB:n});if(!d)return{ok:!1,message:Qo};const[f,p]=d;return Jk({pathA:f,pathB:p,labelsText:i,embedMetadata:o,reverseOrder:l})}return r?s!==null&&c>s?{ok:!1,message:Ax(s,c)}:Zk({paths:e,labelsText:i,embedMetadata:o,reverseOrder:l}):{ok:!1,message:_x}}function gE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s}){const[i,o]=u.useState(""),[l,c]=u.useState(zm),[d,f]=u.useState(null),[p,h]=u.useState(null),w=d!==null;u.useEffect(()=>{if(e.length<2){o(""),c(zm),f(null),h(null);return}f(null),h(null)},[t,n,e]);const x=u.useCallback(y=>{o(y),h(null)},[]),b=u.useCallback(y=>{c(y)},[]),C=u.useCallback(async y=>{if(w)return;if(e.length<2){h(Qo);return}const v=mE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s,labelsText:i,embedMetadata:l,reverseOrder:y});if(!v.ok){h(v.message);return}f(y?"reverse":"normal"),h(null);try{const g=await me.exportComparison(v.payload);ko(g,eE(y))}catch(g){const S=g instanceof Error?g.message:"Failed to export comparison.";h(S)}finally{f(null)}},[w,l,i,s,r,t,n,e]);return{compareExportLabelsText:i,compareExportEmbedMetadata:l,compareExportMode:d,compareExportError:p,compareExportBusy:w,handleCompareExportLabelsTextChange:x,handleCompareExportEmbedMetadataChange:b,runComparisonExport:C}}function Bm(e,t){return e?`${e}::${t??""}`:null}function Um(e,t,n){return!e||!t||!n?null:`${t}::${n}`}function Ka({activeRequestId:e,responseRequestId:t,activeContextKey:n,responseContextKey:r}){return e===t&&n===r}function yE({compareReady:e,comparePathA:t,comparePathB:n}){const[r,s]=u.useState("idle"),[i,o]=u.useState(null),[l,c]=u.useState(null),[d,f]=u.useState(null),[p,h]=u.useState(!1),[w,x]=u.useState(!1),[b,C]=u.useState(!1),y=Um(e,t,n),m=u.useRef(0),v=u.useRef(y);v.current=y;const g=u.useCallback(async(E,T,j)=>{const I=m.current+1;m.current=I,s("loading"),o(null);try{const[M,B]=await Promise.all([me.getMetadata(E),me.getMetadata(T)]);if(!Ka({activeRequestId:m.current,responseRequestId:I,activeContextKey:v.current,responseContextKey:j}))return;c(M.meta),f(B.meta),s("loaded")}catch(M){if(!Ka({activeRequestId:m.current,responseRequestId:I,activeContextKey:v.current,responseContextKey:j}))return;const B=M instanceof Error?M.message:"Failed to load metadata";c(null),f(null),o(B),s("error")}},[]);u.useEffect(()=>{if(m.current+=1,!y||!t||!n){s("idle"),o(null),c(null),f(null),x(!1),C(!1);return}h(!1),x(!1),C(!1),g(t,n,y)},[y,t,n,g]);const S=u.useCallback(()=>{const E=Um(e,t,n);!E||!t||!n||g(t,n,E)},[e,t,n,g]);return{compareMetaState:r,compareMetaError:i,compareMetaA:l,compareMetaB:d,compareIncludePilInfo:p,compareShowPilInfoA:w,compareShowPilInfoB:b,setCompareIncludePilInfo:h,setCompareShowPilInfoA:x,setCompareShowPilInfoB:C,reloadCompareMetadata:S}}function vE({path:e,sidecarUpdatedAt:t}){const[n,r]=u.useState(null),[s,i]=u.useState(null),[o,l]=u.useState("idle"),[c,d]=u.useState(!1),f=Bm(e,t),p=u.useRef(0),h=u.useRef(f);h.current=f,u.useEffect(()=>{p.current+=1,r(null),i(null),l("idle"),d(!1)},[f]);const w=u.useCallback(async()=>{const x=Bm(e,t);if(!x||!e)return;const b=p.current+1;p.current=b,l("loading"),i(null);try{const C=await me.getMetadata(e);if(!Ka({activeRequestId:p.current,responseRequestId:b,activeContextKey:h.current,responseContextKey:x}))return;r(C.meta),l("loaded")}catch(C){if(!Ka({activeRequestId:p.current,responseRequestId:b,activeContextKey:h.current,responseContextKey:x}))return;const y=C instanceof Error?C.message:"Failed to load metadata";r(null),i(y),l("error")}},[e,t]);return{metaRaw:n,metaError:s,metaState:o,showPilInfo:c,setMetaError:i,setShowPilInfo:d,fetchMetadata:w}}function xE({path:e,sidecarUpdatedAt:t,selectedPaths:n,compareReady:r,comparePathA:s,comparePathB:i,compareExportSupportsV2:o,compareExportMaxPathsV2:l}){const c=vE({path:e,sidecarUpdatedAt:t}),d=yE({compareReady:r,comparePathA:s,comparePathB:i}),f=gE({selectedPaths:n,comparePathA:s,comparePathB:i,compareExportSupportsV2:o,compareExportMaxPathsV2:l});return{metaRaw:c.metaRaw,metaError:c.metaError,metaState:c.metaState,showPilInfo:c.showPilInfo,setMetaError:c.setMetaError,compareMetaState:d.compareMetaState,compareMetaError:d.compareMetaError,compareMetaA:d.compareMetaA,compareMetaB:d.compareMetaB,compareIncludePilInfo:d.compareIncludePilInfo,compareShowPilInfoA:d.compareShowPilInfoA,compareShowPilInfoB:d.compareShowPilInfoB,compareExportLabelsText:f.compareExportLabelsText,compareExportEmbedMetadata:f.compareExportEmbedMetadata,compareExportMode:f.compareExportMode,compareExportError:f.compareExportError,compareExportBusy:f.compareExportBusy,setShowPilInfo:c.setShowPilInfo,setCompareIncludePilInfo:d.setCompareIncludePilInfo,setCompareShowPilInfoA:d.setCompareShowPilInfoA,setCompareShowPilInfoB:d.setCompareShowPilInfoB,fetchMetadata:c.fetchMetadata,reloadCompareMetadata:d.reloadCompareMetadata,handleCompareExportLabelsTextChange:f.handleCompareExportLabelsTextChange,handleCompareExportEmbedMetadataChange:f.handleCompareExportEmbedMetadataChange,runComparisonExport:f.runComparisonExport}}function Bl(e){return{notes:(e==null?void 0:e.notes)??"",tags:((e==null?void 0:e.tags)??[]).join(", ")}}function qa(e){return e.split(",").map(t=>t.trim()).filter(Boolean)}function wE(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function bE(e,t){return e!==t}function SE(e,t){return!wE(qa(e),qa(t))}function CE({path:e,selectedPaths:t,multi:n,sidecar:r,conflict:s,star:i,queryClient:o,mutateSidecar:l,onStarChanged:c,onLocalTypingChange:d}){const[f,p]=u.useState(""),[h,w]=u.useState(""),x=u.useRef(!1),b=u.useRef(!1),C=u.useRef(!1),y=u.useRef(Bl(void 0)),m=u.useCallback(F=>{x.current!==F&&(x.current=F,d==null||d(F))},[d]),v=u.useCallback(F=>{y.current=F,b.current=!1,C.current=!1,p(F.tags),w(F.notes),m(!1)},[m]);u.useEffect(()=>{if(!e){v(Bl(void 0));return}v(Bl(r))},[e,v,r==null?void 0:r.updated_at,r==null?void 0:r.version]),u.useEffect(()=>()=>{m(!1)},[m]);const g=u.useCallback(F=>{if(n&&t.length){kx(t,F);return}e&&l(F,(r==null?void 0:r.version)??1)},[n,l,e,t,r==null?void 0:r.version]),S=u.useMemo(()=>({tags:!!(s!=null&&s.pending.set_tags),notes:(s==null?void 0:s.pending.set_notes)!==void 0,star:(s==null?void 0:s.pending.set_star)!==void 0}),[s]),E=u.useCallback(F=>{w(F),b.current=!0,m(!0)},[m]),T=u.useCallback(()=>{const F=b.current;b.current=!1,F&&bE(h,y.current.notes)&&(g({notes:h}),y.current={...y.current,notes:h}),m(!1)},[g,h,m]),j=u.useCallback(F=>{p(F),C.current=!0,m(!0)},[m]),I=u.useCallback(()=>{const F=C.current;C.current=!1,F&&SE(f,y.current.tags)&&(g({tags:qa(f)}),y.current={...y.current,tags:f}),m(!1)},[g,m,f]),M=u.useCallback(()=>{if(!s||!e)return;const F={};s.pending.set_tags!==void 0&&(F.tags=qa(f)),s.pending.set_notes!==void 0&&(F.notes=h),s.pending.set_star!==void 0&&(F.star=i??null),l(F,s.current.version??1)},[s,l,h,e,i,f]),B=u.useCallback(()=>{if(!s||!e)return;const F=s.current,Q=Bl(F);y.current=Q,b.current=!1,C.current=!1,p(Q.tags),w(Q.notes),m(!1),o.setQueryData(Wo(e),F),wu(e),c==null||c([e],F.star??null)},[s,m,c,e,o]);return{tags:f,notes:h,conflictFields:S,commitSidecar:g,applyConflict:M,keepTheirs:B,handleNotesChange:E,handleNotesBlur:T,handleTagsChange:j,handleTagsBlur:I}}const kE=["overview","compare","basics","metadata","notes"],Vm="lenslet.inspector.sections",Wm="lenslet.inspector.metricsExpanded",EE={overview:!0,compare:!0,metadata:!0,basics:!0,notes:!0};function Kt(e){e.current!==null&&(window.clearTimeout(e.current),e.current=null)}function NE({path:e,sidecarUpdatedAt:t,compareReady:n,comparePathA:r,comparePathB:s}){const[i,o]=u.useState(EE),[l,c]=u.useState(!1),[d,f]=u.useState(null),[p,h]=u.useState(!1),[w,x]=u.useState(null),[b,C]=u.useState(null),[y,m]=u.useState(null),[v,g]=u.useState(null),S=u.useRef(null),E=u.useRef(null),T=u.useRef(null),j=u.useRef(null),I=u.useRef(null),M=u.useCallback(U=>{o(_=>({..._,[U]:!_[U]}))},[]),B=u.useCallback(()=>M("overview"),[M]),F=u.useCallback(()=>M("compare"),[M]),Q=u.useCallback(()=>M("basics"),[M]),ee=u.useCallback(()=>M("metadata"),[M]),z=u.useCallback(()=>M("notes"),[M]),L=u.useCallback(()=>{c(U=>!U)},[]),R=u.useCallback(U=>{f(U),Kt(S),S.current=window.setTimeout(()=>{f(_=>_===U?null:_),S.current=null},1e3)},[]),P=u.useCallback(()=>{h(!0),Kt(E),E.current=window.setTimeout(()=>{h(!1),E.current=null},1200)},[]),A=u.useCallback(U=>{x(U),Kt(T),T.current=window.setTimeout(()=>{x(null),T.current=null},900)},[]),O=u.useCallback(U=>{C(U),Kt(j),j.current=window.setTimeout(()=>{C(_=>_===U?null:_),j.current=null},1200)},[]),K=u.useCallback((U,_)=>{U==="A"?m(_):g(_),Kt(I),I.current=window.setTimeout(()=>{m(null),g(null),I.current=null},900)},[]);return u.useEffect(()=>{try{const U=localStorage.getItem(Vm);if(!U)return;const _=JSON.parse(U);if(!_||typeof _!="object")return;const G={};for(const V of kE)typeof _[V]=="boolean"&&(G[V]=_[V]);Object.keys(G).length>0&&o(V=>({...V,...G}))}catch{}},[]),u.useEffect(()=>{try{localStorage.setItem(Vm,JSON.stringify(i))}catch{}},[i]),u.useEffect(()=>{try{const U=localStorage.getItem(Wm);U==="1"||U==="true"?c(!0):(U==="0"||U==="false")&&c(!1)}catch{}},[]),u.useEffect(()=>{try{localStorage.setItem(Wm,l?"1":"0")}catch{}},[l]),u.useEffect(()=>{h(!1),x(null),Kt(E),Kt(T)},[e,t]),u.useEffect(()=>{C(null),m(null),g(null),Kt(j),Kt(I)},[r,s,n]),u.useEffect(()=>()=>{Kt(S),Kt(E),Kt(T),Kt(j),Kt(I)},[]),{openSections:i,toggleOverviewSection:B,toggleCompareSection:F,toggleBasicsSection:Q,toggleMetadataSection:ee,toggleNotesSection:z,metricsExpanded:l,toggleMetricsExpanded:L,copiedField:d,markInfoCopied:R,metaCopied:p,markMetadataCopied:P,metaValueCopiedPath:w,markMetadataValueCopied:A,compareMetaCopied:b,markCompareMetadataCopied:O,compareValueCopiedPathA:y,compareValueCopiedPathB:v,markCompareMetadataValueCopied:K}}const jE=12,ME=120,RE=8,PE=80;function TE({path:e,selectedPaths:t=[],items:n=[],compareActive:r=!1,compareA:s=null,compareB:i=null,onOpenCompare:o,onResize:l,onStarChanged:c,sortSpec:d,onFindSimilar:f,embeddingsAvailable:p=!1,embeddingsLoading:h=!1,compareExportSupportsV2:w=!1,compareExportMaxPathsV2:x=null,onLocalTypingChange:b}){const C=!!e,{data:y}=kk(e??""),m=Ek(e??""),v=wr(),g=t.length>1,S=!!f&&p&&!g,E=f?p?g?"Select a single image to search.":null:h?"Loading embeddings...":"No embeddings detected.":null,j=u.useMemo(()=>{var ve;return((ve=n.find(Xe=>Xe.path===e))==null?void 0:ve.star)??null},[n,e])??(y==null?void 0:y.star)??null,I=gk(g?null:e),M=(s==null?void 0:s.path)??null,B=(i==null?void 0:i.path)??null,F=t.length===2&&!!t[0]&&!!t[1],ee=r&&(!!M&&!!B),{openSections:z,toggleOverviewSection:L,toggleCompareSection:R,toggleBasicsSection:P,toggleMetadataSection:A,toggleNotesSection:O,metricsExpanded:K,toggleMetricsExpanded:U,copiedField:_,markInfoCopied:G,metaCopied:V,markMetadataCopied:J,metaValueCopiedPath:se,markMetadataValueCopied:Y,compareMetaCopied:q,markCompareMetadataCopied:H,compareValueCopiedPathA:fe,compareValueCopiedPathB:Te,markCompareMetadataValueCopied:we}=NE({path:e,sidecarUpdatedAt:y==null?void 0:y.updated_at,comparePathA:M,comparePathB:B,compareReady:ee}),he=ee&&r&&z.compare,ze=!g&&z.metadata,Ue=(s==null?void 0:s.name)??M??"A",Tt=(i==null?void 0:i.name)??B??"B",Bt=u.useCallback((te,ve)=>{m.mutate({patch:te,baseVersion:ve,idempotencyKey:yu("patch")})},[m]),{tags:Ut,notes:Dn,conflictFields:tn,commitSidecar:Cn,applyConflict:Vt,keepTheirs:le,handleNotesChange:oe,handleNotesBlur:ge,handleTagsChange:Ie,handleTagsBlur:Se}=CE({path:e,selectedPaths:t,multi:g,sidecar:y,conflict:I,star:j,queryClient:v,mutateSidecar:Bt,onStarChanged:c,onLocalTypingChange:b}),{metaRaw:ce,metaError:Fe,metaState:Ge,showPilInfo:et,setMetaError:kn,compareMetaState:gt,compareMetaError:zn,compareMetaA:Ce,compareMetaB:rt,compareIncludePilInfo:dn,compareShowPilInfoA:$n,compareShowPilInfoB:Wt,compareExportLabelsText:Bi,compareExportEmbedMetadata:D,compareExportMode:X,compareExportError:ae,compareExportBusy:ye,setShowPilInfo:be,setCompareIncludePilInfo:Ee,setCompareShowPilInfoA:ie,setCompareShowPilInfoB:Ne,fetchMetadata:pe,reloadCompareMetadata:it,handleCompareExportLabelsTextChange:Oe,handleCompareExportEmbedMetadataChange:yt,runComparisonExport:Ht}=xE({path:e,sidecarUpdatedAt:y==null?void 0:y.updated_at,selectedPaths:t,compareReady:ee,comparePathA:M,comparePathB:B,compareExportSupportsV2:w,compareExportMaxPathsV2:x}),En=u.useMemo(()=>{const te=new Set(t);return n.filter(ve=>te.has(ve.path))},[n,t]),fn=u.useMemo(()=>En.reduce((te,ve)=>te+(ve.size||0),0),[En]);u.useEffect(()=>{if(!e)return;const te=ve=>{if(dh(ve.target))return;const Xe=ve.key;if(!/^[0-5]$/.test(Xe))return;ve.preventDefault();const tr=Xe==="0"?null:Number(Xe);if(g&&t.length){Cn({star:tr}),c==null||c(t,tr);return}Cn({star:tr}),c==null||c([e],tr)};return window.addEventListener("keydown",te),()=>window.removeEventListener("keydown",te)},[e,g,t,Cn,c]);const Ye=hs(e?()=>me.getThumb(e):null,[e]),Bn=e?e.split("/").pop()||e:"",Ui=u.useMemo(()=>{var ve;if(Bn.includes("."))return Bn.slice(Bn.lastIndexOf(".")+1).toUpperCase();const te=n.find(Xe=>Xe.path===e);return(ve=te==null?void 0:te.type)!=null&&ve.includes("/")?te.type.split("/")[1].toUpperCase():""},[Bn,n,e]),vt=u.useMemo(()=>n.find(te=>te.path===e),[n,e]),St=u.useMemo(()=>e?(vt==null?void 0:vt.source)??e:"",[vt,e]),Ct=u.useMemo(()=>{if(!ce)return"";try{return JSON.stringify(ce,null,1)}catch{return""}},[ce]),Qt=u.useMemo(()=>kc(ce),[ce]),Fs=u.useMemo(()=>kc(Ce),[Ce]),Un=u.useMemo(()=>kc(rt),[rt]),Zn=u.useMemo(()=>Ec(Qt,et),[Qt,et]),il=u.useMemo(()=>{if(!Ce)return"";try{return JSON.stringify(Ce,null,1)}catch{return""}},[Ce]),Vi=u.useMemo(()=>{if(!rt)return"";try{return JSON.stringify(rt,null,1)}catch{return""}},[rt]),Vn=u.useMemo(()=>Ec(Fs,$n),[Fs,$n]),er=u.useMemo(()=>Ec(Un,Wt),[Un,Wt]),ol=u.useCallback(()=>{var te;Ct&&((te=navigator.clipboard)==null||te.writeText(Ct).then(()=>{J()}).catch(ve=>{const Xe=ve instanceof Error?ve.message:"Copy failed";kn(Xe)}))},[J,Ct,kn]),Su=u.useMemo(()=>!ze||!Zn?null:Co(Zn),[ze,Zn]),Cu=u.useMemo(()=>!he||!Vn?null:Co(Vn),[he,Vn]),ku=u.useMemo(()=>!he||!er?null:Co(er),[he,er]),Wi=u.useCallback((te,ve)=>{var Xe;(Xe=navigator.clipboard)==null||Xe.writeText(ve).then(()=>{Y(te)}).catch(()=>{})},[Y]),ss=u.useCallback((te,ve,Xe)=>{var tr;(tr=navigator.clipboard)==null||tr.writeText(Xe).then(()=>{we(te,ve)}).catch(()=>{})},[we]),Eu=u.useCallback(te=>{if(!Zn)return;const ve=Nc(Zn,te);Wi(ve.pathLabel,ve.copyText)},[Zn,Wi]),Nu=u.useCallback(te=>{if(!Vn)return;const ve=Nc(Vn,te);ss("A",ve.pathLabel,ve.copyText)},[Vn,ss]),ju=u.useCallback(te=>{if(!er)return;const ve=Nc(er,te);ss("B",ve.pathLabel,ve.copyText)},[er,ss]),ll=u.useCallback(te=>{var Xe;const ve=te==="A"?il:Vi;ve&&((Xe=navigator.clipboard)==null||Xe.writeText(ve).then(()=>{H(te)}).catch(()=>{}))},[il,Vi,H]);let Os=Zn?"":"PNG metadata not loaded yet.";Ge==="loading"?Os="Loading metadata":Ge==="error"&&Fe&&(Os=Fe);let Hi="Metadata not loaded yet.";gt==="loading"?Hi="Loading metadata":gt==="error"&&zn&&(Hi=zn);const al=Ge==="loading",br=Ge==="loaded"&&!!Ct,ul=br?"h-48":"h-24";let Ds="Load meta";al?Ds="Loading":br&&(Ds=V?"Copied":"Copy");const Mu=br?ol:pe,cl=jc(ce),dl=jc(Ce),Ru=jc(rt),zs=u.useMemo(()=>he?Pk(Fs,Un,{includePilInfo:dn,limit:ME,maxDepth:RE,maxArray:PE}):null,[he,Fs,Un,dn]),fl=u.useCallback((te,ve)=>{var Xe;ve&&((Xe=navigator.clipboard)==null||Xe.writeText(ve).then(()=>{G(te)}).catch(()=>{}))},[G]),Pu=u.useCallback(te=>{if(g&&t.length){c==null||c(t,te),kx(t,{star:te});return}e&&(c==null||c([e],te),Ex(e,{star:te}))},[g,c,e,t]),$s=u.useCallback(()=>{be(te=>!te)},[be]),Tu=u.useCallback(()=>{Ee(te=>!te)},[Ee]),Iu=u.useCallback(()=>{ie(te=>!te)},[ie]),Lu=u.useCallback(()=>{Ne(te=>!te)},[Ne]),_u=u.useCallback(te=>{Ht(te)},[Ht]),Au=!g&&!!I&&(tn.tags||tn.notes),Fu=!g&&!!I&&tn.star,hl="toolbar-offset sidebar-resize-handle sidebar-resize-handle-right absolute bottom-0";if(!C)return a.jsx("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:a.jsx("div",{className:hl,onPointerDown:l})});const Qi={multi:g,compareActive:r,compareReady:ee,overviewProps:{open:z.overview,onToggle:L,multi:g,selectedCount:t.length,totalSize:fn,filename:Bn,compareActive:r,compareReady:F,onOpenCompare:o,compareExportSupportsV2:w,compareExportMaxPathsV2:x,compareExportLabelsText:Bi,onCompareExportLabelsTextChange:Oe,compareExportEmbedMetadata:D,onCompareExportEmbedMetadataChange:yt,compareExportBusy:ye,compareExportMode:X,onComparisonExport:_u,compareExportError:ae,onFindSimilar:f,canFindSimilar:S,findSimilarDisabledReason:E},compareMetadataProps:{open:z.compare,onToggle:R,compareMetaState:gt,compareMetaError:zn,compareLabelA:Ue,compareLabelB:Tt,compareIncludePilInfo:dn,onToggleCompareIncludePilInfo:Tu,onReload:it,compareDiff:zs,compareHasPilInfoA:dl,compareHasPilInfoB:Ru,compareShowPilInfoA:$n,compareShowPilInfoB:Wt,onToggleCompareShowPilInfoA:Iu,onToggleCompareShowPilInfoB:Lu,compareMetaCopied:q,onCopyCompareMetadata:ll,compareValueCopiedPathA:fe,compareValueCopiedPathB:Te,compareDisplayNodeA:Cu,compareDisplayNodeB:ku,compareMetaContent:Hi,onCompareMetaPathCopyA:Nu,onCompareMetaPathCopyB:ju},basicsProps:{open:z.basics,onToggle:P,multi:g,star:j,onSelectStar:Pu,hasStarConflict:Fu,onApplyConflict:Vt,onKeepTheirs:le,currentItem:vt??null,sourceValue:St,sortSpec:d,copiedField:_,onCopyInfo:fl,metricsExpanded:K,onToggleMetricsExpanded:U,metricsPreviewLimit:jE},metadataProps:{open:z.metadata,onToggle:A,metadataLoading:al,metadataActionLabel:Ds,onMetadataAction:Mu,metadataActionDisabled:!e,hasPilInfo:cl,showPilInfo:et,onToggleShowPilInfo:$s,metaValueCopiedPath:se,metaHeightClass:ul,metaLoaded:br,metaDisplayNode:Su,metaContent:Os,metaError:Fe,onMetaPathCopy:Eu},notesProps:{open:z.notes,onToggle:O,multi:g,showConflictBanner:Au,onApplyConflict:Vt,onKeepTheirs:le,notes:Dn,onNotesChange:oe,onNotesBlur:ge,tags:Ut,onTagsChange:Ie,onTagsBlur:Se}};return a.jsxs("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:[!g&&a.jsx("div",{className:"p-3 border-b border-border flex justify-center",children:a.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-border w-[220px] h-[160px] bg-panel select-none",children:[Ye&&a.jsx("img",{src:Ye,alt:"thumb",className:"block w-full h-full object-contain"}),!!Ui&&a.jsx("div",{className:"absolute top-1.5 left-1.5 bg-surface border border-border text-text text-xs px-1.5 py-0.5 rounded-md select-none",children:Ui})]})}),iE.filter(te=>te.isVisible(Qi)).map(te=>a.jsx(u.Fragment,{children:te.render(Qi)},te.id)),a.jsx("div",{className:hl,onPointerDown:l})]})}function IE({open:e,embeddings:t,rejected:n=[],selectedPath:r,embeddingsLoading:s=!1,embeddingsError:i,onClose:o,onSearch:l}){const[c,d]=u.useState(""),[f,p]=u.useState("path"),[h,w]=u.useState(""),[x,b]=u.useState(""),[C,y]=u.useState("50"),[m,v]=u.useState(""),[g,S]=u.useState(null),[E,T]=u.useState(!1),j=u.useRef(null),I=u.useRef(null),M=u.useMemo(()=>t.find(L=>L.name===c)??t[0]??null,[t,c]);u.useEffect(()=>{e&&(S(null),t.length>0&&!t.some(L=>L.name===c)&&d(t[0].name),r?(p("path"),w(r)):(p("vector"),w("")))},[e,t,c,r]),u.useEffect(()=>{if(!e)return;const L=f==="vector"?I.current:j.current,R=window.requestAnimationFrame(()=>L==null?void 0:L.focus());return()=>window.cancelAnimationFrame(R)},[e,f]);const B=u.useCallback(async()=>{if(S(null),!t.length){S("No embeddings available for similarity search.");return}if(!M){S("Select an embedding to search.");return}const L=h.trim(),R=x.trim(),P=Number(C);if(!Number.isFinite(P)||P<=0){S("Top K must be a positive number.");return}const A=Math.min(1e3,Math.max(1,Math.floor(P))),O=m.trim()===""?null:Number(m);if(O!=null&&!Number.isFinite(O)){S("Min score must be a valid number.");return}if(f==="path"&&!L){S("Select an image path for the query.");return}if(f==="vector"&&!R){S("Paste a base64 vector for the query.");return}const K={embedding:M.name,query_path:f==="path"?L:null,query_vector_b64:f==="vector"?R:null,top_k:A,min_score:O};T(!0);try{await l(K),o()}catch(U){U instanceof ln||U instanceof Error?S(U.message):S("Failed to run similarity search.")}finally{T(!1)}},[t.length,M,h,x,C,m,f,l,o]);u.useEffect(()=>{if(!e)return;const L=R=>{if(R.key==="Escape"){R.preventDefault(),o();return}(R.ctrlKey||R.metaKey)&&R.key==="Enter"&&(R.preventDefault(),B())};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[e,o,B]);const F=u.useCallback(()=>{var L;r&&(p("path"),w(r),(L=j.current)==null||L.focus())},[r]);if(!e)return null;const Q=t.map(L=>({value:L.name,label:L.name})),ee=n.length>0,z=n.slice(0,3);return a.jsx("div",{className:"fixed inset-0 z-[var(--z-overlay)] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",onClick:L=>{L.target===L.currentTarget&&o()},children:a.jsxs("div",{className:"w-full max-w-2xl rounded-lg border border-border bg-panel shadow-[0_20px_50px_rgba(0,0,0,0.55)]",onClick:L=>L.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Find similar",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Find similar"}),a.jsx("div",{className:"text-xs text-muted",children:"Search with embeddings"})]}),a.jsx("button",{className:"btn btn-sm",onClick:o,"aria-label":"Close",children:"Close"})]}),a.jsxs("div",{className:"px-4 py-4 space-y-4",children:[i&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:i}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Embedding"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(lh,{value:(M==null?void 0:M.name)??"",onChange:d,options:Q,placeholder:s?"Loading embeddings...":"Select embedding",disabled:!t.length,triggerClassName:"min-w-[180px]"}),M&&a.jsxs("span",{className:"text-xs text-muted",children:[M.dimension," dims, ",M.metric,", ",M.dtype]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Query mode"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:`btn btn-sm ${f==="path"?"btn-active":""}`,onClick:()=>p("path"),"aria-pressed":f==="path",children:"Selected image"}),a.jsx("button",{type:"button",className:`btn btn-sm ${f==="vector"?"btn-active":""}`,onClick:()=>p("vector"),"aria-pressed":f==="vector",children:"Vector input"})]})]}),f==="path"?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Image path"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{ref:j,type:"text",className:"input w-full",value:h,onChange:L=>w(L.target.value),placeholder:r?"Selected image path":"Select an image first"}),a.jsx("button",{type:"button",className:"btn btn-sm",onClick:F,disabled:!r,title:r?"Use selected image":"Select an image first",children:"Use selected"})]})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Vector (base64 float32)"}),a.jsx("textarea",{ref:I,className:"ui-textarea w-full font-mono text-[11px]",rows:5,value:x,onChange:L=>b(L.target.value),placeholder:"Paste base64-encoded float32 vector"}),a.jsx("div",{className:"text-[11px] text-muted",children:"Base64 of little-endian float32. Length must match embedding dimension."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Top K"}),a.jsx("input",{type:"number",min:1,max:1e3,step:1,className:"input ui-number w-full",value:C,onChange:L=>y(L.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Min score"}),a.jsx("input",{type:"number",step:.01,className:"input ui-number w-full",value:m,onChange:L=>v(L.target.value),placeholder:"Optional"})]})]}),ee&&a.jsxs("div",{className:"ui-banner text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Skipped columns"}),a.jsxs("div",{className:"mt-1 space-y-1 text-muted",children:[z.map(L=>a.jsxs("div",{children:[L.name,": ",L.reason]},L.name)),n.length>z.length&&a.jsxs("div",{children:["+",n.length-z.length," more"]})]})]}),g&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:g})]}),a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-border",children:[a.jsx("div",{className:"text-xs text-muted",children:M?`Metric: ${M.metric}`:"Metric: cosine"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:o,disabled:E,children:"Cancel"}),a.jsx("button",{className:"btn btn-sm btn-active",onClick:B,disabled:E||!t.length,children:E?"Searching...":"Find similar"})]})]})]})})}const LE=/^[\/@a-zA-Z0-9._\-\/]{1,512}$/,_E=[".jpg",".jpeg",".png",".webp"];function Rt(e){try{const t=decodeURI(e||""),r=(t.startsWith("/")?t:`/${t}`).replace(/\/{2,}/g,"/"),s=r.length>1?r.replace(/\/$/,""):r;return LE.test(s)?s:"/"}catch{return"/"}}function Hm(){return(window.location.hash||"").replace(/^#/,"")}function Ox(e){const t=Rt(e),n=`#${encodeURI(t)}`;window.location.hash!==n&&(window.location.hash=n)}function Ul(e){const t=Rt(e),n=`#${encodeURI(t)}`;if(window.location.hash!==n){const r=`${window.location.pathname}${window.location.search}${n}`;window.history.replaceState(window.history.state,"",r)}}function AE(e){const n=Rt(e).toLowerCase();return _E.some(r=>n.endsWith(r))}function Dx(e,t){const n=e.replace(/\/+$/,""),r=t.replace(/^\/+/,""),s=[n,r].filter(Boolean).join("/");return s.startsWith("/")?s:`/${s}`}function Qm(e){const n=Rt(e).split("/").filter(Boolean);return n.length<=1?"/":"/"+n.slice(0,-1).join("/")}function mh(e){return Rt(e).split("/").filter(Boolean).pop()||""}function FE(e){return e.endsWith("/_trash_")}const OE=new Set([0,1,2,3,4,5]),gh=new Set(["<","<=",">",">="]),DE=/^\d{4}-\d{2}-\d{2}$/;function zE(e,t){return!t||!t.and.length?e:e.filter(n=>$E(n,t.and))}function $E(e,t){for(const n of t)if(!BE(e,n))return!1;return!0}function BE(e,t){var n,r,s,i,o,l,c;if("stars"in t){const d=t.stars;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsIn"in t){const d=t.starsIn.values;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsNotIn"in t){const d=t.starsNotIn.values;if(!d||!d.length)return!0;const f=e.star??0;return!d.includes(f)}if("nameContains"in t){const d=(n=t.nameContains.value)==null?void 0:n.trim();return d?(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("nameNotContains"in t){const d=(r=t.nameNotContains.value)==null?void 0:r.trim();return d?!(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("commentsContains"in t){const d=(s=t.commentsContains.value)==null?void 0:s.trim();if(!d)return!0;const f=e.comments??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("commentsNotContains"in t){const d=(i=t.commentsNotContains.value)==null?void 0:i.trim();if(!d)return!0;const f=e.comments??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("urlContains"in t){const d=(o=t.urlContains.value)==null?void 0:o.trim();if(!d)return!0;const f=e.source??e.url??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("urlNotContains"in t){const d=(l=t.urlNotContains.value)==null?void 0:l.trim();if(!d)return!0;const f=e.source??e.url??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("dateRange"in t){const{from:d,to:f}=t.dateRange;if(!d&&!f)return!0;if(!e.addedAt)return!1;const p=Date.parse(e.addedAt);if(Number.isNaN(p))return!1;const h=Gm(d,!1),w=Gm(f,!0);return!(h!=null&&p<h||w!=null&&p>w)}if("widthCompare"in t){const{op:d,value:f}=t.widthCompare;if(!Number.isFinite(f))return!0;const p=e.w;return!Number.isFinite(p)||p<=0?!1:Ym(p,d,f)}if("heightCompare"in t){const{op:d,value:f}=t.heightCompare;if(!Number.isFinite(f))return!0;const p=e.h;return!Number.isFinite(p)||p<=0?!1:Ym(p,d,f)}if("metricRange"in t){const{key:d,min:f,max:p}=t.metricRange,h=(c=e.metrics)==null?void 0:c[d];return!(h==null||h<f||h>p)}return!0}function tf(e){if(!e||typeof e!="object")return null;const t=e.and;if(!Array.isArray(t))return null;const n=[];for(const r of t){const s=nN(r);s&&n.push(s)}return{and:n}}function Km(e){var r;const t=e.and.find(s=>"stars"in s),n=e.and.find(s=>"starsIn"in s);return(r=n==null?void 0:n.starsIn)!=null&&r.values?n.starsIn.values:(t==null?void 0:t.stars)??[]}function Pc(e,t){return zx(e,t)}function UE(e){var n;const t=e.and.find(r=>"starsIn"in r);return((n=t==null?void 0:t.starsIn)==null?void 0:n.values)??[]}function zx(e,t){const n=Eo(t),r=e.and.filter(s=>!("starsIn"in s)&&!("stars"in s));return n.length?{and:[{starsIn:{values:n}},...r]}:{and:r}}function VE(e){var n;const t=e.and.find(r=>"starsNotIn"in r);return((n=t==null?void 0:t.starsNotIn)==null?void 0:n.values)??[]}function $x(e,t){const n=Eo(t),r=e.and.filter(s=>!("starsNotIn"in s));return n.length?{and:[{starsNotIn:{values:n}},...r]}:{and:r}}function WE(e){var n;const t=e.and.find(r=>"nameContains"in r);return((n=t==null?void 0:t.nameContains)==null?void 0:n.value)??null}function Bx(e,t){const n=vn(t),r=e.and.filter(s=>!("nameContains"in s));return n?{and:[{nameContains:{value:n}},...r]}:{and:r}}function HE(e){var n;const t=e.and.find(r=>"nameNotContains"in r);return((n=t==null?void 0:t.nameNotContains)==null?void 0:n.value)??null}function Ux(e,t){const n=vn(t),r=e.and.filter(s=>!("nameNotContains"in s));return n?{and:[{nameNotContains:{value:n}},...r]}:{and:r}}function QE(e){var n;const t=e.and.find(r=>"commentsContains"in r);return((n=t==null?void 0:t.commentsContains)==null?void 0:n.value)??null}function Vx(e,t){const n=vn(t),r=e.and.filter(s=>!("commentsContains"in s));return n?{and:[{commentsContains:{value:n}},...r]}:{and:r}}function KE(e){var n;const t=e.and.find(r=>"commentsNotContains"in r);return((n=t==null?void 0:t.commentsNotContains)==null?void 0:n.value)??null}function Wx(e,t){const n=vn(t),r=e.and.filter(s=>!("commentsNotContains"in s));return n?{and:[{commentsNotContains:{value:n}},...r]}:{and:r}}function qE(e){var n;const t=e.and.find(r=>"urlContains"in r);return((n=t==null?void 0:t.urlContains)==null?void 0:n.value)??null}function Hx(e,t){const n=vn(t),r=e.and.filter(s=>!("urlContains"in s));return n?{and:[{urlContains:{value:n}},...r]}:{and:r}}function GE(e){var n;const t=e.and.find(r=>"urlNotContains"in r);return((n=t==null?void 0:t.urlNotContains)==null?void 0:n.value)??null}function Qx(e,t){const n=vn(t),r=e.and.filter(s=>!("urlNotContains"in s));return n?{and:[{urlNotContains:{value:n}},...r]}:{and:r}}function YE(e){const t=e.and.find(n=>"dateRange"in n);return(t==null?void 0:t.dateRange)??null}function nf(e,t){const n=Ga((t==null?void 0:t.from)??null),r=Ga((t==null?void 0:t.to)??null),s=e.and.filter(i=>!("dateRange"in i));return!n&&!r?{and:s}:{and:[{dateRange:{...n?{from:n}:{},...r?{to:r}:{}}},...s]}}function XE(e){const t=e.and.find(n=>"widthCompare"in n);return(t==null?void 0:t.widthCompare)??null}function fa(e,t){const n=e.and.filter(r=>!("widthCompare"in r));return!t||!Number.isFinite(t.value)||!gh.has(t.op)?{and:n}:{and:[{widthCompare:{op:t.op,value:t.value}},...n]}}function JE(e){const t=e.and.find(n=>"heightCompare"in n);return(t==null?void 0:t.heightCompare)??null}function ha(e,t){const n=e.and.filter(r=>!("heightCompare"in r));return!t||!Number.isFinite(t.value)||!gh.has(t.op)?{and:n}:{and:[{heightCompare:{op:t.op,value:t.value}},...n]}}function ZE(e,t){const n=e.and.find(r=>"metricRange"in r&&r.metricRange.key===t);return(n==null?void 0:n.metricRange)??null}function eN(e,t,n){const r=e.and.filter(s=>!("metricRange"in s&&s.metricRange.key===t));return n?{and:[{metricRange:{key:t,min:n.min,max:n.max}},...r]}:{and:r}}function tN(e){const t=tf(e);return t?t.and.length:0}function nN(e){var t,n,r,s,i,o,l,c;if(!e||typeof e!="object")return null;if("stars"in e){const d=Eo(e.stars);return d.length?{starsIn:{values:d}}:null}if("starsIn"in e){const d=Eo((t=e.starsIn)==null?void 0:t.values);return d.length?{starsIn:{values:d}}:null}if("starsNotIn"in e){const d=Eo((n=e.starsNotIn)==null?void 0:n.values);return d.length?{starsNotIn:{values:d}}:null}if("nameContains"in e){const d=vn((r=e.nameContains)==null?void 0:r.value);return d?{nameContains:{value:d}}:null}if("nameNotContains"in e){const d=vn((s=e.nameNotContains)==null?void 0:s.value);return d?{nameNotContains:{value:d}}:null}if("commentsContains"in e){const d=vn((i=e.commentsContains)==null?void 0:i.value);return d?{commentsContains:{value:d}}:null}if("commentsNotContains"in e){const d=vn((o=e.commentsNotContains)==null?void 0:o.value);return d?{commentsNotContains:{value:d}}:null}if("urlContains"in e){const d=vn((l=e.urlContains)==null?void 0:l.value);return d?{urlContains:{value:d}}:null}if("urlNotContains"in e){const d=vn((c=e.urlNotContains)==null?void 0:c.value);return d?{urlNotContains:{value:d}}:null}if("dateRange"in e){const d=e.dateRange,f=Ga((d==null?void 0:d.from)??null),p=Ga((d==null?void 0:d.to)??null);return!f&&!p?null:{dateRange:{...f?{from:f}:{},...p?{to:p}:{}}}}if("widthCompare"in e){const d=e.widthCompare,f=qm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{widthCompare:f}:null}if("heightCompare"in e){const d=e.heightCompare,f=qm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{heightCompare:f}:null}if("metricRange"in e){const d=e.metricRange;if(!d||typeof d!="object")return null;const f=typeof d.key=="string"?d.key:"",p=rf(d.min),h=rf(d.max);return!f||p==null||h==null||p>h?null:{metricRange:{key:f,min:p,max:h}}}return null}function Eo(e){if(!Array.isArray(e))return[];const t=[],n=new Set;for(const r of e){const s=typeof r=="number"?r:typeof r=="string"?Number(r):NaN;!Number.isInteger(s)||!OE.has(s)||n.has(s)||(n.add(s),t.push(s))}return t}function vn(e){if(typeof e!="string")return null;const t=e.trim();return t||null}function Ga(e){if(typeof e!="string")return null;const t=e.trim();if(!t)return null;const n=Date.parse(t);return Number.isNaN(n)?null:t}function qm(e,t){if(typeof e!="string"||!gh.has(e))return null;const n=rf(t);return n==null?null:{op:e,value:n}}function Gm(e,t){if(!e)return null;const n=e.trim();if(!n)return null;const r=Date.parse(n);return Number.isNaN(r)?null:t&&DE.test(n)?r+24*60*60*1e3-1:r}function Ym(e,t,n){switch(t){case"<":return e<n;case"<=":return e<=n;case">":return e>n;case">=":return e>=n;default:return!0}}function rf(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null}const ps={leftFolders:"leftW.folders",leftMetrics:"leftW.metrics",leftLegacy:"leftW",right:"rightW"},Xm=200,Jm=240,Kx=200;function rN(e){return Number.isFinite(e)&&e>0}function Vl(e){const t=Number(e);return rN(t)?t:null}function qx(e,t,n){return Math.min(Math.max(e,t),n)}function sN(e){return e==="metrics"?ps.leftMetrics:ps.leftFolders}function iN(e){const t=Vl(e.getItem(ps.leftFolders))??Vl(e.getItem(ps.leftLegacy)),n=Vl(e.getItem(ps.leftMetrics)),r=Vl(e.getItem(ps.right));return{leftFoldersW:t,leftMetricsW:n,rightW:r}}function Zm(e,t,n){e.setItem(t,String(n))}function oN({clientX:e,appLeft:t,appWidth:n,rightWidth:r}){const s=e-t,i=Math.max(Xm,n-r-Kx);return qx(s,Xm,i)}function lN({clientX:e,appLeft:t,appWidth:n,leftWidth:r}){const s=e-t,i=n-s,o=Math.max(Jm,n-r-Kx);return qx(i,Jm,o)}function aN(e){return(e.pointerType??"mouse")==="mouse"&&e.button!==0}function uN(e,t){try{e.setPointerCapture(t)}catch{}}function cN(e,t){try{e.releasePointerCapture(t)}catch{}}function dN(e,t){const[n,r]=u.useState(240),[s,i]=u.useState(320),[o,l]=u.useState(240),c=t==="metrics"?s:n,d=u.useRef(c),f=u.useRef(o);u.useEffect(()=>{d.current=c},[c]),u.useEffect(()=>{f.current=o},[o]),u.useEffect(()=>{try{const x=iN(window.localStorage);x.leftFoldersW!==null&&r(x.leftFoldersW),x.leftMetricsW!==null&&i(x.leftMetricsW),x.rightW!==null&&l(x.rightW)}catch{}},[]);const p=(x,b,C)=>{if(aN(x))return;x.preventDefault();const y=x.currentTarget,m=x.pointerId;uN(y,m);const v=E=>{E.pointerId===m&&b(E)};function g(){window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",S),window.removeEventListener("pointercancel",S),cN(y,m)}function S(E){E.pointerId===m&&(g(),C())}window.addEventListener("pointermove",v),window.addEventListener("pointerup",S),window.addEventListener("pointercancel",S)};return{leftW:c,rightW:o,onResizeLeft:x=>{const b=e.current;if(!b)return;const C=b.getBoundingClientRect(),y=sN(t);let m=d.current;p(x,v=>{const g=oN({clientX:v.clientX,appLeft:C.left,appWidth:C.width,rightWidth:f.current});m=g,t==="metrics"?i(g):r(g)},()=>{try{Zm(window.localStorage,y,m)}catch{}})},onResizeRight:x=>{const b=e.current;if(!b)return;const C=b.getBoundingClientRect();let y=f.current;p(x,m=>{const v=lN({clientX:m.clientX,appLeft:C.left,appWidth:C.width,leftWidth:d.current});y=v,f.current=v,l(v)},()=>{try{Zm(window.localStorage,ps.right,y)}catch{}})}}}const fN=5*6e4,hN=6e4,Gx=(e,t)=>t!=null&&t.recursive?["folder",e,"recursive"]:["folder",e];function Yx(e){return e[0]!=="folder"||e[2]!=="recursive"||typeof e[1]!="string"?null:e}function pN(e){return Yx(e)!==null}function mN(e,t,n=!0){if(!pN(e))return!0;const r=Yx(e);if(r==null)return!1;const[,s]=r;return!!(s===t||n&&s==="/")}function gN(e,t,n=!0){return!Array.isArray(e)||e[0]!=="folder"?!1:!mN(e,t,n)}const yN=15e3;function vN(e,t){return me.getFolder(e,t)}function sf(e,t=!1,n){const r=vu(),s={recursive:t},i=!!s.recursive;return pu({queryKey:Gx(e,s),queryFn:()=>vN(e,s),enabled:(n==null?void 0:n.enabled)??!0,staleTime:1e4,gcTime:i?hN:fN,retry:2,retryDelay:o=>Math.min(1e3*Math.pow(2,o),5e3),refetchOnWindowFocus:!1,refetchInterval:r?yN:!1,refetchIntervalInBackground:r})}const Xx="application/x-lenslet-paths",xN='[role="treeitem"].drop-target';function eg(e){var n;return Array.from(((n=e.dataTransfer)==null?void 0:n.types)||[]).includes(Xx)}function wN(e){document.querySelectorAll(xN).forEach(t=>{t!==e&&t.classList.remove("drop-target")})}function tg(e){wN(e),e.classList.add("drop-target")}function ng(e){return e.startsWith("/")?e:`/${e}`}function bN({path:e,isLeaf:t}){const n=wr(),r=u.useCallback(l=>{eg(l)&&(l.preventDefault(),t&&tg(l.currentTarget))},[t]),s=u.useCallback(l=>{!t||!eg(l)||(l.preventDefault(),tg(l.currentTarget))},[t]),i=u.useCallback(l=>{const c=l.currentTarget,d=document.elementFromPoint(l.clientX,l.clientY);d&&c.contains(d)||c.classList.remove("drop-target")},[]),o=u.useCallback(async l=>{const c=l.dataTransfer;if(!c)return;l.preventDefault(),l.currentTarget.classList.remove("drop-target");const d=c.getData(Xx),p=(d?JSON.parse(d):[]).filter(Boolean);if(!p.length)return;let h=p[0].split("/").slice(0,-1).join("/")||"/";h=ng(h);const w=ng(e);try{for(const x of p)await me.moveFile(x,w);n.invalidateQueries({queryKey:["folder",h]}),n.invalidateQueries({queryKey:["folder",w]}),n.setQueryData(["folder",h],x=>!x||!Array.isArray(x.items)?x:{...x,items:x.items.filter(b=>!p.includes(b.path))})}catch{}},[e,n]);return{onDragOver:r,onDragEnter:s,onDragLeave:i,onDrop:o}}const SN='[role="tree"] [role="treeitem"]';function CN(){return Array.from(document.querySelectorAll(SN))}function kN(e,t){var i;const n=CN(),r=n.findIndex(o=>o===e);if(r===-1)return;let s=r;t==="ArrowDown"?s=Math.min(n.length-1,r+1):t==="ArrowUp"?s=Math.max(0,r-1):t==="Home"?s=0:t==="End"&&(s=n.length-1),(i=n[s])==null||i.focus()}function EN({path:e,isLeaf:t,isExpanded:n,setExpanded:r,onOpen:s}){return u.useCallback(i=>{if(i.key==="Enter"){i.preventDefault(),s(e);return}if(i.key==="ArrowRight"){!t&&!n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.add(e),l}));return}if(i.key==="ArrowLeft"){!t&&n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.delete(e),l}));return}(i.key==="ArrowDown"||i.key==="ArrowUp"||i.key==="Home"||i.key==="End")&&(i.preventDefault(),kN(i.currentTarget,i.key))},[e,t,n,r,s])}const rg=64,NN=120;function jN(e){const t=e.split("/").filter(Boolean),n=["/"];let r="";for(const s of t)r=r?`${r}/${s}`:`/${s}`,n.push(r);return n}function MN({current:e,roots:t,data:n,onOpen:r,onPullRefresh:s,onResize:i,onContextMenu:o,onOpenActions:l,countVersion:c,className:d,showResizeHandle:f=!0}){const[p,h]=u.useState(new Set(["/"])),w=u.useRef(new Map),x=u.useRef(new Map),[b,C]=u.useState(!1),[y,m]=u.useState(0),v=u.useRef(null),g=u.useRef(!1),S=wr(),E=u.useCallback(()=>{m(0),v.current=null,g.current=!1},[]),T=u.useCallback(async R=>{const P=Rt(R||"/"),A=w.current,O=x.current,K=A.get(P);if(K!==void 0)return K;const U=Gx(P,{recursive:!0}),_=S.getQueryData(U);if(_){const J=_.totalItems??_.items.length;return A.set(P,J),J}const G=O.get(P);if(G)return G;const V=(async()=>{try{const J=S.getQueryState(U);if((J==null?void 0:J.fetchStatus)==="fetching"){const q=await S.fetchQuery({queryKey:U,queryFn:()=>me.getFolder(P,{recursive:!0})}),H=q.totalItems??q.items.length;return A.set(P,H),H}const se=await me.getFolderCount(P),Y=se.totalItems??se.items.length;return A.set(P,Y),Y}finally{O.delete(P)}})();return O.set(P,V),V},[S]);u.useEffect(()=>{w.current.clear(),x.current.clear()},[c]),u.useEffect(()=>{const R=jN(e);h(P=>{const A=new Set(P);for(const O of R)A.add(O);return A})},[e]);const j=u.useCallback(async()=>{if(!(!s||b)){C(!0);try{await s()}catch(R){console.error("Failed to refresh folders:",R)}finally{C(!1),m(0)}}},[s,b]),I=u.useCallback(R=>{!s||b||R.touches.length===1&&(R.currentTarget.scrollTop>0||(v.current=R.touches[0].clientY,g.current=!1))},[s,b]),M=u.useCallback(R=>{if(!s||b||R.touches.length!==1)return;const P=v.current;if(P==null)return;if(R.currentTarget.scrollTop>0){E();return}const A=R.touches[0].clientY-P;if(A<=0){g.current&&m(0);return}!g.current&&A<8||(g.current=!0,R.preventDefault(),m(Math.min(NN,A*.55)))},[b,s,E]),B=u.useCallback(()=>{if(!s||b){E();return}const R=g.current&&y>=rg;if(v.current=null,g.current=!1,R){j();return}m(0)},[j,b,s,y,E]),F=d??"h-full overflow-auto bg-panel scrollbar-thin",Q=s?`${F} overscroll-y-contain`:F,ee=!!s&&(b||y>0),z=y>=rg,L=b?28:Math.min(44,y);return a.jsxs("div",{className:Q,onTouchStart:s?I:void 0,onTouchMove:s?M:void 0,onTouchEnd:s?B:void 0,onTouchCancel:s?B:void 0,children:[ee&&a.jsx("div",{className:"flex items-end justify-center text-[11px] text-muted select-none transition-[height,opacity] duration-150",style:{height:L,opacity:b||y>8?1:.65},"aria-live":"polite",children:b?"Refreshing":z?"Release to refresh":"Pull to refresh"}),a.jsx("div",{className:"p-1",role:"tree","aria-label":"Folders",children:t.map(R=>a.jsx(Jx,{path:R.path,label:R.label,depth:0,current:e,expanded:p,setExpanded:h,onOpen:r,onContextMenu:o,onOpenActions:l,initial:n,getSubtreeCount:T,countVersion:c},R.path))}),f&&a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 left-[calc(var(--left)-6px)]",onPointerDown:i})]})}function Jx({path:e,label:t,depth:n,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:c,initial:d,getSubtreeCount:f,countVersion:p}){var F;const h=s.has(e),w=r===e,x=e==="/"||h||w,{data:b}=sf(e,!1,{enabled:x}),C=d&&e===d.path?d:b,m=!!C?C.dirs.length===0:!1,[v,g]=u.useState(C?C.items.length:null),S=EN({path:e,isLeaf:m,isExpanded:h,setExpanded:i,onOpen:o}),{onDragOver:E,onDragEnter:T,onDragLeave:j,onDrop:I}=bN({path:e,isLeaf:m}),M=Q=>{Q.stopPropagation(),!m&&i(ee=>{const z=new Set(ee);return z.has(e)?z.delete(e):z.add(e),z})},B=Q=>{if(Q.stopPropagation(),!c)return;const ee=Q.currentTarget.getBoundingClientRect();c(e,{x:ee.right-4,y:ee.bottom-4})};return u.useEffect(()=>{let Q=!1;if(!C){g(null);return}if(g(C.items.length),!!(h&&(n>0||w)))return f(e).then(z=>{Q||g(z)}).catch(z=>{Q||console.warn(`Failed to compute subtree count for ${e}:`,z)}),()=>{Q=!0}},[C,e,f,p,h,n,w]),a.jsxs("div",{children:[a.jsxs("div",{className:`tree-row flex items-center gap-1.5 py-1 px-2 rounded-md cursor-pointer min-h-[40px] outline-none transition-colors duration-75 ${w?"bg-accent/20 text-accent font-medium":"hover:bg-white/5 text-text"}`,role:"treeitem","aria-level":n+1,"aria-expanded":m?void 0:h,"aria-selected":w,tabIndex:w?0:-1,style:{paddingLeft:8+n*14},onClick:()=>o(e),onContextMenu:Q=>{Q.preventDefault(),Q.stopPropagation(),l==null||l(Q,e)},onKeyDown:S,onDragOver:E,onDragEnter:T,onDragLeave:j,onDrop:I,children:[a.jsx("button",{type:"button",className:"tree-expand-btn touch-manipulation",onClick:M,"aria-label":m?`No subfolders in ${t}`:`${h?"Collapse":"Expand"} ${t}`,"aria-expanded":m?void 0:h,disabled:m,children:m?"":h?"":""}),a.jsx("span",{className:"flex-1 overflow-hidden truncate text-sm",title:t,children:Tk(t,28)}),v!==null&&a.jsx("span",{className:"text-[10px] opacity-50 bg-white/5 border border-white/5 rounded px-1.5 min-w-[24px] text-center",children:v}),c&&a.jsx("button",{type:"button",className:"tree-row-action-btn touch-manipulation","aria-label":`Open actions for ${t}`,"aria-haspopup":"menu",onPointerDown:Q=>Q.stopPropagation(),onClick:B,children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]}),h&&((F=C==null?void 0:C.dirs)==null?void 0:F.map(Q=>a.jsx(Jx,{path:Dx(e,Q.name),label:Q.name,depth:n+1,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:c,getSubtreeCount:f,countVersion:p},Q.name)))]})}const sg=[5,4,3,2,1],ig=["<","<=",">",">="];function RN({filters:e,onChangeFilters:t}){const n=u.useMemo(()=>UE(e),[e]),r=u.useMemo(()=>VE(e),[e]),s=u.useMemo(()=>WE(e)??"",[e]),i=u.useMemo(()=>HE(e)??"",[e]),o=u.useMemo(()=>QE(e)??"",[e]),l=u.useMemo(()=>KE(e)??"",[e]),c=u.useMemo(()=>qE(e)??"",[e]),d=u.useMemo(()=>GE(e)??"",[e]),f=u.useMemo(()=>YE(e)??{},[e]),p=u.useMemo(()=>og(f.from),[f.from]),h=u.useMemo(()=>og(f.to),[f.to]),w=u.useMemo(()=>XE(e),[e]),x=u.useMemo(()=>JE(e),[e]),[b,C]=u.useState((w==null?void 0:w.op)??">="),[y,m]=u.useState((x==null?void 0:x.op)??">=");u.useEffect(()=>{w!=null&&w.op&&C(w.op)},[w==null?void 0:w.op]),u.useEffect(()=>{x!=null&&x.op&&m(x.op)},[x==null?void 0:x.op]);const v=(g,S)=>{const E=new Set(n),T=new Set(r);g==="include"?E.has(S)?E.delete(S):(E.add(S),T.delete(S)):T.has(S)?T.delete(S):(T.add(S),E.delete(S));let j=zx(e,Array.from(E));j=$x(j,Array.from(T)),t(j)};return a.jsxs("div",{className:"ui-card",children:[a.jsx("div",{className:"ui-section-title mb-3",children:"Attributes"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Rating"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Include"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[sg.map(g=>{const S=n.includes(g);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${S?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("include",g),"aria-pressed":S,title:`Include ${g} star${g>1?"s":""}`,children:[g,""]},`stars-in-${g}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${n.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("include",0),"aria-pressed":n.includes(0),title:"Include unrated",children:"None"})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Exclude"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[sg.map(g=>{const S=r.includes(g);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${S?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("exclude",g),"aria-pressed":S,title:`Exclude ${g} star${g>1?"s":""}`,children:[g,""]},`stars-out-${g}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${r.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>v("exclude",0),"aria-pressed":r.includes(0),title:"Exclude unrated",children:"None"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Filename"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:s,placeholder:"e.g. draft",onChange:g=>t(Bx(e,g.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:i,placeholder:"e.g. v1",onChange:g=>t(Ux(e,g.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Comments"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:o,placeholder:"e.g. hero",onChange:g=>t(Vx(e,g.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:l,placeholder:"e.g. todo",onChange:g=>t(Wx(e,g.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"URL"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:c,placeholder:"e.g. s3://bucket",onChange:g=>t(Hx(e,g.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:d,placeholder:"e.g. http://",onChange:g=>t(Qx(e,g.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Date Added"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"From"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:p,onChange:g=>t(nf(e,{from:g.target.value||null,to:f.to??null}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"To"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:h,onChange:g=>t(nf(e,{from:f.from??null,to:g.target.value||null}))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Dimensions"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Width"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:b,onChange:g=>{const S=g.target.value;C(S),w&&t(fa(e,{op:S,value:w.value}))},children:ig.map(g=>a.jsx("option",{value:g,children:g},`w-${g}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:w?String(w.value):"",min:0,placeholder:"px",onChange:g=>{const S=g.target.value;if(!S){t(fa(e,null));return}const E=Number(S);Number.isFinite(E)&&t(fa(e,{op:b,value:E}))}})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Height"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:y,onChange:g=>{const S=g.target.value;m(S),x&&t(ha(e,{op:S,value:x.value}))},children:ig.map(g=>a.jsx("option",{value:g,children:g},`h-${g}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:x?String(x.value):"",min:0,placeholder:"px",onChange:g=>{const S=g.target.value;if(!S){t(ha(e,null));return}const E=Number(S);Number.isFinite(E)&&t(ha(e,{op:y,value:E}))}})]})]})]})]})]})]})}function og(e){return e?e.length>=10?e.slice(0,10):e:""}const PN=[];function of(e,t){if(t!=null&&t.length)return TN(e,t);const n=new Map;for(const r of e){const s=r.metrics;if(s)for(const[i,o]of Object.entries(s)){if(o==null||Number.isNaN(o))continue;const l=n.get(i);l?l.push(o):n.set(i,[o])}}return n}function TN(e,t){const n=t.map(s=>({key:s,values:[]}));for(const s of e){const i=s.metrics;if(i)for(const o of n){const l=i[o.key];l==null||Number.isNaN(l)||o.values.push(l)}}const r=new Map;for(const s of n)s.values.length&&r.set(s.key,s.values);return r}function Qs(e,t){return e.get(t)??PN}function Tc(e,t,n){if(!e.length)return null;const r=n?n.min:Math.min(...e);let s=n?n.max:Math.max(...e);r===s&&(s=r+1);const i=new Array(t).fill(0),o=t/(s-r);for(const l of e){const c=Math.max(0,Math.min(t-1,Math.floor((l-r)*o)));i[c]+=1}return{bins:i,min:r,max:s,count:e.length}}function Zx(e,t){return e<t?{min:e,max:t}:{min:t,max:e}}function nn(e){return jx(e)}function kr(e){if(!Number.isFinite(e))return"";const t=e.toString();return t.includes("e")?e.toFixed(6):t}function lg(e){const t=e.trim();if(!t)return{value:null,valid:!0};const n=Number(t);return Number.isFinite(n)?{value:n,valid:!0}:{value:null,valid:!1}}function ag(e,t,n){return e<t?t:e>n?n:e}function yh(e){return e<0?0:e>1?1:e}function Ks(e,t){const n=Math.max(1,Math.abs(e),Math.abs(t));return Math.abs(e-t)<=1e-6*n}function IN(e,t,n){const r=yh((e-t.left)/t.width);return n.min+(n.max-n.min)*r}function LN(e,t,n=4){return e==null?!1:Math.abs(t-e)>=n}function e0(e,t){return Zx(e??t,t)}function _N(e,t,n,r){return e&&t!=null?{commitRange:e0(n,t),shouldClear:!1}:{commitRange:null,shouldClear:r!=null}}function AN({metricKey:e,domain:t,activeRange:n,onChangeRange:r}){const[s,i]=u.useState(null),[o,l]=u.useState(!1),c=u.useRef(null),d=u.useRef(null),f=u.useRef(!1),p=u.useRef(null),[h,w]=u.useState(null),x=s??n;u.useEffect(()=>{w(null)},[e,t==null?void 0:t.min,t==null?void 0:t.max]);const b=v=>{var S;if(!t)return null;const g=(S=p.current)==null?void 0:S.getBoundingClientRect();return g?IN(v,{left:g.left,width:g.width},t):null};return{svgRef:p,hoverValue:h,displayRange:x,onPointerDown:v=>{var S;if(!t)return;v.preventDefault();const g=b(v.clientX);g!=null&&(l(!0),i(null),c.current=g,d.current=v.clientX,f.current=!1,w(g),(S=p.current)==null||S.setPointerCapture(v.pointerId))},onPointerMove:v=>{const g=b(v.clientX);if(g==null){o||w(null);return}w(g),o&&(!f.current&&!LN(d.current,v.clientX)||(f.current=!0,i(e0(c.current,g))))},onPointerUp:v=>{var E;if(!o)return;l(!1),(E=p.current)==null||E.releasePointerCapture(v.pointerId);const g=b(v.clientX),S=_N(f.current,g,c.current,n);S.commitRange?(w(g),r(S.commitRange)):S.shouldClear&&r(null),c.current=null,d.current=null,f.current=!1,setTimeout(()=>i(null),0)},onPointerLeave:()=>w(null)}}const ms=40;function ug({metricKey:e,populationValues:t,filteredValues:n,selectedValues:r=[],filters:s,onChangeRange:i,showTitle:o=!1}){const l=u.useMemo(()=>Tc(t,ms),[t]),c=u.useMemo(()=>l?Tc(n,ms,l):null,[n,l]),d=ZE(s,e),f=l?{min:l.min,max:l.max}:null,{svgRef:p,hoverValue:h,displayRange:w,onPointerDown:x,onPointerMove:b,onPointerUp:C,onPointerLeave:y}=AN({metricKey:e,domain:f,activeRange:d,onChangeRange:F=>i(e,F)}),[m,v]=u.useState(""),[g,S]=u.useState(""),[E,T]=u.useState(null),j=r.length===1?r[0]:null,I=u.useMemo(()=>!l||r.length<2?null:Tc(r,ms,l),[r,l]);u.useEffect(()=>{if(!d||!f){E!=="min"&&v(d?kr(d.min):""),E!=="max"&&S(d?kr(d.max):"");return}if(E!=="min"){const F=Ks(d.min,f.min)?"":kr(d.min);v(F)}if(E!=="max"){const F=Ks(d.max,f.max)?"":kr(d.max);S(F)}},[d,f,E]);const M=(F,Q)=>{if(!f)return;const ee=lg(F),z=lg(Q);if(!ee.valid||!z.valid){ee.valid||v(d?kr(d.min):""),z.valid||S(d?kr(d.max):"");return}if(ee.value==null&&z.value==null){i(e,null);return}const L=ee.value??f.min,R=z.value??f.max,P=ag(L,f.min,f.max),A=ag(R,f.min,f.max),O=Zx(P,A);if(Ks(O.min,f.min)&&Ks(O.max,f.max)){i(e,null);return}i(e,O)};if(!l||!f)return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]});const B=r.length;return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mb-2 tabular-nums",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{children:["Population: ",l.count]}),a.jsxs("span",{children:["Filtered: ",(c==null?void 0:c.count)??0]}),B>1&&a.jsxs("span",{className:"text-text",children:["Selected: ",B]})]}),j!=null&&a.jsxs("span",{className:"text-text",children:["Selected: ",nn(j)]})]}),a.jsxs("svg",{ref:p,viewBox:`0 0 ${ms} 100`,preserveAspectRatio:"none",className:"w-full h-28 cursor-crosshair rounded-md bg-surface-inset",onPointerDown:x,onPointerMove:b,onPointerUp:C,onPointerLeave:y,children:[Ic(l.bins,"#2e3a4b"),c&&Ic(c.bins,"#3a8fff"),I&&Ic(I.bins,"#f59e0b",{opacity:.55}),w&&FN(w,f),j!=null&&cg(j,f,{color:"var(--highlight)",strokeWidth:.7}),h!=null&&cg(h,f,{color:"rgba(255,255,255,0.75)",strokeWidth:.5,dashed:!0})]}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mt-2 tabular-nums",children:[a.jsx("span",{children:nn(f.min)}),a.jsxs("div",{className:"flex flex-col items-center text-center leading-tight",children:[w?a.jsx("span",{className:"text-text",children:Ks(w.min,f.min)?` ${nn(w.max)}`:Ks(w.max,f.max)?` ${nn(w.min)}`:`${nn(w.min)}  ${nn(w.max)}`}):h!=null?a.jsxs("span",{className:"text-text",children:["Cursor: ",nn(h)]}):a.jsx("span",{children:"Drag to filter"}),w&&h!=null&&a.jsxs("span",{className:"text-[11px] text-muted",children:["Cursor: ",nn(h)]})]}),a.jsx("span",{children:nn(f.max)})]}),a.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2 mt-3 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Min"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:m,placeholder:kr(f.min),onFocus:()=>T("min"),onBlur:()=>{T(null),M(m,g)},onChange:F=>v(F.target.value),onKeyDown:F=>{F.key==="Enter"&&F.currentTarget.blur()}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Max"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:g,placeholder:kr(f.max),onFocus:()=>T("max"),onBlur:()=>{T(null),M(m,g)},onChange:F=>S(F.target.value),onKeyDown:F=>{F.key==="Enter"&&F.currentTarget.blur()}})]}),a.jsx("button",{className:"btn btn-xs btn-ghost text-muted hover:text-text",onClick:()=>i(e,null),children:"Clear"})]})]})}function Ic(e,t,n){const r=Math.max(1,...e),s=(n==null?void 0:n.opacity)??.9;return e.map((i,o)=>{const l=i/r*100;return a.jsx("rect",{x:o+.05,y:100-l,width:.9,height:l,fill:t,opacity:s},`${t}-${o}`)})}function FN(e,t){const n=(e.min-t.min)/(t.max-t.min),r=(e.max-t.min)/(t.max-t.min),s=ms*yh(Math.min(n,r)),i=ms*Math.abs(r-n);return a.jsx("rect",{x:s,y:0,width:Math.max(.5,i),height:100,fill:"rgba(255,255,255,0.08)",stroke:"rgba(255,255,255,0.4)",strokeWidth:.4})}function cg(e,t,n){const r=yh((e-t.min)/(t.max-t.min)),s=ms*r;return a.jsx("line",{x1:s,y1:0,x2:s,y2:100,stroke:n.color,strokeWidth:n.strokeWidth??.5,strokeDasharray:n.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}const ON=new Map;function DN({items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}){const[c,d]=u.useState(!1),f=s&&n.includes(s)?s:n[0],p=u.useMemo(()=>c?n:f?[f]:[],[c,n,f]),h=u.useMemo(()=>of(e,p),[e,p]),w=u.useMemo(()=>of(t,p),[t,p]),x=r??ON;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("label",{className:"ui-label",children:"Metric"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-[11px]",onClick:()=>d(b=>!b),"aria-pressed":c,children:c?"Show one":"Show all"})]}),c?a.jsx("div",{className:"ui-input ui-input-readonly w-full flex items-center text-xs",children:"All metrics"}):a.jsx("select",{className:"ui-select w-full",value:f,onChange:b=>i(b.target.value),children:n.map(b=>a.jsx("option",{value:b,children:b},b))})]}),c?a.jsx("div",{className:"space-y-3",children:n.map(b=>a.jsx(ug,{metricKey:b,populationValues:Qs(h,b),filteredValues:Qs(w,b),selectedValues:Qs(x,b),filters:o,onChangeRange:l,showTitle:!0},b))}):f?a.jsx(ug,{metricKey:f,populationValues:Qs(h,f),filteredValues:Qs(w,f),selectedValues:Qs(x,f),filters:o,onChangeRange:l}):a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]})}const zN=12;function $N({items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l,onChangeFilters:c}){const d=u.useMemo(()=>r!=null&&r.length?of(r,n):null,[r,n]),f=d&&r&&r.length?a.jsx(BN,{selectedValuesByKey:d,totalItems:r.length,metricKeys:n}):null,p=a.jsx(RN,{filters:o,onChangeFilters:c});return n.length?a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,a.jsx(DN,{items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:d,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}),p]}):a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,p,a.jsx("div",{className:"p-4 text-sm text-muted",children:"No metrics found in this dataset."})]})}function BN({selectedValuesByKey:e,totalItems:t,metricKeys:n}){const r=u.useMemo(()=>e.size?{entries:(n.length?n.filter(p=>e.has(p)):Array.from(e.keys()).sort()).map(p=>{const h=e.get(p)??[],w=Math.min(...h),x=Math.max(...h),b=h.reduce((C,y)=>C+y,0)/Math.max(1,h.length);return{key:p,value:h[0],min:w,max:x,avg:b,count:h.length}}),totalItems:t}:null,[e,n,t]);if(!r)return null;const{entries:s,totalItems:i}=r,o=s.slice(0,zN),l=s.length-o.length,c=i>1;return a.jsxs("div",{className:"ui-card",children:[a.jsxs("div",{className:"ui-card-header",children:[a.jsx("div",{className:"ui-section-title",children:"Selected metrics"}),a.jsxs("div",{className:"text-[11px] text-muted",children:[i," item",i===1?"":"s"]})]}),a.jsxs("div",{className:"space-y-1 text-[12px]",children:[o.map(d=>a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-muted w-28 shrink-0 truncate",title:d.key,children:d.key}),a.jsxs("span",{className:"font-mono text-text text-right tabular-nums",children:[c?`${nn(d.min)}  ${nn(d.max)}`:nn(d.value),c&&a.jsxs("span",{className:"text-[11px] text-muted ml-2",children:["avg ",nn(d.avg),d.count!==i?`  ${d.count}/${i}`:""]})]})]},d.key)),l>0&&a.jsxs("div",{className:"text-[11px] text-muted",children:["+",l," more"]})]})]})}const UN=[{label:"Root",path:"/"}],VN="w-11 h-11 rounded-md border border-border flex items-center justify-center transition-colors",WN="bg-accent-muted text-accent",HN="bg-surface text-text hover:bg-surface-hover";function Wl(e){return`${VN} ${e?WN:HN}`}function QN({leftTool:e,onToolChange:t,compareEnabled:n,compareActive:r,onOpenCompare:s,views:i,activeViewId:o,onActivateView:l,onSaveView:c,current:d,data:f,onOpenFolder:p,onOpenFolderActions:h,onPullRefreshFolders:w,onContextMenu:x,countVersion:b,items:C,filteredItems:y,metricKeys:m,selectedItems:v,selectedMetric:g,onSelectMetric:S,filters:E,onChangeRange:T,onChangeFilters:j,onResize:I}){const M=Wl(e==="folders"),B=Wl(e==="metrics"),F=Wl(r),Q=`${Wl(!1)} cursor-pointer`;return a.jsxs("div",{className:"app-left-panel col-start-1 row-start-2 relative border-r border-border bg-panel overflow-visible",children:[a.jsxs("div",{className:"absolute inset-y-0 left-0 w-12 border-r border-border flex flex-col items-center gap-2 py-3 bg-surface-overlay",children:[a.jsx("button",{className:M,title:"Folders","aria-label":"Folders","aria-pressed":e==="folders",onClick:()=>t("folders"),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M3 7.5h6l2-2h10a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2z"})})}),a.jsx("button",{className:B,title:"Metrics / Filters","aria-label":"Metrics and Filters","aria-pressed":e==="metrics",onClick:()=>t("metrics"),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]})}),a.jsx("div",{className:"w-6 h-px bg-border/70 my-1"}),a.jsx("button",{className:`${F} ${n?"":"opacity-40 cursor-not-allowed"}`,title:n?"Compare selected images":"Compare (select 2+)","aria-label":"Compare selected images","aria-pressed":r,"aria-disabled":!n,disabled:!n,onClick:()=>{n&&s()},children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("rect",{x:"3",y:"4",width:"8",height:"16",rx:"1"}),a.jsx("rect",{x:"13",y:"4",width:"8",height:"16",rx:"1"})]})}),a.jsx("div",{className:"flex-1"}),a.jsx("a",{className:Q,href:"https://github.com/trojblue/lenslet",title:"Lenslet on GitHub","aria-label":"Lenslet on GitHub",target:"_blank",rel:"noreferrer",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:a.jsx("path",{d:"M12 .5C5.73.5.5 5.74.5 12.02c0 5.1 3.29 9.42 7.86 10.95.58.11.79-.25.79-.56v-2.17c-3.2.7-3.88-1.55-3.88-1.55-.53-1.35-1.29-1.71-1.29-1.71-1.05-.72.08-.71.08-.71 1.16.08 1.78 1.2 1.78 1.2 1.03 1.77 2.71 1.26 3.37.96.1-.75.4-1.26.73-1.55-2.55-.29-5.23-1.29-5.23-5.74 0-1.27.45-2.31 1.19-3.13-.12-.29-.52-1.46.11-3.05 0 0 .97-.31 3.18 1.19.92-.26 1.91-.39 2.89-.39.98 0 1.97.13 2.89.39 2.2-1.5 3.18-1.19 3.18-1.19.63 1.59.23 2.76.11 3.05.74.82 1.19 1.86 1.19 3.13 0 4.46-2.69 5.45-5.25 5.73.41.36.78 1.07.78 2.16v3.2c0 .31.21.67.8.56 4.56-1.53 7.85-5.85 7.85-10.95C23.5 5.74 18.27.5 12 .5z"})})})]}),a.jsx("div",{className:"ml-12 h-full overflow-hidden",children:e==="folders"?a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-2 py-2 border-b border-border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Smart Folders"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:c,title:"Save current view as Smart Folder",children:"+ New"})]}),i.length?a.jsx("div",{className:"flex flex-col gap-1",children:i.map(ee=>{const z=ee.id===o;return a.jsx("button",{className:`text-left px-2 py-2 rounded-md text-sm ${z?"bg-accent-muted text-accent":"hover:bg-hover text-text"}`,onClick:()=>l(ee),children:ee.name},ee.id)})}):a.jsx("div",{className:"text-xs text-muted px-1 py-1.5",children:"No saved Smart Folders yet."})]}),a.jsx(MN,{current:d,roots:UN,data:f,onOpen:p,onPullRefresh:w,onContextMenu:x,onOpenActions:h,countVersion:b,className:"flex-1 min-h-0 overflow-auto scrollbar-thin",showResizeHandle:!1})]}):a.jsx($N,{items:C,filteredItems:y,metricKeys:m,selectedItems:v,selectedMetric:g,onSelectMetric:S,filters:E,onChangeRange:T,onChangeFilters:j})}),a.jsx("div",{className:"toolbar-offset sidebar-resize-handle sidebar-resize-handle-left absolute bottom-0",onPointerDown:I})]})}function KN({persistenceEnabled:e,indexing:t=null,showSwitchToMostRecentBanner:n=!1,onSwitchToMostRecent:r,offViewSummary:s,onRevealOffView:i,canRevealOffView:o=!1,onClearOffView:l,browserZoomPercent:c}){const f=!!(s!=null&&s.names.length)&&s?` (${s.names.join(", ")}${s.extra?` +${s.extra}`:""})`:"",p=o&&i!=null,h=typeof c=="number"?c:null,w=h!==null&&Math.abs(h-100)>=2,x=(t==null?void 0:t.state)==="running",b=(t==null?void 0:t.state)==="error",C=t!=null&&t.scope&&t.scope!=="/"?` (${t.scope})`:"",y=(()=>{if(!x)return null;const g=typeof(t==null?void 0:t.done)=="number"?t.done:null,S=typeof(t==null?void 0:t.total)=="number"?t.total:null;return g===null&&S===null?null:S===null?`${g??0} indexed`:`${Math.min(g??0,S)} / ${S}`})(),m=n&&r!=null;return!e||x||b||m||w||!!s?a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-col gap-2",children:[!e&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Not persisted."})," Workspace is read-only; edits stay in memory until restart."]}),x&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Indexing in progress",C,"."]})," ",y?`${y} complete.`:"Preparing searchable index."]}),b&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Indexing failed."})," ",(t==null?void 0:t.error)||"Open server logs for details."]}),m&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("span",{children:[a.jsx("span",{className:"font-semibold",children:"Indexing complete."})," ","Scan-stable ordering is active for this generation."]}),a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>r==null?void 0:r(),children:"Switch to Most recent"})]}),w&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Browser zoom ",Math.round(h),"%."]})," For best results, set it to 100% so UI elements stay in correct proportions."]}),s&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex items-center justify-between gap-3",children:[a.jsxs("span",{children:["Updates outside current view: ",s.count," item",s.count===1?"":"s",f]}),a.jsxs("div",{className:"flex items-center gap-2",children:[p&&a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>i==null?void 0:i(),"aria-label":"Reveal off-view updates",children:"Reveal"}),a.jsx("button",{className:"text-muted hover:text-text transition-colors text-base leading-none",onClick:l,"aria-label":"Clear off-view updates",children:""})]})]})]})}):null}function qN(e){return e.isOffline?"offline":e.isUnstable?"unstable":e.recentEditActive?"recent":Number.isFinite(e.editingCount)&&e.editingCount>0?"editing":"live"}const GN=6e3,YN=1e4,XN=24*60*6e4,JN=3e4,ZN=350,ej=1400,t0=[-2,-1,1,2],n0=[-2,-1,0,1,2,3];t0.length;n0.length;function tj(e,t,n){return Math.min(Math.max(e,t),n)}function r0(e,t,n){const r=new Set,s=[];for(const i of n){const o=t+i;if(o<0||o>=e.length)continue;const l=e[o];!l||r.has(l)||(r.add(l),s.push(l))}return s}function nj(e,t){if(!t)return[];const n=e.indexOf(t);return n<0?[]:r0(e,n,t0)}function rj(e,t){if(e.length<2)return[];const n=Math.max(0,e.length-2),r=tj(t,0,n);return r0(e,r,n0)}function sj({paths:e,defaultDestination:t,destinations:n,loadingDestinations:r,onClose:s,onSubmit:i}){const[o,l]=u.useState(()=>Rt(t||"/")),[c,d]=u.useState(!1);u.useEffect(()=>{l(Rt(t||"/"))},[t,e]);const f=Rt(o||"/"),p=e.length>0&&!c,h=e.slice(0,3).map(C=>mh(C)||C),w=Math.max(0,e.length-h.length),x=n.filter(C=>C!==f).slice(0,8),b=async C=>{if(C.preventDefault(),!!p){d(!0);try{await i(e,f)}finally{d(!1)}}};return a.jsx("div",{className:"toolbar-offset fixed inset-0 z-overlay bg-black/45 backdrop-blur-[1px] flex items-center justify-center p-3",children:a.jsxs("div",{className:"w-full max-w-[560px] rounded-xl border border-border bg-panel shadow-[0_20px_60px_rgba(0,0,0,0.55)]",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Move to folder"}),a.jsxs("div",{className:"text-xs text-muted",children:[e.length," item(s) selected"]})]}),a.jsx("button",{type:"button",className:"btn btn-icon",onClick:s,"aria-label":"Close move dialog",disabled:c,children:""})]}),a.jsxs("form",{className:"px-4 py-3 flex flex-col gap-3",onSubmit:b,children:[a.jsxs("div",{className:"text-xs text-muted",children:[h.join(", "),w>0?` and ${w} more`:""]}),a.jsxs("label",{className:"text-xs text-muted flex flex-col gap-1.5",children:["Destination folder",a.jsx("input",{value:o,onChange:C=>l(C.target.value),className:"input w-full",list:"move-destination-list",placeholder:"/",autoFocus:!0,disabled:c})]}),a.jsx("datalist",{id:"move-destination-list",children:n.map(C=>a.jsx("option",{value:C},C))}),a.jsx("div",{className:"text-[11px] text-muted",children:r?"Loading folder list":`${n.length.toLocaleString()} destination(s) loaded`}),x.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.map(C=>a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>l(C),disabled:c,children:C},C))}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-border",children:[a.jsx("button",{type:"button",className:"btn",onClick:s,disabled:c,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-active",disabled:!p,children:c?"Moving":"Move"})]})]})]})})}function ij(e){return JSON.stringify(e,null,2)}function oj(e){const t=s=>'"'+s.replaceAll('"','""')+'"',n="path,folder,name,star,type,size,width,height,tags,notes",r=e.map(s=>{const i=(s.tags||[]).join(" "),o=s.notes||"";return[s.path,s.folder,s.name,String(s.star??""),s.type??"",s.size??"",s.width??"",s.height??"",i,o].map(l=>t(String(l))).join(",")});return[n,...r].join(`
`)}function lj(e){return e.map(t=>{const n=t.path.split("/").filter(Boolean);n.pop();const r=n.length?`/${n.join("/")}`:"/";return{path:t.path,folder:r,name:t.name,star:t.star??null,type:t.type,size:t.size,width:t.w,height:t.h}})}function aj({x:e,y:t,items:n}){const r=u.useRef(null),[s,i]=u.useState({x:e,y:t}),[o,l]=u.useState(!1),c=u.useCallback((f,p)=>{p.stopPropagation(),f.disabled||f.onClick()},[]),d=u.useCallback(()=>{const f=r.current,p=dx(),h=f==null?void 0:f.getBoundingClientRect(),w=(h==null?void 0:h.width)??180,x=(h==null?void 0:h.height)??Math.max(40,n.length*36),b=cx({x:e,y:t,menuWidth:w,menuHeight:x,viewport:p});i(C=>C.x===b.x&&C.y===b.y?C:b),l(!0)},[n.length,e,t]);return u.useLayoutEffect(()=>{d()},[d]),u.useEffect(()=>(window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}),[d]),a.jsx("div",{ref:r,className:"dropdown-panel fixed",role:"menu",style:{left:s.x,top:s.y,minWidth:180,visibility:o?"visible":"hidden"},onClick:f=>f.stopPropagation(),children:n.map((f,p)=>a.jsxs("button",{className:`dropdown-item w-full ${f.danger?"text-danger hover:text-danger":""}`,role:"menuitem","aria-disabled":f.disabled,disabled:f.disabled,onClick:h=>c(f,h),children:[f.icon&&a.jsx("span",{className:"shrink-0",children:f.icon}),a.jsx("span",{children:f.label})]},p))})}const uj="Refresh unavailable in read-only mode";function cj({refreshing:e,refreshEnabled:t,onRefresh:n}){return{label:t?e?"Refreshing":"Refresh":uj,disabled:!t||e,onClick:n}}function dg(e){return e==="csv"?"text/csv;charset=utf-8":"application/json;charset=utf-8"}function fg(e,t){const n=lj(e);return t==="csv"?oj(n):ij(n)}function hg(){return new Date().toISOString().replace(/[:.]/g,"-")}async function dj(e){return(await me.getFolder(e,{recursive:!0})).items}function fj({ctx:e,current:t,items:n,setCtx:r,refreshEnabled:s,onRefetch:i,onOpenMoveDialog:o,onRefreshFolder:l}){const c=FE(t),[d,f]=u.useState(!1),[p,h]=u.useState(null),w=e.kind==="grid"?e.payload.paths:[],x=u.useMemo(()=>new Map(n.map(j=>[j.path,j])),[n]),b=()=>{r(null)},C=async()=>{const j=e.kind==="tree"?e.payload.path:"/";f(!0);try{await l(j)}catch(I){console.error("Failed to refresh folder:",I)}finally{f(!1),b()}},y=j=>async()=>{h(j);const I=e.kind==="tree"?e.payload.path:t;try{const M=await dj(I),B=fg(M,j),F=dg(j),Q=I==="/"?"root":(I.replace(/^\/+/,"")||"root").replace(/\//g,"_");ko(new Blob([B],{type:F}),`metadata_${Q}_${hg()}.${j}`)}catch(M){console.error("Failed to export folder:",M),alert("Failed to export folder. See console for details.")}finally{h(null),b()}},m=j=>async()=>{h(j);try{const I=new Set(w),M=n.filter(Q=>I.has(Q.path)),B=fg(M,j),F=dg(j);ko(new Blob([B],{type:F}),`metadata_selection_${hg()}.${j}`)}finally{h(null),b()}},v=async()=>{var j;if(w.length){b();for(const I of w)try{const M=await me.getFile(I),B=((j=x.get(I))==null?void 0:j.name)||mh(I)||"image";ko(M,B)}catch(M){console.error(`Failed to download ${I}:`,M)}}},g=async()=>{if(!c){for(const j of w)try{await me.moveFile(j,"/_trash_")}catch(I){console.error(`Failed to trash ${j}:`,I)}i(),b()}},S=async()=>{if(confirm(`Delete ${w.length} file(s) permanently? This cannot be undone.`)){try{await me.deleteFiles(w)}catch(j){console.error("Failed to delete files:",j)}i(),b()}},E=async()=>{for(const j of w)try{const M=(await me.getSidecar(j)).original_position,B=M&&M.split("/").slice(0,-1).join("/")||"/";await me.moveFile(j,B)}catch(I){console.error(`Failed to recover ${j}:`,I)}i(),b()},T=e.kind==="tree"?[cj({refreshing:d,refreshEnabled:s,onRefresh:C}),{label:p==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!p||d,onClick:y("csv")},{label:p==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!p||d,onClick:y("json")}]:hj({selectedPaths:w,inTrash:c,exporting:p,onDownloadSelection:v,onMoveSelection:o,onMoveToTrash:g,onPermanentDelete:S,onRecover:E,onExportCsv:m("csv"),onExportJson:m("json")});return a.jsx(aj,{x:e.x,y:e.y,items:T})}function hj({selectedPaths:e,inTrash:t,exporting:n,onDownloadSelection:r,onMoveSelection:s,onMoveToTrash:i,onPermanentDelete:o,onRecover:l,onExportCsv:c,onExportJson:d}){const f=[];return e.length&&f.push({label:e.length>1?`Download (${e.length})`:"Download",onClick:r}),e.length&&f.push({label:"Move to",disabled:t,onClick:()=>{t||s(e)}}),f.push({label:"Move to trash",disabled:t,onClick:i}),t&&(f.push({label:"Permanent delete",danger:!0,onClick:o}),f.push({label:"Recover",onClick:l})),e.length&&(f.push({label:n==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!n,onClick:c}),f.push({label:n==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!n,onClick:d})),f}function Hl(e){const t=u.useRef(e);return t.current=e,t}function pj(e,t){return t?e.some(n=>{var s;const r=(s=n.metrics)==null?void 0:s[t];return r!=null&&!Number.isNaN(r)}):!1}function mj(e,t){const n={0:0,1:0,2:0,3:0,4:0,5:0};for(const r of e){const s=t[r.path]??r.star??0,i=String(s);n[i]=(n[i]||0)+1}return n}function gj(e,t=250){const n=new Set;let r=0;for(const s of e){const i=s.metrics;if(i)for(const o of Object.keys(i))n.add(o);if(r+=1,r>=t&&n.size>0)break}return Array.from(n).sort()}function yj(e,t,n,r){return e||t?n:r}function vj(e,t,n,r,s,i){return e?n:t||i==="/"?r:s}function xj(e){if(!e)return null;if(e.queryPath){const t=e.queryPath.split("/").filter(Boolean);return t.length?t[t.length-1]:e.queryPath}return e.queryVector?"Vector query":null}function wj(e,t,n,r){return e?t>0?`${n} of ${r}`:`${r}`:null}function bj(e){return!e.similarityActive&&!e.searching&&e.itemCount===0&&e.isLoading}const Sj=(e,t)=>["search",e,t],Cj=2e4,Ql="/";function kj(e){return e.trim().replace(/\s+/g," ")}function s0(e){const t=e.trim();return!t||t===Ql?Ql:t.startsWith(Ql)?t:`${Ql}${t}`}function vh(e,t){const n=kj(e);return n?{q:n,path:s0(t)}:null}function Ej(e){return!Array.isArray(e)||e[0]!=="search"||typeof e[1]!="string"||typeof e[2]!="string"?null:vh(e[1],e[2])}function Nj(e,t){if(!t)return!1;const n=Ej(e);return n?n.path===t.path:!1}function jj(e,t){const n=vu(),r=vh(e,t),s=Sj((r==null?void 0:r.q)??"",(r==null?void 0:r.path)??s0(t));return pu({enabled:r!==null,queryKey:s,queryFn:()=>r?me.search(r.q,r.path):Promise.resolve({items:[]}),staleTime:3e3,gcTime:6e4,placeholderData:(i,o)=>{if(Nj(o==null?void 0:o.queryKey,r))return i},retry:1,refetchInterval:n?Cj:!1,refetchIntervalInBackground:n})}const Mj=()=>["embeddings"];function Rj(){return pu({queryKey:Mj(),queryFn:me.getEmbeddings,staleTime:6e4,gcTime:5*6e4,retry:1,refetchOnWindowFocus:!1})}function Pj(e,t=250){const[n,r]=Jr.useState(e);return Jr.useEffect(()=>{const s=window.setTimeout(()=>r(e),Math.max(0,t));return()=>window.clearTimeout(s)},[e,t]),n}function pg(e){return e.addedAt?Date.parse(e.addedAt):0}function Ya(e,t){return e.name.localeCompare(t.name)}function Tj(e,t){const n=pg(e),r=pg(t);return n===r?Ya(e,t):n-r}function Ij(e){return(t,n)=>{var i,o;const r=(i=t.metrics)==null?void 0:i[e],s=(o=n.metrics)==null?void 0:o[e];return r==null&&s==null?Ya(t,n):r==null?1:s==null?-1:r===s?Ya(t,n):r-s}}function mg(e,t){return zE(e,t)}function Lj(e){let t=e>>>0;return()=>{t+=1831565813;let n=Math.imul(t^t>>>15,1|t);return n^=n+Math.imul(n^n>>>7,61|n),((n^n>>>14)>>>0)/4294967296}}function _j(e,t){const n=Lj(t||1),r=[...e];for(let s=r.length-1;s>0;s-=1){const i=Math.floor(n()*(s+1));[r[s],r[i]]=[r[i],r[s]]}return r}function Aj(e,t,n){if(t.kind==="builtin"&&t.key==="random"){const i=n??Date.now();return _j(e,i)}let r=Tj;t.kind==="metric"?r=Ij(t.key):t.key==="name"&&(r=Ya);const s=[...e].sort(r);return t.dir==="desc"?s.reverse():s}function Fj(e,t){return e?t instanceof ln||t instanceof Error?t.message:"Failed to load embeddings.":null}function Oj({current:e,query:t,similarityState:n,scanStableMode:r=!1,viewState:s,randomSeed:i,localStarOverrides:o,sessionResetToken:l=0,onFolderHydratedSnapshot:c,getCachedHydratedSnapshot:d}){var _,G;const f=wr(),{data:p,refetch:h,isLoading:w,isError:x}=sf(e,!0),[b,C]=u.useState(),y=u.useRef(0),m=u.useCallback(()=>h(),[h]),{data:v}=sf("/",!0,{enabled:!1});u.useEffect(()=>{f.removeQueries({predicate:({queryKey:V})=>gN(V,e,!0)})},[e,f]),u.useEffect(()=>{y.current+=1,bS({requestId:y.current});const V=(d==null?void 0:d(e))??null;C(V??void 0)},[e,d,l]),u.useEffect(()=>()=>{qS()},[e]),u.useEffect(()=>{if(!p)return;const V=y.current;u.startTransition(()=>{C(p),c==null||c(p.path,p)}),SS(V)},[c,p]);const g=n!==null,S=Pj(t,250),E=u.useMemo(()=>g?null:vh(S,e),[g,S,e]),T=E!==null,j=(E==null?void 0:E.q)??"",I=jj((E==null?void 0:E.q)??"",(E==null?void 0:E.path)??e),M=Rj(),B=((_=M.data)==null?void 0:_.embeddings)??[],F=((G=M.data)==null?void 0:G.rejected)??[],Q=B.length>0,ee=Fj(M.isError,M.error),z=u.useMemo(()=>{var J;return(T?((J=I.data)==null?void 0:J.items)??[]:(b==null?void 0:b.items)??[]).map(se=>({...se,star:o[se.path]!==void 0?o[se.path]:se.star}))},[T,I.data,b,o]),L=u.useMemo(()=>{var se;const V=new Map;for(const Y of z)V.set(Y.path,Y);const J=((se=I.data)==null?void 0:se.items)??[];for(const Y of J){if(V.has(Y.path))continue;const q=o[Y.path]!==void 0?o[Y.path]:Y.star;V.set(Y.path,{...Y,star:q})}return V},[z,I.data,o]),R=u.useMemo(()=>n?n.items.map(V=>{const J=L.get(V.path);return J||hE(V.path,o[V.path])}):[],[n,L,o]),P=u.useMemo(()=>{if(n)return mg(R,s.filters);const V=mg(z,s.filters);return r?V:Aj(V,s.sort,i)},[n,R,z,r,s.filters,s.sort,i]),A=n?R.length:z.length,O=P.length,K=(b==null?void 0:b.totalItems)??(b==null?void 0:b.items.length)??A,U=e==="/"?K:(v==null?void 0:v.totalItems)??(v==null?void 0:v.items.length)??K;return{data:b,refetch:m,isLoading:w,isError:x,searching:T,normalizedQ:j,similarityActive:g,embeddings:B,embeddingsRejected:F,embeddingsAvailable:Q,embeddingsLoading:M.isLoading,embeddingsError:ee,poolItems:z,similarityItems:R,items:P,totalCount:A,filteredCount:O,scopeTotal:K,rootTotal:U}}function Dj({current:e,itemPaths:t,items:n,selectionPool:r,focusGridCell:s}){const[i,o]=u.useState([]),[l,c]=u.useState(null),[d,f]=u.useState(!1),[p,h]=u.useState(0),[w,x]=u.useState(0),b=u.useRef(!1),C=u.useRef(!1),y=u.useRef(null),m=u.useMemo(()=>new Set(i),[i]),v=u.useMemo(()=>{if(!i.length)return[];const q=new Map(r.map(fe=>[fe.path,fe])),H=new Map(n.map(fe=>[fe.path,fe]));return i.map(fe=>q.get(fe)??H.get(fe)).filter(fe=>!!fe)},[i,r,n]),g=u.useMemo(()=>n.filter(q=>m.has(q.path)),[n,m]),S=u.useMemo(()=>g.map(q=>q.path),[g]),E=Math.max(0,g.length-2),T=Math.min(p,E),j=g[T]??null,I=g[T+1]??null,M=T>0,B=T<g.length-2,F=g.length>=2,Q=l!=null||d,ee=l??i[0]??null,z=ee?t.indexOf(ee):-1,L=z>0,R=z>=0&&z<t.length-1;u.useEffect(()=>{h(q=>q>E?E:q)},[E]);const P=u.useCallback(()=>{x(q=>q+1)},[]),A=u.useCallback(q=>{y.current=q},[]),O=u.useCallback(()=>{c(null),b.current=!1},[]),K=u.useCallback(q=>{if(q){c(q),o([q]);return}O()},[O]),U=u.useCallback(q=>{l&&(c(null),b.current=!1,Ul(q))},[l]),_=u.useCallback(q=>{c(q),b.current=!0,Ox(q)},[]),G=u.useCallback(()=>{c(null),b.current?(b.current=!1,window.history.back()):Ul(e),s(y.current)},[e,s]),V=u.useCallback(()=>{d||!F||(i[0]&&(y.current=i[0]),h(0),f(!0),l&&(c(null),b.current&&(b.current=!1),Ul(e)),C.current||(window.history.pushState({compare:!0},"",window.location.href),C.current=!0))},[d,F,e,i,l]),J=u.useCallback(()=>{f(!1),C.current&&(C.current=!1,window.history.back()),s(y.current??i[0])},[s,i]),se=u.useCallback(q=>{g.length<2||h(H=>{const fe=Math.max(0,g.length-2);return Math.min(fe,Math.max(0,H+q))})},[g.length]),Y=u.useCallback(q=>{if(!t.length)return;const H=l??i[0];if(!H)return;const fe=t.indexOf(H);if(fe===-1)return;const Te=Math.min(t.length-1,Math.max(0,fe+q)),we=t[Te];!we||we===H||(l&&(c(we),Ul(we)),o([we]))},[t,i,l]);return u.useEffect(()=>{d&&(F||J())},[d,F,J]),u.useEffect(()=>{const q=()=>{l&&(b.current=!1,c(null)),d&&(C.current=!1,f(!1))};return window.addEventListener("popstate",q),()=>window.removeEventListener("popstate",q)},[l,d]),{selectedPaths:i,setSelectedPaths:o,viewer:l,compareOpen:d,restoreGridToSelectionToken:w,bumpRestoreGridToSelectionToken:P,selectedItems:v,compareItems:g,comparePaths:S,compareIndexClamped:T,compareA:j,compareB:I,canComparePrev:M,canCompareNext:B,compareEnabled:F,canPrevImage:L,canNextImage:R,overlayActive:Q,rememberFocusedPath:A,openViewer:_,closeViewer:G,openCompare:V,closeCompare:J,handleCompareNavigate:se,handleNavigate:Y,resetViewerState:O,clearViewerForSearch:U,syncHashImageSelection:K}}const zj=2048,$j=6,Bj=10;function i0(e){const t=new Map;for(const n of e)t.set(n.path,n.name);return t}function o0(e,t){return t.get(e)??e.split("/").pop()??e}function gg(e,t){const n=e.filter(r=>!t.has(r.path));return n.length===e.length?e:n}function yg(e,t,n,r,s){const i=e.filter(l=>l.path!==t);return[{path:t,ts:n,kind:r},...i].slice(0,s)}function Uj(e,t){if(!e.length)return null;const n=i0(t),r=new Set,s=[];for(const o of e)r.has(o.path)||(r.add(o.path),s.push(o.path));const i=s.slice(0,2).map(o=>o0(o,n));return{count:s.length,names:i,extra:Math.max(0,s.length-i.length)}}function Vj(e,t,n,r){if(!e.length)return[];const s=i0(t);return e.map(i=>({path:i.path,label:o0(i.path,s),timeLabel:r(i.ts,n)}))}function Wj(e){const[t,n]=u.useState([]),[r,s]=u.useState([]),[i,o]=u.useState(new Map),l=u.useRef(new Map),c=u.useRef(new Set),d=u.useRef(new Set),f=u.useRef(new Set);u.useEffect(()=>()=>{for(const C of l.current.values())window.clearTimeout(C);l.current.clear(),c.current.clear()},[]),u.useEffect(()=>{d.current=new Set(e),n(C=>gg(C,f.current))},[e]);const p=u.useCallback((C,y)=>{if(y!=null){if(c.current.has(y))return;if(c.current.add(y),c.current.size>zj){const E=c.current.values().next().value;E!=null&&c.current.delete(E)}}const m=y!=null?`event:${y}`:`event:${C}:${Date.now()}`;o(E=>{if(E.get(C)===m)return E;const T=new Map(E);return T.set(C,m),T});const v=l.current,g=v.get(C);g!=null&&window.clearTimeout(g);const S=window.setTimeout(()=>{o(E=>{if(E.get(C)!==m)return E;const T=new Map(E);return T.delete(C),T}),v.delete(C)},ej);v.set(C,S)},[]),h=u.useCallback(C=>{f.current=C,n(y=>gg(y,C))},[]),w=u.useCallback((C,y,m)=>{const v=Date.now();d.current.has(C)&&f.current.has(C)||n(S=>yg(S,C,v,y,$j)),p(C,m)},[p]),x=u.useCallback((C,y,m)=>{const v=Date.now(),g=Mx(m)??v;s(S=>yg(S,C,g,y,Bj))},[]),b=u.useCallback(()=>{n([])},[]);return{offViewActivity:t,recentTouches:r,highlightedPaths:i,onVisiblePathsChange:h,markRecentActivity:w,markRecentTouch:x,clearOffViewActivity:b}}function vg(e){if(typeof e!="number"||!Number.isFinite(e))return;const t=Math.trunc(e);return t<0?0:t}function Hj(e){if(typeof e!="string")return;const t=e.trim();return t.length?t:void 0}function Qj(e){if(!e)return null;const t=e.state;if(t!=="idle"&&t!=="running"&&t!=="ready"&&t!=="error")return null;let n=vg(e.done);const r=vg(e.total);return n!==void 0&&r!==void 0&&n>r&&(n=r),{state:t,scope:typeof e.scope=="string"?e.scope:void 0,done:n,total:r,generation:Hj(e.generation),started_at:typeof e.started_at=="string"?e.started_at:void 0,finished_at:typeof e.finished_at=="string"?e.finished_at:void 0,error:typeof e.error=="string"?e.error:void 0}}function Kj(e,t){return e===t?!0:!e||!t?!1:e.state===t.state&&e.scope===t.scope&&e.done===t.done&&e.total===t.total&&e.generation===t.generation&&e.started_at===t.started_at&&e.finished_at===t.finished_at&&e.error===t.error}function qj(e){return(e==null?void 0:e.state)==="idle"||(e==null?void 0:e.state)==="running"}function Gj(e,t,n){return(e==null?void 0:e.state)==="running"?t:n}const l0=[1],Yj={supportedVersions:[...l0],maxPathsV2:null,supportsV2:!1};function Xj(e){if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.trunc(e);return t>0?t:null}function Jj(e){if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.trunc(e);return t>=2?t:null}function Zj(e){let t=[...l0];const n=e==null?void 0:e.supported_versions;if(Array.isArray(n)){const i=Array.from(new Set(n.map(o=>Xj(o)).filter(o=>o!==null))).sort((o,l)=>o-l);i.length>0&&(t=i)}const r=Jj(e==null?void 0:e.max_paths_v2),s=t.includes(2)&&r!==null&&r>2;return{supportedVersions:t,maxPathsV2:r,supportsV2:s}}function eM(e,t){if(e===t)return!0;if(e.supportsV2!==t.supportsV2||e.maxPathsV2!==t.maxPathsV2||e.supportedVersions.length!==t.supportedVersions.length)return!1;for(let n=0;n<e.supportedVersions.length;n+=1)if(e.supportedVersions[n]!==t.supportedVersions[n])return!1;return!0}const tM=1200,xg=3e3;function nM(e){switch(e){case"live":return"Live";case"reconnecting":return"Reconnecting";case"offline":return"Offline";case"connecting":case"idle":default:return"Connecting"}}function wg(e){if(!(e instanceof ln))return null;const t=e.body;if(!t||typeof t!="object")return null;const n=t.error;return typeof n=="string"?n:null}function bg(e,t){return t-e<XN?_k(e,t):Ak(e)}function rM({current:e,currentGalleryId:t,itemPaths:n,items:r,queryClient:s,updateItemCaches:i,setLocalStarOverrides:o}){const l=u.useRef(Ai()),c=u.useRef(null),d=u.useRef(null),f=u.useRef(null),p=u.useRef(!1),h=u.useRef(null),w=u.useRef("idle"),[x,b]=u.useState("idle"),[C,y]=u.useState({}),[m,v]=u.useState(null),[g,S]=u.useState(null),[E,T]=u.useState(!1),[j,I]=u.useState(()=>Date.now()),[M,B]=u.useState(!0),[F,Q]=u.useState(null),[ee,z]=u.useState(null),[L,R]=u.useState(Yj);u.useEffect(()=>{if(g==null){T(!1);return}T(!0);const le=window.setTimeout(()=>T(!1),GN);return()=>window.clearTimeout(le)},[g]),u.useEffect(()=>{if(m==null)return;I(Date.now());const le=window.setInterval(()=>I(Date.now()),1e4);return()=>window.clearInterval(le)},[m]);const{offViewActivity:P,recentTouches:A,highlightedPaths:O,onVisiblePathsChange:K,markRecentActivity:U,markRecentTouch:_,clearOffViewActivity:G}=Wj(n),V=u.useCallback(le=>{const oe=Date.now(),Ie=Mx(le)??oe,Se=Ie>oe?oe:Ie;v(ce=>ce==null?Se:ce>Se?ce:Se),S(oe),I(oe)},[]),J=u.useCallback(le=>{le.length&&y(oe=>{let ge=!1;const Ie={...oe};for(const Se of le){const ce=oe[Se.gallery_id];ce&&ce.viewing===Se.viewing&&ce.editing===Se.editing||(Ie[Se.gallery_id]=Se,ge=!0)}return ge?Ie:oe})},[]),se=u.useCallback(()=>{h.current!=null&&(window.clearTimeout(h.current),h.current=null)},[]),Y=u.useCallback(le=>{le&&y(oe=>{if(!(le in oe))return oe;const ge={...oe};return delete ge[le],ge})},[]),q=u.useCallback(le=>{c.current=le.lease_id,d.current=le.gallery_id,J([le])},[J]),H=u.useCallback(async(le,oe=!1)=>{const ge=l.current,Ie=oe?void 0:c.current??void 0,Se=ce=>me.joinPresence(le,ce,ge);try{q(await Se(Ie));return}catch(ce){if(!oe&&wg(ce)==="invalid_lease"){q(await Se(void 0));return}throw ce}},[q]),fe=u.useCallback(async(le,oe)=>{if(le===oe){await H(oe);return}const ge=c.current;if(!ge){await H(oe,!0);return}try{const Ie=await me.movePresence(le,oe,ge,l.current);d.current=Ie.to_scope.gallery_id,J([Ie.from_scope,Ie.to_scope]);return}catch(Ie){const Se=wg(Ie);if(Se==="invalid_lease"){await H(oe,!0);return}if(Se==="scope_mismatch"){await H(oe);return}throw Ie}},[J,H]),Te=u.useCallback(async le=>{const oe=d.current;if(!oe){await H(le,!0);return}if(oe===le){await H(le);return}await fe(oe,le)},[H,fe]),we=u.useCallback(async()=>{if(p.current)return;const le=f.current;if(le){f.current=null,p.current=!0;try{await Te(le)}catch{}finally{p.current=!1;const oe=f.current;oe&&oe!==d.current&&we()}}},[Te]),he=u.useCallback((le,oe=!1)=>{if(f.current=le,se(),oe||d.current==null){we();return}h.current=window.setTimeout(()=>{h.current=null,we()},ZN)},[se,we]),ze=u.useCallback(()=>{d.current=null,c.current=null,f.current=null,se()},[se]),Ue=u.useCallback(le=>{const oe=d.current,ge=c.current;!oe||!ge||(YS(oe,ge,l.current),le&&Y(oe),ze())},[Y,ze]);u.useEffect(()=>{US();const le=WS(ge=>{if(ge.type==="presence"){const ce=ge.data;if(!(ce!=null&&ce.gallery_id))return;J([ce]);return}const Ie=ge.data;if(!(Ie!=null&&Ie.path))return;const Se=Ie.path;if(ge.type==="item-updated"){const ce=ge.data,Fe={v:1,tags:ce.tags??[],notes:ce.notes??"",star:ce.star??null,version:ce.version??1,updated_at:ce.updated_at??"",updated_by:ce.updated_by??"server"};s.setQueryData(Wo(Se),Fe),i({path:Se,star:ce.star??null,metrics:ce.metrics,comments:ce.notes??""}),Ck(Se,Fe),U(Se,"item-updated",ge.id),_(Se,"item-updated",ce.updated_at),V(ce.updated_at),o(Ge=>{if(Ge[Se]===void 0)return Ge;const et={...Ge};return delete et[Se],et})}else if(ge.type==="metrics-updated"){const ce=ge.data;i({path:Se,metrics:ce.metrics}),U(Se,"metrics-updated",ge.id),_(Se,"metrics-updated",ce.updated_at),V(ce.updated_at)}}),oe=HS(b);return()=>{le(),oe(),VS()}},[J,U,_,s,o,i,V]),u.useEffect(()=>{const le=d.current;le!==t&&he(t,le==null)},[t,he]),u.useEffect(()=>{const le=window.setInterval(()=>{const oe=d.current;oe&&H(oe)},JN);return()=>{window.clearInterval(le)}},[H]),u.useEffect(()=>{const le=w.current;if(w.current=x,x==="live"&&le!=="live"){he(t,!0);return}(x==="reconnecting"||x==="offline")&&Y(d.current)},[Y,x,t,he]),u.useEffect(()=>{const le=()=>Ue(!0),oe=()=>Ue(!0),ge=()=>{he(t,!0)};return window.addEventListener("pagehide",le),window.addEventListener("beforeunload",oe),window.addEventListener("pageshow",ge),()=>{window.removeEventListener("pagehide",le),window.removeEventListener("beforeunload",oe),window.removeEventListener("pageshow",ge),Ue(!1)}},[t,he,Ue]),u.useEffect(()=>{let le=!1,oe=null;const ge=()=>{oe!=null&&(window.clearTimeout(oe),oe=null)},Ie=ce=>{ge(),oe=window.setTimeout(()=>{Se()},ce)},Se=async()=>{var ce;try{const Fe=await me.getHealth();if(le)return;B(((ce=Fe==null?void 0:Fe.labels)==null?void 0:ce.enabled)??!0);const Ge=(Fe==null?void 0:Fe.mode)??null;Q(Ge);const et=Qj(Fe==null?void 0:Fe.indexing);z(gt=>Kj(gt,et)?gt:et);const kn=Zj(Fe==null?void 0:Fe.compare_export);R(gt=>eM(gt,kn)?gt:kn),qj(et)&&Ie(Gj(et,tM,xg))}catch{if(le)return;Ie(xg)}};return Se(),()=>{le=!0,ge()}},[]);const Tt=C[e],Bt=(Tt==null?void 0:Tt.editing)??0,Ut=m!=null,Dn=u.useMemo(()=>nM(x),[x]),tn=u.useMemo(()=>!Ut||m==null?"No edits yet.":bg(m,j),[Ut,m,j]),Cn=u.useMemo(()=>Uj(P,r),[P,r]),Vt=u.useMemo(()=>Vj(A,r,j,bg),[r,j,A]);return{connectionStatus:x,connectionLabel:Dn,presence:Tt,editingCount:Bt,recentEditActive:E,hasEdits:Ut,lastEditedLabel:tn,persistenceEnabled:M,healthMode:F,indexing:ee,compareExportCapability:L,highlightedPaths:O,onVisiblePathsChange:K,offViewSummary:Cn,recentTouchesDisplay:Vt,clearOffViewActivity:G}}const sM=600;function iM(e){if(!(e instanceof ln))return!1;if(e.status===403||e.status===405)return!0;const t=String(e.message||"").toLowerCase();return t.includes("read-only")||t.includes("no-write")||t.includes("write")}function oo(e,t){return iM(e)?"This workspace is read-only. Upload and move actions are disabled.":e instanceof ln||e instanceof Error&&e.message?e.message:t}function Lc(e){return Array.from(new Set(e.filter(Boolean)))}function Sg(e,t){return t.length?t.length===1?t[0]:`${e} failed for ${t.length} item(s). ${t[0]}`:""}async function oM(){const e=["/"],t=new Set,n=new Set(["/"]);for(;e.length>0&&t.size<sM;){const r=e.shift()??"/",s=Rt(r);if(t.has(s))continue;t.add(s);let i=null;try{i=await me.getFolder(s)}catch{i=null}if(i)for(const o of i.dirs??[]){const l=Rt(Dx(s,o.name));n.has(l)||(n.add(l),e.push(l))}}return Array.from(n).sort((r,s)=>r==="/"?-1:s==="/"?1:r.localeCompare(s))}function lM({appRef:e,uploadInputRef:t,current:n,currentDirCount:r,selectedPaths:s,setSelectedPaths:i,refetch:o,invalidateDerivedCounts:l}){const c=wr(),[d,f]=u.useState(!1),[p,h]=u.useState(null),[w,x]=u.useState(!1),[b,C]=u.useState(null),[y,m]=u.useState(["/"]),[v,g]=u.useState(!1),[S,E]=u.useState(null);u.useEffect(()=>{h(null)},[n]);const T=u.useCallback(L=>{const R=Lc(s);return R.includes(L)?R:[L]},[s]),j=u.useCallback((L,R)=>{const P=T(L);i(P),E({x:R.x,y:R.y,kind:"grid",payload:{paths:P}})},[T,i]),I=u.useCallback((L,R)=>{E({x:R.x,y:R.y,kind:"tree",payload:{path:L}})},[]);u.useEffect(()=>{if(!b)return;let L=!1;return g(!0),oM().then(R=>{L||m(R)}).catch(R=>{L||h(oo(R,"Failed to load destination folders."))}).finally(()=>{L||g(!1)}),()=>{L=!0}},[b]);const M=u.useCallback(async(L,R)=>{const P=Lc(L);if(!P.length)return!1;const A=Rt(R||"/");h(null);const O=[],K=[];for(const _ of P)try{await me.moveFile(_,A)}catch(G){O.push(`${mh(_)||_}: ${oo(G,"Move failed.")}`),K.push(_)}try{await c.invalidateQueries({predicate:({queryKey:_})=>Array.isArray(_)&&_[0]==="folder"}),l(),await o()}catch(_){O.push(oo(_,"Move completed, but refresh failed."))}if(O.length)return h(Sg("Move",O)),i(K),!1;C(null),E(null);const U=new Set(P);return i(_=>_.filter(G=>!U.has(G))),!0},[l,c,o,i]),B=u.useCallback(L=>{const R=Lc(L);R.length&&(h(null),C({paths:R}),E(null))},[]),F=u.useCallback(async L=>{if(!L.length)return;if(!(r===0)){h("Uploads are only allowed into folders without subdirectories.");return}f(!0),h(null);const P=[];try{for(const A of L)try{await me.uploadFile(n,A)}catch(O){P.push(`${A.name}: ${oo(O,"Upload failed.")}`)}try{await o()}catch(A){P.push(oo(A,"Upload completed, but refresh failed."))}}finally{f(!1)}if(P.length){h(Sg("Upload",P));return}h(null)},[n,r,o]),Q=u.useCallback(()=>{var L;d||(L=t.current)==null||L.click()},[t,d]),ee=u.useCallback(async L=>{const R=Array.from(L.target.files??[]);L.target.value="",R.length&&await F(R)},[F]);u.useEffect(()=>{const L=e.current;if(!L)return;const R=O=>{O.dataTransfer&&Array.from(O.dataTransfer.types).includes("Files")&&(O.preventDefault(),x(!0))},P=O=>{const K=O.relatedTarget;K&&L.contains(K)||x(!1)},A=async O=>{var U;O.preventDefault(),x(!1);const K=Array.from(((U=O.dataTransfer)==null?void 0:U.files)??[]);K.length&&await F(K)};return L.addEventListener("dragover",R),L.addEventListener("dragleave",P),L.addEventListener("drop",A),()=>{L.removeEventListener("dragover",R),L.removeEventListener("dragleave",P),L.removeEventListener("drop",A)}},[e,F]),u.useEffect(()=>{const L=()=>E(null),R=P=>{P.key==="Escape"&&E(null)};return window.addEventListener("click",L),window.addEventListener("keydown",R),()=>{window.removeEventListener("click",L),window.removeEventListener("keydown",R)}},[]);const z=u.useCallback(()=>{C(null)},[]);return{uploading:d,actionError:p,isDraggingOver:w,moveDialog:b,moveFolders:y,moveFoldersLoading:v,ctx:S,setCtx:E,closeMoveDialog:z,openUploadPicker:Q,handleUploadInputChange:ee,openGridActions:j,openFolderActions:I,openMoveDialogForPaths:B,moveSelectedToFolder:M}}function Fn(e){const t=e.trim();return!t||t==="/"?"/":t.startsWith("/")?t:`/${t}`}function a0(e,t){const n=Fn(t),r=e[n];return r||{path:n,hydratedSnapshot:null,hydratedGeneratedAt:null,hydratedItemCount:0,hydratedAtMs:null,topAnchorPath:null}}function lf(e,t){return t==="/"?!0:e===t||e.startsWith(`${t}/`)}function aM(e){for(const t of e)return t;return null}function uM(e,t,n,r){const s=a0(e,t),i={...s,path:Fn(t),hydratedSnapshot:n,hydratedGeneratedAt:n.generatedAt??null,hydratedItemCount:n.totalItems??n.items.length,hydratedAtMs:r};return s.hydratedSnapshot===i.hydratedSnapshot&&s.hydratedGeneratedAt===i.hydratedGeneratedAt&&s.hydratedItemCount===i.hydratedItemCount&&s.hydratedAtMs===i.hydratedAtMs?e:{...e,[i.path]:i}}function Cg(e,t,n){const r=a0(e,t),s=Fn(t),i=n?Fn(n):null;return r.topAnchorPath===i&&r.path===s?e:{...e,[s]:{...r,path:s,topAnchorPath:i}}}function u0(e,t){const n=Fn(t);if(!e[n])return e;const r={...e};return delete r[n],r}function cM(e,t){const n=Fn(t);let r=!1;const s={...e};for(const i of Object.keys(s))lf(i,n)&&(r=!0,delete s[i]);return r?s:e}function dM(e,t){const n=Fn(e),r=Fn(t);return!!(n===r||lf(n,r)||lf(r,n))}function fM(e,t,n){return dM(t,n)?e:u0(e,n)}function hM(){const e=u.useRef({}),t=u.useCallback(p=>e.current[Fn(p)]??null,[]),n=u.useCallback(p=>{var h;return((h=e.current[Fn(p)])==null?void 0:h.hydratedSnapshot)??null},[]),r=u.useCallback(p=>{var h;return((h=e.current[Fn(p)])==null?void 0:h.topAnchorPath)??null},[]),s=u.useCallback((p,h)=>{e.current=uM(e.current,p,h,Date.now())},[]),i=u.useCallback((p,h)=>{e.current=Cg(e.current,p,h)},[]),o=u.useCallback((p,h)=>{const w=aM(h);w&&(e.current=Cg(e.current,p,w))},[]),l=u.useCallback(p=>{e.current=u0(e.current,p)},[]),c=u.useCallback(p=>{e.current=cM(e.current,p)},[]),d=u.useCallback((p,h)=>{e.current=fM(e.current,p,h)},[]),f=u.useCallback(()=>{e.current={}},[]);return u.useMemo(()=>({getSession:t,getHydratedSnapshot:n,getTopAnchorPath:r,saveHydratedSnapshot:s,saveTopAnchorPath:i,saveTopAnchorFromVisiblePaths:o,invalidatePath:l,invalidateSubtree:c,invalidateForScopeTransition:d,clearAllSessions:f}),[t,n,r,s,i,o,l,c,d,f])}const pM={stars:{read:e=>{const t=e.stars||[];return t.length?{id:"stars",label:`Rating in: ${Rc(t)}`}:null},clear:(e,t)=>t.clearStars()},starsIn:{read:e=>{const t=e.starsIn.values||[];return t.length?{id:"stars-in",label:`Rating in: ${Rc(t)}`}:null},clear:(e,t)=>t.clearStars()},starsNotIn:{read:e=>{const t=e.starsNotIn.values||[];return t.length?{id:"stars-not-in",label:`Rating not in: ${Rc(t)}`}:null},clear:(e,t)=>t.clearStarsNotIn()},nameContains:{read:e=>{var n;const t=(n=e.nameContains.value)==null?void 0:n.trim();return t?{id:"name-contains",label:`Filename contains: ${t}`}:null},clear:(e,t)=>t.clearNameContains()},nameNotContains:{read:e=>{var n;const t=(n=e.nameNotContains.value)==null?void 0:n.trim();return t?{id:"name-not-contains",label:`Filename not: ${t}`}:null},clear:(e,t)=>t.clearNameNotContains()},commentsContains:{read:e=>{var n;const t=(n=e.commentsContains.value)==null?void 0:n.trim();return t?{id:"comments-contains",label:`Comments contain: ${t}`}:null},clear:(e,t)=>t.clearCommentsContains()},commentsNotContains:{read:e=>{var n;const t=(n=e.commentsNotContains.value)==null?void 0:n.trim();return t?{id:"comments-not-contains",label:`Comments not: ${t}`}:null},clear:(e,t)=>t.clearCommentsNotContains()},urlContains:{read:e=>{var n;const t=(n=e.urlContains.value)==null?void 0:n.trim();return t?{id:"url-contains",label:`URL contains: ${t}`}:null},clear:(e,t)=>t.clearUrlContains()},urlNotContains:{read:e=>{var n;const t=(n=e.urlNotContains.value)==null?void 0:n.trim();return t?{id:"url-not-contains",label:`URL not: ${t}`}:null},clear:(e,t)=>t.clearUrlNotContains()},dateRange:{read:e=>{const{from:t,to:n}=e.dateRange;return!t&&!n?null:{id:"date-range",label:`Date: ${aE(t,n)}`}},clear:(e,t)=>t.clearDateRange()},widthCompare:{read:e=>({id:"width-compare",label:`Width ${e.widthCompare.op} ${e.widthCompare.value}`}),clear:(e,t)=>t.clearWidthCompare()},heightCompare:{read:e=>({id:"height-compare",label:`Height ${e.heightCompare.op} ${e.heightCompare.value}`}),clear:(e,t)=>t.clearHeightCompare()},metricRange:{read:e=>({id:`metric:${e.metricRange.key}`,label:`${e.metricRange.key}: ${dE(e.metricRange.min,e.metricRange.max)}`}),clear:(e,t)=>t.clearMetricRange(e.metricRange.key)}};function mM(e,t){if("stars"in e)return t("stars",e);if("starsIn"in e)return t("starsIn",e);if("starsNotIn"in e)return t("starsNotIn",e);if("nameContains"in e)return t("nameContains",e);if("nameNotContains"in e)return t("nameNotContains",e);if("commentsContains"in e)return t("commentsContains",e);if("commentsNotContains"in e)return t("commentsNotContains",e);if("urlContains"in e)return t("urlContains",e);if("urlNotContains"in e)return t("urlNotContains",e);if("dateRange"in e)return t("dateRange",e);if("widthCompare"in e)return t("widthCompare",e);if("heightCompare"in e)return t("heightCompare",e);if("metricRange"in e)return t("metricRange",e)}function gM(e,t){const n=[];for(const r of e.and)mM(r,(s,i)=>{const o=pM[s],l=o.read(i);l&&n.push({id:l.id,label:l.label,onRemove:()=>o.clear(i,t)})});return n}function bu(e){if(typeof e!="string")return null;const t=e.trim();return t.length?t:null}function yM(e,t){const n=bu(t==null?void 0:t.generation);return n&&(e===null||(t==null?void 0:t.state)==="idle"||(t==null?void 0:t.state)==="running")?n:e}function vM(e,t){const r=bu(e==null?void 0:e.generation)??((e==null?void 0:e.state)==="ready"?t.scanGeneration:null),s=r!==null&&t.scanGeneration===r&&t.recentGeneration!==r,i=s&&(e==null?void 0:e.state)==="ready";return{scanStableActive:s,sortLocked:s,showSwitchToMostRecentBanner:i}}const tt={sortKey:"sortKey",sortDir:"sortDir",sortSpec:"sortSpec",starFilters:"starFilters",filterAst:"filterAst",selectedMetric:"selectedMetric",viewMode:"viewMode",gridItemSize:"gridItemSize",leftOpen:"leftOpen",rightOpen:"rightOpen"},Kl={scanGeneration:"indexingScanGeneration",recentGeneration:"indexingMostRecentGeneration"};function kg(e){if(typeof window>"u")return null;try{const t=window.localStorage.getItem(e);return bu(t)}catch{return null}}function Eg(e,t){if(!(typeof window>"u"))try{window.localStorage.setItem(e,t)}catch{}}function Ng(e,t){for(const n of e)me.prefetchFile(n,t),me.prefetchThumb(n)}function xM(){var _h;const[e,t]=u.useState("/"),[n,r]=u.useState(""),[s,i]=u.useState(!1),[o,l]=u.useState(null),[c,d]=u.useState(null),[f,p]=u.useState(100),[h,w]=u.useState(null),[x,b]=u.useState(()=>({filters:{and:[]},sort:{kind:"builtin",key:"added",dir:"desc"},selectedMetric:void 0})),[C,y]=u.useState(()=>Date.now()),[m,v]=u.useState("adaptive"),[g,S]=u.useState(220),[E,T]=u.useState(!1),[j,I]=u.useState(!0),[M,B]=u.useState(!0),[F,Q]=u.useState(()=>typeof window>"u"?1440:window.innerWidth),ee=aa(la.narrow),[z,L]=u.useState("folders"),[R,P]=u.useState([]),[A,O]=u.useState(null),[K,U]=u.useState(0),[_,G]=u.useState(()=>kg(Kl.scanGeneration)),[V,J]=u.useState(()=>kg(Kl.recentGeneration)),[se,Y]=u.useState(!1),[q,H]=u.useState({}),fe=u.useRef(null),Te=u.useRef(null),we=u.useRef(null),he=u.useRef(null),ze=u.useRef(null),Ue=u.useRef(null),Tt=u.useRef(!1),{leftW:Bt,rightW:Ut,onResizeLeft:Dn,onResizeRight:tn}=dN(fe,z),{getHydratedSnapshot:Cn,getTopAnchorPath:Vt,saveHydratedSnapshot:le,saveTopAnchorPath:oe,invalidateSubtree:ge}=hM(),[Ie,Se]=u.useState(0),[ce,Fe]=u.useState(0),Ge=wr(),et=vk(),kn=vu(),gt=wk(),[zn,Ce]=u.useState(!1),{data:rt,refetch:dn,isLoading:$n,searching:Wt,normalizedQ:Bi,similarityActive:D,embeddings:X,embeddingsRejected:ae,embeddingsAvailable:ye,embeddingsLoading:be,embeddingsError:Ee,poolItems:ie,similarityItems:Ne,items:pe,totalCount:it,filteredCount:Oe,scopeTotal:yt,rootTotal:Ht}=Oj({current:e,query:n,similarityState:o,scanStableMode:se,viewState:x,randomSeed:C,localStarOverrides:q,onFolderHydratedSnapshot:le,getCachedHydratedSnapshot:Cn,sessionResetToken:ce}),En=u.useMemo(()=>Rt(e||"/"),[e]),fn=u.useMemo(()=>Km(x.filters),[x.filters]),Ye=u.useMemo(()=>pe.map(N=>N.path),[pe]),Bn=u.useCallback(N=>{if(!N)return;const $=document.getElementById(`cell-${encodeURIComponent(N)}`);$==null||$.focus()},[]),Ui=o?Ne:ie,{selectedPaths:vt,setSelectedPaths:St,viewer:Ct,compareOpen:Qt,restoreGridToSelectionToken:Fs,bumpRestoreGridToSelectionToken:Un,selectedItems:Zn,compareItems:il,comparePaths:Vi,compareIndexClamped:Vn,compareA:er,compareB:ol,canComparePrev:Su,canCompareNext:Cu,compareEnabled:ku,canPrevImage:Wi,canNextImage:ss,overlayActive:Eu,rememberFocusedPath:Nu,openViewer:ju,closeViewer:ll,openCompare:Os,closeCompare:Hi,handleCompareNavigate:al,handleNavigate:br,resetViewerState:ul,clearViewerForSearch:Ds,syncHashImageSelection:Mu}=Dj({current:e,itemPaths:Ye,items:pe,selectionPool:Ui,focusGridCell:Bn}),cl=Hl(Mu),dl=Hl(Un);u.useEffect(()=>{const N=re=>{const de=Rt(re),Le=AE(de)?de:null,kt=Le?Qm(de):de,Me=!Tt.current;Tt.current=!0,cl.current(Le),t(Re=>{const dt=cE(Re,kt,Le,Me);return Re===dt?Re:(dl.current(),dt)})};N(Hm());const $=()=>N(Hm());return window.addEventListener("hashchange",$),()=>window.removeEventListener("hashchange",$)},[dl,cl]);const Ru=Ui,zs=o?null:x.sort.kind==="metric"?x.sort.key:null,fl=u.useMemo(()=>pj(pe,zs),[pe,zs]),Pu=u.useCallback(N=>{const $=Object.prototype.hasOwnProperty.call(N,"star"),re=N.metrics!==void 0,de=N.comments!==void 0;if(!$&&!re&&!de)return;const Le=Me=>{if(Me.path!==N.path)return Me;let Re=Me;return $&&Me.star!==N.star&&(Re={...Re,star:N.star??null}),re&&(Re={...Re,metrics:N.metrics??void 0}),de&&Me.comments!==N.comments&&(Re={...Re,comments:N.comments??""}),Re},kt=Me=>{if(!Me)return Me;let Re=!1;const dt=Me.items.map(hn=>{const Us=Le(hn);return Us!==hn&&(Re=!0),Us});return Re?{...Me,items:dt}:Me};Ge.setQueriesData({predicate:({queryKey:Me})=>Array.isArray(Me)&&Me[0]==="folder"},kt),Ge.setQueriesData({predicate:({queryKey:Me})=>Array.isArray(Me)&&Me[0]==="search"},kt)},[Ge]),{connectionStatus:$s,connectionLabel:Tu,presence:Iu,editingCount:Lu,recentEditActive:_u,hasEdits:Au,lastEditedLabel:Fu,persistenceEnabled:hl,healthMode:Qi,indexing:te,compareExportCapability:ve,highlightedPaths:Xe,onVisiblePathsChange:tr,offViewSummary:c0,recentTouchesDisplay:d0,clearOffViewActivity:f0}=rM({current:e,currentGalleryId:En,itemPaths:Ye,items:pe,queryClient:Ge,updateItemCaches:Pu,setLocalStarOverrides:H}),Bs=Qi!=="dataset"&&Qi!=="table";u.useEffect(()=>{const N=yM(_,te);!N||N===_||(G(N),Eg(Kl.scanGeneration,N))},[te,_]);const Ki=u.useMemo(()=>vM(te,{scanGeneration:_,recentGeneration:V}),[te,V,_]);u.useEffect(()=>{Y(N=>N===Ki.scanStableActive?N:Ki.scanStableActive)},[Ki.scanStableActive]);const h0=u.useCallback(()=>{const N=bu(te==null?void 0:te.generation)??_;N&&(V!==N&&(J(N),Eg(Kl.recentGeneration,N)),b($=>$.sort.kind==="builtin"&&$.sort.key==="added"&&$.sort.dir==="desc"?$:{...$,sort:{kind:"builtin",key:"added",dir:"desc"}}))},[te==null?void 0:te.generation,V,_]),p0=u.useCallback(N=>{N&&oe(e,N)},[e,oe]),m0=u.useMemo(()=>Vt(e),[e,Vt]);u.useEffect(()=>{Se(N=>N+1)},[e]);const Ou=u.useCallback(()=>{U(N=>N+1)},[]),xh=u.useCallback(N=>{const $=Rt(N||"/");return $===""?"/":$},[]),wh=u.useCallback(N=>{const $=re=>N==="/"?!0:re===N||re.startsWith(`${N}/`);Ge.invalidateQueries({predicate:({queryKey:re})=>{if(!Array.isArray(re)||re[0]!=="folder")return!1;const de=typeof re[1]=="string"?re[1]:"";return $(de)}})},[Ge]),Du=u.useCallback(async N=>{if(!Bs)return;const $=xh(N);await me.refreshFolder($),wh($),Ou(),ge($),(e===$||e.startsWith($==="/"?"/":`${$}/`))&&(Fe(re=>re+1),await dn()),$d.evictPrefix($),qs.evictPrefix($)},[e,Ou,ge,wh,xh,dn,Bs]),g0=u.useCallback(async()=>{if(Bs)try{await Du(e)}catch(N){console.error("Failed to refresh folder:",N)}},[e,Bs,Du]),y0=u.useMemo(()=>mj(o?Ne:ie,q),[o,Ne,ie,q]),Sr=u.useMemo(()=>gj(o?Ne:ie),[o,Ne,ie]);u.useEffect(()=>{D||Sr.length&&b(N=>{const $=N.selectedMetric&&Sr.includes(N.selectedMetric)?N.selectedMetric:Sr[0];return $===N.selectedMetric?N:{...N,selectedMetric:$}})},[Sr,D]),u.useEffect(()=>{D||x.sort.kind==="metric"&&(Sr.includes(x.sort.key)||b(N=>({...N,sort:{kind:"builtin",key:"added",dir:N.sort.dir}})))},[Sr,x.sort,D]);const pl=u.useMemo(()=>tN(x.filters),[x.filters]),zu=D||Wt||pl>0,v0=et.state==="syncing"?"Syncing":et.state==="error"?et.message?`Not saved  ${et.message}`:"Not saved  retry":"All changes saved",x0=gt!=null&&gt>YN,w0=$s==="offline"||$s==="connecting"||$s==="idle",b0=$s==="reconnecting"||kn||et.state==="error"||x0,S0=qN({isOffline:w0,isUnstable:b0,recentEditActive:_u,editingCount:Lu}),C0=yj(D,zu,Oe,yt),k0=vj(D,zu,it,yt,Ht,e),bh=u.useMemo(()=>xj(o),[o]),Sh=u.useMemo(()=>wj(o!==null,pl,Oe,it),[o,pl,Oe,it]),E0=bj({similarityActive:D,searching:Wt,itemCount:pe.length,isLoading:$n}),It=u.useCallback(N=>{b($=>({...$,filters:N($.filters)}))},[]),N0=u.useCallback(N=>{b($=>({...$,filters:N}))},[]),$u=u.useCallback(()=>{It(N=>Pc(N,[]))},[It]),Ch=u.useCallback(()=>{b(N=>({...N,filters:{and:[]}}))},[]),Bu=u.useCallback(()=>{l(null);const N=Ue.current;Ue.current=null,N&&N.length?(St(N),Un()):St([])},[Un,St]),j0=u.useCallback(()=>{o&&Bu(),r(""),b(N=>({...N,filters:{and:[]}}))},[Bu,o]),M0=u.useCallback(async N=>{!o&&Ue.current===null&&(Ue.current=vt);const $=await me.searchEmbeddings(N);if(l({embedding:$.embedding,queryPath:N.query_path??null,queryVector:N.query_vector_b64??null,topK:N.top_k??50,minScore:N.min_score??null,items:$.items,createdAt:Date.now()}),$.items.length){const re=N.query_path&&$.items.some(de=>de.path===N.query_path)?N.query_path:$.items[0].path;St([re]),Un()}else St([])},[Un,vt,St,o]),Uu=u.useCallback((N,$)=>{It(re=>eN(re,N,$))},[It]),kh=u.useMemo(()=>gM(x.filters,{clearStars:$u,clearStarsNotIn:()=>It(N=>$x(N,[])),clearNameContains:()=>It(N=>Bx(N,"")),clearNameNotContains:()=>It(N=>Ux(N,"")),clearCommentsContains:()=>It(N=>Vx(N,"")),clearCommentsNotContains:()=>It(N=>Wx(N,"")),clearUrlContains:()=>It(N=>Hx(N,"")),clearUrlNotContains:()=>It(N=>Qx(N,"")),clearDateRange:()=>It(N=>nf(N,null)),clearWidthCompare:()=>It(N=>fa(N,null)),clearHeightCompare:()=>It(N=>ha(N,null)),clearMetricRange:N=>Uu(N,null)}),[x.filters,$u,Uu,It]),R0=u.useCallback(N=>{const $=new Set(fn);$.has(N)?$.delete(N):$.add(N),b(re=>({...re,filters:Pc(re.filters,Array.from($))}))},[fn]),P0=u.useCallback(()=>{I(!0),L("metrics")},[]),T0=u.useCallback(N=>{b($=>({...$,sort:N})),N.kind==="builtin"&&N.key==="random"&&y(Date.now())},[]),Eh=u.useCallback(N=>{if(N==="/"||N==="")return"Lenslet | Root";const $=N.split("/").filter(Boolean);if(!$.length)return"Lenslet";const re=$.slice(-2).join("/");return`Lenslet | ${$.length>2?`.../${re}`:`/${re}`}`},[]),I0=u.useMemo(()=>uE(e),[e]);u.useEffect(()=>{document.title=Eh(e)},[e,Eh]),u.useEffect(()=>{let N=!0;return me.getViews().then($=>{N&&P($.views||[])}).catch(()=>{N&&P([])}),()=>{N=!1}},[]),u.useEffect(()=>{Wt&&(St([]),Ds(e))},[Ds,e,Wt,St]),u.useEffect(()=>{const N=fe.current,$=he.current;if(!N||!$)return;const re=()=>{const Le=Math.max(48,Math.round($.getBoundingClientRect().height));N.style.setProperty("--toolbar-h",`${Le}px`)};re();const de=window.ResizeObserver;if(de){const Le=new de(re);return Le.observe($),()=>Le.disconnect()}return window.addEventListener("resize",re),()=>window.removeEventListener("resize",re)},[]),u.useEffect(()=>{try{const N=localStorage.getItem(tt.sortKey),$=localStorage.getItem(tt.sortDir),re=localStorage.getItem(tt.sortSpec),de=localStorage.getItem(tt.starFilters),Le=localStorage.getItem(tt.filterAst),kt=localStorage.getItem(tt.selectedMetric),Me=localStorage.getItem(tt.viewMode),Re=localStorage.getItem(tt.gridItemSize),dt=localStorage.getItem(tt.leftOpen),hn=localStorage.getItem(tt.rightOpen),Ah=(Et=>{if(!Et)return null;const ot=Mc(Et);return!ot||typeof ot!="object"?null:ot.kind==="builtin"&&(ot.key==="name"||ot.key==="added"||ot.key==="random")&&(ot.dir==="asc"||ot.dir==="desc")||ot.kind==="metric"&&typeof ot.key=="string"&&ot.key.length>0&&(ot.dir==="asc"||ot.dir==="desc")?ot:null})(re)??{kind:"builtin",key:N==="name"||N==="added"||N==="random"?N:"added",dir:$==="asc"||$==="desc"?$:"desc"};Ah.key==="random"&&y(Date.now());let Wu=(Et=>{if(!Et)return null;const ot=Mc(Et);return tf(ot)})(Le)??{and:[]};if(de){const Et=Mc(de);if(Array.isArray(Et)){const ot=Et.filter(Q0=>[0,1,2,3,4,5].includes(Q0));Wu=Pc(Wu,ot)}}if(b(Et=>({...Et,sort:Ah,filters:Wu,selectedMetric:kt||Et.selectedMetric})),(Me==="grid"||Me==="adaptive")&&v(Me),Re){const Et=Number(Re);!isNaN(Et)&&Et>=80&&Et<=500&&S(Et)}(dt==="0"||dt==="false")&&I(!1),(hn==="0"||hn==="false")&&B(!1)}catch{}},[]),u.useEffect(()=>{ee&&(I(!1),B(!1))},[ee]),u.useEffect(()=>{if(typeof window>"u")return;const N=[1,1.25,1.5,1.75,2,3,4],$=Le=>N.reduce((kt,Me)=>Math.abs(Me-Le)<Math.abs(kt-Le)?Me:kt,N[0]),re=()=>{var Us;const Le=window.devicePixelRatio||1,kt=$(Le),Me=((Us=window.visualViewport)==null?void 0:Us.scale)??1,Re=Le*Me/kt;if(!Number.isFinite(Re)){w(null);return}const dt=Math.round(Re*100),hn=Math.min(500,Math.max(25,dt));w(hn)};re(),window.addEventListener("resize",re),window.addEventListener("orientationchange",re);const de=window.visualViewport;return de&&de.addEventListener("resize",re),()=>{window.removeEventListener("resize",re),window.removeEventListener("orientationchange",re),de&&de.removeEventListener("resize",re)}},[]),u.useEffect(()=>{try{localStorage.setItem(tt.sortKey,x.sort.kind==="builtin"?x.sort.key:"added"),localStorage.setItem(tt.sortDir,x.sort.dir),localStorage.setItem(tt.sortSpec,JSON.stringify(x.sort));const N=Km(x.filters);localStorage.setItem(tt.starFilters,JSON.stringify(N)),localStorage.setItem(tt.filterAst,JSON.stringify(x.filters)),x.selectedMetric?localStorage.setItem(tt.selectedMetric,x.selectedMetric):localStorage.removeItem(tt.selectedMetric),localStorage.setItem(tt.viewMode,m),localStorage.setItem(tt.gridItemSize,String(g)),localStorage.setItem(tt.leftOpen,j?"1":"0"),localStorage.setItem(tt.rightOpen,M?"1":"0")}catch{}},[x,m,g,j,M]),u.useEffect(()=>{if(typeof window>"u")return;const N=()=>Q(window.innerWidth);return N(),window.addEventListener("resize",N),window.addEventListener("orientationchange",N),()=>{window.removeEventListener("resize",N),window.removeEventListener("orientationchange",N)}},[]);const ml=F<=Yr.mobileMax,Nh=Hl(g);u.useEffect(()=>{ml||E&&T(!1)},[ml,E]),u.useEffect(()=>{const N=Te.current;if(!N)return;const $=de=>Math.min(500,Math.max(80,de)),re=de=>{de.ctrlKey&&(Ct||Qt||(de.preventDefault(),S(Le=>$(Le+(de.deltaY<0?20:-20)))))};return N.addEventListener("wheel",re,{passive:!1}),()=>N.removeEventListener("wheel",re)},[Ct,Qt]),u.useEffect(()=>{if(Ct||Qt)return;const N=Te.current;if(!N)return;const $=Re=>Math.min(500,Math.max(80,Re));let re=null;const de=Re=>{if(Re.length<2)return 0;const[dt,hn]=[Re[0],Re[1]];return Math.hypot(dt.clientX-hn.clientX,dt.clientY-hn.clientY)},Le=Re=>{if(Re.touches.length!==2)return;const dt=de(Re.touches);dt&&(re={dist:dt,size:Nh.current})},kt=Re=>{if(!re||Re.touches.length!==2)return;const dt=de(Re.touches);if(!dt)return;Re.preventDefault();const hn=$(re.size*(dt/re.dist));S(hn)},Me=()=>{re=null};return N.addEventListener("touchstart",Le,{passive:!0}),N.addEventListener("touchmove",kt,{passive:!1}),N.addEventListener("touchend",Me),N.addEventListener("touchcancel",Me),()=>{N.removeEventListener("touchstart",Le),N.removeEventListener("touchmove",kt),N.removeEventListener("touchend",Me),N.removeEventListener("touchcancel",Me)}},[Ct,Qt,Nh]),u.useEffect(()=>{Ng(nj(Ye,Ct),"viewer")},[Ct,Ye]),u.useEffect(()=>{Qt&&Ng(rj(Vi,Vn),"compare")},[Qt,Vi,Vn]);const Vu=u.useCallback(N=>{ul();const $=Rt(N);t($),Ox($)},[ul]),{uploading:L0,actionError:jh,isDraggingOver:_0,moveDialog:Mh,moveFolders:A0,moveFoldersLoading:F0,ctx:Rh,setCtx:O0,closeMoveDialog:D0,openUploadPicker:z0,handleUploadInputChange:$0,openGridActions:Ph,openFolderActions:Th,openMoveDialogForPaths:B0,moveSelectedToFolder:U0}=lM({appRef:fe,uploadInputRef:ze,current:e,currentDirCount:((_h=rt==null?void 0:rt.dirs)==null?void 0:_h.length)??0,selectedPaths:vt,setSelectedPaths:St,refetch:dn,invalidateDerivedCounts:Ou}),V0=u.useCallback(async()=>{const N=window.prompt("Save Smart Folder as:","New Smart Folder");if(!N)return;const $=oE(N,R),re={id:$,name:N,pool:{kind:"folder",path:e},view:JSON.parse(JSON.stringify(x))},de=[...R.filter(Le=>Le.id!==$),re];P(de),O($);try{await me.saveViews({version:1,views:de})}catch(Le){if(Le instanceof ln&&Le.status===403){const kt=new Blob([JSON.stringify({version:1,views:de},null,2)],{type:"application/json"});ko(kt,`lenslet-smart-folder-${$}.json`),alert("No-write mode: exported Smart Folder JSON instead of saving.");return}console.error("Failed to save Smart Folder:",Le)}},[e,x,R]);u.useEffect(()=>{if(!A)return;const N=R.find(de=>de.id===A);if(!N){O(null);return}const $=N.pool.path===e,re=JSON.stringify(N.view)===JSON.stringify(x);(!$||!re)&&O(null)},[A,R,e,x]);const Ih=Hl({current:e,items:pe,selectedPaths:vt,viewer:Ct,compareOpen:Qt,mobileSelectMode:E,openFolder:Vu});u.useEffect(()=>{const N=$=>{const re=Ih.current;if(!dh($.target)){if(($.ctrlKey||$.metaKey)&&$.key.toLowerCase()==="b"){$.preventDefault(),$.altKey?B(de=>!de):I(de=>!de);return}if(!(re.viewer||re.compareOpen)){if($.key==="Backspace"||$.key==="Delete")$.preventDefault(),re.openFolder(Qm(re.current));else if(($.ctrlKey||$.metaKey)&&$.key.toLowerCase()==="a")$.preventDefault(),St(re.items.map(de=>de.path));else if($.key==="Escape"){if(re.selectedPaths.length){$.preventDefault(),St([]);return}re.mobileSelectMode&&($.preventDefault(),T(!1))}else if($.key==="/"){$.preventDefault();const de=document.querySelector(".toolbar-right .input");de==null||de.focus()}}}};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[Ih,St]);const Lh=u.useMemo(()=>hS({viewportWidth:F,leftOpen:j,rightOpen:M,leftWidth:Bt,rightWidth:Ut}),[F,j,M,Bt,Ut]),W0=j?`${Lh.leftWidth}px`:"0px",H0=M?`${Lh.rightWidth}px`:"0px";return a.jsxs("div",{className:"app-shell grid h-full grid-cols-[var(--left)_1fr_var(--right)]",ref:fe,style:{"--left":W0,"--right":H0},children:[a.jsx(gS,{rootRef:he,onSearch:r,viewerActive:!!Ct,onBack:ll,zoomPercent:Ct?f:void 0,onZoomPercentChange:N=>d(N),currentLabel:I0,itemCount:C0,totalCount:k0,sortSpec:x.sort,metricKeys:Sr,onSortChange:T0,sortDisabled:D||Ki.sortLocked,filterCount:pl,onOpenFilters:P0,starFilters:fn,onToggleStar:R0,onClearStars:$u,onClearFilters:Ch,starCounts:y0,viewMode:m,onViewMode:v,gridItemSize:g,onGridItemSize:S,leftOpen:j,rightOpen:M,onToggleLeft:()=>I(N=>!N),onToggleRight:()=>B(N=>!N),onPrevImage:()=>br(-1),onNextImage:()=>br(1),canPrevImage:Wi,canNextImage:ss,searchDisabled:D,searchPlaceholder:D?"Exit similarity to search":void 0,onUploadClick:z0,uploadBusy:L0,uploadDisabled:Qt,multiSelectMode:E,selectedCount:vt.length,onToggleMultiSelectMode:ml?()=>T(N=>!N):void 0,syncIndicator:{state:S0,presence:Iu,syncLabel:v0,connectionLabel:Tu,lastEditedLabel:Fu,hasEdits:Au,localTypingActive:zn,recentTouches:d0}}),a.jsx("input",{ref:ze,type:"file",multiple:!0,accept:"image/*",className:"sr-only",onChange:$0}),j&&a.jsx(QN,{leftTool:z,onToolChange:L,compareEnabled:ku,compareActive:Qt,onOpenCompare:Os,views:R,activeViewId:A,onActivateView:N=>{var re;O(N.id);const $=tf((re=N.view)==null?void 0:re.filters)??{and:[]};b({...N.view,filters:$}),Vu(N.pool.path)},onSaveView:V0,current:e,data:rt,onOpenFolder:N=>{O(null),Vu(N)},onOpenFolderActions:Th,onPullRefreshFolders:Bs?g0:void 0,onContextMenu:(N,$)=>{N.preventDefault(),Th($,{x:N.clientX,y:N.clientY})},countVersion:K,items:Ru,filteredItems:pe,metricKeys:Sr,selectedItems:Zn,selectedMetric:x.selectedMetric,onSelectMetric:N=>b($=>({...$,selectedMetric:N})),filters:x.filters,onChangeRange:Uu,onChangeFilters:N0,onResize:Dn}),a.jsxs("div",{className:"grid-shell col-start-2 row-start-2 relative overflow-hidden flex flex-col",ref:Te,children:[a.jsx("div",{"aria-live":"polite",className:"sr-only",children:vt.length?`${vt.length} selected`:""}),a.jsx(KN,{persistenceEnabled:hl,indexing:te,showSwitchToMostRecentBanner:Ki.showSwitchToMostRecentBanner,onSwitchToMostRecent:h0,offViewSummary:c0,canRevealOffView:zu,onRevealOffView:j0,onClearOffView:f0,browserZoomPercent:h}),jh&&a.jsx("div",{className:"border-b border-border bg-panel px-3 py-2",children:a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",children:jh})}),o&&a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"font-semibold",children:"Similarity mode"}),a.jsxs("span",{className:"text-muted",children:["Embedding: ",o.embedding]}),bh&&a.jsxs("span",{className:"text-muted",children:["Query: ",bh]}),Sh&&a.jsxs("span",{className:"text-muted",children:["Results: ",Sh]}),a.jsxs("span",{className:"text-muted",children:["Top K: ",o.topK]}),o.minScore!=null&&a.jsxs("span",{className:"text-muted",children:["Min score: ",o.minScore]})]}),a.jsx("button",{className:"btn btn-sm",onClick:Bu,children:"Exit similarity"})]})}),kh.length>0&&a.jsx("div",{className:"sticky top-0 z-10 px-3 py-2 bg-panel border-b border-border",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Filters"}),kh.map(N=>a.jsxs("span",{className:"filter-chip",children:[a.jsx("span",{className:"truncate max-w-[240px]",title:N.label,children:N.label}),a.jsx("button",{className:"filter-chip-remove","aria-label":`Clear filter ${N.label}`,onClick:N.onRemove,children:""})]},N.id)),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:Ch,children:"Clear all"})]})}),a.jsxs("div",{className:"flex-1 min-h-0 relative",children:[a.jsx(zC,{items:pe,selected:vt,restoreToSelectionToken:Fs,restoreToTopAnchorToken:Ie,restoreToTopAnchorPath:m0,multiSelectMode:ml&&E,onSelectionChange:St,onOpenViewer:N=>{Nu(N),ju(N),St([N])},highlight:Wt?Bi:"",recentlyUpdated:Xe,onVisiblePathsChange:tr,onTopAnchorPathChange:p0,suppressSelectionHighlight:Eu,viewMode:m,targetCellSize:g,onContextMenuItem:(N,$)=>{N.preventDefault(),Ph($,{x:N.clientX,y:N.clientY})},onOpenItemActions:Ph,scrollRef:we,hideScrollbar:fl,isLoading:E0}),fl&&zs&&a.jsx(UC,{items:pe,metricKey:zs,scrollRef:we,sortDir:x.sort.dir})]})]}),M&&a.jsx(TE,{path:vt[0]??null,selectedPaths:vt,items:pe,compareActive:Qt,compareA:er,compareB:ol,onOpenCompare:Os,sortSpec:x.sort,onResize:tn,onStarChanged:(N,$)=>{H(re=>{const de={...re};for(const Le of N)de[Le]=$;return de})},onFindSimilar:()=>i(!0),embeddingsAvailable:ye,embeddingsLoading:be,compareExportSupportsV2:ve.supportsV2,compareExportMaxPathsV2:ve.maxPathsV2,onLocalTypingChange:Ce}),a.jsx(IE,{open:s,embeddings:X,rejected:ae,selectedPath:vt[0]??null,embeddingsLoading:be,embeddingsError:Ee,onClose:()=>i(!1),onSearch:M0}),Ct&&a.jsx(nk,{path:Ct,onClose:ll,onZoomChange:N=>p(Math.round(N)),requestedZoomPercent:c,onZoomRequestConsumed:()=>d(null),canPrev:Wi,canNext:ss,onNavigate:br}),Qt&&a.jsx(uk,{aItem:er,bItem:ol,index:Vn,total:il.length,canPrev:Su,canNext:Cu,onNavigate:al,onClose:Hi}),Mh&&a.jsx(sj,{paths:Mh.paths,defaultDestination:e,destinations:A0,loadingDestinations:F0,onClose:D0,onSubmit:U0}),_0&&a.jsx("div",{className:"toolbar-offset fixed inset-0 left-[var(--left)] right-[var(--right)] bg-accent/10 border-2 border-dashed border-accent text-text flex items-center justify-center text-lg z-overlay pointer-events-none",children:"Drop images to upload"}),Rh&&a.jsx(fj,{ctx:Rh,current:e,items:pe,setCtx:O0,refreshEnabled:Bs,onRefetch:dn,onOpenMoveDialog:B0,onRefreshFolder:Du})]})}const wM=new Wb({defaultOptions:{queries:{staleTime:1e4,gcTime:5*6e4,retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),1e4),refetchOnWindowFocus:!1,refetchOnReconnect:"always"},mutations:{retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),5e3)}}});function bM(){return a.jsx(Hb,{client:wM,children:a.jsx(xM,{})})}Yv(document.getElementById("root")).render(a.jsx(bM,{}));
