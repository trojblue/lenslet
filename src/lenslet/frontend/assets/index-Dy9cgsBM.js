var J0=Object.defineProperty;var Fh=e=>{throw TypeError(e)};var Z0=(e,t,n)=>t in e?J0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var dt=(e,t,n)=>Z0(e,typeof t!="symbol"?t+"":t,n),Qu=(e,t,n)=>t.has(e)||Fh("Cannot "+n);var k=(e,t,n)=>(Qu(e,t,"read from private field"),n?n.call(e):t.get(e)),ue=(e,t,n)=>t.has(e)?Fh("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),J=(e,t,n,r)=>(Qu(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),xe=(e,t,n)=>(Qu(e,t,"access private method"),n);var wl=(e,t,n,r)=>({set _(s){J(e,t,s,n)},get _(){return k(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function ew(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zg={exports:{}},nu={},$g={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jo=Symbol.for("react.element"),tw=Symbol.for("react.portal"),nw=Symbol.for("react.fragment"),rw=Symbol.for("react.strict_mode"),sw=Symbol.for("react.profiler"),iw=Symbol.for("react.provider"),ow=Symbol.for("react.context"),lw=Symbol.for("react.forward_ref"),aw=Symbol.for("react.suspense"),uw=Symbol.for("react.memo"),cw=Symbol.for("react.lazy"),Oh=Symbol.iterator;function dw(e){return e===null||typeof e!="object"?null:(e=Oh&&e[Oh]||e["@@iterator"],typeof e=="function"?e:null)}var Bg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ug=Object.assign,Vg={};function Oi(e,t,n){this.props=e,this.context=t,this.refs=Vg,this.updater=n||Bg}Oi.prototype.isReactComponent={};Oi.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Oi.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Wg(){}Wg.prototype=Oi.prototype;function cf(e,t,n){this.props=e,this.context=t,this.refs=Vg,this.updater=n||Bg}var df=cf.prototype=new Wg;df.constructor=cf;Ug(df,Oi.prototype);df.isPureReactComponent=!0;var Dh=Array.isArray,Hg=Object.prototype.hasOwnProperty,ff={current:null},Qg={key:!0,ref:!0,__self:!0,__source:!0};function Kg(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)Hg.call(t,r)&&!Qg.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Jo,type:e,key:i,ref:o,props:s,_owner:ff.current}}function fw(e,t){return{$$typeof:Jo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function hf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Jo}function hw(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var zh=/\/+/g;function Ku(e,t){return typeof e=="object"&&e!==null&&e.key!=null?hw(""+e.key):t.toString(36)}function Jl(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Jo:case tw:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+Ku(o,0):r,Dh(s)?(n="",e!=null&&(n=e.replace(zh,"$&/")+"/"),Jl(s,t,n,"",function(d){return d})):s!=null&&(hf(s)&&(s=fw(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(zh,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",Dh(e))for(var l=0;l<e.length;l++){i=e[l];var c=r+Ku(i,l);o+=Jl(i,t,n,c,s)}else if(c=dw(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=r+Ku(i,l++),o+=Jl(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Sl(e,t,n){if(e==null)return e;var r=[],s=0;return Jl(e,r,"","",function(i){return t.call(n,i,s++)}),r}function pw(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Bt={current:null},Zl={transition:null},mw={ReactCurrentDispatcher:Bt,ReactCurrentBatchConfig:Zl,ReactCurrentOwner:ff};function Gg(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:Sl,forEach:function(e,t,n){Sl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Sl(e,function(){t++}),t},toArray:function(e){return Sl(e,function(t){return t})||[]},only:function(e){if(!hf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ce.Component=Oi;Ce.Fragment=nw;Ce.Profiler=sw;Ce.PureComponent=cf;Ce.StrictMode=rw;Ce.Suspense=aw;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mw;Ce.act=Gg;Ce.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Ug({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=ff.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Hg.call(t,c)&&!Qg.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Jo,type:e.type,key:s,ref:i,props:r,_owner:o}};Ce.createContext=function(e){return e={$$typeof:ow,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:iw,_context:e},e.Consumer=e};Ce.createElement=Kg;Ce.createFactory=function(e){var t=Kg.bind(null,e);return t.type=e,t};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(e){return{$$typeof:lw,render:e}};Ce.isValidElement=hf;Ce.lazy=function(e){return{$$typeof:cw,_payload:{_status:-1,_result:e},_init:pw}};Ce.memo=function(e,t){return{$$typeof:uw,type:e,compare:t===void 0?null:t}};Ce.startTransition=function(e){var t=Zl.transition;Zl.transition={};try{e()}finally{Zl.transition=t}};Ce.unstable_act=Gg;Ce.useCallback=function(e,t){return Bt.current.useCallback(e,t)};Ce.useContext=function(e){return Bt.current.useContext(e)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(e){return Bt.current.useDeferredValue(e)};Ce.useEffect=function(e,t){return Bt.current.useEffect(e,t)};Ce.useId=function(){return Bt.current.useId()};Ce.useImperativeHandle=function(e,t,n){return Bt.current.useImperativeHandle(e,t,n)};Ce.useInsertionEffect=function(e,t){return Bt.current.useInsertionEffect(e,t)};Ce.useLayoutEffect=function(e,t){return Bt.current.useLayoutEffect(e,t)};Ce.useMemo=function(e,t){return Bt.current.useMemo(e,t)};Ce.useReducer=function(e,t,n){return Bt.current.useReducer(e,t,n)};Ce.useRef=function(e){return Bt.current.useRef(e)};Ce.useState=function(e){return Bt.current.useState(e)};Ce.useSyncExternalStore=function(e,t,n){return Bt.current.useSyncExternalStore(e,t,n)};Ce.useTransition=function(){return Bt.current.useTransition()};Ce.version="18.3.1";$g.exports=Ce;var u=$g.exports;const Yr=ew(u);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gw=u,vw=Symbol.for("react.element"),yw=Symbol.for("react.fragment"),xw=Object.prototype.hasOwnProperty,ww=gw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Sw={key:!0,ref:!0,__self:!0,__source:!0};function qg(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)xw.call(t,r)&&!Sw.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:vw,type:e,key:i,ref:o,props:s,_owner:ww.current}}nu.Fragment=yw;nu.jsx=qg;nu.jsxs=qg;zg.exports=nu;var a=zg.exports,Yg={exports:{}},ln={},Xg={exports:{}},Jg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,_){var O=P.length;P.push(_);e:for(;0<O;){var q=O-1>>>1,U=P[q];if(0<s(U,_))P[q]=_,P[O]=U,O=q;else break e}}function n(P){return P.length===0?null:P[0]}function r(P){if(P.length===0)return null;var _=P[0],O=P.pop();if(O!==_){P[0]=O;e:for(var q=0,U=P.length,A=U>>>1;q<A;){var K=2*(q+1)-1,X=P[K],te=K+1,oe=P[te];if(0>s(X,O))te<U&&0>s(oe,X)?(P[q]=oe,P[te]=O,q=te):(P[q]=X,P[K]=O,q=K);else if(te<U&&0>s(oe,O))P[q]=oe,P[te]=O,q=te;else break e}}return _}function s(P,_){var O=P.sortIndex-_.sortIndex;return O!==0?O:P.id-_.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],d=[],f=1,p=null,h=3,w=!1,x=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,g=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(P){for(var _=n(d);_!==null;){if(_.callback===null)r(d);else if(_.startTime<=P)r(d),_.sortIndex=_.expirationTime,t(c,_);else break;_=n(d)}}function m(P){if(S=!1,y(P),!x)if(n(c)!==null)x=!0,I(b);else{var _=n(d);_!==null&&T(m,_.startTime-P)}}function b(P,_){x=!1,S&&(S=!1,v(M),M=-1),w=!0;var O=h;try{for(y(_),p=n(c);p!==null&&(!(p.expirationTime>_)||P&&!B());){var q=p.callback;if(typeof q=="function"){p.callback=null,h=p.priorityLevel;var U=q(p.expirationTime<=_);_=e.unstable_now(),typeof U=="function"?p.callback=U:p===n(c)&&r(c),y(_)}else r(c);p=n(c)}if(p!==null)var A=!0;else{var K=n(d);K!==null&&T(m,K.startTime-_),A=!1}return A}finally{p=null,h=O,w=!1}}var E=!1,j=null,M=-1,L=5,R=-1;function B(){return!(e.unstable_now()-R<L)}function F(){if(j!==null){var P=e.unstable_now();R=P;var _=!0;try{_=j(!0,P)}finally{_?G():(E=!1,j=null)}}else E=!1}var G;if(typeof g=="function")G=function(){g(F)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,$=Z.port2;Z.port1.onmessage=F,G=function(){$.postMessage(null)}}else G=function(){C(F,0)};function I(P){j=P,E||(E=!0,G())}function T(P,_){M=C(function(){P(e.unstable_now())},_)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){x||w||(x=!0,I(b))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(P){switch(h){case 1:case 2:case 3:var _=3;break;default:_=h}var O=h;h=_;try{return P()}finally{h=O}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,_){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var O=h;h=P;try{return _()}finally{h=O}},e.unstable_scheduleCallback=function(P,_,O){var q=e.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?q+O:q):O=q,P){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=O+U,P={id:f++,callback:_,priorityLevel:P,startTime:O,expirationTime:U,sortIndex:-1},O>q?(P.sortIndex=O,t(d,P),n(c)===null&&P===n(d)&&(S?(v(M),M=-1):S=!0,T(m,O-q))):(P.sortIndex=U,t(c,P),x||w||(x=!0,I(b))),P},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(P){var _=h;return function(){var O=h;h=_;try{return P.apply(this,arguments)}finally{h=O}}}})(Jg);Xg.exports=Jg;var bw=Xg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cw=u,on=bw;function H(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Zg=new Set,No={};function Ls(e,t){ji(e,t),ji(e+"Capture",t)}function ji(e,t){for(No[e]=t,e=0;e<t.length;e++)Zg.add(t[e])}var cr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ac=Object.prototype.hasOwnProperty,kw=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$h={},Bh={};function Ew(e){return Ac.call(Bh,e)?!0:Ac.call($h,e)?!1:kw.test(e)?Bh[e]=!0:($h[e]=!0,!1)}function Nw(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Mw(e,t,n,r){if(t===null||typeof t>"u"||Nw(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ut(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){kt[e]=new Ut(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];kt[t]=new Ut(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){kt[e]=new Ut(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){kt[e]=new Ut(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){kt[e]=new Ut(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){kt[e]=new Ut(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){kt[e]=new Ut(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){kt[e]=new Ut(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){kt[e]=new Ut(e,5,!1,e.toLowerCase(),null,!1,!1)});var pf=/[\-:]([a-z])/g;function mf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(pf,mf);kt[t]=new Ut(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(pf,mf);kt[t]=new Ut(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(pf,mf);kt[t]=new Ut(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){kt[e]=new Ut(e,1,!1,e.toLowerCase(),null,!1,!1)});kt.xlinkHref=new Ut("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){kt[e]=new Ut(e,1,!1,e.toLowerCase(),null,!0,!0)});function gf(e,t,n,r){var s=kt.hasOwnProperty(t)?kt[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Mw(t,n,s,r)&&(n=null),r||s===null?Ew(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var pr=Cw.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bl=Symbol.for("react.element"),qs=Symbol.for("react.portal"),Ys=Symbol.for("react.fragment"),vf=Symbol.for("react.strict_mode"),Fc=Symbol.for("react.profiler"),ev=Symbol.for("react.provider"),tv=Symbol.for("react.context"),yf=Symbol.for("react.forward_ref"),Oc=Symbol.for("react.suspense"),Dc=Symbol.for("react.suspense_list"),xf=Symbol.for("react.memo"),kr=Symbol.for("react.lazy"),nv=Symbol.for("react.offscreen"),Uh=Symbol.iterator;function Ki(e){return e===null||typeof e!="object"?null:(e=Uh&&e[Uh]||e["@@iterator"],typeof e=="function"?e:null)}var Je=Object.assign,Gu;function lo(e){if(Gu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Gu=t&&t[1]||""}return`
`+Gu+e}var qu=!1;function Yu(e,t){if(!e||qu)return"";qu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{qu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?lo(e):""}function jw(e){switch(e.tag){case 5:return lo(e.type);case 16:return lo("Lazy");case 13:return lo("Suspense");case 19:return lo("SuspenseList");case 0:case 2:case 15:return e=Yu(e.type,!1),e;case 11:return e=Yu(e.type.render,!1),e;case 1:return e=Yu(e.type,!0),e;default:return""}}function zc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ys:return"Fragment";case qs:return"Portal";case Fc:return"Profiler";case vf:return"StrictMode";case Oc:return"Suspense";case Dc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case tv:return(e.displayName||"Context")+".Consumer";case ev:return(e._context.displayName||"Context")+".Provider";case yf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case xf:return t=e.displayName||null,t!==null?t:zc(e.type)||"Memo";case kr:t=e._payload,e=e._init;try{return zc(e(t))}catch{}}return null}function Pw(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zc(t);case 8:return t===vf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Xr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function rv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Rw(e){var t=rv(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Cl(e){e._valueTracker||(e._valueTracker=Rw(e))}function sv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=rv(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function xa(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function $c(e,t){var n=t.checked;return Je({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Vh(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Xr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function iv(e,t){t=t.checked,t!=null&&gf(e,"checked",t,!1)}function Bc(e,t){iv(e,t);var n=Xr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Uc(e,t.type,n):t.hasOwnProperty("defaultValue")&&Uc(e,t.type,Xr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Wh(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Uc(e,t,n){(t!=="number"||xa(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ao=Array.isArray;function li(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Xr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Vc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(H(91));return Je({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Hh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(H(92));if(ao(n)){if(1<n.length)throw Error(H(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Xr(n)}}function ov(e,t){var n=Xr(t.value),r=Xr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Qh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function lv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Wc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?lv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var kl,av=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(kl=kl||document.createElement("div"),kl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=kl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Mo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var po={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Tw=["Webkit","ms","Moz","O"];Object.keys(po).forEach(function(e){Tw.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),po[t]=po[e]})});function uv(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||po.hasOwnProperty(e)&&po[e]?(""+t).trim():t+"px"}function cv(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=uv(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var Iw=Je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Hc(e,t){if(t){if(Iw[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(H(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(H(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(H(61))}if(t.style!=null&&typeof t.style!="object")throw Error(H(62))}}function Qc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kc=null;function wf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Gc=null,ai=null,ui=null;function Kh(e){if(e=tl(e)){if(typeof Gc!="function")throw Error(H(280));var t=e.stateNode;t&&(t=lu(t),Gc(e.stateNode,e.type,t))}}function dv(e){ai?ui?ui.push(e):ui=[e]:ai=e}function fv(){if(ai){var e=ai,t=ui;if(ui=ai=null,Kh(e),t)for(e=0;e<t.length;e++)Kh(t[e])}}function hv(e,t){return e(t)}function pv(){}var Xu=!1;function mv(e,t,n){if(Xu)return e(t,n);Xu=!0;try{return hv(e,t,n)}finally{Xu=!1,(ai!==null||ui!==null)&&(pv(),fv())}}function jo(e,t){var n=e.stateNode;if(n===null)return null;var r=lu(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(H(231,t,typeof n));return n}var qc=!1;if(cr)try{var Gi={};Object.defineProperty(Gi,"passive",{get:function(){qc=!0}}),window.addEventListener("test",Gi,Gi),window.removeEventListener("test",Gi,Gi)}catch{qc=!1}function Lw(e,t,n,r,s,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(f){this.onError(f)}}var mo=!1,wa=null,Sa=!1,Yc=null,_w={onError:function(e){mo=!0,wa=e}};function Aw(e,t,n,r,s,i,o,l,c){mo=!1,wa=null,Lw.apply(_w,arguments)}function Fw(e,t,n,r,s,i,o,l,c){if(Aw.apply(this,arguments),mo){if(mo){var d=wa;mo=!1,wa=null}else throw Error(H(198));Sa||(Sa=!0,Yc=d)}}function _s(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function gv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Gh(e){if(_s(e)!==e)throw Error(H(188))}function Ow(e){var t=e.alternate;if(!t){if(t=_s(e),t===null)throw Error(H(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Gh(s),e;if(i===r)return Gh(s),t;i=i.sibling}throw Error(H(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?e:t}function vv(e){return e=Ow(e),e!==null?yv(e):null}function yv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=yv(e);if(t!==null)return t;e=e.sibling}return null}var xv=on.unstable_scheduleCallback,qh=on.unstable_cancelCallback,Dw=on.unstable_shouldYield,zw=on.unstable_requestPaint,lt=on.unstable_now,$w=on.unstable_getCurrentPriorityLevel,Sf=on.unstable_ImmediatePriority,wv=on.unstable_UserBlockingPriority,ba=on.unstable_NormalPriority,Bw=on.unstable_LowPriority,Sv=on.unstable_IdlePriority,ru=null,Hn=null;function Uw(e){if(Hn&&typeof Hn.onCommitFiberRoot=="function")try{Hn.onCommitFiberRoot(ru,e,void 0,(e.current.flags&128)===128)}catch{}}var Pn=Math.clz32?Math.clz32:Hw,Vw=Math.log,Ww=Math.LN2;function Hw(e){return e>>>=0,e===0?32:31-(Vw(e)/Ww|0)|0}var El=64,Nl=4194304;function uo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Ca(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=uo(l):(i&=o,i!==0&&(r=uo(i)))}else o=n&~s,o!==0?r=uo(o):i!==0&&(r=uo(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Pn(t),s=1<<n,r|=e[n],t&=~s;return r}function Qw(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Kw(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Pn(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=Qw(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function Xc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function bv(){var e=El;return El<<=1,!(El&4194240)&&(El=64),e}function Ju(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Zo(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Pn(t),e[t]=n}function Gw(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Pn(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function bf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Pn(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Oe=0;function Cv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var kv,Cf,Ev,Nv,Mv,Jc=!1,Ml=[],zr=null,$r=null,Br=null,Po=new Map,Ro=new Map,Nr=[],qw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Yh(e,t){switch(e){case"focusin":case"focusout":zr=null;break;case"dragenter":case"dragleave":$r=null;break;case"mouseover":case"mouseout":Br=null;break;case"pointerover":case"pointerout":Po.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ro.delete(t.pointerId)}}function qi(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=tl(t),t!==null&&Cf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Yw(e,t,n,r,s){switch(t){case"focusin":return zr=qi(zr,e,t,n,r,s),!0;case"dragenter":return $r=qi($r,e,t,n,r,s),!0;case"mouseover":return Br=qi(Br,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return Po.set(i,qi(Po.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Ro.set(i,qi(Ro.get(i)||null,e,t,n,r,s)),!0}return!1}function jv(e){var t=ls(e.target);if(t!==null){var n=_s(t);if(n!==null){if(t=n.tag,t===13){if(t=gv(n),t!==null){e.blockedOn=t,Mv(e.priority,function(){Ev(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ea(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Kc=r,n.target.dispatchEvent(r),Kc=null}else return t=tl(n),t!==null&&Cf(t),e.blockedOn=n,!1;t.shift()}return!0}function Xh(e,t,n){ea(e)&&n.delete(t)}function Xw(){Jc=!1,zr!==null&&ea(zr)&&(zr=null),$r!==null&&ea($r)&&($r=null),Br!==null&&ea(Br)&&(Br=null),Po.forEach(Xh),Ro.forEach(Xh)}function Yi(e,t){e.blockedOn===t&&(e.blockedOn=null,Jc||(Jc=!0,on.unstable_scheduleCallback(on.unstable_NormalPriority,Xw)))}function To(e){function t(s){return Yi(s,e)}if(0<Ml.length){Yi(Ml[0],e);for(var n=1;n<Ml.length;n++){var r=Ml[n];r.blockedOn===e&&(r.blockedOn=null)}}for(zr!==null&&Yi(zr,e),$r!==null&&Yi($r,e),Br!==null&&Yi(Br,e),Po.forEach(t),Ro.forEach(t),n=0;n<Nr.length;n++)r=Nr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Nr.length&&(n=Nr[0],n.blockedOn===null);)jv(n),n.blockedOn===null&&Nr.shift()}var ci=pr.ReactCurrentBatchConfig,ka=!0;function Jw(e,t,n,r){var s=Oe,i=ci.transition;ci.transition=null;try{Oe=1,kf(e,t,n,r)}finally{Oe=s,ci.transition=i}}function Zw(e,t,n,r){var s=Oe,i=ci.transition;ci.transition=null;try{Oe=4,kf(e,t,n,r)}finally{Oe=s,ci.transition=i}}function kf(e,t,n,r){if(ka){var s=Zc(e,t,n,r);if(s===null)ac(e,t,r,Ea,n),Yh(e,r);else if(Yw(s,e,t,n,r))r.stopPropagation();else if(Yh(e,r),t&4&&-1<qw.indexOf(e)){for(;s!==null;){var i=tl(s);if(i!==null&&kv(i),i=Zc(e,t,n,r),i===null&&ac(e,t,r,Ea,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else ac(e,t,r,null,n)}}var Ea=null;function Zc(e,t,n,r){if(Ea=null,e=wf(r),e=ls(e),e!==null)if(t=_s(e),t===null)e=null;else if(n=t.tag,n===13){if(e=gv(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ea=e,null}function Pv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($w()){case Sf:return 1;case wv:return 4;case ba:case Bw:return 16;case Sv:return 536870912;default:return 16}default:return 16}}var Or=null,Ef=null,ta=null;function Rv(){if(ta)return ta;var e,t=Ef,n=t.length,r,s="value"in Or?Or.value:Or.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return ta=s.slice(e,1<r?1-r:void 0)}function na(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function jl(){return!0}function Jh(){return!1}function an(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?jl:Jh,this.isPropagationStopped=Jh,this}return Je(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=jl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=jl)},persist:function(){},isPersistent:jl}),t}var Di={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nf=an(Di),el=Je({},Di,{view:0,detail:0}),e1=an(el),Zu,ec,Xi,su=Je({},el,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Xi&&(Xi&&e.type==="mousemove"?(Zu=e.screenX-Xi.screenX,ec=e.screenY-Xi.screenY):ec=Zu=0,Xi=e),Zu)},movementY:function(e){return"movementY"in e?e.movementY:ec}}),Zh=an(su),t1=Je({},su,{dataTransfer:0}),n1=an(t1),r1=Je({},el,{relatedTarget:0}),tc=an(r1),s1=Je({},Di,{animationName:0,elapsedTime:0,pseudoElement:0}),i1=an(s1),o1=Je({},Di,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),l1=an(o1),a1=Je({},Di,{data:0}),ep=an(a1),u1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},c1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},d1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function f1(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=d1[e])?!!t[e]:!1}function Mf(){return f1}var h1=Je({},el,{key:function(e){if(e.key){var t=u1[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=na(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?c1[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mf,charCode:function(e){return e.type==="keypress"?na(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?na(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),p1=an(h1),m1=Je({},su,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),tp=an(m1),g1=Je({},el,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mf}),v1=an(g1),y1=Je({},Di,{propertyName:0,elapsedTime:0,pseudoElement:0}),x1=an(y1),w1=Je({},su,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),S1=an(w1),b1=[9,13,27,32],jf=cr&&"CompositionEvent"in window,go=null;cr&&"documentMode"in document&&(go=document.documentMode);var C1=cr&&"TextEvent"in window&&!go,Tv=cr&&(!jf||go&&8<go&&11>=go),np=" ",rp=!1;function Iv(e,t){switch(e){case"keyup":return b1.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Xs=!1;function k1(e,t){switch(e){case"compositionend":return Lv(t);case"keypress":return t.which!==32?null:(rp=!0,np);case"textInput":return e=t.data,e===np&&rp?null:e;default:return null}}function E1(e,t){if(Xs)return e==="compositionend"||!jf&&Iv(e,t)?(e=Rv(),ta=Ef=Or=null,Xs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Tv&&t.locale!=="ko"?null:t.data;default:return null}}var N1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!N1[e.type]:t==="textarea"}function _v(e,t,n,r){dv(r),t=Na(t,"onChange"),0<t.length&&(n=new Nf("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var vo=null,Io=null;function M1(e){Hv(e,0)}function iu(e){var t=ei(e);if(sv(t))return e}function j1(e,t){if(e==="change")return t}var Av=!1;if(cr){var nc;if(cr){var rc="oninput"in document;if(!rc){var ip=document.createElement("div");ip.setAttribute("oninput","return;"),rc=typeof ip.oninput=="function"}nc=rc}else nc=!1;Av=nc&&(!document.documentMode||9<document.documentMode)}function op(){vo&&(vo.detachEvent("onpropertychange",Fv),Io=vo=null)}function Fv(e){if(e.propertyName==="value"&&iu(Io)){var t=[];_v(t,Io,e,wf(e)),mv(M1,t)}}function P1(e,t,n){e==="focusin"?(op(),vo=t,Io=n,vo.attachEvent("onpropertychange",Fv)):e==="focusout"&&op()}function R1(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return iu(Io)}function T1(e,t){if(e==="click")return iu(t)}function I1(e,t){if(e==="input"||e==="change")return iu(t)}function L1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var In=typeof Object.is=="function"?Object.is:L1;function Lo(e,t){if(In(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ac.call(t,s)||!In(e[s],t[s]))return!1}return!0}function lp(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ap(e,t){var n=lp(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=lp(n)}}function Ov(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ov(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Dv(){for(var e=window,t=xa();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=xa(e.document)}return t}function Pf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function _1(e){var t=Dv(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Ov(n.ownerDocument.documentElement,n)){if(r!==null&&Pf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=ap(n,i);var o=ap(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var A1=cr&&"documentMode"in document&&11>=document.documentMode,Js=null,ed=null,yo=null,td=!1;function up(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;td||Js==null||Js!==xa(r)||(r=Js,"selectionStart"in r&&Pf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),yo&&Lo(yo,r)||(yo=r,r=Na(ed,"onSelect"),0<r.length&&(t=new Nf("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Js)))}function Pl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Zs={animationend:Pl("Animation","AnimationEnd"),animationiteration:Pl("Animation","AnimationIteration"),animationstart:Pl("Animation","AnimationStart"),transitionend:Pl("Transition","TransitionEnd")},sc={},zv={};cr&&(zv=document.createElement("div").style,"AnimationEvent"in window||(delete Zs.animationend.animation,delete Zs.animationiteration.animation,delete Zs.animationstart.animation),"TransitionEvent"in window||delete Zs.transitionend.transition);function ou(e){if(sc[e])return sc[e];if(!Zs[e])return e;var t=Zs[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in zv)return sc[e]=t[n];return e}var $v=ou("animationend"),Bv=ou("animationiteration"),Uv=ou("animationstart"),Vv=ou("transitionend"),Wv=new Map,cp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zr(e,t){Wv.set(e,t),Ls(t,[e])}for(var ic=0;ic<cp.length;ic++){var oc=cp[ic],F1=oc.toLowerCase(),O1=oc[0].toUpperCase()+oc.slice(1);Zr(F1,"on"+O1)}Zr($v,"onAnimationEnd");Zr(Bv,"onAnimationIteration");Zr(Uv,"onAnimationStart");Zr("dblclick","onDoubleClick");Zr("focusin","onFocus");Zr("focusout","onBlur");Zr(Vv,"onTransitionEnd");ji("onMouseEnter",["mouseout","mouseover"]);ji("onMouseLeave",["mouseout","mouseover"]);ji("onPointerEnter",["pointerout","pointerover"]);ji("onPointerLeave",["pointerout","pointerover"]);Ls("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ls("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ls("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ls("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ls("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ls("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var co="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D1=new Set("cancel close invalid load scroll toggle".split(" ").concat(co));function dp(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Fw(r,t,void 0,e),e.currentTarget=null}function Hv(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;dp(s,l,d),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;dp(s,l,d),i=c}}}if(Sa)throw e=Yc,Sa=!1,Yc=null,e}function Ue(e,t){var n=t[od];n===void 0&&(n=t[od]=new Set);var r=e+"__bubble";n.has(r)||(Qv(t,e,2,!1),n.add(r))}function lc(e,t,n){var r=0;t&&(r|=4),Qv(n,e,r,t)}var Rl="_reactListening"+Math.random().toString(36).slice(2);function _o(e){if(!e[Rl]){e[Rl]=!0,Zg.forEach(function(n){n!=="selectionchange"&&(D1.has(n)||lc(n,!1,e),lc(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Rl]||(t[Rl]=!0,lc("selectionchange",!1,t))}}function Qv(e,t,n,r){switch(Pv(t)){case 1:var s=Jw;break;case 4:s=Zw;break;default:s=kf}n=s.bind(null,t,n,e),s=void 0,!qc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function ac(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=ls(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}mv(function(){var d=i,f=wf(n),p=[];e:{var h=Wv.get(e);if(h!==void 0){var w=Nf,x=e;switch(e){case"keypress":if(na(n)===0)break e;case"keydown":case"keyup":w=p1;break;case"focusin":x="focus",w=tc;break;case"focusout":x="blur",w=tc;break;case"beforeblur":case"afterblur":w=tc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Zh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=n1;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=v1;break;case $v:case Bv:case Uv:w=i1;break;case Vv:w=x1;break;case"scroll":w=e1;break;case"wheel":w=S1;break;case"copy":case"cut":case"paste":w=l1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=tp}var S=(t&4)!==0,C=!S&&e==="scroll",v=S?h!==null?h+"Capture":null:h;S=[];for(var g=d,y;g!==null;){y=g;var m=y.stateNode;if(y.tag===5&&m!==null&&(y=m,v!==null&&(m=jo(g,v),m!=null&&S.push(Ao(g,m,y)))),C)break;g=g.return}0<S.length&&(h=new w(h,x,null,n,f),p.push({event:h,listeners:S}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",h&&n!==Kc&&(x=n.relatedTarget||n.fromElement)&&(ls(x)||x[dr]))break e;if((w||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,w?(x=n.relatedTarget||n.toElement,w=d,x=x?ls(x):null,x!==null&&(C=_s(x),x!==C||x.tag!==5&&x.tag!==6)&&(x=null)):(w=null,x=d),w!==x)){if(S=Zh,m="onMouseLeave",v="onMouseEnter",g="mouse",(e==="pointerout"||e==="pointerover")&&(S=tp,m="onPointerLeave",v="onPointerEnter",g="pointer"),C=w==null?h:ei(w),y=x==null?h:ei(x),h=new S(m,g+"leave",w,n,f),h.target=C,h.relatedTarget=y,m=null,ls(f)===d&&(S=new S(v,g+"enter",x,n,f),S.target=y,S.relatedTarget=C,m=S),C=m,w&&x)t:{for(S=w,v=x,g=0,y=S;y;y=Ws(y))g++;for(y=0,m=v;m;m=Ws(m))y++;for(;0<g-y;)S=Ws(S),g--;for(;0<y-g;)v=Ws(v),y--;for(;g--;){if(S===v||v!==null&&S===v.alternate)break t;S=Ws(S),v=Ws(v)}S=null}else S=null;w!==null&&fp(p,h,w,S,!1),x!==null&&C!==null&&fp(p,C,x,S,!0)}}e:{if(h=d?ei(d):window,w=h.nodeName&&h.nodeName.toLowerCase(),w==="select"||w==="input"&&h.type==="file")var b=j1;else if(sp(h))if(Av)b=I1;else{b=R1;var E=P1}else(w=h.nodeName)&&w.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(b=T1);if(b&&(b=b(e,d))){_v(p,b,n,f);break e}E&&E(e,h,d),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&Uc(h,"number",h.value)}switch(E=d?ei(d):window,e){case"focusin":(sp(E)||E.contentEditable==="true")&&(Js=E,ed=d,yo=null);break;case"focusout":yo=ed=Js=null;break;case"mousedown":td=!0;break;case"contextmenu":case"mouseup":case"dragend":td=!1,up(p,n,f);break;case"selectionchange":if(A1)break;case"keydown":case"keyup":up(p,n,f)}var j;if(jf)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Xs?Iv(e,n)&&(M="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(Tv&&n.locale!=="ko"&&(Xs||M!=="onCompositionStart"?M==="onCompositionEnd"&&Xs&&(j=Rv()):(Or=f,Ef="value"in Or?Or.value:Or.textContent,Xs=!0)),E=Na(d,M),0<E.length&&(M=new ep(M,e,null,n,f),p.push({event:M,listeners:E}),j?M.data=j:(j=Lv(n),j!==null&&(M.data=j)))),(j=C1?k1(e,n):E1(e,n))&&(d=Na(d,"onBeforeInput"),0<d.length&&(f=new ep("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=j))}Hv(p,t)})}function Ao(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Na(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=jo(e,n),i!=null&&r.unshift(Ao(e,i,s)),i=jo(e,t),i!=null&&r.push(Ao(e,i,s))),e=e.return}return r}function Ws(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function fp(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,s?(c=jo(n,i),c!=null&&o.unshift(Ao(n,c,l))):s||(c=jo(n,i),c!=null&&o.push(Ao(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var z1=/\r\n?/g,$1=/\u0000|\uFFFD/g;function hp(e){return(typeof e=="string"?e:""+e).replace(z1,`
`).replace($1,"")}function Tl(e,t,n){if(t=hp(t),hp(e)!==t&&n)throw Error(H(425))}function Ma(){}var nd=null,rd=null;function sd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var id=typeof setTimeout=="function"?setTimeout:void 0,B1=typeof clearTimeout=="function"?clearTimeout:void 0,pp=typeof Promise=="function"?Promise:void 0,U1=typeof queueMicrotask=="function"?queueMicrotask:typeof pp<"u"?function(e){return pp.resolve(null).then(e).catch(V1)}:id;function V1(e){setTimeout(function(){throw e})}function uc(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),To(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);To(t)}function Ur(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function mp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var zi=Math.random().toString(36).slice(2),Wn="__reactFiber$"+zi,Fo="__reactProps$"+zi,dr="__reactContainer$"+zi,od="__reactEvents$"+zi,W1="__reactListeners$"+zi,H1="__reactHandles$"+zi;function ls(e){var t=e[Wn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[dr]||n[Wn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=mp(e);e!==null;){if(n=e[Wn])return n;e=mp(e)}return t}e=n,n=e.parentNode}return null}function tl(e){return e=e[Wn]||e[dr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ei(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(H(33))}function lu(e){return e[Fo]||null}var ld=[],ti=-1;function es(e){return{current:e}}function Ve(e){0>ti||(e.current=ld[ti],ld[ti]=null,ti--)}function $e(e,t){ti++,ld[ti]=e.current,e.current=t}var Jr={},Tt=es(Jr),qt=es(!1),Ns=Jr;function Pi(e,t){var n=e.type.contextTypes;if(!n)return Jr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Yt(e){return e=e.childContextTypes,e!=null}function ja(){Ve(qt),Ve(Tt)}function gp(e,t,n){if(Tt.current!==Jr)throw Error(H(168));$e(Tt,t),$e(qt,n)}function Kv(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(H(108,Pw(e)||"Unknown",s));return Je({},n,r)}function Pa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Jr,Ns=Tt.current,$e(Tt,e),$e(qt,qt.current),!0}function vp(e,t,n){var r=e.stateNode;if(!r)throw Error(H(169));n?(e=Kv(e,t,Ns),r.__reactInternalMemoizedMergedChildContext=e,Ve(qt),Ve(Tt),$e(Tt,e)):Ve(qt),$e(qt,n)}var er=null,au=!1,cc=!1;function Gv(e){er===null?er=[e]:er.push(e)}function Q1(e){au=!0,Gv(e)}function ts(){if(!cc&&er!==null){cc=!0;var e=0,t=Oe;try{var n=er;for(Oe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}er=null,au=!1}catch(s){throw er!==null&&(er=er.slice(e+1)),xv(Sf,ts),s}finally{Oe=t,cc=!1}}return null}var ni=[],ri=0,Ra=null,Ta=0,hn=[],pn=0,Ms=null,ir=1,or="";function ss(e,t){ni[ri++]=Ta,ni[ri++]=Ra,Ra=e,Ta=t}function qv(e,t,n){hn[pn++]=ir,hn[pn++]=or,hn[pn++]=Ms,Ms=e;var r=ir;e=or;var s=32-Pn(r)-1;r&=~(1<<s),n+=1;var i=32-Pn(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,ir=1<<32-Pn(t)+s|n<<s|r,or=i+e}else ir=1<<i|n<<s|r,or=e}function Rf(e){e.return!==null&&(ss(e,1),qv(e,1,0))}function Tf(e){for(;e===Ra;)Ra=ni[--ri],ni[ri]=null,Ta=ni[--ri],ni[ri]=null;for(;e===Ms;)Ms=hn[--pn],hn[pn]=null,or=hn[--pn],hn[pn]=null,ir=hn[--pn],hn[pn]=null}var rn=null,nn=null,Qe=!1,jn=null;function Yv(e,t){var n=gn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function yp(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,rn=e,nn=Ur(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,rn=e,nn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ms!==null?{id:ir,overflow:or}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=gn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,rn=e,nn=null,!0):!1;default:return!1}}function ad(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ud(e){if(Qe){var t=nn;if(t){var n=t;if(!yp(e,t)){if(ad(e))throw Error(H(418));t=Ur(n.nextSibling);var r=rn;t&&yp(e,t)?Yv(r,n):(e.flags=e.flags&-4097|2,Qe=!1,rn=e)}}else{if(ad(e))throw Error(H(418));e.flags=e.flags&-4097|2,Qe=!1,rn=e}}}function xp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;rn=e}function Il(e){if(e!==rn)return!1;if(!Qe)return xp(e),Qe=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!sd(e.type,e.memoizedProps)),t&&(t=nn)){if(ad(e))throw Xv(),Error(H(418));for(;t;)Yv(e,t),t=Ur(t.nextSibling)}if(xp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(H(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){nn=Ur(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}nn=null}}else nn=rn?Ur(e.stateNode.nextSibling):null;return!0}function Xv(){for(var e=nn;e;)e=Ur(e.nextSibling)}function Ri(){nn=rn=null,Qe=!1}function If(e){jn===null?jn=[e]:jn.push(e)}var K1=pr.ReactCurrentBatchConfig;function Ji(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,e))}return e}function Ll(e,t){throw e=Object.prototype.toString.call(t),Error(H(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function wp(e){var t=e._init;return t(e._payload)}function Jv(e){function t(v,g){if(e){var y=v.deletions;y===null?(v.deletions=[g],v.flags|=16):y.push(g)}}function n(v,g){if(!e)return null;for(;g!==null;)t(v,g),g=g.sibling;return null}function r(v,g){for(v=new Map;g!==null;)g.key!==null?v.set(g.key,g):v.set(g.index,g),g=g.sibling;return v}function s(v,g){return v=Qr(v,g),v.index=0,v.sibling=null,v}function i(v,g,y){return v.index=y,e?(y=v.alternate,y!==null?(y=y.index,y<g?(v.flags|=2,g):y):(v.flags|=2,g)):(v.flags|=1048576,g)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,g,y,m){return g===null||g.tag!==6?(g=vc(y,v.mode,m),g.return=v,g):(g=s(g,y),g.return=v,g)}function c(v,g,y,m){var b=y.type;return b===Ys?f(v,g,y.props.children,m,y.key):g!==null&&(g.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===kr&&wp(b)===g.type)?(m=s(g,y.props),m.ref=Ji(v,g,y),m.return=v,m):(m=ua(y.type,y.key,y.props,null,v.mode,m),m.ref=Ji(v,g,y),m.return=v,m)}function d(v,g,y,m){return g===null||g.tag!==4||g.stateNode.containerInfo!==y.containerInfo||g.stateNode.implementation!==y.implementation?(g=yc(y,v.mode,m),g.return=v,g):(g=s(g,y.children||[]),g.return=v,g)}function f(v,g,y,m,b){return g===null||g.tag!==7?(g=Es(y,v.mode,m,b),g.return=v,g):(g=s(g,y),g.return=v,g)}function p(v,g,y){if(typeof g=="string"&&g!==""||typeof g=="number")return g=vc(""+g,v.mode,y),g.return=v,g;if(typeof g=="object"&&g!==null){switch(g.$$typeof){case bl:return y=ua(g.type,g.key,g.props,null,v.mode,y),y.ref=Ji(v,null,g),y.return=v,y;case qs:return g=yc(g,v.mode,y),g.return=v,g;case kr:var m=g._init;return p(v,m(g._payload),y)}if(ao(g)||Ki(g))return g=Es(g,v.mode,y,null),g.return=v,g;Ll(v,g)}return null}function h(v,g,y,m){var b=g!==null?g.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return b!==null?null:l(v,g,""+y,m);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case bl:return y.key===b?c(v,g,y,m):null;case qs:return y.key===b?d(v,g,y,m):null;case kr:return b=y._init,h(v,g,b(y._payload),m)}if(ao(y)||Ki(y))return b!==null?null:f(v,g,y,m,null);Ll(v,y)}return null}function w(v,g,y,m,b){if(typeof m=="string"&&m!==""||typeof m=="number")return v=v.get(y)||null,l(g,v,""+m,b);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case bl:return v=v.get(m.key===null?y:m.key)||null,c(g,v,m,b);case qs:return v=v.get(m.key===null?y:m.key)||null,d(g,v,m,b);case kr:var E=m._init;return w(v,g,y,E(m._payload),b)}if(ao(m)||Ki(m))return v=v.get(y)||null,f(g,v,m,b,null);Ll(g,m)}return null}function x(v,g,y,m){for(var b=null,E=null,j=g,M=g=0,L=null;j!==null&&M<y.length;M++){j.index>M?(L=j,j=null):L=j.sibling;var R=h(v,j,y[M],m);if(R===null){j===null&&(j=L);break}e&&j&&R.alternate===null&&t(v,j),g=i(R,g,M),E===null?b=R:E.sibling=R,E=R,j=L}if(M===y.length)return n(v,j),Qe&&ss(v,M),b;if(j===null){for(;M<y.length;M++)j=p(v,y[M],m),j!==null&&(g=i(j,g,M),E===null?b=j:E.sibling=j,E=j);return Qe&&ss(v,M),b}for(j=r(v,j);M<y.length;M++)L=w(j,v,M,y[M],m),L!==null&&(e&&L.alternate!==null&&j.delete(L.key===null?M:L.key),g=i(L,g,M),E===null?b=L:E.sibling=L,E=L);return e&&j.forEach(function(B){return t(v,B)}),Qe&&ss(v,M),b}function S(v,g,y,m){var b=Ki(y);if(typeof b!="function")throw Error(H(150));if(y=b.call(y),y==null)throw Error(H(151));for(var E=b=null,j=g,M=g=0,L=null,R=y.next();j!==null&&!R.done;M++,R=y.next()){j.index>M?(L=j,j=null):L=j.sibling;var B=h(v,j,R.value,m);if(B===null){j===null&&(j=L);break}e&&j&&B.alternate===null&&t(v,j),g=i(B,g,M),E===null?b=B:E.sibling=B,E=B,j=L}if(R.done)return n(v,j),Qe&&ss(v,M),b;if(j===null){for(;!R.done;M++,R=y.next())R=p(v,R.value,m),R!==null&&(g=i(R,g,M),E===null?b=R:E.sibling=R,E=R);return Qe&&ss(v,M),b}for(j=r(v,j);!R.done;M++,R=y.next())R=w(j,v,M,R.value,m),R!==null&&(e&&R.alternate!==null&&j.delete(R.key===null?M:R.key),g=i(R,g,M),E===null?b=R:E.sibling=R,E=R);return e&&j.forEach(function(F){return t(v,F)}),Qe&&ss(v,M),b}function C(v,g,y,m){if(typeof y=="object"&&y!==null&&y.type===Ys&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case bl:e:{for(var b=y.key,E=g;E!==null;){if(E.key===b){if(b=y.type,b===Ys){if(E.tag===7){n(v,E.sibling),g=s(E,y.props.children),g.return=v,v=g;break e}}else if(E.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===kr&&wp(b)===E.type){n(v,E.sibling),g=s(E,y.props),g.ref=Ji(v,E,y),g.return=v,v=g;break e}n(v,E);break}else t(v,E);E=E.sibling}y.type===Ys?(g=Es(y.props.children,v.mode,m,y.key),g.return=v,v=g):(m=ua(y.type,y.key,y.props,null,v.mode,m),m.ref=Ji(v,g,y),m.return=v,v=m)}return o(v);case qs:e:{for(E=y.key;g!==null;){if(g.key===E)if(g.tag===4&&g.stateNode.containerInfo===y.containerInfo&&g.stateNode.implementation===y.implementation){n(v,g.sibling),g=s(g,y.children||[]),g.return=v,v=g;break e}else{n(v,g);break}else t(v,g);g=g.sibling}g=yc(y,v.mode,m),g.return=v,v=g}return o(v);case kr:return E=y._init,C(v,g,E(y._payload),m)}if(ao(y))return x(v,g,y,m);if(Ki(y))return S(v,g,y,m);Ll(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,g!==null&&g.tag===6?(n(v,g.sibling),g=s(g,y),g.return=v,v=g):(n(v,g),g=vc(y,v.mode,m),g.return=v,v=g),o(v)):n(v,g)}return C}var Ti=Jv(!0),Zv=Jv(!1),Ia=es(null),La=null,si=null,Lf=null;function _f(){Lf=si=La=null}function Af(e){var t=Ia.current;Ve(Ia),e._currentValue=t}function cd(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function di(e,t){La=e,Lf=si=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Gt=!0),e.firstContext=null)}function yn(e){var t=e._currentValue;if(Lf!==e)if(e={context:e,memoizedValue:t,next:null},si===null){if(La===null)throw Error(H(308));si=e,La.dependencies={lanes:0,firstContext:e}}else si=si.next=e;return t}var as=null;function Ff(e){as===null?as=[e]:as.push(e)}function ey(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Ff(t)):(n.next=s.next,s.next=n),t.interleaved=n,fr(e,r)}function fr(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Er=!1;function Of(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ty(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function lr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Vr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,fr(e,n)}return s=r.interleaved,s===null?(t.next=t,Ff(r)):(t.next=s.next,s.next=t),r.interleaved=t,fr(e,n)}function ra(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,bf(e,n)}}function Sp(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function _a(e,t,n,r){var s=e.updateQueue;Er=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=c))}if(i!==null){var p=s.baseState;o=0,f=d=c=null,l=i;do{var h=l.lane,w=l.eventTime;if((r&h)===h){f!==null&&(f=f.next={eventTime:w,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,S=l;switch(h=t,w=n,S.tag){case 1:if(x=S.payload,typeof x=="function"){p=x.call(w,p,h);break e}p=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=S.payload,h=typeof x=="function"?x.call(w,p,h):x,h==null)break e;p=Je({},p,h);break e;case 2:Er=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else w={eventTime:w,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=w,c=p):f=f.next=w,o|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(f===null&&(c=p),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Ps|=o,e.lanes=o,e.memoizedState=p}}function bp(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(H(191,s));s.call(r)}}}var nl={},Qn=es(nl),Oo=es(nl),Do=es(nl);function us(e){if(e===nl)throw Error(H(174));return e}function Df(e,t){switch($e(Do,t),$e(Oo,e),$e(Qn,nl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Wc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Wc(t,e)}Ve(Qn),$e(Qn,t)}function Ii(){Ve(Qn),Ve(Oo),Ve(Do)}function ny(e){us(Do.current);var t=us(Qn.current),n=Wc(t,e.type);t!==n&&($e(Oo,e),$e(Qn,n))}function zf(e){Oo.current===e&&(Ve(Qn),Ve(Oo))}var Ye=es(0);function Aa(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var dc=[];function $f(){for(var e=0;e<dc.length;e++)dc[e]._workInProgressVersionPrimary=null;dc.length=0}var sa=pr.ReactCurrentDispatcher,fc=pr.ReactCurrentBatchConfig,js=0,Xe=null,ft=null,vt=null,Fa=!1,xo=!1,zo=0,G1=0;function Mt(){throw Error(H(321))}function Bf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!In(e[n],t[n]))return!1;return!0}function Uf(e,t,n,r,s,i){if(js=i,Xe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,sa.current=e===null||e.memoizedState===null?J1:Z1,e=n(r,s),xo){i=0;do{if(xo=!1,zo=0,25<=i)throw Error(H(301));i+=1,vt=ft=null,t.updateQueue=null,sa.current=eS,e=n(r,s)}while(xo)}if(sa.current=Oa,t=ft!==null&&ft.next!==null,js=0,vt=ft=Xe=null,Fa=!1,t)throw Error(H(300));return e}function Vf(){var e=zo!==0;return zo=0,e}function $n(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?Xe.memoizedState=vt=e:vt=vt.next=e,vt}function xn(){if(ft===null){var e=Xe.alternate;e=e!==null?e.memoizedState:null}else e=ft.next;var t=vt===null?Xe.memoizedState:vt.next;if(t!==null)vt=t,ft=e;else{if(e===null)throw Error(H(310));ft=e,e={memoizedState:ft.memoizedState,baseState:ft.baseState,baseQueue:ft.baseQueue,queue:ft.queue,next:null},vt===null?Xe.memoizedState=vt=e:vt=vt.next=e}return vt}function $o(e,t){return typeof t=="function"?t(e):t}function hc(e){var t=xn(),n=t.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=e;var r=ft,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,d=i;do{var f=d.lane;if((js&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=p,o=r):c=c.next=p,Xe.lanes|=f,Ps|=f}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=l,In(r,t.memoizedState)||(Gt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Xe.lanes|=i,Ps|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function pc(e){var t=xn(),n=t.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);In(i,t.memoizedState)||(Gt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function ry(){}function sy(e,t){var n=Xe,r=xn(),s=t(),i=!In(r.memoizedState,s);if(i&&(r.memoizedState=s,Gt=!0),r=r.queue,Wf(ly.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||vt!==null&&vt.memoizedState.tag&1){if(n.flags|=2048,Bo(9,oy.bind(null,n,r,s,t),void 0,null),yt===null)throw Error(H(349));js&30||iy(n,t,s)}return s}function iy(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Xe.updateQueue,t===null?(t={lastEffect:null,stores:null},Xe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function oy(e,t,n,r){t.value=n,t.getSnapshot=r,ay(t)&&uy(e)}function ly(e,t,n){return n(function(){ay(t)&&uy(e)})}function ay(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!In(e,n)}catch{return!0}}function uy(e){var t=fr(e,1);t!==null&&Rn(t,e,1,-1)}function Cp(e){var t=$n();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$o,lastRenderedState:e},t.queue=e,e=e.dispatch=X1.bind(null,Xe,e),[t.memoizedState,e]}function Bo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Xe.updateQueue,t===null?(t={lastEffect:null,stores:null},Xe.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function cy(){return xn().memoizedState}function ia(e,t,n,r){var s=$n();Xe.flags|=e,s.memoizedState=Bo(1|t,n,void 0,r===void 0?null:r)}function uu(e,t,n,r){var s=xn();r=r===void 0?null:r;var i=void 0;if(ft!==null){var o=ft.memoizedState;if(i=o.destroy,r!==null&&Bf(r,o.deps)){s.memoizedState=Bo(t,n,i,r);return}}Xe.flags|=e,s.memoizedState=Bo(1|t,n,i,r)}function kp(e,t){return ia(8390656,8,e,t)}function Wf(e,t){return uu(2048,8,e,t)}function dy(e,t){return uu(4,2,e,t)}function fy(e,t){return uu(4,4,e,t)}function hy(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function py(e,t,n){return n=n!=null?n.concat([e]):null,uu(4,4,hy.bind(null,t,e),n)}function Hf(){}function my(e,t){var n=xn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Bf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function gy(e,t){var n=xn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Bf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function vy(e,t,n){return js&21?(In(n,t)||(n=bv(),Xe.lanes|=n,Ps|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Gt=!0),e.memoizedState=n)}function q1(e,t){var n=Oe;Oe=n!==0&&4>n?n:4,e(!0);var r=fc.transition;fc.transition={};try{e(!1),t()}finally{Oe=n,fc.transition=r}}function yy(){return xn().memoizedState}function Y1(e,t,n){var r=Hr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},xy(e))wy(t,n);else if(n=ey(e,t,n,r),n!==null){var s=$t();Rn(n,e,r,s),Sy(n,t,r)}}function X1(e,t,n){var r=Hr(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(xy(e))wy(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,In(l,o)){var c=t.interleaved;c===null?(s.next=s,Ff(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=ey(e,t,s,r),n!==null&&(s=$t(),Rn(n,e,r,s),Sy(n,t,r))}}function xy(e){var t=e.alternate;return e===Xe||t!==null&&t===Xe}function wy(e,t){xo=Fa=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Sy(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,bf(e,n)}}var Oa={readContext:yn,useCallback:Mt,useContext:Mt,useEffect:Mt,useImperativeHandle:Mt,useInsertionEffect:Mt,useLayoutEffect:Mt,useMemo:Mt,useReducer:Mt,useRef:Mt,useState:Mt,useDebugValue:Mt,useDeferredValue:Mt,useTransition:Mt,useMutableSource:Mt,useSyncExternalStore:Mt,useId:Mt,unstable_isNewReconciler:!1},J1={readContext:yn,useCallback:function(e,t){return $n().memoizedState=[e,t===void 0?null:t],e},useContext:yn,useEffect:kp,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ia(4194308,4,hy.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ia(4194308,4,e,t)},useInsertionEffect:function(e,t){return ia(4,2,e,t)},useMemo:function(e,t){var n=$n();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=$n();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Y1.bind(null,Xe,e),[r.memoizedState,e]},useRef:function(e){var t=$n();return e={current:e},t.memoizedState=e},useState:Cp,useDebugValue:Hf,useDeferredValue:function(e){return $n().memoizedState=e},useTransition:function(){var e=Cp(!1),t=e[0];return e=q1.bind(null,e[1]),$n().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Xe,s=$n();if(Qe){if(n===void 0)throw Error(H(407));n=n()}else{if(n=t(),yt===null)throw Error(H(349));js&30||iy(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,kp(ly.bind(null,r,i,e),[e]),r.flags|=2048,Bo(9,oy.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=$n(),t=yt.identifierPrefix;if(Qe){var n=or,r=ir;n=(r&~(1<<32-Pn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=zo++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=G1++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Z1={readContext:yn,useCallback:my,useContext:yn,useEffect:Wf,useImperativeHandle:py,useInsertionEffect:dy,useLayoutEffect:fy,useMemo:gy,useReducer:hc,useRef:cy,useState:function(){return hc($o)},useDebugValue:Hf,useDeferredValue:function(e){var t=xn();return vy(t,ft.memoizedState,e)},useTransition:function(){var e=hc($o)[0],t=xn().memoizedState;return[e,t]},useMutableSource:ry,useSyncExternalStore:sy,useId:yy,unstable_isNewReconciler:!1},eS={readContext:yn,useCallback:my,useContext:yn,useEffect:Wf,useImperativeHandle:py,useInsertionEffect:dy,useLayoutEffect:fy,useMemo:gy,useReducer:pc,useRef:cy,useState:function(){return pc($o)},useDebugValue:Hf,useDeferredValue:function(e){var t=xn();return ft===null?t.memoizedState=e:vy(t,ft.memoizedState,e)},useTransition:function(){var e=pc($o)[0],t=xn().memoizedState;return[e,t]},useMutableSource:ry,useSyncExternalStore:sy,useId:yy,unstable_isNewReconciler:!1};function Cn(e,t){if(e&&e.defaultProps){t=Je({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function dd(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Je({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var cu={isMounted:function(e){return(e=e._reactInternals)?_s(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=$t(),s=Hr(e),i=lr(r,s);i.payload=t,n!=null&&(i.callback=n),t=Vr(e,i,s),t!==null&&(Rn(t,e,s,r),ra(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=$t(),s=Hr(e),i=lr(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Vr(e,i,s),t!==null&&(Rn(t,e,s,r),ra(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=$t(),r=Hr(e),s=lr(n,r);s.tag=2,t!=null&&(s.callback=t),t=Vr(e,s,r),t!==null&&(Rn(t,e,r,n),ra(t,e,r))}};function Ep(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!Lo(n,r)||!Lo(s,i):!0}function by(e,t,n){var r=!1,s=Jr,i=t.contextType;return typeof i=="object"&&i!==null?i=yn(i):(s=Yt(t)?Ns:Tt.current,r=t.contextTypes,i=(r=r!=null)?Pi(e,s):Jr),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=cu,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function Np(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&cu.enqueueReplaceState(t,t.state,null)}function fd(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Of(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=yn(i):(i=Yt(t)?Ns:Tt.current,s.context=Pi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(dd(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&cu.enqueueReplaceState(s,s.state,null),_a(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Li(e,t){try{var n="",r=t;do n+=jw(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function mc(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function hd(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var tS=typeof WeakMap=="function"?WeakMap:Map;function Cy(e,t,n){n=lr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){za||(za=!0,Cd=r),hd(e,t)},n}function ky(e,t,n){n=lr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){hd(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){hd(e,t),typeof r!="function"&&(Wr===null?Wr=new Set([this]):Wr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function Mp(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new tS;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=mS.bind(null,e,t,n),t.then(e,e))}function jp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Pp(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=lr(-1,1),t.tag=2,Vr(n,t,1))),n.lanes|=1),e)}var nS=pr.ReactCurrentOwner,Gt=!1;function Dt(e,t,n,r){t.child=e===null?Zv(t,null,n,r):Ti(t,e.child,n,r)}function Rp(e,t,n,r,s){n=n.render;var i=t.ref;return di(t,s),r=Uf(e,t,n,r,i,s),n=Vf(),e!==null&&!Gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,hr(e,t,s)):(Qe&&n&&Rf(t),t.flags|=1,Dt(e,t,r,s),t.child)}function Tp(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!Zf(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,Ey(e,t,i,r,s)):(e=ua(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Lo,n(o,r)&&e.ref===t.ref)return hr(e,t,s)}return t.flags|=1,e=Qr(i,r),e.ref=t.ref,e.return=t,t.child=e}function Ey(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(Lo(i,r)&&e.ref===t.ref)if(Gt=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Gt=!0);else return t.lanes=e.lanes,hr(e,t,s)}return pd(e,t,n,r,s)}function Ny(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},$e(oi,tn),tn|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,$e(oi,tn),tn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,$e(oi,tn),tn|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,$e(oi,tn),tn|=r;return Dt(e,t,s,n),t.child}function My(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function pd(e,t,n,r,s){var i=Yt(n)?Ns:Tt.current;return i=Pi(t,i),di(t,s),n=Uf(e,t,n,r,i,s),r=Vf(),e!==null&&!Gt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,hr(e,t,s)):(Qe&&r&&Rf(t),t.flags|=1,Dt(e,t,n,s),t.child)}function Ip(e,t,n,r,s){if(Yt(n)){var i=!0;Pa(t)}else i=!1;if(di(t,s),t.stateNode===null)oa(e,t),by(t,n,r),fd(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=yn(d):(d=Yt(n)?Ns:Tt.current,d=Pi(t,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==d)&&Np(t,o,r,d),Er=!1;var h=t.memoizedState;o.state=h,_a(t,r,o,s),c=t.memoizedState,l!==r||h!==c||qt.current||Er?(typeof f=="function"&&(dd(t,n,f,r),c=t.memoizedState),(l=Er||Ep(t,n,l,r,h,c,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,ty(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:Cn(t.type,l),o.props=d,p=t.pendingProps,h=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=yn(c):(c=Yt(n)?Ns:Tt.current,c=Pi(t,c));var w=n.getDerivedStateFromProps;(f=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||h!==c)&&Np(t,o,r,c),Er=!1,h=t.memoizedState,o.state=h,_a(t,r,o,s);var x=t.memoizedState;l!==p||h!==x||qt.current||Er?(typeof w=="function"&&(dd(t,n,w,r),x=t.memoizedState),(d=Er||Ep(t,n,d,r,h,x,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=x),o.props=r,o.state=x,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return md(e,t,n,r,i,s)}function md(e,t,n,r,s,i){My(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&vp(t,n,!1),hr(e,t,i);r=t.stateNode,nS.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Ti(t,e.child,null,i),t.child=Ti(t,null,l,i)):Dt(e,t,l,i),t.memoizedState=r.state,s&&vp(t,n,!0),t.child}function jy(e){var t=e.stateNode;t.pendingContext?gp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&gp(e,t.context,!1),Df(e,t.containerInfo)}function Lp(e,t,n,r,s){return Ri(),If(s),t.flags|=256,Dt(e,t,n,r),t.child}var gd={dehydrated:null,treeContext:null,retryLane:0};function vd(e){return{baseLanes:e,cachePool:null,transitions:null}}function Py(e,t,n){var r=t.pendingProps,s=Ye.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),$e(Ye,s&1),e===null)return ud(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=hu(o,r,0,null),e=Es(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=vd(n),t.memoizedState=gd,e):Qf(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return rS(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=Qr(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Qr(l,i):(i=Es(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?vd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=gd,r}return i=e.child,e=i.sibling,r=Qr(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Qf(e,t){return t=hu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function _l(e,t,n,r){return r!==null&&If(r),Ti(t,e.child,null,n),e=Qf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function rS(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=mc(Error(H(422))),_l(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=hu({mode:"visible",children:r.children},s,0,null),i=Es(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Ti(t,e.child,null,o),t.child.memoizedState=vd(o),t.memoizedState=gd,i);if(!(t.mode&1))return _l(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(H(419)),r=mc(i,r,void 0),_l(e,t,o,r)}if(l=(o&e.childLanes)!==0,Gt||l){if(r=yt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,fr(e,s),Rn(r,e,s,-1))}return Jf(),r=mc(Error(H(421))),_l(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=gS.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,nn=Ur(s.nextSibling),rn=t,Qe=!0,jn=null,e!==null&&(hn[pn++]=ir,hn[pn++]=or,hn[pn++]=Ms,ir=e.id,or=e.overflow,Ms=t),t=Qf(t,r.children),t.flags|=4096,t)}function _p(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),cd(e.return,t,n)}function gc(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function Ry(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(Dt(e,t,r.children,n),r=Ye.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&_p(e,n,t);else if(e.tag===19)_p(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if($e(Ye,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&Aa(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),gc(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Aa(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}gc(t,!0,n,null,i);break;case"together":gc(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function oa(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function hr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ps|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(H(153));if(t.child!==null){for(e=t.child,n=Qr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Qr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function sS(e,t,n){switch(t.tag){case 3:jy(t),Ri();break;case 5:ny(t);break;case 1:Yt(t.type)&&Pa(t);break;case 4:Df(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;$e(Ia,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?($e(Ye,Ye.current&1),t.flags|=128,null):n&t.child.childLanes?Py(e,t,n):($e(Ye,Ye.current&1),e=hr(e,t,n),e!==null?e.sibling:null);$e(Ye,Ye.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Ry(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),$e(Ye,Ye.current),r)break;return null;case 22:case 23:return t.lanes=0,Ny(e,t,n)}return hr(e,t,n)}var Ty,yd,Iy,Ly;Ty=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};yd=function(){};Iy=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,us(Qn.current);var i=null;switch(n){case"input":s=$c(e,s),r=$c(e,r),i=[];break;case"select":s=Je({},s,{value:void 0}),r=Je({},r,{value:void 0}),i=[];break;case"textarea":s=Vc(e,s),r=Vc(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=Ma)}Hc(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(No.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(No.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ue("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Ly=function(e,t,n,r){n!==r&&(t.flags|=4)};function Zi(e,t){if(!Qe)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function iS(e,t,n){var r=t.pendingProps;switch(Tf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(t),null;case 1:return Yt(t.type)&&ja(),jt(t),null;case 3:return r=t.stateNode,Ii(),Ve(qt),Ve(Tt),$f(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Il(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,jn!==null&&(Nd(jn),jn=null))),yd(e,t),jt(t),null;case 5:zf(t);var s=us(Do.current);if(n=t.type,e!==null&&t.stateNode!=null)Iy(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(H(166));return jt(t),null}if(e=us(Qn.current),Il(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Wn]=t,r[Fo]=i,e=(t.mode&1)!==0,n){case"dialog":Ue("cancel",r),Ue("close",r);break;case"iframe":case"object":case"embed":Ue("load",r);break;case"video":case"audio":for(s=0;s<co.length;s++)Ue(co[s],r);break;case"source":Ue("error",r);break;case"img":case"image":case"link":Ue("error",r),Ue("load",r);break;case"details":Ue("toggle",r);break;case"input":Vh(r,i),Ue("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ue("invalid",r);break;case"textarea":Hh(r,i),Ue("invalid",r)}Hc(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Tl(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Tl(r.textContent,l,e),s=["children",""+l]):No.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ue("scroll",r)}switch(n){case"input":Cl(r),Wh(r,i,!0);break;case"textarea":Cl(r),Qh(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Ma)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=lv(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Wn]=t,e[Fo]=r,Ty(e,t,!1,!1),t.stateNode=e;e:{switch(o=Qc(n,r),n){case"dialog":Ue("cancel",e),Ue("close",e),s=r;break;case"iframe":case"object":case"embed":Ue("load",e),s=r;break;case"video":case"audio":for(s=0;s<co.length;s++)Ue(co[s],e);s=r;break;case"source":Ue("error",e),s=r;break;case"img":case"image":case"link":Ue("error",e),Ue("load",e),s=r;break;case"details":Ue("toggle",e),s=r;break;case"input":Vh(e,r),s=$c(e,r),Ue("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Je({},r,{value:void 0}),Ue("invalid",e);break;case"textarea":Hh(e,r),s=Vc(e,r),Ue("invalid",e);break;default:s=r}Hc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?cv(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&av(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Mo(e,c):typeof c=="number"&&Mo(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(No.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Ue("scroll",e):c!=null&&gf(e,i,c,o))}switch(n){case"input":Cl(e),Wh(e,r,!1);break;case"textarea":Cl(e),Qh(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Xr(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?li(e,!!r.multiple,i,!1):r.defaultValue!=null&&li(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Ma)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return jt(t),null;case 6:if(e&&t.stateNode!=null)Ly(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(H(166));if(n=us(Do.current),us(Qn.current),Il(t)){if(r=t.stateNode,n=t.memoizedProps,r[Wn]=t,(i=r.nodeValue!==n)&&(e=rn,e!==null))switch(e.tag){case 3:Tl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Tl(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Wn]=t,t.stateNode=r}return jt(t),null;case 13:if(Ve(Ye),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Qe&&nn!==null&&t.mode&1&&!(t.flags&128))Xv(),Ri(),t.flags|=98560,i=!1;else if(i=Il(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(H(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[Wn]=t}else Ri(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;jt(t),i=!1}else jn!==null&&(Nd(jn),jn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ye.current&1?pt===0&&(pt=3):Jf())),t.updateQueue!==null&&(t.flags|=4),jt(t),null);case 4:return Ii(),yd(e,t),e===null&&_o(t.stateNode.containerInfo),jt(t),null;case 10:return Af(t.type._context),jt(t),null;case 17:return Yt(t.type)&&ja(),jt(t),null;case 19:if(Ve(Ye),i=t.memoizedState,i===null)return jt(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)Zi(i,!1);else{if(pt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Aa(e),o!==null){for(t.flags|=128,Zi(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return $e(Ye,Ye.current&1|2),t.child}e=e.sibling}i.tail!==null&&lt()>_i&&(t.flags|=128,r=!0,Zi(i,!1),t.lanes=4194304)}else{if(!r)if(e=Aa(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Zi(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Qe)return jt(t),null}else 2*lt()-i.renderingStartTime>_i&&n!==1073741824&&(t.flags|=128,r=!0,Zi(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=lt(),t.sibling=null,n=Ye.current,$e(Ye,r?n&1|2:n&1),t):(jt(t),null);case 22:case 23:return Xf(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?tn&1073741824&&(jt(t),t.subtreeFlags&6&&(t.flags|=8192)):jt(t),null;case 24:return null;case 25:return null}throw Error(H(156,t.tag))}function oS(e,t){switch(Tf(t),t.tag){case 1:return Yt(t.type)&&ja(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ii(),Ve(qt),Ve(Tt),$f(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return zf(t),null;case 13:if(Ve(Ye),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(H(340));Ri()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ve(Ye),null;case 4:return Ii(),null;case 10:return Af(t.type._context),null;case 22:case 23:return Xf(),null;case 24:return null;default:return null}}var Al=!1,Pt=!1,lS=typeof WeakSet=="function"?WeakSet:Set,ee=null;function ii(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){nt(e,t,r)}else n.current=null}function xd(e,t,n){try{n()}catch(r){nt(e,t,r)}}var Ap=!1;function aS(e,t){if(nd=ka,e=Dv(),Pf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,d=0,f=0,p=e,h=null;t:for(;;){for(var w;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(c=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(w=p.firstChild)!==null;)h=p,p=w;for(;;){if(p===e)break t;if(h===n&&++d===s&&(l=o),h===i&&++f===r&&(c=o),(w=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=w}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(rd={focusedElem:e,selectionRange:n},ka=!1,ee=t;ee!==null;)if(t=ee,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ee=e;else for(;ee!==null;){t=ee;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var S=x.memoizedProps,C=x.memoizedState,v=t.stateNode,g=v.getSnapshotBeforeUpdate(t.elementType===t.type?S:Cn(t.type,S),C);v.__reactInternalSnapshotBeforeUpdate=g}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(m){nt(t,t.return,m)}if(e=t.sibling,e!==null){e.return=t.return,ee=e;break}ee=t.return}return x=Ap,Ap=!1,x}function wo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&xd(t,n,i)}s=s.next}while(s!==r)}}function du(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function wd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function _y(e){var t=e.alternate;t!==null&&(e.alternate=null,_y(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Wn],delete t[Fo],delete t[od],delete t[W1],delete t[H1])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ay(e){return e.tag===5||e.tag===3||e.tag===4}function Fp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ay(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Sd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ma));else if(r!==4&&(e=e.child,e!==null))for(Sd(e,t,n),e=e.sibling;e!==null;)Sd(e,t,n),e=e.sibling}function bd(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(bd(e,t,n),e=e.sibling;e!==null;)bd(e,t,n),e=e.sibling}var bt=null,Mn=!1;function Sr(e,t,n){for(n=n.child;n!==null;)Fy(e,t,n),n=n.sibling}function Fy(e,t,n){if(Hn&&typeof Hn.onCommitFiberUnmount=="function")try{Hn.onCommitFiberUnmount(ru,n)}catch{}switch(n.tag){case 5:Pt||ii(n,t);case 6:var r=bt,s=Mn;bt=null,Sr(e,t,n),bt=r,Mn=s,bt!==null&&(Mn?(e=bt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):bt.removeChild(n.stateNode));break;case 18:bt!==null&&(Mn?(e=bt,n=n.stateNode,e.nodeType===8?uc(e.parentNode,n):e.nodeType===1&&uc(e,n),To(e)):uc(bt,n.stateNode));break;case 4:r=bt,s=Mn,bt=n.stateNode.containerInfo,Mn=!0,Sr(e,t,n),bt=r,Mn=s;break;case 0:case 11:case 14:case 15:if(!Pt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&xd(n,t,o),s=s.next}while(s!==r)}Sr(e,t,n);break;case 1:if(!Pt&&(ii(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){nt(n,t,l)}Sr(e,t,n);break;case 21:Sr(e,t,n);break;case 22:n.mode&1?(Pt=(r=Pt)||n.memoizedState!==null,Sr(e,t,n),Pt=r):Sr(e,t,n);break;default:Sr(e,t,n)}}function Op(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new lS),t.forEach(function(r){var s=vS.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Sn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:bt=l.stateNode,Mn=!1;break e;case 3:bt=l.stateNode.containerInfo,Mn=!0;break e;case 4:bt=l.stateNode.containerInfo,Mn=!0;break e}l=l.return}if(bt===null)throw Error(H(160));Fy(i,o,s),bt=null,Mn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){nt(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Oy(t,e),t=t.sibling}function Oy(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Sn(t,e),zn(e),r&4){try{wo(3,e,e.return),du(3,e)}catch(S){nt(e,e.return,S)}try{wo(5,e,e.return)}catch(S){nt(e,e.return,S)}}break;case 1:Sn(t,e),zn(e),r&512&&n!==null&&ii(n,n.return);break;case 5:if(Sn(t,e),zn(e),r&512&&n!==null&&ii(n,n.return),e.flags&32){var s=e.stateNode;try{Mo(s,"")}catch(S){nt(e,e.return,S)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&iv(s,i),Qc(l,o);var d=Qc(l,i);for(o=0;o<c.length;o+=2){var f=c[o],p=c[o+1];f==="style"?cv(s,p):f==="dangerouslySetInnerHTML"?av(s,p):f==="children"?Mo(s,p):gf(s,f,p,d)}switch(l){case"input":Bc(s,i);break;case"textarea":ov(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?li(s,!!i.multiple,w,!1):h!==!!i.multiple&&(i.defaultValue!=null?li(s,!!i.multiple,i.defaultValue,!0):li(s,!!i.multiple,i.multiple?[]:"",!1))}s[Fo]=i}catch(S){nt(e,e.return,S)}}break;case 6:if(Sn(t,e),zn(e),r&4){if(e.stateNode===null)throw Error(H(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(S){nt(e,e.return,S)}}break;case 3:if(Sn(t,e),zn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{To(t.containerInfo)}catch(S){nt(e,e.return,S)}break;case 4:Sn(t,e),zn(e);break;case 13:Sn(t,e),zn(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(qf=lt())),r&4&&Op(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(Pt=(d=Pt)||f,Sn(t,e),Pt=d):Sn(t,e),zn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!f&&e.mode&1)for(ee=e,f=e.child;f!==null;){for(p=ee=f;ee!==null;){switch(h=ee,w=h.child,h.tag){case 0:case 11:case 14:case 15:wo(4,h,h.return);break;case 1:ii(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(S){nt(r,n,S)}}break;case 5:ii(h,h.return);break;case 22:if(h.memoizedState!==null){zp(p);continue}}w!==null?(w.return=h,ee=w):zp(p)}f=f.sibling}e:for(f=null,p=e;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=uv("display",o))}catch(S){nt(e,e.return,S)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(S){nt(e,e.return,S)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Sn(t,e),zn(e),r&4&&Op(e);break;case 21:break;default:Sn(t,e),zn(e)}}function zn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Ay(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Mo(s,""),r.flags&=-33);var i=Fp(e);bd(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Fp(e);Sd(e,l,o);break;default:throw Error(H(161))}}catch(c){nt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function uS(e,t,n){ee=e,Dy(e)}function Dy(e,t,n){for(var r=(e.mode&1)!==0;ee!==null;){var s=ee,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Al;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Pt;l=Al;var d=Pt;if(Al=o,(Pt=c)&&!d)for(ee=s;ee!==null;)o=ee,c=o.child,o.tag===22&&o.memoizedState!==null?$p(s):c!==null?(c.return=o,ee=c):$p(s);for(;i!==null;)ee=i,Dy(i),i=i.sibling;ee=s,Al=l,Pt=d}Dp(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ee=i):Dp(e)}}function Dp(e){for(;ee!==null;){var t=ee;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Pt||du(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Pt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Cn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&bp(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}bp(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&To(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}Pt||t.flags&512&&wd(t)}catch(h){nt(t,t.return,h)}}if(t===e){ee=null;break}if(n=t.sibling,n!==null){n.return=t.return,ee=n;break}ee=t.return}}function zp(e){for(;ee!==null;){var t=ee;if(t===e){ee=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ee=n;break}ee=t.return}}function $p(e){for(;ee!==null;){var t=ee;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{du(4,t)}catch(c){nt(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){nt(t,s,c)}}var i=t.return;try{wd(t)}catch(c){nt(t,i,c)}break;case 5:var o=t.return;try{wd(t)}catch(c){nt(t,o,c)}}}catch(c){nt(t,t.return,c)}if(t===e){ee=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ee=l;break}ee=t.return}}var cS=Math.ceil,Da=pr.ReactCurrentDispatcher,Kf=pr.ReactCurrentOwner,vn=pr.ReactCurrentBatchConfig,Re=0,yt=null,at=null,Ct=0,tn=0,oi=es(0),pt=0,Uo=null,Ps=0,fu=0,Gf=0,So=null,Kt=null,qf=0,_i=1/0,Zn=null,za=!1,Cd=null,Wr=null,Fl=!1,Dr=null,$a=0,bo=0,kd=null,la=-1,aa=0;function $t(){return Re&6?lt():la!==-1?la:la=lt()}function Hr(e){return e.mode&1?Re&2&&Ct!==0?Ct&-Ct:K1.transition!==null?(aa===0&&(aa=bv()),aa):(e=Oe,e!==0||(e=window.event,e=e===void 0?16:Pv(e.type)),e):1}function Rn(e,t,n,r){if(50<bo)throw bo=0,kd=null,Error(H(185));Zo(e,n,r),(!(Re&2)||e!==yt)&&(e===yt&&(!(Re&2)&&(fu|=n),pt===4&&Mr(e,Ct)),Xt(e,r),n===1&&Re===0&&!(t.mode&1)&&(_i=lt()+500,au&&ts()))}function Xt(e,t){var n=e.callbackNode;Kw(e,t);var r=Ca(e,e===yt?Ct:0);if(r===0)n!==null&&qh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&qh(n),t===1)e.tag===0?Q1(Bp.bind(null,e)):Gv(Bp.bind(null,e)),U1(function(){!(Re&6)&&ts()}),n=null;else{switch(Cv(r)){case 1:n=Sf;break;case 4:n=wv;break;case 16:n=ba;break;case 536870912:n=Sv;break;default:n=ba}n=Qy(n,zy.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function zy(e,t){if(la=-1,aa=0,Re&6)throw Error(H(327));var n=e.callbackNode;if(fi()&&e.callbackNode!==n)return null;var r=Ca(e,e===yt?Ct:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Ba(e,r);else{t=r;var s=Re;Re|=2;var i=By();(yt!==e||Ct!==t)&&(Zn=null,_i=lt()+500,ks(e,t));do try{hS();break}catch(l){$y(e,l)}while(!0);_f(),Da.current=i,Re=s,at!==null?t=0:(yt=null,Ct=0,t=pt)}if(t!==0){if(t===2&&(s=Xc(e),s!==0&&(r=s,t=Ed(e,s))),t===1)throw n=Uo,ks(e,0),Mr(e,r),Xt(e,lt()),n;if(t===6)Mr(e,r);else{if(s=e.current.alternate,!(r&30)&&!dS(s)&&(t=Ba(e,r),t===2&&(i=Xc(e),i!==0&&(r=i,t=Ed(e,i))),t===1))throw n=Uo,ks(e,0),Mr(e,r),Xt(e,lt()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(H(345));case 2:is(e,Kt,Zn);break;case 3:if(Mr(e,r),(r&130023424)===r&&(t=qf+500-lt(),10<t)){if(Ca(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){$t(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=id(is.bind(null,e,Kt,Zn),t);break}is(e,Kt,Zn);break;case 4:if(Mr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-Pn(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=lt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*cS(r/1960))-r,10<r){e.timeoutHandle=id(is.bind(null,e,Kt,Zn),r);break}is(e,Kt,Zn);break;case 5:is(e,Kt,Zn);break;default:throw Error(H(329))}}}return Xt(e,lt()),e.callbackNode===n?zy.bind(null,e):null}function Ed(e,t){var n=So;return e.current.memoizedState.isDehydrated&&(ks(e,t).flags|=256),e=Ba(e,t),e!==2&&(t=Kt,Kt=n,t!==null&&Nd(t)),e}function Nd(e){Kt===null?Kt=e:Kt.push.apply(Kt,e)}function dS(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!In(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Mr(e,t){for(t&=~Gf,t&=~fu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Pn(t),r=1<<n;e[n]=-1,t&=~r}}function Bp(e){if(Re&6)throw Error(H(327));fi();var t=Ca(e,0);if(!(t&1))return Xt(e,lt()),null;var n=Ba(e,t);if(e.tag!==0&&n===2){var r=Xc(e);r!==0&&(t=r,n=Ed(e,r))}if(n===1)throw n=Uo,ks(e,0),Mr(e,t),Xt(e,lt()),n;if(n===6)throw Error(H(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,is(e,Kt,Zn),Xt(e,lt()),null}function Yf(e,t){var n=Re;Re|=1;try{return e(t)}finally{Re=n,Re===0&&(_i=lt()+500,au&&ts())}}function Rs(e){Dr!==null&&Dr.tag===0&&!(Re&6)&&fi();var t=Re;Re|=1;var n=vn.transition,r=Oe;try{if(vn.transition=null,Oe=1,e)return e()}finally{Oe=r,vn.transition=n,Re=t,!(Re&6)&&ts()}}function Xf(){tn=oi.current,Ve(oi)}function ks(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,B1(n)),at!==null)for(n=at.return;n!==null;){var r=n;switch(Tf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ja();break;case 3:Ii(),Ve(qt),Ve(Tt),$f();break;case 5:zf(r);break;case 4:Ii();break;case 13:Ve(Ye);break;case 19:Ve(Ye);break;case 10:Af(r.type._context);break;case 22:case 23:Xf()}n=n.return}if(yt=e,at=e=Qr(e.current,null),Ct=tn=t,pt=0,Uo=null,Gf=fu=Ps=0,Kt=So=null,as!==null){for(t=0;t<as.length;t++)if(n=as[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}as=null}return e}function $y(e,t){do{var n=at;try{if(_f(),sa.current=Oa,Fa){for(var r=Xe.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Fa=!1}if(js=0,vt=ft=Xe=null,xo=!1,zo=0,Kf.current=null,n===null||n.return===null){pt=1,Uo=t,at=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=Ct,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var w=jp(o);if(w!==null){w.flags&=-257,Pp(w,o,l,i,t),w.mode&1&&Mp(i,d,t),t=w,c=d;var x=t.updateQueue;if(x===null){var S=new Set;S.add(c),t.updateQueue=S}else x.add(c);break e}else{if(!(t&1)){Mp(i,d,t),Jf();break e}c=Error(H(426))}}else if(Qe&&l.mode&1){var C=jp(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),Pp(C,o,l,i,t),If(Li(c,l));break e}}i=c=Li(c,l),pt!==4&&(pt=2),So===null?So=[i]:So.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=Cy(i,c,t);Sp(i,v);break e;case 1:l=c;var g=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof g.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Wr===null||!Wr.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var m=ky(i,l,t);Sp(i,m);break e}}i=i.return}while(i!==null)}Vy(n)}catch(b){t=b,at===n&&n!==null&&(at=n=n.return);continue}break}while(!0)}function By(){var e=Da.current;return Da.current=Oa,e===null?Oa:e}function Jf(){(pt===0||pt===3||pt===2)&&(pt=4),yt===null||!(Ps&268435455)&&!(fu&268435455)||Mr(yt,Ct)}function Ba(e,t){var n=Re;Re|=2;var r=By();(yt!==e||Ct!==t)&&(Zn=null,ks(e,t));do try{fS();break}catch(s){$y(e,s)}while(!0);if(_f(),Re=n,Da.current=r,at!==null)throw Error(H(261));return yt=null,Ct=0,pt}function fS(){for(;at!==null;)Uy(at)}function hS(){for(;at!==null&&!Dw();)Uy(at)}function Uy(e){var t=Hy(e.alternate,e,tn);e.memoizedProps=e.pendingProps,t===null?Vy(e):at=t,Kf.current=null}function Vy(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=oS(n,t),n!==null){n.flags&=32767,at=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{pt=6,at=null;return}}else if(n=iS(n,t,tn),n!==null){at=n;return}if(t=t.sibling,t!==null){at=t;return}at=t=e}while(t!==null);pt===0&&(pt=5)}function is(e,t,n){var r=Oe,s=vn.transition;try{vn.transition=null,Oe=1,pS(e,t,n,r)}finally{vn.transition=s,Oe=r}return null}function pS(e,t,n,r){do fi();while(Dr!==null);if(Re&6)throw Error(H(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(H(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(Gw(e,i),e===yt&&(at=yt=null,Ct=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Fl||(Fl=!0,Qy(ba,function(){return fi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=vn.transition,vn.transition=null;var o=Oe;Oe=1;var l=Re;Re|=4,Kf.current=null,aS(e,n),Oy(n,e),_1(rd),ka=!!nd,rd=nd=null,e.current=n,uS(n),zw(),Re=l,Oe=o,vn.transition=i}else e.current=n;if(Fl&&(Fl=!1,Dr=e,$a=s),i=e.pendingLanes,i===0&&(Wr=null),Uw(n.stateNode),Xt(e,lt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(za)throw za=!1,e=Cd,Cd=null,e;return $a&1&&e.tag!==0&&fi(),i=e.pendingLanes,i&1?e===kd?bo++:(bo=0,kd=e):bo=0,ts(),null}function fi(){if(Dr!==null){var e=Cv($a),t=vn.transition,n=Oe;try{if(vn.transition=null,Oe=16>e?16:e,Dr===null)var r=!1;else{if(e=Dr,Dr=null,$a=0,Re&6)throw Error(H(331));var s=Re;for(Re|=4,ee=e.current;ee!==null;){var i=ee,o=i.child;if(ee.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(ee=d;ee!==null;){var f=ee;switch(f.tag){case 0:case 11:case 15:wo(8,f,i)}var p=f.child;if(p!==null)p.return=f,ee=p;else for(;ee!==null;){f=ee;var h=f.sibling,w=f.return;if(_y(f),f===d){ee=null;break}if(h!==null){h.return=w,ee=h;break}ee=w}}}var x=i.alternate;if(x!==null){var S=x.child;if(S!==null){x.child=null;do{var C=S.sibling;S.sibling=null,S=C}while(S!==null)}}ee=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ee=o;else e:for(;ee!==null;){if(i=ee,i.flags&2048)switch(i.tag){case 0:case 11:case 15:wo(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,ee=v;break e}ee=i.return}}var g=e.current;for(ee=g;ee!==null;){o=ee;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,ee=y;else e:for(o=g;ee!==null;){if(l=ee,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:du(9,l)}}catch(b){nt(l,l.return,b)}if(l===o){ee=null;break e}var m=l.sibling;if(m!==null){m.return=l.return,ee=m;break e}ee=l.return}}if(Re=s,ts(),Hn&&typeof Hn.onPostCommitFiberRoot=="function")try{Hn.onPostCommitFiberRoot(ru,e)}catch{}r=!0}return r}finally{Oe=n,vn.transition=t}}return!1}function Up(e,t,n){t=Li(n,t),t=Cy(e,t,1),e=Vr(e,t,1),t=$t(),e!==null&&(Zo(e,1,t),Xt(e,t))}function nt(e,t,n){if(e.tag===3)Up(e,e,n);else for(;t!==null;){if(t.tag===3){Up(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Wr===null||!Wr.has(r))){e=Li(n,e),e=ky(t,e,1),t=Vr(t,e,1),e=$t(),t!==null&&(Zo(t,1,e),Xt(t,e));break}}t=t.return}}function mS(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=$t(),e.pingedLanes|=e.suspendedLanes&n,yt===e&&(Ct&n)===n&&(pt===4||pt===3&&(Ct&130023424)===Ct&&500>lt()-qf?ks(e,0):Gf|=n),Xt(e,t)}function Wy(e,t){t===0&&(e.mode&1?(t=Nl,Nl<<=1,!(Nl&130023424)&&(Nl=4194304)):t=1);var n=$t();e=fr(e,t),e!==null&&(Zo(e,t,n),Xt(e,n))}function gS(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Wy(e,n)}function vS(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(t),Wy(e,n)}var Hy;Hy=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||qt.current)Gt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Gt=!1,sS(e,t,n);Gt=!!(e.flags&131072)}else Gt=!1,Qe&&t.flags&1048576&&qv(t,Ta,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;oa(e,t),e=t.pendingProps;var s=Pi(t,Tt.current);di(t,n),s=Uf(null,t,r,e,s,n);var i=Vf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Yt(r)?(i=!0,Pa(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Of(t),s.updater=cu,t.stateNode=s,s._reactInternals=t,fd(t,r,e,n),t=md(null,t,r,!0,i,n)):(t.tag=0,Qe&&i&&Rf(t),Dt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(oa(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=xS(r),e=Cn(r,e),s){case 0:t=pd(null,t,r,e,n);break e;case 1:t=Ip(null,t,r,e,n);break e;case 11:t=Rp(null,t,r,e,n);break e;case 14:t=Tp(null,t,r,Cn(r.type,e),n);break e}throw Error(H(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Cn(r,s),pd(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Cn(r,s),Ip(e,t,r,s,n);case 3:e:{if(jy(t),e===null)throw Error(H(387));r=t.pendingProps,i=t.memoizedState,s=i.element,ty(e,t),_a(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Li(Error(H(423)),t),t=Lp(e,t,r,n,s);break e}else if(r!==s){s=Li(Error(H(424)),t),t=Lp(e,t,r,n,s);break e}else for(nn=Ur(t.stateNode.containerInfo.firstChild),rn=t,Qe=!0,jn=null,n=Zv(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ri(),r===s){t=hr(e,t,n);break e}Dt(e,t,r,n)}t=t.child}return t;case 5:return ny(t),e===null&&ud(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,sd(r,s)?o=null:i!==null&&sd(r,i)&&(t.flags|=32),My(e,t),Dt(e,t,o,n),t.child;case 6:return e===null&&ud(t),null;case 13:return Py(e,t,n);case 4:return Df(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Ti(t,null,r,n):Dt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Cn(r,s),Rp(e,t,r,s,n);case 7:return Dt(e,t,t.pendingProps,n),t.child;case 8:return Dt(e,t,t.pendingProps.children,n),t.child;case 12:return Dt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,$e(Ia,r._currentValue),r._currentValue=o,i!==null)if(In(i.value,o)){if(i.children===s.children&&!qt.current){t=hr(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=lr(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),cd(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(H(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),cd(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Dt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,di(t,n),s=yn(s),r=r(s),t.flags|=1,Dt(e,t,r,n),t.child;case 14:return r=t.type,s=Cn(r,t.pendingProps),s=Cn(r.type,s),Tp(e,t,r,s,n);case 15:return Ey(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Cn(r,s),oa(e,t),t.tag=1,Yt(r)?(e=!0,Pa(t)):e=!1,di(t,n),by(t,r,s),fd(t,r,s,n),md(null,t,r,!0,e,n);case 19:return Ry(e,t,n);case 22:return Ny(e,t,n)}throw Error(H(156,t.tag))};function Qy(e,t){return xv(e,t)}function yS(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gn(e,t,n,r){return new yS(e,t,n,r)}function Zf(e){return e=e.prototype,!(!e||!e.isReactComponent)}function xS(e){if(typeof e=="function")return Zf(e)?1:0;if(e!=null){if(e=e.$$typeof,e===yf)return 11;if(e===xf)return 14}return 2}function Qr(e,t){var n=e.alternate;return n===null?(n=gn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ua(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")Zf(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Ys:return Es(n.children,s,i,t);case vf:o=8,s|=8;break;case Fc:return e=gn(12,n,t,s|2),e.elementType=Fc,e.lanes=i,e;case Oc:return e=gn(13,n,t,s),e.elementType=Oc,e.lanes=i,e;case Dc:return e=gn(19,n,t,s),e.elementType=Dc,e.lanes=i,e;case nv:return hu(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ev:o=10;break e;case tv:o=9;break e;case yf:o=11;break e;case xf:o=14;break e;case kr:o=16,r=null;break e}throw Error(H(130,e==null?e:typeof e,""))}return t=gn(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function Es(e,t,n,r){return e=gn(7,e,r,t),e.lanes=n,e}function hu(e,t,n,r){return e=gn(22,e,r,t),e.elementType=nv,e.lanes=n,e.stateNode={isHidden:!1},e}function vc(e,t,n){return e=gn(6,e,null,t),e.lanes=n,e}function yc(e,t,n){return t=gn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function wS(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ju(0),this.expirationTimes=Ju(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ju(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function eh(e,t,n,r,s,i,o,l,c){return e=new wS(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=gn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Of(i),e}function SS(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qs,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Ky(e){if(!e)return Jr;e=e._reactInternals;e:{if(_s(e)!==e||e.tag!==1)throw Error(H(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Yt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(H(171))}if(e.tag===1){var n=e.type;if(Yt(n))return Kv(e,n,t)}return t}function Gy(e,t,n,r,s,i,o,l,c){return e=eh(n,r,!0,e,s,i,o,l,c),e.context=Ky(null),n=e.current,r=$t(),s=Hr(n),i=lr(r,s),i.callback=t??null,Vr(n,i,s),e.current.lanes=s,Zo(e,s,r),Xt(e,r),e}function pu(e,t,n,r){var s=t.current,i=$t(),o=Hr(s);return n=Ky(n),t.context===null?t.context=n:t.pendingContext=n,t=lr(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Vr(s,t,o),e!==null&&(Rn(e,s,o,i),ra(e,s,o)),o}function Ua(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Vp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function th(e,t){Vp(e,t),(e=e.alternate)&&Vp(e,t)}function bS(){return null}var qy=typeof reportError=="function"?reportError:function(e){console.error(e)};function nh(e){this._internalRoot=e}mu.prototype.render=nh.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(H(409));pu(e,t,null,null)};mu.prototype.unmount=nh.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Rs(function(){pu(null,e,null,null)}),t[dr]=null}};function mu(e){this._internalRoot=e}mu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Nv();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Nr.length&&t!==0&&t<Nr[n].priority;n++);Nr.splice(n,0,e),n===0&&jv(e)}};function rh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function gu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Wp(){}function CS(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Ua(o);i.call(d)}}var o=Gy(t,r,e,0,null,!1,!1,"",Wp);return e._reactRootContainer=o,e[dr]=o.current,_o(e.nodeType===8?e.parentNode:e),Rs(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=Ua(c);l.call(d)}}var c=eh(e,0,!1,null,null,!1,!1,"",Wp);return e._reactRootContainer=c,e[dr]=c.current,_o(e.nodeType===8?e.parentNode:e),Rs(function(){pu(t,c,n,r)}),c}function vu(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Ua(o);l.call(c)}}pu(t,o,e,s)}else o=CS(n,t,e,s,r);return Ua(o)}kv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=uo(t.pendingLanes);n!==0&&(bf(t,n|1),Xt(t,lt()),!(Re&6)&&(_i=lt()+500,ts()))}break;case 13:Rs(function(){var r=fr(e,1);if(r!==null){var s=$t();Rn(r,e,1,s)}}),th(e,1)}};Cf=function(e){if(e.tag===13){var t=fr(e,134217728);if(t!==null){var n=$t();Rn(t,e,134217728,n)}th(e,134217728)}};Ev=function(e){if(e.tag===13){var t=Hr(e),n=fr(e,t);if(n!==null){var r=$t();Rn(n,e,t,r)}th(e,t)}};Nv=function(){return Oe};Mv=function(e,t){var n=Oe;try{return Oe=e,t()}finally{Oe=n}};Gc=function(e,t,n){switch(t){case"input":if(Bc(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=lu(r);if(!s)throw Error(H(90));sv(r),Bc(r,s)}}}break;case"textarea":ov(e,n);break;case"select":t=n.value,t!=null&&li(e,!!n.multiple,t,!1)}};hv=Yf;pv=Rs;var kS={usingClientEntryPoint:!1,Events:[tl,ei,lu,dv,fv,Yf]},eo={findFiberByHostInstance:ls,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ES={bundleType:eo.bundleType,version:eo.version,rendererPackageName:eo.rendererPackageName,rendererConfig:eo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=vv(e),e===null?null:e.stateNode},findFiberByHostInstance:eo.findFiberByHostInstance||bS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ol=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ol.isDisabled&&Ol.supportsFiber)try{ru=Ol.inject(ES),Hn=Ol}catch{}}ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kS;ln.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!rh(t))throw Error(H(200));return SS(e,t,null,n)};ln.createRoot=function(e,t){if(!rh(e))throw Error(H(299));var n=!1,r="",s=qy;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=eh(e,1,!1,null,null,n,!1,r,s),e[dr]=t.current,_o(e.nodeType===8?e.parentNode:e),new nh(t)};ln.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(H(188)):(e=Object.keys(e).join(","),Error(H(268,e)));return e=vv(t),e=e===null?null:e.stateNode,e};ln.flushSync=function(e){return Rs(e)};ln.hydrate=function(e,t,n){if(!gu(t))throw Error(H(200));return vu(null,e,t,!0,n)};ln.hydrateRoot=function(e,t,n){if(!rh(e))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=qy;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Gy(t,null,e,1,n??null,s,!1,i,o),e[dr]=t.current,_o(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new mu(t)};ln.render=function(e,t,n){if(!gu(t))throw Error(H(200));return vu(null,e,t,!1,n)};ln.unmountComponentAtNode=function(e){if(!gu(e))throw Error(H(40));return e._reactRootContainer?(Rs(function(){vu(null,null,e,!1,function(){e._reactRootContainer=null,e[dr]=null})}),!0):!1};ln.unstable_batchedUpdates=Yf;ln.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!gu(n))throw Error(H(200));if(e==null||e._reactInternals===void 0)throw Error(H(38));return vu(e,t,n,!1,r)};ln.version="18.3.1-next-f1338f8080-20240426";function Yy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Yy)}catch(e){console.error(e)}}Yy(),Yg.exports=ln;var yu=Yg.exports,Xy,Hp=yu;Xy=Hp.createRoot,Hp.hydrateRoot;var $i=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},NS={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},jr,uf,jg,MS=(jg=class{constructor(){ue(this,jr,NS);ue(this,uf,!1)}setTimeoutProvider(e){J(this,jr,e)}setTimeout(e,t){return k(this,jr).setTimeout(e,t)}clearTimeout(e){k(this,jr).clearTimeout(e)}setInterval(e,t){return k(this,jr).setInterval(e,t)}clearInterval(e){k(this,jr).clearInterval(e)}},jr=new WeakMap,uf=new WeakMap,jg),cs=new MS;function jS(e){setTimeout(e,0)}var Ts=typeof window>"u"||"Deno"in globalThis;function zt(){}function PS(e,t){return typeof e=="function"?e(t):e}function Md(e){return typeof e=="number"&&e>=0&&e!==1/0}function Jy(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Kr(e,t){return typeof e=="function"?e(t):e}function fn(e,t){return typeof e=="function"?e(t):e}function Qp(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(r){if(t.queryHash!==sh(o,t.options))return!1}else if(!Vo(t.queryKey,o))return!1}if(n!=="all"){const c=t.isActive();if(n==="active"&&!c||n==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function Kp(e,t){const{exact:n,status:r,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(Is(t.options.mutationKey)!==Is(i))return!1}else if(!Vo(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function sh(e,t){return((t==null?void 0:t.queryKeyHashFn)||Is)(e)}function Is(e){return JSON.stringify(e,(t,n)=>jd(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function Vo(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Vo(e[n],t[n])):!1}var RS=Object.prototype.hasOwnProperty;function Zy(e,t){if(e===t)return e;const n=Gp(e)&&Gp(t);if(!n&&!(jd(e)&&jd(t)))return t;const s=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),o=i.length,l=n?new Array(o):{};let c=0;for(let d=0;d<o;d++){const f=n?d:i[d],p=e[f],h=t[f];if(p===h){l[f]=p,(n?d<s:RS.call(e,f))&&c++;continue}if(p===null||h===null||typeof p!="object"||typeof h!="object"){l[f]=h;continue}const w=Zy(p,h);l[f]=w,w===p&&c++}return s===o&&c===s?e:l}function Va(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function Gp(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function jd(e){if(!qp(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!qp(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function qp(e){return Object.prototype.toString.call(e)==="[object Object]"}function TS(e){return new Promise(t=>{cs.setTimeout(t,e)})}function Pd(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?Zy(e,t):t}function IS(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function LS(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var ih=Symbol();function ex(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===ih?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function tx(e,t){return typeof e=="function"?e(...t):!!e}function _S(e,t,n){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=t()),r||(r=!0,s.aborted?n():s.addEventListener("abort",n,{once:!0})),s)}),e}var ms,Pr,gi,Pg,AS=(Pg=class extends $i{constructor(){super();ue(this,ms);ue(this,Pr);ue(this,gi);J(this,gi,t=>{if(!Ts&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){k(this,Pr)||this.setEventListener(k(this,gi))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,Pr))==null||t.call(this),J(this,Pr,void 0))}setEventListener(t){var n;J(this,gi,t),(n=k(this,Pr))==null||n.call(this),J(this,Pr,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){k(this,ms)!==t&&(J(this,ms,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof k(this,ms)=="boolean"?k(this,ms):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},ms=new WeakMap,Pr=new WeakMap,gi=new WeakMap,Pg),oh=new AS;function Rd(){let e,t;const n=new Promise((s,i)=>{e=s,t=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}var FS=jS;function OS(){let e=[],t=0,n=l=>{l()},r=l=>{l()},s=FS;const i=l=>{t?e.push(l):s(()=>{n(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{r(()=>{l.forEach(c=>{n(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var ht=OS(),vi,Rr,yi,Rg,DS=(Rg=class extends $i{constructor(){super();ue(this,vi,!0);ue(this,Rr);ue(this,yi);J(this,yi,t=>{if(!Ts&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){k(this,Rr)||this.setEventListener(k(this,yi))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,Rr))==null||t.call(this),J(this,Rr,void 0))}setEventListener(t){var n;J(this,yi,t),(n=k(this,Rr))==null||n.call(this),J(this,Rr,t(this.setOnline.bind(this)))}setOnline(t){k(this,vi)!==t&&(J(this,vi,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return k(this,vi)}},vi=new WeakMap,Rr=new WeakMap,yi=new WeakMap,Rg),Wa=new DS;function zS(e){return Math.min(1e3*2**e,3e4)}function nx(e){return(e??"online")==="online"?Wa.isOnline():!0}var Td=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function rx(e){let t=!1,n=0,r;const s=Rd(),i=()=>s.status!=="pending",o=S=>{var C;if(!i()){const v=new Td(S);h(v),(C=e.onCancel)==null||C.call(e,v)}},l=()=>{t=!0},c=()=>{t=!1},d=()=>oh.isFocused()&&(e.networkMode==="always"||Wa.isOnline())&&e.canRun(),f=()=>nx(e.networkMode)&&e.canRun(),p=S=>{i()||(r==null||r(),s.resolve(S))},h=S=>{i()||(r==null||r(),s.reject(S))},w=()=>new Promise(S=>{var C;r=v=>{(i()||d())&&S(v)},(C=e.onPause)==null||C.call(e)}).then(()=>{var S;r=void 0,i()||(S=e.onContinue)==null||S.call(e)}),x=()=>{if(i())return;let S;const C=n===0?e.initialPromise:void 0;try{S=C??e.fn()}catch(v){S=Promise.reject(v)}Promise.resolve(S).then(p).catch(v=>{var E;if(i())return;const g=e.retry??(Ts?0:3),y=e.retryDelay??zS,m=typeof y=="function"?y(n,v):y,b=g===!0||typeof g=="number"&&n<g||typeof g=="function"&&g(n,v);if(t||!b){h(v);return}n++,(E=e.onFail)==null||E.call(e,n,v),TS(m).then(()=>d()?void 0:w()).then(()=>{t?h(v):x()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:l,continueRetry:c,canStart:f,start:()=>(f()?x():w().then(x),s)}}var gs,Tg,sx=(Tg=class{constructor(){ue(this,gs)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Md(this.gcTime)&&J(this,gs,cs.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Ts?1/0:5*60*1e3))}clearGcTimeout(){k(this,gs)&&(cs.clearTimeout(k(this,gs)),J(this,gs,void 0))}},gs=new WeakMap,Tg),vs,xi,dn,ys,gt,Ko,xs,En,Jn,Ig,$S=(Ig=class extends sx{constructor(t){super();ue(this,En);ue(this,vs);ue(this,xi);ue(this,dn);ue(this,ys);ue(this,gt);ue(this,Ko);ue(this,xs);J(this,xs,!1),J(this,Ko,t.defaultOptions),this.setOptions(t.options),this.observers=[],J(this,ys,t.client),J(this,dn,k(this,ys).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,J(this,vs,Xp(this.options)),this.state=t.state??k(this,vs),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=k(this,gt))==null?void 0:t.promise}setOptions(t){if(this.options={...k(this,Ko),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Xp(this.options);n.data!==void 0&&(this.setState(Yp(n.data,n.dataUpdatedAt)),J(this,vs,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&k(this,dn).remove(this)}setData(t,n){const r=Pd(this.state.data,t,this.options);return xe(this,En,Jn).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){xe(this,En,Jn).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=k(this,gt))==null?void 0:r.promise;return(s=k(this,gt))==null||s.cancel(t),n?n.then(zt).catch(zt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(k(this,vs))}isActive(){return this.observers.some(t=>fn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ih||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Kr(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Jy(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,gt))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,gt))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),k(this,dn).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(k(this,gt)&&(k(this,xs)?k(this,gt).cancel({revert:!0}):k(this,gt).cancelRetry()),this.scheduleGc()),k(this,dn).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||xe(this,En,Jn).call(this,{type:"invalidate"})}async fetch(t,n){var c,d,f,p,h,w,x,S,C,v,g,y;if(this.state.fetchStatus!=="idle"&&((c=k(this,gt))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(k(this,gt))return k(this,gt).continueRetry(),k(this,gt).promise}if(t&&this.setOptions(t),!this.options.queryFn){const m=this.observers.find(b=>b.options.queryFn);m&&this.setOptions(m.options)}const r=new AbortController,s=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(J(this,xs,!0),r.signal)})},i=()=>{const m=ex(this.options,n),E=(()=>{const j={client:k(this,ys),queryKey:this.queryKey,meta:this.meta};return s(j),j})();return J(this,xs,!1),this.options.persister?this.options.persister(m,E,this):m(E)},l=(()=>{const m={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:k(this,ys),state:this.state,fetchFn:i};return s(m),m})();(d=this.options.behavior)==null||d.onFetch(l,this),J(this,xi,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&xe(this,En,Jn).call(this,{type:"fetch",meta:(p=l.fetchOptions)==null?void 0:p.meta}),J(this,gt,rx({initialPromise:n==null?void 0:n.initialPromise,fn:l.fetchFn,onCancel:m=>{m instanceof Td&&m.revert&&this.setState({...k(this,xi),fetchStatus:"idle"}),r.abort()},onFail:(m,b)=>{xe(this,En,Jn).call(this,{type:"failed",failureCount:m,error:b})},onPause:()=>{xe(this,En,Jn).call(this,{type:"pause"})},onContinue:()=>{xe(this,En,Jn).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const m=await k(this,gt).start();if(m===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(m),(w=(h=k(this,dn).config).onSuccess)==null||w.call(h,m,this),(S=(x=k(this,dn).config).onSettled)==null||S.call(x,m,this.state.error,this),m}catch(m){if(m instanceof Td){if(m.silent)return k(this,gt).promise;if(m.revert){if(this.state.data===void 0)throw m;return this.state.data}}throw xe(this,En,Jn).call(this,{type:"error",error:m}),(v=(C=k(this,dn).config).onError)==null||v.call(C,m,this),(y=(g=k(this,dn).config).onSettled)==null||y.call(g,this.state.data,m,this),m}finally{this.scheduleGc()}}},vs=new WeakMap,xi=new WeakMap,dn=new WeakMap,ys=new WeakMap,gt=new WeakMap,Ko=new WeakMap,xs=new WeakMap,En=new WeakSet,Jn=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...ix(r.data,this.options),fetchMeta:t.meta??null};case"success":const s={...r,...Yp(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return J(this,xi,t.manual?s:void 0),s;case"error":const i=t.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),ht.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),k(this,dn).notify({query:this,type:"updated",action:t})})},Ig);function ix(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:nx(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Yp(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Xp(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Ht,Me,Go,Ft,ws,wi,tr,Tr,qo,Si,bi,Ss,bs,Ir,Ci,Fe,fo,Id,Ld,_d,Ad,Fd,Od,Dd,ox,Lg,BS=(Lg=class extends $i{constructor(t,n){super();ue(this,Fe);ue(this,Ht);ue(this,Me);ue(this,Go);ue(this,Ft);ue(this,ws);ue(this,wi);ue(this,tr);ue(this,Tr);ue(this,qo);ue(this,Si);ue(this,bi);ue(this,Ss);ue(this,bs);ue(this,Ir);ue(this,Ci,new Set);this.options=n,J(this,Ht,t),J(this,Tr,null),J(this,tr,Rd()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(k(this,Me).addObserver(this),Jp(k(this,Me),this.options)?xe(this,Fe,fo).call(this):this.updateResult(),xe(this,Fe,Ad).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return zd(k(this,Me),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return zd(k(this,Me),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,xe(this,Fe,Fd).call(this),xe(this,Fe,Od).call(this),k(this,Me).removeObserver(this)}setOptions(t){const n=this.options,r=k(this,Me);if(this.options=k(this,Ht).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof fn(this.options.enabled,k(this,Me))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");xe(this,Fe,Dd).call(this),k(this,Me).setOptions(this.options),n._defaulted&&!Va(this.options,n)&&k(this,Ht).getQueryCache().notify({type:"observerOptionsUpdated",query:k(this,Me),observer:this});const s=this.hasListeners();s&&Zp(k(this,Me),r,this.options,n)&&xe(this,Fe,fo).call(this),this.updateResult(),s&&(k(this,Me)!==r||fn(this.options.enabled,k(this,Me))!==fn(n.enabled,k(this,Me))||Kr(this.options.staleTime,k(this,Me))!==Kr(n.staleTime,k(this,Me)))&&xe(this,Fe,Id).call(this);const i=xe(this,Fe,Ld).call(this);s&&(k(this,Me)!==r||fn(this.options.enabled,k(this,Me))!==fn(n.enabled,k(this,Me))||i!==k(this,Ir))&&xe(this,Fe,_d).call(this,i)}getOptimisticResult(t){const n=k(this,Ht).getQueryCache().build(k(this,Ht),t),r=this.createResult(n,t);return VS(this,r)&&(J(this,Ft,r),J(this,wi,this.options),J(this,ws,k(this,Me).state)),r}getCurrentResult(){return k(this,Ft)}trackResult(t,n){return new Proxy(t,{get:(r,s)=>(this.trackProp(s),n==null||n(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&k(this,tr).status==="pending"&&k(this,tr).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(t){k(this,Ci).add(t)}getCurrentQuery(){return k(this,Me)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=k(this,Ht).defaultQueryOptions(t),r=k(this,Ht).getQueryCache().build(k(this,Ht),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return xe(this,Fe,fo).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),k(this,Ft)))}createResult(t,n){var L;const r=k(this,Me),s=this.options,i=k(this,Ft),o=k(this,ws),l=k(this,wi),d=t!==r?t.state:k(this,Go),{state:f}=t;let p={...f},h=!1,w;if(n._optimisticResults){const R=this.hasListeners(),B=!R&&Jp(t,n),F=R&&Zp(t,r,n,s);(B||F)&&(p={...p,...ix(f.data,t.options)}),n._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:x,errorUpdatedAt:S,status:C}=p;w=p.data;let v=!1;if(n.placeholderData!==void 0&&w===void 0&&C==="pending"){let R;i!=null&&i.isPlaceholderData&&n.placeholderData===(l==null?void 0:l.placeholderData)?(R=i.data,v=!0):R=typeof n.placeholderData=="function"?n.placeholderData((L=k(this,bi))==null?void 0:L.state.data,k(this,bi)):n.placeholderData,R!==void 0&&(C="success",w=Pd(i==null?void 0:i.data,R,n),h=!0)}if(n.select&&w!==void 0&&!v)if(i&&w===(o==null?void 0:o.data)&&n.select===k(this,qo))w=k(this,Si);else try{J(this,qo,n.select),w=n.select(w),w=Pd(i==null?void 0:i.data,w,n),J(this,Si,w),J(this,Tr,null)}catch(R){J(this,Tr,R)}k(this,Tr)&&(x=k(this,Tr),w=k(this,Si),S=Date.now(),C="error");const g=p.fetchStatus==="fetching",y=C==="pending",m=C==="error",b=y&&g,E=w!==void 0,M={status:C,fetchStatus:p.fetchStatus,isPending:y,isSuccess:C==="success",isError:m,isInitialLoading:b,isLoading:b,data:w,dataUpdatedAt:p.dataUpdatedAt,error:x,errorUpdatedAt:S,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:g,isRefetching:g&&!y,isLoadingError:m&&!E,isPaused:p.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:m&&E,isStale:lh(t,n),refetch:this.refetch,promise:k(this,tr),isEnabled:fn(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const R=G=>{M.status==="error"?G.reject(M.error):M.data!==void 0&&G.resolve(M.data)},B=()=>{const G=J(this,tr,M.promise=Rd());R(G)},F=k(this,tr);switch(F.status){case"pending":t.queryHash===r.queryHash&&R(F);break;case"fulfilled":(M.status==="error"||M.data!==F.value)&&B();break;case"rejected":(M.status!=="error"||M.error!==F.reason)&&B();break}}return M}updateResult(){const t=k(this,Ft),n=this.createResult(k(this,Me),this.options);if(J(this,ws,k(this,Me).state),J(this,wi,this.options),k(this,ws).data!==void 0&&J(this,bi,k(this,Me)),Va(n,t))return;J(this,Ft,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!k(this,Ci).size)return!0;const o=new Set(i??k(this,Ci));return this.options.throwOnError&&o.add("error"),Object.keys(k(this,Ft)).some(l=>{const c=l;return k(this,Ft)[c]!==t[c]&&o.has(c)})};xe(this,Fe,ox).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&xe(this,Fe,Ad).call(this)}},Ht=new WeakMap,Me=new WeakMap,Go=new WeakMap,Ft=new WeakMap,ws=new WeakMap,wi=new WeakMap,tr=new WeakMap,Tr=new WeakMap,qo=new WeakMap,Si=new WeakMap,bi=new WeakMap,Ss=new WeakMap,bs=new WeakMap,Ir=new WeakMap,Ci=new WeakMap,Fe=new WeakSet,fo=function(t){xe(this,Fe,Dd).call(this);let n=k(this,Me).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(zt)),n},Id=function(){xe(this,Fe,Fd).call(this);const t=Kr(this.options.staleTime,k(this,Me));if(Ts||k(this,Ft).isStale||!Md(t))return;const r=Jy(k(this,Ft).dataUpdatedAt,t)+1;J(this,Ss,cs.setTimeout(()=>{k(this,Ft).isStale||this.updateResult()},r))},Ld=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(k(this,Me)):this.options.refetchInterval)??!1},_d=function(t){xe(this,Fe,Od).call(this),J(this,Ir,t),!(Ts||fn(this.options.enabled,k(this,Me))===!1||!Md(k(this,Ir))||k(this,Ir)===0)&&J(this,bs,cs.setInterval(()=>{(this.options.refetchIntervalInBackground||oh.isFocused())&&xe(this,Fe,fo).call(this)},k(this,Ir)))},Ad=function(){xe(this,Fe,Id).call(this),xe(this,Fe,_d).call(this,xe(this,Fe,Ld).call(this))},Fd=function(){k(this,Ss)&&(cs.clearTimeout(k(this,Ss)),J(this,Ss,void 0))},Od=function(){k(this,bs)&&(cs.clearInterval(k(this,bs)),J(this,bs,void 0))},Dd=function(){const t=k(this,Ht).getQueryCache().build(k(this,Ht),this.options);if(t===k(this,Me))return;const n=k(this,Me);J(this,Me,t),J(this,Go,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},ox=function(t){ht.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(k(this,Ft))}),k(this,Ht).getQueryCache().notify({query:k(this,Me),type:"observerResultsUpdated"})})},Lg);function US(e,t){return fn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Jp(e,t){return US(e,t)||e.state.data!==void 0&&zd(e,t,t.refetchOnMount)}function zd(e,t,n){if(fn(t.enabled,e)!==!1&&Kr(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&lh(e,t)}return!1}function Zp(e,t,n,r){return(e!==t||fn(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&lh(e,n)}function lh(e,t){return fn(t.enabled,e)!==!1&&e.isStaleByTime(Kr(t.staleTime,e))}function VS(e,t){return!Va(e.getCurrentResult(),t)}function em(e){return{onFetch:(t,n)=>{var f,p,h,w,x;const r=t.options,s=(h=(p=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:p.fetchMore)==null?void 0:h.direction,i=((w=t.state.data)==null?void 0:w.pages)||[],o=((x=t.state.data)==null?void 0:x.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let S=!1;const C=y=>{_S(y,()=>t.signal,()=>S=!0)},v=ex(t.options,t.fetchOptions),g=async(y,m,b)=>{if(S)return Promise.reject();if(m==null&&y.pages.length)return Promise.resolve(y);const j=(()=>{const B={client:t.client,queryKey:t.queryKey,pageParam:m,direction:b?"backward":"forward",meta:t.options.meta};return C(B),B})(),M=await v(j),{maxPages:L}=t.options,R=b?LS:IS;return{pages:R(y.pages,M,L),pageParams:R(y.pageParams,m,L)}};if(s&&i.length){const y=s==="backward",m=y?WS:tm,b={pages:i,pageParams:o},E=m(r,b);l=await g(b,E,y)}else{const y=e??i.length;do{const m=c===0?o[0]??r.initialPageParam:tm(r,l);if(c>0&&m==null)break;l=await g(l,m),c++}while(c<y)}return l};t.options.persister?t.fetchFn=()=>{var S,C;return(C=(S=t.options).persister)==null?void 0:C.call(S,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=d}}}function tm(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function WS(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var Yo,Bn,Ot,Cs,Un,Cr,_g,HS=(_g=class extends sx{constructor(t){super();ue(this,Un);ue(this,Yo);ue(this,Bn);ue(this,Ot);ue(this,Cs);J(this,Yo,t.client),this.mutationId=t.mutationId,J(this,Ot,t.mutationCache),J(this,Bn,[]),this.state=t.state||lx(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){k(this,Bn).includes(t)||(k(this,Bn).push(t),this.clearGcTimeout(),k(this,Ot).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){J(this,Bn,k(this,Bn).filter(n=>n!==t)),this.scheduleGc(),k(this,Ot).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){k(this,Bn).length||(this.state.status==="pending"?this.scheduleGc():k(this,Ot).remove(this))}continue(){var t;return((t=k(this,Cs))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,c,d,f,p,h,w,x,S,C,v,g,y,m,b,E,j,M,L;const n=()=>{xe(this,Un,Cr).call(this,{type:"continue"})},r={client:k(this,Yo),meta:this.options.meta,mutationKey:this.options.mutationKey};J(this,Cs,rx({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(R,B)=>{xe(this,Un,Cr).call(this,{type:"failed",failureCount:R,error:B})},onPause:()=>{xe(this,Un,Cr).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>k(this,Ot).canRun(this)}));const s=this.state.status==="pending",i=!k(this,Cs).canStart();try{if(s)n();else{xe(this,Un,Cr).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(o=k(this,Ot).config).onMutate)==null?void 0:l.call(o,t,this,r));const B=await((d=(c=this.options).onMutate)==null?void 0:d.call(c,t,r));B!==this.state.context&&xe(this,Un,Cr).call(this,{type:"pending",context:B,variables:t,isPaused:i})}const R=await k(this,Cs).start();return await((p=(f=k(this,Ot).config).onSuccess)==null?void 0:p.call(f,R,t,this.state.context,this,r)),await((w=(h=this.options).onSuccess)==null?void 0:w.call(h,R,t,this.state.context,r)),await((S=(x=k(this,Ot).config).onSettled)==null?void 0:S.call(x,R,null,this.state.variables,this.state.context,this,r)),await((v=(C=this.options).onSettled)==null?void 0:v.call(C,R,null,t,this.state.context,r)),xe(this,Un,Cr).call(this,{type:"success",data:R}),R}catch(R){try{await((y=(g=k(this,Ot).config).onError)==null?void 0:y.call(g,R,t,this.state.context,this,r))}catch(B){Promise.reject(B)}try{await((b=(m=this.options).onError)==null?void 0:b.call(m,R,t,this.state.context,r))}catch(B){Promise.reject(B)}try{await((j=(E=k(this,Ot).config).onSettled)==null?void 0:j.call(E,void 0,R,this.state.variables,this.state.context,this,r))}catch(B){Promise.reject(B)}try{await((L=(M=this.options).onSettled)==null?void 0:L.call(M,void 0,R,t,this.state.context,r))}catch(B){Promise.reject(B)}throw xe(this,Un,Cr).call(this,{type:"error",error:R}),R}finally{k(this,Ot).runNext(this)}}},Yo=new WeakMap,Bn=new WeakMap,Ot=new WeakMap,Cs=new WeakMap,Un=new WeakSet,Cr=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),ht.batch(()=>{k(this,Bn).forEach(r=>{r.onMutationUpdate(t)}),k(this,Ot).notify({mutation:this,type:"updated",action:t})})},_g);function lx(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var nr,Nn,Xo,Ag,QS=(Ag=class extends $i{constructor(t={}){super();ue(this,nr);ue(this,Nn);ue(this,Xo);this.config=t,J(this,nr,new Set),J(this,Nn,new Map),J(this,Xo,0)}build(t,n,r){const s=new HS({client:t,mutationCache:this,mutationId:++wl(this,Xo)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){k(this,nr).add(t);const n=Dl(t);if(typeof n=="string"){const r=k(this,Nn).get(n);r?r.push(t):k(this,Nn).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(k(this,nr).delete(t)){const n=Dl(t);if(typeof n=="string"){const r=k(this,Nn).get(n);if(r)if(r.length>1){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}else r[0]===t&&k(this,Nn).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Dl(t);if(typeof n=="string"){const r=k(this,Nn).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var r;const n=Dl(t);if(typeof n=="string"){const s=(r=k(this,Nn).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){ht.batch(()=>{k(this,nr).forEach(t=>{this.notify({type:"removed",mutation:t})}),k(this,nr).clear(),k(this,Nn).clear()})}getAll(){return Array.from(k(this,nr))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Kp(n,r))}findAll(t={}){return this.getAll().filter(n=>Kp(t,n))}notify(t){ht.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return ht.batch(()=>Promise.all(t.map(n=>n.continue().catch(zt))))}},nr=new WeakMap,Nn=new WeakMap,Xo=new WeakMap,Ag);function Dl(e){var t;return(t=e.options.scope)==null?void 0:t.id}var rr,Lr,Qt,sr,ur,ca,$d,Fg,KS=(Fg=class extends $i{constructor(n,r){super();ue(this,ur);ue(this,rr);ue(this,Lr);ue(this,Qt);ue(this,sr);J(this,rr,n),this.setOptions(r),this.bindMethods(),xe(this,ur,ca).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var s;const r=this.options;this.options=k(this,rr).defaultMutationOptions(n),Va(this.options,r)||k(this,rr).getMutationCache().notify({type:"observerOptionsUpdated",mutation:k(this,Qt),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Is(r.mutationKey)!==Is(this.options.mutationKey)?this.reset():((s=k(this,Qt))==null?void 0:s.state.status)==="pending"&&k(this,Qt).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=k(this,Qt))==null||n.removeObserver(this)}onMutationUpdate(n){xe(this,ur,ca).call(this),xe(this,ur,$d).call(this,n)}getCurrentResult(){return k(this,Lr)}reset(){var n;(n=k(this,Qt))==null||n.removeObserver(this),J(this,Qt,void 0),xe(this,ur,ca).call(this),xe(this,ur,$d).call(this)}mutate(n,r){var s;return J(this,sr,r),(s=k(this,Qt))==null||s.removeObserver(this),J(this,Qt,k(this,rr).getMutationCache().build(k(this,rr),this.options)),k(this,Qt).addObserver(this),k(this,Qt).execute(n)}},rr=new WeakMap,Lr=new WeakMap,Qt=new WeakMap,sr=new WeakMap,ur=new WeakSet,ca=function(){var r;const n=((r=k(this,Qt))==null?void 0:r.state)??lx();J(this,Lr,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},$d=function(n){ht.batch(()=>{var r,s,i,o,l,c,d,f;if(k(this,sr)&&this.hasListeners()){const p=k(this,Lr).variables,h=k(this,Lr).context,w={client:k(this,rr),meta:this.options.meta,mutationKey:this.options.mutationKey};if((n==null?void 0:n.type)==="success"){try{(s=(r=k(this,sr)).onSuccess)==null||s.call(r,n.data,p,h,w)}catch(x){Promise.reject(x)}try{(o=(i=k(this,sr)).onSettled)==null||o.call(i,n.data,null,p,h,w)}catch(x){Promise.reject(x)}}else if((n==null?void 0:n.type)==="error"){try{(c=(l=k(this,sr)).onError)==null||c.call(l,n.error,p,h,w)}catch(x){Promise.reject(x)}try{(f=(d=k(this,sr)).onSettled)==null||f.call(d,void 0,n.error,p,h,w)}catch(x){Promise.reject(x)}}}this.listeners.forEach(p=>{p(k(this,Lr))})})},Fg),Vn,Og,GS=(Og=class extends $i{constructor(t={}){super();ue(this,Vn);this.config=t,J(this,Vn,new Map)}build(t,n,r){const s=n.queryKey,i=n.queryHash??sh(s,n);let o=this.get(i);return o||(o=new $S({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){k(this,Vn).has(t.queryHash)||(k(this,Vn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=k(this,Vn).get(t.queryHash);n&&(t.destroy(),n===t&&k(this,Vn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ht.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return k(this,Vn).get(t)}getAll(){return[...k(this,Vn).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Qp(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>Qp(t,r)):n}notify(t){ht.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){ht.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ht.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Vn=new WeakMap,Og),tt,_r,Ar,ki,Ei,Fr,Ni,Mi,Dg,qS=(Dg=class{constructor(e={}){ue(this,tt);ue(this,_r);ue(this,Ar);ue(this,ki);ue(this,Ei);ue(this,Fr);ue(this,Ni);ue(this,Mi);J(this,tt,e.queryCache||new GS),J(this,_r,e.mutationCache||new QS),J(this,Ar,e.defaultOptions||{}),J(this,ki,new Map),J(this,Ei,new Map),J(this,Fr,0)}mount(){wl(this,Fr)._++,k(this,Fr)===1&&(J(this,Ni,oh.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,tt).onFocus())})),J(this,Mi,Wa.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,tt).onOnline())})))}unmount(){var e,t;wl(this,Fr)._--,k(this,Fr)===0&&((e=k(this,Ni))==null||e.call(this),J(this,Ni,void 0),(t=k(this,Mi))==null||t.call(this),J(this,Mi,void 0))}isFetching(e){return k(this,tt).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return k(this,_r).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,tt).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=k(this,tt).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Kr(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return k(this,tt).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=k(this,tt).get(r.queryHash),i=s==null?void 0:s.state.data,o=PS(t,i);if(o!==void 0)return k(this,tt).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return ht.batch(()=>k(this,tt).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,tt).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=k(this,tt);ht.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=k(this,tt);return ht.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=ht.batch(()=>k(this,tt).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(zt).catch(zt)}invalidateQueries(e,t={}){return ht.batch(()=>(k(this,tt).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=ht.batch(()=>k(this,tt).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(zt)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(zt)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=k(this,tt).build(this,t);return n.isStaleByTime(Kr(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(zt).catch(zt)}fetchInfiniteQuery(e){return e.behavior=em(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(zt).catch(zt)}ensureInfiniteQueryData(e){return e.behavior=em(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Wa.isOnline()?k(this,_r).resumePausedMutations():Promise.resolve()}getQueryCache(){return k(this,tt)}getMutationCache(){return k(this,_r)}getDefaultOptions(){return k(this,Ar)}setDefaultOptions(e){J(this,Ar,e)}setQueryDefaults(e,t){k(this,ki).set(Is(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...k(this,ki).values()],n={};return t.forEach(r=>{Vo(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){k(this,Ei).set(Is(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...k(this,Ei).values()],n={};return t.forEach(r=>{Vo(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...k(this,Ar).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=sh(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===ih&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...k(this,Ar).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){k(this,tt).clear(),k(this,_r).clear()}},tt=new WeakMap,_r=new WeakMap,Ar=new WeakMap,ki=new WeakMap,Ei=new WeakMap,Fr=new WeakMap,Ni=new WeakMap,Mi=new WeakMap,Dg),ax=u.createContext(void 0),mr=e=>{const t=u.useContext(ax);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},YS=({client:e,children:t})=>(u.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(ax.Provider,{value:e,children:t})),ux=u.createContext(!1),XS=()=>u.useContext(ux);ux.Provider;function JS(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var ZS=u.createContext(JS()),eb=()=>u.useContext(ZS),tb=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},nb=e=>{u.useEffect(()=>{e.clearReset()},[e])},rb=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||tx(n,[e.error,r])),sb=e=>{if(e.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},ib=(e,t)=>e.isLoading&&e.isFetching&&!t,ob=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,nm=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function lb(e,t,n){var p,h,w,x,S;const r=XS(),s=eb(),i=mr(),o=i.defaultQueryOptions(e);(h=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||h.call(p,o),o._optimisticResults=r?"isRestoring":"optimistic",sb(o),tb(o,s),nb(s);const l=!i.getQueryCache().get(o.queryHash),[c]=u.useState(()=>new t(i,o)),d=c.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(u.useSyncExternalStore(u.useCallback(C=>{const v=f?c.subscribe(ht.batchCalls(C)):zt;return c.updateResult(),v},[c,f]),()=>c.getCurrentResult(),()=>c.getCurrentResult()),u.useEffect(()=>{c.setOptions(o)},[o,c]),ob(o,d))throw nm(o,c,s);if(rb({result:d,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((x=(w=i.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||x.call(w,o,d),o.experimental_prefetchInRender&&!Ts&&ib(d,r)){const C=l?nm(o,c,s):(S=i.getQueryCache().get(o.queryHash))==null?void 0:S.promise;C==null||C.catch(zt).finally(()=>{c.updateResult()})}return o.notifyOnChangeProps?d:c.trackResult(d)}function xu(e,t){return lb(e,BS)}function ab(e,t){const n=mr(),[r]=u.useState(()=>new KS(n,e));u.useEffect(()=>{r.setOptions(e)},[r,e]);const s=u.useSyncExternalStore(u.useCallback(o=>r.subscribe(ht.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=u.useCallback((o,l)=>{r.mutate(o,l).catch(zt)},[r]);if(s.error&&tx(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}const cx=8,ub=6;function rm(e,t,n){return n<t?t:Math.min(n,Math.max(t,e))}function dx({x:e,y:t,menuWidth:n,menuHeight:r,viewport:s,margin:i=cx}){const o=i,l=i,c=s.width-Math.max(0,n)-i,d=s.height-Math.max(0,r)-i;return{x:rm(e,o,c),y:rm(t,l,d)}}function cb({anchorRect:e,menuSize:t,viewport:n,align:r="left",margin:s=cx,sideOffset:i=ub}){const o=r==="right"?e.right-t.width:e.left,l=e.bottom+i,c=e.top-t.height-i,d=l+t.height+s<=n.height,f=c>=s;return dx({x:o,y:!d&&f?c:l,menuWidth:t.width,menuHeight:t.height,viewport:n,margin:s})}function fx(){return typeof window>"u"?{width:1024,height:768}:{width:window.innerWidth,height:window.innerHeight}}function sm(e){return e.length>0&&"options"in e[0]}function im(){return{x:0,y:0,ready:!1}}function ah({value:e,onChange:t,options:n,placeholder:r="Select...",trigger:s,triggerClassName:i="",panelClassName:o="",align:l="left",width:c="auto",showChevron:d=!0,title:f,disabled:p=!1,"aria-label":h}){var G,Z;const[w,x]=u.useState(!1),S=u.useRef(null),C=u.useRef(null),v=u.useRef(null),[g,y]=u.useState(im),b=u.useCallback(()=>{const $=I=>{const T=I.find(P=>P.value===e);return T?T.label:null};if(sm(n))for(const I of n){const T=$(I.options);if(T)return T}else{const I=$(n);if(I)return I}return r},[e,n,r])(),E=((G=S.current)==null?void 0:G.getBoundingClientRect().width)??((Z=C.current)==null?void 0:Z.offsetWidth)??0,j=c==="trigger"?E:c==="auto"?void 0:c,M=u.useCallback(()=>{if(!w)return;const $=S.current,I=v.current;if(!$||!I)return;const T=$.getBoundingClientRect(),P=I.getBoundingClientRect(),_=j??P.width??180,O=P.height||I.scrollHeight||1,q=cb({anchorRect:T,menuSize:{width:_,height:O},viewport:fx(),align:l});y(U=>U.x===q.x&&U.y===q.y&&U.ready?U:{x:q.x,y:q.y,ready:!0})},[l,j,w]);u.useLayoutEffect(()=>{if(!w){y(im());return}M()},[w,M,n,e]),u.useEffect(()=>{if(!w)return;const $=P=>{var O,q;const _=P.target;(O=S.current)!=null&&O.contains(_)||(q=v.current)!=null&&q.contains(_)||x(!1)},I=P=>{var _;P.key==="Escape"&&(x(!1),(_=C.current)==null||_.focus())},T=()=>M();return window.addEventListener("click",$),window.addEventListener("keydown",I),window.addEventListener("resize",T),window.addEventListener("scroll",T,!0),()=>{window.removeEventListener("click",$),window.removeEventListener("keydown",I),window.removeEventListener("resize",T),window.removeEventListener("scroll",T,!0)}},[w,M]);const L=$=>{var I;t($),x(!1),(I=C.current)==null||I.focus()},R=$=>$.map(I=>a.jsxs("button",{className:"dropdown-item","data-active":I.value===e,disabled:I.disabled,onClick:()=>!I.disabled&&L(I.value),role:"menuitem",children:[I.icon&&a.jsx("span",{className:"shrink-0",children:I.icon}),a.jsx("span",{className:"flex-1 truncate",children:I.label}),I.value===e&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0 text-accent",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})]},I.value)),B=u.useMemo(()=>({position:"fixed",left:g.x,top:g.y,visibility:g.ready?"visible":"hidden",...j?{width:j,minWidth:j}:{}}),[j,g]),F=w?a.jsx("div",{ref:v,className:`dropdown-panel ${o}`,style:B,role:"listbox","aria-label":h,children:sm(n)?n.map(($,I)=>a.jsxs("div",{children:[$.label&&a.jsx("div",{className:"dropdown-label",children:$.label}),R($.options),I<n.length-1&&a.jsx("div",{className:"dropdown-divider"})]},$.label||I)):R(n)}):null;return a.jsxs("div",{ref:S,className:"relative",children:[s?a.jsx("div",{onClick:()=>!p&&x($=>!$),children:s}):a.jsxs("button",{ref:C,type:"button",className:`dropdown-trigger ${i}`,onClick:()=>x($=>!$),disabled:p,title:f,"aria-label":h,"aria-haspopup":"listbox","aria-expanded":w,children:[a.jsx("span",{className:"truncate",children:b}),d&&a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`shrink-0 opacity-60 transition-transform ${w?"rotate-180":""}`,children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),F&&typeof document<"u"?yu.createPortal(F,document.body):F]})}const db={offline:"sync-dot-offline",unstable:"sync-dot-unstable",recent:"sync-dot-recent",editing:"sync-dot-editing",live:"sync-dot-live"};function fb({state:e,presence:t,syncLabel:n,connectionLabel:r,lastEditedLabel:s,hasEdits:i,localTypingActive:o,recentTouches:l,isNarrow:c}){const[d,f]=u.useState(!1),[p,h]=u.useState(null),w=u.useRef(null),x=u.useRef(null),S=u.useRef(null),C=t?`${t.viewing} viewing  ${t.editing} editing`:"- viewing  - editing",v=t?String(t.viewing):"-",g=u.useCallback(()=>{S.current&&(window.clearTimeout(S.current),S.current=null)},[]),y=u.useCallback((b,E)=>{var j;E&&((j=navigator.clipboard)==null||j.writeText(E).then(()=>{h(b),g(),S.current=window.setTimeout(()=>{h(M=>M===b?null:M)},1e3)}).catch(()=>{}))},[g]),m=u.useCallback(()=>{f(!1),window.requestAnimationFrame(()=>{var b;return(b=x.current)==null?void 0:b.focus()})},[]);return u.useEffect(()=>{if(!d)return;const b=j=>{!w.current||w.current.contains(j.target)||m()},E=j=>{j.key==="Escape"&&m()};return window.addEventListener("mousedown",b),window.addEventListener("keydown",E),()=>{window.removeEventListener("mousedown",b),window.removeEventListener("keydown",E)}},[d,m]),u.useEffect(()=>()=>{g()},[g]),a.jsxs("div",{ref:w,className:"sync-indicator",children:[a.jsxs("button",{ref:x,type:"button",className:"sync-indicator-button",onClick:()=>d?m():f(!0),"aria-haspopup":"dialog","aria-expanded":d,"aria-label":"Sync status",title:C,children:[a.jsx("span",{className:`sync-indicator-dot ${db[e]}`,"aria-hidden":"true"}),!c&&a.jsx("span",{className:"sync-indicator-count tabular-nums",children:v}),!c&&o&&a.jsx("span",{className:"sync-indicator-local",children:"typing"})]}),d&&a.jsxs("div",{role:"dialog","aria-label":"Sync status",className:"sync-indicator-card select-text",children:[a.jsx("div",{className:"sync-indicator-line sync-indicator-primary",children:n}),a.jsx("div",{className:"sync-indicator-line",children:r}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:C}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:i?`Last edited: ${s}`:"No edits yet."}),o&&a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:"Local typing in progress (saved on blur)."}),a.jsxs("div",{className:"sync-indicator-section",children:[a.jsx("div",{className:"sync-indicator-section-title",children:"Recently touched files"}),l.length>0?a.jsx("div",{className:"sync-indicator-list",children:l.map(b=>a.jsxs("div",{className:"sync-indicator-item",children:[a.jsx("button",{type:"button",className:"sync-indicator-item-name",title:`Copy filename: ${b.label}`,onClick:()=>y(b.path,b.label),children:b.label}),a.jsx("span",{className:"sync-indicator-item-time tabular-nums",children:p===b.path?"Copied":b.timeLabel})]},b.path))}):a.jsx("div",{className:"sync-indicator-empty",children:"No recent touches."})]})]})]})}const Gr={phoneMax:480,mobileMax:767,narrowMax:900,tabletMax:1024,mediumMax:1180},da={phone:`(max-width: ${Gr.phoneMax}px)`,narrow:`(max-width: ${Gr.narrowMax}px)`,toolbarCompact:`(max-width: ${Gr.mediumMax}px)`},om=200,lm=240,hb=320,pb=360,mb=420;function am(e,t,n){return Math.min(Math.max(e,t),n)}function gb(e){return e<=Gr.tabletMax?hb:e<=Gr.mediumMax?pb:mb}function vb(e){return e<=Gr.tabletMax?360:e<=Gr.mediumMax?420:520}function yb({viewportWidth:e,leftOpen:t,rightOpen:n,leftWidth:r,rightWidth:s}){const i=gb(e);let o=t?am(r,om,i):0,l=n?am(s,lm,i):0;const c=Math.max(0,e-vb(e));if(o+l>c){let d=o+l-c;if(l>0){const f=Math.max(0,l-lm),p=Math.min(f,d);l-=p,d-=p}if(d>0&&o>0){const f=Math.max(0,o-om),p=Math.min(f,d);o-=p,d-=p}d>0&&l>0&&(l=Math.max(0,c-o)),o+l>c&&(o=Math.max(0,c-l))}return{leftWidth:Number(o.toFixed(2)),rightWidth:Number(l.toFixed(2))}}function fa(e,t=!1){const[n,r]=u.useState(t);return u.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;const s=window.matchMedia(e),i=s,o=()=>r(s.matches);if(o(),typeof s.addEventListener=="function")return s.addEventListener("change",o),()=>s.removeEventListener("change",o);if(typeof i.addListener=="function"&&typeof i.removeListener=="function")return i.addListener(o),()=>{var l;return(l=i.removeListener)==null?void 0:l.call(i,o)}},[e]),n}function hx({isRandom:e,dir:t}){return e?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),a.jsx("path",{d:"M21 3v5h-5"})]}):t==="desc"?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 5v14"}),a.jsx("path",{d:"M19 12l-7 7-7-7"})]}):a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 19V5"}),a.jsx("path",{d:"M5 12l7-7 7 7"})]})}function xb({viewerActive:e,filtersOpen:t,filtersRef:n,totalFilterCount:r,filterCount:s,starFilterList:i,starCounts:o,onToggleFilters:l,onOpenFilters:c,onToggleStar:d,onClearFilters:f,onClearStars:p}){return a.jsxs("div",{ref:n,className:`toolbar-filter relative ${e?"opacity-40 pointer-events-none":""}`,children:[a.jsxs("button",{className:`btn ${r>0?"btn-active":""}`,onClick:l,"aria-haspopup":"dialog","aria-expanded":t,title:"Filters","aria-disabled":e,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),a.jsx("span",{className:"toolbar-filters-label",children:"Filters"}),r>0&&a.jsx("span",{className:"toolbar-filters-count px-1.5 py-0.5 text-[11px] rounded-full bg-accent-strong text-text",children:r})]}),t&&a.jsxs("div",{role:"dialog","aria-label":"Filters",className:"dropdown-panel w-[240px]",style:{top:"38px",left:0},children:[a.jsx("div",{className:"dropdown-label",children:"Rating"}),a.jsxs("div",{className:"px-1",children:[[5,4,3,2,1].map(h=>{const w=i.includes(h),x=(o==null?void 0:o[String(h)])??0;return a.jsxs("button",{onClick:()=>d==null?void 0:d(h),className:`dropdown-item justify-between ${w?"bg-accent-muted":""}`,children:[a.jsxs("span",{className:w?"text-star-active":"text-text",children:["".repeat(h),"".repeat(5-h)]}),a.jsx("span",{className:"text-xs text-muted",children:x})]},h)}),a.jsxs("button",{onClick:()=>d==null?void 0:d(0),className:`dropdown-item justify-between ${i.includes(0)?"bg-accent-muted":""}`,children:[a.jsx("span",{className:"text-text",children:"Unrated"}),a.jsx("span",{className:"text-xs text-muted",children:(o==null?void 0:o["0"])??0})]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("div",{className:"dropdown-label",children:"Metrics"}),a.jsxs("button",{className:"dropdown-item",onClick:()=>{l(),c==null||c()},children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]}),a.jsx("span",{children:"Open Metrics Panel"}),(s||0)>0&&a.jsxs("span",{className:"ml-auto text-xs text-muted",children:[s," active"]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("button",{className:"dropdown-item text-muted hover:text-text",onClick:()=>{f?f():p==null||p()},disabled:r===0,children:"Clear all filters"})]})]})}function wb({viewMode:e,currentSort:t,sortOnlyOptions:n,sortDisabled:r,sortControlsDisabled:s,sortDir:i,isRandom:o,showSelectModeToggle:l,multiSelectMode:c,selectModeLabel:d,uploadBusy:f,uploadDisabled:p,onViewMode:h,onSortChange:w,onToggleSortDir:x,onToggleMultiSelectMode:S,onUploadClick:C}){return a.jsx("div",{className:"mobile-drawer",children:a.jsxs("div",{className:"mobile-drawer-row",children:[a.jsxs("div",{className:"mobile-pill-group",children:[a.jsx("button",{className:`mobile-pill ${e==="grid"?"is-active":""}`,onClick:()=>h==null?void 0:h("grid"),"aria-pressed":e==="grid",children:"Grid"}),a.jsx("button",{className:`mobile-pill ${e==="adaptive"?"is-active":""}`,onClick:()=>h==null?void 0:h("adaptive"),"aria-pressed":e==="adaptive",children:"Masonry"})]}),a.jsx(ah,{value:t,onChange:v=>w==null?void 0:w(v),options:n,"aria-label":"Sort",triggerClassName:"mobile-pill mobile-pill-dropdown",panelClassName:"mobile-drawer-panel",disabled:r}),a.jsx("button",{className:`mobile-pill mobile-pill-icon ${s?"opacity-50 cursor-not-allowed":""}`,onClick:x,title:r?"Sorting disabled":o?"Shuffle":`Sort ${i==="desc"?"descending":"ascending"}`,"aria-label":o?"Shuffle":"Toggle sort direction","aria-disabled":s,disabled:s,children:a.jsx(hx,{isRandom:o,dir:i})}),l&&a.jsx("button",{className:`mobile-pill ${c?"is-active":""}`,onClick:()=>S==null?void 0:S(),"aria-pressed":c,title:c?"Exit select mode":"Enter select mode",children:d}),C&&a.jsx("button",{className:`mobile-pill ${p||f?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!p&&!f&&C(),disabled:p||f,children:f?"Uploading":"Upload"})]})})}function Sb({rootRef:e,onSearch:t,viewerActive:n,onBack:r,zoomPercent:s,onZoomPercentChange:i,currentLabel:o,itemCount:l,totalCount:c,sortSpec:d,metricKeys:f,onSortChange:p,sortDisabled:h=!1,filterCount:w,onOpenFilters:x,starFilters:S,onToggleStar:C,onClearStars:v,onClearFilters:g,starCounts:y,viewMode:m,onViewMode:b,gridItemSize:E,onGridItemSize:j,leftOpen:M,rightOpen:L,onToggleLeft:R,onToggleRight:B,onPrevImage:F,onNextImage:G,canPrevImage:Z,canNextImage:$,searchDisabled:I=!1,searchPlaceholder:T,onUploadClick:P,uploadBusy:_=!1,uploadDisabled:O=!1,multiSelectMode:q=!1,selectedCount:U=0,onToggleMultiSelectMode:A,syncIndicator:K}){const[X,te]=u.useState(!1),[oe,W]=u.useState(!1),Q=u.useRef(null),de=u.useRef(null),V=fa(da.narrow),Se=fa(da.phone),ce=fa(da.toolbarCompact);u.useEffect(()=>{if(!X)return;const ke=st=>{Q.current&&!Q.current.contains(st.target)&&te(!1)};return window.addEventListener("click",ke),()=>window.removeEventListener("click",ke)},[X]),u.useEffect(()=>{if(I){W(!1);return}if(!V||n){W(!1);return}if(!oe)return;const ke=window.requestAnimationFrame(()=>{var st;return(st=de.current)==null?void 0:st.focus()});return()=>window.cancelAnimationFrame(ke)},[V,oe,n,I]);const me=d??{kind:"builtin",key:"added",dir:"desc"},Be=me.dir,We=me.kind==="builtin"&&me.key==="random",ut=n||h,Ln=f!=null&&f.length?f.map(ke=>({value:`metric:${ke}`,label:ke,disabled:h})):[],It=[{value:"builtin:added",label:"Date added",disabled:h},{value:"builtin:name",label:"Filename",disabled:h},{value:"builtin:random",label:"Random",disabled:h},...Ln],_n=[{label:"Layout",options:[{value:"layout:grid",label:"Grid"},{value:"layout:masonry",label:"Masonry"}]},{label:"Sort by",options:It}],Jt=me.kind==="metric"?`metric:${me.key}`:`builtin:${me.key}`,re=[{label:"Sort by",options:It}],se=V&&!n,Ie=!(!!n&&ce),we=!!n&&!Se,pe=se&&!!A,Ze=q?U>0?`Done (${U})`:"Done":"Select",rt=ke=>{if(ke.startsWith("layout:")){const st=ke==="layout:masonry"?"adaptive":"grid";b==null||b(st)}else{if(h)return;p==null||p(um(ke,me))}},xt=()=>{!p||h||p(We?me:{...me,dir:Be==="desc"?"asc":"desc"})},et=S??[],Zt=et.length,gr=Cb(w,Zt),wn=bb(l,c),An=o||"Root";return a.jsxs("div",{ref:e,className:`toolbar-shell ${n?"toolbar-shell-viewer":""} ${Se?"toolbar-shell-phone":""} ${ce?"toolbar-shell-compact":""} fixed top-0 left-0 right-0 h-12 grid grid-cols-[minmax(0,1fr)_minmax(0,1fr)_auto] items-center px-3 gap-3 bg-panel border-b border-border z-[var(--z-toolbar)] col-span-full row-start-1 select-none`,children:[a.jsxs("div",{className:"toolbar-left flex items-center gap-4 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope flex items-center gap-3 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope-text flex flex-col min-w-0 leading-tight",children:[a.jsx("span",{className:"toolbar-scope-label text-[10px] uppercase tracking-widest text-muted",children:"Scope"}),a.jsx("span",{className:"text-sm font-medium text-text truncate",title:An,children:An})]}),wn&&a.jsx("span",{className:"toolbar-count text-xs text-muted whitespace-nowrap tabular-nums",children:wn})]}),n&&a.jsxs("button",{className:"toolbar-back-btn btn btn-sm",onClick:r,title:"Back to grid",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]}),Ie&&a.jsxs("div",{className:"toolbar-sort flex items-center gap-2",children:[a.jsxs("div",{className:`toolbar-sort-controls flex items-center gap-2 ${n?"opacity-40 pointer-events-none":""}`,children:[a.jsx(ah,{value:Jt,onChange:rt,options:_n,title:"Sort and layout options","aria-label":"Sort and layout",triggerClassName:"min-w-[110px]"}),a.jsx("button",{className:"toolbar-sort-dir btn btn-icon",onClick:xt,title:h?"Sorting disabled":We?"Shuffle":`Sort ${Be==="desc"?"descending":"ascending"}`,"aria-label":We?"Shuffle":"Toggle sort direction","aria-disabled":ut,disabled:ut,children:a.jsx(hx,{isRandom:We,dir:Be})})]}),a.jsx(xb,{viewerActive:!!n,filtersOpen:X,filtersRef:Q,totalFilterCount:gr,filterCount:w,starFilterList:et,starCounts:y,onToggleFilters:()=>te(ke=>!ke),onOpenFilters:x,onToggleStar:C,onClearFilters:g,onClearStars:v})]})]}),a.jsx("div",{className:"toolbar-center flex items-center gap-3 justify-center min-w-0",children:n?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"range",min:5,max:800,step:1,value:Math.round(Math.max(5,Math.min(800,s??100))),onChange:ke=>i==null?void 0:i(Number(ke.target.value)),className:"zoom-slider","aria-label":"Zoom level"}),a.jsxs("span",{className:"text-xs text-muted min-w-[42px] text-right",children:[Math.round(s??100),"%"]})]}):j&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-muted",children:"Size"}),a.jsx("input",{type:"range",min:80,max:500,step:10,value:E??220,onChange:ke=>j(Number(ke.target.value)),className:"w-28 h-1.5 bg-border rounded-full appearance-none cursor-pointer hover:bg-hover transition-colors [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-text [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-text [&::-moz-range-thumb]:border-0","aria-label":"Thumbnail size"})]})}),a.jsxs("div",{className:"toolbar-right flex items-center gap-2 justify-end",children:[we&&a.jsxs("div",{className:"toolbar-nav flex items-center gap-1 mr-1",children:[a.jsx("button",{className:`btn btn-icon ${Z?"":"opacity-40 cursor-not-allowed"}`,title:"Previous image (A / )",onClick:()=>Z&&(F==null?void 0:F()),"aria-label":"Previous image","aria-disabled":!Z,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("button",{className:`btn btn-icon ${$?"":"opacity-40 cursor-not-allowed"}`,title:"Next image (D / )",onClick:()=>$&&(G==null?void 0:G()),"aria-label":"Next image","aria-disabled":!$,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 6l6 6-6 6"})})})]}),a.jsxs("div",{className:"toolbar-panels flex items-center gap-1",children:[a.jsx("button",{className:`btn btn-icon ${M?"":"opacity-50"}`,title:M?"Hide left panel (Ctrl+B)":"Show left panel (Ctrl+B)",onClick:R,"aria-pressed":M,"aria-label":"Toggle left panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"11",y:"5",width:"10",height:"14",rx:"1.5"})]})}),a.jsx("button",{className:`btn btn-icon ${L?"":"opacity-50"}`,title:L?"Hide right panel (Ctrl+Alt+B)":"Show right panel (Ctrl+Alt+B)",onClick:B,"aria-pressed":L,"aria-label":"Toggle right panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"15",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"3",y:"5",width:"10",height:"14",rx:"1.5"})]})})]}),!n&&P&&a.jsxs("button",{className:`btn ${O?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!O&&P(),"aria-label":"Upload images",title:_?"Uploading":"Upload images","aria-disabled":O||_,disabled:O||_,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M12 16V5"}),a.jsx("path",{d:"M7 10l5-5 5 5"}),a.jsx("path",{d:"M4 19h16"})]}),a.jsx("span",{children:_?"Uploading":"Upload"})]}),K&&a.jsx(fb,{...K,isNarrow:V||ce}),!n&&V&&a.jsx("button",{className:`btn btn-icon ${oe?"btn-active":""} ${I?"opacity-50 cursor-not-allowed":""}`,"aria-label":oe?"Close search":"Open search",title:I?"Search disabled":oe?"Close search":"Search",onClick:()=>!I&&W(ke=>!ke),disabled:I,children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"11",cy:"11",r:"7"}),a.jsx("path",{d:"M21 21l-4.35-4.35"})]})}),!n&&!V?a.jsx("div",{className:"toolbar-search toolbar-search-desktop w-[240px]",children:a.jsx("input",{ref:de,"aria-label":"Search filename, tags, notes",placeholder:I?T??"Search disabled":"Search...",onChange:ke=>t(ke.target.value),className:"toolbar-search-input input w-full focus:w-full transition-all duration-200 select-text",disabled:I})}):null]}),!n&&V&&oe&&!I&&a.jsx("div",{className:"toolbar-search-row",children:a.jsx("input",{ref:de,"aria-label":"Search filename, tags, notes",placeholder:T??"Search...",onChange:ke=>t(ke.target.value),className:"toolbar-search-input-mobile input input-lg w-full select-text"})}),se&&a.jsx(wb,{viewMode:m,currentSort:Jt,sortOnlyOptions:re,sortDisabled:h,sortControlsDisabled:ut,sortDir:Be,isRandom:We,showSelectModeToggle:pe,multiSelectMode:q,selectModeLabel:Ze,uploadBusy:_,uploadDisabled:O,onViewMode:b,onSortChange:ke=>p==null?void 0:p(um(ke,me)),onToggleSortDir:xt,onToggleMultiSelectMode:A,onUploadClick:P})]})}function bb(e,t){if(typeof e!="number")return null;const n=e.toLocaleString();if(typeof t!="number")return`${n} items`;const r=t.toLocaleString();return t===e?`${n} items`:`${n} / ${r} items`}function Cb(e,t){return typeof e=="number"?e:t>0?1:0}function um(e,t){if(e.startsWith("metric:")){const n=e.slice(7);return n?{kind:"metric",key:n,dir:t.dir}:t}if(e.startsWith("builtin:")){const n=e.slice(8);if(n==="name"||n==="added"||n==="random")return{kind:"builtin",key:n,dir:t.dir}}return t}class sn extends Error{constructor(n,r,s,i){super(r);dt(this,"status");dt(this,"url");dt(this,"body");this.name="FetchError",this.status=n,this.url=s,this.body=i}}function kb(e){const t=e.trim();return t.startsWith("{")||t.startsWith("[")}function px(e,t,n){if(t&&typeof t=="object"){const r=t,s=typeof r.error=="string"?r.error:null,i=typeof r.message=="string"?r.message:null;if(s&&i)return`${s}: ${i}`;if(s)return s;if(i)return i}return typeof t=="string"&&t?t:`HTTP ${e} for ${n}`}function St(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{let c=null;const d=await l.text().catch(()=>"");if(d)if((l.headers.get("content-type")||"").includes("application/json")||kb(d))try{c=JSON.parse(d)}catch{c=d}else c=d;if(!l.ok)throw new sn(l.status,px(l.status,c,e),e,c);return c}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}function to(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{if(!l.ok){const c=await l.text().catch(()=>""),d=c||null;throw new sn(l.status,px(l.status,d,e),e,d)}return l.blob()}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}class mx{constructor(t){dt(this,"store",new Map);dt(this,"inflight",new Map);dt(this,"totalBytes",0);this.maxBytes=t}getMaxBytes(){return this.maxBytes}getTotalBytes(){return this.totalBytes}getSize(){return this.store.size}has(t){return this.store.has(t)}isInflight(t){return this.inflight.has(t)}get(t){const n=this.store.get(t);if(n)return this.store.delete(t),this.store.set(t,n),n.blob}evictIfNeeded(t){for(;this.totalBytes+t>this.maxBytes&&this.store.size>0;){const n=this.store.keys().next().value;if(n==null)break;const r=this.store.get(n);r&&(this.totalBytes-=r.size),this.store.delete(n)}}set(t,n){const r=n.size||0;if(!(r>this.maxBytes)){if(this.store.has(t)){const s=this.store.get(t);this.totalBytes-=s.size,this.store.delete(t)}this.evictIfNeeded(r),this.store.set(t,{blob:n,size:r}),this.totalBytes+=r}}async getOrFetch(t,n){const r=this.get(t);if(r)return r;const s=this.inflight.get(t);if(s)return s.promise;const i=n(),o=typeof i=="object"&&"promise"in i,l=o?i.promise:i,c=o?i.abort:void 0,d=l.then(f=>(this.set(t,f),f)).finally(()=>{this.inflight.delete(t)});return this.inflight.set(t,{promise:d,abort:c}),d}prefetch(t,n){if(this.store.has(t)||this.inflight.has(t))return;const r=n(),s=typeof r=="object"&&"promise"in r,i=s?r.promise:r,o=s?r.abort:void 0,l=i.then(c=>(this.set(t,c),c)).catch(()=>new Blob).finally(()=>{this.inflight.delete(t)});this.inflight.set(t,{promise:l,abort:o})}cancelPrefetch(t){const n=this.inflight.get(t);if(n!=null&&n.abort)try{n.abort()}catch{}this.inflight.delete(t)}clear(){for(const[t,n]of this.inflight)if(n.abort)try{n.abort()}catch{}this.inflight.clear(),this.store.clear(),this.totalBytes=0}evictPrefix(t){const n=(()=>{const s=t?`/${t.replace(/^\/+/,"")}`:"/";return s==="/"?"/":s.replace(/\/+$/,"")})(),r=s=>{const i=s.startsWith("/")?s.replace(/\/+$/,""):`/${s.replace(/\/+$/,"")}`;return n==="/"?!0:i===n||i.startsWith(`${n}/`)};for(const[s,i]of Array.from(this.store.entries()))r(s)&&(this.totalBytes-=i.size,this.store.delete(s));for(const[s,i]of Array.from(this.inflight.entries()))if(r(s)){if(i.abort)try{i.abort()}catch{}this.inflight.delete(s)}this.totalBytes<0&&(this.totalBytes=0)}}const Gs=new mx(60*1024*1024),Bd=new mx(20*1024*1024),qr={hydrationStart:e=>`lenslet:browse:hydration:start:${e}`,hydrationComplete:e=>`lenslet:browse:hydration:complete:${e}`,firstGrid:e=>`lenslet:browse:first-grid:${e}`,firstGridLatency:e=>`lenslet:browse:first-grid-latency:${e}`,firstThumb:e=>`lenslet:browse:first-thumb:${e}`,firstThumbLatency:e=>`lenslet:browse:first-thumb-latency:${e}`},Te={activeRequestId:null,activeHydrationStartedAtMs:null,firstGridItemLatencyMs:null,firstGridItemPath:null,firstThumbnailLatencyMs:null,firstThumbnailPath:null,requestBudget:null,hydration:null};function Ai(){return typeof performance<"u"&&typeof performance.now=="function"?performance.now():Date.now()}function wu(e){if(!(typeof performance>"u"||typeof performance.mark!="function"))try{performance.mark(e)}catch{}}function gx(e,t,n){if(!(typeof performance>"u"||typeof performance.measure!="function"))try{performance.measure(e,t,n)}catch{}}function As(){typeof window>"u"||(window.__lensletBrowseHotpath=vx())}function vx(){return{firstGridItemLatencyMs:Te.firstGridItemLatencyMs,firstGridItemPath:Te.firstGridItemPath,firstThumbnailLatencyMs:Te.firstThumbnailLatencyMs,firstThumbnailPath:Te.firstThumbnailPath,requestBudget:Te.requestBudget?{...Te.requestBudget}:null,hydration:Te.hydration?{...Te.hydration}:null}}function Eb(e){Te.requestBudget={...e},As()}function Nb(e){Te.activeRequestId=e.requestId,Te.activeHydrationStartedAtMs=Ai(),Te.firstGridItemLatencyMs=null,Te.firstGridItemPath=null,Te.firstThumbnailLatencyMs=null,Te.firstThumbnailPath=null,Te.hydration={...e,completed:!1,updatedAtMs:Ai()},wu(qr.hydrationStart(e.requestId)),As()}function Mb(e){Te.activeRequestId===e.requestId&&(Te.hydration={...e,completed:!1,updatedAtMs:Ai()},As())}function jb(e){Te.activeRequestId===e&&(Te.hydration&&(Te.hydration={...Te.hydration,completed:!0,updatedAtMs:Ai()}),wu(qr.hydrationComplete(e)),As())}function Pb(e){const t=Te.activeRequestId,n=Te.activeHydrationStartedAtMs;if(t==null||n==null||Te.firstGridItemLatencyMs!=null)return;const r=Math.max(0,Ai()-n);Te.firstGridItemLatencyMs=Math.round(r),Te.firstGridItemPath=e;const s=qr.firstGrid(t);wu(s),gx(qr.firstGridLatency(t),qr.hydrationStart(t),s),As()}function cm(e){const t=Te.activeRequestId,n=Te.activeHydrationStartedAtMs;if(t==null||n==null||Te.firstThumbnailLatencyMs!=null)return;const r=Math.max(0,Ai()-n);Te.firstThumbnailLatencyMs=Math.round(r),Te.firstThumbnailPath=e;const s=qr.firstThumb(t);wu(s),gx(qr.firstThumbLatency(t),qr.hydrationStart(t),s),As()}As();const Rb=["folders","thumb","file"],xc={folders:2,thumb:8,file:3};let dm=1;const At={folders:{limit:xc.folders,inflight:new Map,queued:[],peakInflight:0},thumb:{limit:xc.thumb,inflight:new Map,queued:[],peakInflight:0},file:{limit:xc.file,inflight:new Map,queued:[],peakInflight:0}};function Ha(){if(typeof DOMException<"u")return new DOMException("request aborted","AbortError");const e=new Error("request aborted");return e.name="AbortError",e}function Tb(){return{limits:{folders:At.folders.limit,thumb:At.thumb.limit,file:At.file.limit},inflight:{folders:At.folders.inflight.size,thumb:At.thumb.inflight.size,file:At.file.inflight.size},queued:{folders:At.folders.queued.length,thumb:At.thumb.queued.length,file:At.file.queued.length},peakInflight:{folders:At.folders.peakInflight,thumb:At.thumb.peakInflight,file:At.file.peakInflight},updatedAtMs:Date.now()}}function os(){Eb(Tb())}function fm(e){const t=At[e];for(;t.inflight.size<t.limit&&t.queued.length>0;){const n=t.queued.shift();if(!n)break;n.start()}}function no(e,t){const n=At[e],r=dm;dm+=1;let s=!1,i=!1,o=null;return{promise:new Promise((d,f)=>{const p=()=>{i&&(i=!1,n.inflight.delete(r),fm(e),os())},h=()=>{if(s||i)return;i=!0;let w;try{w=t()}catch(x){s=!0,p(),f(x);return}o={id:r,abort:w.abort,reject:f},n.inflight.set(r,o),n.peakInflight=Math.max(n.peakInflight,n.inflight.size),os(),w.promise.then(x=>{s||(s=!0,p(),d(x))},x=>{s||(s=!0,p(),f(x))})};if(n.inflight.size<n.limit){h();return}n.queued.push({id:r,start:h,reject:f}),os()}),abort:()=>{if(s)return;if(s=!0,i){if(n.inflight.delete(r),o!=null&&o.abort)try{o.abort()}catch{}o==null||o.reject(Ha()),fm(e),os();return}const d=n.queued.findIndex(f=>f.id===r);if(d>=0){const[f]=n.queued.splice(d,1);f.reject(Ha()),os()}}}}function Ib(e=Rb){for(const t of e){const n=At[t];for(const s of Array.from(n.inflight.values())){if(s.abort)try{s.abort()}catch{}s.reject(Ha())}n.inflight.clear();const r=n.queued.splice(0,n.queued.length);for(const s of r)s.reject(Ha())}os()}os();const wc={};function Lb(){const e=wc==null?void 0:wc.VITE_API_BASE,t=typeof window<"u",n=t?window.location.origin:"http://localhost",r=t?window.location.hostname:"localhost",s=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\]|.+\.localhost)$/i.test(r);if(!e)return"";let i;try{i=new URL(e,n)}catch{return""}const o=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\])$/i.test(i.hostname);return s?i.origin:o?"":i.origin}const qe=Lb();const _b=40*1024*1024;function Ab(e){return e==="viewer"||e==="compare"}function hm(e){return`${qe}/thumb?path=${encodeURIComponent(e)}`}function pm(e){return`${qe}/file?path=${encodeURIComponent(e)}`}const Sc="lenslet.client_id",mm="lenslet.client_id.session",yx="lenslet.last_event_id",Fb=1e3,Ob=3e4,Db=5;let Ud=null,ha=null,gm=0,hi=null,pi=0,Su=!0,Qa=!1;function xx(){return typeof window<"u"&&typeof EventSource<"u"}function vm(e,t){if(!e)return null;try{return e.getItem(t)}catch{return null}}function ym(e,t,n){if(e)try{e.setItem(t,n)}catch{}}function zb(e,t){if(e)try{e.removeItem(t)}catch{}}function $b(){if(typeof navigator>"u")return"server";const e=navigator.userAgent||"",t=navigator.language||"",n=navigator.platform||"",r=typeof Intl<"u"&&Intl.DateTimeFormat().resolvedOptions().timeZone||"",s=typeof screen<"u"?`${screen.width}x${screen.height}x${screen.colorDepth}`:"";return[e,t,n,r,s].join("|")}function Bb(e){let t=2166136261;for(let n=0;n<e.length;n+=1)t^=e.charCodeAt(n),t=t*16777619>>>0;return t.toString(16).padStart(8,"0")}function xm(){return typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`client_${Math.random().toString(36).slice(2,10)}_${Date.now()}`}function ro(e){return Ud=e,e}function Ka(e){if(typeof window>"u")return null;try{return e==="local"?window.localStorage:window.sessionStorage}catch{return null}}function Fi(){if(Ud)return Ud;const e=Ka("local"),t=Ka("session"),n=vm(t,mm);if(n)return ro(n);const r=vm(e,Sc);if(t){const i=xm();return ym(t,mm,i),r&&zb(e,Sc),ro(i)}if(r)return ro(r);if(e){const i=xm();return ym(e,Sc,i),ro(i)}const s=`fp_${Bb($b())}_${Math.random().toString(36).slice(2,8)}`;return ro(s)}function bu(e="lenslet"){gm+=1;const t=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`nonce_${Math.random().toString(36).slice(2,10)}_${Date.now()}_${gm}`;return`${e}:${Fi()}:${t}`}function Ub(){if(ha!=null)return ha;if(typeof window>"u")return null;const e=Ka("local");if(!e)return null;try{const t=e.getItem(yx);if(!t)return null;const n=Number(t);return!Number.isFinite(n)||n<=0?null:(ha=n,n)}catch{return null}}function Vb(e){if(!Number.isFinite(e)||e<=0||(ha=e,typeof window>"u"))return;const t=Ka("local");if(t)try{t.setItem(yx,String(e))}catch{}}function Wb(){if(typeof window>"u")return`${qe}/events`;const e=new URL(`${qe}/events`,window.location.origin),t=Ub();return t!=null&&Number.isFinite(t)&&e.searchParams.set("last_event_id",String(t)),e.toString()}function Hb(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}let kn=null,wx="idle";const Vd=new Set,Wd=new Set,Hd=new Set;function mi(e){wx=e;for(const t of Wd)t(e)}function uh(e){if(Qa!==e){Qa=e;for(const t of Hd)t(e)}}function ch(){hi!=null&&(window.clearTimeout(hi),hi=null)}function Qb(){pi=0,ch()}function Kb(){if(!Su||hi!=null)return;pi+=1;const e=Math.min(Fb*Math.pow(2,pi-1),Ob);pi>=Db?(mi("offline"),uh(!0)):mi("reconnecting"),hi=window.setTimeout(()=>{hi=null,Sx()},e)}function Sx(){if(!Su||!xx()||(kn&&kn.readyState===EventSource.CLOSED&&(kn.close(),kn=null),kn))return;pi>0?mi("reconnecting"):mi("connecting");const e=new EventSource(Wb());kn=e;const t=n=>r=>{const s=Hb(r.data);if(!s)return;const i=r.lastEventId?Number(r.lastEventId):null,o=i!=null&&Number.isFinite(i)?i:null;o!=null&&Vb(o);for(const l of Vd)l({type:n,id:o,data:s})};e.addEventListener("item-updated",t("item-updated")),e.addEventListener("metrics-updated",t("metrics-updated")),e.addEventListener("presence",t("presence")),e.onopen=()=>{Qb(),uh(!1),mi("live")},e.onerror=()=>{kn===e&&(e.close(),kn=null,Kb())}}function Gb(){Su=!0,xx()&&(ch(),Sx())}function qb(){Su=!1,ch(),pi=0,kn&&(kn.close(),kn=null),uh(!1),mi("offline")}function Yb(e){return Vd.add(e),()=>{Vd.delete(e)}}function Xb(e){return Wd.add(e),e(wx),()=>{Wd.delete(e)}}function Jb(e){return Hd.add(e),e(Qa),()=>{Hd.delete(e)}}function Zb(){return Qa}function wm(e){Ib(e)}function eC(e,t){const n=JSON.stringify(t),r=`${qe}${e}`;if(typeof navigator<"u"&&typeof navigator.sendBeacon=="function")try{if(navigator.sendBeacon(r,new Blob([n],{type:"application/json"})))return!0}catch{}if(typeof fetch!="function")return!1;try{return fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0}),!0}catch{return!1}}function tC(e,t,n){return eC("/presence/leave",{gallery_id:e,lease_id:t,client_id:n??Fi()})}function zl(e){return e??Fi()}function $l(e,t){return St(`${qe}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).promise}function nC(e,t){const n=new URLSearchParams({path:e});return(t==null?void 0:t.page)!=null&&n.set("page",String(t.page)),(t==null?void 0:t.pageSize)!=null&&n.set("page_size",String(t.pageSize)),t!=null&&t.recursive&&n.set("recursive","1"),n.toString()}const ge={getFolder:(e,t)=>no("folders",()=>St(`${qe}/folders?${nC(e,t)}`)).promise,search:(e,t)=>{const n=new URLSearchParams;return e&&n.set("q",e),t&&n.set("path",t),St(`${qe}/search?${n}`).promise},getEmbeddings:()=>St(`${qe}/embeddings`).promise,searchEmbeddings:e=>St(`${qe}/embeddings/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,refreshFolder:e=>{const t=new URLSearchParams({path:e});return St(`${qe}/refresh?${t}`,{method:"POST"}).promise},getSidecar:e=>St(`${qe}/item?path=${encodeURIComponent(e)}`).promise,patchSidecar:(e,t,n)=>{const s={"Content-Type":"application/json","Idempotency-Key":(n==null?void 0:n.idempotencyKey)??bu("patch"),"x-client-id":Fi(),"x-updated-by":"web"};return(n==null?void 0:n.ifMatch)!=null&&(s["If-Match"]=String(n.ifMatch)),St(`${qe}/item?path=${encodeURIComponent(e)}`,{method:"PATCH",headers:s,body:JSON.stringify(t)}).promise},getMetadata:e=>St(`${qe}/metadata?path=${encodeURIComponent(e)}`).promise,putSidecar:(e,t)=>St(`${qe}/item?path=${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json","x-client-id":Fi(),"x-updated-by":"web"},body:JSON.stringify(t)}).promise,getHealth:()=>St(`${qe}/health`).promise,joinPresence:(e,t,n)=>$l("/presence/join",{gallery_id:e,client_id:zl(n),lease_id:t}),movePresence:(e,t,n,r)=>$l("/presence/move",{from_gallery_id:e,to_gallery_id:t,client_id:zl(r),lease_id:n}),leavePresence:(e,t,n)=>$l("/presence/leave",{gallery_id:e,client_id:zl(n),lease_id:t}),postPresence:(e,t,n)=>$l("/presence",{gallery_id:e,client_id:zl(n),lease_id:t}),getThumb:e=>Bd.getOrFetch(e,()=>no("thumb",()=>to(hm(e)))),prefetchThumb:e=>{Bd.prefetch(e,()=>no("thumb",()=>to(hm(e))))},getFile:e=>Gs.getOrFetch(e,()=>no("file",()=>to(pm(e)))),exportComparison:e=>to(`${qe}/export-comparison`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,prefetchFile:async(e,t)=>{if(Ab(t)&&!(Gs.has(e)||Gs.isInflight(e)))try{const n=await no("file",()=>to(pm(e),{headers:{"x-lenslet-prefetch":t}})).promise;n.size<=_b&&Gs.set(e,n)}catch{}},cancelPrefetch:e=>{Gs.cancelPrefetch(e)},uploadFile:async(e,t)=>{const n=new FormData;return n.append("dest",e),n.append("file",t),St(`${qe}/file`,{method:"POST",body:n,timeoutMs:6e4}).promise},moveFile:async(e,t)=>{const n=new FormData;return n.append("src",e),n.append("dest",t),St(`${qe}/move`,{method:"POST",body:n}).promise},deleteFiles:async e=>St(`${qe}/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paths:e})}).promise,exportIntent:async e=>{const t=new FormData;return t.append("path",e),St(`${qe}/export-intent`,{method:"POST",body:t}).promise},getViews:()=>St(`${qe}/views`).promise,saveViews:e=>St(`${qe}/views`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise};class rC{constructor(t=400){dt(this,"cache",new Map);dt(this,"maxSize");this.maxSize=t,typeof window<"u"&&window.addEventListener("beforeunload",()=>this.clear(),{once:!0})}get(t){const n=this.cache.get(t);return n&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){for(this.cache.has(t)&&this.cache.delete(t);this.cache.size>=this.maxSize;){const r=this.cache.keys().next().value;if(r===void 0)break;const s=this.cache.get(r);if(this.cache.delete(r),s)try{URL.revokeObjectURL(s)}catch{}}this.cache.set(t,n)}clear(){for(const t of this.cache.values())try{URL.revokeObjectURL(t)}catch{}this.cache.clear()}}const bc=new rC(400);function sC({path:e,name:t,onClick:n,selected:r,highlighted:s,highlightKey:i,displayW:o,displayH:l,ioRoot:c,isScrolling:d,priority:f}){const p=u.useRef(null),[h,w]=u.useState(()=>bc.get(e)??null),[x,S]=u.useState(!1),[C,v]=u.useState(()=>!!h);u.useEffect(()=>{const y=p.current;if(!y)return;const m=new IntersectionObserver(b=>{for(const E of b)E.target===y&&S(E.isIntersecting||E.intersectionRatio>0)},{root:c??null,rootMargin:"200px 0px",threshold:.01});return m.observe(y),()=>{m.unobserve(y),m.disconnect()}},[c]),u.useEffect(()=>{if(h||!(x&&!d||f))return;let y=!0;return ge.getThumb(e).then(m=>{if(!y)return;const b=URL.createObjectURL(m);bc.set(e,b),w(b)}).catch(()=>{}),()=>{y=!1}},[e,h,x,d,f]),u.useEffect(()=>{var m;if(!h){v(!1);return}const y=(m=p.current)==null?void 0:m.querySelector("img");y&&y.complete&&y.naturalWidth>0?(v(!0),cm(e)):v(!1)},[h]),u.useEffect(()=>{w(bc.get(e)??null)},[e]);const g=["absolute inset-0 relative bg-hover border border-border rounded-lg overflow-hidden select-none",r?"outline-2 outline-accent":"",s?"thumb-updated-ring":"","hover:outline hover:outline-1 hover:outline-accent"].filter(Boolean).join(" ");return a.jsx("div",{ref:p,"data-highlight-key":i??void 0,className:g,onClick:n,children:h?a.jsx("img",{className:`w-full h-full object-cover block pointer-events-none select-none opacity-0 transition-opacity duration-[160ms] ${C?"opacity-100":""}`,src:h,alt:t,loading:"lazy",decoding:"async",onLoad:()=>{v(!0),cm(e)},width:o?Math.round(o):void 0,height:l?Math.round(l):void 0}):null})}function Hs(e,t,n){let r=n.initialDeps??[],s,i=!0;function o(){var l,c,d;let f;n.key&&((l=n.debug)!=null&&l.call(n))&&(f=Date.now());const p=e();if(!(p.length!==r.length||p.some((x,S)=>r[S]!==x)))return s;r=p;let w;if(n.key&&((c=n.debug)!=null&&c.call(n))&&(w=Date.now()),s=t(...p),n.key&&((d=n.debug)!=null&&d.call(n))){const x=Math.round((Date.now()-f)*100)/100,S=Math.round((Date.now()-w)*100)/100,C=S/16,v=(g,y)=>{for(g=String(g);g.length<y;)g=" "+g;return g};console.info(`%c ${v(S,5)} /${v(x,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*C,120))}deg 100% 31%);`,n==null?void 0:n.key)}return n!=null&&n.onChange&&!(i&&n.skipInitialOnChange)&&n.onChange(s),i=!1,s}return o.updateDeps=l=>{r=l},o}function Sm(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const iC=(e,t)=>Math.abs(e-t)<1.01,oC=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},bm=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},lC=e=>e,aC=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},uC=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=o=>{const{width:l,height:c}=o;t({width:Math.round(l),height:Math.round(c)})};if(s(bm(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(o=>{const l=()=>{const c=o[0];if(c!=null&&c.borderBoxSize){const d=c.borderBoxSize[0];if(d){s({width:d.inlineSize,height:d.blockSize});return}}s(bm(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},Cm={passive:!0},km=typeof window>"u"?!0:"onscrollend"in window,cC=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&km?()=>{}:oC(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),o=f=>()=>{const{horizontal:p,isRtl:h}=e.options;s=p?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,f)},l=o(!0),c=o(!1);c(),n.addEventListener("scroll",l,Cm);const d=e.options.useScrollendEvent&&km;return d&&n.addEventListener("scrollend",c,Cm),()=>{n.removeEventListener("scroll",l),d&&n.removeEventListener("scrollend",c)}},dC=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},fC=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const o=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class hC{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:lC,rangeExtractor:aC,onChange:()=>{},measureElement:dC,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=Hs(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let o=r-1;o>=0;o--){const l=n[o];if(s.has(l.lane))continue;const c=i.get(l.lane);if(c==null||l.end>c.end?i.set(l.lane,l):l.end<c.end&&s.set(l.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=Hs(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(n,r,s,i,o,l)=>(this.prevLanes!==void 0&&this.prevLanes!==l&&(this.lanesChangedFlag=!0),this.prevLanes=l,this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=Hs(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l},c)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>n)for(const h of this.laneAssignments.keys())h>=n&&this.laneAssignments.delete(h);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(h=>{this.itemSizeCache.set(h.key,h.size)}));const d=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===n&&(this.lanesSettling=!1);const f=this.measurementsCache.slice(0,d),p=new Array(l).fill(void 0);for(let h=0;h<d;h++){const w=f[h];w&&(p[w.lane]=h)}for(let h=d;h<n;h++){const w=i(h),x=this.laneAssignments.get(h);let S,C;if(x!==void 0&&this.options.lanes>1){S=x;const m=p[S],b=m!==void 0?f[m]:void 0;C=b?b.end+this.options.gap:r+s}else{const m=this.options.lanes===1?f[h-1]:this.getFurthestMeasurement(f,h);C=m?m.end+this.options.gap:r+s,S=m?m.lane:h%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(h,S)}const v=c.get(w),g=typeof v=="number"?v:this.options.estimateSize(h),y=C+g;f[h]={index:h,start:C,size:g,end:y,key:w,lane:S},p[S]=h}return this.measurementsCache=f,f},{key:!1,debug:()=>this.options.debug}),this.calculateRange=Hs(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?pC({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=Hs(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,o)=>i===null||o===null?[]:n({startIndex:i,endIndex:o,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==n&&(l&&this.observer.unobserve(l),this.observer.observe(n),this.elementsCache.set(o,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,o=r-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,o,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=Hs(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,o=n.length;i<o;i++){const l=n[i],c=r[l];s.push(c)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return Sm(r[bx(0,r.length-1,s=>Sm(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),o=this.getScrollOffset();r==="auto"&&(r=n>=o+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),o=this.getScrollOffset();if(r==="auto")if(s.end>=o+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=o+this.options.scrollPaddingStart)r="start";else return[o,r];const l=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),n=Math.max(0,Math.min(n,this.options.count-1));let i=0;const o=10,l=d=>{if(!this.targetWindow)return;const f=this.getOffsetForIndex(n,d);if(!f){console.warn("Failed to get offset for index:",n);return}const[p,h]=f;this._scrollToOffset(p,{adjustments:void 0,behavior:s}),this.targetWindow.requestAnimationFrame(()=>{const w=this.getScrollOffset(),x=this.getOffsetForIndex(n,h);if(!x){console.warn("Failed to get offset for index:",n);return}iC(x[0],w)||c(h)})},c=d=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(d)):console.warn(`Failed to scroll to index ${n} after ${o} attempts.`))};l(r)},this.scrollBy=(n,{behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=r.length-1;for(;o>=0&&i.some(l=>l===null);){const l=r[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}s=Math.max(...i.filter(l=>l!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(t)}}const bx=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function pC({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=c=>e[c].start;if(e.length<=r)return{startIndex:0,endIndex:s};let o=bx(0,s,i,n),l=o;if(r===1)for(;l<s&&e[l].end<n+t;)l++;else if(r>1){const c=Array(r).fill(0);for(;l<s&&c.some(f=>f<n+t);){const f=e[l];c[f.lane]=f.end,l++}const d=Array(r).fill(n+t);for(;o>=0&&d.some(f=>f>=n);){const f=e[o];d[f.lane]=f.start,o--}o=Math.max(0,o-o%r),l=Math.min(s,l+(r-1-l%r))}return{startIndex:o,endIndex:l}}const Em=typeof document<"u"?u.useLayoutEffect:u.useEffect;function mC(e){const t=u.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var o;i?yu.flushSync(t):t(),(o=e.onChange)==null||o.call(e,s,i)}},[r]=u.useState(()=>new hC(n));return r.setOptions(n),Em(()=>r._didMount(),[]),Em(()=>r._willUpdate()),r}function gC(e){return mC({observeElementRect:uC,observeElementOffset:cC,scrollToFn:fC,...e})}function vC({containerW:e,gap:t,targetCell:n,aspect:r,captionH:s}){const i=Math.max(1,Math.floor((e+t)/(n+t))),o=(e-t*(i-1))/i,l=o*r.h/r.w,c=l+s+t;return{columns:i,cellW:o,mediaH:l,rowH:c}}const yC=1.333;function xC({items:e,containerWidth:t,targetHeight:n,gap:r,captionH:s}){if(t<=0)return[];const i=[];let o=[],l=0;const c=(d,f)=>({index:i.length,height:f+s+r,imageH:f,items:d.map(p=>({item:p.item,displayW:p.aspect*f,displayH:f,originalIndex:p.originalIndex}))});for(let d=0;d<e.length;d++){const f=e[d],p=f.w>0&&f.h>0?f.w/f.h:yC;o.push({item:f,aspect:p,originalIndex:d}),l+=p;const h=(o.length-1)*r;if(l*n+h>=t){const x=(t-h)/l;i.push(c(o,x)),o=[],l=0}}return o.length>0&&i.push(c(o,n)),i}function wC(e,t,n){return{mode:"adaptive",rows:xC({items:t,containerWidth:e,targetHeight:n.targetCell,gap:n.gap,captionH:n.captionH})}}function SC(e,t,n){const{columns:r,cellW:s,mediaH:i,rowH:o}=vC({containerW:e,gap:n.gap,targetCell:n.targetCell,aspect:n.aspect,captionH:n.captionH}),l=Math.ceil(t.length/Math.max(1,r));return{mode:"grid",columns:r,cellW:s,mediaH:i,rowH:o,rowCount:l}}function bC(e,t,n){const[r,s]=u.useState(0);u.useLayoutEffect(()=>{const c=e.current;if(!c)return;const d=()=>{const p=getComputedStyle(c),h=c.clientWidth-parseFloat(p.paddingLeft)-parseFloat(p.paddingRight);s(h)},f=new ResizeObserver(d);return f.observe(c),d(),()=>f.disconnect()},[]);const i=u.useMemo(()=>n.viewMode==="adaptive"?wC(r,t,n):SC(r,t,n),[r,t,n.viewMode,n.gap,n.targetCell,n.aspect.w,n.aspect.h,n.captionH]),o=gC({count:i.mode==="adaptive"?i.rows.length:i.rowCount,getScrollElement:()=>e.current,estimateSize:c=>i.mode==="adaptive"?i.rows[c].height:i.rowH,overscan:8}),l=o.getVirtualItems();return u.useEffect(()=>{o.measure()},[i,o]),{width:r,layout:i,rowVirtualizer:o,virtualRows:l}}function CC(e,t,n,r){if(!e.length)return null;const s=n?e.findIndex(l=>l.path===n):0,i=Math.max(1,t);let o=s;if(r.key==="ArrowRight"||r.key==="d")o=Math.min(e.length-1,s+1);else if(r.key==="ArrowLeft"||r.key==="a")o=Math.max(0,s-1);else if(r.key==="ArrowDown"||r.key==="s")o=Math.min(e.length-1,s+i);else if(r.key==="ArrowUp"||r.key==="w")o=Math.max(0,s-i);else return r.key==="Enter"&&n?"open":null;return o}function kC(e,t,n){if(e.length===0)return[];const r=Array.from(new Set(e.map(d=>d.index))).sort((d,f)=>d-f),s=r[0],i=r[r.length-1],o=t.mode==="adaptive"?Math.max(0,t.rows.length-1):Math.max(0,Math.ceil(n.length/Math.max(1,t.columns))-1),l=[s-1,i+1].filter(d=>d>=0&&d<=o);if(l.length===0)return[];const c=[];for(const d of l){if(t.mode==="adaptive"){const h=t.rows[d];if(!h)continue;for(const w of h.items)c.push(w.item.path);continue}const f=d*t.columns,p=n.slice(f,f+t.columns);for(const h of p)c.push(h.path)}return Array.from(new Set(c))}function EC(e,t){var s,i;let n=0,r=e.length-1;for(;n<=r;){const o=n+r>>1,l=e[o],c=((s=l.items[0])==null?void 0:s.originalIndex)??-1,d=((i=l.items[l.items.length-1])==null?void 0:i.originalIndex)??-1;if(t>=c&&t<=d)return o;t<c?r=o-1:n=o+1}return 0}function NC(e,t,n){const r=new Set;for(const s of n){if(t.mode==="adaptive"){const l=t.rows[s.index];if(!l)continue;for(const c of l.items)r.add(c.item.path);continue}const i=s.index*t.columns,o=Math.min(e.length,i+t.columns);for(let l=i;l<o;l+=1){const c=e[l];c&&r.add(c.path)}}return r}function MC(e,t,n,r){var o,l,c;const s=PC(n,r);if(!s)return null;if(t.mode==="adaptive")return((l=(o=t.rows[s.index])==null?void 0:o.items[0])==null?void 0:l.item.path)??null;const i=s.index*t.columns;return((c=e[i])==null?void 0:c.path)??null}function jC(e,t,n){let r=null,s=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;for(const o of e)o.path&&(o.bottom<=t||o.top>=n||o.top>s||o.top===s&&o.left>=i||(r=o.path,s=o.top,i=o.left));return r}function PC(e,t){if(e.length===0)return null;const n=Math.max(0,t);for(const r of e){const s=r.start??0;if((r.end??s+(r.size??0))>n)return r}return e[0]}function RC({selectionToken:e,appliedSelectionToken:t,selectedPath:n,topAnchorToken:r,appliedTopAnchorToken:s,topAnchorPath:i,hasPath:o}){const l=e??0;if(l>0&&l!==t&&n&&o(n))return{source:"selection",path:n,token:l};const c=r??0;return c>0&&c!==s&&i&&o(i)?{source:"top-anchor",path:i,token:c}:null}function TC({path:e,pathToIndex:t,layout:n,adaptiveRowMeta:r}){var o;const s=t.get(e);if(s==null||s<0)return null;const i=n.mode==="grid"?Math.floor(s/Math.max(1,n.columns)):EC(n.rows,s);return n.mode==="grid"?i*n.rowH:((o=r==null?void 0:r[i])==null?void 0:o.start)??0}const IC=500,LC=450,_C=600,AC=8;function FC(e){return Math.max(LC,Math.min(_C,e))}class OC{constructor(t){dt(this,"delayMs");dt(this,"moveTolerancePx");dt(this,"onLongPress");dt(this,"onCancel");dt(this,"timerId",null);dt(this,"activePointerId",null);dt(this,"startX",0);dt(this,"startY",0);dt(this,"lastEvent",null);dt(this,"fired",!1);this.delayMs=FC(t.delayMs??IC),this.moveTolerancePx=Math.max(0,t.moveTolerancePx??AC),this.onLongPress=t.onLongPress,this.onCancel=t.onCancel}pointerDown(t){return(t.pointerType??"mouse")==="mouse"?!1:t.isPrimary===!1?(this.cancel("multitouch"),!1):this.activePointerId!=null&&this.activePointerId!==t.pointerId?(this.cancel("multitouch"),!1):(this.activePointerId=t.pointerId,this.startX=t.clientX,this.startY=t.clientY,this.lastEvent=t,this.fired=!1,this.clearTimer(),this.timerId=setTimeout(()=>{this.activePointerId==null||this.fired||this.lastEvent==null||(this.fired=!0,this.clearTimer(),this.onLongPress(this.lastEvent))},this.delayMs),!0)}pointerMove(t){if(!this.matchesPointer(t.pointerId)||this.fired)return;this.lastEvent=t;const n=t.clientX-this.startX,r=t.clientY-this.startY;Math.hypot(n,r)>this.moveTolerancePx&&this.cancel("movement")}pointerUp(t){if(!(t!=null&&!this.matchesPointer(t))){if(!this.fired){this.cancel("pointerup");return}this.reset()}}pointerCancel(t){t!=null&&!this.matchesPointer(t)||this.cancel("pointercancel")}cancelFromScroll(){this.cancel("scroll")}destroy(){this.cancel("cleanup")}matchesPointer(t){return this.activePointerId!=null&&this.activePointerId===t}clearTimer(){this.timerId!=null&&(clearTimeout(this.timerId),this.timerId=null)}reset(){this.clearTimer(),this.activePointerId=null,this.lastEvent=null,this.fired=!1}cancel(t){var r;const n=this.timerId!=null&&!this.fired&&t!=="cleanup";this.reset(),n&&((r=this.onCancel)==null||r.call(this,t))}}function DC(e){return e==="touch"||e==="pen"}function zC(e){return e.multiSelectMode||e.isShift||e.isToggle||!DC(e.pointerType)?!1:e.selectedPaths.length===1&&e.selectedPaths[0]===e.path}function Nm(e,t){return e.includes(t)?e.filter(n=>n!==t):[...e,t]}const Xn=12,$C=44,BC={w:4,h:3},UC=350,VC=120;function WC(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function Mm(e){return{pointerId:e.pointerId,pointerType:e.pointerType,clientX:e.clientX,clientY:e.clientY,isPrimary:e.isPrimary}}function HC(e,t){const n=(t??"").trim();if(!n)return e;const r=e.toLowerCase().indexOf(n.toLowerCase());if(r===-1)return e;const s=e.slice(0,r),i=e.slice(r,r+n.length),o=e.slice(r+n.length);return a.jsxs(a.Fragment,{children:[s,a.jsx("mark",{className:"bg-accent/20 text-inherit rounded px-0.5",children:i}),o]})}function QC(e){if(!e)return null;const t=e.getBoundingClientRect(),n=Array.from(e.querySelectorAll('[role="gridcell"][id^="cell-"]')).map(r=>{const s=r.getBoundingClientRect(),i=r.id.startsWith("cell-")?r.id.slice(5):"";let o="";try{o=i?decodeURIComponent(i):""}catch{o=""}return{path:o,top:s.top,left:s.left,bottom:s.bottom}});return jC(n,t.top,t.bottom)}function KC({items:e,selected:t,restoreToSelectionToken:n,restoreToTopAnchorToken:r,restoreToTopAnchorPath:s,multiSelectMode:i=!1,onSelectionChange:o,onOpenViewer:l,onContextMenuItem:c,onOpenItemActions:d,highlight:f,recentlyUpdated:p,onVisiblePathsChange:h,onTopAnchorPathChange:w,suppressSelectionHighlight:x=!1,viewMode:S="grid",targetCellSize:C=220,scrollRef:v,hideScrollbar:g=!1,isHydrationLoading:y=!1,hydrationProgress:m=null}){const[b,E]=u.useState(null),[j,M]=u.useState(null),[L,R]=u.useState(!1),[B,F]=u.useState(null),[G,Z]=u.useState(null),$=u.useRef(null),I=u.useRef(null),T=u.useRef(null),P=v??T,_=u.useRef(null),O=u.useRef(0),q=u.useRef(0),U=u.useRef(new Set),A=u.useRef(null),K=u.useRef(null),X=u.useRef(null),te=u.useRef(null),oe=u.useRef(null),W=u.useRef({path:null,pointerType:null}),Q=C,{width:de,layout:V,rowVirtualizer:Se,virtualRows:ce}=bC(P,e,{gap:Xn,targetCell:Q,aspect:BC,captionH:$C,viewMode:S}),me=u.useMemo(()=>{const D=new Map;for(let Y=0;Y<e.length;Y++)D.set(e[Y].path,Y);return D},[e]),Be=u.useMemo(()=>{if(V.mode!=="adaptive")return null;const D=new Map;return V.rows.forEach((Y,ie)=>{let ve=0;Y.items.forEach((be,Ee)=>{const le=ve+be.displayW/2;D.set(be.item.path,{row:ie,center:le,order:Ee}),ve+=be.displayW+Xn})}),D},[V]);u.useEffect(()=>{if(!t.length)return;const D=t[0];B!==D&&F(D)},[t,B]);const We=u.useMemo(()=>{if(V.mode!=="adaptive")return null;let D=0;return V.rows.map(Y=>{const ie=D;return D+=Y.height,{start:ie,height:Y.height}})},[V]),ut=u.useRef(null),Ln=(D,Y)=>{try{if(ut.current!=null){try{cancelAnimationFrame(ut.current)}catch{}ut.current=null}const ie=D.scrollTop,ve=Y-ie;if(Math.abs(ve)<1){D.scrollTop=Y;return}const be=140,Ee=performance.now(),le=Ne=>1-Math.pow(1-Ne,3),Le=Ne=>{const it=Math.min(1,(Ne-Ee)/be),De=le(it);D.scrollTop=ie+ve*De,it<1?ut.current=requestAnimationFrame(Le):ut.current=null};ut.current=requestAnimationFrame(Le)}catch{D.scrollTop=Y}},[It,_n]=u.useState(!1);u.useEffect(()=>{const D=P.current;if(!D)return;let Y=0;const ie=()=>{var ve;(ve=K.current)==null||ve.cancelFromScroll(),_n(!0),window.clearTimeout(Y),Y=window.setTimeout(()=>_n(!1),VC)};return D.addEventListener("scroll",ie,{passive:!0}),()=>D.removeEventListener("scroll",ie)},[]),u.useEffect(()=>{const D=new OC({onLongPress:Y=>{const ie=X.current;if(!ie||!d)return;const ve=te.current??{x:Y.clientX,y:Y.clientY};d(ie,ve),oe.current={path:ie,untilMs:Date.now()+700}}});return K.current=D,()=>{D.destroy(),K.current===D&&(K.current=null)}},[d]);const Jt=()=>{I.current!=null&&(window.clearTimeout(I.current),I.current=null)},re=()=>{if(Jt(),R(!1),E(null),$.current){try{URL.revokeObjectURL($.current)}catch{}$.current=null}M(null)},se=D=>{It||(Jt(),E(D),R(!1),I.current=window.setTimeout(async()=>{I.current=null;try{const Y=await ge.getFile(D),ie=URL.createObjectURL(Y);if($.current)try{URL.revokeObjectURL($.current)}catch{}$.current=ie,M(ie),R(!0)}catch{}},UC))},ye=V.mode==="grid"?V.columns:Math.max(1,Math.floor(de/(Q+Xn))),Ie=(D,Y)=>{if(V.mode!=="adaptive")return null;const ie=V.rows[D];if(!ie)return null;let ve=0,be=null;for(const Ee of ie.items){const le=ve+Ee.displayW/2,Le=Math.abs(le-Y);(!be||Le<be.dist)&&(be={path:Ee.item.path,dist:Le}),ve+=Ee.displayW+Xn}return be?be.path:null},we=(D,Y)=>{var De,wt,ze,He;if(!e.length)return null;const ie=D??e[0].path;if(V.mode!=="adaptive"){const Ke=CC(e,ye,ie,Y);return Ke==="open"||Ke==null?Ke:((De=e[Ke])==null?void 0:De.path)??null}const ve=Be==null?void 0:Be.get(ie);if(!ve)return ie;const be=me.get(ie)??0,Ee=Y.key;if(Ee==="Enter")return"open";if(Ee==="ArrowRight"||Ee==="d")return((wt=e[Math.min(e.length-1,be+1)])==null?void 0:wt.path)??ie;if(Ee==="ArrowLeft"||Ee==="a")return((ze=e[Math.max(0,be-1)])==null?void 0:ze.path)??ie;const le=Ee==="ArrowDown"||Ee==="s"?1:Ee==="ArrowUp"||Ee==="w"?-1:0;if(le===0)return null;const Le=ve.row+le;if(Le<0||Le>=(((He=V.rows)==null?void 0:He.length)??0))return ie;const Ne=ve.center;return Ie(Le,Ne)??ie},pe=D=>{var Y;try{(Y=document.getElementById(`cell-${encodeURIComponent(D)}`))==null||Y.focus()}catch{}},Ze=u.useCallback(D=>{try{ge.prefetchThumb(D)}catch{}},[]),rt=u.useCallback((D,Y)=>{d==null||d(D,Y)},[d]),xt=()=>{X.current=null,te.current=null},et=(D,Y)=>{var ie;Y.target.closest("[data-grid-action]")||(W.current={path:D,pointerType:Y.pointerType},!i&&(X.current=D,te.current={x:Y.clientX,y:Y.clientY},(ie=K.current)==null||ie.pointerDown(Mm(Y))))},Zt=D=>{var Y;i||(te.current={x:D.clientX,y:D.clientY},(Y=K.current)==null||Y.pointerMove(Mm(D)))},gr=D=>{var Y;i||((Y=K.current)==null||Y.pointerUp(D.pointerId),xt())},wn=D=>{var Y;i||((Y=K.current)==null||Y.pointerCancel(D.pointerId),xt())},An=(D,Y)=>{const ie=oe.current;if(ie&&ie.path===D&&ie.untilMs>Date.now()){oe.current=null,pe(D);return}ie&&ie.untilMs<=Date.now()&&(oe.current=null),F(D),Z(D);const ve=!!Y.shiftKey,be=!!(Y.ctrlKey||Y.metaKey);if(i)o(Nm(t,D)),_.current=D;else if(zC({pointerType:W.current.path===D?W.current.pointerType:null,multiSelectMode:i,isShift:ve,isToggle:be,selectedPaths:t,path:D}))o([D]),_.current=D,l(D);else if(ve){const Ee=_.current??B??t[0]??D,le=me.get(Ee)??e.findIndex(Ne=>Ne.path===Ee),Le=me.get(D)??e.findIndex(Ne=>Ne.path===D);if(le!==-1&&Le!==-1){const Ne=Math.min(le,Le),it=Math.max(le,Le),De=e.slice(Ne,it+1).map(wt=>wt.path);if(be){const wt=new Set(t);for(const ze of De)wt.add(ze);o(Array.from(wt))}else o(De)}else o([D])}else be?(o(Nm(t,D)),_.current=D):(o([D]),_.current=D);It||Ze(D),pe(D)},ke=(D,Y)=>{var ie,ve;try{const be=st.has(D)&&t.length>0?t:[D];(ie=Y.dataTransfer)==null||ie.setData("application/x-lenslet-paths",JSON.stringify(be)),Y.dataTransfer&&(Y.dataTransfer.effectAllowed="copyMove");try{document.body.classList.add("drag-active")}catch{}const le=Y.currentTarget.querySelector(".cell-content img"),Le=document.createElement("div");Le.className="drag-ghost";const Ne=document.createElement("img");Ne.draggable=!1,Ne.alt="drag",le&&le.src&&(Ne.src=le.src),Le.appendChild(Ne),document.body.appendChild(Le);const it=Le.getBoundingClientRect().width||150;(ve=Y.dataTransfer)==null||ve.setDragImage(Le,Math.round(it/2),0);const De=()=>{try{Le.remove()}catch{}try{document.body.classList.remove("drag-active")}catch{}window.removeEventListener("dragend",De),window.removeEventListener("pointerup",De),document.removeEventListener("visibilitychange",De)};window.addEventListener("dragend",De),window.addEventListener("pointerup",De),document.addEventListener("visibilitychange",De)}catch{}};u.useEffect(()=>{const D=P.current;if(!D)return;const Y=ie=>{var De,wt,ze;const ve=we(G,ie);if(ve==null)return;if(ie.preventDefault(),ve==="open"){G&&l(G);return}const be=e.find(He=>He.path===ve);if(!be)return;Z(be.path),F(be.path),o([be.path]),_.current=be.path;const Ee=V.mode==="grid"?Math.floor((me.get(be.path)??0)/Math.max(1,V.columns)):((De=Be==null?void 0:Be.get(be.path))==null?void 0:De.row)??0,le=D.scrollTop,Le=le+D.clientHeight,Ne=V.mode==="adaptive"?((wt=We==null?void 0:We[Ee])==null?void 0:wt.start)??0:Ee*V.rowH,it=V.mode==="adaptive"?Ne+(((ze=We==null?void 0:We[Ee])==null?void 0:ze.height)??0):Ne+V.rowH;(Ne<le||it>Le)&&Ln(D,Ne),pe(be.path)};return D.addEventListener("keydown",Y),()=>{D.removeEventListener("keydown",Y)}},[e,G,ye,l,V,Be,We,me]),u.useLayoutEffect(()=>{const D=P.current;if(!D)return;const Y=RC({selectionToken:n,appliedSelectionToken:O.current,selectedPath:t[0]??null,topAnchorToken:r,appliedTopAnchorToken:q.current,topAnchorPath:s??null,hasPath:ve=>me.has(ve)});if(!Y)return;const ie=TC({path:Y.path,pathToIndex:me,layout:V,adaptiveRowMeta:We});if(ie!=null){try{D.scrollTop=ie}catch{}if(Y.source==="selection"){O.current=Y.token;return}q.current=Y.token}},[n,r,s,t,me,V,We]);const st=u.useMemo(()=>new Set(t),[t]),Fn=!!(b&&j&&L),Gn=u.useMemo(()=>kC(ce,V,e),[e,V,ce]);u.useEffect(()=>{if(!(It||Gn.length===0))for(const D of Gn)Ze(D)},[It,Gn,Ze]),u.useEffect(()=>{var D;(D=P.current)==null||D.focus()},[]),u.useEffect(()=>{var D;if(x){try{(D=P.current)==null||D.blur()}catch{}Z(null)}},[x]);const Vt=u.useMemo(()=>NC(e,V,ce),[e,V,ce]),vr=u.useMemo(()=>{var Y;const D=QC(P.current);return D||MC(e,V,ce,((Y=P.current)==null?void 0:Y.scrollTop)??0)},[e,V,ce,P]);u.useEffect(()=>{h&&(WC(U.current,Vt)||(U.current=Vt,h(Vt)))},[h,Vt]),u.useEffect(()=>{w&&A.current!==vr&&(A.current=vr,w(vr))},[w,vr]);const Lt=G?`cell-${encodeURIComponent(G)}`:void 0,Bi=u.useMemo(()=>{const D=(m==null?void 0:m.totalItems)??0,Y=(m==null?void 0:m.loadedItems)??0;return D<=0||Y<=0?0:Math.min(100,Math.max(0,Y/D*100))},[m]),Fs=((m==null?void 0:m.totalItems)??0)>0,Ui=Math.max(0,(m==null?void 0:m.loadedItems)??0),ns=Math.max(0,(m==null?void 0:m.totalItems)??0),Os=Math.max(0,(m==null?void 0:m.loadedPages)??0),On=Math.max(0,(m==null?void 0:m.totalPages)??0),Dn=`${Bi.toFixed(2)}%`;return u.useEffect(()=>{if(!e.length||vx().firstGridItemLatencyMs!=null)return;const D=P.current;if(!D)return;const Y=D.querySelector('[role="gridcell"][id^="cell-"]');if(!Y)return;const ie=D.getBoundingClientRect(),ve=Y.getBoundingClientRect();if(!(ve.bottom>=ie.top&&ve.top<=ie.bottom))return;const Ee=Y.id.startsWith("cell-")?Y.id.slice(5):"";let le=e[0].path;if(Ee)try{le=decodeURIComponent(Ee)}catch{le=e[0].path}Pb(le)},[e,P]),a.jsxs("div",{role:"grid","aria-label":"Gallery",className:`relative h-full overflow-auto p-3 outline-none ${g?"scrollbar-hidden pr-4":"scrollbar-thin"} ${Fn?"cursor-zoom-in":""}`,ref:P,tabIndex:0,"aria-activedescendant":Lt,"aria-busy":y||void 0,onMouseDown:()=>{var D;return(D=P.current)==null?void 0:D.focus()},style:{"--gap":`${Xn}px`},children:[a.jsxs("div",{className:"relative w-full",style:{height:Se.getTotalSize()},children:[ce.map(D=>{var Ee;let Y=[],ie={},ve="";if(V.mode==="adaptive"){const le=V.rows[D.index];if(!le)return null;Y=le.items,ie={height:le.height,transform:`translate3d(0, ${D.start}px, 0)`,display:"flex",gap:Xn,paddingBottom:Xn},ve="absolute top-0 left-0 right-0 w-full will-change-transform"}else{const le=D.index*V.columns;Y=e.slice(le,le+V.columns).map(Ne=>({item:Ne,displayW:V.cellW,displayH:V.mediaH})),ie={transform:`translate3d(0, ${D.start}px, 0)`,gridTemplateColumns:`repeat(${V.columns}, minmax(0, 1fr))`,gap:Xn,paddingBottom:Xn},ve="absolute top-0 left-0 right-0 w-full grid will-change-transform"}const be=D.index===((Ee=ce[0])==null?void 0:Ee.index);return a.jsx("div",{className:ve,role:"row",style:ie,children:Y.map(({item:le,displayW:Le,displayH:Ne})=>{const it=!x&&(B===le.path||st.has(le.path)),De=(p==null?void 0:p.get(le.path))??null,wt=De!=null,ze=V.mode==="adaptive"?{width:Le}:{},He=V.mode==="adaptive"?{height:Ne}:{},Ke=V.mode==="adaptive"?"relative rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group shrink-0":"relative aspect-[4/3] rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group";return a.jsxs("div",{id:`cell-${encodeURIComponent(le.path)}`,className:`relative min-w-0 ${it?"outline outline-2 outline-accent outline-offset-2 rounded-[10px]":""}`,role:"gridcell","aria-selected":it,tabIndex:G===le.path?0:-1,onFocus:()=>Z(le.path),draggable:!0,style:ze,onDragStart:_e=>ke(le.path,_e),onPointerDown:_e=>et(le.path,_e),onPointerMove:Zt,onPointerUp:gr,onPointerCancel:wn,onContextMenu:_e=>{_e.preventDefault(),_e.stopPropagation(),c==null||c(_e,le.path)},children:[a.jsxs("div",{className:Ke,style:He,onDoubleClick:()=>{i||l(le.path)},onMouseLeave:re,children:[a.jsx("button",{type:"button",className:"grid-item-action-btn touch-manipulation","data-grid-action":"1","aria-label":`Open actions for ${le.name}`,"aria-haspopup":"menu",onPointerDown:_e=>_e.stopPropagation(),onClick:_e=>{_e.stopPropagation();const un=_e.currentTarget.getBoundingClientRect();rt(le.path,{x:un.right-4,y:un.bottom-4})},children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})}),a.jsx("div",{className:"cell-content absolute inset-0",children:a.jsx(sC,{path:le.path,name:le.name,selected:it,highlighted:wt,highlightKey:De,displayW:Le,displayH:Ne,ioRoot:P.current,isScrolling:It,priority:be,onClick:_e=>An(le.path,_e)})}),a.jsx("div",{className:"absolute right-0 bottom-0 w-7 h-7 cursor-zoom-in",onMouseEnter:()=>se(le.path),onMouseLeave:re,children:a.jsx("div",{className:"grid-item-preview-corner absolute right-0 bottom-0 h-[18px] w-[18px] flex items-center justify-center text-text select-none",style:{clipPath:'path("M0 9C0 4.02944 4.02944 0 9 0H18V18H0V9Z")',background:"linear-gradient(135deg, rgba(18,18,18,0.9) 0%, rgba(34,34,34,0.9) 60%, rgba(22,22,22,0.9) 100%)",borderTop:"1px solid rgba(255,255,255,0.08)",borderLeft:"1px solid rgba(255,255,255,0.08)",boxShadow:"0 1px 2px rgba(0,0,0,0.45)",backdropFilter:"blur(1px)"},children:a.jsxs("svg",{width:"11",height:"11",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round",className:"text-[#d9dce2]","aria-hidden":"true",style:{transform:"translate(0px,0px)"},children:[a.jsx("circle",{cx:"11",cy:"11",r:"5.4"}),a.jsx("path",{d:"M15.5 15.5 L19 19"})]})})})]}),a.jsxs("div",{className:"flex flex-col items-center text-center gap-0 mt-1 px-0.5 text-white/90",children:[a.jsx("div",{className:"text-sm leading-[18px] thumb-filename line-clamp-2 break-words hyphens-auto text-center",title:le.name,children:HC(le.name,f)}),a.jsxs("div",{className:"text-[11px] leading-[15px] opacity-70",children:[le.w,"  ",le.h]})]})]},le.path)})},D.key)}),b&&j&&L&&yu.createPortal(a.jsx("div",{className:"toolbar-offset fixed inset-0 z-[999] flex items-center justify-center pointer-events-none bg-black/20 opacity-100",children:a.jsx("img",{src:j,alt:"preview",className:"max-w-[80vw] max-h-[80vh] object-contain opacity-[0.98]"})}),document.body)]},`${S}-${ye}`),y&&e.length===0&&a.jsx("div",{className:"pointer-events-none absolute inset-3 z-20 flex items-center justify-center",children:a.jsxs("div",{className:"w-full max-w-[580px] rounded-lg border border-border bg-panel/95 px-4 py-3 shadow-lg",children:[a.jsxs("div",{className:"flex items-center justify-between gap-3 text-xs text-text",children:[a.jsx("span",{className:"font-semibold",children:"Loading gallery"}),Fs&&a.jsxs("span",{className:"font-mono text-muted",children:[Ui.toLocaleString()," / ",ns.toLocaleString()," items"]})]}),Fs?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mt-2 h-1.5 overflow-hidden rounded bg-surface-inset",children:a.jsx("div",{className:"h-full rounded bg-accent transition-[width] duration-150",style:{width:Dn}})}),a.jsxs("div",{className:"mt-2 text-[11px] text-muted",children:["Page ",Os.toLocaleString()," of ",On.toLocaleString()]})]}):a.jsx("div",{className:"mt-2 text-[11px] text-muted",children:"Preparing first recursive page"})]})})]})}const GC=48,qC=[.1,.24,.5,.74,.9];function YC({items:e,metricKey:t,scrollRef:n,sortDir:r}){const{orderedValues:s,numericValues:i}=u.useMemo(()=>{var R;const M=[],L=[];for(const B of e){const F=(R=B.metrics)==null?void 0:R[t],G=F==null||Number.isNaN(F)?null:F;M.push(G),G!=null&&L.push(G)}return{orderedValues:M,numericValues:L}},[e,t]),o=u.useMemo(()=>XC(i,GC),[i]),l=u.useMemo(()=>JC(i,qC),[i]),[c,d]=u.useState(0),[f,p]=u.useState(null),[h,w]=u.useState(!1),x=u.useRef(null);if(u.useEffect(()=>{const M=n.current;if(!M)return;const L=()=>{const R=Math.max(1,M.scrollHeight-M.clientHeight),B=ds(R>0?M.scrollTop/R:0);d(B)};return L(),M.addEventListener("scroll",L,{passive:!0}),window.addEventListener("resize",L),()=>{M.removeEventListener("scroll",L),window.removeEventListener("resize",L)}},[n,e.length]),u.useEffect(()=>{p(null)},[t,e.length]),!o)return null;const S={min:o.min,max:o.max},C=f!=null?Pm(f):null,v=Pm(c),g=r==="desc",y=u.useMemo(()=>f==null?null:tk(s,f),[s,f]);function m(M){p(ds(M))}function b(){p(null)}function E(M){const L=n.current;if(!L)return;const R=Math.max(0,L.scrollHeight-L.clientHeight);L.scrollTop=ds(M)*R}function j(M){var R;const L=(R=x.current)==null?void 0:R.getBoundingClientRect();return L?ds((M.clientY-L.top)/L.height):null}return a.jsxs("div",{className:"absolute right-0 top-3 bottom-3 w-[14px] flex items-stretch pointer-events-auto",children:[a.jsxs("svg",{ref:x,viewBox:"0 0 10 100",preserveAspectRatio:"none",className:"w-full h-full rounded bg-surface-inset border border-border/60 cursor-ns-resize",onPointerDown:M=>{var R;M.preventDefault();const L=j(M);L!=null&&(w(!0),m(L),E(L),(R=x.current)==null||R.setPointerCapture(M.pointerId))},onPointerMove:M=>{const L=j(M);if(L==null){h||b();return}m(L),h&&E(L)},onPointerUp:M=>{var L;w(!1),(L=x.current)==null||L.releasePointerCapture(M.pointerId)},onPointerLeave:()=>{h||b()},children:[ZC(o.bins,"var(--border-strong)",{flip:g}),ek(l,S,{flip:g,color:"var(--muted)"}),jm(v,{color:"var(--highlight)",strokeWidth:.8}),C!=null&&jm(C,{color:"var(--text-secondary)",strokeWidth:.6,dashed:!0})]}),y!=null&&f!=null&&a.jsx("div",{className:"pointer-events-none absolute right-full mr-2 px-1.5 py-0.5 rounded border border-border bg-surface text-[10px] text-text shadow",style:{top:`calc(${(f*100).toFixed(2)}% - 8px)`},children:rk(y)})]})}function XC(e,t){if(!e.length)return null;const n=Math.min(...e);let r=Math.max(...e);n===r&&(r=n+1);const s=new Array(t).fill(0),i=t/(r-n);for(const o of e){const l=Math.max(0,Math.min(t-1,Math.floor((o-n)*i)));s[l]+=1}return{bins:s,min:n,max:r}}function JC(e,t){if(!e.length)return[];const n=[...e].sort((s,i)=>s-i),r=n.length-1;return t.map(s=>{const i=r*s,o=Math.floor(i),l=Math.ceil(i);if(o===l)return n[o];const c=i-o;return n[o]+(n[l]-n[o])*c})}function ZC(e,t,n){const r=Math.max(1,...e),s=100/e.length,i=(n==null?void 0:n.flip)??!1;return e.map((o,l)=>{const c=Math.max(.8,o/r*10),d=(i?e.length-1-l:l)*s;return a.jsx("rect",{x:10-c,y:d,width:c,height:Math.max(.2,s-.2),fill:t,opacity:.9},`sb-${l}`)})}function ek(e,t,n){const r=(n==null?void 0:n.flip)??!1,s=n==null?void 0:n.color;return e.map((i,o)=>{const l=nk(i,t,r),c=o===2;return a.jsx("line",{x1:0,y1:l,x2:10,y2:l,stroke:s,strokeWidth:c?.8:.5,opacity:c?.9:.6,vectorEffect:"non-scaling-stroke"},`qt-${o}-${i}`)})}function jm(e,t){return a.jsx("line",{x1:0,y1:e,x2:10,y2:e,stroke:t.color,strokeWidth:t.strokeWidth??.6,strokeDasharray:t.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}function tk(e,t){if(!e.length)return null;const n=Math.round(ds(t)*(e.length-1)),r=e[n];if(r!=null)return r;for(let s=1;s<e.length;s++){const i=n-s;if(i>=0&&e[i]!=null)return e[i];const o=n+s;if(o<e.length&&e[o]!=null)return e[o]}return null}function nk(e,t,n){const r=t.max-t.min;if(r===0)return 0;const s=ds((e-t.min)/r);return(n?1-s:s)*100}function Pm(e){return ds(e)*100}function ds(e){return e<0?0:e>1?1:e}function rk(e){if(e==null||Number.isNaN(e))return"-";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function fs(e,t){const[n,r]=u.useState(null),s=u.useRef(null);return u.useEffect(()=>{if(!e){if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}r(null);return}let i=!0;return e().then(o=>{if(!i)return;const l=URL.createObjectURL(o);if(s.current)try{URL.revokeObjectURL(s.current)}catch{}s.current=l,r(l)}).catch(()=>{}),()=>{i=!1}},t),u.useEffect(()=>()=>{if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}},[]),n}const sk=1.2,ik=.05,ok=8;function Cc(e){return Number(Math.min(ok,Math.max(ik,e)).toFixed(4))}function Rm(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Tm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function lk(e,t){try{e.setPointerCapture(t)}catch{}}function ak(e,t){try{e.releasePointerCapture(t)}catch{}}function uk(){const[e,t]=u.useState(1),[n,r]=u.useState(0),[s,i]=u.useState(0),[o,l]=u.useState(1),[c,d]=u.useState(!1),[f,p]=u.useState(!1),[h,w]=u.useState(!1),x=u.useRef(null),S=u.useRef(null),C=u.useRef(1),v=u.useRef(0),g=u.useRef(0),y=u.useRef(new Map),m=u.useRef(null),b=u.useRef(null),E=(T,P)=>{v.current=T,g.current=P,r(T),i(P)},j=T=>{const P=Cc(T);C.current=P,t(P)},M=(T,P)=>{m.current={pointerId:T,startX:P.x,startY:P.y,startTx:v.current,startTy:g.current},b.current=null,p(!0)},L=()=>{const T=Array.from(y.current.entries());if(T.length<2)return;const[P,_]=T,[O,q]=P,[U,A]=_,K=Rm(q,A);!Number.isFinite(K)||K<=2||(b.current={pointerIds:[O,U],startDistance:K,startCenter:Tm(q,A),startScale:C.current,startTx:v.current,startTy:g.current},m.current=null,p(!0))},R=()=>{const T=x.current,P=S.current;if(!T||!P||!P.naturalWidth||!P.naturalHeight)return;const _=T.getBoundingClientRect(),O=_.width/P.naturalWidth,q=_.height/P.naturalHeight,U=Math.min(1,Math.min(O,q));l(U);const A=P.naturalWidth*U,K=P.naturalHeight*U;E((_.width-A)/2,(_.height-K)/2),j(1)};u.useEffect(()=>{const T=x.current;if(!T)return;const P=new ResizeObserver(()=>{try{requestAnimationFrame(()=>R())}catch{R()}});return P.observe(T),()=>P.disconnect()},[]),u.useEffect(()=>{C.current=e,v.current=n,g.current=s},[e,n,s]),u.useEffect(()=>()=>{y.current.clear(),m.current=null,b.current=null},[]);const B=T=>{T.preventDefault();const P=T.deltaY>0?-1:1,_=x.current;if(!_)return;const O=_.getBoundingClientRect(),q=T.clientX-O.left,U=T.clientY-O.top,A=C.current,K=Cc(A*Math.pow(sk,P));if(K===A)return;const X=K/A,te=q-X*(q-v.current),oe=U-X*(U-g.current);j(K),E(te,oe)},F=T=>{if((T.pointerType??"mouse")==="mouse"&&T.button!==0)return;const _=y.current,O=S.current;if(!O||_.size===0&&T.target!==O)return;const q=T.currentTarget,U=q.getBoundingClientRect();if(!(T.clientX<U.left||T.clientX>U.right||T.clientY<U.top||T.clientY>U.bottom)){if(T.preventDefault(),T.stopPropagation(),_.set(T.pointerId,{x:T.clientX,y:T.clientY}),lk(q,T.pointerId),_.size>=2){L();return}M(T.pointerId,{x:T.clientX,y:T.clientY})}},G=T=>{const P=y.current;if(!P.has(T.pointerId))return;P.set(T.pointerId,{x:T.clientX,y:T.clientY});const _=b.current;if(_){const A=P.get(_.pointerIds[0]),K=P.get(_.pointerIds[1]);if(A&&K){const X=Rm(A,K);if(X>2){const te=Tm(A,K),oe=Cc(_.startScale*(X/_.startDistance)),W=oe/_.startScale,Q=te.x-W*(_.startCenter.x-_.startTx),de=te.y-W*(_.startCenter.y-_.startTy);j(oe),E(Q,de)}}return}const O=m.current;if(!O||O.pointerId!==T.pointerId)return;const q=T.clientX-O.startX,U=T.clientY-O.startY;E(O.startTx+q,O.startTy+U)},Z=(T,P)=>{const _=y.current;if(!_.has(T))return;if(_.delete(T),ak(P,T),_.size===0){m.current=null,b.current=null,p(!1);return}if(_.size>=2){L();return}const[O,q]=_.entries().next().value;M(O,q)};return{scale:e,setScale:t,tx:n,setTx:r,ty:s,setTy:i,base:o,setBase:l,ready:c,setReady:d,dragging:f,setDragging:p,visible:h,setVisible:w,containerRef:x,imgRef:S,fitAndCenter:R,handleWheel:B,handlePointerDown:F,handlePointerMove:G,handlePointerUp:T=>{Z(T.pointerId,T.currentTarget)},handlePointerCancel:T=>{Z(T.pointerId,T.currentTarget)}}}function ck({path:e,onClose:t,onNavigate:n,canPrev:r=!1,canNext:s=!1,onZoomChange:i,requestedZoomPercent:o,onZoomRequestConsumed:l}){const{scale:c,setScale:d,tx:f,setTx:p,ty:h,setTy:w,base:x,ready:S,setReady:C,dragging:v,visible:g,setVisible:y,containerRef:m,imgRef:b,fitAndCenter:E,handleWheel:j,handlePointerDown:M,handlePointerMove:L,handlePointerUp:R,handlePointerCancel:B}=uk(),F=fs(()=>ge.getFile(e),[e]),G=fs(()=>ge.getThumb(e),[e]),Z=u.useCallback(()=>{y(!1),window.setTimeout(t,110)},[t,y]);return u.useEffect(()=>{requestAnimationFrame(()=>{var $;y(!0),($=m.current)==null||$.focus()})},[e]),u.useEffect(()=>{const $=I=>{I.key==="Escape"?Z():(I.key==="ArrowRight"||I.key==="d")&&n?n(1):(I.key==="ArrowLeft"||I.key==="a")&&n&&n(-1)};return window.addEventListener("keydown",$),()=>window.removeEventListener("keydown",$)},[Z,n]),u.useEffect(()=>{C(!1)},[F]),u.useEffect(()=>{i&&i(x*c*100)},[x,c,i]),u.useEffect(()=>{if(o==null)return;const $=m.current;if(!$){l&&l();return}const I=Math.max(.05,Math.min(8,o/100/Math.max(1e-6,x))),T=$.getBoundingClientRect(),P=T.width/2,_=T.height/2;d(O=>{const q=I/O;return p(U=>P-q*(P-U)),w(U=>_-q*(_-U)),Number(I.toFixed(4))}),l&&l()},[o,x,l]),a.jsxs("div",{ref:m,role:"dialog","aria-modal":!0,"aria-label":"Image viewer",tabIndex:-1,className:`toolbar-offset touch-none absolute inset-0 left-[var(--left)] right-[var(--right)] flex items-start justify-start bg-panel z-viewer overflow-hidden transition-opacity duration-[110ms] ease-out cursor-grab focus:outline-none focus-visible:outline-none ${v?"cursor-grabbing select-none":""} ${g?"opacity-100":"opacity-0"}`,style:{outline:"none"},onClick:Z,onWheel:j,onPointerDown:M,onPointerMove:L,onPointerUp:R,onPointerCancel:B,onKeyDown:$=>{$.key==="Tab"&&$.preventDefault()},children:[a.jsxs("button",{"aria-label":"Close",onClick:$=>{$.stopPropagation(),Z()},className:"btn btn-sm absolute top-3 right-3 z-10",title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]}),G&&a.jsx("img",{src:G,alt:"thumb",className:"absolute top-0 left-0 max-w-none max-h-none object-contain pointer-events-none transition-opacity duration-[110ms] ease-out",draggable:!1,onDragStart:$=>$.preventDefault(),style:{transform:`translate(${f}px, ${h}px) scale(${x})`,transformOrigin:"0 0",opacity:S?0:.5,filter:"blur(0.25px)"}}),F&&a.jsx("img",{ref:b,src:F,alt:"viewer",className:"max-w-none max-h-none object-contain transition-opacity duration-[110ms] ease-out will-change-transform select-none",draggable:!1,onDragStart:$=>{$.preventDefault()},onLoad:$=>{E(),d(1);try{requestAnimationFrame(()=>C(!0))}catch{C(!0)}},onClick:$=>$.stopPropagation(),style:{transform:`translate(${f}px, ${h}px) scale(${x*c})`,transformOrigin:"0 0",opacity:S?.99:0,WebkitUserDrag:"none"}}),n&&a.jsxs("div",{className:"viewer-mobile-nav",onClick:$=>$.stopPropagation(),children:[a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${r?"":"is-disabled"}`,onClick:()=>r&&n(-1),"aria-label":"Previous image","aria-disabled":!r,disabled:!r,children:"Prev"}),a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${s?"":"is-disabled"}`,onClick:()=>s&&n(1),"aria-label":"Next image","aria-disabled":!s,disabled:!s,children:"Next"})]})]})}function dh(e){return!e||!(e instanceof HTMLElement)?!1:e.closest('input, textarea, [contenteditable="true"]')!==null}const dk=1.2,fk=.05,hk=8;function kc(e){return Number(Math.min(hk,Math.max(fk,e)).toFixed(4))}function Im(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function Lm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function pk(e,t){try{e.setPointerCapture(t)}catch{}}function mk(e,t){try{e.releasePointerCapture(t)}catch{}}function gk(){const[e,t]=u.useState(1),[n,r]=u.useState(0),[s,i]=u.useState(0),[o,l]=u.useState(0),[c,d]=u.useState(0),[f,p]=u.useState(1),[h,w]=u.useState(1),[x,S]=u.useState(!1),C=u.useRef(null),v=u.useRef(null),g=u.useRef(null),y=u.useRef(1),m=u.useRef(0),b=u.useRef(0),E=u.useRef(0),j=u.useRef(0),M=u.useRef(new Map),L=u.useRef(null),R=u.useRef(null),B=u.useCallback(A=>{m.current=A.txA,b.current=A.tyA,E.current=A.txB,j.current=A.tyB,r(A.txA),i(A.tyA),l(A.txB),d(A.tyB)},[]),F=u.useCallback(A=>{const K=kc(A);y.current=K,t(K)},[]),G=u.useCallback((A,K)=>{L.current={pointerId:A,startX:K.x,startY:K.y,startTxA:m.current,startTyA:b.current,startTxB:E.current,startTyB:j.current},R.current=null,S(!0)},[]),Z=u.useCallback(()=>{const A=Array.from(M.current.entries());if(A.length<2)return;const[K,X]=A,[te,oe]=K,[W,Q]=X,de=Im(oe,Q);!Number.isFinite(de)||de<=2||(R.current={pointerIds:[te,W],startDistance:de,startCenter:Lm(oe,Q),startScale:y.current,startTxA:m.current,startTyA:b.current,startTxB:E.current,startTyB:j.current},L.current=null,S(!0))},[]),$=u.useCallback((A,K)=>{const X=M.current;if(!X.has(A))return;if(X.delete(A),mk(K,A),X.size===0){L.current=null,R.current=null,S(!1);return}if(X.size>=2){Z();return}const[te,oe]=X.entries().next().value;G(te,oe)},[G,Z]),I=u.useCallback(()=>{const A=C.current;if(!A)return;const K=A.getBoundingClientRect(),X=W=>{if(!W||!W.naturalWidth||!W.naturalHeight)return;const Q=K.width/W.naturalWidth,de=K.height/W.naturalHeight,V=Math.min(1,Math.min(Q,de)),Se=W.naturalWidth*V,ce=W.naturalHeight*V;return{base:V,tx:(K.width-Se)/2,ty:(K.height-ce)/2}},te=X(v.current);te&&(p(te.base),m.current=te.tx,b.current=te.ty,r(te.tx),i(te.ty));const oe=X(g.current);oe&&(w(oe.base),E.current=oe.tx,j.current=oe.ty,l(oe.tx),d(oe.ty))},[]);u.useEffect(()=>{const A=C.current;if(!A)return;const K=new ResizeObserver(()=>{try{requestAnimationFrame(()=>I())}catch{I()}});return K.observe(A),()=>K.disconnect()},[I]);const T=u.useCallback(()=>{F(1),I()},[I,F]);u.useEffect(()=>{y.current=e,m.current=n,b.current=s,E.current=o,j.current=c},[e,n,s,o,c]),u.useEffect(()=>()=>{M.current.clear(),L.current=null,R.current=null},[]);const P=u.useCallback(A=>{A.preventDefault();const K=A.deltaY>0?-1:1,X=C.current;if(!X)return;const te=X.getBoundingClientRect(),oe=A.clientX-te.left,W=A.clientY-te.top,Q=y.current,de=kc(Q*Math.pow(dk,K));if(de===Q)return;const V=de/Q;F(de),B({txA:oe-V*(oe-m.current),tyA:W-V*(W-b.current),txB:oe-V*(oe-E.current),tyB:W-V*(W-j.current)})},[B,F]),_=u.useCallback(A=>{if((A.pointerType??"mouse")==="mouse"&&A.button!==0)return;const X=A.currentTarget;if(A.preventDefault(),M.current.set(A.pointerId,{x:A.clientX,y:A.clientY}),pk(X,A.pointerId),M.current.size>=2){Z();return}G(A.pointerId,{x:A.clientX,y:A.clientY})},[G,Z]),O=u.useCallback(A=>{const K=M.current;if(!K.has(A.pointerId))return;K.set(A.pointerId,{x:A.clientX,y:A.clientY});const X=R.current;if(X){const Q=K.get(X.pointerIds[0]),de=K.get(X.pointerIds[1]);if(Q&&de){const V=Im(Q,de);if(V>2){const Se=Lm(Q,de),ce=kc(X.startScale*(V/X.startDistance)),me=ce/X.startScale;F(ce),B({txA:Se.x-me*(X.startCenter.x-X.startTxA),tyA:Se.y-me*(X.startCenter.y-X.startTyA),txB:Se.x-me*(X.startCenter.x-X.startTxB),tyB:Se.y-me*(X.startCenter.y-X.startTyB)})}}return}const te=L.current;if(!te||te.pointerId!==A.pointerId)return;const oe=A.clientX-te.startX,W=A.clientY-te.startY;B({txA:te.startTxA+oe,tyA:te.startTyA+W,txB:te.startTxB+oe,tyB:te.startTyB+W})},[B,F]),q=u.useCallback(A=>{$(A.pointerId,A.currentTarget)},[$]),U=u.useCallback(A=>{$(A.pointerId,A.currentTarget)},[$]);return{scale:e,baseA:f,baseB:h,txA:n,tyA:s,txB:o,tyB:c,dragging:x,containerRef:C,imgARef:v,imgBRef:g,fitAndCenter:I,resetView:T,handleWheel:P,handlePointerDown:_,handlePointerMove:O,handlePointerUp:q,handlePointerCancel:U}}function vk({aItem:e,bItem:t,index:n,total:r,canPrev:s,canNext:i,onNavigate:o,onClose:l}){const c=u.useRef(null),[d,f]=u.useState(50),[p,h]=u.useState(!1),[w,x]=u.useState(!1),{scale:S,baseA:C,baseB:v,txA:g,tyA:y,txB:m,tyB:b,dragging:E,containerRef:j,imgARef:M,imgBRef:L,fitAndCenter:R,resetView:B,handleWheel:F,handlePointerDown:G,handlePointerMove:Z,handlePointerUp:$,handlePointerCancel:I}=gk(),T=(e==null?void 0:e.path)??null,P=(t==null?void 0:t.path)??null,_=(e==null?void 0:e.name)??T??"Select an image",O=(t==null?void 0:t.name)??P??"Select another image";u.useEffect(()=>{requestAnimationFrame(()=>{var W;return(W=c.current)==null?void 0:W.focus()})},[T,P]),u.useEffect(()=>{B(),h(!1),x(!1)},[T,P,B]),u.useEffect(()=>{const W=Q=>{if(!dh(Q.target)){if(Q.key==="Escape"){Q.preventDefault(),l();return}if((Q.key==="ArrowRight"||Q.key==="d")&&i){Q.preventDefault(),o(1);return}(Q.key==="ArrowLeft"||Q.key==="a")&&s&&(Q.preventDefault(),o(-1))}};return window.addEventListener("keydown",W),()=>window.removeEventListener("keydown",W)},[l,o,s,i]);const q=fs(T?()=>ge.getFile(T):null,[T]),U=fs(P?()=>ge.getFile(P):null,[P]),A=fs(T?()=>ge.getThumb(T):null,[T]),K=fs(P?()=>ge.getThumb(P):null,[P]),X=u.useCallback(W=>Math.min(95,Math.max(5,W)),[]),te=u.useCallback(W=>{const Q=W.target;Q!=null&&Q.closest(".compare-label")||Q!=null&&Q.closest(".compare-divider-hit")||G(W)},[G]),oe=u.useCallback(W=>{const Q=j.current;if(!Q)return;W.preventDefault(),W.stopPropagation();const de=Q.getBoundingClientRect(),V=W.currentTarget;V.setPointerCapture(W.pointerId);const Se=me=>{const Be=(me.clientX-de.left)/de.width*100;f(X(Be))},ce=me=>{try{V.releasePointerCapture(me.pointerId)}catch{}window.removeEventListener("pointermove",Se),window.removeEventListener("pointerup",ce),window.removeEventListener("pointercancel",ce)};window.addEventListener("pointermove",Se),window.addEventListener("pointerup",ce),window.addEventListener("pointercancel",ce)},[X]);return a.jsxs("div",{ref:c,role:"dialog","aria-modal":!0,"aria-label":"Compare images",tabIndex:-1,className:"toolbar-offset absolute inset-0 left-[var(--left)] right-[var(--right)] bg-panel z-viewer flex flex-col overflow-hidden focus:outline-none",onKeyDown:W=>{W.key==="Tab"&&W.preventDefault()},children:[a.jsxs("div",{className:"compare-header flex items-center gap-3 px-3 py-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Compare"}),a.jsx("div",{className:"text-xs text-muted",children:r>=2?`${n+1}-${Math.min(n+2,r)} of ${r}`:"Select 2 images"}),a.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(-1),disabled:!s,title:"Previous (Left Arrow or A)",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Prev"]}),a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(1),disabled:!i,title:"Next (Right Arrow or D)",children:["Next",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"btn btn-sm",onClick:l,title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]})]})]}),a.jsx("div",{className:"flex-1 min-h-0 p-3 bg-panel",children:a.jsx("div",{ref:j,className:`compare-stage ${E?"is-dragging":""}`,onWheel:F,onPointerDown:te,onPointerMove:Z,onPointerUp:$,onPointerCancel:I,children:!e||!t?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-sm text-muted",children:"Select 2 images to compare."}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"compare-label left-3",children:[a.jsx("span",{className:"compare-label-tag",children:"A"}),a.jsx("span",{className:"truncate",title:e.path,children:_})]}),a.jsxs("div",{className:"compare-label right-3",children:[a.jsx("span",{className:"compare-label-tag",children:"B"}),a.jsx("span",{className:"truncate",title:t.path,children:O})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 ${100-d}% 0 0)`},children:[A&&a.jsx("img",{src:A,alt:"thumb A",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:W=>W.preventDefault(),style:{transform:`translate(${g}px, ${y}px) scale(${C})`,transformOrigin:"0 0",opacity:p?0:.5}}),q&&a.jsx("img",{ref:M,src:q,alt:"compare A",className:"compare-image",draggable:!1,onDragStart:W=>W.preventDefault(),onLoad:()=>{R();try{requestAnimationFrame(()=>h(!0))}catch{h(!0)}},style:{transform:`translate(${g}px, ${y}px) scale(${C*S})`,transformOrigin:"0 0",opacity:p?.99:0}})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 0 0 ${d}%)`},children:[K&&a.jsx("img",{src:K,alt:"thumb B",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:W=>W.preventDefault(),style:{transform:`translate(${m}px, ${b}px) scale(${v})`,transformOrigin:"0 0",opacity:w?0:.5}}),U&&a.jsx("img",{ref:L,src:U,alt:"compare B",className:"compare-image",draggable:!1,onDragStart:W=>W.preventDefault(),onLoad:()=>{R();try{requestAnimationFrame(()=>x(!0))}catch{x(!0)}},style:{transform:`translate(${m}px, ${b}px) scale(${v*S})`,transformOrigin:"0 0",opacity:w?.99:0}})]}),a.jsxs("div",{className:"compare-divider-hit",style:{left:`${d}%`},onPointerDown:oe,children:[a.jsx("div",{className:"compare-divider-line"}),a.jsx("div",{className:"compare-divider-handle"})]})]})})})]})}function Cu(){const[e,t]=u.useState(Zb());return u.useEffect(()=>Jb(t),[]),e}const Wo=e=>["item",e],yk={v:1,tags:[],notes:"",version:1,updated_at:"",updated_by:"web"},bn=new Map,pa=new Map,Qd=new Map,fh=new Map;let _m=0;const Kn=new Map,ho=new Map,xk=12e3,Kd=new Set,Gd=new Set;let hh={state:"idle"},Ho=null,qd=0;function Bl(e){hh=e;for(const t of Kd)t(e)}function ar(){const e=Kn.size>0,t=bn.size+pa.size+qd;if(e){Bl({state:"error",message:"Conflict detected"});return}if(Ho){Bl({state:"error",message:Ho});return}if(t>0){Bl({state:"syncing"});return}Bl({state:"idle"})}function ph(){let e=null;for(const t of Qd.values())e=e==null?t:Math.min(e,t);for(const t of fh.values())e=e==null?t:Math.min(e,t);return e}function Ga(){const e=ph();for(const t of Gd)t(e)}function qa(e){Ho=e,ar()}function Cx(){Ho&&(Ho=null,ar())}function Am(e){qd=Math.max(0,qd+e),ar()}function wk(){_m+=1;const e=_m;return fh.set(e,Date.now()),Ga(),e}function Sk(e){e!=null&&fh.delete(e)&&Ga()}function ku(e){const t=ho.get(e);if(!t||!t.size)return;const n=Kn.get(e)??null;for(const r of t)r(n)}function Fm(e){return Kn.get(e)??null}function Eu(e){Kn.delete(e)&&(ku(e),ar())}function bk(e,t){Kn.set(e,t),ku(e),ar()}function Ck(e,t){const n=ho.get(e)??new Set;return n.add(t),ho.set(e,n),t(Kn.get(e)??null),()=>{const r=ho.get(e);r&&(r.delete(t),r.size||ho.delete(e))}}function kk(e){const[t,n]=u.useState(()=>e?Fm(e):null);return u.useEffect(()=>{if(!e){n(null);return}return n(Fm(e)),Ck(e,n)},[e]),t}function Ek(e){return Kd.add(e),e(hh),()=>{Kd.delete(e)}}function Nk(){const[e,t]=u.useState(hh);return u.useEffect(()=>Ek(t),[]),e}function Mk(e){return Gd.add(e),e(ph()),()=>{Gd.delete(e)}}function jk(){const[e,t]=u.useState(()=>ph()),[n,r]=u.useState(()=>e==null?null:Date.now()-e);return u.useEffect(()=>Mk(t),[]),u.useEffect(()=>{if(e==null){r(null);return}r(Date.now()-e);const s=window.setInterval(()=>{r(Date.now()-e)},1e3);return()=>window.clearInterval(s)},[e]),n}function Yd(e){const t={};return Object.prototype.hasOwnProperty.call(e,"star")&&(t.set_star=e.star??null),Object.prototype.hasOwnProperty.call(e,"notes")&&(t.set_notes=e.notes??""),Object.prototype.hasOwnProperty.call(e,"tags")&&(t.set_tags=Array.isArray(e.tags)?e.tags:[]),t}function Xd(e){var t,n;return e.set_star!==void 0||e.set_notes!==void 0||e.set_tags!==void 0||(((t=e.add_tags)==null?void 0:t.length)??0)>0||(((n=e.remove_tags)==null?void 0:n.length)??0)>0}function so(e){const t=[],n=new Set;for(const r of e??[]){if(typeof r!="string")continue;const s=r.trim();!s||n.has(s)||(n.add(s),t.push(s))}return t}function Pk(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function Rk(e,t){if(e.set_star!==void 0&&(t.star??null)!==e.set_star||e.set_notes!==void 0&&(t.notes??"")!==(e.set_notes??""))return!1;if(e.set_tags!==void 0){const r=so(e.set_tags),s=so(t.tags);return Pk(r,s)}const n=so(t.tags);for(const r of so(e.add_tags))if(!n.includes(r))return!1;for(const r of so(e.remove_tags))if(n.includes(r))return!1;return!0}function kx(e,t,n){if(n instanceof sn&&n.status===409){const r=n.body;if(r!=null&&r.current)return bk(e,{path:e,current:r.current,pending:t,receivedAt:new Date().toISOString()}),!0}return!1}function Tk(e,t){const n=Kn.get(e);if(n){if(Rk(n.pending,t)){Eu(e);return}Kn.set(e,{...n,current:t}),ku(e),ar()}}function Ik(e){const t=Cu();return xu({queryKey:Wo(e),queryFn:()=>ge.getSidecar(e),enabled:!!e,staleTime:3e4,gcTime:5*6e4,retry:2,refetchInterval:t?xk:!1,refetchIntervalInBackground:t})}function Lk(e){const t=mr();return ab({mutationFn:async({patch:n,baseVersion:r,idempotencyKey:s})=>{const i=Yd(n);if(!Xd(i))return t.getQueryData(Wo(e))??yk;const o={...i,base_version:r};try{return await ge.patchSidecar(e,o,{idempotencyKey:s??bu("patch"),ifMatch:r})}catch(l){throw kx(e,i,l),l}},retry:(n,r)=>r instanceof sn&&r.status===409?!1:n<2,retryDelay:n=>Math.min(1e3*Math.pow(2,n),4e3),onMutate:()=>(Cx(),Am(1),{inflightId:wk()}),onSuccess:n=>{Eu(e),t.setQueryData(Wo(e),n)},onError:n=>{n instanceof sn&&n.status===409||(n instanceof sn?qa(n.message):qa("Failed to save"))},onSettled:(n,r,s,i)=>{Am(-1),Sk(i==null?void 0:i.inflightId)}})}const _k=6;async function Ex(e,t){if(!e.length)return;let n=0;const r=[],s=async()=>{for(;n<e.length;){const o=n++,l=e[o];try{await Nx(l,t)}catch(c){r.push({path:l,error:c}),console.error(`[bulkUpdateSidecars] Failed for ${l}:`,c)}}},i=Array.from({length:Math.min(_k,e.length)},()=>s());if(await Promise.all(i),r.length===e.length)throw new Error(`All ${e.length} sidecar updates failed`)}async function Nx(e,t){const n=bn.get(e)||{};bn.set(e,{...n,...t}),Cx(),ar();const r=pa.get(e);if(r)return r;Qd.set(e,Date.now()),Ga();const s=(async()=>{try{for(;bn.has(e);){const i=bn.get(e);if(!i)break;const o=Yd(i);if(!Xd(o)){bn.get(e)===i&&bn.delete(e);continue}let l=1;try{l=(await ge.getSidecar(e)).version??1}catch{l=1}const c={...o,base_version:l};try{await ge.patchSidecar(e,c,{idempotencyKey:bu("patch"),ifMatch:l}),Eu(e),bn.get(e)===i&&bn.delete(e)}catch(d){if(kx(e,o,d)){const p=bn.get(e);if(p&&p!==i){const h=Yd(p);if(Xd(h)){const w=Kn.get(e);w&&(Kn.set(e,{...w,pending:h}),ku(e))}}bn.delete(e)}else d instanceof sn?qa(d.message):qa("Failed to save");throw d}}}finally{pa.delete(e),Qd.delete(e),Ga(),ar()}})();return pa.set(e,s),ar(),s}function rl(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function Mx(e){return e==="pil_info"||e.startsWith("pil_info.")||e.startsWith("pil_info[")}function Jd(e,t){if(typeof t=="number")return e?`${e}[${t}]`:`[${t}]`;const n=/^[A-Za-z0-9_$-]+$/.test(t);return e?n?`${e}.${t}`:`${e}["${t}"]`:n?t:`["${t}"]`}function Ya(e){return e==null?String(e):typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):Array.isArray(e)?`[${e.map(Ya).join(",")}]`:typeof e=="object"?`{${Object.entries(e).sort(([n],[r])=>n.localeCompare(r)).map(([n,r])=>`${n}:${Ya(r)}`).join(",")}}`:String(e)}function Ul(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return String(e);try{return JSON.stringify(e,null,1)}catch{return String(e)}}function Xa(e,t,n,r,s){if(s.skipPilInfo&&Mx(t))return;const i=t||"(root)";if(r>=s.maxDepth){n.set(i,e);return}if(Array.isArray(e)){if(!e.length){n.set(i,[]);return}if(e.length>s.maxArray){n.set(i,e);return}e.forEach((o,l)=>Xa(o,Jd(t,l),n,r+1,s));return}if(rl(e)){const o=Object.keys(e).sort((l,c)=>l.localeCompare(c));if(!o.length){n.set(t||"(root)",{});return}for(const l of o)s.skipPilInfo&&!t&&l==="pil_info"||Xa(e[l],Jd(t,l),n,r+1,s);return}n.set(i,e)}function ma(e){if(Array.isArray(e))return e.map(ma);if(e&&typeof e=="object")return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,ma(n)]));if(typeof e=="string"){const t=e.trim();if(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]")||t.startsWith('"')&&t.endsWith('"'))try{const r=JSON.parse(t);return ma(r)}catch{return e}}return e}function Ec(e){return e?ma(e):null}function Nc(e,t){if(!e)return null;if(!t&&rl(e)&&"pil_info"in e){const n={};for(const[r,s]of Object.entries(e))n[r]=r==="pil_info"?"Hidden (toggle Show PIL info to expand)":s;return n}return e}function Co(e,t=[]){return e===null?{kind:"null",text:"null"}:e===void 0?{kind:"undefined",text:"undefined"}:typeof e=="string"?{kind:"string",text:JSON.stringify(e)}:typeof e=="number"?{kind:"number",text:String(e)}:typeof e=="boolean"?{kind:"boolean",text:e?"true":"false"}:Array.isArray(e)?{kind:"array",items:e.map((n,r)=>Co(n,[...t,r]))}:rl(e)?{kind:"object",entries:Object.keys(e).map(n=>{const r=[...t,n];return{key:n,path:r,value:Co(e[n],r)}})}:{kind:"fallback",text:String(e)}}function Ak(e){let t="";for(const n of e)t=Jd(t,n);return t||"(root)"}function Fk(e,t){let n=e;for(const r of t){if(typeof r=="number"){if(!Array.isArray(n))return;n=n[r];continue}if(!rl(n))return;n=n[r]}return n}function Ok(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e;try{return JSON.stringify(e,null,1)}catch{return String(e)}}function Mc(e,t){const n=Fk(e,t);return{pathLabel:Ak(t),copyText:Ok(n)}}function jc(e){return!!e&&rl(e)&&"pil_info"in e}function Dk(e,t,n){if(e==null||t==null)return null;const r=new Map,s=new Map,i={maxDepth:n.maxDepth,maxArray:n.maxArray,skipPilInfo:!n.includePilInfo};Xa(e,"",r,0,i),Xa(t,"",s,0,i);const o=new Set([...r.keys(),...s.keys()]),l=[];let c=0,d=0,f=0;const p=Array.from(o).sort((S,C)=>S.localeCompare(C)),h=!n.includePilInfo;for(const S of p){if(h&&Mx(S))continue;const C=r.has(S),v=s.has(S);if(!C&&v){d+=1,l.push({key:S,kind:"onlyB",aText:"",bText:Ul(s.get(S))});continue}if(C&&!v){c+=1,l.push({key:S,kind:"onlyA",aText:Ul(r.get(S)),bText:""});continue}const g=r.get(S),y=s.get(S),m=Ya(g),b=Ya(y);m!==b&&(f+=1,l.push({key:S,kind:"different",aText:Ul(g),bText:Ul(y)}))}const w=Math.max(0,l.length-n.limit);return{entries:w?l.slice(0,n.limit):l,onlyA:c,onlyB:d,different:f,truncatedCount:w}}function Zd(e){const t=["B","KB","MB","GB","TB"];let n=0,r=e;for(;r>=1024&&n<t.length-1;)r/=1024,n+=1;return`${r.toFixed(1)} ${t[n]}`}function jx(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function Pc(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function zk(e,t=28){if(e.length<=t)return e;const n=Math.max(4,Math.floor((t-1)/2));return`${e.slice(0,n)}${e.slice(-n)}`}const $k=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"});function Bk(e){const t=e.trim();return!t||/[zZ]|[+-]\d{2}:?\d{2}$/.test(t)?t:`${t.includes("T")?t:t.replace(" ","T")}Z`}function Px(e){if(!e)return null;const t=Date.parse(Bk(e));return Number.isFinite(t)?t:null}function Uk(e,t=Date.now()){const n=Math.max(0,t-e),r=Math.max(1,Math.floor(n/1e3));if(r<60)return`${r} second${r===1?"":"s"} ago`;const s=Math.floor(r/60);if(s<60)return`${s} minute${s===1?"":"s"} ago`;const i=Math.floor(s/60);return`${i} hour${i===1?"":"s"} ago`}function Vk(e){return $k.format(new Date(e))}function sl({title:e,open:t,onToggle:n,actions:r,children:s,contentClassName:i}){const[o,l]=u.useState(t),[c,d]=u.useState(t?"open":"closed");return u.useEffect(()=>{if(t){l(!0);const p=window.requestAnimationFrame(()=>d("open"));return()=>window.cancelAnimationFrame(p)}d("closing");const f=window.setTimeout(()=>{l(!1),d("closed")},140);return()=>window.clearTimeout(f)},[t]),a.jsxs("div",{className:"border-b border-border/60",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[a.jsxs("button",{type:"button",onClick:n,"aria-expanded":t,className:"flex items-center gap-2 inspector-section-title hover:text-text transition-colors",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`transition-transform ${t?"rotate-90":""}`,"aria-hidden":"true",children:a.jsx("path",{d:"m9 18 6-6-6-6"})}),a.jsx("span",{children:e})]}),r]}),o&&a.jsx("div",{className:"inspector-section-body","data-state":c,"aria-hidden":!t,children:a.jsx("div",{className:i??"px-3 pb-3",children:s})})]})}function Vl({copied:e,value:t,className:n="",title:r}){return a.jsxs("span",{className:`ui-kv-value relative inline-block text-right min-w-[80px] ${n}`.trim(),title:r,children:[a.jsx("span",{className:e?"invisible block":"block",children:t}),e&&a.jsx("span",{className:"absolute inset-0 text-right",children:"Copied"})]})}function Wk({open:e,onToggle:t,multi:n,star:r,onSelectStar:s,hasStarConflict:i,onApplyConflict:o,onKeepTheirs:l,currentItem:c,sourceValue:d,sortSpec:f,copiedField:p,onCopyInfo:h,metricsExpanded:w,onToggleMetricsExpanded:x,metricsPreviewLimit:S}){return a.jsxs(sl,{title:"Basics",open:e,onToggle:t,children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs mb-1",role:"radiogroup","aria-label":"Star rating",children:[a.jsx("span",{className:"ui-kv-label w-16 shrink-0",children:n?"Rating (all)":"Rating"}),a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(C=>{const v=(r??0)>=C;return a.jsx("button",{className:`w-6 h-6 flex items-center justify-center rounded-lg border border-border/60 bg-transparent text-[13px] ${v?"text-star-active":"text-star-inactive"} hover:border-border hover:text-star-hover transition-colors`,onClick:()=>{s(r===C&&!n?null:C)},title:`${C} star${C>1?"s":""} (key ${C})`,"aria-label":`${C} star${C>1?"s":""}`,"aria-pressed":r===C,children:v?"":""},C)})})]}),i&&a.jsxs("div",{className:"ui-banner ui-banner-danger mt-2 text-[11px] flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Rating conflict."}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:o,children:"Apply again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:l,children:"Keep theirs"})]})]}),!n&&c&&a.jsxs("div",{className:"text-[12px] space-y-1.5 leading-relaxed",children:[a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("dimensions",`${c.w}${c.h}`),children:"Dimensions"}),a.jsx(Vl,{copied:p==="dimensions",value:`${c.w}${c.h}`})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("size",Zd(c.size)),children:"Size"}),a.jsx(Vl,{copied:p==="size",value:Zd(c.size)})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("type",c.type),children:"Type"}),a.jsx(Vl,{copied:p==="type",value:c.type,className:"break-all"})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>d&&h("source",d),children:"Source"}),a.jsx(Vl,{copied:p==="source",value:d,className:"inspector-value-clamp break-words max-w-[70%]",title:d})]}),(()=>{const C=c.metrics||null;if(!C)return null;const v=Object.entries(C).filter(([,L])=>L!=null);if(!v.length)return null;const g=(f==null?void 0:f.kind)==="metric"?f.key:null,y=[...v].sort(([L],[R])=>L.localeCompare(R));let m=y;if(g){const L=y.findIndex(([R])=>R===g);L>0&&(m=[y[L],...y.slice(0,L),...y.slice(L+1)])}const b=m.length>S,j=w||!b?m:m.slice(0,S),M=m.length-S;return a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"ui-subsection-title mb-1",children:"Metrics"}),a.jsxs("div",{className:"space-y-1",children:[j.map(([L,R])=>{const B=g===L;return a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:`w-24 shrink-0 ${B?"text-accent font-medium":"ui-kv-label"}`,children:L}),a.jsx("span",{className:`ui-kv-value text-right ${B?"text-accent font-medium":""}`,children:jx(R)})]},L)}),b&&a.jsx("button",{type:"button",className:"text-[11px] text-muted underline underline-offset-2 hover:text-text",onClick:x,"aria-expanded":w,children:w?"Show less":`+${M} more`})]})]})})()]})]})}const Wl=2,Hk={color:"var(--json-string)"},Qk={color:"var(--json-number)"},Kk={color:"var(--json-literal)"},Gk={color:"var(--json-fallback)"},qk={color:"var(--json-key)"};function ef(e,t,n){switch(e.kind){case"null":case"boolean":return a.jsx("span",{style:Kk,children:e.text});case"undefined":case"fallback":return a.jsx("span",{style:Gk,children:e.text});case"string":return a.jsx("span",{style:Hk,children:e.text});case"number":return a.jsx("span",{style:Qk,children:e.text});case"array":return e.items.length===0?"[]":a.jsxs(a.Fragment,{children:[`[
`,e.items.map((r,s)=>a.jsxs(Yr.Fragment,{children:[" ".repeat(t+Wl),ef(r,t+Wl,n),s<e.items.length-1?",":"",`
`]},s))," ".repeat(t),"]"]});case"object":return e.entries.length===0?"{}":a.jsxs(a.Fragment,{children:[`{
`,e.entries.map((r,s)=>a.jsxs(Yr.Fragment,{children:[" ".repeat(t+Wl),a.jsx("span",{className:"ui-json-key",style:qk,onClick:n?i=>{i.stopPropagation(),n(r.path)}:void 0,children:JSON.stringify(r.key)}),": ",ef(r.value,t+Wl,n),s<e.entries.length-1?",":"",`
`]},JSON.stringify(r.path)))," ".repeat(t),"}"]})}}function Rx({node:e,onPathClick:t}){return a.jsx("code",{className:"block whitespace-pre-wrap",children:ef(e,0,t)})}const Tx=Yr.memo(function({compareDiff:t}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-muted",children:[a.jsxs("span",{children:[t.different," ","different"," ",""," ",t.onlyA," ","only A"," ",""," ",t.onlyB," ","only B"]}),a.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:"Deep paths"})]}),t.entries.length===0?a.jsx("div",{className:"text-muted",children:"No differences found."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2 text-[10px] uppercase tracking-wide text-muted",children:[a.jsx("div",{children:"Path"}),a.jsx("div",{children:"A"}),a.jsx("div",{children:"B"})]}),t.entries.map(n=>a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2",children:[a.jsx("div",{className:"text-[11px] text-muted font-mono break-all",children:n.key}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.aText}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.bText})]},n.key)),t.truncatedCount>0&&a.jsxs("div",{className:"text-muted text-[11px]",children:["+",t.truncatedCount," ","more differences not shown."]})]})]})});Tx.displayName="CompareDiffTable";const tf=Yr.memo(function({side:t,compareMetaLoaded:n,hasPilInfo:r,showPilInfo:s,onToggleShowPilInfo:i,copied:o,onCopy:l,copiedPath:c,displayNode:d,compareMetaContent:f,onMetaPathCopy:p}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:["Metadata"," ",t]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[r&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:i,disabled:!n,children:s?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:l,disabled:!n,children:o?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[c&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",c]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",children:n&&d?a.jsx(Rx,{node:d,onPathClick:p}):f})]})]})});tf.displayName="CompareMetadataPane";function Yk({open:e,onToggle:t,compareMetaState:n,compareMetaError:r,compareLabelA:s,compareLabelB:i,compareIncludePilInfo:o,onToggleCompareIncludePilInfo:l,onReload:c,compareDiff:d,compareHasPilInfoA:f,compareHasPilInfoB:p,compareShowPilInfoA:h,compareShowPilInfoB:w,onToggleCompareShowPilInfoA:x,onToggleCompareShowPilInfoB:S,compareMetaCopied:C,onCopyCompareMetadata:v,compareValueCopiedPathA:g,compareValueCopiedPathB:y,compareDisplayNodeA:m,compareDisplayNodeB:b,compareMetaContent:E,onCompareMetaPathCopyA:j,onCompareMetaPathCopyB:M}){const L=n==="loaded";return a.jsx(sl,{title:"Compare Metadata",open:e,onToggle:t,actions:a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:c,disabled:n==="loading",children:n==="loading"?"Loading":"Reload"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:l,disabled:!L,children:o?"Hide PIL info":"Include PIL info"})]}),children:a.jsxs("div",{className:"space-y-2 text-[11px]",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] text-muted",children:[a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"A"}),a.jsx("div",{className:"text-text break-all",title:s,children:s})]}),a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"B"}),a.jsx("div",{className:"text-text break-all",title:i,children:i})]})]}),n==="loading"&&a.jsx("div",{className:"text-muted",children:"Loading metadata"}),n==="error"&&r&&a.jsx("div",{className:"text-danger break-words",children:r}),L&&d&&a.jsx(Tx,{compareDiff:d}),a.jsxs("div",{className:"grid gap-3 pt-2",children:[a.jsx(tf,{side:"A",compareMetaLoaded:L,hasPilInfo:f,showPilInfo:h,onToggleShowPilInfo:x,copied:C==="A",onCopy:()=>v("A"),copiedPath:g,displayNode:m,compareMetaContent:E,onMetaPathCopy:j}),a.jsx(tf,{side:"B",compareMetaLoaded:L,hasPilInfo:p,showPilInfo:w,onToggleShowPilInfo:S,copied:C==="B",onCopy:()=>v("B"),copiedPath:y,displayNode:b,compareMetaContent:E,onMetaPathCopy:M})]})]})})}const Ix=Yr.memo(Yk);Ix.displayName="CompareMetadataSection";function Xk({open:e,onToggle:t,metadataLoading:n,metadataActionLabel:r,onMetadataAction:s,metadataActionDisabled:i,hasPilInfo:o,showPilInfo:l,onToggleShowPilInfo:c,metaValueCopiedPath:d,metaHeightClass:f,metaLoaded:p,metaDisplayNode:h,metaContent:w,metaError:x,onMetaPathCopy:S}){const C=a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[p&&o&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:c,disabled:!p,children:l?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[78px]",onClick:s,disabled:i||n,children:r})]});return a.jsxs(sl,{title:"Metadata",open:e,onToggle:t,actions:C,children:[a.jsxs("div",{className:"relative",children:[d&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",d]}),a.jsx("pre",{className:`ui-code-block ui-code-block-resizable ${f} overflow-auto whitespace-pre-wrap`,children:p&&h?a.jsx(Rx,{node:h,onPathClick:S}):w})]}),x&&a.jsx("div",{className:"text-[11px] text-danger mt-1 break-words",children:x})]})}const Lx=Yr.memo(Xk);Lx.displayName="MetadataSection";function Jk({open:e,onToggle:t,multi:n,showConflictBanner:r,onApplyConflict:s,onKeepTheirs:i,notes:o,onNotesChange:l,onNotesBlur:c,tags:d,onTagsChange:f,onTagsBlur:p}){return a.jsxs(sl,{title:"Notes & Tags",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",children:[r&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Conflicting edits detected."}),a.jsx("div",{className:"text-[11px] text-muted mt-0.5",children:"Your changes were not saved because this item was updated elsewhere."}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:s,children:"Apply my changes again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:i,children:"Keep theirs"})]})]}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full scrollbar-thin",placeholder:"Add notes",value:o,onChange:h=>l(h.target.value),onBlur:c,"aria-label":n?"Notes for selected items":"Notes"}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:n?"Tags (apply to all, comma-separated)":"Tags (comma-separated)"}),a.jsx("input",{className:"ui-input inspector-input w-full",placeholder:"tag1, tag2",value:d,onChange:h=>f(h.target.value),onBlur:p,"aria-label":n?"Tags for selected items":"Tags"})]})]})}function Zk(e){return e===2?null:e>2?`Side-by-side view supports exactly 2 selections (selected ${e}).`:"Select exactly 2 images to open side-by-side view."}function eE({selectedCount:e,compareActive:t,onOpenCompare:n}){const r=Zk(e),s=!n||t||r!==null,i=t?"Side-by-side viewer is already open.":r??"Open side by side to compare selected images.";return a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Selection Actions"}),a.jsx("div",{className:"flex flex-wrap items-center gap-2",children:a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>n==null?void 0:n(),disabled:s,children:"Side by side view"})}),a.jsx("div",{className:"text-[11px] text-muted",children:i})]})}const Om=2,_x=12,Dm=120,zm=!0,Qo="Comparison export (v1) requires exactly 2 selected images.",tE=`Comparison export (v2) requires between 2 and ${_x} selected images.`,Ax="Comparison export for more than 2 selections is unavailable on this server.";function Fx(e,t){return`Comparison export (v2) supports up to ${e} selections (selected ${t}).`}function nE(e){return e.replace(/[\u0000-\u001f\u007f]/g,"").trim()}function rE(e){const n=e.replace(/\r\n?/g,`
`).replace(/\n+$/g,"");return n?n.split(`
`):[]}function sE(e){if(e.length!==0)return e.length===1?[e[0]]:[e[0],e[1]]}function iE(e){return e.map(t=>t.trim()).filter(t=>t.length>0)}function Ox(e,t){const{maxLines:n,tooManyLinesMessage:r}=t,s=rE(e);if(s.length>n)return{ok:!1,message:r};const i=s.map(l=>nE(l));return i.some(l=>l.length>Dm)?{ok:!1,message:`Each label must be at most ${Dm} characters.`}:i.some(l=>l.length>0)?{ok:!0,labels:i}:{ok:!0,labels:void 0}}function oE(e){const{pathA:t,pathB:n,labelsText:r,embedMetadata:s,reverseOrder:i}=e;if(!t||!n)return{ok:!1,message:Qo};const o=Ox(r,{maxLines:Om,tooManyLinesMessage:`Enter at most ${Om} label lines (line 1 = A, line 2 = B).`});if(!o.ok)return o;const l={v:1,paths:[t,n],embed_metadata:s,reverse_order:i};return o.labels&&(l.labels=sE(o.labels)),{ok:!0,payload:l}}function lE(e){const{paths:t,labelsText:n,embedMetadata:r,reverseOrder:s}=e,i=iE(t);if(i.length!==t.length||i.length<2||i.length>_x)return{ok:!1,message:tE};const o=Ox(n,{maxLines:i.length,tooManyLinesMessage:`Enter at most ${i.length} label lines (one per selected image).`});if(!o.ok)return o;const l={v:2,paths:i,embed_metadata:r,reverse_order:s};return o.labels&&(l.labels=o.labels),{ok:!0,payload:l}}function io(e){return String(e).padStart(2,"0")}function aE(e,t=new Date){const n=t.getUTCFullYear(),r=io(t.getUTCMonth()+1),s=io(t.getUTCDate()),i=io(t.getUTCHours()),o=io(t.getUTCMinutes()),l=io(t.getUTCSeconds());return`comparison${e?"_reverse":""}_${n}${r}${s}_${i}${o}${l}.png`}function uE({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r}){return e<2?`Comparison export requires at least 2 selections (selected ${e}).`:e===2?t?null:Qo:!n||r===null?Ax:e>r?Fx(r,e):null}function cE({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r,compareExportLabelsText:s,onCompareExportLabelsTextChange:i,compareExportEmbedMetadata:o,onCompareExportEmbedMetadataChange:l,compareExportBusy:c,compareExportMode:d,onComparisonExport:f,compareExportError:p}){const h=uE({selectedCount:e,compareReady:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r}),w=c||h!==null,x=e>2?`Label for image 1
Label for image 2
...`:`Label for A
Label for B`;return a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Selection Export"}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full h-20 scrollbar-thin",placeholder:x,value:s,onChange:S=>i(S.target.value),disabled:w,"aria-label":"Selection export labels"}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-[11px] text-muted",children:[a.jsx("input",{type:"checkbox",checked:o,onChange:S=>l(S.target.checked),disabled:w}),a.jsx("span",{children:"Embed metadata"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>f(!1),disabled:w,children:d==="normal"?"Exporting":"Export comparison"}),a.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",onClick:()=>f(!0),disabled:w,children:d==="reverse"?"Exporting":"Export (reverse order)"})]}),h&&a.jsx("div",{className:"text-[11px] text-muted",children:h}),p&&a.jsx("div",{className:"text-danger break-words",children:p})]})}const dE=[{id:"selectionActions",isVisible:()=>!0,render:({selectionActionsProps:e})=>a.jsx(eE,{...e})},{id:"selectionExport",isVisible:({compareActive:e})=>!e,render:({selectionExportProps:e})=>a.jsx(cE,{...e})}];function fE({open:e,onToggle:t,multi:n,selectedCount:r,totalSize:s,filename:i,compareActive:o,compareReady:l,onOpenCompare:c,compareExportSupportsV2:d,compareExportMaxPathsV2:f,compareExportLabelsText:p,onCompareExportLabelsTextChange:h,compareExportEmbedMetadata:w,onCompareExportEmbedMetadataChange:x,compareExportBusy:S,compareExportMode:C,onComparisonExport:v,compareExportError:g,onFindSimilar:y,canFindSimilar:m,findSimilarDisabledReason:b}){const E={compareActive:o,selectionActionsProps:{selectedCount:r,compareActive:o,onOpenCompare:c},selectionExportProps:{selectedCount:r,compareReady:l,compareExportSupportsV2:d,compareExportMaxPathsV2:f,compareExportLabelsText:p,onCompareExportLabelsTextChange:h,compareExportEmbedMetadata:w,onCompareExportEmbedMetadataChange:x,compareExportBusy:S,compareExportMode:C,onComparisonExport:v,compareExportError:g}};return a.jsxs(sl,{title:n?"Selection":"Item",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",actions:y&&a.jsx("button",{type:"button",className:"btn btn-sm",onClick:y,disabled:!m,title:b??"Find similar",children:"Find similar"}),children:[n?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Selected"}),a.jsxs("div",{className:"inspector-field-value",children:[r," files"]})]}),a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Total size"}),a.jsx("div",{className:"inspector-field-value",children:Zd(s)})]})]}),dE.filter(j=>j.isVisible(E)).map(j=>a.jsx(u.Fragment,{children:j.render(E)},j.id))]}):a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Filename"}),a.jsx("div",{className:"inspector-field-value break-all",title:i,children:i})]}),b&&a.jsx("div",{className:"text-[11px] text-muted",children:b})]})}const hE=[{id:"overview",isVisible:()=>!0,render:({overviewProps:e})=>a.jsx(fE,{...e})},{id:"compareMetadata",isVisible:({compareActive:e,compareReady:t})=>e&&t,render:({compareMetadataProps:e})=>a.jsx(Ix,{...e})},{id:"basics",isVisible:()=>!0,render:({basicsProps:e})=>a.jsx(Wk,{...e})},{id:"metadata",isVisible:({multi:e})=>!e,render:({metadataProps:e})=>a.jsx(Lx,{...e})},{id:"notes",isVisible:()=>!0,render:({notesProps:e})=>a.jsx(Jk,{...e})}];function pE(e,t){const n=mE(e)||"view",r=new Set(t.map(i=>i.id));if(!r.has(n))return n;let s=2;for(;r.has(`${n}-${s}`);)s+=1;return`${n}-${s}`}function mE(e){return e.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function Rc(e){const t=e.filter(s=>s>0).sort((s,i)=>i-s),n=e.includes(0),r=[...t.map(s=>String(s))];return n&&r.push("None"),r.join(", ")}function gE(e,t){return e&&t?`${e} to ${t}`:e?`from ${e}`:t?`to ${t}`:""}function vE(e){if(e==="/"||e==="")return"Root";const t=e.split("/").filter(Boolean);return t.length?t.length<=2?`/${t.join("/")}`:`.../${t.slice(-2).join("/")}`:"Root"}function yE(e,t,n,r){return!n||r?t:e==="/"||e===""?e||"/":n===e||n.startsWith(`${e}/`)?e:t}function xE(e,t){return`${$m(e)}${$m(t)}`}function $m(e){const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function wE(e){const t=e.toLowerCase();return t.endsWith(".png")?"image/png":t.endsWith(".webp")?"image/webp":"image/jpeg"}function SE(e,t){const n=e.split("/").pop()??e;return{path:e,name:n,type:wE(e),w:0,h:0,size:0,hasThumb:!0,hasMeta:!1,star:t??null}}function ko(e,t){const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}function bE({selectedPaths:e,comparePathA:t,comparePathB:n}){if(e.length!==2)return null;if(t&&n)return[t,n];const[r,s]=e;return!r||!s?null:[r,s]}function CE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s,labelsText:i,embedMetadata:o,reverseOrder:l}){const c=e.length;if(c<2)return{ok:!1,message:Qo};if(c===2){const d=bE({selectedPaths:e,comparePathA:t,comparePathB:n});if(!d)return{ok:!1,message:Qo};const[f,p]=d;return oE({pathA:f,pathB:p,labelsText:i,embedMetadata:o,reverseOrder:l})}return r?s!==null&&c>s?{ok:!1,message:Fx(s,c)}:lE({paths:e,labelsText:i,embedMetadata:o,reverseOrder:l}):{ok:!1,message:Ax}}function kE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s}){const[i,o]=u.useState(""),[l,c]=u.useState(zm),[d,f]=u.useState(null),[p,h]=u.useState(null),w=d!==null;u.useEffect(()=>{if(e.length<2){o(""),c(zm),f(null),h(null);return}f(null),h(null)},[t,n,e]);const x=u.useCallback(v=>{o(v),h(null)},[]),S=u.useCallback(v=>{c(v)},[]),C=u.useCallback(async v=>{if(w)return;if(e.length<2){h(Qo);return}const y=CE({selectedPaths:e,comparePathA:t,comparePathB:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s,labelsText:i,embedMetadata:l,reverseOrder:v});if(!y.ok){h(y.message);return}f(v?"reverse":"normal"),h(null);try{const m=await ge.exportComparison(y.payload);ko(m,aE(v))}catch(m){const b=m instanceof Error?m.message:"Failed to export comparison.";h(b)}finally{f(null)}},[w,l,i,s,r,t,n,e]);return{compareExportLabelsText:i,compareExportEmbedMetadata:l,compareExportMode:d,compareExportError:p,compareExportBusy:w,handleCompareExportLabelsTextChange:x,handleCompareExportEmbedMetadataChange:S,runComparisonExport:C}}function Bm(e,t){return e?`${e}::${t??""}`:null}function Um(e,t,n){return!e||!t||!n?null:`${t}::${n}`}function Ja({activeRequestId:e,responseRequestId:t,activeContextKey:n,responseContextKey:r}){return e===t&&n===r}function EE({compareReady:e,comparePathA:t,comparePathB:n}){const[r,s]=u.useState("idle"),[i,o]=u.useState(null),[l,c]=u.useState(null),[d,f]=u.useState(null),[p,h]=u.useState(!1),[w,x]=u.useState(!1),[S,C]=u.useState(!1),v=Um(e,t,n),g=u.useRef(0),y=u.useRef(v);y.current=v;const m=u.useCallback(async(E,j,M)=>{const L=g.current+1;g.current=L,s("loading"),o(null);try{const[R,B]=await Promise.all([ge.getMetadata(E),ge.getMetadata(j)]);if(!Ja({activeRequestId:g.current,responseRequestId:L,activeContextKey:y.current,responseContextKey:M}))return;c(R.meta),f(B.meta),s("loaded")}catch(R){if(!Ja({activeRequestId:g.current,responseRequestId:L,activeContextKey:y.current,responseContextKey:M}))return;const B=R instanceof Error?R.message:"Failed to load metadata";c(null),f(null),o(B),s("error")}},[]);u.useEffect(()=>{if(g.current+=1,!v||!t||!n){s("idle"),o(null),c(null),f(null),x(!1),C(!1);return}h(!1),x(!1),C(!1),m(t,n,v)},[v,t,n,m]);const b=u.useCallback(()=>{const E=Um(e,t,n);!E||!t||!n||m(t,n,E)},[e,t,n,m]);return{compareMetaState:r,compareMetaError:i,compareMetaA:l,compareMetaB:d,compareIncludePilInfo:p,compareShowPilInfoA:w,compareShowPilInfoB:S,setCompareIncludePilInfo:h,setCompareShowPilInfoA:x,setCompareShowPilInfoB:C,reloadCompareMetadata:b}}function NE({path:e,sidecarUpdatedAt:t}){const[n,r]=u.useState(null),[s,i]=u.useState(null),[o,l]=u.useState("idle"),[c,d]=u.useState(!1),f=Bm(e,t),p=u.useRef(0),h=u.useRef(f);h.current=f,u.useEffect(()=>{p.current+=1,r(null),i(null),l("idle"),d(!1)},[f]);const w=u.useCallback(async()=>{const x=Bm(e,t);if(!x||!e)return;const S=p.current+1;p.current=S,l("loading"),i(null);try{const C=await ge.getMetadata(e);if(!Ja({activeRequestId:p.current,responseRequestId:S,activeContextKey:h.current,responseContextKey:x}))return;r(C.meta),l("loaded")}catch(C){if(!Ja({activeRequestId:p.current,responseRequestId:S,activeContextKey:h.current,responseContextKey:x}))return;const v=C instanceof Error?C.message:"Failed to load metadata";r(null),i(v),l("error")}},[e,t]);return{metaRaw:n,metaError:s,metaState:o,showPilInfo:c,setMetaError:i,setShowPilInfo:d,fetchMetadata:w}}function ME({path:e,sidecarUpdatedAt:t,selectedPaths:n,compareReady:r,comparePathA:s,comparePathB:i,compareExportSupportsV2:o,compareExportMaxPathsV2:l}){const c=NE({path:e,sidecarUpdatedAt:t}),d=EE({compareReady:r,comparePathA:s,comparePathB:i}),f=kE({selectedPaths:n,comparePathA:s,comparePathB:i,compareExportSupportsV2:o,compareExportMaxPathsV2:l});return{metaRaw:c.metaRaw,metaError:c.metaError,metaState:c.metaState,showPilInfo:c.showPilInfo,setMetaError:c.setMetaError,compareMetaState:d.compareMetaState,compareMetaError:d.compareMetaError,compareMetaA:d.compareMetaA,compareMetaB:d.compareMetaB,compareIncludePilInfo:d.compareIncludePilInfo,compareShowPilInfoA:d.compareShowPilInfoA,compareShowPilInfoB:d.compareShowPilInfoB,compareExportLabelsText:f.compareExportLabelsText,compareExportEmbedMetadata:f.compareExportEmbedMetadata,compareExportMode:f.compareExportMode,compareExportError:f.compareExportError,compareExportBusy:f.compareExportBusy,setShowPilInfo:c.setShowPilInfo,setCompareIncludePilInfo:d.setCompareIncludePilInfo,setCompareShowPilInfoA:d.setCompareShowPilInfoA,setCompareShowPilInfoB:d.setCompareShowPilInfoB,fetchMetadata:c.fetchMetadata,reloadCompareMetadata:d.reloadCompareMetadata,handleCompareExportLabelsTextChange:f.handleCompareExportLabelsTextChange,handleCompareExportEmbedMetadataChange:f.handleCompareExportEmbedMetadataChange,runComparisonExport:f.runComparisonExport}}function Hl(e){return{notes:(e==null?void 0:e.notes)??"",tags:((e==null?void 0:e.tags)??[]).join(", ")}}function Za(e){return e.split(",").map(t=>t.trim()).filter(Boolean)}function jE(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function PE(e,t){return e!==t}function RE(e,t){return!jE(Za(e),Za(t))}function TE({path:e,selectedPaths:t,multi:n,sidecar:r,conflict:s,star:i,queryClient:o,mutateSidecar:l,onStarChanged:c,onLocalTypingChange:d}){const[f,p]=u.useState(""),[h,w]=u.useState(""),x=u.useRef(!1),S=u.useRef(!1),C=u.useRef(!1),v=u.useRef(Hl(void 0)),g=u.useCallback(F=>{x.current!==F&&(x.current=F,d==null||d(F))},[d]),y=u.useCallback(F=>{v.current=F,S.current=!1,C.current=!1,p(F.tags),w(F.notes),g(!1)},[g]);u.useEffect(()=>{if(!e){y(Hl(void 0));return}y(Hl(r))},[e,y,r==null?void 0:r.updated_at,r==null?void 0:r.version]),u.useEffect(()=>()=>{g(!1)},[g]);const m=u.useCallback(F=>{if(n&&t.length){Ex(t,F);return}e&&l(F,(r==null?void 0:r.version)??1)},[n,l,e,t,r==null?void 0:r.version]),b=u.useMemo(()=>({tags:!!(s!=null&&s.pending.set_tags),notes:(s==null?void 0:s.pending.set_notes)!==void 0,star:(s==null?void 0:s.pending.set_star)!==void 0}),[s]),E=u.useCallback(F=>{w(F),S.current=!0,g(!0)},[g]),j=u.useCallback(()=>{const F=S.current;S.current=!1,F&&PE(h,v.current.notes)&&(m({notes:h}),v.current={...v.current,notes:h}),g(!1)},[m,h,g]),M=u.useCallback(F=>{p(F),C.current=!0,g(!0)},[g]),L=u.useCallback(()=>{const F=C.current;C.current=!1,F&&RE(f,v.current.tags)&&(m({tags:Za(f)}),v.current={...v.current,tags:f}),g(!1)},[m,g,f]),R=u.useCallback(()=>{if(!s||!e)return;const F={};s.pending.set_tags!==void 0&&(F.tags=Za(f)),s.pending.set_notes!==void 0&&(F.notes=h),s.pending.set_star!==void 0&&(F.star=i??null),l(F,s.current.version??1)},[s,l,h,e,i,f]),B=u.useCallback(()=>{if(!s||!e)return;const F=s.current,G=Hl(F);v.current=G,S.current=!1,C.current=!1,p(G.tags),w(G.notes),g(!1),o.setQueryData(Wo(e),F),Eu(e),c==null||c([e],F.star??null)},[s,g,c,e,o]);return{tags:f,notes:h,conflictFields:b,commitSidecar:m,applyConflict:R,keepTheirs:B,handleNotesChange:E,handleNotesBlur:j,handleTagsChange:M,handleTagsBlur:L}}const IE=["overview","compare","basics","metadata","notes"],Vm="lenslet.inspector.sections",Wm="lenslet.inspector.metricsExpanded",LE={overview:!0,compare:!0,metadata:!0,basics:!0,notes:!0};function Wt(e){e.current!==null&&(window.clearTimeout(e.current),e.current=null)}function _E({path:e,sidecarUpdatedAt:t,compareReady:n,comparePathA:r,comparePathB:s}){const[i,o]=u.useState(LE),[l,c]=u.useState(!1),[d,f]=u.useState(null),[p,h]=u.useState(!1),[w,x]=u.useState(null),[S,C]=u.useState(null),[v,g]=u.useState(null),[y,m]=u.useState(null),b=u.useRef(null),E=u.useRef(null),j=u.useRef(null),M=u.useRef(null),L=u.useRef(null),R=u.useCallback(U=>{o(A=>({...A,[U]:!A[U]}))},[]),B=u.useCallback(()=>R("overview"),[R]),F=u.useCallback(()=>R("compare"),[R]),G=u.useCallback(()=>R("basics"),[R]),Z=u.useCallback(()=>R("metadata"),[R]),$=u.useCallback(()=>R("notes"),[R]),I=u.useCallback(()=>{c(U=>!U)},[]),T=u.useCallback(U=>{f(U),Wt(b),b.current=window.setTimeout(()=>{f(A=>A===U?null:A),b.current=null},1e3)},[]),P=u.useCallback(()=>{h(!0),Wt(E),E.current=window.setTimeout(()=>{h(!1),E.current=null},1200)},[]),_=u.useCallback(U=>{x(U),Wt(j),j.current=window.setTimeout(()=>{x(null),j.current=null},900)},[]),O=u.useCallback(U=>{C(U),Wt(M),M.current=window.setTimeout(()=>{C(A=>A===U?null:A),M.current=null},1200)},[]),q=u.useCallback((U,A)=>{U==="A"?g(A):m(A),Wt(L),L.current=window.setTimeout(()=>{g(null),m(null),L.current=null},900)},[]);return u.useEffect(()=>{try{const U=localStorage.getItem(Vm);if(!U)return;const A=JSON.parse(U);if(!A||typeof A!="object")return;const K={};for(const X of IE)typeof A[X]=="boolean"&&(K[X]=A[X]);Object.keys(K).length>0&&o(X=>({...X,...K}))}catch{}},[]),u.useEffect(()=>{try{localStorage.setItem(Vm,JSON.stringify(i))}catch{}},[i]),u.useEffect(()=>{try{const U=localStorage.getItem(Wm);U==="1"||U==="true"?c(!0):(U==="0"||U==="false")&&c(!1)}catch{}},[]),u.useEffect(()=>{try{localStorage.setItem(Wm,l?"1":"0")}catch{}},[l]),u.useEffect(()=>{h(!1),x(null),Wt(E),Wt(j)},[e,t]),u.useEffect(()=>{C(null),g(null),m(null),Wt(M),Wt(L)},[r,s,n]),u.useEffect(()=>()=>{Wt(b),Wt(E),Wt(j),Wt(M),Wt(L)},[]),{openSections:i,toggleOverviewSection:B,toggleCompareSection:F,toggleBasicsSection:G,toggleMetadataSection:Z,toggleNotesSection:$,metricsExpanded:l,toggleMetricsExpanded:I,copiedField:d,markInfoCopied:T,metaCopied:p,markMetadataCopied:P,metaValueCopiedPath:w,markMetadataValueCopied:_,compareMetaCopied:S,markCompareMetadataCopied:O,compareValueCopiedPathA:v,compareValueCopiedPathB:y,markCompareMetadataValueCopied:q}}const AE=12,FE=120,OE=8,DE=80;function zE({path:e,selectedPaths:t=[],items:n=[],compareActive:r=!1,compareA:s=null,compareB:i=null,onOpenCompare:o,onResize:l,onStarChanged:c,sortSpec:d,onFindSimilar:f,embeddingsAvailable:p=!1,embeddingsLoading:h=!1,compareExportSupportsV2:w=!1,compareExportMaxPathsV2:x=null,onLocalTypingChange:S}){const C=!!e,{data:v}=Ik(e??""),g=Lk(e??""),y=mr(),m=t.length>1,b=!!f&&p&&!m,E=f?p?m?"Select a single image to search.":null:h?"Loading embeddings...":"No embeddings detected.":null,M=u.useMemo(()=>{var he;return((he=n.find(Ge=>Ge.path===e))==null?void 0:he.star)??null},[n,e])??(v==null?void 0:v.star)??null,L=kk(m?null:e),R=(s==null?void 0:s.path)??null,B=(i==null?void 0:i.path)??null,F=t.length===2&&!!t[0]&&!!t[1],Z=r&&(!!R&&!!B),{openSections:$,toggleOverviewSection:I,toggleCompareSection:T,toggleBasicsSection:P,toggleMetadataSection:_,toggleNotesSection:O,metricsExpanded:q,toggleMetricsExpanded:U,copiedField:A,markInfoCopied:K,metaCopied:X,markMetadataCopied:te,metaValueCopiedPath:oe,markMetadataValueCopied:W,compareMetaCopied:Q,markCompareMetadataCopied:de,compareValueCopiedPathA:V,compareValueCopiedPathB:Se,markCompareMetadataValueCopied:ce}=_E({path:e,sidecarUpdatedAt:v==null?void 0:v.updated_at,comparePathA:R,comparePathB:B,compareReady:Z}),me=Z&&r&&$.compare,Be=!m&&$.metadata,We=(s==null?void 0:s.name)??R??"A",ut=(i==null?void 0:i.name)??B??"B",Ln=u.useCallback((ae,he)=>{g.mutate({patch:ae,baseVersion:he,idempotencyKey:bu("patch")})},[g]),{tags:It,notes:_n,conflictFields:Jt,commitSidecar:re,applyConflict:se,keepTheirs:ye,handleNotesChange:Ie,handleNotesBlur:we,handleTagsChange:pe,handleTagsBlur:Ze}=TE({path:e,selectedPaths:t,multi:m,sidecar:v,conflict:L,star:M,queryClient:y,mutateSidecar:Ln,onStarChanged:c,onLocalTypingChange:S}),{metaRaw:rt,metaError:xt,metaState:et,showPilInfo:Zt,setMetaError:gr,compareMetaState:wn,compareMetaError:An,compareMetaA:ke,compareMetaB:st,compareIncludePilInfo:Fn,compareShowPilInfoA:Gn,compareShowPilInfoB:Vt,compareExportLabelsText:vr,compareExportEmbedMetadata:Lt,compareExportMode:Bi,compareExportError:Fs,compareExportBusy:Ui,setShowPilInfo:ns,setCompareIncludePilInfo:Os,setCompareShowPilInfoA:On,setCompareShowPilInfoB:Dn,fetchMetadata:D,reloadCompareMetadata:Y,handleCompareExportLabelsTextChange:ie,handleCompareExportEmbedMetadataChange:ve,runComparisonExport:be}=ME({path:e,sidecarUpdatedAt:v==null?void 0:v.updated_at,selectedPaths:t,compareReady:Z,comparePathA:R,comparePathB:B,compareExportSupportsV2:w,compareExportMaxPathsV2:x}),Ee=u.useMemo(()=>{const ae=new Set(t);return n.filter(he=>ae.has(he.path))},[n,t]),le=u.useMemo(()=>Ee.reduce((ae,he)=>ae+(he.size||0),0),[Ee]);u.useEffect(()=>{if(!e)return;const ae=he=>{if(dh(he.target))return;const Ge=he.key;if(!/^[0-5]$/.test(Ge))return;he.preventDefault();const Yn=Ge==="0"?null:Number(Ge);if(m&&t.length){re({star:Yn}),c==null||c(t,Yn);return}re({star:Yn}),c==null||c([e],Yn)};return window.addEventListener("keydown",ae),()=>window.removeEventListener("keydown",ae)},[e,m,t,re,c]);const Le=fs(e?()=>ge.getThumb(e):null,[e]),Ne=e?e.split("/").pop()||e:"",it=u.useMemo(()=>{var he;if(Ne.includes("."))return Ne.slice(Ne.lastIndexOf(".")+1).toUpperCase();const ae=n.find(Ge=>Ge.path===e);return(he=ae==null?void 0:ae.type)!=null&&he.includes("/")?ae.type.split("/")[1].toUpperCase():""},[Ne,n,e]),De=u.useMemo(()=>n.find(ae=>ae.path===e),[n,e]),wt=u.useMemo(()=>e?(De==null?void 0:De.source)??e:"",[De,e]),ze=u.useMemo(()=>{if(!rt)return"";try{return JSON.stringify(rt,null,1)}catch{return""}},[rt]),He=u.useMemo(()=>Ec(rt),[rt]),Ke=u.useMemo(()=>Ec(ke),[ke]),_e=u.useMemo(()=>Ec(st),[st]),un=u.useMemo(()=>Nc(He,Zt),[He,Zt]),yr=u.useMemo(()=>{if(!ke)return"";try{return JSON.stringify(ke,null,1)}catch{return""}},[ke]),il=u.useMemo(()=>{if(!st)return"";try{return JSON.stringify(st,null,1)}catch{return""}},[st]),xr=u.useMemo(()=>Nc(Ke,Gn),[Ke,Gn]),qn=u.useMemo(()=>Nc(_e,Vt),[_e,Vt]),Vi=u.useCallback(()=>{var ae;ze&&((ae=navigator.clipboard)==null||ae.writeText(ze).then(()=>{te()}).catch(he=>{const Ge=he instanceof Error?he.message:"Copy failed";gr(Ge)}))},[te,ze,gr]),ol=u.useMemo(()=>!Be||!un?null:Co(un),[Be,un]),ll=u.useMemo(()=>!me||!xr?null:Co(xr),[me,xr]),Mu=u.useMemo(()=>!me||!qn?null:Co(qn),[me,qn]),al=u.useCallback((ae,he)=>{var Ge;(Ge=navigator.clipboard)==null||Ge.writeText(he).then(()=>{W(ae)}).catch(()=>{})},[W]),Ds=u.useCallback((ae,he,Ge)=>{var Yn;(Yn=navigator.clipboard)==null||Yn.writeText(Ge).then(()=>{ce(ae,he)}).catch(()=>{})},[ce]),ul=u.useCallback(ae=>{if(!un)return;const he=Mc(un,ae);al(he.pathLabel,he.copyText)},[un,al]),cl=u.useCallback(ae=>{if(!xr)return;const he=Mc(xr,ae);Ds("A",he.pathLabel,he.copyText)},[xr,Ds]),ju=u.useCallback(ae=>{if(!qn)return;const he=Mc(qn,ae);Ds("B",he.pathLabel,he.copyText)},[qn,Ds]),Pu=u.useCallback(ae=>{var Ge;const he=ae==="A"?yr:il;he&&((Ge=navigator.clipboard)==null||Ge.writeText(he).then(()=>{de(ae)}).catch(()=>{}))},[yr,il,de]);let Wi=un?"":"PNG metadata not loaded yet.";et==="loading"?Wi="Loading metadata":et==="error"&&xt&&(Wi=xt);let zs="Metadata not loaded yet.";wn==="loading"?zs="Loading metadata":wn==="error"&&An&&(zs=An);const Hi=et==="loading",$s=et==="loaded"&&!!ze,Ru=$s?"h-48":"h-24";let rs="Load meta";Hi?rs="Loading":$s&&(rs=X?"Copied":"Copy");const dl=$s?Vi:D,fl=jc(rt),Tu=jc(ke),hl=jc(st),pl=u.useMemo(()=>me?Dk(Ke,_e,{includePilInfo:Fn,limit:FE,maxDepth:OE,maxArray:DE}):null,[me,Ke,_e,Fn]),Iu=u.useCallback((ae,he)=>{var Ge;he&&((Ge=navigator.clipboard)==null||Ge.writeText(he).then(()=>{K(ae)}).catch(()=>{}))},[K]),Bs=u.useCallback(ae=>{if(m&&t.length){c==null||c(t,ae),Ex(t,{star:ae});return}e&&(c==null||c([e],ae),Nx(e,{star:ae}))},[m,c,e,t]),ml=u.useCallback(()=>{ns(ae=>!ae)},[ns]),Lu=u.useCallback(()=>{Os(ae=>!ae)},[Os]),Us=u.useCallback(()=>{On(ae=>!ae)},[On]),_u=u.useCallback(()=>{Dn(ae=>!ae)},[Dn]),Au=u.useCallback(ae=>{be(ae)},[be]),Fu=!m&&!!L&&(Jt.tags||Jt.notes),Ou=!m&&!!L&&Jt.star,gl="toolbar-offset sidebar-resize-handle sidebar-resize-handle-right absolute bottom-0";if(!C)return a.jsx("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:a.jsx("div",{className:gl,onPointerDown:l})});const vl={multi:m,compareActive:r,compareReady:Z,overviewProps:{open:$.overview,onToggle:I,multi:m,selectedCount:t.length,totalSize:le,filename:Ne,compareActive:r,compareReady:F,onOpenCompare:o,compareExportSupportsV2:w,compareExportMaxPathsV2:x,compareExportLabelsText:vr,onCompareExportLabelsTextChange:ie,compareExportEmbedMetadata:Lt,onCompareExportEmbedMetadataChange:ve,compareExportBusy:Ui,compareExportMode:Bi,onComparisonExport:Au,compareExportError:Fs,onFindSimilar:f,canFindSimilar:b,findSimilarDisabledReason:E},compareMetadataProps:{open:$.compare,onToggle:T,compareMetaState:wn,compareMetaError:An,compareLabelA:We,compareLabelB:ut,compareIncludePilInfo:Fn,onToggleCompareIncludePilInfo:Lu,onReload:Y,compareDiff:pl,compareHasPilInfoA:Tu,compareHasPilInfoB:hl,compareShowPilInfoA:Gn,compareShowPilInfoB:Vt,onToggleCompareShowPilInfoA:Us,onToggleCompareShowPilInfoB:_u,compareMetaCopied:Q,onCopyCompareMetadata:Pu,compareValueCopiedPathA:V,compareValueCopiedPathB:Se,compareDisplayNodeA:ll,compareDisplayNodeB:Mu,compareMetaContent:zs,onCompareMetaPathCopyA:cl,onCompareMetaPathCopyB:ju},basicsProps:{open:$.basics,onToggle:P,multi:m,star:M,onSelectStar:Bs,hasStarConflict:Ou,onApplyConflict:se,onKeepTheirs:ye,currentItem:De??null,sourceValue:wt,sortSpec:d,copiedField:A,onCopyInfo:Iu,metricsExpanded:q,onToggleMetricsExpanded:U,metricsPreviewLimit:AE},metadataProps:{open:$.metadata,onToggle:_,metadataLoading:Hi,metadataActionLabel:rs,onMetadataAction:dl,metadataActionDisabled:!e,hasPilInfo:fl,showPilInfo:Zt,onToggleShowPilInfo:ml,metaValueCopiedPath:oe,metaHeightClass:Ru,metaLoaded:$s,metaDisplayNode:ol,metaContent:Wi,metaError:xt,onMetaPathCopy:ul},notesProps:{open:$.notes,onToggle:O,multi:m,showConflictBanner:Fu,onApplyConflict:se,onKeepTheirs:ye,notes:_n,onNotesChange:Ie,onNotesBlur:we,tags:It,onTagsChange:pe,onTagsBlur:Ze}};return a.jsxs("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:[!m&&a.jsx("div",{className:"p-3 border-b border-border flex justify-center",children:a.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-border w-[220px] h-[160px] bg-panel select-none",children:[Le&&a.jsx("img",{src:Le,alt:"thumb",className:"block w-full h-full object-contain"}),!!it&&a.jsx("div",{className:"absolute top-1.5 left-1.5 bg-surface border border-border text-text text-xs px-1.5 py-0.5 rounded-md select-none",children:it})]})}),hE.filter(ae=>ae.isVisible(vl)).map(ae=>a.jsx(u.Fragment,{children:ae.render(vl)},ae.id)),a.jsx("div",{className:gl,onPointerDown:l})]})}function $E({open:e,embeddings:t,rejected:n=[],selectedPath:r,embeddingsLoading:s=!1,embeddingsError:i,onClose:o,onSearch:l}){const[c,d]=u.useState(""),[f,p]=u.useState("path"),[h,w]=u.useState(""),[x,S]=u.useState(""),[C,v]=u.useState("50"),[g,y]=u.useState(""),[m,b]=u.useState(null),[E,j]=u.useState(!1),M=u.useRef(null),L=u.useRef(null),R=u.useMemo(()=>t.find(I=>I.name===c)??t[0]??null,[t,c]);u.useEffect(()=>{e&&(b(null),t.length>0&&!t.some(I=>I.name===c)&&d(t[0].name),r?(p("path"),w(r)):(p("vector"),w("")))},[e,t,c,r]),u.useEffect(()=>{if(!e)return;const I=f==="vector"?L.current:M.current,T=window.requestAnimationFrame(()=>I==null?void 0:I.focus());return()=>window.cancelAnimationFrame(T)},[e,f]);const B=u.useCallback(async()=>{if(b(null),!t.length){b("No embeddings available for similarity search.");return}if(!R){b("Select an embedding to search.");return}const I=h.trim(),T=x.trim(),P=Number(C);if(!Number.isFinite(P)||P<=0){b("Top K must be a positive number.");return}const _=Math.min(1e3,Math.max(1,Math.floor(P))),O=g.trim()===""?null:Number(g);if(O!=null&&!Number.isFinite(O)){b("Min score must be a valid number.");return}if(f==="path"&&!I){b("Select an image path for the query.");return}if(f==="vector"&&!T){b("Paste a base64 vector for the query.");return}const q={embedding:R.name,query_path:f==="path"?I:null,query_vector_b64:f==="vector"?T:null,top_k:_,min_score:O};j(!0);try{await l(q),o()}catch(U){U instanceof sn||U instanceof Error?b(U.message):b("Failed to run similarity search.")}finally{j(!1)}},[t.length,R,h,x,C,g,f,l,o]);u.useEffect(()=>{if(!e)return;const I=T=>{if(T.key==="Escape"){T.preventDefault(),o();return}(T.ctrlKey||T.metaKey)&&T.key==="Enter"&&(T.preventDefault(),B())};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[e,o,B]);const F=u.useCallback(()=>{var I;r&&(p("path"),w(r),(I=M.current)==null||I.focus())},[r]);if(!e)return null;const G=t.map(I=>({value:I.name,label:I.name})),Z=n.length>0,$=n.slice(0,3);return a.jsx("div",{className:"fixed inset-0 z-[var(--z-overlay)] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",onClick:I=>{I.target===I.currentTarget&&o()},children:a.jsxs("div",{className:"w-full max-w-2xl rounded-lg border border-border bg-panel shadow-[0_20px_50px_rgba(0,0,0,0.55)]",onClick:I=>I.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Find similar",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Find similar"}),a.jsx("div",{className:"text-xs text-muted",children:"Search with embeddings"})]}),a.jsx("button",{className:"btn btn-sm",onClick:o,"aria-label":"Close",children:"Close"})]}),a.jsxs("div",{className:"px-4 py-4 space-y-4",children:[i&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:i}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Embedding"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ah,{value:(R==null?void 0:R.name)??"",onChange:d,options:G,placeholder:s?"Loading embeddings...":"Select embedding",disabled:!t.length,triggerClassName:"min-w-[180px]"}),R&&a.jsxs("span",{className:"text-xs text-muted",children:[R.dimension," dims, ",R.metric,", ",R.dtype]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Query mode"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:`btn btn-sm ${f==="path"?"btn-active":""}`,onClick:()=>p("path"),"aria-pressed":f==="path",children:"Selected image"}),a.jsx("button",{type:"button",className:`btn btn-sm ${f==="vector"?"btn-active":""}`,onClick:()=>p("vector"),"aria-pressed":f==="vector",children:"Vector input"})]})]}),f==="path"?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Image path"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{ref:M,type:"text",className:"input w-full",value:h,onChange:I=>w(I.target.value),placeholder:r?"Selected image path":"Select an image first"}),a.jsx("button",{type:"button",className:"btn btn-sm",onClick:F,disabled:!r,title:r?"Use selected image":"Select an image first",children:"Use selected"})]})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Vector (base64 float32)"}),a.jsx("textarea",{ref:L,className:"ui-textarea w-full font-mono text-[11px]",rows:5,value:x,onChange:I=>S(I.target.value),placeholder:"Paste base64-encoded float32 vector"}),a.jsx("div",{className:"text-[11px] text-muted",children:"Base64 of little-endian float32. Length must match embedding dimension."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Top K"}),a.jsx("input",{type:"number",min:1,max:1e3,step:1,className:"input ui-number w-full",value:C,onChange:I=>v(I.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Min score"}),a.jsx("input",{type:"number",step:.01,className:"input ui-number w-full",value:g,onChange:I=>y(I.target.value),placeholder:"Optional"})]})]}),Z&&a.jsxs("div",{className:"ui-banner text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Skipped columns"}),a.jsxs("div",{className:"mt-1 space-y-1 text-muted",children:[$.map(I=>a.jsxs("div",{children:[I.name,": ",I.reason]},I.name)),n.length>$.length&&a.jsxs("div",{children:["+",n.length-$.length," more"]})]})]}),m&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:m})]}),a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-border",children:[a.jsx("div",{className:"text-xs text-muted",children:R?`Metric: ${R.metric}`:"Metric: cosine"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:o,disabled:E,children:"Cancel"}),a.jsx("button",{className:"btn btn-sm btn-active",onClick:B,disabled:E||!t.length,children:E?"Searching...":"Find similar"})]})]})]})})}const BE=/^[\/@a-zA-Z0-9._\-\/]{1,512}$/,UE=[".jpg",".jpeg",".png",".webp"];function Rt(e){try{const t=decodeURI(e||""),r=(t.startsWith("/")?t:`/${t}`).replace(/\/{2,}/g,"/"),s=r.length>1?r.replace(/\/$/,""):r;return BE.test(s)?s:"/"}catch{return"/"}}function Hm(){return(window.location.hash||"").replace(/^#/,"")}function Dx(e){const t=Rt(e),n=`#${encodeURI(t)}`;window.location.hash!==n&&(window.location.hash=n)}function Ql(e){const t=Rt(e),n=`#${encodeURI(t)}`;if(window.location.hash!==n){const r=`${window.location.pathname}${window.location.search}${n}`;window.history.replaceState(window.history.state,"",r)}}function VE(e){const n=Rt(e).toLowerCase();return UE.some(r=>n.endsWith(r))}function zx(e,t){const n=e.replace(/\/+$/,""),r=t.replace(/^\/+/,""),s=[n,r].filter(Boolean).join("/");return s.startsWith("/")?s:`/${s}`}function Qm(e){const n=Rt(e).split("/").filter(Boolean);return n.length<=1?"/":"/"+n.slice(0,-1).join("/")}function mh(e){return Rt(e).split("/").filter(Boolean).pop()||""}function WE(e){return e.endsWith("/_trash_")}const HE=new Set([0,1,2,3,4,5]),gh=new Set(["<","<=",">",">="]),QE=/^\d{4}-\d{2}-\d{2}$/;function KE(e,t){return!t||!t.and.length?e:e.filter(n=>GE(n,t.and))}function GE(e,t){for(const n of t)if(!qE(e,n))return!1;return!0}function qE(e,t){var n,r,s,i,o,l,c;if("stars"in t){const d=t.stars;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsIn"in t){const d=t.starsIn.values;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsNotIn"in t){const d=t.starsNotIn.values;if(!d||!d.length)return!0;const f=e.star??0;return!d.includes(f)}if("nameContains"in t){const d=(n=t.nameContains.value)==null?void 0:n.trim();return d?(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("nameNotContains"in t){const d=(r=t.nameNotContains.value)==null?void 0:r.trim();return d?!(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("commentsContains"in t){const d=(s=t.commentsContains.value)==null?void 0:s.trim();if(!d)return!0;const f=e.comments??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("commentsNotContains"in t){const d=(i=t.commentsNotContains.value)==null?void 0:i.trim();if(!d)return!0;const f=e.comments??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("urlContains"in t){const d=(o=t.urlContains.value)==null?void 0:o.trim();if(!d)return!0;const f=e.source??e.url??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("urlNotContains"in t){const d=(l=t.urlNotContains.value)==null?void 0:l.trim();if(!d)return!0;const f=e.source??e.url??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("dateRange"in t){const{from:d,to:f}=t.dateRange;if(!d&&!f)return!0;if(!e.addedAt)return!1;const p=Date.parse(e.addedAt);if(Number.isNaN(p))return!1;const h=qm(d,!1),w=qm(f,!0);return!(h!=null&&p<h||w!=null&&p>w)}if("widthCompare"in t){const{op:d,value:f}=t.widthCompare;if(!Number.isFinite(f))return!0;const p=e.w;return!Number.isFinite(p)||p<=0?!1:Ym(p,d,f)}if("heightCompare"in t){const{op:d,value:f}=t.heightCompare;if(!Number.isFinite(f))return!0;const p=e.h;return!Number.isFinite(p)||p<=0?!1:Ym(p,d,f)}if("metricRange"in t){const{key:d,min:f,max:p}=t.metricRange,h=(c=e.metrics)==null?void 0:c[d];return!(h==null||h<f||h>p)}return!0}function nf(e){if(!e||typeof e!="object")return null;const t=e.and;if(!Array.isArray(t))return null;const n=[];for(const r of t){const s=cN(r);s&&n.push(s)}return{and:n}}function Km(e){var r;const t=e.and.find(s=>"stars"in s),n=e.and.find(s=>"starsIn"in s);return(r=n==null?void 0:n.starsIn)!=null&&r.values?n.starsIn.values:(t==null?void 0:t.stars)??[]}function Tc(e,t){return $x(e,t)}function YE(e){var n;const t=e.and.find(r=>"starsIn"in r);return((n=t==null?void 0:t.starsIn)==null?void 0:n.values)??[]}function $x(e,t){const n=Eo(t),r=e.and.filter(s=>!("starsIn"in s)&&!("stars"in s));return n.length?{and:[{starsIn:{values:n}},...r]}:{and:r}}function XE(e){var n;const t=e.and.find(r=>"starsNotIn"in r);return((n=t==null?void 0:t.starsNotIn)==null?void 0:n.values)??[]}function Bx(e,t){const n=Eo(t),r=e.and.filter(s=>!("starsNotIn"in s));return n.length?{and:[{starsNotIn:{values:n}},...r]}:{and:r}}function JE(e){var n;const t=e.and.find(r=>"nameContains"in r);return((n=t==null?void 0:t.nameContains)==null?void 0:n.value)??null}function Ux(e,t){const n=mn(t),r=e.and.filter(s=>!("nameContains"in s));return n?{and:[{nameContains:{value:n}},...r]}:{and:r}}function ZE(e){var n;const t=e.and.find(r=>"nameNotContains"in r);return((n=t==null?void 0:t.nameNotContains)==null?void 0:n.value)??null}function Vx(e,t){const n=mn(t),r=e.and.filter(s=>!("nameNotContains"in s));return n?{and:[{nameNotContains:{value:n}},...r]}:{and:r}}function eN(e){var n;const t=e.and.find(r=>"commentsContains"in r);return((n=t==null?void 0:t.commentsContains)==null?void 0:n.value)??null}function Wx(e,t){const n=mn(t),r=e.and.filter(s=>!("commentsContains"in s));return n?{and:[{commentsContains:{value:n}},...r]}:{and:r}}function tN(e){var n;const t=e.and.find(r=>"commentsNotContains"in r);return((n=t==null?void 0:t.commentsNotContains)==null?void 0:n.value)??null}function Hx(e,t){const n=mn(t),r=e.and.filter(s=>!("commentsNotContains"in s));return n?{and:[{commentsNotContains:{value:n}},...r]}:{and:r}}function nN(e){var n;const t=e.and.find(r=>"urlContains"in r);return((n=t==null?void 0:t.urlContains)==null?void 0:n.value)??null}function Qx(e,t){const n=mn(t),r=e.and.filter(s=>!("urlContains"in s));return n?{and:[{urlContains:{value:n}},...r]}:{and:r}}function rN(e){var n;const t=e.and.find(r=>"urlNotContains"in r);return((n=t==null?void 0:t.urlNotContains)==null?void 0:n.value)??null}function Kx(e,t){const n=mn(t),r=e.and.filter(s=>!("urlNotContains"in s));return n?{and:[{urlNotContains:{value:n}},...r]}:{and:r}}function sN(e){const t=e.and.find(n=>"dateRange"in n);return(t==null?void 0:t.dateRange)??null}function rf(e,t){const n=eu((t==null?void 0:t.from)??null),r=eu((t==null?void 0:t.to)??null),s=e.and.filter(i=>!("dateRange"in i));return!n&&!r?{and:s}:{and:[{dateRange:{...n?{from:n}:{},...r?{to:r}:{}}},...s]}}function iN(e){const t=e.and.find(n=>"widthCompare"in n);return(t==null?void 0:t.widthCompare)??null}function ga(e,t){const n=e.and.filter(r=>!("widthCompare"in r));return!t||!Number.isFinite(t.value)||!gh.has(t.op)?{and:n}:{and:[{widthCompare:{op:t.op,value:t.value}},...n]}}function oN(e){const t=e.and.find(n=>"heightCompare"in n);return(t==null?void 0:t.heightCompare)??null}function va(e,t){const n=e.and.filter(r=>!("heightCompare"in r));return!t||!Number.isFinite(t.value)||!gh.has(t.op)?{and:n}:{and:[{heightCompare:{op:t.op,value:t.value}},...n]}}function lN(e,t){const n=e.and.find(r=>"metricRange"in r&&r.metricRange.key===t);return(n==null?void 0:n.metricRange)??null}function aN(e,t,n){const r=e.and.filter(s=>!("metricRange"in s&&s.metricRange.key===t));return n?{and:[{metricRange:{key:t,min:n.min,max:n.max}},...r]}:{and:r}}function uN(e){const t=nf(e);return t?t.and.length:0}function cN(e){var t,n,r,s,i,o,l,c;if(!e||typeof e!="object")return null;if("stars"in e){const d=Eo(e.stars);return d.length?{starsIn:{values:d}}:null}if("starsIn"in e){const d=Eo((t=e.starsIn)==null?void 0:t.values);return d.length?{starsIn:{values:d}}:null}if("starsNotIn"in e){const d=Eo((n=e.starsNotIn)==null?void 0:n.values);return d.length?{starsNotIn:{values:d}}:null}if("nameContains"in e){const d=mn((r=e.nameContains)==null?void 0:r.value);return d?{nameContains:{value:d}}:null}if("nameNotContains"in e){const d=mn((s=e.nameNotContains)==null?void 0:s.value);return d?{nameNotContains:{value:d}}:null}if("commentsContains"in e){const d=mn((i=e.commentsContains)==null?void 0:i.value);return d?{commentsContains:{value:d}}:null}if("commentsNotContains"in e){const d=mn((o=e.commentsNotContains)==null?void 0:o.value);return d?{commentsNotContains:{value:d}}:null}if("urlContains"in e){const d=mn((l=e.urlContains)==null?void 0:l.value);return d?{urlContains:{value:d}}:null}if("urlNotContains"in e){const d=mn((c=e.urlNotContains)==null?void 0:c.value);return d?{urlNotContains:{value:d}}:null}if("dateRange"in e){const d=e.dateRange,f=eu((d==null?void 0:d.from)??null),p=eu((d==null?void 0:d.to)??null);return!f&&!p?null:{dateRange:{...f?{from:f}:{},...p?{to:p}:{}}}}if("widthCompare"in e){const d=e.widthCompare,f=Gm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{widthCompare:f}:null}if("heightCompare"in e){const d=e.heightCompare,f=Gm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{heightCompare:f}:null}if("metricRange"in e){const d=e.metricRange;if(!d||typeof d!="object")return null;const f=typeof d.key=="string"?d.key:"",p=sf(d.min),h=sf(d.max);return!f||p==null||h==null||p>h?null:{metricRange:{key:f,min:p,max:h}}}return null}function Eo(e){if(!Array.isArray(e))return[];const t=[],n=new Set;for(const r of e){const s=typeof r=="number"?r:typeof r=="string"?Number(r):NaN;!Number.isInteger(s)||!HE.has(s)||n.has(s)||(n.add(s),t.push(s))}return t}function mn(e){if(typeof e!="string")return null;const t=e.trim();return t||null}function eu(e){if(typeof e!="string")return null;const t=e.trim();if(!t)return null;const n=Date.parse(t);return Number.isNaN(n)?null:t}function Gm(e,t){if(typeof e!="string"||!gh.has(e))return null;const n=sf(t);return n==null?null:{op:e,value:n}}function qm(e,t){if(!e)return null;const n=e.trim();if(!n)return null;const r=Date.parse(n);return Number.isNaN(r)?null:t&&QE.test(n)?r+24*60*60*1e3-1:r}function Ym(e,t,n){switch(t){case"<":return e<n;case"<=":return e<=n;case">":return e>n;case">=":return e>=n;default:return!0}}function sf(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null}const hs={leftFolders:"leftW.folders",leftMetrics:"leftW.metrics",leftLegacy:"leftW",right:"rightW"},Xm=200,Jm=240,Gx=200;function dN(e){return Number.isFinite(e)&&e>0}function Kl(e){const t=Number(e);return dN(t)?t:null}function qx(e,t,n){return Math.min(Math.max(e,t),n)}function fN(e){return e==="metrics"?hs.leftMetrics:hs.leftFolders}function hN(e){const t=Kl(e.getItem(hs.leftFolders))??Kl(e.getItem(hs.leftLegacy)),n=Kl(e.getItem(hs.leftMetrics)),r=Kl(e.getItem(hs.right));return{leftFoldersW:t,leftMetricsW:n,rightW:r}}function Zm(e,t,n){e.setItem(t,String(n))}function pN({clientX:e,appLeft:t,appWidth:n,rightWidth:r}){const s=e-t,i=Math.max(Xm,n-r-Gx);return qx(s,Xm,i)}function mN({clientX:e,appLeft:t,appWidth:n,leftWidth:r}){const s=e-t,i=n-s,o=Math.max(Jm,n-r-Gx);return qx(i,Jm,o)}function gN(e){return(e.pointerType??"mouse")==="mouse"&&e.button!==0}function vN(e,t){try{e.setPointerCapture(t)}catch{}}function yN(e,t){try{e.releasePointerCapture(t)}catch{}}function xN(e,t){const[n,r]=u.useState(240),[s,i]=u.useState(320),[o,l]=u.useState(240),c=t==="metrics"?s:n,d=u.useRef(c),f=u.useRef(o);u.useEffect(()=>{d.current=c},[c]),u.useEffect(()=>{f.current=o},[o]),u.useEffect(()=>{try{const x=hN(window.localStorage);x.leftFoldersW!==null&&r(x.leftFoldersW),x.leftMetricsW!==null&&i(x.leftMetricsW),x.rightW!==null&&l(x.rightW)}catch{}},[]);const p=(x,S,C)=>{if(gN(x))return;x.preventDefault();const v=x.currentTarget,g=x.pointerId;vN(v,g);const y=E=>{E.pointerId===g&&S(E)};function m(){window.removeEventListener("pointermove",y),window.removeEventListener("pointerup",b),window.removeEventListener("pointercancel",b),yN(v,g)}function b(E){E.pointerId===g&&(m(),C())}window.addEventListener("pointermove",y),window.addEventListener("pointerup",b),window.addEventListener("pointercancel",b)};return{leftW:c,rightW:o,onResizeLeft:x=>{const S=e.current;if(!S)return;const C=S.getBoundingClientRect(),v=fN(t);let g=d.current;p(x,y=>{const m=pN({clientX:y.clientX,appLeft:C.left,appWidth:C.width,rightWidth:f.current});g=m,t==="metrics"?i(m):r(m)},()=>{try{Zm(window.localStorage,v,g)}catch{}})},onResizeRight:x=>{const S=e.current;if(!S)return;const C=S.getBoundingClientRect();let v=f.current;p(x,g=>{const y=mN({clientX:g.clientX,appLeft:C.left,appWidth:C.width,leftWidth:d.current});v=y,f.current=y,l(y)},()=>{try{Zm(window.localStorage,hs.right,v)}catch{}})}}}const Yx=1,ya=200,wN=5*6e4,SN=6e4,Xx=(e,t)=>t!=null&&t.recursive?["folder",e,"recursive",t.page??Yx,t.pageSize??ya]:["folder",e];function Jx(e){return e[0]!=="folder"||e[2]!=="recursive"||typeof e[1]!="string"||typeof e[3]!="number"||typeof e[4]!="number"?null:e}function bN(e){return Jx(e)!==null}function CN(e,t,n=!0){if(!bN(e))return!0;const r=Jx(e);if(r==null)return!1;const[,s,,i]=r;return i!==Yx?!1:!!(s===t||n&&s==="/")}function kN(e,t,n=!0){return!Array.isArray(e)||e[0]!=="folder"?!1:!CN(e,t,n)}const EN=15e3;function NN(e,t){return ge.getFolder(e,t)}function of(e,t=!1,n){const r=Cu(),s={recursive:t,page:n==null?void 0:n.page,pageSize:n==null?void 0:n.pageSize},i=!!s.recursive;return xu({queryKey:Xx(e,s),queryFn:()=>NN(e,s),enabled:(n==null?void 0:n.enabled)??!0,staleTime:1e4,gcTime:i?SN:wN,retry:2,retryDelay:o=>Math.min(1e3*Math.pow(2,o),5e3),refetchOnWindowFocus:!1,refetchInterval:r?EN:!1,refetchIntervalInBackground:r})}const Zx="application/x-lenslet-paths",MN='[role="treeitem"].drop-target';function eg(e){var n;return Array.from(((n=e.dataTransfer)==null?void 0:n.types)||[]).includes(Zx)}function jN(e){document.querySelectorAll(MN).forEach(t=>{t!==e&&t.classList.remove("drop-target")})}function tg(e){jN(e),e.classList.add("drop-target")}function ng(e){return e.startsWith("/")?e:`/${e}`}function PN({path:e,isLeaf:t}){const n=mr(),r=u.useCallback(l=>{eg(l)&&(l.preventDefault(),t&&tg(l.currentTarget))},[t]),s=u.useCallback(l=>{!t||!eg(l)||(l.preventDefault(),tg(l.currentTarget))},[t]),i=u.useCallback(l=>{const c=l.currentTarget,d=document.elementFromPoint(l.clientX,l.clientY);d&&c.contains(d)||c.classList.remove("drop-target")},[]),o=u.useCallback(async l=>{const c=l.dataTransfer;if(!c)return;l.preventDefault(),l.currentTarget.classList.remove("drop-target");const d=c.getData(Zx),p=(d?JSON.parse(d):[]).filter(Boolean);if(!p.length)return;let h=p[0].split("/").slice(0,-1).join("/")||"/";h=ng(h);const w=ng(e);try{for(const x of p)await ge.moveFile(x,w);n.invalidateQueries({queryKey:["folder",h]}),n.invalidateQueries({queryKey:["folder",w]}),n.setQueryData(["folder",h],x=>!x||!Array.isArray(x.items)?x:{...x,items:x.items.filter(S=>!p.includes(S.path))})}catch{}},[e,n]);return{onDragOver:r,onDragEnter:s,onDragLeave:i,onDrop:o}}const RN='[role="tree"] [role="treeitem"]';function TN(){return Array.from(document.querySelectorAll(RN))}function IN(e,t){var i;const n=TN(),r=n.findIndex(o=>o===e);if(r===-1)return;let s=r;t==="ArrowDown"?s=Math.min(n.length-1,r+1):t==="ArrowUp"?s=Math.max(0,r-1):t==="Home"?s=0:t==="End"&&(s=n.length-1),(i=n[s])==null||i.focus()}function LN({path:e,isLeaf:t,isExpanded:n,setExpanded:r,onOpen:s}){return u.useCallback(i=>{if(i.key==="Enter"){i.preventDefault(),s(e);return}if(i.key==="ArrowRight"){!t&&!n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.add(e),l}));return}if(i.key==="ArrowLeft"){!t&&n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.delete(e),l}));return}(i.key==="ArrowDown"||i.key==="ArrowUp"||i.key==="Home"||i.key==="End")&&(i.preventDefault(),IN(i.currentTarget,i.key))},[e,t,n,r,s])}const rg=64,_N=120;function AN(e){const t=e.split("/").filter(Boolean),n=["/"];let r="";for(const s of t)r=r?`${r}/${s}`:`/${s}`,n.push(r);return n}function FN({current:e,roots:t,data:n,onOpen:r,onPullRefresh:s,onResize:i,onContextMenu:o,onOpenActions:l,countVersion:c,className:d,showResizeHandle:f=!0}){const[p,h]=u.useState(new Set(["/"])),w=u.useRef(new Map),x=u.useRef(new Map),[S,C]=u.useState(!1),[v,g]=u.useState(0),y=u.useRef(null),m=u.useRef(!1),b=mr(),E=u.useCallback(()=>{g(0),y.current=null,m.current=!1},[]),j=u.useCallback(async T=>{const P=Rt(T||"/"),_=w.current,O=x.current,q=_.get(P);if(q!==void 0)return q;const U=b.getQueryData(Xx(P,{recursive:!0}));if(U){const X=U.totalItems??U.items.length;return _.set(P,X),X}const A=O.get(P);if(A)return A;const K=(async()=>{try{const X=await ge.getFolder(P,{recursive:!0}),te=X.totalItems??X.items.length;return _.set(P,te),te}finally{O.delete(P)}})();return O.set(P,K),K},[b]);u.useEffect(()=>{w.current.clear(),x.current.clear()},[c]),u.useEffect(()=>{const T=AN(e);h(P=>{const _=new Set(P);for(const O of T)_.add(O);return _})},[e]);const M=u.useCallback(async()=>{if(!(!s||S)){C(!0);try{await s()}catch(T){console.error("Failed to refresh folders:",T)}finally{C(!1),g(0)}}},[s,S]),L=u.useCallback(T=>{!s||S||T.touches.length===1&&(T.currentTarget.scrollTop>0||(y.current=T.touches[0].clientY,m.current=!1))},[s,S]),R=u.useCallback(T=>{if(!s||S||T.touches.length!==1)return;const P=y.current;if(P==null)return;if(T.currentTarget.scrollTop>0){E();return}const _=T.touches[0].clientY-P;if(_<=0){m.current&&g(0);return}!m.current&&_<8||(m.current=!0,T.preventDefault(),g(Math.min(_N,_*.55)))},[S,s,E]),B=u.useCallback(()=>{if(!s||S){E();return}const T=m.current&&v>=rg;if(y.current=null,m.current=!1,T){M();return}g(0)},[M,S,s,v,E]),F=d??"h-full overflow-auto bg-panel scrollbar-thin",G=s?`${F} overscroll-y-contain`:F,Z=!!s&&(S||v>0),$=v>=rg,I=S?28:Math.min(44,v);return a.jsxs("div",{className:G,onTouchStart:s?L:void 0,onTouchMove:s?R:void 0,onTouchEnd:s?B:void 0,onTouchCancel:s?B:void 0,children:[Z&&a.jsx("div",{className:"flex items-end justify-center text-[11px] text-muted select-none transition-[height,opacity] duration-150",style:{height:I,opacity:S||v>8?1:.65},"aria-live":"polite",children:S?"Refreshing":$?"Release to refresh":"Pull to refresh"}),a.jsx("div",{className:"p-1",role:"tree","aria-label":"Folders",children:t.map(T=>a.jsx(e0,{path:T.path,label:T.label,depth:0,current:e,expanded:p,setExpanded:h,onOpen:r,onContextMenu:o,onOpenActions:l,initial:n,getSubtreeCount:j,countVersion:c},T.path))}),f&&a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 left-[calc(var(--left)-6px)]",onPointerDown:i})]})}function e0({path:e,label:t,depth:n,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:c,initial:d,getSubtreeCount:f,countVersion:p}){var F;const h=s.has(e),w=r===e,x=e==="/"||h||w,{data:S}=of(e,!1,{enabled:x}),C=d&&e===d.path?d:S,g=!!C?C.dirs.length===0:!1,[y,m]=u.useState(C?C.items.length:null),b=LN({path:e,isLeaf:g,isExpanded:h,setExpanded:i,onOpen:o}),{onDragOver:E,onDragEnter:j,onDragLeave:M,onDrop:L}=PN({path:e,isLeaf:g}),R=G=>{G.stopPropagation(),!g&&i(Z=>{const $=new Set(Z);return $.has(e)?$.delete(e):$.add(e),$})},B=G=>{if(G.stopPropagation(),!c)return;const Z=G.currentTarget.getBoundingClientRect();c(e,{x:Z.right-4,y:Z.bottom-4})};return u.useEffect(()=>{let G=!1;if(!C){m(null);return}if(m(C.items.length),!!(h&&(n>0||w)))return f(e).then($=>{G||m($)}).catch($=>{G||console.warn(`Failed to compute subtree count for ${e}:`,$)}),()=>{G=!0}},[C,e,f,p,h,n,w]),a.jsxs("div",{children:[a.jsxs("div",{className:`tree-row flex items-center gap-1.5 py-1 px-2 rounded-md cursor-pointer min-h-[40px] outline-none transition-colors duration-75 ${w?"bg-accent/20 text-accent font-medium":"hover:bg-white/5 text-text"}`,role:"treeitem","aria-level":n+1,"aria-expanded":g?void 0:h,"aria-selected":w,tabIndex:w?0:-1,style:{paddingLeft:8+n*14},onClick:()=>o(e),onContextMenu:G=>{G.preventDefault(),G.stopPropagation(),l==null||l(G,e)},onKeyDown:b,onDragOver:E,onDragEnter:j,onDragLeave:M,onDrop:L,children:[a.jsx("button",{type:"button",className:"tree-expand-btn touch-manipulation",onClick:R,"aria-label":g?`No subfolders in ${t}`:`${h?"Collapse":"Expand"} ${t}`,"aria-expanded":g?void 0:h,disabled:g,children:g?"":h?"":""}),a.jsx("span",{className:"flex-1 overflow-hidden truncate text-sm",title:t,children:zk(t,28)}),y!==null&&a.jsx("span",{className:"text-[10px] opacity-50 bg-white/5 border border-white/5 rounded px-1.5 min-w-[24px] text-center",children:y}),c&&a.jsx("button",{type:"button",className:"tree-row-action-btn touch-manipulation","aria-label":`Open actions for ${t}`,"aria-haspopup":"menu",onPointerDown:G=>G.stopPropagation(),onClick:B,children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]}),h&&((F=C==null?void 0:C.dirs)==null?void 0:F.map(G=>a.jsx(e0,{path:zx(e,G.name),label:G.name,depth:n+1,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:c,getSubtreeCount:f,countVersion:p},G.name)))]})}const sg=[5,4,3,2,1],ig=["<","<=",">",">="];function ON({filters:e,onChangeFilters:t}){const n=u.useMemo(()=>YE(e),[e]),r=u.useMemo(()=>XE(e),[e]),s=u.useMemo(()=>JE(e)??"",[e]),i=u.useMemo(()=>ZE(e)??"",[e]),o=u.useMemo(()=>eN(e)??"",[e]),l=u.useMemo(()=>tN(e)??"",[e]),c=u.useMemo(()=>nN(e)??"",[e]),d=u.useMemo(()=>rN(e)??"",[e]),f=u.useMemo(()=>sN(e)??{},[e]),p=u.useMemo(()=>og(f.from),[f.from]),h=u.useMemo(()=>og(f.to),[f.to]),w=u.useMemo(()=>iN(e),[e]),x=u.useMemo(()=>oN(e),[e]),[S,C]=u.useState((w==null?void 0:w.op)??">="),[v,g]=u.useState((x==null?void 0:x.op)??">=");u.useEffect(()=>{w!=null&&w.op&&C(w.op)},[w==null?void 0:w.op]),u.useEffect(()=>{x!=null&&x.op&&g(x.op)},[x==null?void 0:x.op]);const y=(m,b)=>{const E=new Set(n),j=new Set(r);m==="include"?E.has(b)?E.delete(b):(E.add(b),j.delete(b)):j.has(b)?j.delete(b):(j.add(b),E.delete(b));let M=$x(e,Array.from(E));M=Bx(M,Array.from(j)),t(M)};return a.jsxs("div",{className:"ui-card",children:[a.jsx("div",{className:"ui-section-title mb-3",children:"Attributes"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Rating"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Include"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[sg.map(m=>{const b=n.includes(m);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${b?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>y("include",m),"aria-pressed":b,title:`Include ${m} star${m>1?"s":""}`,children:[m,""]},`stars-in-${m}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${n.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>y("include",0),"aria-pressed":n.includes(0),title:"Include unrated",children:"None"})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Exclude"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[sg.map(m=>{const b=r.includes(m);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${b?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>y("exclude",m),"aria-pressed":b,title:`Exclude ${m} star${m>1?"s":""}`,children:[m,""]},`stars-out-${m}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${r.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>y("exclude",0),"aria-pressed":r.includes(0),title:"Exclude unrated",children:"None"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Filename"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:s,placeholder:"e.g. draft",onChange:m=>t(Ux(e,m.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:i,placeholder:"e.g. v1",onChange:m=>t(Vx(e,m.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Comments"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:o,placeholder:"e.g. hero",onChange:m=>t(Wx(e,m.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:l,placeholder:"e.g. todo",onChange:m=>t(Hx(e,m.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"URL"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:c,placeholder:"e.g. s3://bucket",onChange:m=>t(Qx(e,m.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:d,placeholder:"e.g. http://",onChange:m=>t(Kx(e,m.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Date Added"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"From"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:p,onChange:m=>t(rf(e,{from:m.target.value||null,to:f.to??null}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"To"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:h,onChange:m=>t(rf(e,{from:f.from??null,to:m.target.value||null}))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Dimensions"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Width"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:S,onChange:m=>{const b=m.target.value;C(b),w&&t(ga(e,{op:b,value:w.value}))},children:ig.map(m=>a.jsx("option",{value:m,children:m},`w-${m}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:w?String(w.value):"",min:0,placeholder:"px",onChange:m=>{const b=m.target.value;if(!b){t(ga(e,null));return}const E=Number(b);Number.isFinite(E)&&t(ga(e,{op:S,value:E}))}})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Height"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:v,onChange:m=>{const b=m.target.value;g(b),x&&t(va(e,{op:b,value:x.value}))},children:ig.map(m=>a.jsx("option",{value:m,children:m},`h-${m}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:x?String(x.value):"",min:0,placeholder:"px",onChange:m=>{const b=m.target.value;if(!b){t(va(e,null));return}const E=Number(b);Number.isFinite(E)&&t(va(e,{op:v,value:E}))}})]})]})]})]})]})]})}function og(e){return e?e.length>=10?e.slice(0,10):e:""}const DN=[];function lf(e,t){if(t!=null&&t.length)return zN(e,t);const n=new Map;for(const r of e){const s=r.metrics;if(s)for(const[i,o]of Object.entries(s)){if(o==null||Number.isNaN(o))continue;const l=n.get(i);l?l.push(o):n.set(i,[o])}}return n}function zN(e,t){const n=t.map(s=>({key:s,values:[]}));for(const s of e){const i=s.metrics;if(i)for(const o of n){const l=i[o.key];l==null||Number.isNaN(l)||o.values.push(l)}}const r=new Map;for(const s of n)s.values.length&&r.set(s.key,s.values);return r}function Qs(e,t){return e.get(t)??DN}function Ic(e,t,n){if(!e.length)return null;const r=n?n.min:Math.min(...e);let s=n?n.max:Math.max(...e);r===s&&(s=r+1);const i=new Array(t).fill(0),o=t/(s-r);for(const l of e){const c=Math.max(0,Math.min(t-1,Math.floor((l-r)*o)));i[c]+=1}return{bins:i,min:r,max:s,count:e.length}}function t0(e,t){return e<t?{min:e,max:t}:{min:t,max:e}}function en(e){return jx(e)}function br(e){if(!Number.isFinite(e))return"";const t=e.toString();return t.includes("e")?e.toFixed(6):t}function lg(e){const t=e.trim();if(!t)return{value:null,valid:!0};const n=Number(t);return Number.isFinite(n)?{value:n,valid:!0}:{value:null,valid:!1}}function ag(e,t,n){return e<t?t:e>n?n:e}function vh(e){return e<0?0:e>1?1:e}function Ks(e,t){const n=Math.max(1,Math.abs(e),Math.abs(t));return Math.abs(e-t)<=1e-6*n}function $N(e,t,n){const r=vh((e-t.left)/t.width);return n.min+(n.max-n.min)*r}function BN(e,t,n=4){return e==null?!1:Math.abs(t-e)>=n}function n0(e,t){return t0(e??t,t)}function UN(e,t,n,r){return e&&t!=null?{commitRange:n0(n,t),shouldClear:!1}:{commitRange:null,shouldClear:r!=null}}function VN({metricKey:e,domain:t,activeRange:n,onChangeRange:r}){const[s,i]=u.useState(null),[o,l]=u.useState(!1),c=u.useRef(null),d=u.useRef(null),f=u.useRef(!1),p=u.useRef(null),[h,w]=u.useState(null),x=s??n;u.useEffect(()=>{w(null)},[e,t==null?void 0:t.min,t==null?void 0:t.max]);const S=y=>{var b;if(!t)return null;const m=(b=p.current)==null?void 0:b.getBoundingClientRect();return m?$N(y,{left:m.left,width:m.width},t):null};return{svgRef:p,hoverValue:h,displayRange:x,onPointerDown:y=>{var b;if(!t)return;y.preventDefault();const m=S(y.clientX);m!=null&&(l(!0),i(null),c.current=m,d.current=y.clientX,f.current=!1,w(m),(b=p.current)==null||b.setPointerCapture(y.pointerId))},onPointerMove:y=>{const m=S(y.clientX);if(m==null){o||w(null);return}w(m),o&&(!f.current&&!BN(d.current,y.clientX)||(f.current=!0,i(n0(c.current,m))))},onPointerUp:y=>{var E;if(!o)return;l(!1),(E=p.current)==null||E.releasePointerCapture(y.pointerId);const m=S(y.clientX),b=UN(f.current,m,c.current,n);b.commitRange?(w(m),r(b.commitRange)):b.shouldClear&&r(null),c.current=null,d.current=null,f.current=!1,setTimeout(()=>i(null),0)},onPointerLeave:()=>w(null)}}const ps=40;function ug({metricKey:e,populationValues:t,filteredValues:n,selectedValues:r=[],filters:s,onChangeRange:i,showTitle:o=!1}){const l=u.useMemo(()=>Ic(t,ps),[t]),c=u.useMemo(()=>l?Ic(n,ps,l):null,[n,l]),d=lN(s,e),f=l?{min:l.min,max:l.max}:null,{svgRef:p,hoverValue:h,displayRange:w,onPointerDown:x,onPointerMove:S,onPointerUp:C,onPointerLeave:v}=VN({metricKey:e,domain:f,activeRange:d,onChangeRange:F=>i(e,F)}),[g,y]=u.useState(""),[m,b]=u.useState(""),[E,j]=u.useState(null),M=r.length===1?r[0]:null,L=u.useMemo(()=>!l||r.length<2?null:Ic(r,ps,l),[r,l]);u.useEffect(()=>{if(!d||!f){E!=="min"&&y(d?br(d.min):""),E!=="max"&&b(d?br(d.max):"");return}if(E!=="min"){const F=Ks(d.min,f.min)?"":br(d.min);y(F)}if(E!=="max"){const F=Ks(d.max,f.max)?"":br(d.max);b(F)}},[d,f,E]);const R=(F,G)=>{if(!f)return;const Z=lg(F),$=lg(G);if(!Z.valid||!$.valid){Z.valid||y(d?br(d.min):""),$.valid||b(d?br(d.max):"");return}if(Z.value==null&&$.value==null){i(e,null);return}const I=Z.value??f.min,T=$.value??f.max,P=ag(I,f.min,f.max),_=ag(T,f.min,f.max),O=t0(P,_);if(Ks(O.min,f.min)&&Ks(O.max,f.max)){i(e,null);return}i(e,O)};if(!l||!f)return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]});const B=r.length;return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mb-2 tabular-nums",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{children:["Population: ",l.count]}),a.jsxs("span",{children:["Filtered: ",(c==null?void 0:c.count)??0]}),B>1&&a.jsxs("span",{className:"text-text",children:["Selected: ",B]})]}),M!=null&&a.jsxs("span",{className:"text-text",children:["Selected: ",en(M)]})]}),a.jsxs("svg",{ref:p,viewBox:`0 0 ${ps} 100`,preserveAspectRatio:"none",className:"w-full h-28 cursor-crosshair rounded-md bg-surface-inset",onPointerDown:x,onPointerMove:S,onPointerUp:C,onPointerLeave:v,children:[Lc(l.bins,"#2e3a4b"),c&&Lc(c.bins,"#3a8fff"),L&&Lc(L.bins,"#f59e0b",{opacity:.55}),w&&WN(w,f),M!=null&&cg(M,f,{color:"var(--highlight)",strokeWidth:.7}),h!=null&&cg(h,f,{color:"rgba(255,255,255,0.75)",strokeWidth:.5,dashed:!0})]}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mt-2 tabular-nums",children:[a.jsx("span",{children:en(f.min)}),a.jsxs("div",{className:"flex flex-col items-center text-center leading-tight",children:[w?a.jsx("span",{className:"text-text",children:Ks(w.min,f.min)?` ${en(w.max)}`:Ks(w.max,f.max)?` ${en(w.min)}`:`${en(w.min)}  ${en(w.max)}`}):h!=null?a.jsxs("span",{className:"text-text",children:["Cursor: ",en(h)]}):a.jsx("span",{children:"Drag to filter"}),w&&h!=null&&a.jsxs("span",{className:"text-[11px] text-muted",children:["Cursor: ",en(h)]})]}),a.jsx("span",{children:en(f.max)})]}),a.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2 mt-3 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Min"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:g,placeholder:br(f.min),onFocus:()=>j("min"),onBlur:()=>{j(null),R(g,m)},onChange:F=>y(F.target.value),onKeyDown:F=>{F.key==="Enter"&&F.currentTarget.blur()}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Max"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:m,placeholder:br(f.max),onFocus:()=>j("max"),onBlur:()=>{j(null),R(g,m)},onChange:F=>b(F.target.value),onKeyDown:F=>{F.key==="Enter"&&F.currentTarget.blur()}})]}),a.jsx("button",{className:"btn btn-xs btn-ghost text-muted hover:text-text",onClick:()=>i(e,null),children:"Clear"})]})]})}function Lc(e,t,n){const r=Math.max(1,...e),s=(n==null?void 0:n.opacity)??.9;return e.map((i,o)=>{const l=i/r*100;return a.jsx("rect",{x:o+.05,y:100-l,width:.9,height:l,fill:t,opacity:s},`${t}-${o}`)})}function WN(e,t){const n=(e.min-t.min)/(t.max-t.min),r=(e.max-t.min)/(t.max-t.min),s=ps*vh(Math.min(n,r)),i=ps*Math.abs(r-n);return a.jsx("rect",{x:s,y:0,width:Math.max(.5,i),height:100,fill:"rgba(255,255,255,0.08)",stroke:"rgba(255,255,255,0.4)",strokeWidth:.4})}function cg(e,t,n){const r=vh((e-t.min)/(t.max-t.min)),s=ps*r;return a.jsx("line",{x1:s,y1:0,x2:s,y2:100,stroke:n.color,strokeWidth:n.strokeWidth??.5,strokeDasharray:n.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}const HN=new Map;function QN({items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}){const[c,d]=u.useState(!1),f=s&&n.includes(s)?s:n[0],p=u.useMemo(()=>c?n:f?[f]:[],[c,n,f]),h=u.useMemo(()=>lf(e,p),[e,p]),w=u.useMemo(()=>lf(t,p),[t,p]),x=r??HN;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("label",{className:"ui-label",children:"Metric"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-[11px]",onClick:()=>d(S=>!S),"aria-pressed":c,children:c?"Show one":"Show all"})]}),c?a.jsx("div",{className:"ui-input ui-input-readonly w-full flex items-center text-xs",children:"All metrics"}):a.jsx("select",{className:"ui-select w-full",value:f,onChange:S=>i(S.target.value),children:n.map(S=>a.jsx("option",{value:S,children:S},S))})]}),c?a.jsx("div",{className:"space-y-3",children:n.map(S=>a.jsx(ug,{metricKey:S,populationValues:Qs(h,S),filteredValues:Qs(w,S),selectedValues:Qs(x,S),filters:o,onChangeRange:l,showTitle:!0},S))}):f?a.jsx(ug,{metricKey:f,populationValues:Qs(h,f),filteredValues:Qs(w,f),selectedValues:Qs(x,f),filters:o,onChangeRange:l}):a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]})}const KN=12;function GN({items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l,onChangeFilters:c}){const d=u.useMemo(()=>r!=null&&r.length?lf(r,n):null,[r,n]),f=d&&r&&r.length?a.jsx(qN,{selectedValuesByKey:d,totalItems:r.length,metricKeys:n}):null,p=a.jsx(ON,{filters:o,onChangeFilters:c});return n.length?a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,a.jsx(QN,{items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:d,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}),p]}):a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,p,a.jsx("div",{className:"p-4 text-sm text-muted",children:"No metrics found in this dataset."})]})}function qN({selectedValuesByKey:e,totalItems:t,metricKeys:n}){const r=u.useMemo(()=>e.size?{entries:(n.length?n.filter(p=>e.has(p)):Array.from(e.keys()).sort()).map(p=>{const h=e.get(p)??[],w=Math.min(...h),x=Math.max(...h),S=h.reduce((C,v)=>C+v,0)/Math.max(1,h.length);return{key:p,value:h[0],min:w,max:x,avg:S,count:h.length}}),totalItems:t}:null,[e,n,t]);if(!r)return null;const{entries:s,totalItems:i}=r,o=s.slice(0,KN),l=s.length-o.length,c=i>1;return a.jsxs("div",{className:"ui-card",children:[a.jsxs("div",{className:"ui-card-header",children:[a.jsx("div",{className:"ui-section-title",children:"Selected metrics"}),a.jsxs("div",{className:"text-[11px] text-muted",children:[i," item",i===1?"":"s"]})]}),a.jsxs("div",{className:"space-y-1 text-[12px]",children:[o.map(d=>a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-muted w-28 shrink-0 truncate",title:d.key,children:d.key}),a.jsxs("span",{className:"font-mono text-text text-right tabular-nums",children:[c?`${en(d.min)}  ${en(d.max)}`:en(d.value),c&&a.jsxs("span",{className:"text-[11px] text-muted ml-2",children:["avg ",en(d.avg),d.count!==i?`  ${d.count}/${i}`:""]})]})]},d.key)),l>0&&a.jsxs("div",{className:"text-[11px] text-muted",children:["+",l," more"]})]})]})}const YN=[{label:"Root",path:"/"}],XN="w-11 h-11 rounded-md border border-border flex items-center justify-center transition-colors",JN="bg-accent-muted text-accent",ZN="bg-surface text-text hover:bg-surface-hover";function Gl(e){return`${XN} ${e?JN:ZN}`}function eM({leftTool:e,onToolChange:t,compareEnabled:n,compareActive:r,onOpenCompare:s,views:i,activeViewId:o,onActivateView:l,onSaveView:c,current:d,data:f,onOpenFolder:p,onOpenFolderActions:h,onPullRefreshFolders:w,onContextMenu:x,countVersion:S,items:C,filteredItems:v,metricKeys:g,selectedItems:y,selectedMetric:m,onSelectMetric:b,filters:E,onChangeRange:j,onChangeFilters:M,onResize:L}){const R=Gl(e==="folders"),B=Gl(e==="metrics"),F=Gl(r),G=`${Gl(!1)} cursor-pointer`;return a.jsxs("div",{className:"app-left-panel col-start-1 row-start-2 relative border-r border-border bg-panel overflow-visible",children:[a.jsxs("div",{className:"absolute inset-y-0 left-0 w-12 border-r border-border flex flex-col items-center gap-2 py-3 bg-surface-overlay",children:[a.jsx("button",{className:R,title:"Folders","aria-label":"Folders","aria-pressed":e==="folders",onClick:()=>t("folders"),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M3 7.5h6l2-2h10a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2z"})})}),a.jsx("button",{className:B,title:"Metrics / Filters","aria-label":"Metrics and Filters","aria-pressed":e==="metrics",onClick:()=>t("metrics"),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]})}),a.jsx("div",{className:"w-6 h-px bg-border/70 my-1"}),a.jsx("button",{className:`${F} ${n?"":"opacity-40 cursor-not-allowed"}`,title:n?"Compare selected images":"Compare (select 2+)","aria-label":"Compare selected images","aria-pressed":r,"aria-disabled":!n,disabled:!n,onClick:()=>{n&&s()},children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("rect",{x:"3",y:"4",width:"8",height:"16",rx:"1"}),a.jsx("rect",{x:"13",y:"4",width:"8",height:"16",rx:"1"})]})}),a.jsx("div",{className:"flex-1"}),a.jsx("a",{className:G,href:"https://github.com/trojblue/lenslet",title:"Lenslet on GitHub","aria-label":"Lenslet on GitHub",target:"_blank",rel:"noreferrer",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:a.jsx("path",{d:"M12 .5C5.73.5.5 5.74.5 12.02c0 5.1 3.29 9.42 7.86 10.95.58.11.79-.25.79-.56v-2.17c-3.2.7-3.88-1.55-3.88-1.55-.53-1.35-1.29-1.71-1.29-1.71-1.05-.72.08-.71.08-.71 1.16.08 1.78 1.2 1.78 1.2 1.03 1.77 2.71 1.26 3.37.96.1-.75.4-1.26.73-1.55-2.55-.29-5.23-1.29-5.23-5.74 0-1.27.45-2.31 1.19-3.13-.12-.29-.52-1.46.11-3.05 0 0 .97-.31 3.18 1.19.92-.26 1.91-.39 2.89-.39.98 0 1.97.13 2.89.39 2.2-1.5 3.18-1.19 3.18-1.19.63 1.59.23 2.76.11 3.05.74.82 1.19 1.86 1.19 3.13 0 4.46-2.69 5.45-5.25 5.73.41.36.78 1.07.78 2.16v3.2c0 .31.21.67.8.56 4.56-1.53 7.85-5.85 7.85-10.95C23.5 5.74 18.27.5 12 .5z"})})})]}),a.jsx("div",{className:"ml-12 h-full overflow-hidden",children:e==="folders"?a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-2 py-2 border-b border-border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Smart Folders"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:c,title:"Save current view as Smart Folder",children:"+ New"})]}),i.length?a.jsx("div",{className:"flex flex-col gap-1",children:i.map(Z=>{const $=Z.id===o;return a.jsx("button",{className:`text-left px-2 py-2 rounded-md text-sm ${$?"bg-accent-muted text-accent":"hover:bg-hover text-text"}`,onClick:()=>l(Z),children:Z.name},Z.id)})}):a.jsx("div",{className:"text-xs text-muted px-1 py-1.5",children:"No saved Smart Folders yet."})]}),a.jsx(FN,{current:d,roots:YN,data:f,onOpen:p,onPullRefresh:w,onContextMenu:x,onOpenActions:h,countVersion:S,className:"flex-1 min-h-0 overflow-auto scrollbar-thin",showResizeHandle:!1})]}):a.jsx(GN,{items:C,filteredItems:v,metricKeys:g,selectedItems:y,selectedMetric:m,onSelectMetric:b,filters:E,onChangeRange:j,onChangeFilters:M})}),a.jsx("div",{className:"toolbar-offset sidebar-resize-handle sidebar-resize-handle-left absolute bottom-0",onPointerDown:L})]})}function tM({persistenceEnabled:e,indexing:t=null,showSwitchToMostRecentBanner:n=!1,onSwitchToMostRecent:r,offViewSummary:s,onRevealOffView:i,canRevealOffView:o=!1,onClearOffView:l,browserZoomPercent:c}){const f=!!(s!=null&&s.names.length)&&s?` (${s.names.join(", ")}${s.extra?` +${s.extra}`:""})`:"",p=o&&i!=null,h=typeof c=="number"?c:null,w=h!==null&&Math.abs(h-100)>=2,x=(t==null?void 0:t.state)==="running",S=(t==null?void 0:t.state)==="error",C=t!=null&&t.scope&&t.scope!=="/"?` (${t.scope})`:"",v=(()=>{if(!x)return null;const m=typeof(t==null?void 0:t.done)=="number"?t.done:null,b=typeof(t==null?void 0:t.total)=="number"?t.total:null;return m===null&&b===null?null:b===null?`${m??0} indexed`:`${Math.min(m??0,b)} / ${b}`})(),g=n&&r!=null;return!e||x||S||g||w||!!s?a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-col gap-2",children:[!e&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Not persisted."})," Workspace is read-only; edits stay in memory until restart."]}),x&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Indexing in progress",C,"."]})," ",v?`${v} complete.`:"Preparing searchable index."]}),S&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Indexing failed."})," ",(t==null?void 0:t.error)||"Open server logs for details."]}),g&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center justify-between gap-3",children:[a.jsxs("span",{children:[a.jsx("span",{className:"font-semibold",children:"Indexing complete."})," ","Scan-stable ordering is active for this generation."]}),a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>r==null?void 0:r(),children:"Switch to Most recent"})]}),w&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Browser zoom ",Math.round(h),"%."]})," For best results, set it to 100% so UI elements stay in correct proportions."]}),s&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex items-center justify-between gap-3",children:[a.jsxs("span",{children:["Updates outside current view: ",s.count," item",s.count===1?"":"s",f]}),a.jsxs("div",{className:"flex items-center gap-2",children:[p&&a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>i==null?void 0:i(),"aria-label":"Reveal off-view updates",children:"Reveal"}),a.jsx("button",{className:"text-muted hover:text-text transition-colors text-base leading-none",onClick:l,"aria-label":"Clear off-view updates",children:""})]})]})]})}):null}function nM(e){return e.isOffline?"offline":e.isUnstable?"unstable":e.recentEditActive?"recent":Number.isFinite(e.editingCount)&&e.editingCount>0?"editing":"live"}const rM=6e3,sM=1e4,iM=24*60*6e4,oM=3e4,lM=350,aM=1400,r0=[-2,-1,1,2],s0=[-2,-1,0,1,2,3];r0.length;s0.length;function uM(e,t,n){return Math.min(Math.max(e,t),n)}function i0(e,t,n){const r=new Set,s=[];for(const i of n){const o=t+i;if(o<0||o>=e.length)continue;const l=e[o];!l||r.has(l)||(r.add(l),s.push(l))}return s}function cM(e,t){if(!t)return[];const n=e.indexOf(t);return n<0?[]:i0(e,n,r0)}function dM(e,t){if(e.length<2)return[];const n=Math.max(0,e.length-2),r=uM(t,0,n);return i0(e,r,s0)}function fM({paths:e,defaultDestination:t,destinations:n,loadingDestinations:r,onClose:s,onSubmit:i}){const[o,l]=u.useState(()=>Rt(t||"/")),[c,d]=u.useState(!1);u.useEffect(()=>{l(Rt(t||"/"))},[t,e]);const f=Rt(o||"/"),p=e.length>0&&!c,h=e.slice(0,3).map(C=>mh(C)||C),w=Math.max(0,e.length-h.length),x=n.filter(C=>C!==f).slice(0,8),S=async C=>{if(C.preventDefault(),!!p){d(!0);try{await i(e,f)}finally{d(!1)}}};return a.jsx("div",{className:"toolbar-offset fixed inset-0 z-overlay bg-black/45 backdrop-blur-[1px] flex items-center justify-center p-3",children:a.jsxs("div",{className:"w-full max-w-[560px] rounded-xl border border-border bg-panel shadow-[0_20px_60px_rgba(0,0,0,0.55)]",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Move to folder"}),a.jsxs("div",{className:"text-xs text-muted",children:[e.length," item(s) selected"]})]}),a.jsx("button",{type:"button",className:"btn btn-icon",onClick:s,"aria-label":"Close move dialog",disabled:c,children:""})]}),a.jsxs("form",{className:"px-4 py-3 flex flex-col gap-3",onSubmit:S,children:[a.jsxs("div",{className:"text-xs text-muted",children:[h.join(", "),w>0?` and ${w} more`:""]}),a.jsxs("label",{className:"text-xs text-muted flex flex-col gap-1.5",children:["Destination folder",a.jsx("input",{value:o,onChange:C=>l(C.target.value),className:"input w-full",list:"move-destination-list",placeholder:"/",autoFocus:!0,disabled:c})]}),a.jsx("datalist",{id:"move-destination-list",children:n.map(C=>a.jsx("option",{value:C},C))}),a.jsx("div",{className:"text-[11px] text-muted",children:r?"Loading folder list":`${n.length.toLocaleString()} destination(s) loaded`}),x.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.map(C=>a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>l(C),disabled:c,children:C},C))}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-border",children:[a.jsx("button",{type:"button",className:"btn",onClick:s,disabled:c,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-active",disabled:!p,children:c?"Moving":"Move"})]})]})]})})}function hM(e){return JSON.stringify(e,null,2)}function pM(e){const t=s=>'"'+s.replaceAll('"','""')+'"',n="path,folder,name,star,type,size,width,height,tags,notes",r=e.map(s=>{const i=(s.tags||[]).join(" "),o=s.notes||"";return[s.path,s.folder,s.name,String(s.star??""),s.type??"",s.size??"",s.width??"",s.height??"",i,o].map(l=>t(String(l))).join(",")});return[n,...r].join(`
`)}function mM(e){return e.map(t=>{const n=t.path.split("/").filter(Boolean);n.pop();const r=n.length?`/${n.join("/")}`:"/";return{path:t.path,folder:r,name:t.name,star:t.star??null,type:t.type,size:t.size,width:t.w,height:t.h}})}function gM({x:e,y:t,items:n}){const r=u.useRef(null),[s,i]=u.useState({x:e,y:t}),[o,l]=u.useState(!1),c=u.useCallback((f,p)=>{p.stopPropagation(),f.disabled||f.onClick()},[]),d=u.useCallback(()=>{const f=r.current,p=fx(),h=f==null?void 0:f.getBoundingClientRect(),w=(h==null?void 0:h.width)??180,x=(h==null?void 0:h.height)??Math.max(40,n.length*36),S=dx({x:e,y:t,menuWidth:w,menuHeight:x,viewport:p});i(C=>C.x===S.x&&C.y===S.y?C:S),l(!0)},[n.length,e,t]);return u.useLayoutEffect(()=>{d()},[d]),u.useEffect(()=>(window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}),[d]),a.jsx("div",{ref:r,className:"dropdown-panel fixed",role:"menu",style:{left:s.x,top:s.y,minWidth:180,visibility:o?"visible":"hidden"},onClick:f=>f.stopPropagation(),children:n.map((f,p)=>a.jsxs("button",{className:`dropdown-item w-full ${f.danger?"text-danger hover:text-danger":""}`,role:"menuitem","aria-disabled":f.disabled,disabled:f.disabled,onClick:h=>c(f,h),children:[f.icon&&a.jsx("span",{className:"shrink-0",children:f.icon}),a.jsx("span",{children:f.label})]},p))})}const dg=500;function fg(e){return e==="csv"?"text/csv;charset=utf-8":"application/json;charset=utf-8"}function hg(e,t){const n=mM(e);return t==="csv"?pM(n):hM(n)}function pg(){return new Date().toISOString().replace(/[:.]/g,"-")}async function vM(e){const t=await ge.getFolder(e,{recursive:!0,page:1,pageSize:dg}),n=new Map(t.items.map(s=>[s.path,s])),r=t.pageCount??1;for(let s=2;s<=r;s+=1){const i=await ge.getFolder(e,{recursive:!0,page:s,pageSize:dg});for(const o of i.items)n.has(o.path)||n.set(o.path,o)}return Array.from(n.values())}function yM({ctx:e,current:t,items:n,setCtx:r,onRefetch:s,onOpenMoveDialog:i,onRefreshFolder:o}){const l=WE(t),[c,d]=u.useState(!1),[f,p]=u.useState(null),h=e.kind==="grid"?e.payload.paths:[],w=u.useMemo(()=>new Map(n.map(j=>[j.path,j])),[n]),x=()=>{r(null)},S=async()=>{const j=e.kind==="tree"?e.payload.path:"/";d(!0);try{await o(j)}catch(M){console.error("Failed to refresh folder:",M)}finally{d(!1),x()}},C=j=>async()=>{p(j);const M=e.kind==="tree"?e.payload.path:t;try{const L=await vM(M),R=hg(L,j),B=fg(j),F=M==="/"?"root":(M.replace(/^\/+/,"")||"root").replace(/\//g,"_");ko(new Blob([R],{type:B}),`metadata_${F}_${pg()}.${j}`)}catch(L){console.error("Failed to export folder:",L),alert("Failed to export folder. See console for details.")}finally{p(null),x()}},v=j=>async()=>{p(j);try{const M=new Set(h),L=n.filter(F=>M.has(F.path)),R=hg(L,j),B=fg(j);ko(new Blob([R],{type:B}),`metadata_selection_${pg()}.${j}`)}finally{p(null),x()}},g=async()=>{var j;if(h.length){x();for(const M of h)try{const L=await ge.getFile(M),R=((j=w.get(M))==null?void 0:j.name)||mh(M)||"image";ko(L,R)}catch(L){console.error(`Failed to download ${M}:`,L)}}},y=async()=>{if(!l){for(const j of h)try{await ge.moveFile(j,"/_trash_")}catch(M){console.error(`Failed to trash ${j}:`,M)}s(),x()}},m=async()=>{if(confirm(`Delete ${h.length} file(s) permanently? This cannot be undone.`)){try{await ge.deleteFiles(h)}catch(j){console.error("Failed to delete files:",j)}s(),x()}},b=async()=>{for(const j of h)try{const L=(await ge.getSidecar(j)).original_position,R=L&&L.split("/").slice(0,-1).join("/")||"/";await ge.moveFile(j,R)}catch(M){console.error(`Failed to recover ${j}:`,M)}s(),x()},E=e.kind==="tree"?[{label:c?"Refreshing":"Refresh",disabled:c,onClick:S},{label:f==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!f||c,onClick:C("csv")},{label:f==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!f||c,onClick:C("json")}]:xM({selectedPaths:h,inTrash:l,exporting:f,onDownloadSelection:g,onMoveSelection:i,onMoveToTrash:y,onPermanentDelete:m,onRecover:b,onExportCsv:v("csv"),onExportJson:v("json")});return a.jsx(gM,{x:e.x,y:e.y,items:E})}function xM({selectedPaths:e,inTrash:t,exporting:n,onDownloadSelection:r,onMoveSelection:s,onMoveToTrash:i,onPermanentDelete:o,onRecover:l,onExportCsv:c,onExportJson:d}){const f=[];return e.length&&f.push({label:e.length>1?`Download (${e.length})`:"Download",onClick:r}),e.length&&f.push({label:"Move to",disabled:t,onClick:()=>{t||s(e)}}),f.push({label:"Move to trash",disabled:t,onClick:i}),t&&(f.push({label:"Permanent delete",danger:!0,onClick:o}),f.push({label:"Recover",onClick:l})),e.length&&(f.push({label:n==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!n,onClick:c}),f.push({label:n==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!n,onClick:d})),f}function ql(e){const t=u.useRef(e);return t.current=e,t}function wM(e,t){return t?e.some(n=>{var s;const r=(s=n.metrics)==null?void 0:s[t];return r!=null&&!Number.isNaN(r)}):!1}function SM(e,t){const n={0:0,1:0,2:0,3:0,4:0,5:0};for(const r of e){const s=t[r.path]??r.star??0,i=String(s);n[i]=(n[i]||0)+1}return n}function bM(e,t=250){const n=new Set;let r=0;for(const s of e){const i=s.metrics;if(i)for(const o of Object.keys(i))n.add(o);if(r+=1,r>=t&&n.size>0)break}return Array.from(n).sort()}function CM(e,t,n,r){return e||t?n:r}function kM(e,t,n,r,s,i){return e?n:t||i==="/"?r:s}function EM(e){if(!e)return null;if(e.queryPath){const t=e.queryPath.split("/").filter(Boolean);return t.length?t[t.length-1]:e.queryPath}return e.queryVector?"Vector query":null}function NM(e,t,n,r){return e?t>0?`${n} of ${r}`:`${r}`:null}const MM=(e,t)=>["search",e,t],jM=2e4,Yl="/";function PM(e){return e.trim().replace(/\s+/g," ")}function o0(e){const t=e.trim();return!t||t===Yl?Yl:t.startsWith(Yl)?t:`${Yl}${t}`}function yh(e,t){const n=PM(e);return n?{q:n,path:o0(t)}:null}function RM(e){return!Array.isArray(e)||e[0]!=="search"||typeof e[1]!="string"||typeof e[2]!="string"?null:yh(e[1],e[2])}function TM(e,t){if(!t)return!1;const n=RM(e);return n?n.path===t.path:!1}function IM(e,t){const n=Cu(),r=yh(e,t),s=MM((r==null?void 0:r.q)??"",(r==null?void 0:r.path)??o0(t));return xu({enabled:r!==null,queryKey:s,queryFn:()=>r?ge.search(r.q,r.path):Promise.resolve({items:[]}),staleTime:3e3,gcTime:6e4,placeholderData:(i,o)=>{if(TM(o==null?void 0:o.queryKey,r))return i},retry:1,refetchInterval:n?jM:!1,refetchIntervalInBackground:n})}const LM=()=>["embeddings"];function _M(){return xu({queryKey:LM(),queryFn:ge.getEmbeddings,staleTime:6e4,gcTime:5*6e4,retry:1,refetchOnWindowFocus:!1})}function AM(e,t=250){const[n,r]=Yr.useState(e);return Yr.useEffect(()=>{const s=window.setTimeout(()=>r(e),Math.max(0,t));return()=>window.clearTimeout(s)},[e,t]),n}function mg(e){return e.addedAt?Date.parse(e.addedAt):0}function tu(e,t){return e.name.localeCompare(t.name)}function FM(e,t){const n=mg(e),r=mg(t);return n===r?tu(e,t):n-r}function OM(e){return(t,n)=>{var i,o;const r=(i=t.metrics)==null?void 0:i[e],s=(o=n.metrics)==null?void 0:o[e];return r==null&&s==null?tu(t,n):r==null?1:s==null?-1:r===s?tu(t,n):r-s}}function gg(e,t){return KE(e,t)}function DM(e){let t=e>>>0;return()=>{t+=1831565813;let n=Math.imul(t^t>>>15,1|t);return n^=n+Math.imul(n^n>>>7,61|n),((n^n>>>14)>>>0)/4294967296}}function zM(e,t){const n=DM(t||1),r=[...e];for(let s=r.length-1;s>0;s-=1){const i=Math.floor(n()*(s+1));[r[s],r[i]]=[r[i],r[s]]}return r}function $M(e,t,n){if(t.kind==="builtin"&&t.key==="random"){const i=n??Date.now();return zM(e,i)}let r=FM;t.kind==="metric"?r=OM(t.key):t.key==="name"&&(r=tu);const s=[...e].sort(r);return t.dir==="desc"?s.reverse():s}function l0(e){if(!e.length)return e;const t=new Set,n=[];for(const r of e)t.has(r.path)||(t.add(r.path),n.push(r));return n}function a0(e){return{...e,items:l0(e.items)}}function BM(e,t){const n=e.pageCount??1,r=e.pageSize??t,s=(e.page??1)+1;return n<=1||s>n?null:{startPage:s,endPage:n,pageSize:r}}function UM(e,t){if(e.path!==t.path)return a0(t);const n=l0([...e.items,...t.items]);return{...e,generatedAt:t.generatedAt??e.generatedAt,dirs:e.dirs.length?e.dirs:t.dirs,items:n,page:t.page??e.page,pageSize:t.pageSize??e.pageSize,pageCount:t.pageCount??e.pageCount,totalItems:t.totalItems??e.totalItems}}async function VM(e,t){const n=t.shouldContinue??(()=>!0),r=t.progressiveUpdates??!0,s=Math.max(0,t.interPageDelayMs??0),i=BM(e,t.defaultPageSize),o=t.skipInitialUpdateIfPaged===!0&&i!==null;let l=a0(e);const c=f=>{var p;(p=t.onProgress)==null||p.call(t,{loadedPages:l.page??(i?i.startPage-1:1),totalPages:l.pageCount??(i==null?void 0:i.endPage)??1,loadedItems:l.items.length,totalItems:l.totalItems??l.items.length,completed:f})};if(o||t.onUpdate(l),c(!1),!i){o&&t.onUpdate(l),c(!0);return}let d=!1;for(let f=i.startPage;f<=i.endPage;f+=1){if(!n())return;let p;try{p=await t.fetchPage(f,i.pageSize)}catch{return}if(!n()||(l=UM(l,p),d=!0,r&&t.onUpdate(l),c(!1),f<i.endPage&&s>0&&(await new Promise(h=>{setTimeout(h,s)}),!n())))return}!r&&d&&t.onUpdate(l),c(!0)}function WM(e,t){return e?t instanceof sn||t instanceof Error?t.message:"Failed to load embeddings.":null}function HM({current:e,query:t,similarityState:n,scanStableMode:r=!1,viewState:s,randomSeed:i,localStarOverrides:o,sessionResetToken:l=0,onFolderHydratedSnapshot:c,getCachedHydratedSnapshot:d}){var te,oe;const f=mr(),{data:p,refetch:h,isLoading:w,isError:x}=of(e,!0,{page:1,pageSize:ya}),[S,C]=u.useState(),[v,g]=u.useState(null),y=u.useRef(0),m=u.useCallback(()=>h(),[h]),{data:b}=of("/",!0,{enabled:!1,page:1,pageSize:ya});u.useEffect(()=>{f.removeQueries({predicate:({queryKey:W})=>kN(W,e,!0)})},[e,f]),u.useEffect(()=>{y.current+=1;const W=(d==null?void 0:d(e))??null;C(W??void 0),g(null)},[e,d,l]),u.useEffect(()=>()=>{wm()},[e]),u.useEffect(()=>{if(!p)return;const W=++y.current;let Q=!1;const de=((d==null?void 0:d(p.path))??null)!==null,V=ce=>{C(ce),c==null||c(ce.path,ce)},Se={loadedPages:p.page??1,totalPages:p.pageCount??1,loadedItems:p.items.length,totalItems:p.totalItems??p.items.length,completed:!1};return Nb({requestId:W,path:p.path,loadedPages:Se.loadedPages,totalPages:Se.totalPages,loadedItems:Se.loadedItems,totalItems:Se.totalItems}),g(Se),VM(p,{defaultPageSize:ya,fetchPage:(ce,me)=>ge.getFolder(p.path,{recursive:!0,page:ce,pageSize:me}),onUpdate:V,onProgress:ce=>{Q||y.current!==W||(g(ce),Mb({requestId:W,path:p.path,loadedPages:ce.loadedPages,totalPages:ce.totalPages,loadedItems:ce.loadedItems,totalItems:ce.totalItems}))},shouldContinue:()=>!Q&&y.current===W,progressiveUpdates:!0,interPageDelayMs:p.path==="/"?40:12,skipInitialUpdateIfPaged:de}).finally(()=>{Q||y.current!==W||(jb(W),g(ce=>ce?{...ce,completed:!0}:null))}),()=>{Q=!0,wm(["folders"])}},[d,c,p]);const E=n!==null,j=AM(t,250),M=u.useMemo(()=>E?null:yh(j,e),[E,j,e]),L=M!==null,R=(M==null?void 0:M.q)??"",B=IM((M==null?void 0:M.q)??"",(M==null?void 0:M.path)??e),F=_M(),G=((te=F.data)==null?void 0:te.embeddings)??[],Z=((oe=F.data)==null?void 0:oe.rejected)??[],$=G.length>0,I=WM(F.isError,F.error),T=u.useMemo(()=>{var Q;return(L?((Q=B.data)==null?void 0:Q.items)??[]:(S==null?void 0:S.items)??[]).map(de=>({...de,star:o[de.path]!==void 0?o[de.path]:de.star}))},[L,B.data,S,o]),P=u.useMemo(()=>{var de;const W=new Map;for(const V of T)W.set(V.path,V);const Q=((de=B.data)==null?void 0:de.items)??[];for(const V of Q){if(W.has(V.path))continue;const Se=o[V.path]!==void 0?o[V.path]:V.star;W.set(V.path,{...V,star:Se})}return W},[T,B.data,o]),_=u.useMemo(()=>n?n.items.map(W=>{const Q=P.get(W.path);return Q||SE(W.path,o[W.path])}):[],[n,P,o]),O=u.useMemo(()=>{if(n)return gg(_,s.filters);const W=gg(T,s.filters);return r?W:$M(W,s.sort,i)},[n,_,T,r,s.filters,s.sort,i]),q=n?_.length:T.length,U=O.length,A=(S==null?void 0:S.totalItems)??(S==null?void 0:S.items.length)??q,K=e==="/"?A:(b==null?void 0:b.totalItems)??(b==null?void 0:b.items.length)??A,X=!!v&&!v.completed;return{data:S,refetch:m,isLoading:w,isError:x,searching:L,normalizedQ:R,similarityActive:E,embeddings:G,embeddingsRejected:Z,embeddingsAvailable:$,embeddingsLoading:F.isLoading,embeddingsError:I,poolItems:T,similarityItems:_,items:O,totalCount:q,filteredCount:U,scopeTotal:A,rootTotal:K,browseHydrationPending:X,browseHydrationProgress:v}}function QM({current:e,itemPaths:t,items:n,selectionPool:r,focusGridCell:s}){const[i,o]=u.useState([]),[l,c]=u.useState(null),[d,f]=u.useState(!1),[p,h]=u.useState(0),[w,x]=u.useState(0),S=u.useRef(!1),C=u.useRef(!1),v=u.useRef(null),g=u.useMemo(()=>new Set(i),[i]),y=u.useMemo(()=>{if(!i.length)return[];const Q=new Map(r.map(V=>[V.path,V])),de=new Map(n.map(V=>[V.path,V]));return i.map(V=>Q.get(V)??de.get(V)).filter(V=>!!V)},[i,r,n]),m=u.useMemo(()=>n.filter(Q=>g.has(Q.path)),[n,g]),b=u.useMemo(()=>m.map(Q=>Q.path),[m]),E=Math.max(0,m.length-2),j=Math.min(p,E),M=m[j]??null,L=m[j+1]??null,R=j>0,B=j<m.length-2,F=m.length>=2,G=l!=null||d,Z=l??i[0]??null,$=Z?t.indexOf(Z):-1,I=$>0,T=$>=0&&$<t.length-1;u.useEffect(()=>{h(Q=>Q>E?E:Q)},[E]);const P=u.useCallback(()=>{x(Q=>Q+1)},[]),_=u.useCallback(Q=>{v.current=Q},[]),O=u.useCallback(()=>{c(null),S.current=!1},[]),q=u.useCallback(Q=>{if(Q){c(Q),o([Q]);return}O()},[O]),U=u.useCallback(Q=>{l&&(c(null),S.current=!1,Ql(Q))},[l]),A=u.useCallback(Q=>{c(Q),S.current=!0,Dx(Q)},[]),K=u.useCallback(()=>{c(null),S.current?(S.current=!1,window.history.back()):Ql(e),s(v.current)},[e,s]),X=u.useCallback(()=>{d||!F||(i[0]&&(v.current=i[0]),h(0),f(!0),l&&(c(null),S.current&&(S.current=!1),Ql(e)),C.current||(window.history.pushState({compare:!0},"",window.location.href),C.current=!0))},[d,F,e,i,l]),te=u.useCallback(()=>{f(!1),C.current&&(C.current=!1,window.history.back()),s(v.current??i[0])},[s,i]),oe=u.useCallback(Q=>{m.length<2||h(de=>{const V=Math.max(0,m.length-2);return Math.min(V,Math.max(0,de+Q))})},[m.length]),W=u.useCallback(Q=>{if(!t.length)return;const de=l??i[0];if(!de)return;const V=t.indexOf(de);if(V===-1)return;const Se=Math.min(t.length-1,Math.max(0,V+Q)),ce=t[Se];!ce||ce===de||(l&&(c(ce),Ql(ce)),o([ce]))},[t,i,l]);return u.useEffect(()=>{d&&(F||te())},[d,F,te]),u.useEffect(()=>{const Q=()=>{l&&(S.current=!1,c(null)),d&&(C.current=!1,f(!1))};return window.addEventListener("popstate",Q),()=>window.removeEventListener("popstate",Q)},[l,d]),{selectedPaths:i,setSelectedPaths:o,viewer:l,compareOpen:d,restoreGridToSelectionToken:w,bumpRestoreGridToSelectionToken:P,selectedItems:y,compareItems:m,comparePaths:b,compareIndexClamped:j,compareA:M,compareB:L,canComparePrev:R,canCompareNext:B,compareEnabled:F,canPrevImage:I,canNextImage:T,overlayActive:G,rememberFocusedPath:_,openViewer:A,closeViewer:K,openCompare:X,closeCompare:te,handleCompareNavigate:oe,handleNavigate:W,resetViewerState:O,clearViewerForSearch:U,syncHashImageSelection:q}}const KM=2048,GM=6,qM=10;function u0(e){const t=new Map;for(const n of e)t.set(n.path,n.name);return t}function c0(e,t){return t.get(e)??e.split("/").pop()??e}function vg(e,t){const n=e.filter(r=>!t.has(r.path));return n.length===e.length?e:n}function yg(e,t,n,r,s){const i=e.filter(l=>l.path!==t);return[{path:t,ts:n,kind:r},...i].slice(0,s)}function YM(e,t){if(!e.length)return null;const n=u0(t),r=new Set,s=[];for(const o of e)r.has(o.path)||(r.add(o.path),s.push(o.path));const i=s.slice(0,2).map(o=>c0(o,n));return{count:s.length,names:i,extra:Math.max(0,s.length-i.length)}}function XM(e,t,n,r){if(!e.length)return[];const s=u0(t);return e.map(i=>({path:i.path,label:c0(i.path,s),timeLabel:r(i.ts,n)}))}function JM(e){const[t,n]=u.useState([]),[r,s]=u.useState([]),[i,o]=u.useState(new Map),l=u.useRef(new Map),c=u.useRef(new Set),d=u.useRef(new Set),f=u.useRef(new Set);u.useEffect(()=>()=>{for(const C of l.current.values())window.clearTimeout(C);l.current.clear(),c.current.clear()},[]),u.useEffect(()=>{d.current=new Set(e),n(C=>vg(C,f.current))},[e]);const p=u.useCallback((C,v)=>{if(v!=null){if(c.current.has(v))return;if(c.current.add(v),c.current.size>KM){const E=c.current.values().next().value;E!=null&&c.current.delete(E)}}const g=v!=null?`event:${v}`:`event:${C}:${Date.now()}`;o(E=>{if(E.get(C)===g)return E;const j=new Map(E);return j.set(C,g),j});const y=l.current,m=y.get(C);m!=null&&window.clearTimeout(m);const b=window.setTimeout(()=>{o(E=>{if(E.get(C)!==g)return E;const j=new Map(E);return j.delete(C),j}),y.delete(C)},aM);y.set(C,b)},[]),h=u.useCallback(C=>{f.current=C,n(v=>vg(v,C))},[]),w=u.useCallback((C,v,g)=>{const y=Date.now();d.current.has(C)&&f.current.has(C)||n(b=>yg(b,C,y,v,GM)),p(C,g)},[p]),x=u.useCallback((C,v,g)=>{const y=Date.now(),m=Px(g)??y;s(b=>yg(b,C,m,v,qM))},[]),S=u.useCallback(()=>{n([])},[]);return{offViewActivity:t,recentTouches:r,highlightedPaths:i,onVisiblePathsChange:h,markRecentActivity:w,markRecentTouch:x,clearOffViewActivity:S}}function xg(e){if(typeof e!="number"||!Number.isFinite(e))return;const t=Math.trunc(e);return t<0?0:t}function ZM(e){if(typeof e!="string")return;const t=e.trim();return t.length?t:void 0}function ej(e){if(!e)return null;const t=e.state;if(t!=="idle"&&t!=="running"&&t!=="ready"&&t!=="error")return null;let n=xg(e.done);const r=xg(e.total);return n!==void 0&&r!==void 0&&n>r&&(n=r),{state:t,scope:typeof e.scope=="string"?e.scope:void 0,done:n,total:r,generation:ZM(e.generation),started_at:typeof e.started_at=="string"?e.started_at:void 0,finished_at:typeof e.finished_at=="string"?e.finished_at:void 0,error:typeof e.error=="string"?e.error:void 0}}function tj(e,t){return e===t?!0:!e||!t?!1:e.state===t.state&&e.scope===t.scope&&e.done===t.done&&e.total===t.total&&e.generation===t.generation&&e.started_at===t.started_at&&e.finished_at===t.finished_at&&e.error===t.error}function nj(e){return(e==null?void 0:e.state)==="idle"||(e==null?void 0:e.state)==="running"}function rj(e,t,n){return(e==null?void 0:e.state)==="running"?t:n}const d0=[1],sj={supportedVersions:[...d0],maxPathsV2:null,supportsV2:!1};function ij(e){if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.trunc(e);return t>0?t:null}function oj(e){if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.trunc(e);return t>=2?t:null}function lj(e){let t=[...d0];const n=e==null?void 0:e.supported_versions;if(Array.isArray(n)){const i=Array.from(new Set(n.map(o=>ij(o)).filter(o=>o!==null))).sort((o,l)=>o-l);i.length>0&&(t=i)}const r=oj(e==null?void 0:e.max_paths_v2),s=t.includes(2)&&r!==null&&r>2;return{supportedVersions:t,maxPathsV2:r,supportsV2:s}}function aj(e,t){if(e===t)return!0;if(e.supportsV2!==t.supportsV2||e.maxPathsV2!==t.maxPathsV2||e.supportedVersions.length!==t.supportedVersions.length)return!1;for(let n=0;n<e.supportedVersions.length;n+=1)if(e.supportedVersions[n]!==t.supportedVersions[n])return!1;return!0}const uj=1200,wg=3e3;function cj(e){switch(e){case"live":return"Live";case"reconnecting":return"Reconnecting";case"offline":return"Offline";case"connecting":case"idle":default:return"Connecting"}}function Sg(e){if(!(e instanceof sn))return null;const t=e.body;if(!t||typeof t!="object")return null;const n=t.error;return typeof n=="string"?n:null}function bg(e,t){return t-e<iM?Uk(e,t):Vk(e)}function dj({current:e,currentGalleryId:t,itemPaths:n,items:r,queryClient:s,updateItemCaches:i,setLocalStarOverrides:o}){const l=u.useRef(Fi()),c=u.useRef(null),d=u.useRef(null),f=u.useRef(null),p=u.useRef(!1),h=u.useRef(null),w=u.useRef("idle"),[x,S]=u.useState("idle"),[C,v]=u.useState({}),[g,y]=u.useState(null),[m,b]=u.useState(null),[E,j]=u.useState(!1),[M,L]=u.useState(()=>Date.now()),[R,B]=u.useState(!0),[F,G]=u.useState(null),[Z,$]=u.useState(sj);u.useEffect(()=>{if(m==null){j(!1);return}j(!0);const re=window.setTimeout(()=>j(!1),rM);return()=>window.clearTimeout(re)},[m]),u.useEffect(()=>{if(g==null)return;L(Date.now());const re=window.setInterval(()=>L(Date.now()),1e4);return()=>window.clearInterval(re)},[g]);const{offViewActivity:I,recentTouches:T,highlightedPaths:P,onVisiblePathsChange:_,markRecentActivity:O,markRecentTouch:q,clearOffViewActivity:U}=JM(n),A=u.useCallback(re=>{const se=Date.now(),Ie=Px(re)??se,we=Ie>se?se:Ie;y(pe=>pe==null?we:pe>we?pe:we),b(se),L(se)},[]),K=u.useCallback(re=>{re.length&&v(se=>{let ye=!1;const Ie={...se};for(const we of re){const pe=se[we.gallery_id];pe&&pe.viewing===we.viewing&&pe.editing===we.editing||(Ie[we.gallery_id]=we,ye=!0)}return ye?Ie:se})},[]),X=u.useCallback(()=>{h.current!=null&&(window.clearTimeout(h.current),h.current=null)},[]),te=u.useCallback(re=>{re&&v(se=>{if(!(re in se))return se;const ye={...se};return delete ye[re],ye})},[]),oe=u.useCallback(re=>{c.current=re.lease_id,d.current=re.gallery_id,K([re])},[K]),W=u.useCallback(async(re,se=!1)=>{const ye=l.current,Ie=se?void 0:c.current??void 0,we=pe=>ge.joinPresence(re,pe,ye);try{oe(await we(Ie));return}catch(pe){if(!se&&Sg(pe)==="invalid_lease"){oe(await we(void 0));return}throw pe}},[oe]),Q=u.useCallback(async(re,se)=>{if(re===se){await W(se);return}const ye=c.current;if(!ye){await W(se,!0);return}try{const Ie=await ge.movePresence(re,se,ye,l.current);d.current=Ie.to_scope.gallery_id,K([Ie.from_scope,Ie.to_scope]);return}catch(Ie){const we=Sg(Ie);if(we==="invalid_lease"){await W(se,!0);return}if(we==="scope_mismatch"){await W(se);return}throw Ie}},[K,W]),de=u.useCallback(async re=>{const se=d.current;if(!se){await W(re,!0);return}if(se===re){await W(re);return}await Q(se,re)},[W,Q]),V=u.useCallback(async()=>{if(p.current)return;const re=f.current;if(re){f.current=null,p.current=!0;try{await de(re)}catch{}finally{p.current=!1;const se=f.current;se&&se!==d.current&&V()}}},[de]),Se=u.useCallback((re,se=!1)=>{if(f.current=re,X(),se||d.current==null){V();return}h.current=window.setTimeout(()=>{h.current=null,V()},lM)},[X,V]),ce=u.useCallback(()=>{d.current=null,c.current=null,f.current=null,X()},[X]),me=u.useCallback(re=>{const se=d.current,ye=c.current;!se||!ye||(tC(se,ye,l.current),re&&te(se),ce())},[te,ce]);u.useEffect(()=>{Gb();const re=Yb(ye=>{if(ye.type==="presence"){const pe=ye.data;if(!(pe!=null&&pe.gallery_id))return;K([pe]);return}const Ie=ye.data;if(!(Ie!=null&&Ie.path))return;const we=Ie.path;if(ye.type==="item-updated"){const pe=ye.data,Ze={v:1,tags:pe.tags??[],notes:pe.notes??"",star:pe.star??null,version:pe.version??1,updated_at:pe.updated_at??"",updated_by:pe.updated_by??"server"};s.setQueryData(Wo(we),Ze),i({path:we,star:pe.star??null,metrics:pe.metrics,comments:pe.notes??""}),Tk(we,Ze),O(we,"item-updated",ye.id),q(we,"item-updated",pe.updated_at),A(pe.updated_at),o(rt=>{if(rt[we]===void 0)return rt;const xt={...rt};return delete xt[we],xt})}else if(ye.type==="metrics-updated"){const pe=ye.data;i({path:we,metrics:pe.metrics}),O(we,"metrics-updated",ye.id),q(we,"metrics-updated",pe.updated_at),A(pe.updated_at)}}),se=Xb(S);return()=>{re(),se(),qb()}},[K,O,q,s,o,i,A]),u.useEffect(()=>{const re=d.current;re!==t&&Se(t,re==null)},[t,Se]),u.useEffect(()=>{const re=window.setInterval(()=>{const se=d.current;se&&W(se)},oM);return()=>{window.clearInterval(re)}},[W]),u.useEffect(()=>{const re=w.current;if(w.current=x,x==="live"&&re!=="live"){Se(t,!0);return}(x==="reconnecting"||x==="offline")&&te(d.current)},[te,x,t,Se]),u.useEffect(()=>{const re=()=>me(!0),se=()=>me(!0),ye=()=>{Se(t,!0)};return window.addEventListener("pagehide",re),window.addEventListener("beforeunload",se),window.addEventListener("pageshow",ye),()=>{window.removeEventListener("pagehide",re),window.removeEventListener("beforeunload",se),window.removeEventListener("pageshow",ye),me(!1)}},[t,Se,me]),u.useEffect(()=>{let re=!1,se=null;const ye=()=>{se!=null&&(window.clearTimeout(se),se=null)},Ie=pe=>{ye(),se=window.setTimeout(()=>{we()},pe)},we=async()=>{var pe;try{const Ze=await ge.getHealth();if(re)return;B(((pe=Ze==null?void 0:Ze.labels)==null?void 0:pe.enabled)??!0);const rt=ej(Ze==null?void 0:Ze.indexing);G(et=>tj(et,rt)?et:rt);const xt=lj(Ze==null?void 0:Ze.compare_export);$(et=>aj(et,xt)?et:xt),nj(rt)&&Ie(rj(rt,uj,wg))}catch{if(re)return;Ie(wg)}};return we(),()=>{re=!0,ye()}},[]);const Be=C[e],We=(Be==null?void 0:Be.editing)??0,ut=g!=null,Ln=u.useMemo(()=>cj(x),[x]),It=u.useMemo(()=>!ut||g==null?"No edits yet.":bg(g,M),[ut,g,M]),_n=u.useMemo(()=>YM(I,r),[I,r]),Jt=u.useMemo(()=>XM(T,r,M,bg),[r,M,T]);return{connectionStatus:x,connectionLabel:Ln,presence:Be,editingCount:We,recentEditActive:E,hasEdits:ut,lastEditedLabel:It,persistenceEnabled:R,indexing:F,compareExportCapability:Z,highlightedPaths:P,onVisiblePathsChange:_,offViewSummary:_n,recentTouchesDisplay:Jt,clearOffViewActivity:U}}const fj=600;function hj(e){if(!(e instanceof sn))return!1;if(e.status===403||e.status===405)return!0;const t=String(e.message||"").toLowerCase();return t.includes("read-only")||t.includes("no-write")||t.includes("write")}function oo(e,t){return hj(e)?"This workspace is read-only. Upload and move actions are disabled.":e instanceof sn||e instanceof Error&&e.message?e.message:t}function _c(e){return Array.from(new Set(e.filter(Boolean)))}function Cg(e,t){return t.length?t.length===1?t[0]:`${e} failed for ${t.length} item(s). ${t[0]}`:""}async function pj(){const e=["/"],t=new Set,n=new Set(["/"]);for(;e.length>0&&t.size<fj;){const r=e.shift()??"/",s=Rt(r);if(t.has(s))continue;t.add(s);let i=null;try{i=await ge.getFolder(s)}catch{i=null}if(i)for(const o of i.dirs??[]){const l=Rt(zx(s,o.name));n.has(l)||(n.add(l),e.push(l))}}return Array.from(n).sort((r,s)=>r==="/"?-1:s==="/"?1:r.localeCompare(s))}function mj({appRef:e,uploadInputRef:t,current:n,currentDirCount:r,selectedPaths:s,setSelectedPaths:i,refetch:o,invalidateDerivedCounts:l}){const c=mr(),[d,f]=u.useState(!1),[p,h]=u.useState(null),[w,x]=u.useState(!1),[S,C]=u.useState(null),[v,g]=u.useState(["/"]),[y,m]=u.useState(!1),[b,E]=u.useState(null);u.useEffect(()=>{h(null)},[n]);const j=u.useCallback(I=>{const T=_c(s);return T.includes(I)?T:[I]},[s]),M=u.useCallback((I,T)=>{const P=j(I);i(P),E({x:T.x,y:T.y,kind:"grid",payload:{paths:P}})},[j,i]),L=u.useCallback((I,T)=>{E({x:T.x,y:T.y,kind:"tree",payload:{path:I}})},[]);u.useEffect(()=>{if(!S)return;let I=!1;return m(!0),pj().then(T=>{I||g(T)}).catch(T=>{I||h(oo(T,"Failed to load destination folders."))}).finally(()=>{I||m(!1)}),()=>{I=!0}},[S]);const R=u.useCallback(async(I,T)=>{const P=_c(I);if(!P.length)return!1;const _=Rt(T||"/");h(null);const O=[],q=[];for(const A of P)try{await ge.moveFile(A,_)}catch(K){O.push(`${mh(A)||A}: ${oo(K,"Move failed.")}`),q.push(A)}try{await c.invalidateQueries({predicate:({queryKey:A})=>Array.isArray(A)&&A[0]==="folder"}),l(),await o()}catch(A){O.push(oo(A,"Move completed, but refresh failed."))}if(O.length)return h(Cg("Move",O)),i(q),!1;C(null),E(null);const U=new Set(P);return i(A=>A.filter(K=>!U.has(K))),!0},[l,c,o,i]),B=u.useCallback(I=>{const T=_c(I);T.length&&(h(null),C({paths:T}),E(null))},[]),F=u.useCallback(async I=>{if(!I.length)return;if(!(r===0)){h("Uploads are only allowed into folders without subdirectories.");return}f(!0),h(null);const P=[];try{for(const _ of I)try{await ge.uploadFile(n,_)}catch(O){P.push(`${_.name}: ${oo(O,"Upload failed.")}`)}try{await o()}catch(_){P.push(oo(_,"Upload completed, but refresh failed."))}}finally{f(!1)}if(P.length){h(Cg("Upload",P));return}h(null)},[n,r,o]),G=u.useCallback(()=>{var I;d||(I=t.current)==null||I.click()},[t,d]),Z=u.useCallback(async I=>{const T=Array.from(I.target.files??[]);I.target.value="",T.length&&await F(T)},[F]);u.useEffect(()=>{const I=e.current;if(!I)return;const T=O=>{O.dataTransfer&&Array.from(O.dataTransfer.types).includes("Files")&&(O.preventDefault(),x(!0))},P=O=>{const q=O.relatedTarget;q&&I.contains(q)||x(!1)},_=async O=>{var U;O.preventDefault(),x(!1);const q=Array.from(((U=O.dataTransfer)==null?void 0:U.files)??[]);q.length&&await F(q)};return I.addEventListener("dragover",T),I.addEventListener("dragleave",P),I.addEventListener("drop",_),()=>{I.removeEventListener("dragover",T),I.removeEventListener("dragleave",P),I.removeEventListener("drop",_)}},[e,F]),u.useEffect(()=>{const I=()=>E(null),T=P=>{P.key==="Escape"&&E(null)};return window.addEventListener("click",I),window.addEventListener("keydown",T),()=>{window.removeEventListener("click",I),window.removeEventListener("keydown",T)}},[]);const $=u.useCallback(()=>{C(null)},[]);return{uploading:d,actionError:p,isDraggingOver:w,moveDialog:S,moveFolders:v,moveFoldersLoading:y,ctx:b,setCtx:E,closeMoveDialog:$,openUploadPicker:G,handleUploadInputChange:Z,openGridActions:M,openFolderActions:L,openMoveDialogForPaths:B,moveSelectedToFolder:R}}function Tn(e){const t=e.trim();return!t||t==="/"?"/":t.startsWith("/")?t:`/${t}`}function f0(e,t){const n=Tn(t),r=e[n];return r||{path:n,hydratedSnapshot:null,hydratedGeneratedAt:null,hydratedItemCount:0,hydratedAtMs:null,topAnchorPath:null}}function af(e,t){return t==="/"?!0:e===t||e.startsWith(`${t}/`)}function gj(e){for(const t of e)return t;return null}function vj(e,t,n,r){const s=f0(e,t),i={...s,path:Tn(t),hydratedSnapshot:n,hydratedGeneratedAt:n.generatedAt??null,hydratedItemCount:n.totalItems??n.items.length,hydratedAtMs:r};return s.hydratedSnapshot===i.hydratedSnapshot&&s.hydratedGeneratedAt===i.hydratedGeneratedAt&&s.hydratedItemCount===i.hydratedItemCount&&s.hydratedAtMs===i.hydratedAtMs?e:{...e,[i.path]:i}}function kg(e,t,n){const r=f0(e,t),s=Tn(t),i=n?Tn(n):null;return r.topAnchorPath===i&&r.path===s?e:{...e,[s]:{...r,path:s,topAnchorPath:i}}}function h0(e,t){const n=Tn(t);if(!e[n])return e;const r={...e};return delete r[n],r}function yj(e,t){const n=Tn(t);let r=!1;const s={...e};for(const i of Object.keys(s))af(i,n)&&(r=!0,delete s[i]);return r?s:e}function xj(e,t){const n=Tn(e),r=Tn(t);return!!(n===r||af(n,r)||af(r,n))}function wj(e,t,n){return xj(t,n)?e:h0(e,n)}function Sj(){const e=u.useRef({}),t=u.useCallback(p=>e.current[Tn(p)]??null,[]),n=u.useCallback(p=>{var h;return((h=e.current[Tn(p)])==null?void 0:h.hydratedSnapshot)??null},[]),r=u.useCallback(p=>{var h;return((h=e.current[Tn(p)])==null?void 0:h.topAnchorPath)??null},[]),s=u.useCallback((p,h)=>{e.current=vj(e.current,p,h,Date.now())},[]),i=u.useCallback((p,h)=>{e.current=kg(e.current,p,h)},[]),o=u.useCallback((p,h)=>{const w=gj(h);w&&(e.current=kg(e.current,p,w))},[]),l=u.useCallback(p=>{e.current=h0(e.current,p)},[]),c=u.useCallback(p=>{e.current=yj(e.current,p)},[]),d=u.useCallback((p,h)=>{e.current=wj(e.current,p,h)},[]),f=u.useCallback(()=>{e.current={}},[]);return u.useMemo(()=>({getSession:t,getHydratedSnapshot:n,getTopAnchorPath:r,saveHydratedSnapshot:s,saveTopAnchorPath:i,saveTopAnchorFromVisiblePaths:o,invalidatePath:l,invalidateSubtree:c,invalidateForScopeTransition:d,clearAllSessions:f}),[t,n,r,s,i,o,l,c,d,f])}const bj={stars:{read:e=>{const t=e.stars||[];return t.length?{id:"stars",label:`Rating in: ${Rc(t)}`}:null},clear:(e,t)=>t.clearStars()},starsIn:{read:e=>{const t=e.starsIn.values||[];return t.length?{id:"stars-in",label:`Rating in: ${Rc(t)}`}:null},clear:(e,t)=>t.clearStars()},starsNotIn:{read:e=>{const t=e.starsNotIn.values||[];return t.length?{id:"stars-not-in",label:`Rating not in: ${Rc(t)}`}:null},clear:(e,t)=>t.clearStarsNotIn()},nameContains:{read:e=>{var n;const t=(n=e.nameContains.value)==null?void 0:n.trim();return t?{id:"name-contains",label:`Filename contains: ${t}`}:null},clear:(e,t)=>t.clearNameContains()},nameNotContains:{read:e=>{var n;const t=(n=e.nameNotContains.value)==null?void 0:n.trim();return t?{id:"name-not-contains",label:`Filename not: ${t}`}:null},clear:(e,t)=>t.clearNameNotContains()},commentsContains:{read:e=>{var n;const t=(n=e.commentsContains.value)==null?void 0:n.trim();return t?{id:"comments-contains",label:`Comments contain: ${t}`}:null},clear:(e,t)=>t.clearCommentsContains()},commentsNotContains:{read:e=>{var n;const t=(n=e.commentsNotContains.value)==null?void 0:n.trim();return t?{id:"comments-not-contains",label:`Comments not: ${t}`}:null},clear:(e,t)=>t.clearCommentsNotContains()},urlContains:{read:e=>{var n;const t=(n=e.urlContains.value)==null?void 0:n.trim();return t?{id:"url-contains",label:`URL contains: ${t}`}:null},clear:(e,t)=>t.clearUrlContains()},urlNotContains:{read:e=>{var n;const t=(n=e.urlNotContains.value)==null?void 0:n.trim();return t?{id:"url-not-contains",label:`URL not: ${t}`}:null},clear:(e,t)=>t.clearUrlNotContains()},dateRange:{read:e=>{const{from:t,to:n}=e.dateRange;return!t&&!n?null:{id:"date-range",label:`Date: ${gE(t,n)}`}},clear:(e,t)=>t.clearDateRange()},widthCompare:{read:e=>({id:"width-compare",label:`Width ${e.widthCompare.op} ${e.widthCompare.value}`}),clear:(e,t)=>t.clearWidthCompare()},heightCompare:{read:e=>({id:"height-compare",label:`Height ${e.heightCompare.op} ${e.heightCompare.value}`}),clear:(e,t)=>t.clearHeightCompare()},metricRange:{read:e=>({id:`metric:${e.metricRange.key}`,label:`${e.metricRange.key}: ${xE(e.metricRange.min,e.metricRange.max)}`}),clear:(e,t)=>t.clearMetricRange(e.metricRange.key)}};function Cj(e,t){if("stars"in e)return t("stars",e);if("starsIn"in e)return t("starsIn",e);if("starsNotIn"in e)return t("starsNotIn",e);if("nameContains"in e)return t("nameContains",e);if("nameNotContains"in e)return t("nameNotContains",e);if("commentsContains"in e)return t("commentsContains",e);if("commentsNotContains"in e)return t("commentsNotContains",e);if("urlContains"in e)return t("urlContains",e);if("urlNotContains"in e)return t("urlNotContains",e);if("dateRange"in e)return t("dateRange",e);if("widthCompare"in e)return t("widthCompare",e);if("heightCompare"in e)return t("heightCompare",e);if("metricRange"in e)return t("metricRange",e)}function kj(e,t){const n=[];for(const r of e.and)Cj(r,(s,i)=>{const o=bj[s],l=o.read(i);l&&n.push({id:l.id,label:l.label,onRemove:()=>o.clear(i,t)})});return n}function Nu(e){if(typeof e!="string")return null;const t=e.trim();return t.length?t:null}function Ej(e,t){const n=Nu(t==null?void 0:t.generation);return!n||(t==null?void 0:t.state)!=="idle"&&(t==null?void 0:t.state)!=="running"?e:n}function Nj(e,t){const r=Nu(e==null?void 0:e.generation)??((e==null?void 0:e.state)==="ready"?t.scanGeneration:null),s=r!==null&&t.scanGeneration===r&&t.recentGeneration!==r,i=s&&(e==null?void 0:e.state)==="ready";return{scanStableActive:s,sortLocked:s,showSwitchToMostRecentBanner:i}}const ot={sortKey:"sortKey",sortDir:"sortDir",sortSpec:"sortSpec",starFilters:"starFilters",filterAst:"filterAst",selectedMetric:"selectedMetric",viewMode:"viewMode",gridItemSize:"gridItemSize",leftOpen:"leftOpen",rightOpen:"rightOpen"},Xl={scanGeneration:"indexingScanGeneration",recentGeneration:"indexingMostRecentGeneration"};function Eg(e){if(typeof window>"u")return null;try{const t=window.localStorage.getItem(e);return Nu(t)}catch{return null}}function Ng(e,t){if(!(typeof window>"u"))try{window.localStorage.setItem(e,t)}catch{}}function Mg(e,t){for(const n of e)ge.prefetchFile(n,t),ge.prefetchThumb(n)}function Mj(){var _h;const[e,t]=u.useState("/"),[n,r]=u.useState(""),[s,i]=u.useState(!1),[o,l]=u.useState(null),[c,d]=u.useState(null),[f,p]=u.useState(100),[h,w]=u.useState(null),[x,S]=u.useState(()=>({filters:{and:[]},sort:{kind:"builtin",key:"added",dir:"desc"},selectedMetric:void 0})),[C,v]=u.useState(()=>Date.now()),[g,y]=u.useState("adaptive"),[m,b]=u.useState(220),[E,j]=u.useState(!1),[M,L]=u.useState(!0),[R,B]=u.useState(!0),[F,G]=u.useState(()=>typeof window>"u"?1440:window.innerWidth),Z=fa(da.narrow),[$,I]=u.useState("folders"),[T,P]=u.useState([]),[_,O]=u.useState(null),[q,U]=u.useState(0),[A,K]=u.useState(()=>Eg(Xl.scanGeneration)),[X,te]=u.useState(()=>Eg(Xl.recentGeneration)),[oe,W]=u.useState(!1),[Q,de]=u.useState({}),V=u.useRef(null),Se=u.useRef(null),ce=u.useRef(null),me=u.useRef(null),Be=u.useRef(null),We=u.useRef(null),ut=u.useRef(!1),{leftW:Ln,rightW:It,onResizeLeft:_n,onResizeRight:Jt}=xN(V,$),{getHydratedSnapshot:re,getTopAnchorPath:se,saveHydratedSnapshot:ye,saveTopAnchorPath:Ie,invalidateSubtree:we}=Sj(),[pe,Ze]=u.useState(0),[rt,xt]=u.useState(0),et=mr(),Zt=Nk(),gr=Cu(),wn=jk(),[An,ke]=u.useState(!1),{data:st,refetch:Fn,isLoading:Gn,searching:Vt,normalizedQ:vr,similarityActive:Lt,embeddings:Bi,embeddingsRejected:Fs,embeddingsAvailable:Ui,embeddingsLoading:ns,embeddingsError:Os,poolItems:On,similarityItems:Dn,items:D,totalCount:Y,filteredCount:ie,scopeTotal:ve,rootTotal:be,browseHydrationPending:Ee,browseHydrationProgress:le}=HM({current:e,query:n,similarityState:o,scanStableMode:oe,viewState:x,randomSeed:C,localStarOverrides:Q,onFolderHydratedSnapshot:ye,getCachedHydratedSnapshot:re,sessionResetToken:rt}),Le=u.useMemo(()=>Rt(e||"/"),[e]),Ne=u.useMemo(()=>Km(x.filters),[x.filters]),it=u.useMemo(()=>D.map(N=>N.path),[D]),De=u.useCallback(N=>{if(!N)return;const z=document.getElementById(`cell-${encodeURIComponent(N)}`);z==null||z.focus()},[]),wt=o?Dn:On,{selectedPaths:ze,setSelectedPaths:He,viewer:Ke,compareOpen:_e,restoreGridToSelectionToken:un,bumpRestoreGridToSelectionToken:yr,selectedItems:il,compareItems:xr,comparePaths:qn,compareIndexClamped:Vi,compareA:ol,compareB:ll,canComparePrev:Mu,canCompareNext:al,compareEnabled:Ds,canPrevImage:ul,canNextImage:cl,overlayActive:ju,rememberFocusedPath:Pu,openViewer:Wi,closeViewer:zs,openCompare:Hi,closeCompare:$s,handleCompareNavigate:Ru,handleNavigate:rs,resetViewerState:dl,clearViewerForSearch:fl,syncHashImageSelection:Tu}=QM({current:e,itemPaths:it,items:D,selectionPool:wt,focusGridCell:De}),hl=ql(Tu),pl=ql(yr);u.useEffect(()=>{const N=ne=>{const fe=Rt(ne),Ae=VE(fe)?fe:null,Et=Ae?Qm(fe):fe,je=!ut.current;ut.current=!0,hl.current(Ae),t(Pe=>{const mt=yE(Pe,Et,Ae,je);return Pe===mt?Pe:(pl.current(),mt)})};N(Hm());const z=()=>N(Hm());return window.addEventListener("hashchange",z),()=>window.removeEventListener("hashchange",z)},[pl,hl]);const Iu=wt,Bs=o?null:x.sort.kind==="metric"?x.sort.key:null,ml=u.useMemo(()=>wM(D,Bs),[D,Bs]),Lu=u.useCallback(N=>{const z=Object.prototype.hasOwnProperty.call(N,"star"),ne=N.metrics!==void 0,fe=N.comments!==void 0;if(!z&&!ne&&!fe)return;const Ae=je=>{if(je.path!==N.path)return je;let Pe=je;return z&&je.star!==N.star&&(Pe={...Pe,star:N.star??null}),ne&&(Pe={...Pe,metrics:N.metrics??void 0}),fe&&je.comments!==N.comments&&(Pe={...Pe,comments:N.comments??""}),Pe},Et=je=>{if(!je)return je;let Pe=!1;const mt=je.items.map(cn=>{const Vs=Ae(cn);return Vs!==cn&&(Pe=!0),Vs});return Pe?{...je,items:mt}:je};et.setQueriesData({predicate:({queryKey:je})=>Array.isArray(je)&&je[0]==="folder"},Et),et.setQueriesData({predicate:({queryKey:je})=>Array.isArray(je)&&je[0]==="search"},Et)},[et]),{connectionStatus:Us,connectionLabel:_u,presence:Au,editingCount:Fu,recentEditActive:Ou,hasEdits:gl,lastEditedLabel:vl,persistenceEnabled:ae,indexing:he,compareExportCapability:Ge,highlightedPaths:Yn,onVisiblePathsChange:p0,offViewSummary:m0,recentTouchesDisplay:g0,clearOffViewActivity:v0}=dj({current:e,currentGalleryId:Le,itemPaths:it,items:D,queryClient:et,updateItemCaches:Lu,setLocalStarOverrides:de});u.useEffect(()=>{const N=Ej(A,he);!N||N===A||(K(N),Ng(Xl.scanGeneration,N))},[he,A]);const Qi=u.useMemo(()=>Nj(he,{scanGeneration:A,recentGeneration:X}),[he,X,A]);u.useEffect(()=>{W(N=>N===Qi.scanStableActive?N:Qi.scanStableActive)},[Qi.scanStableActive]);const y0=u.useCallback(()=>{const N=Nu(he==null?void 0:he.generation)??A;N&&(X!==N&&(te(N),Ng(Xl.recentGeneration,N)),S(z=>z.sort.kind==="builtin"&&z.sort.key==="added"&&z.sort.dir==="desc"?z:{...z,sort:{kind:"builtin",key:"added",dir:"desc"}}))},[he==null?void 0:he.generation,X,A]),x0=u.useCallback(N=>{N&&Ie(e,N)},[e,Ie]),w0=u.useMemo(()=>se(e),[e,se]);u.useEffect(()=>{Ze(N=>N+1)},[e]);const Du=u.useCallback(()=>{U(N=>N+1)},[]),xh=u.useCallback(N=>{const z=Rt(N||"/");return z===""?"/":z},[]),wh=u.useCallback(N=>{const z=ne=>N==="/"?!0:ne===N||ne.startsWith(`${N}/`);et.invalidateQueries({predicate:({queryKey:ne})=>{if(!Array.isArray(ne)||ne[0]!=="folder")return!1;const fe=typeof ne[1]=="string"?ne[1]:"";return z(fe)}})},[et]),zu=u.useCallback(async N=>{const z=xh(N);await ge.refreshFolder(z),wh(z),Du(),we(z),(e===z||e.startsWith(z==="/"?"/":`${z}/`))&&(xt(ne=>ne+1),await Fn()),Bd.evictPrefix(z),Gs.evictPrefix(z)},[e,Du,we,wh,xh,Fn]),S0=u.useCallback(async()=>{try{await zu(e)}catch(N){console.error("Failed to refresh folder:",N)}},[e,zu]),b0=u.useMemo(()=>SM(o?Dn:On,Q),[o,Dn,On,Q]),wr=u.useMemo(()=>bM(o?Dn:On),[o,Dn,On]);u.useEffect(()=>{Lt||wr.length&&S(N=>{const z=N.selectedMetric&&wr.includes(N.selectedMetric)?N.selectedMetric:wr[0];return z===N.selectedMetric?N:{...N,selectedMetric:z}})},[wr,Lt]),u.useEffect(()=>{Lt||x.sort.kind==="metric"&&(wr.includes(x.sort.key)||S(N=>({...N,sort:{kind:"builtin",key:"added",dir:N.sort.dir}})))},[wr,x.sort,Lt]);const yl=u.useMemo(()=>uN(x.filters),[x.filters]),$u=Lt||Vt||yl>0,C0=Zt.state==="syncing"?"Syncing":Zt.state==="error"?Zt.message?`Not saved  ${Zt.message}`:"Not saved  retry":"All changes saved",k0=wn!=null&&wn>sM,E0=Us==="offline"||Us==="connecting"||Us==="idle",N0=Us==="reconnecting"||gr||Zt.state==="error"||k0,M0=nM({isOffline:E0,isUnstable:N0,recentEditActive:Ou,editingCount:Fu}),j0=CM(Lt,$u,ie,ve),P0=kM(Lt,$u,Y,ve,be,e),Sh=u.useMemo(()=>EM(o),[o]),bh=u.useMemo(()=>NM(o!==null,yl,ie,Y),[o,yl,ie,Y]),R0=!Lt&&!Vt&&D.length===0&&(Gn||Ee),_t=u.useCallback(N=>{S(z=>({...z,filters:N(z.filters)}))},[]),T0=u.useCallback(N=>{S(z=>({...z,filters:N}))},[]),Bu=u.useCallback(()=>{_t(N=>Tc(N,[]))},[_t]),Ch=u.useCallback(()=>{S(N=>({...N,filters:{and:[]}}))},[]),Uu=u.useCallback(()=>{l(null);const N=We.current;We.current=null,N&&N.length?(He(N),yr()):He([])},[yr,He]),I0=u.useCallback(()=>{o&&Uu(),r(""),S(N=>({...N,filters:{and:[]}}))},[Uu,o]),L0=u.useCallback(async N=>{!o&&We.current===null&&(We.current=ze);const z=await ge.searchEmbeddings(N);if(l({embedding:z.embedding,queryPath:N.query_path??null,queryVector:N.query_vector_b64??null,topK:N.top_k??50,minScore:N.min_score??null,items:z.items,createdAt:Date.now()}),z.items.length){const ne=N.query_path&&z.items.some(fe=>fe.path===N.query_path)?N.query_path:z.items[0].path;He([ne]),yr()}else He([])},[yr,ze,He,o]),Vu=u.useCallback((N,z)=>{_t(ne=>aN(ne,N,z))},[_t]),kh=u.useMemo(()=>kj(x.filters,{clearStars:Bu,clearStarsNotIn:()=>_t(N=>Bx(N,[])),clearNameContains:()=>_t(N=>Ux(N,"")),clearNameNotContains:()=>_t(N=>Vx(N,"")),clearCommentsContains:()=>_t(N=>Wx(N,"")),clearCommentsNotContains:()=>_t(N=>Hx(N,"")),clearUrlContains:()=>_t(N=>Qx(N,"")),clearUrlNotContains:()=>_t(N=>Kx(N,"")),clearDateRange:()=>_t(N=>rf(N,null)),clearWidthCompare:()=>_t(N=>ga(N,null)),clearHeightCompare:()=>_t(N=>va(N,null)),clearMetricRange:N=>Vu(N,null)}),[x.filters,Bu,Vu,_t]),_0=u.useCallback(N=>{const z=new Set(Ne);z.has(N)?z.delete(N):z.add(N),S(ne=>({...ne,filters:Tc(ne.filters,Array.from(z))}))},[Ne]),A0=u.useCallback(()=>{L(!0),I("metrics")},[]),F0=u.useCallback(N=>{S(z=>({...z,sort:N})),N.kind==="builtin"&&N.key==="random"&&v(Date.now())},[]),Eh=u.useCallback(N=>{if(N==="/"||N==="")return"Lenslet | Root";const z=N.split("/").filter(Boolean);if(!z.length)return"Lenslet";const ne=z.slice(-2).join("/");return`Lenslet | ${z.length>2?`.../${ne}`:`/${ne}`}`},[]),O0=u.useMemo(()=>vE(e),[e]);u.useEffect(()=>{document.title=Eh(e)},[e,Eh]),u.useEffect(()=>{let N=!0;return ge.getViews().then(z=>{N&&P(z.views||[])}).catch(()=>{N&&P([])}),()=>{N=!1}},[]),u.useEffect(()=>{Vt&&(He([]),fl(e))},[fl,e,Vt,He]),u.useEffect(()=>{const N=V.current,z=me.current;if(!N||!z)return;const ne=()=>{const Ae=Math.max(48,Math.round(z.getBoundingClientRect().height));N.style.setProperty("--toolbar-h",`${Ae}px`)};ne();const fe=window.ResizeObserver;if(fe){const Ae=new fe(ne);return Ae.observe(z),()=>Ae.disconnect()}return window.addEventListener("resize",ne),()=>window.removeEventListener("resize",ne)},[]),u.useEffect(()=>{try{const N=localStorage.getItem(ot.sortKey),z=localStorage.getItem(ot.sortDir),ne=localStorage.getItem(ot.sortSpec),fe=localStorage.getItem(ot.starFilters),Ae=localStorage.getItem(ot.filterAst),Et=localStorage.getItem(ot.selectedMetric),je=localStorage.getItem(ot.viewMode),Pe=localStorage.getItem(ot.gridItemSize),mt=localStorage.getItem(ot.leftOpen),cn=localStorage.getItem(ot.rightOpen),Ah=(Nt=>{if(!Nt)return null;const ct=Pc(Nt);return!ct||typeof ct!="object"?null:ct.kind==="builtin"&&(ct.key==="name"||ct.key==="added"||ct.key==="random")&&(ct.dir==="asc"||ct.dir==="desc")||ct.kind==="metric"&&typeof ct.key=="string"&&ct.key.length>0&&(ct.dir==="asc"||ct.dir==="desc")?ct:null})(ne)??{kind:"builtin",key:N==="name"||N==="added"||N==="random"?N:"added",dir:z==="asc"||z==="desc"?z:"desc"};Ah.key==="random"&&v(Date.now());let Hu=(Nt=>{if(!Nt)return null;const ct=Pc(Nt);return nf(ct)})(Ae)??{and:[]};if(fe){const Nt=Pc(fe);if(Array.isArray(Nt)){const ct=Nt.filter(X0=>[0,1,2,3,4,5].includes(X0));Hu=Tc(Hu,ct)}}if(S(Nt=>({...Nt,sort:Ah,filters:Hu,selectedMetric:Et||Nt.selectedMetric})),(je==="grid"||je==="adaptive")&&y(je),Pe){const Nt=Number(Pe);!isNaN(Nt)&&Nt>=80&&Nt<=500&&b(Nt)}(mt==="0"||mt==="false")&&L(!1),(cn==="0"||cn==="false")&&B(!1)}catch{}},[]),u.useEffect(()=>{Z&&(L(!1),B(!1))},[Z]),u.useEffect(()=>{if(typeof window>"u")return;const N=[1,1.25,1.5,1.75,2,3,4],z=Ae=>N.reduce((Et,je)=>Math.abs(je-Ae)<Math.abs(Et-Ae)?je:Et,N[0]),ne=()=>{var Vs;const Ae=window.devicePixelRatio||1,Et=z(Ae),je=((Vs=window.visualViewport)==null?void 0:Vs.scale)??1,Pe=Ae*je/Et;if(!Number.isFinite(Pe)){w(null);return}const mt=Math.round(Pe*100),cn=Math.min(500,Math.max(25,mt));w(cn)};ne(),window.addEventListener("resize",ne),window.addEventListener("orientationchange",ne);const fe=window.visualViewport;return fe&&fe.addEventListener("resize",ne),()=>{window.removeEventListener("resize",ne),window.removeEventListener("orientationchange",ne),fe&&fe.removeEventListener("resize",ne)}},[]),u.useEffect(()=>{try{localStorage.setItem(ot.sortKey,x.sort.kind==="builtin"?x.sort.key:"added"),localStorage.setItem(ot.sortDir,x.sort.dir),localStorage.setItem(ot.sortSpec,JSON.stringify(x.sort));const N=Km(x.filters);localStorage.setItem(ot.starFilters,JSON.stringify(N)),localStorage.setItem(ot.filterAst,JSON.stringify(x.filters)),x.selectedMetric?localStorage.setItem(ot.selectedMetric,x.selectedMetric):localStorage.removeItem(ot.selectedMetric),localStorage.setItem(ot.viewMode,g),localStorage.setItem(ot.gridItemSize,String(m)),localStorage.setItem(ot.leftOpen,M?"1":"0"),localStorage.setItem(ot.rightOpen,R?"1":"0")}catch{}},[x,g,m,M,R]),u.useEffect(()=>{if(typeof window>"u")return;const N=()=>G(window.innerWidth);return N(),window.addEventListener("resize",N),window.addEventListener("orientationchange",N),()=>{window.removeEventListener("resize",N),window.removeEventListener("orientationchange",N)}},[]);const xl=F<=Gr.mobileMax,Nh=ql(m);u.useEffect(()=>{xl||E&&j(!1)},[xl,E]),u.useEffect(()=>{const N=Se.current;if(!N)return;const z=fe=>Math.min(500,Math.max(80,fe)),ne=fe=>{fe.ctrlKey&&(Ke||_e||(fe.preventDefault(),b(Ae=>z(Ae+(fe.deltaY<0?20:-20)))))};return N.addEventListener("wheel",ne,{passive:!1}),()=>N.removeEventListener("wheel",ne)},[Ke,_e]),u.useEffect(()=>{if(Ke||_e)return;const N=Se.current;if(!N)return;const z=Pe=>Math.min(500,Math.max(80,Pe));let ne=null;const fe=Pe=>{if(Pe.length<2)return 0;const[mt,cn]=[Pe[0],Pe[1]];return Math.hypot(mt.clientX-cn.clientX,mt.clientY-cn.clientY)},Ae=Pe=>{if(Pe.touches.length!==2)return;const mt=fe(Pe.touches);mt&&(ne={dist:mt,size:Nh.current})},Et=Pe=>{if(!ne||Pe.touches.length!==2)return;const mt=fe(Pe.touches);if(!mt)return;Pe.preventDefault();const cn=z(ne.size*(mt/ne.dist));b(cn)},je=()=>{ne=null};return N.addEventListener("touchstart",Ae,{passive:!0}),N.addEventListener("touchmove",Et,{passive:!1}),N.addEventListener("touchend",je),N.addEventListener("touchcancel",je),()=>{N.removeEventListener("touchstart",Ae),N.removeEventListener("touchmove",Et),N.removeEventListener("touchend",je),N.removeEventListener("touchcancel",je)}},[Ke,_e,Nh]),u.useEffect(()=>{Mg(cM(it,Ke),"viewer")},[Ke,it]),u.useEffect(()=>{_e&&Mg(dM(qn,Vi),"compare")},[_e,qn,Vi]);const Wu=u.useCallback(N=>{dl();const z=Rt(N);t(z),Dx(z)},[dl]),{uploading:D0,actionError:Mh,isDraggingOver:z0,moveDialog:jh,moveFolders:$0,moveFoldersLoading:B0,ctx:Ph,setCtx:U0,closeMoveDialog:V0,openUploadPicker:W0,handleUploadInputChange:H0,openGridActions:Rh,openFolderActions:Th,openMoveDialogForPaths:Q0,moveSelectedToFolder:K0}=mj({appRef:V,uploadInputRef:Be,current:e,currentDirCount:((_h=st==null?void 0:st.dirs)==null?void 0:_h.length)??0,selectedPaths:ze,setSelectedPaths:He,refetch:Fn,invalidateDerivedCounts:Du}),G0=u.useCallback(async()=>{const N=window.prompt("Save Smart Folder as:","New Smart Folder");if(!N)return;const z=pE(N,T),ne={id:z,name:N,pool:{kind:"folder",path:e},view:JSON.parse(JSON.stringify(x))},fe=[...T.filter(Ae=>Ae.id!==z),ne];P(fe),O(z);try{await ge.saveViews({version:1,views:fe})}catch(Ae){if(Ae instanceof sn&&Ae.status===403){const Et=new Blob([JSON.stringify({version:1,views:fe},null,2)],{type:"application/json"});ko(Et,`lenslet-smart-folder-${z}.json`),alert("No-write mode: exported Smart Folder JSON instead of saving.");return}console.error("Failed to save Smart Folder:",Ae)}},[e,x,T]);u.useEffect(()=>{if(!_)return;const N=T.find(fe=>fe.id===_);if(!N){O(null);return}const z=N.pool.path===e,ne=JSON.stringify(N.view)===JSON.stringify(x);(!z||!ne)&&O(null)},[_,T,e,x]);const Ih=ql({current:e,items:D,selectedPaths:ze,viewer:Ke,compareOpen:_e,mobileSelectMode:E,openFolder:Wu});u.useEffect(()=>{const N=z=>{const ne=Ih.current;if(!dh(z.target)){if((z.ctrlKey||z.metaKey)&&z.key.toLowerCase()==="b"){z.preventDefault(),z.altKey?B(fe=>!fe):L(fe=>!fe);return}if(!(ne.viewer||ne.compareOpen)){if(z.key==="Backspace"||z.key==="Delete")z.preventDefault(),ne.openFolder(Qm(ne.current));else if((z.ctrlKey||z.metaKey)&&z.key.toLowerCase()==="a")z.preventDefault(),He(ne.items.map(fe=>fe.path));else if(z.key==="Escape"){if(ne.selectedPaths.length){z.preventDefault(),He([]);return}ne.mobileSelectMode&&(z.preventDefault(),j(!1))}else if(z.key==="/"){z.preventDefault();const fe=document.querySelector(".toolbar-right .input");fe==null||fe.focus()}}}};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[Ih,He]);const Lh=u.useMemo(()=>yb({viewportWidth:F,leftOpen:M,rightOpen:R,leftWidth:Ln,rightWidth:It}),[F,M,R,Ln,It]),q0=M?`${Lh.leftWidth}px`:"0px",Y0=R?`${Lh.rightWidth}px`:"0px";return a.jsxs("div",{className:"app-shell grid h-full grid-cols-[var(--left)_1fr_var(--right)]",ref:V,style:{"--left":q0,"--right":Y0},children:[a.jsx(Sb,{rootRef:me,onSearch:r,viewerActive:!!Ke,onBack:zs,zoomPercent:Ke?f:void 0,onZoomPercentChange:N=>d(N),currentLabel:O0,itemCount:j0,totalCount:P0,sortSpec:x.sort,metricKeys:wr,onSortChange:F0,sortDisabled:Lt||Qi.sortLocked,filterCount:yl,onOpenFilters:A0,starFilters:Ne,onToggleStar:_0,onClearStars:Bu,onClearFilters:Ch,starCounts:b0,viewMode:g,onViewMode:y,gridItemSize:m,onGridItemSize:b,leftOpen:M,rightOpen:R,onToggleLeft:()=>L(N=>!N),onToggleRight:()=>B(N=>!N),onPrevImage:()=>rs(-1),onNextImage:()=>rs(1),canPrevImage:ul,canNextImage:cl,searchDisabled:Lt,searchPlaceholder:Lt?"Exit similarity to search":void 0,onUploadClick:W0,uploadBusy:D0,uploadDisabled:_e,multiSelectMode:E,selectedCount:ze.length,onToggleMultiSelectMode:xl?()=>j(N=>!N):void 0,syncIndicator:{state:M0,presence:Au,syncLabel:C0,connectionLabel:_u,lastEditedLabel:vl,hasEdits:gl,localTypingActive:An,recentTouches:g0}}),a.jsx("input",{ref:Be,type:"file",multiple:!0,accept:"image/*",className:"sr-only",onChange:H0}),M&&a.jsx(eM,{leftTool:$,onToolChange:I,compareEnabled:Ds,compareActive:_e,onOpenCompare:Hi,views:T,activeViewId:_,onActivateView:N=>{var ne;O(N.id);const z=nf((ne=N.view)==null?void 0:ne.filters)??{and:[]};S({...N.view,filters:z}),Wu(N.pool.path)},onSaveView:G0,current:e,data:st,onOpenFolder:N=>{O(null),Wu(N)},onOpenFolderActions:Th,onPullRefreshFolders:S0,onContextMenu:(N,z)=>{N.preventDefault(),Th(z,{x:N.clientX,y:N.clientY})},countVersion:q,items:Iu,filteredItems:D,metricKeys:wr,selectedItems:il,selectedMetric:x.selectedMetric,onSelectMetric:N=>S(z=>({...z,selectedMetric:N})),filters:x.filters,onChangeRange:Vu,onChangeFilters:T0,onResize:_n}),a.jsxs("div",{className:"grid-shell col-start-2 row-start-2 relative overflow-hidden flex flex-col",ref:Se,children:[a.jsx("div",{"aria-live":"polite",className:"sr-only",children:ze.length?`${ze.length} selected`:""}),a.jsx(tM,{persistenceEnabled:ae,indexing:he,showSwitchToMostRecentBanner:Qi.showSwitchToMostRecentBanner,onSwitchToMostRecent:y0,offViewSummary:m0,canRevealOffView:$u,onRevealOffView:I0,onClearOffView:v0,browserZoomPercent:h}),Mh&&a.jsx("div",{className:"border-b border-border bg-panel px-3 py-2",children:a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",children:Mh})}),o&&a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"font-semibold",children:"Similarity mode"}),a.jsxs("span",{className:"text-muted",children:["Embedding: ",o.embedding]}),Sh&&a.jsxs("span",{className:"text-muted",children:["Query: ",Sh]}),bh&&a.jsxs("span",{className:"text-muted",children:["Results: ",bh]}),a.jsxs("span",{className:"text-muted",children:["Top K: ",o.topK]}),o.minScore!=null&&a.jsxs("span",{className:"text-muted",children:["Min score: ",o.minScore]})]}),a.jsx("button",{className:"btn btn-sm",onClick:Uu,children:"Exit similarity"})]})}),kh.length>0&&a.jsx("div",{className:"sticky top-0 z-10 px-3 py-2 bg-panel border-b border-border",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Filters"}),kh.map(N=>a.jsxs("span",{className:"filter-chip",children:[a.jsx("span",{className:"truncate max-w-[240px]",title:N.label,children:N.label}),a.jsx("button",{className:"filter-chip-remove","aria-label":`Clear filter ${N.label}`,onClick:N.onRemove,children:""})]},N.id)),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:Ch,children:"Clear all"})]})}),a.jsxs("div",{className:"flex-1 min-h-0 relative",children:[a.jsx(KC,{items:D,selected:ze,restoreToSelectionToken:un,restoreToTopAnchorToken:pe,restoreToTopAnchorPath:w0,multiSelectMode:xl&&E,onSelectionChange:He,onOpenViewer:N=>{Pu(N),Wi(N),He([N])},highlight:Vt?vr:"",recentlyUpdated:Yn,onVisiblePathsChange:p0,onTopAnchorPathChange:x0,suppressSelectionHighlight:ju,viewMode:g,targetCellSize:m,onContextMenuItem:(N,z)=>{N.preventDefault(),Rh(z,{x:N.clientX,y:N.clientY})},onOpenItemActions:Rh,scrollRef:ce,hideScrollbar:ml,isHydrationLoading:R0,hydrationProgress:le}),ml&&Bs&&a.jsx(YC,{items:D,metricKey:Bs,scrollRef:ce,sortDir:x.sort.dir})]})]}),R&&a.jsx(zE,{path:ze[0]??null,selectedPaths:ze,items:D,compareActive:_e,compareA:ol,compareB:ll,onOpenCompare:Hi,sortSpec:x.sort,onResize:Jt,onStarChanged:(N,z)=>{de(ne=>{const fe={...ne};for(const Ae of N)fe[Ae]=z;return fe})},onFindSimilar:()=>i(!0),embeddingsAvailable:Ui,embeddingsLoading:ns,compareExportSupportsV2:Ge.supportsV2,compareExportMaxPathsV2:Ge.maxPathsV2,onLocalTypingChange:ke}),a.jsx($E,{open:s,embeddings:Bi,rejected:Fs,selectedPath:ze[0]??null,embeddingsLoading:ns,embeddingsError:Os,onClose:()=>i(!1),onSearch:L0}),Ke&&a.jsx(ck,{path:Ke,onClose:zs,onZoomChange:N=>p(Math.round(N)),requestedZoomPercent:c,onZoomRequestConsumed:()=>d(null),canPrev:ul,canNext:cl,onNavigate:rs}),_e&&a.jsx(vk,{aItem:ol,bItem:ll,index:Vi,total:xr.length,canPrev:Mu,canNext:al,onNavigate:Ru,onClose:$s}),jh&&a.jsx(fM,{paths:jh.paths,defaultDestination:e,destinations:$0,loadingDestinations:B0,onClose:V0,onSubmit:K0}),z0&&a.jsx("div",{className:"toolbar-offset fixed inset-0 left-[var(--left)] right-[var(--right)] bg-accent/10 border-2 border-dashed border-accent text-text flex items-center justify-center text-lg z-overlay pointer-events-none",children:"Drop images to upload"}),Ph&&a.jsx(yM,{ctx:Ph,current:e,items:D,setCtx:U0,onRefetch:Fn,onOpenMoveDialog:Q0,onRefreshFolder:zu})]})}const jj=new qS({defaultOptions:{queries:{staleTime:1e4,gcTime:5*6e4,retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),1e4),refetchOnWindowFocus:!1,refetchOnReconnect:"always"},mutations:{retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),5e3)}}});function Pj(){return a.jsx(YS,{client:jj,children:a.jsx(Mj,{})})}Xy(document.getElementById("root")).render(a.jsx(Pj,{}));
