var w0=Object.defineProperty;var Sh=e=>{throw TypeError(e)};var S0=(e,t,n)=>t in e?w0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var lt=(e,t,n)=>S0(e,typeof t!="symbol"?t+"":t,n),Ru=(e,t,n)=>t.has(e)||Sh("Cannot "+n);var k=(e,t,n)=>(Ru(e,t,"read from private field"),n?n.call(e):t.get(e)),le=(e,t,n)=>t.has(e)?Sh("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),J=(e,t,n,r)=>(Ru(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),ve=(e,t,n)=>(Ru(e,t,"access private method"),n);var nl=(e,t,n,r)=>({set _(s){J(e,t,s,n)},get _(){return k(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function b0(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var gg={exports:{}},Fa={},vg={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zo=Symbol.for("react.element"),C0=Symbol.for("react.portal"),k0=Symbol.for("react.fragment"),E0=Symbol.for("react.strict_mode"),N0=Symbol.for("react.profiler"),j0=Symbol.for("react.provider"),M0=Symbol.for("react.context"),P0=Symbol.for("react.forward_ref"),R0=Symbol.for("react.suspense"),T0=Symbol.for("react.memo"),I0=Symbol.for("react.lazy"),bh=Symbol.iterator;function _0(e){return e===null||typeof e!="object"?null:(e=bh&&e[bh]||e["@@iterator"],typeof e=="function"?e:null)}var yg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},xg=Object.assign,wg={};function Ni(e,t,n){this.props=e,this.context=t,this.refs=wg,this.updater=n||yg}Ni.prototype.isReactComponent={};Ni.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ni.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Sg(){}Sg.prototype=Ni.prototype;function Yd(e,t,n){this.props=e,this.context=t,this.refs=wg,this.updater=n||yg}var Xd=Yd.prototype=new Sg;Xd.constructor=Yd;xg(Xd,Ni.prototype);Xd.isPureReactComponent=!0;var Ch=Array.isArray,bg=Object.prototype.hasOwnProperty,qd={current:null},Cg={key:!0,ref:!0,__self:!0,__source:!0};function kg(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)bg.call(t,r)&&!Cg.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:zo,type:e,key:i,ref:o,props:s,_owner:qd.current}}function L0(e,t){return{$$typeof:zo,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Gd(e){return typeof e=="object"&&e!==null&&e.$$typeof===zo}function A0(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var kh=/\/+/g;function Tu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?A0(""+e.key):t.toString(36)}function _l(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case zo:case C0:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+Tu(o,0):r,Ch(s)?(n="",e!=null&&(n=e.replace(kh,"$&/")+"/"),_l(s,t,n,"",function(d){return d})):s!=null&&(Gd(s)&&(s=L0(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(kh,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",Ch(e))for(var l=0;l<e.length;l++){i=e[l];var u=r+Tu(i,l);o+=_l(i,t,n,u,s)}else if(u=_0(e),typeof u=="function")for(e=u.call(e),l=0;!(i=e.next()).done;)i=i.value,u=r+Tu(i,l++),o+=_l(i,t,n,u,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function rl(e,t,n){if(e==null)return e;var r=[],s=0;return _l(e,r,"","",function(i){return t.call(n,i,s++)}),r}function F0(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ot={current:null},Ll={transition:null},O0={ReactCurrentDispatcher:Ot,ReactCurrentBatchConfig:Ll,ReactCurrentOwner:qd};function Eg(){throw Error("act(...) is not supported in production builds of React.")}Ce.Children={map:rl,forEach:function(e,t,n){rl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return rl(e,function(){t++}),t},toArray:function(e){return rl(e,function(t){return t})||[]},only:function(e){if(!Gd(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ce.Component=Ni;Ce.Fragment=k0;Ce.Profiler=N0;Ce.PureComponent=Yd;Ce.StrictMode=E0;Ce.Suspense=R0;Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O0;Ce.act=Eg;Ce.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=xg({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=qd.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)bg.call(t,u)&&!Cg.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&l!==void 0?l[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:zo,type:e.type,key:s,ref:i,props:r,_owner:o}};Ce.createContext=function(e){return e={$$typeof:M0,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:j0,_context:e},e.Consumer=e};Ce.createElement=kg;Ce.createFactory=function(e){var t=kg.bind(null,e);return t.type=e,t};Ce.createRef=function(){return{current:null}};Ce.forwardRef=function(e){return{$$typeof:P0,render:e}};Ce.isValidElement=Gd;Ce.lazy=function(e){return{$$typeof:I0,_payload:{_status:-1,_result:e},_init:F0}};Ce.memo=function(e,t){return{$$typeof:T0,type:e,compare:t===void 0?null:t}};Ce.startTransition=function(e){var t=Ll.transition;Ll.transition={};try{e()}finally{Ll.transition=t}};Ce.unstable_act=Eg;Ce.useCallback=function(e,t){return Ot.current.useCallback(e,t)};Ce.useContext=function(e){return Ot.current.useContext(e)};Ce.useDebugValue=function(){};Ce.useDeferredValue=function(e){return Ot.current.useDeferredValue(e)};Ce.useEffect=function(e,t){return Ot.current.useEffect(e,t)};Ce.useId=function(){return Ot.current.useId()};Ce.useImperativeHandle=function(e,t,n){return Ot.current.useImperativeHandle(e,t,n)};Ce.useInsertionEffect=function(e,t){return Ot.current.useInsertionEffect(e,t)};Ce.useLayoutEffect=function(e,t){return Ot.current.useLayoutEffect(e,t)};Ce.useMemo=function(e,t){return Ot.current.useMemo(e,t)};Ce.useReducer=function(e,t,n){return Ot.current.useReducer(e,t,n)};Ce.useRef=function(e){return Ot.current.useRef(e)};Ce.useState=function(e){return Ot.current.useState(e)};Ce.useSyncExternalStore=function(e,t,n){return Ot.current.useSyncExternalStore(e,t,n)};Ce.useTransition=function(){return Ot.current.useTransition()};Ce.version="18.3.1";vg.exports=Ce;var c=vg.exports;const Wr=b0(c);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D0=c,z0=Symbol.for("react.element"),$0=Symbol.for("react.fragment"),B0=Object.prototype.hasOwnProperty,U0=D0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,V0={key:!0,ref:!0,__self:!0,__source:!0};function Ng(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)B0.call(t,r)&&!V0.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:z0,type:e,key:i,ref:o,props:s,_owner:U0.current}}Fa.Fragment=$0;Fa.jsx=Ng;Fa.jsxs=Ng;gg.exports=Fa;var a=gg.exports,jg={exports:{}},rn={},Mg={exports:{}},Pg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(T,L){var O=T.length;T.push(L);e:for(;0<O;){var Y=O-1>>>1,$=T[Y];if(0<s($,L))T[Y]=L,T[O]=$,O=Y;else break e}}function n(T){return T.length===0?null:T[0]}function r(T){if(T.length===0)return null;var L=T[0],O=T.pop();if(O!==L){T[0]=O;e:for(var Y=0,$=T.length,A=$>>>1;Y<A;){var V=2*(Y+1)-1,K=T[V],G=V+1,re=T[G];if(0>s(K,O))G<$&&0>s(re,K)?(T[Y]=re,T[G]=O,Y=G):(T[Y]=K,T[V]=O,Y=V);else if(G<$&&0>s(re,O))T[Y]=re,T[G]=O,Y=G;else break e}}return L}function s(T,L){var O=T.sortIndex-L.sortIndex;return O!==0?O:T.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var u=[],d=[],f=1,p=null,h=3,w=!1,x=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(T){for(var L=n(d);L!==null;){if(L.callback===null)r(d);else if(L.startTime<=T)r(d),L.sortIndex=L.expirationTime,t(u,L);else break;L=n(d)}}function g(T){if(S=!1,y(T),!x)if(n(u)!==null)x=!0,I(b);else{var L=n(d);L!==null&&R(g,L.startTime-T)}}function b(T,L){x=!1,S&&(S=!1,v(N),N=-1),w=!0;var O=h;try{for(y(L),p=n(u);p!==null&&(!(p.expirationTime>L)||T&&!B());){var Y=p.callback;if(typeof Y=="function"){p.callback=null,h=p.priorityLevel;var $=Y(p.expirationTime<=L);L=e.unstable_now(),typeof $=="function"?p.callback=$:p===n(u)&&r(u),y(L)}else r(u);p=n(u)}if(p!==null)var A=!0;else{var V=n(d);V!==null&&R(g,V.startTime-L),A=!1}return A}finally{p=null,h=O,w=!1}}var E=!1,M=null,N=-1,_=5,P=-1;function B(){return!(e.unstable_now()-P<_)}function F(){if(M!==null){var T=e.unstable_now();P=T;var L=!0;try{L=M(!0,T)}finally{L?Q():(E=!1,M=null)}}else E=!1}var Q;if(typeof m=="function")Q=function(){m(F)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,W=Z.port2;Z.port1.onmessage=F,Q=function(){W.postMessage(null)}}else Q=function(){C(F,0)};function I(T){M=T,E||(E=!0,Q())}function R(T,L){N=C(function(){T(e.unstable_now())},L)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(T){T.callback=null},e.unstable_continueExecution=function(){x||w||(x=!0,I(b))},e.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<T?Math.floor(1e3/T):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(T){switch(h){case 1:case 2:case 3:var L=3;break;default:L=h}var O=h;h=L;try{return T()}finally{h=O}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(T,L){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var O=h;h=T;try{return L()}finally{h=O}},e.unstable_scheduleCallback=function(T,L,O){var Y=e.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?Y+O:Y):O=Y,T){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=O+$,T={id:f++,callback:L,priorityLevel:T,startTime:O,expirationTime:$,sortIndex:-1},O>Y?(T.sortIndex=O,t(d,T),n(u)===null&&T===n(d)&&(S?(v(N),N=-1):S=!0,R(g,O-Y))):(T.sortIndex=$,t(u,T),x||w||(x=!0,I(b))),T},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(T){var L=h;return function(){var O=h;h=L;try{return T.apply(this,arguments)}finally{h=O}}}})(Pg);Mg.exports=Pg;var W0=Mg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H0=c,nn=W0;function H(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Rg=new Set,po={};function Ms(e,t){yi(e,t),yi(e+"Capture",t)}function yi(e,t){for(po[e]=t,e=0;e<t.length;e++)Rg.add(t[e])}var or=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xc=Object.prototype.hasOwnProperty,Q0=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Eh={},Nh={};function K0(e){return xc.call(Nh,e)?!0:xc.call(Eh,e)?!1:Q0.test(e)?Nh[e]=!0:(Eh[e]=!0,!1)}function Y0(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function X0(e,t,n,r){if(t===null||typeof t>"u"||Y0(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Dt(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var St={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){St[e]=new Dt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];St[t]=new Dt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){St[e]=new Dt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){St[e]=new Dt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){St[e]=new Dt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){St[e]=new Dt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){St[e]=new Dt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){St[e]=new Dt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){St[e]=new Dt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Jd=/[\-:]([a-z])/g;function Zd(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Jd,Zd);St[t]=new Dt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Jd,Zd);St[t]=new Dt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Jd,Zd);St[t]=new Dt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){St[e]=new Dt(e,1,!1,e.toLowerCase(),null,!1,!1)});St.xlinkHref=new Dt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){St[e]=new Dt(e,1,!1,e.toLowerCase(),null,!0,!0)});function ef(e,t,n,r){var s=St.hasOwnProperty(t)?St[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(X0(t,n,s,r)&&(n=null),r||s===null?K0(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var cr=H0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,sl=Symbol.for("react.element"),zs=Symbol.for("react.portal"),$s=Symbol.for("react.fragment"),tf=Symbol.for("react.strict_mode"),wc=Symbol.for("react.profiler"),Tg=Symbol.for("react.provider"),Ig=Symbol.for("react.context"),nf=Symbol.for("react.forward_ref"),Sc=Symbol.for("react.suspense"),bc=Symbol.for("react.suspense_list"),rf=Symbol.for("react.memo"),xr=Symbol.for("react.lazy"),_g=Symbol.for("react.offscreen"),jh=Symbol.iterator;function Fi(e){return e===null||typeof e!="object"?null:(e=jh&&e[jh]||e["@@iterator"],typeof e=="function"?e:null)}var Xe=Object.assign,Iu;function Xi(e){if(Iu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Iu=t&&t[1]||""}return`
`+Iu+e}var _u=!1;function Lu(e,t){if(!e||_u)return"";_u=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=o&&0<=l);break}}}finally{_u=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Xi(e):""}function q0(e){switch(e.tag){case 5:return Xi(e.type);case 16:return Xi("Lazy");case 13:return Xi("Suspense");case 19:return Xi("SuspenseList");case 0:case 2:case 15:return e=Lu(e.type,!1),e;case 11:return e=Lu(e.type.render,!1),e;case 1:return e=Lu(e.type,!0),e;default:return""}}function Cc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $s:return"Fragment";case zs:return"Portal";case wc:return"Profiler";case tf:return"StrictMode";case Sc:return"Suspense";case bc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Ig:return(e.displayName||"Context")+".Consumer";case Tg:return(e._context.displayName||"Context")+".Provider";case nf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case rf:return t=e.displayName||null,t!==null?t:Cc(e.type)||"Memo";case xr:t=e._payload,e=e._init;try{return Cc(e(t))}catch{}}return null}function G0(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cc(t);case 8:return t===tf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Hr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Lg(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function J0(e){var t=Lg(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function il(e){e._valueTracker||(e._valueTracker=J0(e))}function Ag(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Lg(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ea(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function kc(e,t){var n=t.checked;return Xe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Mh(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Hr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Fg(e,t){t=t.checked,t!=null&&ef(e,"checked",t,!1)}function Ec(e,t){Fg(e,t);var n=Hr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Nc(e,t.type,n):t.hasOwnProperty("defaultValue")&&Nc(e,t.type,Hr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ph(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Nc(e,t,n){(t!=="number"||ea(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var qi=Array.isArray;function Gs(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Hr(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function jc(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(H(91));return Xe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Rh(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(H(92));if(qi(n)){if(1<n.length)throw Error(H(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Hr(n)}}function Og(e,t){var n=Hr(t.value),r=Hr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Th(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Dg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mc(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Dg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ol,zg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ol=ol||document.createElement("div"),ol.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ol.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function mo(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var to={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Z0=["Webkit","ms","Moz","O"];Object.keys(to).forEach(function(e){Z0.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),to[t]=to[e]})});function $g(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||to.hasOwnProperty(e)&&to[e]?(""+t).trim():t+"px"}function Bg(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=$g(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var ew=Xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Pc(e,t){if(t){if(ew[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(H(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(H(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(H(61))}if(t.style!=null&&typeof t.style!="object")throw Error(H(62))}}function Rc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tc=null;function sf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ic=null,Js=null,Zs=null;function Ih(e){if(e=Uo(e)){if(typeof Ic!="function")throw Error(H(280));var t=e.stateNode;t&&(t=Ba(t),Ic(e.stateNode,e.type,t))}}function Ug(e){Js?Zs?Zs.push(e):Zs=[e]:Js=e}function Vg(){if(Js){var e=Js,t=Zs;if(Zs=Js=null,Ih(e),t)for(e=0;e<t.length;e++)Ih(t[e])}}function Wg(e,t){return e(t)}function Hg(){}var Au=!1;function Qg(e,t,n){if(Au)return e(t,n);Au=!0;try{return Wg(e,t,n)}finally{Au=!1,(Js!==null||Zs!==null)&&(Hg(),Vg())}}function go(e,t){var n=e.stateNode;if(n===null)return null;var r=Ba(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(H(231,t,typeof n));return n}var _c=!1;if(or)try{var Oi={};Object.defineProperty(Oi,"passive",{get:function(){_c=!0}}),window.addEventListener("test",Oi,Oi),window.removeEventListener("test",Oi,Oi)}catch{_c=!1}function tw(e,t,n,r,s,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(f){this.onError(f)}}var no=!1,ta=null,na=!1,Lc=null,nw={onError:function(e){no=!0,ta=e}};function rw(e,t,n,r,s,i,o,l,u){no=!1,ta=null,tw.apply(nw,arguments)}function sw(e,t,n,r,s,i,o,l,u){if(rw.apply(this,arguments),no){if(no){var d=ta;no=!1,ta=null}else throw Error(H(198));na||(na=!0,Lc=d)}}function Ps(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Kg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function _h(e){if(Ps(e)!==e)throw Error(H(188))}function iw(e){var t=e.alternate;if(!t){if(t=Ps(e),t===null)throw Error(H(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return _h(s),e;if(i===r)return _h(s),t;i=i.sibling}throw Error(H(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?e:t}function Yg(e){return e=iw(e),e!==null?Xg(e):null}function Xg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Xg(e);if(t!==null)return t;e=e.sibling}return null}var qg=nn.unstable_scheduleCallback,Lh=nn.unstable_cancelCallback,ow=nn.unstable_shouldYield,lw=nn.unstable_requestPaint,nt=nn.unstable_now,aw=nn.unstable_getCurrentPriorityLevel,of=nn.unstable_ImmediatePriority,Gg=nn.unstable_UserBlockingPriority,ra=nn.unstable_NormalPriority,uw=nn.unstable_LowPriority,Jg=nn.unstable_IdlePriority,Oa=null,Bn=null;function cw(e){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(Oa,e,void 0,(e.current.flags&128)===128)}catch{}}var Mn=Math.clz32?Math.clz32:hw,dw=Math.log,fw=Math.LN2;function hw(e){return e>>>=0,e===0?32:31-(dw(e)/fw|0)|0}var ll=64,al=4194304;function Gi(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function sa(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Gi(l):(i&=o,i!==0&&(r=Gi(i)))}else o=n&~s,o!==0?r=Gi(o):i!==0&&(r=Gi(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Mn(t),s=1<<n,r|=e[n],t&=~s;return r}function pw(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mw(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-Mn(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=pw(l,t)):u<=t&&(e.expiredLanes|=l),i&=~l}}function Ac(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Zg(){var e=ll;return ll<<=1,!(ll&4194240)&&(ll=64),e}function Fu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function $o(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Mn(t),e[t]=n}function gw(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Mn(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function lf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Mn(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var Fe=0;function ev(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var tv,af,nv,rv,sv,Fc=!1,ul=[],Lr=null,Ar=null,Fr=null,vo=new Map,yo=new Map,Sr=[],vw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ah(e,t){switch(e){case"focusin":case"focusout":Lr=null;break;case"dragenter":case"dragleave":Ar=null;break;case"mouseover":case"mouseout":Fr=null;break;case"pointerover":case"pointerout":vo.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":yo.delete(t.pointerId)}}function Di(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Uo(t),t!==null&&af(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function yw(e,t,n,r,s){switch(t){case"focusin":return Lr=Di(Lr,e,t,n,r,s),!0;case"dragenter":return Ar=Di(Ar,e,t,n,r,s),!0;case"mouseover":return Fr=Di(Fr,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return vo.set(i,Di(vo.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,yo.set(i,Di(yo.get(i)||null,e,t,n,r,s)),!0}return!1}function iv(e){var t=ns(e.target);if(t!==null){var n=Ps(t);if(n!==null){if(t=n.tag,t===13){if(t=Kg(n),t!==null){e.blockedOn=t,sv(e.priority,function(){nv(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Al(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Oc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Tc=r,n.target.dispatchEvent(r),Tc=null}else return t=Uo(n),t!==null&&af(t),e.blockedOn=n,!1;t.shift()}return!0}function Fh(e,t,n){Al(e)&&n.delete(t)}function xw(){Fc=!1,Lr!==null&&Al(Lr)&&(Lr=null),Ar!==null&&Al(Ar)&&(Ar=null),Fr!==null&&Al(Fr)&&(Fr=null),vo.forEach(Fh),yo.forEach(Fh)}function zi(e,t){e.blockedOn===t&&(e.blockedOn=null,Fc||(Fc=!0,nn.unstable_scheduleCallback(nn.unstable_NormalPriority,xw)))}function xo(e){function t(s){return zi(s,e)}if(0<ul.length){zi(ul[0],e);for(var n=1;n<ul.length;n++){var r=ul[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Lr!==null&&zi(Lr,e),Ar!==null&&zi(Ar,e),Fr!==null&&zi(Fr,e),vo.forEach(t),yo.forEach(t),n=0;n<Sr.length;n++)r=Sr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Sr.length&&(n=Sr[0],n.blockedOn===null);)iv(n),n.blockedOn===null&&Sr.shift()}var ei=cr.ReactCurrentBatchConfig,ia=!0;function ww(e,t,n,r){var s=Fe,i=ei.transition;ei.transition=null;try{Fe=1,uf(e,t,n,r)}finally{Fe=s,ei.transition=i}}function Sw(e,t,n,r){var s=Fe,i=ei.transition;ei.transition=null;try{Fe=4,uf(e,t,n,r)}finally{Fe=s,ei.transition=i}}function uf(e,t,n,r){if(ia){var s=Oc(e,t,n,r);if(s===null)Qu(e,t,r,oa,n),Ah(e,r);else if(yw(s,e,t,n,r))r.stopPropagation();else if(Ah(e,r),t&4&&-1<vw.indexOf(e)){for(;s!==null;){var i=Uo(s);if(i!==null&&tv(i),i=Oc(e,t,n,r),i===null&&Qu(e,t,r,oa,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Qu(e,t,r,null,n)}}var oa=null;function Oc(e,t,n,r){if(oa=null,e=sf(r),e=ns(e),e!==null)if(t=Ps(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Kg(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return oa=e,null}function ov(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(aw()){case of:return 1;case Gg:return 4;case ra:case uw:return 16;case Jg:return 536870912;default:return 16}default:return 16}}var Ir=null,cf=null,Fl=null;function lv(){if(Fl)return Fl;var e,t=cf,n=t.length,r,s="value"in Ir?Ir.value:Ir.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return Fl=s.slice(e,1<r?1-r:void 0)}function Ol(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function cl(){return!0}function Oh(){return!1}function sn(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?cl:Oh,this.isPropagationStopped=Oh,this}return Xe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=cl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=cl)},persist:function(){},isPersistent:cl}),t}var ji={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},df=sn(ji),Bo=Xe({},ji,{view:0,detail:0}),bw=sn(Bo),Ou,Du,$i,Da=Xe({},Bo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ff,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==$i&&($i&&e.type==="mousemove"?(Ou=e.screenX-$i.screenX,Du=e.screenY-$i.screenY):Du=Ou=0,$i=e),Ou)},movementY:function(e){return"movementY"in e?e.movementY:Du}}),Dh=sn(Da),Cw=Xe({},Da,{dataTransfer:0}),kw=sn(Cw),Ew=Xe({},Bo,{relatedTarget:0}),zu=sn(Ew),Nw=Xe({},ji,{animationName:0,elapsedTime:0,pseudoElement:0}),jw=sn(Nw),Mw=Xe({},ji,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Pw=sn(Mw),Rw=Xe({},ji,{data:0}),zh=sn(Rw),Tw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Iw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_w={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Lw(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=_w[e])?!!t[e]:!1}function ff(){return Lw}var Aw=Xe({},Bo,{key:function(e){if(e.key){var t=Tw[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ol(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Iw[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ff,charCode:function(e){return e.type==="keypress"?Ol(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ol(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Fw=sn(Aw),Ow=Xe({},Da,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$h=sn(Ow),Dw=Xe({},Bo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ff}),zw=sn(Dw),$w=Xe({},ji,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bw=sn($w),Uw=Xe({},Da,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Vw=sn(Uw),Ww=[9,13,27,32],hf=or&&"CompositionEvent"in window,ro=null;or&&"documentMode"in document&&(ro=document.documentMode);var Hw=or&&"TextEvent"in window&&!ro,av=or&&(!hf||ro&&8<ro&&11>=ro),Bh=" ",Uh=!1;function uv(e,t){switch(e){case"keyup":return Ww.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Bs=!1;function Qw(e,t){switch(e){case"compositionend":return cv(t);case"keypress":return t.which!==32?null:(Uh=!0,Bh);case"textInput":return e=t.data,e===Bh&&Uh?null:e;default:return null}}function Kw(e,t){if(Bs)return e==="compositionend"||!hf&&uv(e,t)?(e=lv(),Fl=cf=Ir=null,Bs=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return av&&t.locale!=="ko"?null:t.data;default:return null}}var Yw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Yw[e.type]:t==="textarea"}function dv(e,t,n,r){Ug(r),t=la(t,"onChange"),0<t.length&&(n=new df("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var so=null,wo=null;function Xw(e){bv(e,0)}function za(e){var t=Ws(e);if(Ag(t))return e}function qw(e,t){if(e==="change")return t}var fv=!1;if(or){var $u;if(or){var Bu="oninput"in document;if(!Bu){var Wh=document.createElement("div");Wh.setAttribute("oninput","return;"),Bu=typeof Wh.oninput=="function"}$u=Bu}else $u=!1;fv=$u&&(!document.documentMode||9<document.documentMode)}function Hh(){so&&(so.detachEvent("onpropertychange",hv),wo=so=null)}function hv(e){if(e.propertyName==="value"&&za(wo)){var t=[];dv(t,wo,e,sf(e)),Qg(Xw,t)}}function Gw(e,t,n){e==="focusin"?(Hh(),so=t,wo=n,so.attachEvent("onpropertychange",hv)):e==="focusout"&&Hh()}function Jw(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return za(wo)}function Zw(e,t){if(e==="click")return za(t)}function e1(e,t){if(e==="input"||e==="change")return za(t)}function t1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Tn=typeof Object.is=="function"?Object.is:t1;function So(e,t){if(Tn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!xc.call(t,s)||!Tn(e[s],t[s]))return!1}return!0}function Qh(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Kh(e,t){var n=Qh(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Qh(n)}}function pv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?pv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function mv(){for(var e=window,t=ea();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ea(e.document)}return t}function pf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function n1(e){var t=mv(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&pv(n.ownerDocument.documentElement,n)){if(r!==null&&pf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=Kh(n,i);var o=Kh(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var r1=or&&"documentMode"in document&&11>=document.documentMode,Us=null,Dc=null,io=null,zc=!1;function Yh(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;zc||Us==null||Us!==ea(r)||(r=Us,"selectionStart"in r&&pf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),io&&So(io,r)||(io=r,r=la(Dc,"onSelect"),0<r.length&&(t=new df("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Us)))}function dl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Vs={animationend:dl("Animation","AnimationEnd"),animationiteration:dl("Animation","AnimationIteration"),animationstart:dl("Animation","AnimationStart"),transitionend:dl("Transition","TransitionEnd")},Uu={},gv={};or&&(gv=document.createElement("div").style,"AnimationEvent"in window||(delete Vs.animationend.animation,delete Vs.animationiteration.animation,delete Vs.animationstart.animation),"TransitionEvent"in window||delete Vs.transitionend.transition);function $a(e){if(Uu[e])return Uu[e];if(!Vs[e])return e;var t=Vs[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in gv)return Uu[e]=t[n];return e}var vv=$a("animationend"),yv=$a("animationiteration"),xv=$a("animationstart"),wv=$a("transitionend"),Sv=new Map,Xh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Kr(e,t){Sv.set(e,t),Ms(t,[e])}for(var Vu=0;Vu<Xh.length;Vu++){var Wu=Xh[Vu],s1=Wu.toLowerCase(),i1=Wu[0].toUpperCase()+Wu.slice(1);Kr(s1,"on"+i1)}Kr(vv,"onAnimationEnd");Kr(yv,"onAnimationIteration");Kr(xv,"onAnimationStart");Kr("dblclick","onDoubleClick");Kr("focusin","onFocus");Kr("focusout","onBlur");Kr(wv,"onTransitionEnd");yi("onMouseEnter",["mouseout","mouseover"]);yi("onMouseLeave",["mouseout","mouseover"]);yi("onPointerEnter",["pointerout","pointerover"]);yi("onPointerLeave",["pointerout","pointerover"]);Ms("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ms("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ms("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ms("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ms("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ms("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ji="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),o1=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ji));function qh(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,sw(r,t,void 0,e),e.currentTarget=null}function bv(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;qh(s,l,d),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;qh(s,l,d),i=u}}}if(na)throw e=Lc,na=!1,Lc=null,e}function De(e,t){var n=t[Wc];n===void 0&&(n=t[Wc]=new Set);var r=e+"__bubble";n.has(r)||(Cv(t,e,2,!1),n.add(r))}function Hu(e,t,n){var r=0;t&&(r|=4),Cv(n,e,r,t)}var fl="_reactListening"+Math.random().toString(36).slice(2);function bo(e){if(!e[fl]){e[fl]=!0,Rg.forEach(function(n){n!=="selectionchange"&&(o1.has(n)||Hu(n,!1,e),Hu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[fl]||(t[fl]=!0,Hu("selectionchange",!1,t))}}function Cv(e,t,n,r){switch(ov(t)){case 1:var s=ww;break;case 4:s=Sw;break;default:s=uf}n=s.bind(null,t,n,e),s=void 0,!_c||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Qu(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=ns(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Qg(function(){var d=i,f=sf(n),p=[];e:{var h=Sv.get(e);if(h!==void 0){var w=df,x=e;switch(e){case"keypress":if(Ol(n)===0)break e;case"keydown":case"keyup":w=Fw;break;case"focusin":x="focus",w=zu;break;case"focusout":x="blur",w=zu;break;case"beforeblur":case"afterblur":w=zu;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Dh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=kw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=zw;break;case vv:case yv:case xv:w=jw;break;case wv:w=Bw;break;case"scroll":w=bw;break;case"wheel":w=Vw;break;case"copy":case"cut":case"paste":w=Pw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=$h}var S=(t&4)!==0,C=!S&&e==="scroll",v=S?h!==null?h+"Capture":null:h;S=[];for(var m=d,y;m!==null;){y=m;var g=y.stateNode;if(y.tag===5&&g!==null&&(y=g,v!==null&&(g=go(m,v),g!=null&&S.push(Co(m,g,y)))),C)break;m=m.return}0<S.length&&(h=new w(h,x,null,n,f),p.push({event:h,listeners:S}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",h&&n!==Tc&&(x=n.relatedTarget||n.fromElement)&&(ns(x)||x[lr]))break e;if((w||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,w?(x=n.relatedTarget||n.toElement,w=d,x=x?ns(x):null,x!==null&&(C=Ps(x),x!==C||x.tag!==5&&x.tag!==6)&&(x=null)):(w=null,x=d),w!==x)){if(S=Dh,g="onMouseLeave",v="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(S=$h,g="onPointerLeave",v="onPointerEnter",m="pointer"),C=w==null?h:Ws(w),y=x==null?h:Ws(x),h=new S(g,m+"leave",w,n,f),h.target=C,h.relatedTarget=y,g=null,ns(f)===d&&(S=new S(v,m+"enter",x,n,f),S.target=y,S.relatedTarget=C,g=S),C=g,w&&x)t:{for(S=w,v=x,m=0,y=S;y;y=Ls(y))m++;for(y=0,g=v;g;g=Ls(g))y++;for(;0<m-y;)S=Ls(S),m--;for(;0<y-m;)v=Ls(v),y--;for(;m--;){if(S===v||v!==null&&S===v.alternate)break t;S=Ls(S),v=Ls(v)}S=null}else S=null;w!==null&&Gh(p,h,w,S,!1),x!==null&&C!==null&&Gh(p,C,x,S,!0)}}e:{if(h=d?Ws(d):window,w=h.nodeName&&h.nodeName.toLowerCase(),w==="select"||w==="input"&&h.type==="file")var b=qw;else if(Vh(h))if(fv)b=e1;else{b=Jw;var E=Gw}else(w=h.nodeName)&&w.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(b=Zw);if(b&&(b=b(e,d))){dv(p,b,n,f);break e}E&&E(e,h,d),e==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&Nc(h,"number",h.value)}switch(E=d?Ws(d):window,e){case"focusin":(Vh(E)||E.contentEditable==="true")&&(Us=E,Dc=d,io=null);break;case"focusout":io=Dc=Us=null;break;case"mousedown":zc=!0;break;case"contextmenu":case"mouseup":case"dragend":zc=!1,Yh(p,n,f);break;case"selectionchange":if(r1)break;case"keydown":case"keyup":Yh(p,n,f)}var M;if(hf)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Bs?uv(e,n)&&(N="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(N="onCompositionStart");N&&(av&&n.locale!=="ko"&&(Bs||N!=="onCompositionStart"?N==="onCompositionEnd"&&Bs&&(M=lv()):(Ir=f,cf="value"in Ir?Ir.value:Ir.textContent,Bs=!0)),E=la(d,N),0<E.length&&(N=new zh(N,e,null,n,f),p.push({event:N,listeners:E}),M?N.data=M:(M=cv(n),M!==null&&(N.data=M)))),(M=Hw?Qw(e,n):Kw(e,n))&&(d=la(d,"onBeforeInput"),0<d.length&&(f=new zh("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:d}),f.data=M))}bv(p,t)})}function Co(e,t,n){return{instance:e,listener:t,currentTarget:n}}function la(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=go(e,n),i!=null&&r.unshift(Co(e,i,s)),i=go(e,t),i!=null&&r.push(Co(e,i,s))),e=e.return}return r}function Ls(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Gh(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,s?(u=go(n,i),u!=null&&o.unshift(Co(n,u,l))):s||(u=go(n,i),u!=null&&o.push(Co(n,u,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var l1=/\r\n?/g,a1=/\u0000|\uFFFD/g;function Jh(e){return(typeof e=="string"?e:""+e).replace(l1,`
`).replace(a1,"")}function hl(e,t,n){if(t=Jh(t),Jh(e)!==t&&n)throw Error(H(425))}function aa(){}var $c=null,Bc=null;function Uc(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Vc=typeof setTimeout=="function"?setTimeout:void 0,u1=typeof clearTimeout=="function"?clearTimeout:void 0,Zh=typeof Promise=="function"?Promise:void 0,c1=typeof queueMicrotask=="function"?queueMicrotask:typeof Zh<"u"?function(e){return Zh.resolve(null).then(e).catch(d1)}:Vc;function d1(e){setTimeout(function(){throw e})}function Ku(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),xo(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);xo(t)}function Or(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function ep(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Mi=Math.random().toString(36).slice(2),$n="__reactFiber$"+Mi,ko="__reactProps$"+Mi,lr="__reactContainer$"+Mi,Wc="__reactEvents$"+Mi,f1="__reactListeners$"+Mi,h1="__reactHandles$"+Mi;function ns(e){var t=e[$n];if(t)return t;for(var n=e.parentNode;n;){if(t=n[lr]||n[$n]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=ep(e);e!==null;){if(n=e[$n])return n;e=ep(e)}return t}e=n,n=e.parentNode}return null}function Uo(e){return e=e[$n]||e[lr],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Ws(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(H(33))}function Ba(e){return e[ko]||null}var Hc=[],Hs=-1;function Yr(e){return{current:e}}function ze(e){0>Hs||(e.current=Hc[Hs],Hc[Hs]=null,Hs--)}function Oe(e,t){Hs++,Hc[Hs]=e.current,e.current=t}var Qr={},Rt=Yr(Qr),Ht=Yr(!1),Ss=Qr;function xi(e,t){var n=e.type.contextTypes;if(!n)return Qr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Qt(e){return e=e.childContextTypes,e!=null}function ua(){ze(Ht),ze(Rt)}function tp(e,t,n){if(Rt.current!==Qr)throw Error(H(168));Oe(Rt,t),Oe(Ht,n)}function kv(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(H(108,G0(e)||"Unknown",s));return Xe({},n,r)}function ca(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Qr,Ss=Rt.current,Oe(Rt,e),Oe(Ht,Ht.current),!0}function np(e,t,n){var r=e.stateNode;if(!r)throw Error(H(169));n?(e=kv(e,t,Ss),r.__reactInternalMemoizedMergedChildContext=e,ze(Ht),ze(Rt),Oe(Rt,e)):ze(Ht),Oe(Ht,n)}var qn=null,Ua=!1,Yu=!1;function Ev(e){qn===null?qn=[e]:qn.push(e)}function p1(e){Ua=!0,Ev(e)}function Xr(){if(!Yu&&qn!==null){Yu=!0;var e=0,t=Fe;try{var n=qn;for(Fe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}qn=null,Ua=!1}catch(s){throw qn!==null&&(qn=qn.slice(e+1)),qg(of,Xr),s}finally{Fe=t,Yu=!1}}return null}var Qs=[],Ks=0,da=null,fa=0,dn=[],fn=0,bs=null,tr=1,nr="";function es(e,t){Qs[Ks++]=fa,Qs[Ks++]=da,da=e,fa=t}function Nv(e,t,n){dn[fn++]=tr,dn[fn++]=nr,dn[fn++]=bs,bs=e;var r=tr;e=nr;var s=32-Mn(r)-1;r&=~(1<<s),n+=1;var i=32-Mn(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,tr=1<<32-Mn(t)+s|n<<s|r,nr=i+e}else tr=1<<i|n<<s|r,nr=e}function mf(e){e.return!==null&&(es(e,1),Nv(e,1,0))}function gf(e){for(;e===da;)da=Qs[--Ks],Qs[Ks]=null,fa=Qs[--Ks],Qs[Ks]=null;for(;e===bs;)bs=dn[--fn],dn[fn]=null,nr=dn[--fn],dn[fn]=null,tr=dn[--fn],dn[fn]=null}var en=null,Zt=null,Ve=!1,jn=null;function jv(e,t){var n=pn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function rp(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,en=e,Zt=Or(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,en=e,Zt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=bs!==null?{id:tr,overflow:nr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=pn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,en=e,Zt=null,!0):!1;default:return!1}}function Qc(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Kc(e){if(Ve){var t=Zt;if(t){var n=t;if(!rp(e,t)){if(Qc(e))throw Error(H(418));t=Or(n.nextSibling);var r=en;t&&rp(e,t)?jv(r,n):(e.flags=e.flags&-4097|2,Ve=!1,en=e)}}else{if(Qc(e))throw Error(H(418));e.flags=e.flags&-4097|2,Ve=!1,en=e}}}function sp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;en=e}function pl(e){if(e!==en)return!1;if(!Ve)return sp(e),Ve=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Uc(e.type,e.memoizedProps)),t&&(t=Zt)){if(Qc(e))throw Mv(),Error(H(418));for(;t;)jv(e,t),t=Or(t.nextSibling)}if(sp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(H(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Zt=Or(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Zt=null}}else Zt=en?Or(e.stateNode.nextSibling):null;return!0}function Mv(){for(var e=Zt;e;)e=Or(e.nextSibling)}function wi(){Zt=en=null,Ve=!1}function vf(e){jn===null?jn=[e]:jn.push(e)}var m1=cr.ReactCurrentBatchConfig;function Bi(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,e))}return e}function ml(e,t){throw e=Object.prototype.toString.call(t),Error(H(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ip(e){var t=e._init;return t(e._payload)}function Pv(e){function t(v,m){if(e){var y=v.deletions;y===null?(v.deletions=[m],v.flags|=16):y.push(m)}}function n(v,m){if(!e)return null;for(;m!==null;)t(v,m),m=m.sibling;return null}function r(v,m){for(v=new Map;m!==null;)m.key!==null?v.set(m.key,m):v.set(m.index,m),m=m.sibling;return v}function s(v,m){return v=Br(v,m),v.index=0,v.sibling=null,v}function i(v,m,y){return v.index=y,e?(y=v.alternate,y!==null?(y=y.index,y<m?(v.flags|=2,m):y):(v.flags|=2,m)):(v.flags|=1048576,m)}function o(v){return e&&v.alternate===null&&(v.flags|=2),v}function l(v,m,y,g){return m===null||m.tag!==6?(m=tc(y,v.mode,g),m.return=v,m):(m=s(m,y),m.return=v,m)}function u(v,m,y,g){var b=y.type;return b===$s?f(v,m,y.props.children,g,y.key):m!==null&&(m.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===xr&&ip(b)===m.type)?(g=s(m,y.props),g.ref=Bi(v,m,y),g.return=v,g):(g=Wl(y.type,y.key,y.props,null,v.mode,g),g.ref=Bi(v,m,y),g.return=v,g)}function d(v,m,y,g){return m===null||m.tag!==4||m.stateNode.containerInfo!==y.containerInfo||m.stateNode.implementation!==y.implementation?(m=nc(y,v.mode,g),m.return=v,m):(m=s(m,y.children||[]),m.return=v,m)}function f(v,m,y,g,b){return m===null||m.tag!==7?(m=ws(y,v.mode,g,b),m.return=v,m):(m=s(m,y),m.return=v,m)}function p(v,m,y){if(typeof m=="string"&&m!==""||typeof m=="number")return m=tc(""+m,v.mode,y),m.return=v,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case sl:return y=Wl(m.type,m.key,m.props,null,v.mode,y),y.ref=Bi(v,null,m),y.return=v,y;case zs:return m=nc(m,v.mode,y),m.return=v,m;case xr:var g=m._init;return p(v,g(m._payload),y)}if(qi(m)||Fi(m))return m=ws(m,v.mode,y,null),m.return=v,m;ml(v,m)}return null}function h(v,m,y,g){var b=m!==null?m.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return b!==null?null:l(v,m,""+y,g);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case sl:return y.key===b?u(v,m,y,g):null;case zs:return y.key===b?d(v,m,y,g):null;case xr:return b=y._init,h(v,m,b(y._payload),g)}if(qi(y)||Fi(y))return b!==null?null:f(v,m,y,g,null);ml(v,y)}return null}function w(v,m,y,g,b){if(typeof g=="string"&&g!==""||typeof g=="number")return v=v.get(y)||null,l(m,v,""+g,b);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case sl:return v=v.get(g.key===null?y:g.key)||null,u(m,v,g,b);case zs:return v=v.get(g.key===null?y:g.key)||null,d(m,v,g,b);case xr:var E=g._init;return w(v,m,y,E(g._payload),b)}if(qi(g)||Fi(g))return v=v.get(y)||null,f(m,v,g,b,null);ml(m,g)}return null}function x(v,m,y,g){for(var b=null,E=null,M=m,N=m=0,_=null;M!==null&&N<y.length;N++){M.index>N?(_=M,M=null):_=M.sibling;var P=h(v,M,y[N],g);if(P===null){M===null&&(M=_);break}e&&M&&P.alternate===null&&t(v,M),m=i(P,m,N),E===null?b=P:E.sibling=P,E=P,M=_}if(N===y.length)return n(v,M),Ve&&es(v,N),b;if(M===null){for(;N<y.length;N++)M=p(v,y[N],g),M!==null&&(m=i(M,m,N),E===null?b=M:E.sibling=M,E=M);return Ve&&es(v,N),b}for(M=r(v,M);N<y.length;N++)_=w(M,v,N,y[N],g),_!==null&&(e&&_.alternate!==null&&M.delete(_.key===null?N:_.key),m=i(_,m,N),E===null?b=_:E.sibling=_,E=_);return e&&M.forEach(function(B){return t(v,B)}),Ve&&es(v,N),b}function S(v,m,y,g){var b=Fi(y);if(typeof b!="function")throw Error(H(150));if(y=b.call(y),y==null)throw Error(H(151));for(var E=b=null,M=m,N=m=0,_=null,P=y.next();M!==null&&!P.done;N++,P=y.next()){M.index>N?(_=M,M=null):_=M.sibling;var B=h(v,M,P.value,g);if(B===null){M===null&&(M=_);break}e&&M&&B.alternate===null&&t(v,M),m=i(B,m,N),E===null?b=B:E.sibling=B,E=B,M=_}if(P.done)return n(v,M),Ve&&es(v,N),b;if(M===null){for(;!P.done;N++,P=y.next())P=p(v,P.value,g),P!==null&&(m=i(P,m,N),E===null?b=P:E.sibling=P,E=P);return Ve&&es(v,N),b}for(M=r(v,M);!P.done;N++,P=y.next())P=w(M,v,N,P.value,g),P!==null&&(e&&P.alternate!==null&&M.delete(P.key===null?N:P.key),m=i(P,m,N),E===null?b=P:E.sibling=P,E=P);return e&&M.forEach(function(F){return t(v,F)}),Ve&&es(v,N),b}function C(v,m,y,g){if(typeof y=="object"&&y!==null&&y.type===$s&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case sl:e:{for(var b=y.key,E=m;E!==null;){if(E.key===b){if(b=y.type,b===$s){if(E.tag===7){n(v,E.sibling),m=s(E,y.props.children),m.return=v,v=m;break e}}else if(E.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===xr&&ip(b)===E.type){n(v,E.sibling),m=s(E,y.props),m.ref=Bi(v,E,y),m.return=v,v=m;break e}n(v,E);break}else t(v,E);E=E.sibling}y.type===$s?(m=ws(y.props.children,v.mode,g,y.key),m.return=v,v=m):(g=Wl(y.type,y.key,y.props,null,v.mode,g),g.ref=Bi(v,m,y),g.return=v,v=g)}return o(v);case zs:e:{for(E=y.key;m!==null;){if(m.key===E)if(m.tag===4&&m.stateNode.containerInfo===y.containerInfo&&m.stateNode.implementation===y.implementation){n(v,m.sibling),m=s(m,y.children||[]),m.return=v,v=m;break e}else{n(v,m);break}else t(v,m);m=m.sibling}m=nc(y,v.mode,g),m.return=v,v=m}return o(v);case xr:return E=y._init,C(v,m,E(y._payload),g)}if(qi(y))return x(v,m,y,g);if(Fi(y))return S(v,m,y,g);ml(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,m!==null&&m.tag===6?(n(v,m.sibling),m=s(m,y),m.return=v,v=m):(n(v,m),m=tc(y,v.mode,g),m.return=v,v=m),o(v)):n(v,m)}return C}var Si=Pv(!0),Rv=Pv(!1),ha=Yr(null),pa=null,Ys=null,yf=null;function xf(){yf=Ys=pa=null}function wf(e){var t=ha.current;ze(ha),e._currentValue=t}function Yc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ti(e,t){pa=e,yf=Ys=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Wt=!0),e.firstContext=null)}function gn(e){var t=e._currentValue;if(yf!==e)if(e={context:e,memoizedValue:t,next:null},Ys===null){if(pa===null)throw Error(H(308));Ys=e,pa.dependencies={lanes:0,firstContext:e}}else Ys=Ys.next=e;return t}var rs=null;function Sf(e){rs===null?rs=[e]:rs.push(e)}function Tv(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Sf(t)):(n.next=s.next,s.next=n),t.interleaved=n,ar(e,r)}function ar(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var wr=!1;function bf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Iv(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function rr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Dr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,ar(e,n)}return s=r.interleaved,s===null?(t.next=t,Sf(r)):(t.next=s.next,s.next=t),r.interleaved=t,ar(e,n)}function Dl(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,lf(e,n)}}function op(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ma(e,t,n,r){var s=e.updateQueue;wr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var f=e.alternate;f!==null&&(f=f.updateQueue,l=f.lastBaseUpdate,l!==o&&(l===null?f.firstBaseUpdate=d:l.next=d,f.lastBaseUpdate=u))}if(i!==null){var p=s.baseState;o=0,f=d=u=null,l=i;do{var h=l.lane,w=l.eventTime;if((r&h)===h){f!==null&&(f=f.next={eventTime:w,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,S=l;switch(h=t,w=n,S.tag){case 1:if(x=S.payload,typeof x=="function"){p=x.call(w,p,h);break e}p=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=S.payload,h=typeof x=="function"?x.call(w,p,h):x,h==null)break e;p=Xe({},p,h);break e;case 2:wr=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[l]:h.push(l))}else w={eventTime:w,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},f===null?(d=f=w,u=p):f=f.next=w,o|=h;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;h=l,l=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(f===null&&(u=p),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);ks|=o,e.lanes=o,e.memoizedState=p}}function lp(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(H(191,s));s.call(r)}}}var Vo={},Un=Yr(Vo),Eo=Yr(Vo),No=Yr(Vo);function ss(e){if(e===Vo)throw Error(H(174));return e}function Cf(e,t){switch(Oe(No,t),Oe(Eo,e),Oe(Un,Vo),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Mc(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Mc(t,e)}ze(Un),Oe(Un,t)}function bi(){ze(Un),ze(Eo),ze(No)}function _v(e){ss(No.current);var t=ss(Un.current),n=Mc(t,e.type);t!==n&&(Oe(Eo,e),Oe(Un,n))}function kf(e){Eo.current===e&&(ze(Un),ze(Eo))}var Ke=Yr(0);function ga(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Xu=[];function Ef(){for(var e=0;e<Xu.length;e++)Xu[e]._workInProgressVersionPrimary=null;Xu.length=0}var zl=cr.ReactCurrentDispatcher,qu=cr.ReactCurrentBatchConfig,Cs=0,Ye=null,at=null,gt=null,va=!1,oo=!1,jo=0,g1=0;function Nt(){throw Error(H(321))}function Nf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Tn(e[n],t[n]))return!1;return!0}function jf(e,t,n,r,s,i){if(Cs=i,Ye=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,zl.current=e===null||e.memoizedState===null?w1:S1,e=n(r,s),oo){i=0;do{if(oo=!1,jo=0,25<=i)throw Error(H(301));i+=1,gt=at=null,t.updateQueue=null,zl.current=b1,e=n(r,s)}while(oo)}if(zl.current=ya,t=at!==null&&at.next!==null,Cs=0,gt=at=Ye=null,va=!1,t)throw Error(H(300));return e}function Mf(){var e=jo!==0;return jo=0,e}function Fn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?Ye.memoizedState=gt=e:gt=gt.next=e,gt}function vn(){if(at===null){var e=Ye.alternate;e=e!==null?e.memoizedState:null}else e=at.next;var t=gt===null?Ye.memoizedState:gt.next;if(t!==null)gt=t,at=e;else{if(e===null)throw Error(H(310));at=e,e={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},gt===null?Ye.memoizedState=gt=e:gt=gt.next=e}return gt}function Mo(e,t){return typeof t=="function"?t(e):t}function Gu(e){var t=vn(),n=t.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=e;var r=at,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,d=i;do{var f=d.lane;if((Cs&f)===f)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var p={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=p,o=r):u=u.next=p,Ye.lanes|=f,ks|=f}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=l,Tn(r,t.memoizedState)||(Wt=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Ye.lanes|=i,ks|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ju(e){var t=vn(),n=t.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);Tn(i,t.memoizedState)||(Wt=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function Lv(){}function Av(e,t){var n=Ye,r=vn(),s=t(),i=!Tn(r.memoizedState,s);if(i&&(r.memoizedState=s,Wt=!0),r=r.queue,Pf(Dv.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||gt!==null&&gt.memoizedState.tag&1){if(n.flags|=2048,Po(9,Ov.bind(null,n,r,s,t),void 0,null),vt===null)throw Error(H(349));Cs&30||Fv(n,t,s)}return s}function Fv(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Ye.updateQueue,t===null?(t={lastEffect:null,stores:null},Ye.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Ov(e,t,n,r){t.value=n,t.getSnapshot=r,zv(t)&&$v(e)}function Dv(e,t,n){return n(function(){zv(t)&&$v(e)})}function zv(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Tn(e,n)}catch{return!0}}function $v(e){var t=ar(e,1);t!==null&&Pn(t,e,1,-1)}function ap(e){var t=Fn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mo,lastRenderedState:e},t.queue=e,e=e.dispatch=x1.bind(null,Ye,e),[t.memoizedState,e]}function Po(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Ye.updateQueue,t===null?(t={lastEffect:null,stores:null},Ye.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Bv(){return vn().memoizedState}function $l(e,t,n,r){var s=Fn();Ye.flags|=e,s.memoizedState=Po(1|t,n,void 0,r===void 0?null:r)}function Va(e,t,n,r){var s=vn();r=r===void 0?null:r;var i=void 0;if(at!==null){var o=at.memoizedState;if(i=o.destroy,r!==null&&Nf(r,o.deps)){s.memoizedState=Po(t,n,i,r);return}}Ye.flags|=e,s.memoizedState=Po(1|t,n,i,r)}function up(e,t){return $l(8390656,8,e,t)}function Pf(e,t){return Va(2048,8,e,t)}function Uv(e,t){return Va(4,2,e,t)}function Vv(e,t){return Va(4,4,e,t)}function Wv(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Hv(e,t,n){return n=n!=null?n.concat([e]):null,Va(4,4,Wv.bind(null,t,e),n)}function Rf(){}function Qv(e,t){var n=vn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Nf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Kv(e,t){var n=vn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Nf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Yv(e,t,n){return Cs&21?(Tn(n,t)||(n=Zg(),Ye.lanes|=n,ks|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Wt=!0),e.memoizedState=n)}function v1(e,t){var n=Fe;Fe=n!==0&&4>n?n:4,e(!0);var r=qu.transition;qu.transition={};try{e(!1),t()}finally{Fe=n,qu.transition=r}}function Xv(){return vn().memoizedState}function y1(e,t,n){var r=$r(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},qv(e))Gv(t,n);else if(n=Tv(e,t,n,r),n!==null){var s=Ft();Pn(n,e,r,s),Jv(n,t,r)}}function x1(e,t,n){var r=$r(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(qv(e))Gv(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Tn(l,o)){var u=t.interleaved;u===null?(s.next=s,Sf(t)):(s.next=u.next,u.next=s),t.interleaved=s;return}}catch{}finally{}n=Tv(e,t,s,r),n!==null&&(s=Ft(),Pn(n,e,r,s),Jv(n,t,r))}}function qv(e){var t=e.alternate;return e===Ye||t!==null&&t===Ye}function Gv(e,t){oo=va=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Jv(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,lf(e,n)}}var ya={readContext:gn,useCallback:Nt,useContext:Nt,useEffect:Nt,useImperativeHandle:Nt,useInsertionEffect:Nt,useLayoutEffect:Nt,useMemo:Nt,useReducer:Nt,useRef:Nt,useState:Nt,useDebugValue:Nt,useDeferredValue:Nt,useTransition:Nt,useMutableSource:Nt,useSyncExternalStore:Nt,useId:Nt,unstable_isNewReconciler:!1},w1={readContext:gn,useCallback:function(e,t){return Fn().memoizedState=[e,t===void 0?null:t],e},useContext:gn,useEffect:up,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,$l(4194308,4,Wv.bind(null,t,e),n)},useLayoutEffect:function(e,t){return $l(4194308,4,e,t)},useInsertionEffect:function(e,t){return $l(4,2,e,t)},useMemo:function(e,t){var n=Fn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Fn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=y1.bind(null,Ye,e),[r.memoizedState,e]},useRef:function(e){var t=Fn();return e={current:e},t.memoizedState=e},useState:ap,useDebugValue:Rf,useDeferredValue:function(e){return Fn().memoizedState=e},useTransition:function(){var e=ap(!1),t=e[0];return e=v1.bind(null,e[1]),Fn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Ye,s=Fn();if(Ve){if(n===void 0)throw Error(H(407));n=n()}else{if(n=t(),vt===null)throw Error(H(349));Cs&30||Fv(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,up(Dv.bind(null,r,i,e),[e]),r.flags|=2048,Po(9,Ov.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Fn(),t=vt.identifierPrefix;if(Ve){var n=nr,r=tr;n=(r&~(1<<32-Mn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=jo++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=g1++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},S1={readContext:gn,useCallback:Qv,useContext:gn,useEffect:Pf,useImperativeHandle:Hv,useInsertionEffect:Uv,useLayoutEffect:Vv,useMemo:Kv,useReducer:Gu,useRef:Bv,useState:function(){return Gu(Mo)},useDebugValue:Rf,useDeferredValue:function(e){var t=vn();return Yv(t,at.memoizedState,e)},useTransition:function(){var e=Gu(Mo)[0],t=vn().memoizedState;return[e,t]},useMutableSource:Lv,useSyncExternalStore:Av,useId:Xv,unstable_isNewReconciler:!1},b1={readContext:gn,useCallback:Qv,useContext:gn,useEffect:Pf,useImperativeHandle:Hv,useInsertionEffect:Uv,useLayoutEffect:Vv,useMemo:Kv,useReducer:Ju,useRef:Bv,useState:function(){return Ju(Mo)},useDebugValue:Rf,useDeferredValue:function(e){var t=vn();return at===null?t.memoizedState=e:Yv(t,at.memoizedState,e)},useTransition:function(){var e=Ju(Mo)[0],t=vn().memoizedState;return[e,t]},useMutableSource:Lv,useSyncExternalStore:Av,useId:Xv,unstable_isNewReconciler:!1};function bn(e,t){if(e&&e.defaultProps){t=Xe({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function Xc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Xe({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Wa={isMounted:function(e){return(e=e._reactInternals)?Ps(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ft(),s=$r(e),i=rr(r,s);i.payload=t,n!=null&&(i.callback=n),t=Dr(e,i,s),t!==null&&(Pn(t,e,s,r),Dl(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ft(),s=$r(e),i=rr(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Dr(e,i,s),t!==null&&(Pn(t,e,s,r),Dl(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ft(),r=$r(e),s=rr(n,r);s.tag=2,t!=null&&(s.callback=t),t=Dr(e,s,r),t!==null&&(Pn(t,e,r,n),Dl(t,e,r))}};function cp(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!So(n,r)||!So(s,i):!0}function Zv(e,t,n){var r=!1,s=Qr,i=t.contextType;return typeof i=="object"&&i!==null?i=gn(i):(s=Qt(t)?Ss:Rt.current,r=t.contextTypes,i=(r=r!=null)?xi(e,s):Qr),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Wa,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function dp(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Wa.enqueueReplaceState(t,t.state,null)}function qc(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},bf(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=gn(i):(i=Qt(t)?Ss:Rt.current,s.context=xi(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(Xc(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Wa.enqueueReplaceState(s,s.state,null),ma(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Ci(e,t){try{var n="",r=t;do n+=q0(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function Zu(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Gc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var C1=typeof WeakMap=="function"?WeakMap:Map;function ey(e,t,n){n=rr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){wa||(wa=!0,ld=r),Gc(e,t)},n}function ty(e,t,n){n=rr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){Gc(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Gc(e,t),typeof r!="function"&&(zr===null?zr=new Set([this]):zr.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function fp(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new C1;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=O1.bind(null,e,t,n),t.then(e,e))}function hp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function pp(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=rr(-1,1),t.tag=2,Dr(n,t,1))),n.lanes|=1),e)}var k1=cr.ReactCurrentOwner,Wt=!1;function Lt(e,t,n,r){t.child=e===null?Rv(t,null,n,r):Si(t,e.child,n,r)}function mp(e,t,n,r,s){n=n.render;var i=t.ref;return ti(t,s),r=jf(e,t,n,r,i,s),n=Mf(),e!==null&&!Wt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ur(e,t,s)):(Ve&&n&&mf(t),t.flags|=1,Lt(e,t,r,s),t.child)}function gp(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!Df(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,ny(e,t,i,r,s)):(e=Wl(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:So,n(o,r)&&e.ref===t.ref)return ur(e,t,s)}return t.flags|=1,e=Br(i,r),e.ref=t.ref,e.return=t,t.child=e}function ny(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(So(i,r)&&e.ref===t.ref)if(Wt=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&(Wt=!0);else return t.lanes=e.lanes,ur(e,t,s)}return Jc(e,t,n,r,s)}function ry(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Oe(qs,Jt),Jt|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Oe(qs,Jt),Jt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Oe(qs,Jt),Jt|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Oe(qs,Jt),Jt|=r;return Lt(e,t,s,n),t.child}function sy(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Jc(e,t,n,r,s){var i=Qt(n)?Ss:Rt.current;return i=xi(t,i),ti(t,s),n=jf(e,t,n,r,i,s),r=Mf(),e!==null&&!Wt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ur(e,t,s)):(Ve&&r&&mf(t),t.flags|=1,Lt(e,t,n,s),t.child)}function vp(e,t,n,r,s){if(Qt(n)){var i=!0;ca(t)}else i=!1;if(ti(t,s),t.stateNode===null)Bl(e,t),Zv(t,n,r),qc(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=gn(d):(d=Qt(n)?Ss:Rt.current,d=xi(t,d));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&dp(t,o,r,d),wr=!1;var h=t.memoizedState;o.state=h,ma(t,r,o,s),u=t.memoizedState,l!==r||h!==u||Ht.current||wr?(typeof f=="function"&&(Xc(t,n,f,r),u=t.memoizedState),(l=wr||cp(t,n,l,r,h,u,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Iv(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:bn(t.type,l),o.props=d,p=t.pendingProps,h=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=gn(u):(u=Qt(n)?Ss:Rt.current,u=xi(t,u));var w=n.getDerivedStateFromProps;(f=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||h!==u)&&dp(t,o,r,u),wr=!1,h=t.memoizedState,o.state=h,ma(t,r,o,s);var x=t.memoizedState;l!==p||h!==x||Ht.current||wr?(typeof w=="function"&&(Xc(t,n,w,r),x=t.memoizedState),(d=wr||cp(t,n,d,r,h,x,u)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,x,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,x,u)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=x),o.props=r,o.state=x,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Zc(e,t,n,r,i,s)}function Zc(e,t,n,r,s,i){sy(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&np(t,n,!1),ur(e,t,i);r=t.stateNode,k1.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=Si(t,e.child,null,i),t.child=Si(t,null,l,i)):Lt(e,t,l,i),t.memoizedState=r.state,s&&np(t,n,!0),t.child}function iy(e){var t=e.stateNode;t.pendingContext?tp(e,t.pendingContext,t.pendingContext!==t.context):t.context&&tp(e,t.context,!1),Cf(e,t.containerInfo)}function yp(e,t,n,r,s){return wi(),vf(s),t.flags|=256,Lt(e,t,n,r),t.child}var ed={dehydrated:null,treeContext:null,retryLane:0};function td(e){return{baseLanes:e,cachePool:null,transitions:null}}function oy(e,t,n){var r=t.pendingProps,s=Ke.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Oe(Ke,s&1),e===null)return Kc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Ka(o,r,0,null),e=ws(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=td(n),t.memoizedState=ed,e):Tf(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return E1(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=Br(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=Br(l,i):(i=ws(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?td(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=ed,r}return i=e.child,e=i.sibling,r=Br(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Tf(e,t){return t=Ka({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function gl(e,t,n,r){return r!==null&&vf(r),Si(t,e.child,null,n),e=Tf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function E1(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=Zu(Error(H(422))),gl(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Ka({mode:"visible",children:r.children},s,0,null),i=ws(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&Si(t,e.child,null,o),t.child.memoizedState=td(o),t.memoizedState=ed,i);if(!(t.mode&1))return gl(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(H(419)),r=Zu(i,r,void 0),gl(e,t,o,r)}if(l=(o&e.childLanes)!==0,Wt||l){if(r=vt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,ar(e,s),Pn(r,e,s,-1))}return Of(),r=Zu(Error(H(421))),gl(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=D1.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,Zt=Or(s.nextSibling),en=t,Ve=!0,jn=null,e!==null&&(dn[fn++]=tr,dn[fn++]=nr,dn[fn++]=bs,tr=e.id,nr=e.overflow,bs=t),t=Tf(t,r.children),t.flags|=4096,t)}function xp(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Yc(e.return,t,n)}function ec(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function ly(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(Lt(e,t,r.children,n),r=Ke.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&xp(e,n,t);else if(e.tag===19)xp(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Oe(Ke,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&ga(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),ec(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&ga(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}ec(t,!0,n,null,i);break;case"together":ec(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Bl(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ur(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),ks|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(H(153));if(t.child!==null){for(e=t.child,n=Br(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Br(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function N1(e,t,n){switch(t.tag){case 3:iy(t),wi();break;case 5:_v(t);break;case 1:Qt(t.type)&&ca(t);break;case 4:Cf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Oe(ha,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Oe(Ke,Ke.current&1),t.flags|=128,null):n&t.child.childLanes?oy(e,t,n):(Oe(Ke,Ke.current&1),e=ur(e,t,n),e!==null?e.sibling:null);Oe(Ke,Ke.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return ly(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Oe(Ke,Ke.current),r)break;return null;case 22:case 23:return t.lanes=0,ry(e,t,n)}return ur(e,t,n)}var ay,nd,uy,cy;ay=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};nd=function(){};uy=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,ss(Un.current);var i=null;switch(n){case"input":s=kc(e,s),r=kc(e,r),i=[];break;case"select":s=Xe({},s,{value:void 0}),r=Xe({},r,{value:void 0}),i=[];break;case"textarea":s=jc(e,s),r=jc(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=aa)}Pc(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(po.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(po.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&De("scroll",e),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};cy=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ui(e,t){if(!Ve)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function jt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function j1(e,t,n){var r=t.pendingProps;switch(gf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(t),null;case 1:return Qt(t.type)&&ua(),jt(t),null;case 3:return r=t.stateNode,bi(),ze(Ht),ze(Rt),Ef(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(pl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,jn!==null&&(cd(jn),jn=null))),nd(e,t),jt(t),null;case 5:kf(t);var s=ss(No.current);if(n=t.type,e!==null&&t.stateNode!=null)uy(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(H(166));return jt(t),null}if(e=ss(Un.current),pl(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[$n]=t,r[ko]=i,e=(t.mode&1)!==0,n){case"dialog":De("cancel",r),De("close",r);break;case"iframe":case"object":case"embed":De("load",r);break;case"video":case"audio":for(s=0;s<Ji.length;s++)De(Ji[s],r);break;case"source":De("error",r);break;case"img":case"image":case"link":De("error",r),De("load",r);break;case"details":De("toggle",r);break;case"input":Mh(r,i),De("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},De("invalid",r);break;case"textarea":Rh(r,i),De("invalid",r)}Pc(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&hl(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&hl(r.textContent,l,e),s=["children",""+l]):po.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&De("scroll",r)}switch(n){case"input":il(r),Ph(r,i,!0);break;case"textarea":il(r),Th(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=aa)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Dg(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[$n]=t,e[ko]=r,ay(e,t,!1,!1),t.stateNode=e;e:{switch(o=Rc(n,r),n){case"dialog":De("cancel",e),De("close",e),s=r;break;case"iframe":case"object":case"embed":De("load",e),s=r;break;case"video":case"audio":for(s=0;s<Ji.length;s++)De(Ji[s],e);s=r;break;case"source":De("error",e),s=r;break;case"img":case"image":case"link":De("error",e),De("load",e),s=r;break;case"details":De("toggle",e),s=r;break;case"input":Mh(e,r),s=kc(e,r),De("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Xe({},r,{value:void 0}),De("invalid",e);break;case"textarea":Rh(e,r),s=jc(e,r),De("invalid",e);break;default:s=r}Pc(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?Bg(e,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&zg(e,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&mo(e,u):typeof u=="number"&&mo(e,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(po.hasOwnProperty(i)?u!=null&&i==="onScroll"&&De("scroll",e):u!=null&&ef(e,i,u,o))}switch(n){case"input":il(e),Ph(e,r,!1);break;case"textarea":il(e),Th(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Hr(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?Gs(e,!!r.multiple,i,!1):r.defaultValue!=null&&Gs(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=aa)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return jt(t),null;case 6:if(e&&t.stateNode!=null)cy(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(H(166));if(n=ss(No.current),ss(Un.current),pl(t)){if(r=t.stateNode,n=t.memoizedProps,r[$n]=t,(i=r.nodeValue!==n)&&(e=en,e!==null))switch(e.tag){case 3:hl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&hl(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[$n]=t,t.stateNode=r}return jt(t),null;case 13:if(ze(Ke),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ve&&Zt!==null&&t.mode&1&&!(t.flags&128))Mv(),wi(),t.flags|=98560,i=!1;else if(i=pl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(H(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[$n]=t}else wi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;jt(t),i=!1}else jn!==null&&(cd(jn),jn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Ke.current&1?ct===0&&(ct=3):Of())),t.updateQueue!==null&&(t.flags|=4),jt(t),null);case 4:return bi(),nd(e,t),e===null&&bo(t.stateNode.containerInfo),jt(t),null;case 10:return wf(t.type._context),jt(t),null;case 17:return Qt(t.type)&&ua(),jt(t),null;case 19:if(ze(Ke),i=t.memoizedState,i===null)return jt(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)Ui(i,!1);else{if(ct!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=ga(e),o!==null){for(t.flags|=128,Ui(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Oe(Ke,Ke.current&1|2),t.child}e=e.sibling}i.tail!==null&&nt()>ki&&(t.flags|=128,r=!0,Ui(i,!1),t.lanes=4194304)}else{if(!r)if(e=ga(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ui(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ve)return jt(t),null}else 2*nt()-i.renderingStartTime>ki&&n!==1073741824&&(t.flags|=128,r=!0,Ui(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=nt(),t.sibling=null,n=Ke.current,Oe(Ke,r?n&1|2:n&1),t):(jt(t),null);case 22:case 23:return Ff(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Jt&1073741824&&(jt(t),t.subtreeFlags&6&&(t.flags|=8192)):jt(t),null;case 24:return null;case 25:return null}throw Error(H(156,t.tag))}function M1(e,t){switch(gf(t),t.tag){case 1:return Qt(t.type)&&ua(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return bi(),ze(Ht),ze(Rt),Ef(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return kf(t),null;case 13:if(ze(Ke),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(H(340));wi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ze(Ke),null;case 4:return bi(),null;case 10:return wf(t.type._context),null;case 22:case 23:return Ff(),null;case 24:return null;default:return null}}var vl=!1,Mt=!1,P1=typeof WeakSet=="function"?WeakSet:Set,ee=null;function Xs(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ze(e,t,r)}else n.current=null}function rd(e,t,n){try{n()}catch(r){Ze(e,t,r)}}var wp=!1;function R1(e,t){if($c=ia,e=mv(),pf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,f=0,p=e,h=null;t:for(;;){for(var w;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(u=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(w=p.firstChild)!==null;)h=p,p=w;for(;;){if(p===e)break t;if(h===n&&++d===s&&(l=o),h===i&&++f===r&&(u=o),(w=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=w}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bc={focusedElem:e,selectionRange:n},ia=!1,ee=t;ee!==null;)if(t=ee,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ee=e;else for(;ee!==null;){t=ee;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var S=x.memoizedProps,C=x.memoizedState,v=t.stateNode,m=v.getSnapshotBeforeUpdate(t.elementType===t.type?S:bn(t.type,S),C);v.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(g){Ze(t,t.return,g)}if(e=t.sibling,e!==null){e.return=t.return,ee=e;break}ee=t.return}return x=wp,wp=!1,x}function lo(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&rd(t,n,i)}s=s.next}while(s!==r)}}function Ha(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sd(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function dy(e){var t=e.alternate;t!==null&&(e.alternate=null,dy(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[$n],delete t[ko],delete t[Wc],delete t[f1],delete t[h1])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function fy(e){return e.tag===5||e.tag===3||e.tag===4}function Sp(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||fy(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function id(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=aa));else if(r!==4&&(e=e.child,e!==null))for(id(e,t,n),e=e.sibling;e!==null;)id(e,t,n),e=e.sibling}function od(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(od(e,t,n),e=e.sibling;e!==null;)od(e,t,n),e=e.sibling}var xt=null,Nn=!1;function gr(e,t,n){for(n=n.child;n!==null;)hy(e,t,n),n=n.sibling}function hy(e,t,n){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(Oa,n)}catch{}switch(n.tag){case 5:Mt||Xs(n,t);case 6:var r=xt,s=Nn;xt=null,gr(e,t,n),xt=r,Nn=s,xt!==null&&(Nn?(e=xt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):xt.removeChild(n.stateNode));break;case 18:xt!==null&&(Nn?(e=xt,n=n.stateNode,e.nodeType===8?Ku(e.parentNode,n):e.nodeType===1&&Ku(e,n),xo(e)):Ku(xt,n.stateNode));break;case 4:r=xt,s=Nn,xt=n.stateNode.containerInfo,Nn=!0,gr(e,t,n),xt=r,Nn=s;break;case 0:case 11:case 14:case 15:if(!Mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&rd(n,t,o),s=s.next}while(s!==r)}gr(e,t,n);break;case 1:if(!Mt&&(Xs(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ze(n,t,l)}gr(e,t,n);break;case 21:gr(e,t,n);break;case 22:n.mode&1?(Mt=(r=Mt)||n.memoizedState!==null,gr(e,t,n),Mt=r):gr(e,t,n);break;default:gr(e,t,n)}}function bp(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new P1),t.forEach(function(r){var s=z1.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function wn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:xt=l.stateNode,Nn=!1;break e;case 3:xt=l.stateNode.containerInfo,Nn=!0;break e;case 4:xt=l.stateNode.containerInfo,Nn=!0;break e}l=l.return}if(xt===null)throw Error(H(160));hy(i,o,s),xt=null,Nn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){Ze(s,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)py(t,e),t=t.sibling}function py(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(wn(t,e),An(e),r&4){try{lo(3,e,e.return),Ha(3,e)}catch(S){Ze(e,e.return,S)}try{lo(5,e,e.return)}catch(S){Ze(e,e.return,S)}}break;case 1:wn(t,e),An(e),r&512&&n!==null&&Xs(n,n.return);break;case 5:if(wn(t,e),An(e),r&512&&n!==null&&Xs(n,n.return),e.flags&32){var s=e.stateNode;try{mo(s,"")}catch(S){Ze(e,e.return,S)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Fg(s,i),Rc(l,o);var d=Rc(l,i);for(o=0;o<u.length;o+=2){var f=u[o],p=u[o+1];f==="style"?Bg(s,p):f==="dangerouslySetInnerHTML"?zg(s,p):f==="children"?mo(s,p):ef(s,f,p,d)}switch(l){case"input":Ec(s,i);break;case"textarea":Og(s,i);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var w=i.value;w!=null?Gs(s,!!i.multiple,w,!1):h!==!!i.multiple&&(i.defaultValue!=null?Gs(s,!!i.multiple,i.defaultValue,!0):Gs(s,!!i.multiple,i.multiple?[]:"",!1))}s[ko]=i}catch(S){Ze(e,e.return,S)}}break;case 6:if(wn(t,e),An(e),r&4){if(e.stateNode===null)throw Error(H(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(S){Ze(e,e.return,S)}}break;case 3:if(wn(t,e),An(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{xo(t.containerInfo)}catch(S){Ze(e,e.return,S)}break;case 4:wn(t,e),An(e);break;case 13:wn(t,e),An(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Lf=nt())),r&4&&bp(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(Mt=(d=Mt)||f,wn(t,e),Mt=d):wn(t,e),An(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!f&&e.mode&1)for(ee=e,f=e.child;f!==null;){for(p=ee=f;ee!==null;){switch(h=ee,w=h.child,h.tag){case 0:case 11:case 14:case 15:lo(4,h,h.return);break;case 1:Xs(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){r=h,n=h.return;try{t=r,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(S){Ze(r,n,S)}}break;case 5:Xs(h,h.return);break;case 22:if(h.memoizedState!==null){kp(p);continue}}w!==null?(w.return=h,ee=w):kp(p)}f=f.sibling}e:for(f=null,p=e;;){if(p.tag===5){if(f===null){f=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,u=p.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=$g("display",o))}catch(S){Ze(e,e.return,S)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(S){Ze(e,e.return,S)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:wn(t,e),An(e),r&4&&bp(e);break;case 21:break;default:wn(t,e),An(e)}}function An(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(fy(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(mo(s,""),r.flags&=-33);var i=Sp(e);od(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=Sp(e);id(e,l,o);break;default:throw Error(H(161))}}catch(u){Ze(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function T1(e,t,n){ee=e,my(e)}function my(e,t,n){for(var r=(e.mode&1)!==0;ee!==null;){var s=ee,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||vl;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||Mt;l=vl;var d=Mt;if(vl=o,(Mt=u)&&!d)for(ee=s;ee!==null;)o=ee,u=o.child,o.tag===22&&o.memoizedState!==null?Ep(s):u!==null?(u.return=o,ee=u):Ep(s);for(;i!==null;)ee=i,my(i),i=i.sibling;ee=s,vl=l,Mt=d}Cp(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ee=i):Cp(e)}}function Cp(e){for(;ee!==null;){var t=ee;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Mt||Ha(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Mt)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:bn(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&lp(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}lp(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&xo(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}Mt||t.flags&512&&sd(t)}catch(h){Ze(t,t.return,h)}}if(t===e){ee=null;break}if(n=t.sibling,n!==null){n.return=t.return,ee=n;break}ee=t.return}}function kp(e){for(;ee!==null;){var t=ee;if(t===e){ee=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ee=n;break}ee=t.return}}function Ep(e){for(;ee!==null;){var t=ee;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ha(4,t)}catch(u){Ze(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(u){Ze(t,s,u)}}var i=t.return;try{sd(t)}catch(u){Ze(t,i,u)}break;case 5:var o=t.return;try{sd(t)}catch(u){Ze(t,o,u)}}}catch(u){Ze(t,t.return,u)}if(t===e){ee=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ee=l;break}ee=t.return}}var I1=Math.ceil,xa=cr.ReactCurrentDispatcher,If=cr.ReactCurrentOwner,mn=cr.ReactCurrentBatchConfig,Re=0,vt=null,st=null,wt=0,Jt=0,qs=Yr(0),ct=0,Ro=null,ks=0,Qa=0,_f=0,ao=null,Vt=null,Lf=0,ki=1/0,Xn=null,wa=!1,ld=null,zr=null,yl=!1,_r=null,Sa=0,uo=0,ad=null,Ul=-1,Vl=0;function Ft(){return Re&6?nt():Ul!==-1?Ul:Ul=nt()}function $r(e){return e.mode&1?Re&2&&wt!==0?wt&-wt:m1.transition!==null?(Vl===0&&(Vl=Zg()),Vl):(e=Fe,e!==0||(e=window.event,e=e===void 0?16:ov(e.type)),e):1}function Pn(e,t,n,r){if(50<uo)throw uo=0,ad=null,Error(H(185));$o(e,n,r),(!(Re&2)||e!==vt)&&(e===vt&&(!(Re&2)&&(Qa|=n),ct===4&&br(e,wt)),Kt(e,r),n===1&&Re===0&&!(t.mode&1)&&(ki=nt()+500,Ua&&Xr()))}function Kt(e,t){var n=e.callbackNode;mw(e,t);var r=sa(e,e===vt?wt:0);if(r===0)n!==null&&Lh(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Lh(n),t===1)e.tag===0?p1(Np.bind(null,e)):Ev(Np.bind(null,e)),c1(function(){!(Re&6)&&Xr()}),n=null;else{switch(ev(r)){case 1:n=of;break;case 4:n=Gg;break;case 16:n=ra;break;case 536870912:n=Jg;break;default:n=ra}n=Cy(n,gy.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function gy(e,t){if(Ul=-1,Vl=0,Re&6)throw Error(H(327));var n=e.callbackNode;if(ni()&&e.callbackNode!==n)return null;var r=sa(e,e===vt?wt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=ba(e,r);else{t=r;var s=Re;Re|=2;var i=yy();(vt!==e||wt!==t)&&(Xn=null,ki=nt()+500,xs(e,t));do try{A1();break}catch(l){vy(e,l)}while(!0);xf(),xa.current=i,Re=s,st!==null?t=0:(vt=null,wt=0,t=ct)}if(t!==0){if(t===2&&(s=Ac(e),s!==0&&(r=s,t=ud(e,s))),t===1)throw n=Ro,xs(e,0),br(e,r),Kt(e,nt()),n;if(t===6)br(e,r);else{if(s=e.current.alternate,!(r&30)&&!_1(s)&&(t=ba(e,r),t===2&&(i=Ac(e),i!==0&&(r=i,t=ud(e,i))),t===1))throw n=Ro,xs(e,0),br(e,r),Kt(e,nt()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(H(345));case 2:ts(e,Vt,Xn);break;case 3:if(br(e,r),(r&130023424)===r&&(t=Lf+500-nt(),10<t)){if(sa(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){Ft(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Vc(ts.bind(null,e,Vt,Xn),t);break}ts(e,Vt,Xn);break;case 4:if(br(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-Mn(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=nt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*I1(r/1960))-r,10<r){e.timeoutHandle=Vc(ts.bind(null,e,Vt,Xn),r);break}ts(e,Vt,Xn);break;case 5:ts(e,Vt,Xn);break;default:throw Error(H(329))}}}return Kt(e,nt()),e.callbackNode===n?gy.bind(null,e):null}function ud(e,t){var n=ao;return e.current.memoizedState.isDehydrated&&(xs(e,t).flags|=256),e=ba(e,t),e!==2&&(t=Vt,Vt=n,t!==null&&cd(t)),e}function cd(e){Vt===null?Vt=e:Vt.push.apply(Vt,e)}function _1(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Tn(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function br(e,t){for(t&=~_f,t&=~Qa,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Mn(t),r=1<<n;e[n]=-1,t&=~r}}function Np(e){if(Re&6)throw Error(H(327));ni();var t=sa(e,0);if(!(t&1))return Kt(e,nt()),null;var n=ba(e,t);if(e.tag!==0&&n===2){var r=Ac(e);r!==0&&(t=r,n=ud(e,r))}if(n===1)throw n=Ro,xs(e,0),br(e,t),Kt(e,nt()),n;if(n===6)throw Error(H(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ts(e,Vt,Xn),Kt(e,nt()),null}function Af(e,t){var n=Re;Re|=1;try{return e(t)}finally{Re=n,Re===0&&(ki=nt()+500,Ua&&Xr())}}function Es(e){_r!==null&&_r.tag===0&&!(Re&6)&&ni();var t=Re;Re|=1;var n=mn.transition,r=Fe;try{if(mn.transition=null,Fe=1,e)return e()}finally{Fe=r,mn.transition=n,Re=t,!(Re&6)&&Xr()}}function Ff(){Jt=qs.current,ze(qs)}function xs(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,u1(n)),st!==null)for(n=st.return;n!==null;){var r=n;switch(gf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ua();break;case 3:bi(),ze(Ht),ze(Rt),Ef();break;case 5:kf(r);break;case 4:bi();break;case 13:ze(Ke);break;case 19:ze(Ke);break;case 10:wf(r.type._context);break;case 22:case 23:Ff()}n=n.return}if(vt=e,st=e=Br(e.current,null),wt=Jt=t,ct=0,Ro=null,_f=Qa=ks=0,Vt=ao=null,rs!==null){for(t=0;t<rs.length;t++)if(n=rs[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}rs=null}return e}function vy(e,t){do{var n=st;try{if(xf(),zl.current=ya,va){for(var r=Ye.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}va=!1}if(Cs=0,gt=at=Ye=null,oo=!1,jo=0,If.current=null,n===null||n.return===null){ct=1,Ro=t,st=null;break}e:{var i=e,o=n.return,l=n,u=t;if(t=wt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,f=l,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var w=hp(o);if(w!==null){w.flags&=-257,pp(w,o,l,i,t),w.mode&1&&fp(i,d,t),t=w,u=d;var x=t.updateQueue;if(x===null){var S=new Set;S.add(u),t.updateQueue=S}else x.add(u);break e}else{if(!(t&1)){fp(i,d,t),Of();break e}u=Error(H(426))}}else if(Ve&&l.mode&1){var C=hp(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),pp(C,o,l,i,t),vf(Ci(u,l));break e}}i=u=Ci(u,l),ct!==4&&(ct=2),ao===null?ao=[i]:ao.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var v=ey(i,u,t);op(i,v);break e;case 1:l=u;var m=i.type,y=i.stateNode;if(!(i.flags&128)&&(typeof m.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(zr===null||!zr.has(y)))){i.flags|=65536,t&=-t,i.lanes|=t;var g=ty(i,l,t);op(i,g);break e}}i=i.return}while(i!==null)}wy(n)}catch(b){t=b,st===n&&n!==null&&(st=n=n.return);continue}break}while(!0)}function yy(){var e=xa.current;return xa.current=ya,e===null?ya:e}function Of(){(ct===0||ct===3||ct===2)&&(ct=4),vt===null||!(ks&268435455)&&!(Qa&268435455)||br(vt,wt)}function ba(e,t){var n=Re;Re|=2;var r=yy();(vt!==e||wt!==t)&&(Xn=null,xs(e,t));do try{L1();break}catch(s){vy(e,s)}while(!0);if(xf(),Re=n,xa.current=r,st!==null)throw Error(H(261));return vt=null,wt=0,ct}function L1(){for(;st!==null;)xy(st)}function A1(){for(;st!==null&&!ow();)xy(st)}function xy(e){var t=by(e.alternate,e,Jt);e.memoizedProps=e.pendingProps,t===null?wy(e):st=t,If.current=null}function wy(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=M1(n,t),n!==null){n.flags&=32767,st=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ct=6,st=null;return}}else if(n=j1(n,t,Jt),n!==null){st=n;return}if(t=t.sibling,t!==null){st=t;return}st=t=e}while(t!==null);ct===0&&(ct=5)}function ts(e,t,n){var r=Fe,s=mn.transition;try{mn.transition=null,Fe=1,F1(e,t,n,r)}finally{mn.transition=s,Fe=r}return null}function F1(e,t,n,r){do ni();while(_r!==null);if(Re&6)throw Error(H(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(H(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(gw(e,i),e===vt&&(st=vt=null,wt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||yl||(yl=!0,Cy(ra,function(){return ni(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=mn.transition,mn.transition=null;var o=Fe;Fe=1;var l=Re;Re|=4,If.current=null,R1(e,n),py(n,e),n1(Bc),ia=!!$c,Bc=$c=null,e.current=n,T1(n),lw(),Re=l,Fe=o,mn.transition=i}else e.current=n;if(yl&&(yl=!1,_r=e,Sa=s),i=e.pendingLanes,i===0&&(zr=null),cw(n.stateNode),Kt(e,nt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(wa)throw wa=!1,e=ld,ld=null,e;return Sa&1&&e.tag!==0&&ni(),i=e.pendingLanes,i&1?e===ad?uo++:(uo=0,ad=e):uo=0,Xr(),null}function ni(){if(_r!==null){var e=ev(Sa),t=mn.transition,n=Fe;try{if(mn.transition=null,Fe=16>e?16:e,_r===null)var r=!1;else{if(e=_r,_r=null,Sa=0,Re&6)throw Error(H(331));var s=Re;for(Re|=4,ee=e.current;ee!==null;){var i=ee,o=i.child;if(ee.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(ee=d;ee!==null;){var f=ee;switch(f.tag){case 0:case 11:case 15:lo(8,f,i)}var p=f.child;if(p!==null)p.return=f,ee=p;else for(;ee!==null;){f=ee;var h=f.sibling,w=f.return;if(dy(f),f===d){ee=null;break}if(h!==null){h.return=w,ee=h;break}ee=w}}}var x=i.alternate;if(x!==null){var S=x.child;if(S!==null){x.child=null;do{var C=S.sibling;S.sibling=null,S=C}while(S!==null)}}ee=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ee=o;else e:for(;ee!==null;){if(i=ee,i.flags&2048)switch(i.tag){case 0:case 11:case 15:lo(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,ee=v;break e}ee=i.return}}var m=e.current;for(ee=m;ee!==null;){o=ee;var y=o.child;if(o.subtreeFlags&2064&&y!==null)y.return=o,ee=y;else e:for(o=m;ee!==null;){if(l=ee,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ha(9,l)}}catch(b){Ze(l,l.return,b)}if(l===o){ee=null;break e}var g=l.sibling;if(g!==null){g.return=l.return,ee=g;break e}ee=l.return}}if(Re=s,Xr(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(Oa,e)}catch{}r=!0}return r}finally{Fe=n,mn.transition=t}}return!1}function jp(e,t,n){t=Ci(n,t),t=ey(e,t,1),e=Dr(e,t,1),t=Ft(),e!==null&&($o(e,1,t),Kt(e,t))}function Ze(e,t,n){if(e.tag===3)jp(e,e,n);else for(;t!==null;){if(t.tag===3){jp(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(zr===null||!zr.has(r))){e=Ci(n,e),e=ty(t,e,1),t=Dr(t,e,1),e=Ft(),t!==null&&($o(t,1,e),Kt(t,e));break}}t=t.return}}function O1(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ft(),e.pingedLanes|=e.suspendedLanes&n,vt===e&&(wt&n)===n&&(ct===4||ct===3&&(wt&130023424)===wt&&500>nt()-Lf?xs(e,0):_f|=n),Kt(e,t)}function Sy(e,t){t===0&&(e.mode&1?(t=al,al<<=1,!(al&130023424)&&(al=4194304)):t=1);var n=Ft();e=ar(e,t),e!==null&&($o(e,t,n),Kt(e,n))}function D1(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Sy(e,n)}function z1(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(t),Sy(e,n)}var by;by=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ht.current)Wt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Wt=!1,N1(e,t,n);Wt=!!(e.flags&131072)}else Wt=!1,Ve&&t.flags&1048576&&Nv(t,fa,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Bl(e,t),e=t.pendingProps;var s=xi(t,Rt.current);ti(t,n),s=jf(null,t,r,e,s,n);var i=Mf();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Qt(r)?(i=!0,ca(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,bf(t),s.updater=Wa,t.stateNode=s,s._reactInternals=t,qc(t,r,e,n),t=Zc(null,t,r,!0,i,n)):(t.tag=0,Ve&&i&&mf(t),Lt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Bl(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=B1(r),e=bn(r,e),s){case 0:t=Jc(null,t,r,e,n);break e;case 1:t=vp(null,t,r,e,n);break e;case 11:t=mp(null,t,r,e,n);break e;case 14:t=gp(null,t,r,bn(r.type,e),n);break e}throw Error(H(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:bn(r,s),Jc(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:bn(r,s),vp(e,t,r,s,n);case 3:e:{if(iy(t),e===null)throw Error(H(387));r=t.pendingProps,i=t.memoizedState,s=i.element,Iv(e,t),ma(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Ci(Error(H(423)),t),t=yp(e,t,r,n,s);break e}else if(r!==s){s=Ci(Error(H(424)),t),t=yp(e,t,r,n,s);break e}else for(Zt=Or(t.stateNode.containerInfo.firstChild),en=t,Ve=!0,jn=null,n=Rv(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(wi(),r===s){t=ur(e,t,n);break e}Lt(e,t,r,n)}t=t.child}return t;case 5:return _v(t),e===null&&Kc(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,Uc(r,s)?o=null:i!==null&&Uc(r,i)&&(t.flags|=32),sy(e,t),Lt(e,t,o,n),t.child;case 6:return e===null&&Kc(t),null;case 13:return oy(e,t,n);case 4:return Cf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Si(t,null,r,n):Lt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:bn(r,s),mp(e,t,r,s,n);case 7:return Lt(e,t,t.pendingProps,n),t.child;case 8:return Lt(e,t,t.pendingProps.children,n),t.child;case 12:return Lt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Oe(ha,r._currentValue),r._currentValue=o,i!==null)if(Tn(i.value,o)){if(i.children===s.children&&!Ht.current){t=ur(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=rr(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?u.next=u:(u.next=f.next,f.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Yc(i.return,n,t),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(H(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Yc(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Lt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,ti(t,n),s=gn(s),r=r(s),t.flags|=1,Lt(e,t,r,n),t.child;case 14:return r=t.type,s=bn(r,t.pendingProps),s=bn(r.type,s),gp(e,t,r,s,n);case 15:return ny(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:bn(r,s),Bl(e,t),t.tag=1,Qt(r)?(e=!0,ca(t)):e=!1,ti(t,n),Zv(t,r,s),qc(t,r,s,n),Zc(null,t,r,!0,e,n);case 19:return ly(e,t,n);case 22:return ry(e,t,n)}throw Error(H(156,t.tag))};function Cy(e,t){return qg(e,t)}function $1(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pn(e,t,n,r){return new $1(e,t,n,r)}function Df(e){return e=e.prototype,!(!e||!e.isReactComponent)}function B1(e){if(typeof e=="function")return Df(e)?1:0;if(e!=null){if(e=e.$$typeof,e===nf)return 11;if(e===rf)return 14}return 2}function Br(e,t){var n=e.alternate;return n===null?(n=pn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Wl(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")Df(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case $s:return ws(n.children,s,i,t);case tf:o=8,s|=8;break;case wc:return e=pn(12,n,t,s|2),e.elementType=wc,e.lanes=i,e;case Sc:return e=pn(13,n,t,s),e.elementType=Sc,e.lanes=i,e;case bc:return e=pn(19,n,t,s),e.elementType=bc,e.lanes=i,e;case _g:return Ka(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Tg:o=10;break e;case Ig:o=9;break e;case nf:o=11;break e;case rf:o=14;break e;case xr:o=16,r=null;break e}throw Error(H(130,e==null?e:typeof e,""))}return t=pn(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function ws(e,t,n,r){return e=pn(7,e,r,t),e.lanes=n,e}function Ka(e,t,n,r){return e=pn(22,e,r,t),e.elementType=_g,e.lanes=n,e.stateNode={isHidden:!1},e}function tc(e,t,n){return e=pn(6,e,null,t),e.lanes=n,e}function nc(e,t,n){return t=pn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function U1(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Fu(0),this.expirationTimes=Fu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Fu(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function zf(e,t,n,r,s,i,o,l,u){return e=new U1(e,t,n,l,u),t===1?(t=1,i===!0&&(t|=8)):t=0,i=pn(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},bf(i),e}function V1(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zs,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function ky(e){if(!e)return Qr;e=e._reactInternals;e:{if(Ps(e)!==e||e.tag!==1)throw Error(H(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Qt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(H(171))}if(e.tag===1){var n=e.type;if(Qt(n))return kv(e,n,t)}return t}function Ey(e,t,n,r,s,i,o,l,u){return e=zf(n,r,!0,e,s,i,o,l,u),e.context=ky(null),n=e.current,r=Ft(),s=$r(n),i=rr(r,s),i.callback=t??null,Dr(n,i,s),e.current.lanes=s,$o(e,s,r),Kt(e,r),e}function Ya(e,t,n,r){var s=t.current,i=Ft(),o=$r(s);return n=ky(n),t.context===null?t.context=n:t.pendingContext=n,t=rr(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Dr(s,t,o),e!==null&&(Pn(e,s,o,i),Dl(e,s,o)),o}function Ca(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Mp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function $f(e,t){Mp(e,t),(e=e.alternate)&&Mp(e,t)}function W1(){return null}var Ny=typeof reportError=="function"?reportError:function(e){console.error(e)};function Bf(e){this._internalRoot=e}Xa.prototype.render=Bf.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(H(409));Ya(e,t,null,null)};Xa.prototype.unmount=Bf.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Es(function(){Ya(null,e,null,null)}),t[lr]=null}};function Xa(e){this._internalRoot=e}Xa.prototype.unstable_scheduleHydration=function(e){if(e){var t=rv();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Sr.length&&t!==0&&t<Sr[n].priority;n++);Sr.splice(n,0,e),n===0&&iv(e)}};function Uf(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function qa(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Pp(){}function H1(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Ca(o);i.call(d)}}var o=Ey(t,r,e,0,null,!1,!1,"",Pp);return e._reactRootContainer=o,e[lr]=o.current,bo(e.nodeType===8?e.parentNode:e),Es(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=Ca(u);l.call(d)}}var u=zf(e,0,!1,null,null,!1,!1,"",Pp);return e._reactRootContainer=u,e[lr]=u.current,bo(e.nodeType===8?e.parentNode:e),Es(function(){Ya(t,u,n,r)}),u}function Ga(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=Ca(o);l.call(u)}}Ya(t,o,e,s)}else o=H1(n,t,e,s,r);return Ca(o)}tv=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Gi(t.pendingLanes);n!==0&&(lf(t,n|1),Kt(t,nt()),!(Re&6)&&(ki=nt()+500,Xr()))}break;case 13:Es(function(){var r=ar(e,1);if(r!==null){var s=Ft();Pn(r,e,1,s)}}),$f(e,1)}};af=function(e){if(e.tag===13){var t=ar(e,134217728);if(t!==null){var n=Ft();Pn(t,e,134217728,n)}$f(e,134217728)}};nv=function(e){if(e.tag===13){var t=$r(e),n=ar(e,t);if(n!==null){var r=Ft();Pn(n,e,t,r)}$f(e,t)}};rv=function(){return Fe};sv=function(e,t){var n=Fe;try{return Fe=e,t()}finally{Fe=n}};Ic=function(e,t,n){switch(t){case"input":if(Ec(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Ba(r);if(!s)throw Error(H(90));Ag(r),Ec(r,s)}}}break;case"textarea":Og(e,n);break;case"select":t=n.value,t!=null&&Gs(e,!!n.multiple,t,!1)}};Wg=Af;Hg=Es;var Q1={usingClientEntryPoint:!1,Events:[Uo,Ws,Ba,Ug,Vg,Af]},Vi={findFiberByHostInstance:ns,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},K1={bundleType:Vi.bundleType,version:Vi.version,rendererPackageName:Vi.rendererPackageName,rendererConfig:Vi.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Yg(e),e===null?null:e.stateNode},findFiberByHostInstance:Vi.findFiberByHostInstance||W1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xl.isDisabled&&xl.supportsFiber)try{Oa=xl.inject(K1),Bn=xl}catch{}}rn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q1;rn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Uf(t))throw Error(H(200));return V1(e,t,null,n)};rn.createRoot=function(e,t){if(!Uf(e))throw Error(H(299));var n=!1,r="",s=Ny;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=zf(e,1,!1,null,null,n,!1,r,s),e[lr]=t.current,bo(e.nodeType===8?e.parentNode:e),new Bf(t)};rn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(H(188)):(e=Object.keys(e).join(","),Error(H(268,e)));return e=Yg(t),e=e===null?null:e.stateNode,e};rn.flushSync=function(e){return Es(e)};rn.hydrate=function(e,t,n){if(!qa(t))throw Error(H(200));return Ga(null,e,t,!0,n)};rn.hydrateRoot=function(e,t,n){if(!Uf(e))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Ny;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=Ey(t,null,e,1,n??null,s,!1,i,o),e[lr]=t.current,bo(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Xa(t)};rn.render=function(e,t,n){if(!qa(t))throw Error(H(200));return Ga(null,e,t,!1,n)};rn.unmountComponentAtNode=function(e){if(!qa(e))throw Error(H(40));return e._reactRootContainer?(Es(function(){Ga(null,null,e,!1,function(){e._reactRootContainer=null,e[lr]=null})}),!0):!1};rn.unstable_batchedUpdates=Af;rn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!qa(n))throw Error(H(200));if(e==null||e._reactInternals===void 0)throw Error(H(38));return Ga(e,t,n,!1,r)};rn.version="18.3.1-next-f1338f8080-20240426";function jy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jy)}catch(e){console.error(e)}}jy(),jg.exports=rn;var Ja=jg.exports,My,Rp=Ja;My=Rp.createRoot,Rp.hydrateRoot;var Pi=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Y1={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Cr,Kd,ig,X1=(ig=class{constructor(){le(this,Cr,Y1);le(this,Kd,!1)}setTimeoutProvider(e){J(this,Cr,e)}setTimeout(e,t){return k(this,Cr).setTimeout(e,t)}clearTimeout(e){k(this,Cr).clearTimeout(e)}setInterval(e,t){return k(this,Cr).setInterval(e,t)}clearInterval(e){k(this,Cr).clearInterval(e)}},Cr=new WeakMap,Kd=new WeakMap,ig),is=new X1;function q1(e){setTimeout(e,0)}var Ns=typeof window>"u"||"Deno"in globalThis;function At(){}function G1(e,t){return typeof e=="function"?e(t):e}function dd(e){return typeof e=="number"&&e>=0&&e!==1/0}function Py(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Ur(e,t){return typeof e=="function"?e(t):e}function cn(e,t){return typeof e=="function"?e(t):e}function Tp(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(r){if(t.queryHash!==Vf(o,t.options))return!1}else if(!To(t.queryKey,o))return!1}if(n!=="all"){const u=t.isActive();if(n==="active"&&!u||n==="inactive"&&u)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function Ip(e,t){const{exact:n,status:r,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(js(t.options.mutationKey)!==js(i))return!1}else if(!To(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function Vf(e,t){return((t==null?void 0:t.queryKeyHashFn)||js)(e)}function js(e){return JSON.stringify(e,(t,n)=>fd(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function To(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>To(e[n],t[n])):!1}var J1=Object.prototype.hasOwnProperty;function Ry(e,t){if(e===t)return e;const n=_p(e)&&_p(t);if(!n&&!(fd(e)&&fd(t)))return t;const s=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),o=i.length,l=n?new Array(o):{};let u=0;for(let d=0;d<o;d++){const f=n?d:i[d],p=e[f],h=t[f];if(p===h){l[f]=p,(n?d<s:J1.call(e,f))&&u++;continue}if(p===null||h===null||typeof p!="object"||typeof h!="object"){l[f]=h;continue}const w=Ry(p,h);l[f]=w,w===p&&u++}return s===o&&u===s?e:l}function ka(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function _p(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function fd(e){if(!Lp(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!Lp(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function Lp(e){return Object.prototype.toString.call(e)==="[object Object]"}function Z1(e){return new Promise(t=>{is.setTimeout(t,e)})}function hd(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?Ry(e,t):t}function eS(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function tS(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var Wf=Symbol();function Ty(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Wf?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Iy(e,t){return typeof e=="function"?e(...t):!!e}function nS(e,t,n){let r=!1,s;return Object.defineProperty(e,"signal",{enumerable:!0,get:()=>(s??(s=t()),r||(r=!0,s.aborted?n():s.addEventListener("abort",n,{once:!0})),s)}),e}var cs,kr,oi,og,rS=(og=class extends Pi{constructor(){super();le(this,cs);le(this,kr);le(this,oi);J(this,oi,t=>{if(!Ns&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){k(this,kr)||this.setEventListener(k(this,oi))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,kr))==null||t.call(this),J(this,kr,void 0))}setEventListener(t){var n;J(this,oi,t),(n=k(this,kr))==null||n.call(this),J(this,kr,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){k(this,cs)!==t&&(J(this,cs,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof k(this,cs)=="boolean"?k(this,cs):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},cs=new WeakMap,kr=new WeakMap,oi=new WeakMap,og),Hf=new rS;function pd(){let e,t;const n=new Promise((s,i)=>{e=s,t=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}var sS=q1;function iS(){let e=[],t=0,n=l=>{l()},r=l=>{l()},s=sS;const i=l=>{t?e.push(l):s(()=>{n(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{r(()=>{l.forEach(u=>{n(u)})})})};return{batch:l=>{let u;t++;try{u=l()}finally{t--,t||o()}return u},batchCalls:l=>(...u)=>{i(()=>{l(...u)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var ut=iS(),li,Er,ai,lg,oS=(lg=class extends Pi{constructor(){super();le(this,li,!0);le(this,Er);le(this,ai);J(this,ai,t=>{if(!Ns&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){k(this,Er)||this.setEventListener(k(this,ai))}onUnsubscribe(){var t;this.hasListeners()||((t=k(this,Er))==null||t.call(this),J(this,Er,void 0))}setEventListener(t){var n;J(this,ai,t),(n=k(this,Er))==null||n.call(this),J(this,Er,t(this.setOnline.bind(this)))}setOnline(t){k(this,li)!==t&&(J(this,li,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return k(this,li)}},li=new WeakMap,Er=new WeakMap,ai=new WeakMap,lg),Ea=new oS;function lS(e){return Math.min(1e3*2**e,3e4)}function _y(e){return(e??"online")==="online"?Ea.isOnline():!0}var md=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Ly(e){let t=!1,n=0,r;const s=pd(),i=()=>s.status!=="pending",o=S=>{var C;if(!i()){const v=new md(S);h(v),(C=e.onCancel)==null||C.call(e,v)}},l=()=>{t=!0},u=()=>{t=!1},d=()=>Hf.isFocused()&&(e.networkMode==="always"||Ea.isOnline())&&e.canRun(),f=()=>_y(e.networkMode)&&e.canRun(),p=S=>{i()||(r==null||r(),s.resolve(S))},h=S=>{i()||(r==null||r(),s.reject(S))},w=()=>new Promise(S=>{var C;r=v=>{(i()||d())&&S(v)},(C=e.onPause)==null||C.call(e)}).then(()=>{var S;r=void 0,i()||(S=e.onContinue)==null||S.call(e)}),x=()=>{if(i())return;let S;const C=n===0?e.initialPromise:void 0;try{S=C??e.fn()}catch(v){S=Promise.reject(v)}Promise.resolve(S).then(p).catch(v=>{var E;if(i())return;const m=e.retry??(Ns?0:3),y=e.retryDelay??lS,g=typeof y=="function"?y(n,v):y,b=m===!0||typeof m=="number"&&n<m||typeof m=="function"&&m(n,v);if(t||!b){h(v);return}n++,(E=e.onFail)==null||E.call(e,n,v),Z1(g).then(()=>d()?void 0:w()).then(()=>{t?h(v):x()})})};return{promise:s,status:()=>s.status,cancel:o,continue:()=>(r==null||r(),s),cancelRetry:l,continueRetry:u,canStart:f,start:()=>(f()?x():w().then(x),s)}}var ds,ag,Ay=(ag=class{constructor(){le(this,ds)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),dd(this.gcTime)&&J(this,ds,is.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Ns?1/0:5*60*1e3))}clearGcTimeout(){k(this,ds)&&(is.clearTimeout(k(this,ds)),J(this,ds,void 0))}},ds=new WeakMap,ag),fs,ui,un,hs,mt,Lo,ps,kn,Yn,ug,aS=(ug=class extends Ay{constructor(t){super();le(this,kn);le(this,fs);le(this,ui);le(this,un);le(this,hs);le(this,mt);le(this,Lo);le(this,ps);J(this,ps,!1),J(this,Lo,t.defaultOptions),this.setOptions(t.options),this.observers=[],J(this,hs,t.client),J(this,un,k(this,hs).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,J(this,fs,Fp(this.options)),this.state=t.state??k(this,fs),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=k(this,mt))==null?void 0:t.promise}setOptions(t){if(this.options={...k(this,Lo),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Fp(this.options);n.data!==void 0&&(this.setState(Ap(n.data,n.dataUpdatedAt)),J(this,fs,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&k(this,un).remove(this)}setData(t,n){const r=hd(this.state.data,t,this.options);return ve(this,kn,Yn).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){ve(this,kn,Yn).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=k(this,mt))==null?void 0:r.promise;return(s=k(this,mt))==null||s.cancel(t),n?n.then(At).catch(At):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(k(this,fs))}isActive(){return this.observers.some(t=>cn(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Wf||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Ur(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Py(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,mt))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=k(this,mt))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),k(this,un).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(k(this,mt)&&(k(this,ps)?k(this,mt).cancel({revert:!0}):k(this,mt).cancelRetry()),this.scheduleGc()),k(this,un).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ve(this,kn,Yn).call(this,{type:"invalidate"})}async fetch(t,n){var u,d,f,p,h,w,x,S,C,v,m,y;if(this.state.fetchStatus!=="idle"&&((u=k(this,mt))==null?void 0:u.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(k(this,mt))return k(this,mt).continueRetry(),k(this,mt).promise}if(t&&this.setOptions(t),!this.options.queryFn){const g=this.observers.find(b=>b.options.queryFn);g&&this.setOptions(g.options)}const r=new AbortController,s=g=>{Object.defineProperty(g,"signal",{enumerable:!0,get:()=>(J(this,ps,!0),r.signal)})},i=()=>{const g=Ty(this.options,n),E=(()=>{const M={client:k(this,hs),queryKey:this.queryKey,meta:this.meta};return s(M),M})();return J(this,ps,!1),this.options.persister?this.options.persister(g,E,this):g(E)},l=(()=>{const g={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:k(this,hs),state:this.state,fetchFn:i};return s(g),g})();(d=this.options.behavior)==null||d.onFetch(l,this),J(this,ui,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=l.fetchOptions)==null?void 0:f.meta))&&ve(this,kn,Yn).call(this,{type:"fetch",meta:(p=l.fetchOptions)==null?void 0:p.meta}),J(this,mt,Ly({initialPromise:n==null?void 0:n.initialPromise,fn:l.fetchFn,onCancel:g=>{g instanceof md&&g.revert&&this.setState({...k(this,ui),fetchStatus:"idle"}),r.abort()},onFail:(g,b)=>{ve(this,kn,Yn).call(this,{type:"failed",failureCount:g,error:b})},onPause:()=>{ve(this,kn,Yn).call(this,{type:"pause"})},onContinue:()=>{ve(this,kn,Yn).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const g=await k(this,mt).start();if(g===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(g),(w=(h=k(this,un).config).onSuccess)==null||w.call(h,g,this),(S=(x=k(this,un).config).onSettled)==null||S.call(x,g,this.state.error,this),g}catch(g){if(g instanceof md){if(g.silent)return k(this,mt).promise;if(g.revert){if(this.state.data===void 0)throw g;return this.state.data}}throw ve(this,kn,Yn).call(this,{type:"error",error:g}),(v=(C=k(this,un).config).onError)==null||v.call(C,g,this),(y=(m=k(this,un).config).onSettled)==null||y.call(m,this.state.data,g,this),g}finally{this.scheduleGc()}}},fs=new WeakMap,ui=new WeakMap,un=new WeakMap,hs=new WeakMap,mt=new WeakMap,Lo=new WeakMap,ps=new WeakMap,kn=new WeakSet,Yn=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...Fy(r.data,this.options),fetchMeta:t.meta??null};case"success":const s={...r,...Ap(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return J(this,ui,t.manual?s:void 0),s;case"error":const i=t.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),ut.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),k(this,un).notify({query:this,type:"updated",action:t})})},ug);function Fy(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:_y(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Ap(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Fp(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Bt,Ee,Ao,It,ms,ci,Gn,Nr,Fo,di,fi,gs,vs,jr,hi,Ae,Zi,gd,vd,yd,xd,wd,Sd,bd,Oy,cg,uS=(cg=class extends Pi{constructor(t,n){super();le(this,Ae);le(this,Bt);le(this,Ee);le(this,Ao);le(this,It);le(this,ms);le(this,ci);le(this,Gn);le(this,Nr);le(this,Fo);le(this,di);le(this,fi);le(this,gs);le(this,vs);le(this,jr);le(this,hi,new Set);this.options=n,J(this,Bt,t),J(this,Nr,null),J(this,Gn,pd()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(k(this,Ee).addObserver(this),Op(k(this,Ee),this.options)?ve(this,Ae,Zi).call(this):this.updateResult(),ve(this,Ae,xd).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Cd(k(this,Ee),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Cd(k(this,Ee),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,ve(this,Ae,wd).call(this),ve(this,Ae,Sd).call(this),k(this,Ee).removeObserver(this)}setOptions(t){const n=this.options,r=k(this,Ee);if(this.options=k(this,Bt).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof cn(this.options.enabled,k(this,Ee))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");ve(this,Ae,bd).call(this),k(this,Ee).setOptions(this.options),n._defaulted&&!ka(this.options,n)&&k(this,Bt).getQueryCache().notify({type:"observerOptionsUpdated",query:k(this,Ee),observer:this});const s=this.hasListeners();s&&Dp(k(this,Ee),r,this.options,n)&&ve(this,Ae,Zi).call(this),this.updateResult(),s&&(k(this,Ee)!==r||cn(this.options.enabled,k(this,Ee))!==cn(n.enabled,k(this,Ee))||Ur(this.options.staleTime,k(this,Ee))!==Ur(n.staleTime,k(this,Ee)))&&ve(this,Ae,gd).call(this);const i=ve(this,Ae,vd).call(this);s&&(k(this,Ee)!==r||cn(this.options.enabled,k(this,Ee))!==cn(n.enabled,k(this,Ee))||i!==k(this,jr))&&ve(this,Ae,yd).call(this,i)}getOptimisticResult(t){const n=k(this,Bt).getQueryCache().build(k(this,Bt),t),r=this.createResult(n,t);return dS(this,r)&&(J(this,It,r),J(this,ci,this.options),J(this,ms,k(this,Ee).state)),r}getCurrentResult(){return k(this,It)}trackResult(t,n){return new Proxy(t,{get:(r,s)=>(this.trackProp(s),n==null||n(s),s==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&k(this,Gn).status==="pending"&&k(this,Gn).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,s))})}trackProp(t){k(this,hi).add(t)}getCurrentQuery(){return k(this,Ee)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=k(this,Bt).defaultQueryOptions(t),r=k(this,Bt).getQueryCache().build(k(this,Bt),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return ve(this,Ae,Zi).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),k(this,It)))}createResult(t,n){var _;const r=k(this,Ee),s=this.options,i=k(this,It),o=k(this,ms),l=k(this,ci),d=t!==r?t.state:k(this,Ao),{state:f}=t;let p={...f},h=!1,w;if(n._optimisticResults){const P=this.hasListeners(),B=!P&&Op(t,n),F=P&&Dp(t,r,n,s);(B||F)&&(p={...p,...Fy(f.data,t.options)}),n._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:x,errorUpdatedAt:S,status:C}=p;w=p.data;let v=!1;if(n.placeholderData!==void 0&&w===void 0&&C==="pending"){let P;i!=null&&i.isPlaceholderData&&n.placeholderData===(l==null?void 0:l.placeholderData)?(P=i.data,v=!0):P=typeof n.placeholderData=="function"?n.placeholderData((_=k(this,fi))==null?void 0:_.state.data,k(this,fi)):n.placeholderData,P!==void 0&&(C="success",w=hd(i==null?void 0:i.data,P,n),h=!0)}if(n.select&&w!==void 0&&!v)if(i&&w===(o==null?void 0:o.data)&&n.select===k(this,Fo))w=k(this,di);else try{J(this,Fo,n.select),w=n.select(w),w=hd(i==null?void 0:i.data,w,n),J(this,di,w),J(this,Nr,null)}catch(P){J(this,Nr,P)}k(this,Nr)&&(x=k(this,Nr),w=k(this,di),S=Date.now(),C="error");const m=p.fetchStatus==="fetching",y=C==="pending",g=C==="error",b=y&&m,E=w!==void 0,N={status:C,fetchStatus:p.fetchStatus,isPending:y,isSuccess:C==="success",isError:g,isInitialLoading:b,isLoading:b,data:w,dataUpdatedAt:p.dataUpdatedAt,error:x,errorUpdatedAt:S,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:m,isRefetching:m&&!y,isLoadingError:g&&!E,isPaused:p.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:g&&E,isStale:Qf(t,n),refetch:this.refetch,promise:k(this,Gn),isEnabled:cn(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const P=Q=>{N.status==="error"?Q.reject(N.error):N.data!==void 0&&Q.resolve(N.data)},B=()=>{const Q=J(this,Gn,N.promise=pd());P(Q)},F=k(this,Gn);switch(F.status){case"pending":t.queryHash===r.queryHash&&P(F);break;case"fulfilled":(N.status==="error"||N.data!==F.value)&&B();break;case"rejected":(N.status!=="error"||N.error!==F.reason)&&B();break}}return N}updateResult(){const t=k(this,It),n=this.createResult(k(this,Ee),this.options);if(J(this,ms,k(this,Ee).state),J(this,ci,this.options),k(this,ms).data!==void 0&&J(this,fi,k(this,Ee)),ka(n,t))return;J(this,It,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:s}=this.options,i=typeof s=="function"?s():s;if(i==="all"||!i&&!k(this,hi).size)return!0;const o=new Set(i??k(this,hi));return this.options.throwOnError&&o.add("error"),Object.keys(k(this,It)).some(l=>{const u=l;return k(this,It)[u]!==t[u]&&o.has(u)})};ve(this,Ae,Oy).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&ve(this,Ae,xd).call(this)}},Bt=new WeakMap,Ee=new WeakMap,Ao=new WeakMap,It=new WeakMap,ms=new WeakMap,ci=new WeakMap,Gn=new WeakMap,Nr=new WeakMap,Fo=new WeakMap,di=new WeakMap,fi=new WeakMap,gs=new WeakMap,vs=new WeakMap,jr=new WeakMap,hi=new WeakMap,Ae=new WeakSet,Zi=function(t){ve(this,Ae,bd).call(this);let n=k(this,Ee).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(At)),n},gd=function(){ve(this,Ae,wd).call(this);const t=Ur(this.options.staleTime,k(this,Ee));if(Ns||k(this,It).isStale||!dd(t))return;const r=Py(k(this,It).dataUpdatedAt,t)+1;J(this,gs,is.setTimeout(()=>{k(this,It).isStale||this.updateResult()},r))},vd=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(k(this,Ee)):this.options.refetchInterval)??!1},yd=function(t){ve(this,Ae,Sd).call(this),J(this,jr,t),!(Ns||cn(this.options.enabled,k(this,Ee))===!1||!dd(k(this,jr))||k(this,jr)===0)&&J(this,vs,is.setInterval(()=>{(this.options.refetchIntervalInBackground||Hf.isFocused())&&ve(this,Ae,Zi).call(this)},k(this,jr)))},xd=function(){ve(this,Ae,gd).call(this),ve(this,Ae,yd).call(this,ve(this,Ae,vd).call(this))},wd=function(){k(this,gs)&&(is.clearTimeout(k(this,gs)),J(this,gs,void 0))},Sd=function(){k(this,vs)&&(is.clearInterval(k(this,vs)),J(this,vs,void 0))},bd=function(){const t=k(this,Bt).getQueryCache().build(k(this,Bt),this.options);if(t===k(this,Ee))return;const n=k(this,Ee);J(this,Ee,t),J(this,Ao,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},Oy=function(t){ut.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(k(this,It))}),k(this,Bt).getQueryCache().notify({query:k(this,Ee),type:"observerResultsUpdated"})})},cg);function cS(e,t){return cn(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function Op(e,t){return cS(e,t)||e.state.data!==void 0&&Cd(e,t,t.refetchOnMount)}function Cd(e,t,n){if(cn(t.enabled,e)!==!1&&Ur(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&Qf(e,t)}return!1}function Dp(e,t,n,r){return(e!==t||cn(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&Qf(e,n)}function Qf(e,t){return cn(t.enabled,e)!==!1&&e.isStaleByTime(Ur(t.staleTime,e))}function dS(e,t){return!ka(e.getCurrentResult(),t)}function zp(e){return{onFetch:(t,n)=>{var f,p,h,w,x;const r=t.options,s=(h=(p=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:p.fetchMore)==null?void 0:h.direction,i=((w=t.state.data)==null?void 0:w.pages)||[],o=((x=t.state.data)==null?void 0:x.pageParams)||[];let l={pages:[],pageParams:[]},u=0;const d=async()=>{let S=!1;const C=y=>{nS(y,()=>t.signal,()=>S=!0)},v=Ty(t.options,t.fetchOptions),m=async(y,g,b)=>{if(S)return Promise.reject();if(g==null&&y.pages.length)return Promise.resolve(y);const M=(()=>{const B={client:t.client,queryKey:t.queryKey,pageParam:g,direction:b?"backward":"forward",meta:t.options.meta};return C(B),B})(),N=await v(M),{maxPages:_}=t.options,P=b?tS:eS;return{pages:P(y.pages,N,_),pageParams:P(y.pageParams,g,_)}};if(s&&i.length){const y=s==="backward",g=y?fS:$p,b={pages:i,pageParams:o},E=g(r,b);l=await m(b,E,y)}else{const y=e??i.length;do{const g=u===0?o[0]??r.initialPageParam:$p(r,l);if(u>0&&g==null)break;l=await m(l,g),u++}while(u<y)}return l};t.options.persister?t.fetchFn=()=>{var S,C;return(C=(S=t.options).persister)==null?void 0:C.call(S,d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=d}}}function $p(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function fS(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var Oo,On,_t,ys,Dn,yr,dg,hS=(dg=class extends Ay{constructor(t){super();le(this,Dn);le(this,Oo);le(this,On);le(this,_t);le(this,ys);J(this,Oo,t.client),this.mutationId=t.mutationId,J(this,_t,t.mutationCache),J(this,On,[]),this.state=t.state||Dy(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){k(this,On).includes(t)||(k(this,On).push(t),this.clearGcTimeout(),k(this,_t).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){J(this,On,k(this,On).filter(n=>n!==t)),this.scheduleGc(),k(this,_t).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){k(this,On).length||(this.state.status==="pending"?this.scheduleGc():k(this,_t).remove(this))}continue(){var t;return((t=k(this,ys))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var o,l,u,d,f,p,h,w,x,S,C,v,m,y,g,b,E,M,N,_;const n=()=>{ve(this,Dn,yr).call(this,{type:"continue"})},r={client:k(this,Oo),meta:this.options.meta,mutationKey:this.options.mutationKey};J(this,ys,Ly({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(P,B)=>{ve(this,Dn,yr).call(this,{type:"failed",failureCount:P,error:B})},onPause:()=>{ve(this,Dn,yr).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>k(this,_t).canRun(this)}));const s=this.state.status==="pending",i=!k(this,ys).canStart();try{if(s)n();else{ve(this,Dn,yr).call(this,{type:"pending",variables:t,isPaused:i}),await((l=(o=k(this,_t).config).onMutate)==null?void 0:l.call(o,t,this,r));const B=await((d=(u=this.options).onMutate)==null?void 0:d.call(u,t,r));B!==this.state.context&&ve(this,Dn,yr).call(this,{type:"pending",context:B,variables:t,isPaused:i})}const P=await k(this,ys).start();return await((p=(f=k(this,_t).config).onSuccess)==null?void 0:p.call(f,P,t,this.state.context,this,r)),await((w=(h=this.options).onSuccess)==null?void 0:w.call(h,P,t,this.state.context,r)),await((S=(x=k(this,_t).config).onSettled)==null?void 0:S.call(x,P,null,this.state.variables,this.state.context,this,r)),await((v=(C=this.options).onSettled)==null?void 0:v.call(C,P,null,t,this.state.context,r)),ve(this,Dn,yr).call(this,{type:"success",data:P}),P}catch(P){try{await((y=(m=k(this,_t).config).onError)==null?void 0:y.call(m,P,t,this.state.context,this,r))}catch(B){Promise.reject(B)}try{await((b=(g=this.options).onError)==null?void 0:b.call(g,P,t,this.state.context,r))}catch(B){Promise.reject(B)}try{await((M=(E=k(this,_t).config).onSettled)==null?void 0:M.call(E,void 0,P,this.state.variables,this.state.context,this,r))}catch(B){Promise.reject(B)}try{await((_=(N=this.options).onSettled)==null?void 0:_.call(N,void 0,P,t,this.state.context,r))}catch(B){Promise.reject(B)}throw ve(this,Dn,yr).call(this,{type:"error",error:P}),P}finally{k(this,_t).runNext(this)}}},Oo=new WeakMap,On=new WeakMap,_t=new WeakMap,ys=new WeakMap,Dn=new WeakSet,yr=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),ut.batch(()=>{k(this,On).forEach(r=>{r.onMutationUpdate(t)}),k(this,_t).notify({mutation:this,type:"updated",action:t})})},dg);function Dy(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Jn,En,Do,fg,pS=(fg=class extends Pi{constructor(t={}){super();le(this,Jn);le(this,En);le(this,Do);this.config=t,J(this,Jn,new Set),J(this,En,new Map),J(this,Do,0)}build(t,n,r){const s=new hS({client:t,mutationCache:this,mutationId:++nl(this,Do)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){k(this,Jn).add(t);const n=wl(t);if(typeof n=="string"){const r=k(this,En).get(n);r?r.push(t):k(this,En).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(k(this,Jn).delete(t)){const n=wl(t);if(typeof n=="string"){const r=k(this,En).get(n);if(r)if(r.length>1){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}else r[0]===t&&k(this,En).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=wl(t);if(typeof n=="string"){const r=k(this,En).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var r;const n=wl(t);if(typeof n=="string"){const s=(r=k(this,En).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){ut.batch(()=>{k(this,Jn).forEach(t=>{this.notify({type:"removed",mutation:t})}),k(this,Jn).clear(),k(this,En).clear()})}getAll(){return Array.from(k(this,Jn))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Ip(n,r))}findAll(t={}){return this.getAll().filter(n=>Ip(t,n))}notify(t){ut.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return ut.batch(()=>Promise.all(t.map(n=>n.continue().catch(At))))}},Jn=new WeakMap,En=new WeakMap,Do=new WeakMap,fg);function wl(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Zn,Mr,Ut,er,ir,Hl,kd,hg,mS=(hg=class extends Pi{constructor(n,r){super();le(this,ir);le(this,Zn);le(this,Mr);le(this,Ut);le(this,er);J(this,Zn,n),this.setOptions(r),this.bindMethods(),ve(this,ir,Hl).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var s;const r=this.options;this.options=k(this,Zn).defaultMutationOptions(n),ka(this.options,r)||k(this,Zn).getMutationCache().notify({type:"observerOptionsUpdated",mutation:k(this,Ut),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&js(r.mutationKey)!==js(this.options.mutationKey)?this.reset():((s=k(this,Ut))==null?void 0:s.state.status)==="pending"&&k(this,Ut).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=k(this,Ut))==null||n.removeObserver(this)}onMutationUpdate(n){ve(this,ir,Hl).call(this),ve(this,ir,kd).call(this,n)}getCurrentResult(){return k(this,Mr)}reset(){var n;(n=k(this,Ut))==null||n.removeObserver(this),J(this,Ut,void 0),ve(this,ir,Hl).call(this),ve(this,ir,kd).call(this)}mutate(n,r){var s;return J(this,er,r),(s=k(this,Ut))==null||s.removeObserver(this),J(this,Ut,k(this,Zn).getMutationCache().build(k(this,Zn),this.options)),k(this,Ut).addObserver(this),k(this,Ut).execute(n)}},Zn=new WeakMap,Mr=new WeakMap,Ut=new WeakMap,er=new WeakMap,ir=new WeakSet,Hl=function(){var r;const n=((r=k(this,Ut))==null?void 0:r.state)??Dy();J(this,Mr,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},kd=function(n){ut.batch(()=>{var r,s,i,o,l,u,d,f;if(k(this,er)&&this.hasListeners()){const p=k(this,Mr).variables,h=k(this,Mr).context,w={client:k(this,Zn),meta:this.options.meta,mutationKey:this.options.mutationKey};if((n==null?void 0:n.type)==="success"){try{(s=(r=k(this,er)).onSuccess)==null||s.call(r,n.data,p,h,w)}catch(x){Promise.reject(x)}try{(o=(i=k(this,er)).onSettled)==null||o.call(i,n.data,null,p,h,w)}catch(x){Promise.reject(x)}}else if((n==null?void 0:n.type)==="error"){try{(u=(l=k(this,er)).onError)==null||u.call(l,n.error,p,h,w)}catch(x){Promise.reject(x)}try{(f=(d=k(this,er)).onSettled)==null||f.call(d,void 0,n.error,p,h,w)}catch(x){Promise.reject(x)}}}this.listeners.forEach(p=>{p(k(this,Mr))})})},hg),zn,pg,gS=(pg=class extends Pi{constructor(t={}){super();le(this,zn);this.config=t,J(this,zn,new Map)}build(t,n,r){const s=n.queryKey,i=n.queryHash??Vf(s,n);let o=this.get(i);return o||(o=new aS({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){k(this,zn).has(t.queryHash)||(k(this,zn).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=k(this,zn).get(t.queryHash);n&&(t.destroy(),n===t&&k(this,zn).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ut.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return k(this,zn).get(t)}getAll(){return[...k(this,zn).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Tp(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>Tp(t,r)):n}notify(t){ut.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){ut.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ut.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},zn=new WeakMap,pg),Je,Pr,Rr,pi,mi,Tr,gi,vi,mg,vS=(mg=class{constructor(e={}){le(this,Je);le(this,Pr);le(this,Rr);le(this,pi);le(this,mi);le(this,Tr);le(this,gi);le(this,vi);J(this,Je,e.queryCache||new gS),J(this,Pr,e.mutationCache||new pS),J(this,Rr,e.defaultOptions||{}),J(this,pi,new Map),J(this,mi,new Map),J(this,Tr,0)}mount(){nl(this,Tr)._++,k(this,Tr)===1&&(J(this,gi,Hf.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,Je).onFocus())})),J(this,vi,Ea.subscribe(async e=>{e&&(await this.resumePausedMutations(),k(this,Je).onOnline())})))}unmount(){var e,t;nl(this,Tr)._--,k(this,Tr)===0&&((e=k(this,gi))==null||e.call(this),J(this,gi,void 0),(t=k(this,vi))==null||t.call(this),J(this,vi,void 0))}isFetching(e){return k(this,Je).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return k(this,Pr).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,Je).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=k(this,Je).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Ur(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return k(this,Je).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=k(this,Je).get(r.queryHash),i=s==null?void 0:s.state.data,o=G1(t,i);if(o!==void 0)return k(this,Je).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return ut.batch(()=>k(this,Je).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=k(this,Je).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=k(this,Je);ut.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=k(this,Je);return ut.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=ut.batch(()=>k(this,Je).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(At).catch(At)}invalidateQueries(e,t={}){return ut.batch(()=>(k(this,Je).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=ut.batch(()=>k(this,Je).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(At)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(At)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=k(this,Je).build(this,t);return n.isStaleByTime(Ur(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(At).catch(At)}fetchInfiniteQuery(e){return e.behavior=zp(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(At).catch(At)}ensureInfiniteQueryData(e){return e.behavior=zp(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Ea.isOnline()?k(this,Pr).resumePausedMutations():Promise.resolve()}getQueryCache(){return k(this,Je)}getMutationCache(){return k(this,Pr)}getDefaultOptions(){return k(this,Rr)}setDefaultOptions(e){J(this,Rr,e)}setQueryDefaults(e,t){k(this,pi).set(js(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...k(this,pi).values()],n={};return t.forEach(r=>{To(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){k(this,mi).set(js(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...k(this,mi).values()],n={};return t.forEach(r=>{To(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...k(this,Rr).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Vf(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Wf&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...k(this,Rr).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){k(this,Je).clear(),k(this,Pr).clear()}},Je=new WeakMap,Pr=new WeakMap,Rr=new WeakMap,pi=new WeakMap,mi=new WeakMap,Tr=new WeakMap,gi=new WeakMap,vi=new WeakMap,mg),zy=c.createContext(void 0),dr=e=>{const t=c.useContext(zy);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},yS=({client:e,children:t})=>(c.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(zy.Provider,{value:e,children:t})),$y=c.createContext(!1),xS=()=>c.useContext($y);$y.Provider;function wS(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var SS=c.createContext(wS()),bS=()=>c.useContext(SS),CS=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},kS=e=>{c.useEffect(()=>{e.clearReset()},[e])},ES=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:s})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(s&&e.data===void 0||Iy(n,[e.error,r])),NS=e=>{if(e.suspense){const n=s=>s==="static"?s:Math.max(s??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...s)=>n(r(...s)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},jS=(e,t)=>e.isLoading&&e.isFetching&&!t,MS=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,Bp=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function PS(e,t,n){var p,h,w,x,S;const r=xS(),s=bS(),i=dr(),o=i.defaultQueryOptions(e);(h=(p=i.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||h.call(p,o),o._optimisticResults=r?"isRestoring":"optimistic",NS(o),CS(o,s),kS(s);const l=!i.getQueryCache().get(o.queryHash),[u]=c.useState(()=>new t(i,o)),d=u.getOptimisticResult(o),f=!r&&e.subscribed!==!1;if(c.useSyncExternalStore(c.useCallback(C=>{const v=f?u.subscribe(ut.batchCalls(C)):At;return u.updateResult(),v},[u,f]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),c.useEffect(()=>{u.setOptions(o)},[o,u]),MS(o,d))throw Bp(o,u,s);if(ES({result:d,errorResetBoundary:s,throwOnError:o.throwOnError,query:i.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if((x=(w=i.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||x.call(w,o,d),o.experimental_prefetchInRender&&!Ns&&jS(d,r)){const C=l?Bp(o,u,s):(S=i.getQueryCache().get(o.queryHash))==null?void 0:S.promise;C==null||C.catch(At).finally(()=>{u.updateResult()})}return o.notifyOnChangeProps?d:u.trackResult(d)}function Za(e,t){return PS(e,uS)}function RS(e,t){const n=dr(),[r]=c.useState(()=>new mS(n,e));c.useEffect(()=>{r.setOptions(e)},[r,e]);const s=c.useSyncExternalStore(c.useCallback(o=>r.subscribe(ut.batchCalls(o)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=c.useCallback((o,l)=>{r.mutate(o,l).catch(At)},[r]);if(s.error&&Iy(r.options.throwOnError,[s.error]))throw s.error;return{...s,mutate:i,mutateAsync:s.mutate}}const By=8,TS=6;function Up(e,t,n){return n<t?t:Math.min(n,Math.max(t,e))}function Uy({x:e,y:t,menuWidth:n,menuHeight:r,viewport:s,margin:i=By}){const o=i,l=i,u=s.width-Math.max(0,n)-i,d=s.height-Math.max(0,r)-i;return{x:Up(e,o,u),y:Up(t,l,d)}}function IS({anchorRect:e,menuSize:t,viewport:n,align:r="left",margin:s=By,sideOffset:i=TS}){const o=r==="right"?e.right-t.width:e.left,l=e.bottom+i,u=e.top-t.height-i,d=l+t.height+s<=n.height,f=u>=s;return Uy({x:o,y:!d&&f?u:l,menuWidth:t.width,menuHeight:t.height,viewport:n,margin:s})}function Vy(){return typeof window>"u"?{width:1024,height:768}:{width:window.innerWidth,height:window.innerHeight}}function Vp(e){return e.length>0&&"options"in e[0]}function Wp(){return{x:0,y:0,ready:!1}}function Kf({value:e,onChange:t,options:n,placeholder:r="Select...",trigger:s,triggerClassName:i="",panelClassName:o="",align:l="left",width:u="auto",showChevron:d=!0,title:f,disabled:p=!1,"aria-label":h}){var Q,Z;const[w,x]=c.useState(!1),S=c.useRef(null),C=c.useRef(null),v=c.useRef(null),[m,y]=c.useState(Wp),b=c.useCallback(()=>{const W=I=>{const R=I.find(T=>T.value===e);return R?R.label:null};if(Vp(n))for(const I of n){const R=W(I.options);if(R)return R}else{const I=W(n);if(I)return I}return r},[e,n,r])(),E=((Q=S.current)==null?void 0:Q.getBoundingClientRect().width)??((Z=C.current)==null?void 0:Z.offsetWidth)??0,M=u==="trigger"?E:u==="auto"?void 0:u,N=c.useCallback(()=>{if(!w)return;const W=S.current,I=v.current;if(!W||!I)return;const R=W.getBoundingClientRect(),T=I.getBoundingClientRect(),L=M??T.width??180,O=T.height||I.scrollHeight||1,Y=IS({anchorRect:R,menuSize:{width:L,height:O},viewport:Vy(),align:l});y($=>$.x===Y.x&&$.y===Y.y&&$.ready?$:{x:Y.x,y:Y.y,ready:!0})},[l,M,w]);c.useLayoutEffect(()=>{if(!w){y(Wp());return}N()},[w,N,n,e]),c.useEffect(()=>{if(!w)return;const W=T=>{var O,Y;const L=T.target;(O=S.current)!=null&&O.contains(L)||(Y=v.current)!=null&&Y.contains(L)||x(!1)},I=T=>{var L;T.key==="Escape"&&(x(!1),(L=C.current)==null||L.focus())},R=()=>N();return window.addEventListener("click",W),window.addEventListener("keydown",I),window.addEventListener("resize",R),window.addEventListener("scroll",R,!0),()=>{window.removeEventListener("click",W),window.removeEventListener("keydown",I),window.removeEventListener("resize",R),window.removeEventListener("scroll",R,!0)}},[w,N]);const _=W=>{var I;t(W),x(!1),(I=C.current)==null||I.focus()},P=W=>W.map(I=>a.jsxs("button",{className:"dropdown-item","data-active":I.value===e,disabled:I.disabled,onClick:()=>!I.disabled&&_(I.value),role:"menuitem",children:[I.icon&&a.jsx("span",{className:"shrink-0",children:I.icon}),a.jsx("span",{className:"flex-1 truncate",children:I.label}),I.value===e&&a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0 text-accent",children:a.jsx("polyline",{points:"20 6 9 17 4 12"})})]},I.value)),B=c.useMemo(()=>({position:"fixed",left:m.x,top:m.y,visibility:m.ready?"visible":"hidden",...M?{width:M,minWidth:M}:{}}),[M,m]),F=w?a.jsx("div",{ref:v,className:`dropdown-panel ${o}`,style:B,role:"listbox","aria-label":h,children:Vp(n)?n.map((W,I)=>a.jsxs("div",{children:[W.label&&a.jsx("div",{className:"dropdown-label",children:W.label}),P(W.options),I<n.length-1&&a.jsx("div",{className:"dropdown-divider"})]},W.label||I)):P(n)}):null;return a.jsxs("div",{ref:S,className:"relative",children:[s?a.jsx("div",{onClick:()=>!p&&x(W=>!W),children:s}):a.jsxs("button",{ref:C,type:"button",className:`dropdown-trigger ${i}`,onClick:()=>x(W=>!W),disabled:p,title:f,"aria-label":h,"aria-haspopup":"listbox","aria-expanded":w,children:[a.jsx("span",{className:"truncate",children:b}),d&&a.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`shrink-0 opacity-60 transition-transform ${w?"rotate-180":""}`,children:a.jsx("polyline",{points:"6 9 12 15 18 9"})})]}),F&&typeof document<"u"?Ja.createPortal(F,document.body):F]})}const _S={offline:"sync-dot-offline",unstable:"sync-dot-unstable",recent:"sync-dot-recent",editing:"sync-dot-editing",live:"sync-dot-live"};function LS({state:e,presence:t,syncLabel:n,connectionLabel:r,lastEditedLabel:s,hasEdits:i,localTypingActive:o,recentTouches:l,isNarrow:u}){const[d,f]=c.useState(!1),[p,h]=c.useState(null),w=c.useRef(null),x=c.useRef(null),S=c.useRef(null),C=t?`${t.viewing} viewing  ${t.editing} editing`:"- viewing  - editing",v=t?String(t.viewing):"-",m=c.useCallback(()=>{S.current&&(window.clearTimeout(S.current),S.current=null)},[]),y=c.useCallback((b,E)=>{var M;E&&((M=navigator.clipboard)==null||M.writeText(E).then(()=>{h(b),m(),S.current=window.setTimeout(()=>{h(N=>N===b?null:N)},1e3)}).catch(()=>{}))},[m]),g=c.useCallback(()=>{f(!1),window.requestAnimationFrame(()=>{var b;return(b=x.current)==null?void 0:b.focus()})},[]);return c.useEffect(()=>{if(!d)return;const b=M=>{!w.current||w.current.contains(M.target)||g()},E=M=>{M.key==="Escape"&&g()};return window.addEventListener("mousedown",b),window.addEventListener("keydown",E),()=>{window.removeEventListener("mousedown",b),window.removeEventListener("keydown",E)}},[d,g]),c.useEffect(()=>()=>{m()},[m]),a.jsxs("div",{ref:w,className:"sync-indicator",children:[a.jsxs("button",{ref:x,type:"button",className:"sync-indicator-button",onClick:()=>d?g():f(!0),"aria-haspopup":"dialog","aria-expanded":d,"aria-label":"Sync status",title:C,children:[a.jsx("span",{className:`sync-indicator-dot ${_S[e]}`,"aria-hidden":"true"}),!u&&a.jsx("span",{className:"sync-indicator-count tabular-nums",children:v}),!u&&o&&a.jsx("span",{className:"sync-indicator-local",children:"typing"})]}),d&&a.jsxs("div",{role:"dialog","aria-label":"Sync status",className:"sync-indicator-card select-text",children:[a.jsx("div",{className:"sync-indicator-line sync-indicator-primary",children:n}),a.jsx("div",{className:"sync-indicator-line",children:r}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:C}),a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:i?`Last edited: ${s}`:"No edits yet."}),o&&a.jsx("div",{className:"sync-indicator-line sync-indicator-muted",children:"Local typing in progress (saved on blur)."}),a.jsxs("div",{className:"sync-indicator-section",children:[a.jsx("div",{className:"sync-indicator-section-title",children:"Recently touched files"}),l.length>0?a.jsx("div",{className:"sync-indicator-list",children:l.map(b=>a.jsxs("div",{className:"sync-indicator-item",children:[a.jsx("button",{type:"button",className:"sync-indicator-item-name",title:`Copy filename: ${b.label}`,onClick:()=>y(b.path,b.label),children:b.label}),a.jsx("span",{className:"sync-indicator-item-time tabular-nums",children:p===b.path?"Copied":b.timeLabel})]},b.path))}):a.jsx("div",{className:"sync-indicator-empty",children:"No recent touches."})]})]})]})}const Vr={phoneMax:480,mobileMax:767,narrowMax:900,tabletMax:1024,mediumMax:1180},Ql={phone:`(max-width: ${Vr.phoneMax}px)`,narrow:`(max-width: ${Vr.narrowMax}px)`,toolbarCompact:`(max-width: ${Vr.mediumMax}px)`},Hp=200,Qp=240,AS=320,FS=360,OS=420;function Kp(e,t,n){return Math.min(Math.max(e,t),n)}function DS(e){return e<=Vr.tabletMax?AS:e<=Vr.mediumMax?FS:OS}function zS(e){return e<=Vr.tabletMax?360:e<=Vr.mediumMax?420:520}function $S({viewportWidth:e,leftOpen:t,rightOpen:n,leftWidth:r,rightWidth:s}){const i=DS(e);let o=t?Kp(r,Hp,i):0,l=n?Kp(s,Qp,i):0;const u=Math.max(0,e-zS(e));if(o+l>u){let d=o+l-u;if(l>0){const f=Math.max(0,l-Qp),p=Math.min(f,d);l-=p,d-=p}if(d>0&&o>0){const f=Math.max(0,o-Hp),p=Math.min(f,d);o-=p,d-=p}d>0&&l>0&&(l=Math.max(0,u-o)),o+l>u&&(o=Math.max(0,u-l))}return{leftWidth:Number(o.toFixed(2)),rightWidth:Number(l.toFixed(2))}}function Kl(e,t=!1){const[n,r]=c.useState(t);return c.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;const s=window.matchMedia(e),i=s,o=()=>r(s.matches);if(o(),typeof s.addEventListener=="function")return s.addEventListener("change",o),()=>s.removeEventListener("change",o);if(typeof i.addListener=="function"&&typeof i.removeListener=="function")return i.addListener(o),()=>{var l;return(l=i.removeListener)==null?void 0:l.call(i,o)}},[e]),n}function Wy({isRandom:e,dir:t}){return e?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"}),a.jsx("path",{d:"M21 3v5h-5"})]}):t==="desc"?a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 5v14"}),a.jsx("path",{d:"M19 12l-7 7-7-7"})]}):a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M12 19V5"}),a.jsx("path",{d:"M5 12l7-7 7 7"})]})}function BS({viewerActive:e,filtersOpen:t,filtersRef:n,totalFilterCount:r,filterCount:s,starFilterList:i,starCounts:o,onToggleFilters:l,onOpenFilters:u,onToggleStar:d,onClearFilters:f,onClearStars:p}){return a.jsxs("div",{ref:n,className:`toolbar-filter relative ${e?"opacity-40 pointer-events-none":""}`,children:[a.jsxs("button",{className:`btn ${r>0?"btn-active":""}`,onClick:l,"aria-haspopup":"dialog","aria-expanded":t,title:"Filters","aria-disabled":e,children:[a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})}),a.jsx("span",{className:"toolbar-filters-label",children:"Filters"}),r>0&&a.jsx("span",{className:"toolbar-filters-count px-1.5 py-0.5 text-[11px] rounded-full bg-accent-strong text-text",children:r})]}),t&&a.jsxs("div",{role:"dialog","aria-label":"Filters",className:"dropdown-panel w-[240px]",style:{top:"38px",left:0},children:[a.jsx("div",{className:"dropdown-label",children:"Rating"}),a.jsxs("div",{className:"px-1",children:[[5,4,3,2,1].map(h=>{const w=i.includes(h),x=(o==null?void 0:o[String(h)])??0;return a.jsxs("button",{onClick:()=>d==null?void 0:d(h),className:`dropdown-item justify-between ${w?"bg-accent-muted":""}`,children:[a.jsxs("span",{className:w?"text-star-active":"text-text",children:["".repeat(h),"".repeat(5-h)]}),a.jsx("span",{className:"text-xs text-muted",children:x})]},h)}),a.jsxs("button",{onClick:()=>d==null?void 0:d(0),className:`dropdown-item justify-between ${i.includes(0)?"bg-accent-muted":""}`,children:[a.jsx("span",{className:"text-text",children:"Unrated"}),a.jsx("span",{className:"text-xs text-muted",children:(o==null?void 0:o["0"])??0})]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("div",{className:"dropdown-label",children:"Metrics"}),a.jsxs("button",{className:"dropdown-item",onClick:()=>{l(),u==null||u()},children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]}),a.jsx("span",{children:"Open Metrics Panel"}),(s||0)>0&&a.jsxs("span",{className:"ml-auto text-xs text-muted",children:[s," active"]})]}),a.jsx("div",{className:"dropdown-divider"}),a.jsx("button",{className:"dropdown-item text-muted hover:text-text",onClick:()=>{f?f():p==null||p()},disabled:r===0,children:"Clear all filters"})]})]})}function US({viewMode:e,currentSort:t,sortOnlyOptions:n,sortDisabled:r,sortControlsDisabled:s,sortDir:i,isRandom:o,showSelectModeToggle:l,multiSelectMode:u,selectModeLabel:d,uploadBusy:f,uploadDisabled:p,onViewMode:h,onSortChange:w,onToggleSortDir:x,onToggleMultiSelectMode:S,onUploadClick:C}){return a.jsx("div",{className:"mobile-drawer",children:a.jsxs("div",{className:"mobile-drawer-row",children:[a.jsxs("div",{className:"mobile-pill-group",children:[a.jsx("button",{className:`mobile-pill ${e==="grid"?"is-active":""}`,onClick:()=>h==null?void 0:h("grid"),"aria-pressed":e==="grid",children:"Grid"}),a.jsx("button",{className:`mobile-pill ${e==="adaptive"?"is-active":""}`,onClick:()=>h==null?void 0:h("adaptive"),"aria-pressed":e==="adaptive",children:"Masonry"})]}),a.jsx(Kf,{value:t,onChange:v=>w==null?void 0:w(v),options:n,"aria-label":"Sort",triggerClassName:"mobile-pill mobile-pill-dropdown",panelClassName:"mobile-drawer-panel",disabled:r}),a.jsx("button",{className:`mobile-pill mobile-pill-icon ${s?"opacity-50 cursor-not-allowed":""}`,onClick:x,title:r?"Sorting disabled":o?"Shuffle":`Sort ${i==="desc"?"descending":"ascending"}`,"aria-label":o?"Shuffle":"Toggle sort direction","aria-disabled":s,disabled:s,children:a.jsx(Wy,{isRandom:o,dir:i})}),l&&a.jsx("button",{className:`mobile-pill ${u?"is-active":""}`,onClick:()=>S==null?void 0:S(),"aria-pressed":u,title:u?"Exit select mode":"Enter select mode",children:d}),C&&a.jsx("button",{className:`mobile-pill ${p||f?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!p&&!f&&C(),disabled:p||f,children:f?"Uploading":"Upload"})]})})}function VS({rootRef:e,onSearch:t,viewerActive:n,onBack:r,zoomPercent:s,onZoomPercentChange:i,currentLabel:o,itemCount:l,totalCount:u,sortSpec:d,metricKeys:f,onSortChange:p,sortDisabled:h=!1,filterCount:w,onOpenFilters:x,starFilters:S,onToggleStar:C,onClearStars:v,onClearFilters:m,starCounts:y,viewMode:g,onViewMode:b,gridItemSize:E,onGridItemSize:M,leftOpen:N,rightOpen:_,onToggleLeft:P,onToggleRight:B,onPrevImage:F,onNextImage:Q,canPrevImage:Z,canNextImage:W,searchDisabled:I=!1,searchPlaceholder:R,onUploadClick:T,uploadBusy:L=!1,uploadDisabled:O=!1,multiSelectMode:Y=!1,selectedCount:$=0,onToggleMultiSelectMode:A,syncIndicator:V}){const[K,G]=c.useState(!1),[re,X]=c.useState(!1),D=c.useRef(null),he=c.useRef(null),ie=Kl(Ql.narrow),me=Kl(Ql.phone),ke=Kl(Ql.toolbarCompact);c.useEffect(()=>{if(!K)return;const je=Ct=>{D.current&&!D.current.contains(Ct.target)&&G(!1)};return window.addEventListener("click",je),()=>window.removeEventListener("click",je)},[K]),c.useEffect(()=>{if(I){X(!1);return}if(!ie||n){X(!1);return}if(!re)return;const je=window.requestAnimationFrame(()=>{var Ct;return(Ct=he.current)==null?void 0:Ct.focus()});return()=>window.cancelAnimationFrame(je)},[ie,re,n,I]);const xe=d??{kind:"builtin",key:"added",dir:"desc"},qe=xe.dir,Yt=xe.kind==="builtin"&&xe.key==="random",dt=n||h,In=f!=null&&f.length?f.map(je=>({value:`metric:${je}`,label:je,disabled:h})):[],zt=[{value:"builtin:added",label:"Date added",disabled:h},{value:"builtin:name",label:"Filename",disabled:h},{value:"builtin:random",label:"Random",disabled:h},...In],Xt=[{label:"Layout",options:[{value:"layout:grid",label:"Grid"},{value:"layout:masonry",label:"Masonry"}]},{label:"Sort by",options:zt}],yn=xe.kind==="metric"?`metric:${xe.key}`:`builtin:${xe.key}`,se=[{label:"Sort by",options:zt}],oe=ie&&!n,be=!(!!n&&ke),fe=!!n&&!me,ue=oe&&!!A,$e=Y?$>0?`Done (${$})`:"Done":"Select",it=je=>{if(je.startsWith("layout:")){const Ct=je==="layout:masonry"?"adaptive":"grid";b==null||b(Ct)}else{if(h)return;p==null||p(Yp(je,xe))}},bt=()=>{!p||h||p(Yt?xe:{...xe,dir:qe==="desc"?"asc":"desc"})},ft=S??[],on=ft.length,ln=HS(w,on),qt=WS(l,u),We=o||"Root";return a.jsxs("div",{ref:e,className:`toolbar-shell ${n?"toolbar-shell-viewer":""} ${me?"toolbar-shell-phone":""} ${ke?"toolbar-shell-compact":""} fixed top-0 left-0 right-0 h-12 grid grid-cols-[minmax(0,1fr)_minmax(0,1fr)_auto] items-center px-3 gap-3 bg-panel border-b border-border z-[var(--z-toolbar)] col-span-full row-start-1 select-none`,children:[a.jsxs("div",{className:"toolbar-left flex items-center gap-4 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope flex items-center gap-3 min-w-0",children:[a.jsxs("div",{className:"toolbar-scope-text flex flex-col min-w-0 leading-tight",children:[a.jsx("span",{className:"toolbar-scope-label text-[10px] uppercase tracking-widest text-muted",children:"Scope"}),a.jsx("span",{className:"text-sm font-medium text-text truncate",title:We,children:We})]}),qt&&a.jsx("span",{className:"toolbar-count text-xs text-muted whitespace-nowrap tabular-nums",children:qt})]}),n&&a.jsxs("button",{className:"toolbar-back-btn btn btn-sm",onClick:r,title:"Back to grid",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Back"]}),be&&a.jsxs("div",{className:"toolbar-sort flex items-center gap-2",children:[a.jsxs("div",{className:`toolbar-sort-controls flex items-center gap-2 ${n?"opacity-40 pointer-events-none":""}`,children:[a.jsx(Kf,{value:yn,onChange:it,options:Xt,title:"Sort and layout options","aria-label":"Sort and layout",triggerClassName:"min-w-[110px]"}),a.jsx("button",{className:"toolbar-sort-dir btn btn-icon",onClick:bt,title:h?"Sorting disabled":Yt?"Shuffle":`Sort ${qe==="desc"?"descending":"ascending"}`,"aria-label":Yt?"Shuffle":"Toggle sort direction","aria-disabled":dt,disabled:dt,children:a.jsx(Wy,{isRandom:Yt,dir:qe})})]}),a.jsx(BS,{viewerActive:!!n,filtersOpen:K,filtersRef:D,totalFilterCount:ln,filterCount:w,starFilterList:ft,starCounts:y,onToggleFilters:()=>G(je=>!je),onOpenFilters:x,onToggleStar:C,onClearFilters:m,onClearStars:v})]})]}),a.jsx("div",{className:"toolbar-center flex items-center gap-3 justify-center min-w-0",children:n?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"range",min:5,max:800,step:1,value:Math.round(Math.max(5,Math.min(800,s??100))),onChange:je=>i==null?void 0:i(Number(je.target.value)),className:"zoom-slider","aria-label":"Zoom level"}),a.jsxs("span",{className:"text-xs text-muted min-w-[42px] text-right",children:[Math.round(s??100),"%"]})]}):M&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-xs text-muted",children:"Size"}),a.jsx("input",{type:"range",min:80,max:500,step:10,value:E??220,onChange:je=>M(Number(je.target.value)),className:"w-28 h-1.5 bg-border rounded-full appearance-none cursor-pointer hover:bg-hover transition-colors [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-text [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-text [&::-moz-range-thumb]:border-0","aria-label":"Thumbnail size"})]})}),a.jsxs("div",{className:"toolbar-right flex items-center gap-2 justify-end",children:[fe&&a.jsxs("div",{className:"toolbar-nav flex items-center gap-1 mr-1",children:[a.jsx("button",{className:`btn btn-icon ${Z?"":"opacity-40 cursor-not-allowed"}`,title:"Previous image (A / )",onClick:()=>Z&&(F==null?void 0:F()),"aria-label":"Previous image","aria-disabled":!Z,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})}),a.jsx("button",{className:`btn btn-icon ${W?"":"opacity-40 cursor-not-allowed"}`,title:"Next image (D / )",onClick:()=>W&&(Q==null?void 0:Q()),"aria-label":"Next image","aria-disabled":!W,children:a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("path",{d:"M9 6l6 6-6 6"})})})]}),a.jsxs("div",{className:"toolbar-panels flex items-center gap-1",children:[a.jsx("button",{className:`btn btn-icon ${N?"":"opacity-50"}`,title:N?"Hide left panel (Ctrl+B)":"Show left panel (Ctrl+B)",onClick:P,"aria-pressed":N,"aria-label":"Toggle left panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"11",y:"5",width:"10",height:"14",rx:"1.5"})]})}),a.jsx("button",{className:`btn btn-icon ${_?"":"opacity-50"}`,title:_?"Hide right panel (Ctrl+Alt+B)":"Show right panel (Ctrl+Alt+B)",onClick:B,"aria-pressed":_,"aria-label":"Toggle right panel",children:a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"15",y:"5",width:"6",height:"14",rx:"1.5"}),a.jsx("rect",{x:"3",y:"5",width:"10",height:"14",rx:"1.5"})]})})]}),!n&&T&&a.jsxs("button",{className:`btn ${O?"opacity-50 cursor-not-allowed":""}`,onClick:()=>!O&&T(),"aria-label":"Upload images",title:L?"Uploading":"Upload images","aria-disabled":O||L,disabled:O||L,children:[a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M12 16V5"}),a.jsx("path",{d:"M7 10l5-5 5 5"}),a.jsx("path",{d:"M4 19h16"})]}),a.jsx("span",{children:L?"Uploading":"Upload"})]}),V&&a.jsx(LS,{...V,isNarrow:ie||ke}),!n&&ie&&a.jsx("button",{className:`btn btn-icon ${re?"btn-active":""} ${I?"opacity-50 cursor-not-allowed":""}`,"aria-label":re?"Close search":"Open search",title:I?"Search disabled":re?"Close search":"Search",onClick:()=>!I&&X(je=>!je),disabled:I,children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"11",cy:"11",r:"7"}),a.jsx("path",{d:"M21 21l-4.35-4.35"})]})}),!n&&!ie?a.jsx("div",{className:"toolbar-search toolbar-search-desktop w-[240px]",children:a.jsx("input",{ref:he,"aria-label":"Search filename, tags, notes",placeholder:I?R??"Search disabled":"Search...",onChange:je=>t(je.target.value),className:"toolbar-search-input input w-full focus:w-full transition-all duration-200 select-text",disabled:I})}):null]}),!n&&ie&&re&&!I&&a.jsx("div",{className:"toolbar-search-row",children:a.jsx("input",{ref:he,"aria-label":"Search filename, tags, notes",placeholder:R??"Search...",onChange:je=>t(je.target.value),className:"toolbar-search-input-mobile input input-lg w-full select-text"})}),oe&&a.jsx(US,{viewMode:g,currentSort:yn,sortOnlyOptions:se,sortDisabled:h,sortControlsDisabled:dt,sortDir:qe,isRandom:Yt,showSelectModeToggle:ue,multiSelectMode:Y,selectModeLabel:$e,uploadBusy:L,uploadDisabled:O,onViewMode:b,onSortChange:je=>p==null?void 0:p(Yp(je,xe)),onToggleSortDir:bt,onToggleMultiSelectMode:A,onUploadClick:T})]})}function WS(e,t){if(typeof e!="number")return null;const n=e.toLocaleString();if(typeof t!="number")return`${n} items`;const r=t.toLocaleString();return t===e?`${n} items`:`${n} / ${r} items`}function HS(e,t){return typeof e=="number"?e:t>0?1:0}function Yp(e,t){if(e.startsWith("metric:")){const n=e.slice(7);return n?{kind:"metric",key:n,dir:t.dir}:t}if(e.startsWith("builtin:")){const n=e.slice(8);if(n==="name"||n==="added"||n==="random")return{kind:"builtin",key:n,dir:t.dir}}return t}class tn extends Error{constructor(n,r,s,i){super(r);lt(this,"status");lt(this,"url");lt(this,"body");this.name="FetchError",this.status=n,this.url=s,this.body=i}}function QS(e){const t=e.trim();return t.startsWith("{")||t.startsWith("[")}function Hy(e,t,n){if(t&&typeof t=="object"){const r=t,s=typeof r.error=="string"?r.error:null,i=typeof r.message=="string"?r.message:null;if(s&&i)return`${s}: ${i}`;if(s)return s;if(i)return i}return typeof t=="string"&&t?t:`HTTP ${e} for ${n}`}function yt(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{let u=null;const d=await l.text().catch(()=>"");if(d)if((l.headers.get("content-type")||"").includes("application/json")||QS(d))try{u=JSON.parse(d)}catch{u=d}else u=d;if(!l.ok)throw new tn(l.status,Hy(l.status,u,e),e,u);return u}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}function Wi(e,t={}){const{timeoutMs:n,...r}=t,s=new AbortController;let i;return n&&(i=window.setTimeout(()=>s.abort(),n)),{promise:fetch(e,{...r,signal:s.signal}).then(async l=>{if(!l.ok){const u=await l.text().catch(()=>""),d=u||null;throw new tn(l.status,Hy(l.status,d,e),e,d)}return l.blob()}).finally(()=>{i&&window.clearTimeout(i)}),abort:()=>s.abort()}}class Qy{constructor(t){lt(this,"store",new Map);lt(this,"inflight",new Map);lt(this,"totalBytes",0);this.maxBytes=t}getMaxBytes(){return this.maxBytes}getTotalBytes(){return this.totalBytes}getSize(){return this.store.size}has(t){return this.store.has(t)}isInflight(t){return this.inflight.has(t)}get(t){const n=this.store.get(t);if(n)return this.store.delete(t),this.store.set(t,n),n.blob}evictIfNeeded(t){for(;this.totalBytes+t>this.maxBytes&&this.store.size>0;){const n=this.store.keys().next().value;if(n==null)break;const r=this.store.get(n);r&&(this.totalBytes-=r.size),this.store.delete(n)}}set(t,n){const r=n.size||0;if(!(r>this.maxBytes)){if(this.store.has(t)){const s=this.store.get(t);this.totalBytes-=s.size,this.store.delete(t)}this.evictIfNeeded(r),this.store.set(t,{blob:n,size:r}),this.totalBytes+=r}}async getOrFetch(t,n){const r=this.get(t);if(r)return r;const s=this.inflight.get(t);if(s)return s.promise;const i=n(),o=typeof i=="object"&&"promise"in i,l=o?i.promise:i,u=o?i.abort:void 0,d=l.then(f=>(this.set(t,f),f)).finally(()=>{this.inflight.delete(t)});return this.inflight.set(t,{promise:d,abort:u}),d}prefetch(t,n){if(this.store.has(t)||this.inflight.has(t))return;const r=n(),s=typeof r=="object"&&"promise"in r,i=s?r.promise:r,o=s?r.abort:void 0,l=i.then(u=>(this.set(t,u),u)).catch(()=>new Blob).finally(()=>{this.inflight.delete(t)});this.inflight.set(t,{promise:l,abort:o})}cancelPrefetch(t){const n=this.inflight.get(t);if(n!=null&&n.abort)try{n.abort()}catch{}this.inflight.delete(t)}clear(){for(const[t,n]of this.inflight)if(n.abort)try{n.abort()}catch{}this.inflight.clear(),this.store.clear(),this.totalBytes=0}evictPrefix(t){const n=(()=>{const s=t?`/${t.replace(/^\/+/,"")}`:"/";return s==="/"?"/":s.replace(/\/+$/,"")})(),r=s=>{const i=s.startsWith("/")?s.replace(/\/+$/,""):`/${s.replace(/\/+$/,"")}`;return n==="/"?!0:i===n||i.startsWith(`${n}/`)};for(const[s,i]of Array.from(this.store.entries()))r(s)&&(this.totalBytes-=i.size,this.store.delete(s));for(const[s,i]of Array.from(this.inflight.entries()))if(r(s)){if(i.abort)try{i.abort()}catch{}this.inflight.delete(s)}this.totalBytes<0&&(this.totalBytes=0)}}const Ds=new Qy(60*1024*1024),Ed=new Qy(20*1024*1024),rc={};function KS(){const e=rc==null?void 0:rc.VITE_API_BASE,t=typeof window<"u",n=t?window.location.origin:"http://localhost",r=t?window.location.hostname:"localhost",s=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\]|.+\.localhost)$/i.test(r);if(!e)return"";let i;try{i=new URL(e,n)}catch{return""}const o=/^(localhost|127\.0\.0\.1|0\.0\.0\.0|\[::1\])$/i.test(i.hostname);return s?i.origin:o?"":i.origin}const Qe=KS();const YS=40*1024*1024;function XS(e){return e==="viewer"||e==="compare"}function Xp(e){return`${Qe}/thumb?path=${encodeURIComponent(e)}`}function qp(e){return`${Qe}/file?path=${encodeURIComponent(e)}`}const sc="lenslet.client_id",Gp="lenslet.client_id.session",Ky="lenslet.last_event_id",qS=1e3,GS=3e4,JS=5;let Nd=null,Yl=null,Jp=0,ri=null,si=0,eu=!0,Na=!1;function Yy(){return typeof window<"u"&&typeof EventSource<"u"}function Zp(e,t){if(!e)return null;try{return e.getItem(t)}catch{return null}}function em(e,t,n){if(e)try{e.setItem(t,n)}catch{}}function ZS(e,t){if(e)try{e.removeItem(t)}catch{}}function eb(){if(typeof navigator>"u")return"server";const e=navigator.userAgent||"",t=navigator.language||"",n=navigator.platform||"",r=typeof Intl<"u"&&Intl.DateTimeFormat().resolvedOptions().timeZone||"",s=typeof screen<"u"?`${screen.width}x${screen.height}x${screen.colorDepth}`:"";return[e,t,n,r,s].join("|")}function tb(e){let t=2166136261;for(let n=0;n<e.length;n+=1)t^=e.charCodeAt(n),t=t*16777619>>>0;return t.toString(16).padStart(8,"0")}function tm(){return typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`client_${Math.random().toString(36).slice(2,10)}_${Date.now()}`}function Hi(e){return Nd=e,e}function ja(e){if(typeof window>"u")return null;try{return e==="local"?window.localStorage:window.sessionStorage}catch{return null}}function Ei(){if(Nd)return Nd;const e=ja("local"),t=ja("session"),n=Zp(t,Gp);if(n)return Hi(n);const r=Zp(e,sc);if(t){const i=tm();return em(t,Gp,i),r&&ZS(e,sc),Hi(i)}if(r)return Hi(r);if(e){const i=tm();return em(e,sc,i),Hi(i)}const s=`fp_${tb(eb())}_${Math.random().toString(36).slice(2,8)}`;return Hi(s)}function tu(e="lenslet"){Jp+=1;const t=typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():`nonce_${Math.random().toString(36).slice(2,10)}_${Date.now()}_${Jp}`;return`${e}:${Ei()}:${t}`}function nb(){if(Yl!=null)return Yl;if(typeof window>"u")return null;const e=ja("local");if(!e)return null;try{const t=e.getItem(Ky);if(!t)return null;const n=Number(t);return!Number.isFinite(n)||n<=0?null:(Yl=n,n)}catch{return null}}function rb(e){if(!Number.isFinite(e)||e<=0||(Yl=e,typeof window>"u"))return;const t=ja("local");if(t)try{t.setItem(Ky,String(e))}catch{}}function sb(){if(typeof window>"u")return`${Qe}/events`;const e=new URL(`${Qe}/events`,window.location.origin),t=nb();return t!=null&&Number.isFinite(t)&&e.searchParams.set("last_event_id",String(t)),e.toString()}function ib(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}let Cn=null,Xy="idle";const jd=new Set,Md=new Set,Pd=new Set;function ii(e){Xy=e;for(const t of Md)t(e)}function Yf(e){if(Na!==e){Na=e;for(const t of Pd)t(e)}}function Xf(){ri!=null&&(window.clearTimeout(ri),ri=null)}function ob(){si=0,Xf()}function lb(){if(!eu||ri!=null)return;si+=1;const e=Math.min(qS*Math.pow(2,si-1),GS);si>=JS?(ii("offline"),Yf(!0)):ii("reconnecting"),ri=window.setTimeout(()=>{ri=null,qy()},e)}function qy(){if(!eu||!Yy()||(Cn&&Cn.readyState===EventSource.CLOSED&&(Cn.close(),Cn=null),Cn))return;si>0?ii("reconnecting"):ii("connecting");const e=new EventSource(sb());Cn=e;const t=n=>r=>{const s=ib(r.data);if(!s)return;const i=r.lastEventId?Number(r.lastEventId):null,o=i!=null&&Number.isFinite(i)?i:null;o!=null&&rb(o);for(const l of jd)l({type:n,id:o,data:s})};e.addEventListener("item-updated",t("item-updated")),e.addEventListener("metrics-updated",t("metrics-updated")),e.addEventListener("presence",t("presence")),e.onopen=()=>{ob(),Yf(!1),ii("live")},e.onerror=()=>{Cn===e&&(e.close(),Cn=null,lb())}}function ab(){eu=!0,Yy()&&(Xf(),qy())}function ub(){eu=!1,Xf(),si=0,Cn&&(Cn.close(),Cn=null),Yf(!1),ii("offline")}function cb(e){return jd.add(e),()=>{jd.delete(e)}}function db(e){return Md.add(e),e(Xy),()=>{Md.delete(e)}}function fb(e){return Pd.add(e),e(Na),()=>{Pd.delete(e)}}function hb(){return Na}function pb(e,t){const n=JSON.stringify(t),r=`${Qe}${e}`;if(typeof navigator<"u"&&typeof navigator.sendBeacon=="function")try{if(navigator.sendBeacon(r,new Blob([n],{type:"application/json"})))return!0}catch{}if(typeof fetch!="function")return!1;try{return fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:n,keepalive:!0}),!0}catch{return!1}}function mb(e,t,n){return pb("/presence/leave",{gallery_id:e,lease_id:t,client_id:n??Ei()})}function Sl(e){return e??Ei()}function bl(e,t){return yt(`${Qe}${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).promise}function gb(e,t){const n=new URLSearchParams({path:e});return(t==null?void 0:t.page)!=null&&n.set("page",String(t.page)),(t==null?void 0:t.pageSize)!=null&&n.set("page_size",String(t.pageSize)),t!=null&&t.recursive&&n.set("recursive","1"),t!=null&&t.legacyRecursive&&n.set("legacy_recursive","1"),n.toString()}const pe={getFolder:(e,t)=>yt(`${Qe}/folders?${gb(e,t)}`).promise,search:(e,t)=>{const n=new URLSearchParams;return e&&n.set("q",e),t&&n.set("path",t),yt(`${Qe}/search?${n}`).promise},getEmbeddings:()=>yt(`${Qe}/embeddings`).promise,searchEmbeddings:e=>yt(`${Qe}/embeddings/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,refreshFolder:e=>{const t=new URLSearchParams({path:e});return yt(`${Qe}/refresh?${t}`,{method:"POST"}).promise},getSidecar:e=>yt(`${Qe}/item?path=${encodeURIComponent(e)}`).promise,patchSidecar:(e,t,n)=>{const s={"Content-Type":"application/json","Idempotency-Key":(n==null?void 0:n.idempotencyKey)??tu("patch"),"x-client-id":Ei(),"x-updated-by":"web"};return(n==null?void 0:n.ifMatch)!=null&&(s["If-Match"]=String(n.ifMatch)),yt(`${Qe}/item?path=${encodeURIComponent(e)}`,{method:"PATCH",headers:s,body:JSON.stringify(t)}).promise},getMetadata:e=>yt(`${Qe}/metadata?path=${encodeURIComponent(e)}`).promise,putSidecar:(e,t)=>yt(`${Qe}/item?path=${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json","x-client-id":Ei(),"x-updated-by":"web"},body:JSON.stringify(t)}).promise,getHealth:()=>yt(`${Qe}/health`).promise,joinPresence:(e,t,n)=>bl("/presence/join",{gallery_id:e,client_id:Sl(n),lease_id:t}),movePresence:(e,t,n,r)=>bl("/presence/move",{from_gallery_id:e,to_gallery_id:t,client_id:Sl(r),lease_id:n}),leavePresence:(e,t,n)=>bl("/presence/leave",{gallery_id:e,client_id:Sl(n),lease_id:t}),postPresence:(e,t,n)=>bl("/presence",{gallery_id:e,client_id:Sl(n),lease_id:t}),getThumb:e=>Ed.getOrFetch(e,()=>Wi(Xp(e))),prefetchThumb:e=>{Ed.prefetch(e,()=>Wi(Xp(e)))},getFile:e=>Ds.getOrFetch(e,()=>Wi(qp(e))),exportComparison:e=>Wi(`${Qe}/export-comparison`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise,prefetchFile:async(e,t)=>{if(XS(t)&&!(Ds.has(e)||Ds.isInflight(e)))try{const n=await Wi(qp(e),{headers:{"x-lenslet-prefetch":t}}).promise;n.size<=YS&&Ds.set(e,n)}catch{}},cancelPrefetch:e=>{Ds.cancelPrefetch(e)},uploadFile:async(e,t)=>{const n=new FormData;return n.append("dest",e),n.append("file",t),yt(`${Qe}/file`,{method:"POST",body:n,timeoutMs:6e4}).promise},moveFile:async(e,t)=>{const n=new FormData;return n.append("src",e),n.append("dest",t),yt(`${Qe}/move`,{method:"POST",body:n}).promise},deleteFiles:async e=>yt(`${Qe}/delete`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paths:e})}).promise,exportIntent:async e=>{const t=new FormData;return t.append("path",e),yt(`${Qe}/export-intent`,{method:"POST",body:t}).promise},getViews:()=>yt(`${Qe}/views`).promise,saveViews:e=>yt(`${Qe}/views`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).promise};class vb{constructor(t=400){lt(this,"cache",new Map);lt(this,"maxSize");this.maxSize=t,typeof window<"u"&&window.addEventListener("beforeunload",()=>this.clear(),{once:!0})}get(t){const n=this.cache.get(t);return n&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){for(this.cache.has(t)&&this.cache.delete(t);this.cache.size>=this.maxSize;){const r=this.cache.keys().next().value;if(r===void 0)break;const s=this.cache.get(r);if(this.cache.delete(r),s)try{URL.revokeObjectURL(s)}catch{}}this.cache.set(t,n)}clear(){for(const t of this.cache.values())try{URL.revokeObjectURL(t)}catch{}this.cache.clear()}}const ic=new vb(400);function yb({path:e,name:t,onClick:n,selected:r,highlighted:s,highlightKey:i,displayW:o,displayH:l,ioRoot:u,isScrolling:d,priority:f}){const p=c.useRef(null),[h,w]=c.useState(()=>ic.get(e)??null),[x,S]=c.useState(!1),[C,v]=c.useState(()=>!!h);c.useEffect(()=>{const y=p.current;if(!y)return;const g=new IntersectionObserver(b=>{for(const E of b)E.target===y&&S(E.isIntersecting||E.intersectionRatio>0)},{root:u??null,rootMargin:"200px 0px",threshold:.01});return g.observe(y),()=>{g.unobserve(y),g.disconnect()}},[u]),c.useEffect(()=>{if(h||!(x&&!d||f))return;let y=!0;return pe.getThumb(e).then(g=>{if(!y)return;const b=URL.createObjectURL(g);ic.set(e,b),w(b)}).catch(()=>{}),()=>{y=!1}},[e,h,x,d,f]),c.useEffect(()=>{var g;if(!h){v(!1);return}const y=(g=p.current)==null?void 0:g.querySelector("img");y&&y.complete&&y.naturalWidth>0?v(!0):v(!1)},[h]),c.useEffect(()=>{w(ic.get(e)??null)},[e]);const m=["absolute inset-0 relative bg-hover border border-border rounded-lg overflow-hidden select-none",r?"outline-2 outline-accent":"",s?"thumb-updated-ring":"","hover:outline hover:outline-1 hover:outline-accent"].filter(Boolean).join(" ");return a.jsx("div",{ref:p,"data-highlight-key":i??void 0,className:m,onClick:n,children:h?a.jsx("img",{className:`w-full h-full object-cover block pointer-events-none select-none opacity-0 transition-opacity duration-[160ms] ${C?"opacity-100":""}`,src:h,alt:t,loading:"lazy",decoding:"async",onLoad:()=>v(!0),width:o?Math.round(o):void 0,height:l?Math.round(l):void 0}):null})}function As(e,t,n){let r=n.initialDeps??[],s,i=!0;function o(){var l,u,d;let f;n.key&&((l=n.debug)!=null&&l.call(n))&&(f=Date.now());const p=e();if(!(p.length!==r.length||p.some((x,S)=>r[S]!==x)))return s;r=p;let w;if(n.key&&((u=n.debug)!=null&&u.call(n))&&(w=Date.now()),s=t(...p),n.key&&((d=n.debug)!=null&&d.call(n))){const x=Math.round((Date.now()-f)*100)/100,S=Math.round((Date.now()-w)*100)/100,C=S/16,v=(m,y)=>{for(m=String(m);m.length<y;)m=" "+m;return m};console.info(`%c ${v(S,5)} /${v(x,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*C,120))}deg 100% 31%);`,n==null?void 0:n.key)}return n!=null&&n.onChange&&!(i&&n.skipInitialOnChange)&&n.onChange(s),i=!1,s}return o.updateDeps=l=>{r=l},o}function nm(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const xb=(e,t)=>Math.abs(e-t)<1.01,wb=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},rm=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},Sb=e=>e,bb=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},Cb=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=o=>{const{width:l,height:u}=o;t({width:Math.round(l),height:Math.round(u)})};if(s(rm(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(o=>{const l=()=>{const u=o[0];if(u!=null&&u.borderBoxSize){const d=u.borderBoxSize[0];if(d){s({width:d.inlineSize,height:d.blockSize});return}}s(rm(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(l):l()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},sm={passive:!0},im=typeof window>"u"?!0:"onscrollend"in window,kb=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&im?()=>{}:wb(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),o=f=>()=>{const{horizontal:p,isRtl:h}=e.options;s=p?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,f)},l=o(!0),u=o(!1);u(),n.addEventListener("scroll",l,sm);const d=e.options.useScrollendEvent&&im;return d&&n.addEventListener("scrollend",u,sm),()=>{n.removeEventListener("scroll",l),d&&n.removeEventListener("scrollend",u)}},Eb=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},Nb=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const o=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:o,behavior:n})};class jb{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.laneAssignments=new Map,this.pendingMeasuredCacheIndexes=[],this.prevLanes=void 0,this.lanesChangedFlag=!1,this.lanesSettling=!1,this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const o=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Sb,rangeExtractor:bb,onChange:()=>{},measureElement:Eb,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=As(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let o=r-1;o>=0;o--){const l=n[o];if(s.has(l.lane))continue;const u=i.get(l.lane);if(u==null||l.end>u.end?i.set(l.lane,l):l.end<u.end&&s.set(l.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((o,l)=>o.end===l.end?o.index-l.index:o.end-l.end)[0]:void 0},this.getMeasurementOptions=As(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled,this.options.lanes],(n,r,s,i,o,l)=>(this.prevLanes!==void 0&&this.prevLanes!==l&&(this.lanesChangedFlag=!0),this.prevLanes=l,this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l}),{key:!1,skipInitialOnChange:!0,onChange:()=>{this.notify(this.isScrolling)}}),this.getMeasurements=As(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:o,lanes:l},u)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),[];if(this.laneAssignments.size>n)for(const h of this.laneAssignments.keys())h>=n&&this.laneAssignments.delete(h);this.lanesChangedFlag&&(this.lanesChangedFlag=!1,this.lanesSettling=!0,this.measurementsCache=[],this.itemSizeCache.clear(),this.laneAssignments.clear(),this.pendingMeasuredCacheIndexes=[]),this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(h=>{this.itemSizeCache.set(h.key,h.size)}));const d=this.lanesSettling?0:this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[],this.lanesSettling&&this.measurementsCache.length===n&&(this.lanesSettling=!1);const f=this.measurementsCache.slice(0,d),p=new Array(l).fill(void 0);for(let h=0;h<d;h++){const w=f[h];w&&(p[w.lane]=h)}for(let h=d;h<n;h++){const w=i(h),x=this.laneAssignments.get(h);let S,C;if(x!==void 0&&this.options.lanes>1){S=x;const g=p[S],b=g!==void 0?f[g]:void 0;C=b?b.end+this.options.gap:r+s}else{const g=this.options.lanes===1?f[h-1]:this.getFurthestMeasurement(f,h);C=g?g.end+this.options.gap:r+s,S=g?g.lane:h%this.options.lanes,this.options.lanes>1&&this.laneAssignments.set(h,S)}const v=u.get(w),m=typeof v=="number"?v:this.options.estimateSize(h),y=C+m;f[h]={index:h,start:C,size:m,end:y,key:w,lane:S},p[S]=h}return this.measurementsCache=f,f},{key:!1,debug:()=>this.options.debug}),this.calculateRange=As(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?Mb({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=As(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,o)=>i===null||o===null?[]:n({startIndex:i,endIndex:o,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const o=i.key,l=this.elementsCache.get(o);l!==n&&(l&&this.observer.unobserve(l),this.observer.observe(n),this.elementsCache.set(o,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,o=r-i;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,o,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=As(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,o=n.length;i<o;i++){const l=n[i],u=r[l];s.push(u)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return nm(r[Gy(0,r.length-1,s=>nm(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),o=this.getScrollOffset();r==="auto"&&(r=n>=o+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const l=this.getTotalSize()+this.options.scrollMargin-i;return Math.max(Math.min(l,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),o=this.getScrollOffset();if(r==="auto")if(s.end>=o+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=o+this.options.scrollPaddingStart)r="start";else return[o,r];const l=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(l,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),n=Math.max(0,Math.min(n,this.options.count-1));let i=0;const o=10,l=d=>{if(!this.targetWindow)return;const f=this.getOffsetForIndex(n,d);if(!f){console.warn("Failed to get offset for index:",n);return}const[p,h]=f;this._scrollToOffset(p,{adjustments:void 0,behavior:s}),this.targetWindow.requestAnimationFrame(()=>{const w=this.getScrollOffset(),x=this.getOffsetForIndex(n,h);if(!x){console.warn("Failed to get offset for index:",n);return}xb(x[0],w)||u(h)})},u=d=>{this.targetWindow&&(i++,i<o?this.targetWindow.requestAnimationFrame(()=>l(d)):console.warn(`Failed to scroll to index ${n} after ${o} attempts.`))};l(r)},this.scrollBy=(n,{behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let o=r.length-1;for(;o>=0&&i.some(l=>l===null);){const l=r[o];i[l.lane]===null&&(i[l.lane]=l.end),o--}s=Math.max(...i.filter(l=>l!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.laneAssignments=new Map,this.notify(!1)},this.setOptions(t)}}const Gy=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function Mb({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=u=>e[u].start;if(e.length<=r)return{startIndex:0,endIndex:s};let o=Gy(0,s,i,n),l=o;if(r===1)for(;l<s&&e[l].end<n+t;)l++;else if(r>1){const u=Array(r).fill(0);for(;l<s&&u.some(f=>f<n+t);){const f=e[l];u[f.lane]=f.end,l++}const d=Array(r).fill(n+t);for(;o>=0&&d.some(f=>f>=n);){const f=e[o];d[f.lane]=f.start,o--}o=Math.max(0,o-o%r),l=Math.min(s,l+(r-1-l%r))}return{startIndex:o,endIndex:l}}const om=typeof document<"u"?c.useLayoutEffect:c.useEffect;function Pb(e){const t=c.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var o;i?Ja.flushSync(t):t(),(o=e.onChange)==null||o.call(e,s,i)}},[r]=c.useState(()=>new jb(n));return r.setOptions(n),om(()=>r._didMount(),[]),om(()=>r._willUpdate()),r}function Rb(e){return Pb({observeElementRect:Cb,observeElementOffset:kb,scrollToFn:Nb,...e})}function Tb({containerW:e,gap:t,targetCell:n,aspect:r,captionH:s}){const i=Math.max(1,Math.floor((e+t)/(n+t))),o=(e-t*(i-1))/i,l=o*r.h/r.w,u=l+s+t;return{columns:i,cellW:o,mediaH:l,rowH:u}}const Ib=1.333;function _b({items:e,containerWidth:t,targetHeight:n,gap:r,captionH:s}){if(t<=0)return[];const i=[];let o=[],l=0;const u=(d,f)=>({index:i.length,height:f+s+r,imageH:f,items:d.map(p=>({item:p.item,displayW:p.aspect*f,displayH:f,originalIndex:p.originalIndex}))});for(let d=0;d<e.length;d++){const f=e[d],p=f.w>0&&f.h>0?f.w/f.h:Ib;o.push({item:f,aspect:p,originalIndex:d}),l+=p;const h=(o.length-1)*r;if(l*n+h>=t){const x=(t-h)/l;i.push(u(o,x)),o=[],l=0}}return o.length>0&&i.push(u(o,n)),i}function Lb(e,t,n){return{mode:"adaptive",rows:_b({items:t,containerWidth:e,targetHeight:n.targetCell,gap:n.gap,captionH:n.captionH})}}function Ab(e,t,n){const{columns:r,cellW:s,mediaH:i,rowH:o}=Tb({containerW:e,gap:n.gap,targetCell:n.targetCell,aspect:n.aspect,captionH:n.captionH}),l=Math.ceil(t.length/Math.max(1,r));return{mode:"grid",columns:r,cellW:s,mediaH:i,rowH:o,rowCount:l}}function Fb(e,t,n){const[r,s]=c.useState(0);c.useLayoutEffect(()=>{const u=e.current;if(!u)return;const d=()=>{const p=getComputedStyle(u),h=u.clientWidth-parseFloat(p.paddingLeft)-parseFloat(p.paddingRight);s(h)},f=new ResizeObserver(d);return f.observe(u),d(),()=>f.disconnect()},[]);const i=c.useMemo(()=>n.viewMode==="adaptive"?Lb(r,t,n):Ab(r,t,n),[r,t,n.viewMode,n.gap,n.targetCell,n.aspect.w,n.aspect.h,n.captionH]),o=Rb({count:i.mode==="adaptive"?i.rows.length:i.rowCount,getScrollElement:()=>e.current,estimateSize:u=>i.mode==="adaptive"?i.rows[u].height:i.rowH,overscan:8}),l=o.getVirtualItems();return c.useEffect(()=>{o.measure()},[i,o]),{width:r,layout:i,rowVirtualizer:o,virtualRows:l}}function Ob(e,t,n,r){if(!e.length)return null;const s=n?e.findIndex(l=>l.path===n):0,i=Math.max(1,t);let o=s;if(r.key==="ArrowRight"||r.key==="d")o=Math.min(e.length-1,s+1);else if(r.key==="ArrowLeft"||r.key==="a")o=Math.max(0,s-1);else if(r.key==="ArrowDown"||r.key==="s")o=Math.min(e.length-1,s+i);else if(r.key==="ArrowUp"||r.key==="w")o=Math.max(0,s-i);else return r.key==="Enter"&&n?"open":null;return o}function Db(e,t,n){const r=[];for(const s of e){if(t.mode==="adaptive"){const l=t.rows[s.index];if(!l)continue;for(const u of l.items)r.push(u.item.path);continue}const i=s.index*t.columns,o=n.slice(i,i+t.columns);for(const l of o)r.push(l.path)}return Array.from(new Set(r))}function zb(e,t){var s,i;let n=0,r=e.length-1;for(;n<=r;){const o=n+r>>1,l=e[o],u=((s=l.items[0])==null?void 0:s.originalIndex)??-1,d=((i=l.items[l.items.length-1])==null?void 0:i.originalIndex)??-1;if(t>=u&&t<=d)return o;t<u?r=o-1:n=o+1}return 0}function $b(e,t,n){const r=new Set;for(const s of n){if(t.mode==="adaptive"){const l=t.rows[s.index];if(!l)continue;for(const u of l.items)r.add(u.item.path);continue}const i=s.index*t.columns,o=Math.min(e.length,i+t.columns);for(let l=i;l<o;l+=1){const u=e[l];u&&r.add(u.path)}}return r}function Bb(e,t,n,r){var o,l,u;const s=Vb(n,r);if(!s)return null;if(t.mode==="adaptive")return((l=(o=t.rows[s.index])==null?void 0:o.items[0])==null?void 0:l.item.path)??null;const i=s.index*t.columns;return((u=e[i])==null?void 0:u.path)??null}function Ub(e,t,n){let r=null,s=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;for(const o of e)o.path&&(o.bottom<=t||o.top>=n||o.top>s||o.top===s&&o.left>=i||(r=o.path,s=o.top,i=o.left));return r}function Vb(e,t){if(e.length===0)return null;const n=Math.max(0,t);for(const r of e){const s=r.start??0;if((r.end??s+(r.size??0))>n)return r}return e[0]}function Wb({selectionToken:e,appliedSelectionToken:t,selectedPath:n,topAnchorToken:r,appliedTopAnchorToken:s,topAnchorPath:i,hasPath:o}){const l=e??0;if(l>0&&l!==t&&n&&o(n))return{source:"selection",path:n,token:l};const u=r??0;return u>0&&u!==s&&i&&o(i)?{source:"top-anchor",path:i,token:u}:null}function Hb({path:e,pathToIndex:t,layout:n,adaptiveRowMeta:r}){var o;const s=t.get(e);if(s==null||s<0)return null;const i=n.mode==="grid"?Math.floor(s/Math.max(1,n.columns)):zb(n.rows,s);return n.mode==="grid"?i*n.rowH:((o=r==null?void 0:r[i])==null?void 0:o.start)??0}const Qb=500,Kb=450,Yb=600,Xb=8;function qb(e){return Math.max(Kb,Math.min(Yb,e))}class Gb{constructor(t){lt(this,"delayMs");lt(this,"moveTolerancePx");lt(this,"onLongPress");lt(this,"onCancel");lt(this,"timerId",null);lt(this,"activePointerId",null);lt(this,"startX",0);lt(this,"startY",0);lt(this,"lastEvent",null);lt(this,"fired",!1);this.delayMs=qb(t.delayMs??Qb),this.moveTolerancePx=Math.max(0,t.moveTolerancePx??Xb),this.onLongPress=t.onLongPress,this.onCancel=t.onCancel}pointerDown(t){return(t.pointerType??"mouse")==="mouse"?!1:t.isPrimary===!1?(this.cancel("multitouch"),!1):this.activePointerId!=null&&this.activePointerId!==t.pointerId?(this.cancel("multitouch"),!1):(this.activePointerId=t.pointerId,this.startX=t.clientX,this.startY=t.clientY,this.lastEvent=t,this.fired=!1,this.clearTimer(),this.timerId=setTimeout(()=>{this.activePointerId==null||this.fired||this.lastEvent==null||(this.fired=!0,this.clearTimer(),this.onLongPress(this.lastEvent))},this.delayMs),!0)}pointerMove(t){if(!this.matchesPointer(t.pointerId)||this.fired)return;this.lastEvent=t;const n=t.clientX-this.startX,r=t.clientY-this.startY;Math.hypot(n,r)>this.moveTolerancePx&&this.cancel("movement")}pointerUp(t){if(!(t!=null&&!this.matchesPointer(t))){if(!this.fired){this.cancel("pointerup");return}this.reset()}}pointerCancel(t){t!=null&&!this.matchesPointer(t)||this.cancel("pointercancel")}cancelFromScroll(){this.cancel("scroll")}destroy(){this.cancel("cleanup")}matchesPointer(t){return this.activePointerId!=null&&this.activePointerId===t}clearTimer(){this.timerId!=null&&(clearTimeout(this.timerId),this.timerId=null)}reset(){this.clearTimer(),this.activePointerId=null,this.lastEvent=null,this.fired=!1}cancel(t){var r;const n=this.timerId!=null&&!this.fired&&t!=="cleanup";this.reset(),n&&((r=this.onCancel)==null||r.call(this,t))}}function Jb(e){return e==="touch"||e==="pen"}function Zb(e){return e.multiSelectMode||e.isShift||e.isToggle||!Jb(e.pointerType)?!1:e.selectedPaths.length===1&&e.selectedPaths[0]===e.path}function lm(e,t){return e.includes(t)?e.filter(n=>n!==t):[...e,t]}const Kn=12,eC=44,tC={w:4,h:3},nC=350,rC=120;function sC(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function am(e){return{pointerId:e.pointerId,pointerType:e.pointerType,clientX:e.clientX,clientY:e.clientY,isPrimary:e.isPrimary}}function iC(e,t){const n=(t??"").trim();if(!n)return e;const r=e.toLowerCase().indexOf(n.toLowerCase());if(r===-1)return e;const s=e.slice(0,r),i=e.slice(r,r+n.length),o=e.slice(r+n.length);return a.jsxs(a.Fragment,{children:[s,a.jsx("mark",{className:"bg-accent/20 text-inherit rounded px-0.5",children:i}),o]})}function oC(e){if(!e)return null;const t=e.getBoundingClientRect(),n=Array.from(e.querySelectorAll('[role="gridcell"][id^="cell-"]')).map(r=>{const s=r.getBoundingClientRect(),i=r.id.startsWith("cell-")?r.id.slice(5):"";let o="";try{o=i?decodeURIComponent(i):""}catch{o=""}return{path:o,top:s.top,left:s.left,bottom:s.bottom}});return Ub(n,t.top,t.bottom)}function lC({items:e,selected:t,restoreToSelectionToken:n,restoreToTopAnchorToken:r,restoreToTopAnchorPath:s,multiSelectMode:i=!1,onSelectionChange:o,onOpenViewer:l,onContextMenuItem:u,onOpenItemActions:d,highlight:f,recentlyUpdated:p,onVisiblePathsChange:h,onTopAnchorPathChange:w,suppressSelectionHighlight:x=!1,viewMode:S="grid",targetCellSize:C=220,scrollRef:v,hideScrollbar:m=!1}){const[y,g]=c.useState(null),[b,E]=c.useState(null),[M,N]=c.useState(!1),[_,P]=c.useState(null),[B,F]=c.useState(null),Q=c.useRef(null),Z=c.useRef(null),W=c.useRef(null),I=v??W,R=c.useRef(null),T=c.useRef(0),L=c.useRef(0),O=c.useRef(new Set),Y=c.useRef(null),$=c.useRef(null),A=c.useRef(null),V=c.useRef(null),K=c.useRef(null),G=c.useRef({path:null,pointerType:null}),re=C,{width:X,layout:D,rowVirtualizer:he,virtualRows:ie}=Fb(I,e,{gap:Kn,targetCell:re,aspect:tC,captionH:eC,viewMode:S}),me=c.useMemo(()=>{const z=new Map;for(let q=0;q<e.length;q++)z.set(e[q].path,q);return z},[e]),ke=c.useMemo(()=>{if(D.mode!=="adaptive")return null;const z=new Map;return D.rows.forEach((q,te)=>{let ge=0;q.items.forEach((we,Ne)=>{const ae=ge+we.displayW/2;z.set(we.item.path,{row:te,center:ae,order:Ne}),ge+=we.displayW+Kn})}),z},[D]);c.useEffect(()=>{if(!t.length)return;const z=t[0];_!==z&&P(z)},[t,_]);const xe=c.useMemo(()=>{if(D.mode!=="adaptive")return null;let z=0;return D.rows.map(q=>{const te=z;return z+=q.height,{start:te,height:q.height}})},[D]),qe=c.useRef(null),Yt=(z,q)=>{try{if(qe.current!=null){try{cancelAnimationFrame(qe.current)}catch{}qe.current=null}const te=z.scrollTop,ge=q-te;if(Math.abs(ge)<1){z.scrollTop=q;return}const we=140,Ne=performance.now(),ae=Te=>1-Math.pow(1-Te,3),Le=Te=>{const rt=Math.min(1,(Te-Ne)/we),Be=ae(rt);z.scrollTop=te+ge*Be,rt<1?qe.current=requestAnimationFrame(Le):qe.current=null};qe.current=requestAnimationFrame(Le)}catch{z.scrollTop=q}},[dt,In]=c.useState(!1);c.useEffect(()=>{const z=I.current;if(!z)return;let q=0;const te=()=>{var ge;(ge=$.current)==null||ge.cancelFromScroll(),In(!0),window.clearTimeout(q),q=window.setTimeout(()=>In(!1),rC)};return z.addEventListener("scroll",te,{passive:!0}),()=>z.removeEventListener("scroll",te)},[]),c.useEffect(()=>{const z=new Gb({onLongPress:q=>{const te=A.current;if(!te||!d)return;const ge=V.current??{x:q.clientX,y:q.clientY};d(te,ge),K.current={path:te,untilMs:Date.now()+700}}});return $.current=z,()=>{z.destroy(),$.current===z&&($.current=null)}},[d]);const zt=()=>{Z.current!=null&&(window.clearTimeout(Z.current),Z.current=null)},Xt=()=>{if(zt(),N(!1),g(null),Q.current){try{URL.revokeObjectURL(Q.current)}catch{}Q.current=null}E(null)},yn=z=>{dt||(zt(),g(z),N(!1),Z.current=window.setTimeout(async()=>{Z.current=null;try{const q=await pe.getFile(z),te=URL.createObjectURL(q);if(Q.current)try{URL.revokeObjectURL(Q.current)}catch{}Q.current=te,E(te),N(!0)}catch{}},nC))},se=D.mode==="grid"?D.columns:Math.max(1,Math.floor(X/(re+Kn))),oe=(z,q)=>{if(D.mode!=="adaptive")return null;const te=D.rows[z];if(!te)return null;let ge=0,we=null;for(const Ne of te.items){const ae=ge+Ne.displayW/2,Le=Math.abs(ae-q);(!we||Le<we.dist)&&(we={path:Ne.item.path,dist:Le}),ge+=Ne.displayW+Kn}return we?we.path:null},Se=(z,q)=>{var Be,ht,Ue,He;if(!e.length)return null;const te=z??e[0].path;if(D.mode!=="adaptive"){const et=Ob(e,se,te,q);return et==="open"||et==null?et:((Be=e[et])==null?void 0:Be.path)??null}const ge=ke==null?void 0:ke.get(te);if(!ge)return te;const we=me.get(te)??0,Ne=q.key;if(Ne==="Enter")return"open";if(Ne==="ArrowRight"||Ne==="d")return((ht=e[Math.min(e.length-1,we+1)])==null?void 0:ht.path)??te;if(Ne==="ArrowLeft"||Ne==="a")return((Ue=e[Math.max(0,we-1)])==null?void 0:Ue.path)??te;const ae=Ne==="ArrowDown"||Ne==="s"?1:Ne==="ArrowUp"||Ne==="w"?-1:0;if(ae===0)return null;const Le=ge.row+ae;if(Le<0||Le>=(((He=D.rows)==null?void 0:He.length)??0))return te;const Te=ge.center;return oe(Le,Te)??te},be=z=>{var q;try{(q=document.getElementById(`cell-${encodeURIComponent(z)}`))==null||q.focus()}catch{}},fe=c.useCallback(z=>{try{pe.prefetchThumb(z)}catch{}},[]),ue=c.useCallback((z,q)=>{d==null||d(z,q)},[d]),$e=()=>{A.current=null,V.current=null},it=(z,q)=>{var te;q.target.closest("[data-grid-action]")||(G.current={path:z,pointerType:q.pointerType},!i&&(A.current=z,V.current={x:q.clientX,y:q.clientY},(te=$.current)==null||te.pointerDown(am(q))))},bt=z=>{var q;i||(V.current={x:z.clientX,y:z.clientY},(q=$.current)==null||q.pointerMove(am(z)))},ft=z=>{var q;i||((q=$.current)==null||q.pointerUp(z.pointerId),$e())},on=z=>{var q;i||((q=$.current)==null||q.pointerCancel(z.pointerId),$e())},ln=(z,q)=>{const te=K.current;if(te&&te.path===z&&te.untilMs>Date.now()){K.current=null,be(z);return}te&&te.untilMs<=Date.now()&&(K.current=null),P(z),F(z);const ge=!!q.shiftKey,we=!!(q.ctrlKey||q.metaKey);if(i)o(lm(t,z)),R.current=z;else if(Zb({pointerType:G.current.path===z?G.current.pointerType:null,multiSelectMode:i,isShift:ge,isToggle:we,selectedPaths:t,path:z}))o([z]),R.current=z,l(z);else if(ge){const Ne=R.current??_??t[0]??z,ae=me.get(Ne)??e.findIndex(Te=>Te.path===Ne),Le=me.get(z)??e.findIndex(Te=>Te.path===z);if(ae!==-1&&Le!==-1){const Te=Math.min(ae,Le),rt=Math.max(ae,Le),Be=e.slice(Te,rt+1).map(ht=>ht.path);if(we){const ht=new Set(t);for(const Ue of Be)ht.add(Ue);o(Array.from(ht))}else o(Be)}else o([z])}else we?(o(lm(t,z)),R.current=z):(o([z]),R.current=z);dt||fe(z),be(z)},qt=(z,q)=>{var te,ge;try{const we=We.has(z)&&t.length>0?t:[z];(te=q.dataTransfer)==null||te.setData("application/x-lenslet-paths",JSON.stringify(we)),q.dataTransfer&&(q.dataTransfer.effectAllowed="copyMove");try{document.body.classList.add("drag-active")}catch{}const ae=q.currentTarget.querySelector(".cell-content img"),Le=document.createElement("div");Le.className="drag-ghost";const Te=document.createElement("img");Te.draggable=!1,Te.alt="drag",ae&&ae.src&&(Te.src=ae.src),Le.appendChild(Te),document.body.appendChild(Le);const rt=Le.getBoundingClientRect().width||150;(ge=q.dataTransfer)==null||ge.setDragImage(Le,Math.round(rt/2),0);const Be=()=>{try{Le.remove()}catch{}try{document.body.classList.remove("drag-active")}catch{}window.removeEventListener("dragend",Be),window.removeEventListener("pointerup",Be),document.removeEventListener("visibilitychange",Be)};window.addEventListener("dragend",Be),window.addEventListener("pointerup",Be),document.addEventListener("visibilitychange",Be)}catch{}};c.useEffect(()=>{const z=I.current;if(!z)return;const q=te=>{var Be,ht,Ue;const ge=Se(B,te);if(ge==null)return;if(te.preventDefault(),ge==="open"){B&&l(B);return}const we=e.find(He=>He.path===ge);if(!we)return;F(we.path),P(we.path),o([we.path]),R.current=we.path;const Ne=D.mode==="grid"?Math.floor((me.get(we.path)??0)/Math.max(1,D.columns)):((Be=ke==null?void 0:ke.get(we.path))==null?void 0:Be.row)??0,ae=z.scrollTop,Le=ae+z.clientHeight,Te=D.mode==="adaptive"?((ht=xe==null?void 0:xe[Ne])==null?void 0:ht.start)??0:Ne*D.rowH,rt=D.mode==="adaptive"?Te+(((Ue=xe==null?void 0:xe[Ne])==null?void 0:Ue.height)??0):Te+D.rowH;(Te<ae||rt>Le)&&Yt(z,Te),be(we.path)};return z.addEventListener("keydown",q),()=>{z.removeEventListener("keydown",q)}},[e,B,se,l,D,ke,xe,me]),c.useLayoutEffect(()=>{const z=I.current;if(!z)return;const q=Wb({selectionToken:n,appliedSelectionToken:T.current,selectedPath:t[0]??null,topAnchorToken:r,appliedTopAnchorToken:L.current,topAnchorPath:s??null,hasPath:ge=>me.has(ge)});if(!q)return;const te=Hb({path:q.path,pathToIndex:me,layout:D,adaptiveRowMeta:xe});if(te!=null){try{z.scrollTop=te}catch{}if(q.source==="selection"){T.current=q.token;return}L.current=q.token}},[n,r,s,t,me,D,xe]);const We=c.useMemo(()=>new Set(t),[t]),je=!!(y&&b&&M),Ct=c.useMemo(()=>Db(ie,D,e),[e,D,ie]);c.useEffect(()=>{if(!(dt||Ct.length===0))for(const z of Ct)fe(z)},[dt,Ct,fe]),c.useEffect(()=>{var z;(z=I.current)==null||z.focus()},[]),c.useEffect(()=>{var z;if(x){try{(z=I.current)==null||z.blur()}catch{}F(null)}},[x]);const _n=c.useMemo(()=>$b(e,D,ie),[e,D,ie]),Wn=c.useMemo(()=>{var q;const z=oC(I.current);return z||Bb(e,D,ie,((q=I.current)==null?void 0:q.scrollTop)??0)},[e,D,ie,I]);c.useEffect(()=>{h&&(sC(O.current,_n)||(O.current=_n,h(_n)))},[h,_n]),c.useEffect(()=>{w&&Y.current!==Wn&&(Y.current=Wn,w(Wn))},[w,Wn]);const Ri=B?`cell-${encodeURIComponent(B)}`:void 0;return a.jsx("div",{role:"grid","aria-label":"Gallery",className:`relative h-full overflow-auto p-3 outline-none ${m?"scrollbar-hidden pr-4":"scrollbar-thin"} ${je?"cursor-zoom-in":""}`,ref:I,tabIndex:0,"aria-activedescendant":Ri,onMouseDown:()=>{var z;return(z=I.current)==null?void 0:z.focus()},style:{"--gap":`${Kn}px`},children:a.jsxs("div",{className:"relative w-full",style:{height:he.getTotalSize()},children:[ie.map(z=>{var Ne;let q=[],te={},ge="";if(D.mode==="adaptive"){const ae=D.rows[z.index];if(!ae)return null;q=ae.items,te={height:ae.height,transform:`translate3d(0, ${z.start}px, 0)`,display:"flex",gap:Kn,paddingBottom:Kn},ge="absolute top-0 left-0 right-0 w-full will-change-transform"}else{const ae=z.index*D.columns;q=e.slice(ae,ae+D.columns).map(Te=>({item:Te,displayW:D.cellW,displayH:D.mediaH})),te={transform:`translate3d(0, ${z.start}px, 0)`,gridTemplateColumns:`repeat(${D.columns}, minmax(0, 1fr))`,gap:Kn,paddingBottom:Kn},ge="absolute top-0 left-0 right-0 w-full grid will-change-transform"}const we=z.index===((Ne=ie[0])==null?void 0:Ne.index);return a.jsx("div",{className:ge,role:"row",style:te,children:q.map(({item:ae,displayW:Le,displayH:Te})=>{const rt=!x&&(_===ae.path||We.has(ae.path)),Be=(p==null?void 0:p.get(ae.path))??null,ht=Be!=null,Ue=D.mode==="adaptive"?{width:Le}:{},He=D.mode==="adaptive"?{height:Te}:{},et=D.mode==="adaptive"?"relative rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group shrink-0":"relative aspect-[4/3] rounded-lg overflow-hidden bg-[var(--thumb-bg,#121212)] group";return a.jsxs("div",{id:`cell-${encodeURIComponent(ae.path)}`,className:`relative min-w-0 ${rt?"outline outline-2 outline-accent outline-offset-2 rounded-[10px]":""}`,role:"gridcell","aria-selected":rt,tabIndex:B===ae.path?0:-1,onFocus:()=>F(ae.path),draggable:!0,style:Ue,onDragStart:Ie=>qt(ae.path,Ie),onPointerDown:Ie=>it(ae.path,Ie),onPointerMove:bt,onPointerUp:ft,onPointerCancel:on,onContextMenu:Ie=>{Ie.preventDefault(),Ie.stopPropagation(),u==null||u(Ie,ae.path)},children:[a.jsxs("div",{className:et,style:He,onDoubleClick:()=>{i||l(ae.path)},onMouseLeave:Xt,children:[a.jsx("button",{type:"button",className:"grid-item-action-btn touch-manipulation","data-grid-action":"1","aria-label":`Open actions for ${ae.name}`,"aria-haspopup":"menu",onPointerDown:Ie=>Ie.stopPropagation(),onClick:Ie=>{Ie.stopPropagation();const qr=Ie.currentTarget.getBoundingClientRect();ue(ae.path,{x:qr.right-4,y:qr.bottom-4})},children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})}),a.jsx("div",{className:"cell-content absolute inset-0",children:a.jsx(yb,{path:ae.path,name:ae.name,selected:rt,highlighted:ht,highlightKey:Be,displayW:Le,displayH:Te,ioRoot:I.current,isScrolling:dt,priority:we,onClick:Ie=>ln(ae.path,Ie)})}),a.jsx("div",{className:"absolute right-0 bottom-0 w-7 h-7 cursor-zoom-in",onMouseEnter:()=>yn(ae.path),onMouseLeave:Xt,children:a.jsx("div",{className:"grid-item-preview-corner absolute right-0 bottom-0 h-[18px] w-[18px] flex items-center justify-center text-text select-none",style:{clipPath:'path("M0 9C0 4.02944 4.02944 0 9 0H18V18H0V9Z")',background:"linear-gradient(135deg, rgba(18,18,18,0.9) 0%, rgba(34,34,34,0.9) 60%, rgba(22,22,22,0.9) 100%)",borderTop:"1px solid rgba(255,255,255,0.08)",borderLeft:"1px solid rgba(255,255,255,0.08)",boxShadow:"0 1px 2px rgba(0,0,0,0.45)",backdropFilter:"blur(1px)"},children:a.jsxs("svg",{width:"11",height:"11",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.7",strokeLinecap:"round",strokeLinejoin:"round",className:"text-[#d9dce2]","aria-hidden":"true",style:{transform:"translate(0px,0px)"},children:[a.jsx("circle",{cx:"11",cy:"11",r:"5.4"}),a.jsx("path",{d:"M15.5 15.5 L19 19"})]})})})]}),a.jsxs("div",{className:"flex flex-col items-center text-center gap-0 mt-1 px-0.5 text-white/90",children:[a.jsx("div",{className:"text-sm leading-[18px] thumb-filename line-clamp-2 break-words hyphens-auto text-center",title:ae.name,children:iC(ae.name,f)}),a.jsxs("div",{className:"text-[11px] leading-[15px] opacity-70",children:[ae.w,"  ",ae.h]})]})]},ae.path)})},z.key)}),y&&b&&M&&Ja.createPortal(a.jsx("div",{className:"toolbar-offset fixed inset-0 z-[999] flex items-center justify-center pointer-events-none bg-black/20 opacity-100",children:a.jsx("img",{src:b,alt:"preview",className:"max-w-[80vw] max-h-[80vh] object-contain opacity-[0.98]"})}),document.body)]},`${S}-${se}`)})}const aC=48,uC=[.1,.24,.5,.74,.9];function cC({items:e,metricKey:t,scrollRef:n,sortDir:r}){const{orderedValues:s,numericValues:i}=c.useMemo(()=>{var P;const N=[],_=[];for(const B of e){const F=(P=B.metrics)==null?void 0:P[t],Q=F==null||Number.isNaN(F)?null:F;N.push(Q),Q!=null&&_.push(Q)}return{orderedValues:N,numericValues:_}},[e,t]),o=c.useMemo(()=>dC(i,aC),[i]),l=c.useMemo(()=>fC(i,uC),[i]),[u,d]=c.useState(0),[f,p]=c.useState(null),[h,w]=c.useState(!1),x=c.useRef(null);if(c.useEffect(()=>{const N=n.current;if(!N)return;const _=()=>{const P=Math.max(1,N.scrollHeight-N.clientHeight),B=os(P>0?N.scrollTop/P:0);d(B)};return _(),N.addEventListener("scroll",_,{passive:!0}),window.addEventListener("resize",_),()=>{N.removeEventListener("scroll",_),window.removeEventListener("resize",_)}},[n,e.length]),c.useEffect(()=>{p(null)},[t,e.length]),!o)return null;const S={min:o.min,max:o.max},C=f!=null?cm(f):null,v=cm(u),m=r==="desc",y=c.useMemo(()=>f==null?null:mC(s,f),[s,f]);function g(N){p(os(N))}function b(){p(null)}function E(N){const _=n.current;if(!_)return;const P=Math.max(0,_.scrollHeight-_.clientHeight);_.scrollTop=os(N)*P}function M(N){var P;const _=(P=x.current)==null?void 0:P.getBoundingClientRect();return _?os((N.clientY-_.top)/_.height):null}return a.jsxs("div",{className:"absolute right-0 top-3 bottom-3 w-[14px] flex items-stretch pointer-events-auto",children:[a.jsxs("svg",{ref:x,viewBox:"0 0 10 100",preserveAspectRatio:"none",className:"w-full h-full rounded bg-surface-inset border border-border/60 cursor-ns-resize",onPointerDown:N=>{var P;N.preventDefault();const _=M(N);_!=null&&(w(!0),g(_),E(_),(P=x.current)==null||P.setPointerCapture(N.pointerId))},onPointerMove:N=>{const _=M(N);if(_==null){h||b();return}g(_),h&&E(_)},onPointerUp:N=>{var _;w(!1),(_=x.current)==null||_.releasePointerCapture(N.pointerId)},onPointerLeave:()=>{h||b()},children:[hC(o.bins,"var(--border-strong)",{flip:m}),pC(l,S,{flip:m,color:"var(--muted)"}),um(v,{color:"var(--highlight)",strokeWidth:.8}),C!=null&&um(C,{color:"var(--text-secondary)",strokeWidth:.6,dashed:!0})]}),y!=null&&f!=null&&a.jsx("div",{className:"pointer-events-none absolute right-full mr-2 px-1.5 py-0.5 rounded border border-border bg-surface text-[10px] text-text shadow",style:{top:`calc(${(f*100).toFixed(2)}% - 8px)`},children:vC(y)})]})}function dC(e,t){if(!e.length)return null;const n=Math.min(...e);let r=Math.max(...e);n===r&&(r=n+1);const s=new Array(t).fill(0),i=t/(r-n);for(const o of e){const l=Math.max(0,Math.min(t-1,Math.floor((o-n)*i)));s[l]+=1}return{bins:s,min:n,max:r}}function fC(e,t){if(!e.length)return[];const n=[...e].sort((s,i)=>s-i),r=n.length-1;return t.map(s=>{const i=r*s,o=Math.floor(i),l=Math.ceil(i);if(o===l)return n[o];const u=i-o;return n[o]+(n[l]-n[o])*u})}function hC(e,t,n){const r=Math.max(1,...e),s=100/e.length,i=(n==null?void 0:n.flip)??!1;return e.map((o,l)=>{const u=Math.max(.8,o/r*10),d=(i?e.length-1-l:l)*s;return a.jsx("rect",{x:10-u,y:d,width:u,height:Math.max(.2,s-.2),fill:t,opacity:.9},`sb-${l}`)})}function pC(e,t,n){const r=(n==null?void 0:n.flip)??!1,s=n==null?void 0:n.color;return e.map((i,o)=>{const l=gC(i,t,r),u=o===2;return a.jsx("line",{x1:0,y1:l,x2:10,y2:l,stroke:s,strokeWidth:u?.8:.5,opacity:u?.9:.6,vectorEffect:"non-scaling-stroke"},`qt-${o}-${i}`)})}function um(e,t){return a.jsx("line",{x1:0,y1:e,x2:10,y2:e,stroke:t.color,strokeWidth:t.strokeWidth??.6,strokeDasharray:t.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}function mC(e,t){if(!e.length)return null;const n=Math.round(os(t)*(e.length-1)),r=e[n];if(r!=null)return r;for(let s=1;s<e.length;s++){const i=n-s;if(i>=0&&e[i]!=null)return e[i];const o=n+s;if(o<e.length&&e[o]!=null)return e[o]}return null}function gC(e,t,n){const r=t.max-t.min;if(r===0)return 0;const s=os((e-t.min)/r);return(n?1-s:s)*100}function cm(e){return os(e)*100}function os(e){return e<0?0:e>1?1:e}function vC(e){if(e==null||Number.isNaN(e))return"-";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function ls(e,t){const[n,r]=c.useState(null),s=c.useRef(null);return c.useEffect(()=>{if(!e){if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}r(null);return}let i=!0;return e().then(o=>{if(!i)return;const l=URL.createObjectURL(o);if(s.current)try{URL.revokeObjectURL(s.current)}catch{}s.current=l,r(l)}).catch(()=>{}),()=>{i=!1}},t),c.useEffect(()=>()=>{if(s.current){try{URL.revokeObjectURL(s.current)}catch{}s.current=null}},[]),n}const yC=1.2,xC=.05,wC=8;function oc(e){return Number(Math.min(wC,Math.max(xC,e)).toFixed(4))}function dm(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function fm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function SC(e,t){try{e.setPointerCapture(t)}catch{}}function bC(e,t){try{e.releasePointerCapture(t)}catch{}}function CC(){const[e,t]=c.useState(1),[n,r]=c.useState(0),[s,i]=c.useState(0),[o,l]=c.useState(1),[u,d]=c.useState(!1),[f,p]=c.useState(!1),[h,w]=c.useState(!1),x=c.useRef(null),S=c.useRef(null),C=c.useRef(1),v=c.useRef(0),m=c.useRef(0),y=c.useRef(new Map),g=c.useRef(null),b=c.useRef(null),E=(R,T)=>{v.current=R,m.current=T,r(R),i(T)},M=R=>{const T=oc(R);C.current=T,t(T)},N=(R,T)=>{g.current={pointerId:R,startX:T.x,startY:T.y,startTx:v.current,startTy:m.current},b.current=null,p(!0)},_=()=>{const R=Array.from(y.current.entries());if(R.length<2)return;const[T,L]=R,[O,Y]=T,[$,A]=L,V=dm(Y,A);!Number.isFinite(V)||V<=2||(b.current={pointerIds:[O,$],startDistance:V,startCenter:fm(Y,A),startScale:C.current,startTx:v.current,startTy:m.current},g.current=null,p(!0))},P=()=>{const R=x.current,T=S.current;if(!R||!T||!T.naturalWidth||!T.naturalHeight)return;const L=R.getBoundingClientRect(),O=L.width/T.naturalWidth,Y=L.height/T.naturalHeight,$=Math.min(1,Math.min(O,Y));l($);const A=T.naturalWidth*$,V=T.naturalHeight*$;E((L.width-A)/2,(L.height-V)/2),M(1)};c.useEffect(()=>{const R=x.current;if(!R)return;const T=new ResizeObserver(()=>{try{requestAnimationFrame(()=>P())}catch{P()}});return T.observe(R),()=>T.disconnect()},[]),c.useEffect(()=>{C.current=e,v.current=n,m.current=s},[e,n,s]),c.useEffect(()=>()=>{y.current.clear(),g.current=null,b.current=null},[]);const B=R=>{R.preventDefault();const T=R.deltaY>0?-1:1,L=x.current;if(!L)return;const O=L.getBoundingClientRect(),Y=R.clientX-O.left,$=R.clientY-O.top,A=C.current,V=oc(A*Math.pow(yC,T));if(V===A)return;const K=V/A,G=Y-K*(Y-v.current),re=$-K*($-m.current);M(V),E(G,re)},F=R=>{if((R.pointerType??"mouse")==="mouse"&&R.button!==0)return;const L=y.current,O=S.current;if(!O||L.size===0&&R.target!==O)return;const Y=R.currentTarget,$=Y.getBoundingClientRect();if(!(R.clientX<$.left||R.clientX>$.right||R.clientY<$.top||R.clientY>$.bottom)){if(R.preventDefault(),R.stopPropagation(),L.set(R.pointerId,{x:R.clientX,y:R.clientY}),SC(Y,R.pointerId),L.size>=2){_();return}N(R.pointerId,{x:R.clientX,y:R.clientY})}},Q=R=>{const T=y.current;if(!T.has(R.pointerId))return;T.set(R.pointerId,{x:R.clientX,y:R.clientY});const L=b.current;if(L){const A=T.get(L.pointerIds[0]),V=T.get(L.pointerIds[1]);if(A&&V){const K=dm(A,V);if(K>2){const G=fm(A,V),re=oc(L.startScale*(K/L.startDistance)),X=re/L.startScale,D=G.x-X*(L.startCenter.x-L.startTx),he=G.y-X*(L.startCenter.y-L.startTy);M(re),E(D,he)}}return}const O=g.current;if(!O||O.pointerId!==R.pointerId)return;const Y=R.clientX-O.startX,$=R.clientY-O.startY;E(O.startTx+Y,O.startTy+$)},Z=(R,T)=>{const L=y.current;if(!L.has(R))return;if(L.delete(R),bC(T,R),L.size===0){g.current=null,b.current=null,p(!1);return}if(L.size>=2){_();return}const[O,Y]=L.entries().next().value;N(O,Y)};return{scale:e,setScale:t,tx:n,setTx:r,ty:s,setTy:i,base:o,setBase:l,ready:u,setReady:d,dragging:f,setDragging:p,visible:h,setVisible:w,containerRef:x,imgRef:S,fitAndCenter:P,handleWheel:B,handlePointerDown:F,handlePointerMove:Q,handlePointerUp:R=>{Z(R.pointerId,R.currentTarget)},handlePointerCancel:R=>{Z(R.pointerId,R.currentTarget)}}}function kC({path:e,onClose:t,onNavigate:n,canPrev:r=!1,canNext:s=!1,onZoomChange:i,requestedZoomPercent:o,onZoomRequestConsumed:l}){const{scale:u,setScale:d,tx:f,setTx:p,ty:h,setTy:w,base:x,ready:S,setReady:C,dragging:v,visible:m,setVisible:y,containerRef:g,imgRef:b,fitAndCenter:E,handleWheel:M,handlePointerDown:N,handlePointerMove:_,handlePointerUp:P,handlePointerCancel:B}=CC(),F=ls(()=>pe.getFile(e),[e]),Q=ls(()=>pe.getThumb(e),[e]),Z=c.useCallback(()=>{y(!1),window.setTimeout(t,110)},[t,y]);return c.useEffect(()=>{requestAnimationFrame(()=>{var W;y(!0),(W=g.current)==null||W.focus()})},[e]),c.useEffect(()=>{const W=I=>{I.key==="Escape"?Z():(I.key==="ArrowRight"||I.key==="d")&&n?n(1):(I.key==="ArrowLeft"||I.key==="a")&&n&&n(-1)};return window.addEventListener("keydown",W),()=>window.removeEventListener("keydown",W)},[Z,n]),c.useEffect(()=>{C(!1)},[F]),c.useEffect(()=>{i&&i(x*u*100)},[x,u,i]),c.useEffect(()=>{if(o==null)return;const W=g.current;if(!W){l&&l();return}const I=Math.max(.05,Math.min(8,o/100/Math.max(1e-6,x))),R=W.getBoundingClientRect(),T=R.width/2,L=R.height/2;d(O=>{const Y=I/O;return p($=>T-Y*(T-$)),w($=>L-Y*(L-$)),Number(I.toFixed(4))}),l&&l()},[o,x,l]),a.jsxs("div",{ref:g,role:"dialog","aria-modal":!0,"aria-label":"Image viewer",tabIndex:-1,className:`toolbar-offset touch-none absolute inset-0 left-[var(--left)] right-[var(--right)] flex items-start justify-start bg-panel z-viewer overflow-hidden transition-opacity duration-[110ms] ease-out cursor-grab focus:outline-none focus-visible:outline-none ${v?"cursor-grabbing select-none":""} ${m?"opacity-100":"opacity-0"}`,style:{outline:"none"},onClick:Z,onWheel:M,onPointerDown:N,onPointerMove:_,onPointerUp:P,onPointerCancel:B,onKeyDown:W=>{W.key==="Tab"&&W.preventDefault()},children:[a.jsxs("button",{"aria-label":"Close",onClick:W=>{W.stopPropagation(),Z()},className:"btn btn-sm absolute top-3 right-3 z-10",title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]}),Q&&a.jsx("img",{src:Q,alt:"thumb",className:"absolute top-0 left-0 max-w-none max-h-none object-contain pointer-events-none transition-opacity duration-[110ms] ease-out",draggable:!1,onDragStart:W=>W.preventDefault(),style:{transform:`translate(${f}px, ${h}px) scale(${x})`,transformOrigin:"0 0",opacity:S?0:.5,filter:"blur(0.25px)"}}),F&&a.jsx("img",{ref:b,src:F,alt:"viewer",className:"max-w-none max-h-none object-contain transition-opacity duration-[110ms] ease-out will-change-transform select-none",draggable:!1,onDragStart:W=>{W.preventDefault()},onLoad:W=>{E(),d(1);try{requestAnimationFrame(()=>C(!0))}catch{C(!0)}},onClick:W=>W.stopPropagation(),style:{transform:`translate(${f}px, ${h}px) scale(${x*u})`,transformOrigin:"0 0",opacity:S?.99:0,WebkitUserDrag:"none"}}),n&&a.jsxs("div",{className:"viewer-mobile-nav",onClick:W=>W.stopPropagation(),children:[a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${r?"":"is-disabled"}`,onClick:()=>r&&n(-1),"aria-label":"Previous image","aria-disabled":!r,disabled:!r,children:"Prev"}),a.jsx("button",{type:"button",className:`viewer-mobile-nav-btn ${s?"":"is-disabled"}`,onClick:()=>s&&n(1),"aria-label":"Next image","aria-disabled":!s,disabled:!s,children:"Next"})]})]})}function qf(e){return!e||!(e instanceof HTMLElement)?!1:e.closest('input, textarea, [contenteditable="true"]')!==null}const EC=1.2,NC=.05,jC=8;function lc(e){return Number(Math.min(jC,Math.max(NC,e)).toFixed(4))}function hm(e,t){return Math.hypot(e.x-t.x,e.y-t.y)}function pm(e,t){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}function MC(e,t){try{e.setPointerCapture(t)}catch{}}function PC(e,t){try{e.releasePointerCapture(t)}catch{}}function RC(){const[e,t]=c.useState(1),[n,r]=c.useState(0),[s,i]=c.useState(0),[o,l]=c.useState(0),[u,d]=c.useState(0),[f,p]=c.useState(1),[h,w]=c.useState(1),[x,S]=c.useState(!1),C=c.useRef(null),v=c.useRef(null),m=c.useRef(null),y=c.useRef(1),g=c.useRef(0),b=c.useRef(0),E=c.useRef(0),M=c.useRef(0),N=c.useRef(new Map),_=c.useRef(null),P=c.useRef(null),B=c.useCallback(A=>{g.current=A.txA,b.current=A.tyA,E.current=A.txB,M.current=A.tyB,r(A.txA),i(A.tyA),l(A.txB),d(A.tyB)},[]),F=c.useCallback(A=>{const V=lc(A);y.current=V,t(V)},[]),Q=c.useCallback((A,V)=>{_.current={pointerId:A,startX:V.x,startY:V.y,startTxA:g.current,startTyA:b.current,startTxB:E.current,startTyB:M.current},P.current=null,S(!0)},[]),Z=c.useCallback(()=>{const A=Array.from(N.current.entries());if(A.length<2)return;const[V,K]=A,[G,re]=V,[X,D]=K,he=hm(re,D);!Number.isFinite(he)||he<=2||(P.current={pointerIds:[G,X],startDistance:he,startCenter:pm(re,D),startScale:y.current,startTxA:g.current,startTyA:b.current,startTxB:E.current,startTyB:M.current},_.current=null,S(!0))},[]),W=c.useCallback((A,V)=>{const K=N.current;if(!K.has(A))return;if(K.delete(A),PC(V,A),K.size===0){_.current=null,P.current=null,S(!1);return}if(K.size>=2){Z();return}const[G,re]=K.entries().next().value;Q(G,re)},[Q,Z]),I=c.useCallback(()=>{const A=C.current;if(!A)return;const V=A.getBoundingClientRect(),K=X=>{if(!X||!X.naturalWidth||!X.naturalHeight)return;const D=V.width/X.naturalWidth,he=V.height/X.naturalHeight,ie=Math.min(1,Math.min(D,he)),me=X.naturalWidth*ie,ke=X.naturalHeight*ie;return{base:ie,tx:(V.width-me)/2,ty:(V.height-ke)/2}},G=K(v.current);G&&(p(G.base),g.current=G.tx,b.current=G.ty,r(G.tx),i(G.ty));const re=K(m.current);re&&(w(re.base),E.current=re.tx,M.current=re.ty,l(re.tx),d(re.ty))},[]);c.useEffect(()=>{const A=C.current;if(!A)return;const V=new ResizeObserver(()=>{try{requestAnimationFrame(()=>I())}catch{I()}});return V.observe(A),()=>V.disconnect()},[I]);const R=c.useCallback(()=>{F(1),I()},[I,F]);c.useEffect(()=>{y.current=e,g.current=n,b.current=s,E.current=o,M.current=u},[e,n,s,o,u]),c.useEffect(()=>()=>{N.current.clear(),_.current=null,P.current=null},[]);const T=c.useCallback(A=>{A.preventDefault();const V=A.deltaY>0?-1:1,K=C.current;if(!K)return;const G=K.getBoundingClientRect(),re=A.clientX-G.left,X=A.clientY-G.top,D=y.current,he=lc(D*Math.pow(EC,V));if(he===D)return;const ie=he/D;F(he),B({txA:re-ie*(re-g.current),tyA:X-ie*(X-b.current),txB:re-ie*(re-E.current),tyB:X-ie*(X-M.current)})},[B,F]),L=c.useCallback(A=>{if((A.pointerType??"mouse")==="mouse"&&A.button!==0)return;const K=A.currentTarget;if(A.preventDefault(),N.current.set(A.pointerId,{x:A.clientX,y:A.clientY}),MC(K,A.pointerId),N.current.size>=2){Z();return}Q(A.pointerId,{x:A.clientX,y:A.clientY})},[Q,Z]),O=c.useCallback(A=>{const V=N.current;if(!V.has(A.pointerId))return;V.set(A.pointerId,{x:A.clientX,y:A.clientY});const K=P.current;if(K){const D=V.get(K.pointerIds[0]),he=V.get(K.pointerIds[1]);if(D&&he){const ie=hm(D,he);if(ie>2){const me=pm(D,he),ke=lc(K.startScale*(ie/K.startDistance)),xe=ke/K.startScale;F(ke),B({txA:me.x-xe*(K.startCenter.x-K.startTxA),tyA:me.y-xe*(K.startCenter.y-K.startTyA),txB:me.x-xe*(K.startCenter.x-K.startTxB),tyB:me.y-xe*(K.startCenter.y-K.startTyB)})}}return}const G=_.current;if(!G||G.pointerId!==A.pointerId)return;const re=A.clientX-G.startX,X=A.clientY-G.startY;B({txA:G.startTxA+re,tyA:G.startTyA+X,txB:G.startTxB+re,tyB:G.startTyB+X})},[B,F]),Y=c.useCallback(A=>{W(A.pointerId,A.currentTarget)},[W]),$=c.useCallback(A=>{W(A.pointerId,A.currentTarget)},[W]);return{scale:e,baseA:f,baseB:h,txA:n,tyA:s,txB:o,tyB:u,dragging:x,containerRef:C,imgARef:v,imgBRef:m,fitAndCenter:I,resetView:R,handleWheel:T,handlePointerDown:L,handlePointerMove:O,handlePointerUp:Y,handlePointerCancel:$}}function TC({aItem:e,bItem:t,index:n,total:r,canPrev:s,canNext:i,onNavigate:o,onClose:l}){const u=c.useRef(null),[d,f]=c.useState(50),[p,h]=c.useState(!1),[w,x]=c.useState(!1),{scale:S,baseA:C,baseB:v,txA:m,tyA:y,txB:g,tyB:b,dragging:E,containerRef:M,imgARef:N,imgBRef:_,fitAndCenter:P,resetView:B,handleWheel:F,handlePointerDown:Q,handlePointerMove:Z,handlePointerUp:W,handlePointerCancel:I}=RC(),R=(e==null?void 0:e.path)??null,T=(t==null?void 0:t.path)??null,L=(e==null?void 0:e.name)??R??"Select an image",O=(t==null?void 0:t.name)??T??"Select another image";c.useEffect(()=>{requestAnimationFrame(()=>{var X;return(X=u.current)==null?void 0:X.focus()})},[R,T]),c.useEffect(()=>{B(),h(!1),x(!1)},[R,T,B]),c.useEffect(()=>{const X=D=>{if(!qf(D.target)){if(D.key==="Escape"){D.preventDefault(),l();return}if((D.key==="ArrowRight"||D.key==="d")&&i){D.preventDefault(),o(1);return}(D.key==="ArrowLeft"||D.key==="a")&&s&&(D.preventDefault(),o(-1))}};return window.addEventListener("keydown",X),()=>window.removeEventListener("keydown",X)},[l,o,s,i]);const Y=ls(R?()=>pe.getFile(R):null,[R]),$=ls(T?()=>pe.getFile(T):null,[T]),A=ls(R?()=>pe.getThumb(R):null,[R]),V=ls(T?()=>pe.getThumb(T):null,[T]),K=c.useCallback(X=>Math.min(95,Math.max(5,X)),[]),G=c.useCallback(X=>{const D=X.target;D!=null&&D.closest(".compare-label")||D!=null&&D.closest(".compare-divider-hit")||Q(X)},[Q]),re=c.useCallback(X=>{const D=M.current;if(!D)return;X.preventDefault(),X.stopPropagation();const he=D.getBoundingClientRect(),ie=X.currentTarget;ie.setPointerCapture(X.pointerId);const me=xe=>{const qe=(xe.clientX-he.left)/he.width*100;f(K(qe))},ke=xe=>{try{ie.releasePointerCapture(xe.pointerId)}catch{}window.removeEventListener("pointermove",me),window.removeEventListener("pointerup",ke),window.removeEventListener("pointercancel",ke)};window.addEventListener("pointermove",me),window.addEventListener("pointerup",ke),window.addEventListener("pointercancel",ke)},[K]);return a.jsxs("div",{ref:u,role:"dialog","aria-modal":!0,"aria-label":"Compare images",tabIndex:-1,className:"toolbar-offset absolute inset-0 left-[var(--left)] right-[var(--right)] bg-panel z-viewer flex flex-col overflow-hidden focus:outline-none",onKeyDown:X=>{X.key==="Tab"&&X.preventDefault()},children:[a.jsxs("div",{className:"compare-header flex items-center gap-3 px-3 py-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Compare"}),a.jsx("div",{className:"text-xs text-muted",children:r>=2?`${n+1}-${Math.min(n+2,r)} of ${r}`:"Select 2 images"}),a.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(-1),disabled:!s,title:"Previous (Left Arrow or A)",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M15 18l-6-6 6-6"})}),"Prev"]}),a.jsxs("button",{className:"btn btn-sm",onClick:()=>o(1),disabled:!i,title:"Next (Right Arrow or D)",children:["Next",a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M9 18l6-6-6-6"})})]}),a.jsxs("button",{className:"btn btn-sm",onClick:l,title:"Close (Esc)",children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M18 6 6 18"}),a.jsx("path",{d:"M6 6l12 12"})]}),"Close"]})]})]}),a.jsx("div",{className:"flex-1 min-h-0 p-3 bg-panel",children:a.jsx("div",{ref:M,className:`compare-stage ${E?"is-dragging":""}`,onWheel:F,onPointerDown:G,onPointerMove:Z,onPointerUp:W,onPointerCancel:I,children:!e||!t?a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-sm text-muted",children:"Select 2 images to compare."}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"compare-label left-3",children:[a.jsx("span",{className:"compare-label-tag",children:"A"}),a.jsx("span",{className:"truncate",title:e.path,children:L})]}),a.jsxs("div",{className:"compare-label right-3",children:[a.jsx("span",{className:"compare-label-tag",children:"B"}),a.jsx("span",{className:"truncate",title:t.path,children:O})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 ${100-d}% 0 0)`},children:[A&&a.jsx("img",{src:A,alt:"thumb A",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:X=>X.preventDefault(),style:{transform:`translate(${m}px, ${y}px) scale(${C})`,transformOrigin:"0 0",opacity:p?0:.5}}),Y&&a.jsx("img",{ref:N,src:Y,alt:"compare A",className:"compare-image",draggable:!1,onDragStart:X=>X.preventDefault(),onLoad:()=>{P();try{requestAnimationFrame(()=>h(!0))}catch{h(!0)}},style:{transform:`translate(${m}px, ${y}px) scale(${C*S})`,transformOrigin:"0 0",opacity:p?.99:0}})]}),a.jsxs("div",{className:"compare-layer",style:{clipPath:`inset(0 0 0 ${d}%)`},children:[V&&a.jsx("img",{src:V,alt:"thumb B",className:"compare-image compare-image-thumb",draggable:!1,onDragStart:X=>X.preventDefault(),style:{transform:`translate(${g}px, ${b}px) scale(${v})`,transformOrigin:"0 0",opacity:w?0:.5}}),$&&a.jsx("img",{ref:_,src:$,alt:"compare B",className:"compare-image",draggable:!1,onDragStart:X=>X.preventDefault(),onLoad:()=>{P();try{requestAnimationFrame(()=>x(!0))}catch{x(!0)}},style:{transform:`translate(${g}px, ${b}px) scale(${v*S})`,transformOrigin:"0 0",opacity:w?.99:0}})]}),a.jsxs("div",{className:"compare-divider-hit",style:{left:`${d}%`},onPointerDown:re,children:[a.jsx("div",{className:"compare-divider-line"}),a.jsx("div",{className:"compare-divider-handle"})]})]})})})]})}function nu(){const[e,t]=c.useState(hb());return c.useEffect(()=>fb(t),[]),e}const Io=e=>["item",e],IC={v:1,tags:[],notes:"",version:1,updated_at:"",updated_by:"web"},Sn=new Map,Xl=new Map,Rd=new Map,Gf=new Map;let mm=0;const Vn=new Map,eo=new Map,_C=12e3,Td=new Set,Id=new Set;let Jf={state:"idle"},_o=null,_d=0;function Cl(e){Jf=e;for(const t of Td)t(e)}function sr(){const e=Vn.size>0,t=Sn.size+Xl.size+_d;if(e){Cl({state:"error",message:"Conflict detected"});return}if(_o){Cl({state:"error",message:_o});return}if(t>0){Cl({state:"syncing"});return}Cl({state:"idle"})}function Zf(){let e=null;for(const t of Rd.values())e=e==null?t:Math.min(e,t);for(const t of Gf.values())e=e==null?t:Math.min(e,t);return e}function Ma(){const e=Zf();for(const t of Id)t(e)}function Pa(e){_o=e,sr()}function Jy(){_o&&(_o=null,sr())}function gm(e){_d=Math.max(0,_d+e),sr()}function LC(){mm+=1;const e=mm;return Gf.set(e,Date.now()),Ma(),e}function AC(e){e!=null&&Gf.delete(e)&&Ma()}function ru(e){const t=eo.get(e);if(!t||!t.size)return;const n=Vn.get(e)??null;for(const r of t)r(n)}function vm(e){return Vn.get(e)??null}function su(e){Vn.delete(e)&&(ru(e),sr())}function FC(e,t){Vn.set(e,t),ru(e),sr()}function OC(e,t){const n=eo.get(e)??new Set;return n.add(t),eo.set(e,n),t(Vn.get(e)??null),()=>{const r=eo.get(e);r&&(r.delete(t),r.size||eo.delete(e))}}function DC(e){const[t,n]=c.useState(()=>e?vm(e):null);return c.useEffect(()=>{if(!e){n(null);return}return n(vm(e)),OC(e,n)},[e]),t}function zC(e){return Td.add(e),e(Jf),()=>{Td.delete(e)}}function $C(){const[e,t]=c.useState(Jf);return c.useEffect(()=>zC(t),[]),e}function BC(e){return Id.add(e),e(Zf()),()=>{Id.delete(e)}}function UC(){const[e,t]=c.useState(()=>Zf()),[n,r]=c.useState(()=>e==null?null:Date.now()-e);return c.useEffect(()=>BC(t),[]),c.useEffect(()=>{if(e==null){r(null);return}r(Date.now()-e);const s=window.setInterval(()=>{r(Date.now()-e)},1e3);return()=>window.clearInterval(s)},[e]),n}function Ld(e){const t={};return Object.prototype.hasOwnProperty.call(e,"star")&&(t.set_star=e.star??null),Object.prototype.hasOwnProperty.call(e,"notes")&&(t.set_notes=e.notes??""),Object.prototype.hasOwnProperty.call(e,"tags")&&(t.set_tags=Array.isArray(e.tags)?e.tags:[]),t}function Ad(e){var t,n;return e.set_star!==void 0||e.set_notes!==void 0||e.set_tags!==void 0||(((t=e.add_tags)==null?void 0:t.length)??0)>0||(((n=e.remove_tags)==null?void 0:n.length)??0)>0}function Qi(e){const t=[],n=new Set;for(const r of e??[]){if(typeof r!="string")continue;const s=r.trim();!s||n.has(s)||(n.add(s),t.push(s))}return t}function VC(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function WC(e,t){if(e.set_star!==void 0&&(t.star??null)!==e.set_star||e.set_notes!==void 0&&(t.notes??"")!==(e.set_notes??""))return!1;if(e.set_tags!==void 0){const r=Qi(e.set_tags),s=Qi(t.tags);return VC(r,s)}const n=Qi(t.tags);for(const r of Qi(e.add_tags))if(!n.includes(r))return!1;for(const r of Qi(e.remove_tags))if(n.includes(r))return!1;return!0}function Zy(e,t,n){if(n instanceof tn&&n.status===409){const r=n.body;if(r!=null&&r.current)return FC(e,{path:e,current:r.current,pending:t,receivedAt:new Date().toISOString()}),!0}return!1}function HC(e,t){const n=Vn.get(e);if(n){if(WC(n.pending,t)){su(e);return}Vn.set(e,{...n,current:t}),ru(e),sr()}}function QC(e){const t=nu();return Za({queryKey:Io(e),queryFn:()=>pe.getSidecar(e),enabled:!!e,staleTime:3e4,gcTime:5*6e4,retry:2,refetchInterval:t?_C:!1,refetchIntervalInBackground:t})}function KC(e){const t=dr();return RS({mutationFn:async({patch:n,baseVersion:r,idempotencyKey:s})=>{const i=Ld(n);if(!Ad(i))return t.getQueryData(Io(e))??IC;const o={...i,base_version:r};try{return await pe.patchSidecar(e,o,{idempotencyKey:s??tu("patch"),ifMatch:r})}catch(l){throw Zy(e,i,l),l}},retry:(n,r)=>r instanceof tn&&r.status===409?!1:n<2,retryDelay:n=>Math.min(1e3*Math.pow(2,n),4e3),onMutate:()=>(Jy(),gm(1),{inflightId:LC()}),onSuccess:n=>{su(e),t.setQueryData(Io(e),n)},onError:n=>{n instanceof tn&&n.status===409||(n instanceof tn?Pa(n.message):Pa("Failed to save"))},onSettled:(n,r,s,i)=>{gm(-1),AC(i==null?void 0:i.inflightId)}})}const YC=6;async function ex(e,t){if(!e.length)return;let n=0;const r=[],s=async()=>{for(;n<e.length;){const o=n++,l=e[o];try{await tx(l,t)}catch(u){r.push({path:l,error:u}),console.error(`[bulkUpdateSidecars] Failed for ${l}:`,u)}}},i=Array.from({length:Math.min(YC,e.length)},()=>s());if(await Promise.all(i),r.length===e.length)throw new Error(`All ${e.length} sidecar updates failed`)}async function tx(e,t){const n=Sn.get(e)||{};Sn.set(e,{...n,...t}),Jy(),sr();const r=Xl.get(e);if(r)return r;Rd.set(e,Date.now()),Ma();const s=(async()=>{try{for(;Sn.has(e);){const i=Sn.get(e);if(!i)break;const o=Ld(i);if(!Ad(o)){Sn.get(e)===i&&Sn.delete(e);continue}let l=1;try{l=(await pe.getSidecar(e)).version??1}catch{l=1}const u={...o,base_version:l};try{await pe.patchSidecar(e,u,{idempotencyKey:tu("patch"),ifMatch:l}),su(e),Sn.get(e)===i&&Sn.delete(e)}catch(d){if(Zy(e,o,d)){const p=Sn.get(e);if(p&&p!==i){const h=Ld(p);if(Ad(h)){const w=Vn.get(e);w&&(Vn.set(e,{...w,pending:h}),ru(e))}}Sn.delete(e)}else d instanceof tn?Pa(d.message):Pa("Failed to save");throw d}}}finally{Xl.delete(e),Rd.delete(e),Ma(),sr()}})();return Xl.set(e,s),sr(),s}function Wo(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}function nx(e){return e==="pil_info"||e.startsWith("pil_info.")||e.startsWith("pil_info[")}function Fd(e,t){if(typeof t=="number")return e?`${e}[${t}]`:`[${t}]`;const n=/^[A-Za-z0-9_$-]+$/.test(t);return e?n?`${e}.${t}`:`${e}["${t}"]`:n?t:`["${t}"]`}function Ra(e){return e==null?String(e):typeof e=="string"?e:typeof e=="number"||typeof e=="boolean"?String(e):Array.isArray(e)?`[${e.map(Ra).join(",")}]`:typeof e=="object"?`{${Object.entries(e).sort(([n],[r])=>n.localeCompare(r)).map(([n,r])=>`${n}:${Ra(r)}`).join(",")}}`:String(e)}function kl(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return String(e);try{return JSON.stringify(e,null,1)}catch{return String(e)}}function Ta(e,t,n,r,s){if(s.skipPilInfo&&nx(t))return;const i=t||"(root)";if(r>=s.maxDepth){n.set(i,e);return}if(Array.isArray(e)){if(!e.length){n.set(i,[]);return}if(e.length>s.maxArray){n.set(i,e);return}e.forEach((o,l)=>Ta(o,Fd(t,l),n,r+1,s));return}if(Wo(e)){const o=Object.keys(e).sort((l,u)=>l.localeCompare(u));if(!o.length){n.set(t||"(root)",{});return}for(const l of o)s.skipPilInfo&&!t&&l==="pil_info"||Ta(e[l],Fd(t,l),n,r+1,s);return}n.set(i,e)}function ql(e){if(Array.isArray(e))return e.map(ql);if(e&&typeof e=="object")return Object.fromEntries(Object.entries(e).map(([t,n])=>[t,ql(n)]));if(typeof e=="string"){const t=e.trim();if(t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]")||t.startsWith('"')&&t.endsWith('"'))try{const r=JSON.parse(t);return ql(r)}catch{return e}}return e}function ac(e){return e?ql(e):null}function uc(e,t){if(!e)return null;if(!t&&Wo(e)&&"pil_info"in e){const n={};for(const[r,s]of Object.entries(e))n[r]=r==="pil_info"?"Hidden (toggle Show PIL info to expand)":s;return n}return e}function co(e,t=[]){return e===null?{kind:"null",text:"null"}:e===void 0?{kind:"undefined",text:"undefined"}:typeof e=="string"?{kind:"string",text:JSON.stringify(e)}:typeof e=="number"?{kind:"number",text:String(e)}:typeof e=="boolean"?{kind:"boolean",text:e?"true":"false"}:Array.isArray(e)?{kind:"array",items:e.map((n,r)=>co(n,[...t,r]))}:Wo(e)?{kind:"object",entries:Object.keys(e).map(n=>{const r=[...t,n];return{key:n,path:r,value:co(e[n],r)}})}:{kind:"fallback",text:String(e)}}function XC(e){let t="";for(const n of e)t=Fd(t,n);return t||"(root)"}function qC(e,t){let n=e;for(const r of t){if(typeof r=="number"){if(!Array.isArray(n))return;n=n[r];continue}if(!Wo(n))return;n=n[r]}return n}function GC(e){if(e===void 0)return"undefined";if(e===null)return"null";if(typeof e=="string")return e;try{return JSON.stringify(e,null,1)}catch{return String(e)}}function cc(e,t){const n=qC(e,t);return{pathLabel:XC(t),copyText:GC(n)}}function dc(e){return!!e&&Wo(e)&&"pil_info"in e}function JC(e,t,n){if(e==null||t==null)return null;const r=new Map,s=new Map,i={maxDepth:n.maxDepth,maxArray:n.maxArray,skipPilInfo:!n.includePilInfo};Ta(e,"",r,0,i),Ta(t,"",s,0,i);const o=new Set([...r.keys(),...s.keys()]),l=[];let u=0,d=0,f=0;const p=Array.from(o).sort((S,C)=>S.localeCompare(C)),h=!n.includePilInfo;for(const S of p){if(h&&nx(S))continue;const C=r.has(S),v=s.has(S);if(!C&&v){d+=1,l.push({key:S,kind:"onlyB",aText:"",bText:kl(s.get(S))});continue}if(C&&!v){u+=1,l.push({key:S,kind:"onlyA",aText:kl(r.get(S)),bText:""});continue}const m=r.get(S),y=s.get(S),g=Ra(m),b=Ra(y);g!==b&&(f+=1,l.push({key:S,kind:"different",aText:kl(m),bText:kl(y)}))}const w=Math.max(0,l.length-n.limit);return{entries:w?l.slice(0,n.limit):l,onlyA:u,onlyB:d,different:f,truncatedCount:w}}function Od(e){const t=["B","KB","MB","GB","TB"];let n=0,r=e;for(;r>=1024&&n<t.length-1;)r/=1024,n+=1;return`${r.toFixed(1)} ${t[n]}`}function rx(e){if(e==null||Number.isNaN(e))return"";const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function fc(e){if(!e)return null;try{return JSON.parse(e)}catch{return null}}function ZC(e,t=28){if(e.length<=t)return e;const n=Math.max(4,Math.floor((t-1)/2));return`${e.slice(0,n)}${e.slice(-n)}`}const ek=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"});function tk(e){const t=e.trim();return!t||/[zZ]|[+-]\d{2}:?\d{2}$/.test(t)?t:`${t.includes("T")?t:t.replace(" ","T")}Z`}function sx(e){if(!e)return null;const t=Date.parse(tk(e));return Number.isFinite(t)?t:null}function nk(e,t=Date.now()){const n=Math.max(0,t-e),r=Math.max(1,Math.floor(n/1e3));if(r<60)return`${r} second${r===1?"":"s"} ago`;const s=Math.floor(r/60);if(s<60)return`${s} minute${s===1?"":"s"} ago`;const i=Math.floor(s/60);return`${i} hour${i===1?"":"s"} ago`}function rk(e){return ek.format(new Date(e))}function Ho({title:e,open:t,onToggle:n,actions:r,children:s,contentClassName:i}){const[o,l]=c.useState(t),[u,d]=c.useState(t?"open":"closed");return c.useEffect(()=>{if(t){l(!0);const p=window.requestAnimationFrame(()=>d("open"));return()=>window.cancelAnimationFrame(p)}d("closing");const f=window.setTimeout(()=>{l(!1),d("closed")},140);return()=>window.clearTimeout(f)},[t]),a.jsxs("div",{className:"border-b border-border/60",children:[a.jsxs("div",{className:"flex items-center justify-between px-3 py-2.5",children:[a.jsxs("button",{type:"button",onClick:n,"aria-expanded":t,className:"flex items-center gap-2 inspector-section-title hover:text-text transition-colors",children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:`transition-transform ${t?"rotate-90":""}`,"aria-hidden":"true",children:a.jsx("path",{d:"m9 18 6-6-6-6"})}),a.jsx("span",{children:e})]}),r]}),o&&a.jsx("div",{className:"inspector-section-body","data-state":u,"aria-hidden":!t,children:a.jsx("div",{className:i??"px-3 pb-3",children:s})})]})}function El({copied:e,value:t,className:n="",title:r}){return a.jsxs("span",{className:`ui-kv-value relative inline-block text-right min-w-[80px] ${n}`.trim(),title:r,children:[a.jsx("span",{className:e?"invisible block":"block",children:t}),e&&a.jsx("span",{className:"absolute inset-0 text-right",children:"Copied"})]})}function sk({open:e,onToggle:t,multi:n,star:r,onSelectStar:s,hasStarConflict:i,onApplyConflict:o,onKeepTheirs:l,currentItem:u,sourceValue:d,sortSpec:f,copiedField:p,onCopyInfo:h,metricsExpanded:w,onToggleMetricsExpanded:x,metricsPreviewLimit:S}){return a.jsxs(Ho,{title:"Basics",open:e,onToggle:t,children:[a.jsxs("div",{className:"flex items-center gap-2 text-xs mb-1",role:"radiogroup","aria-label":"Star rating",children:[a.jsx("span",{className:"ui-kv-label w-16 shrink-0",children:n?"Rating (all)":"Rating"}),a.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(C=>{const v=(r??0)>=C;return a.jsx("button",{className:`w-6 h-6 flex items-center justify-center rounded-lg border border-border/60 bg-transparent text-[13px] ${v?"text-star-active":"text-star-inactive"} hover:border-border hover:text-star-hover transition-colors`,onClick:()=>{s(r===C&&!n?null:C)},title:`${C} star${C>1?"s":""} (key ${C})`,"aria-label":`${C} star${C>1?"s":""}`,"aria-pressed":r===C,children:v?"":""},C)})})]}),i&&a.jsxs("div",{className:"ui-banner ui-banner-danger mt-2 text-[11px] flex items-center justify-between gap-2",children:[a.jsx("span",{children:"Rating conflict."}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:o,children:"Apply again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:l,children:"Keep theirs"})]})]}),!n&&u&&a.jsxs("div",{className:"text-[12px] space-y-1.5 leading-relaxed",children:[a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("dimensions",`${u.w}${u.h}`),children:"Dimensions"}),a.jsx(El,{copied:p==="dimensions",value:`${u.w}${u.h}`})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("size",Od(u.size)),children:"Size"}),a.jsx(El,{copied:p==="size",value:Od(u.size)})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>h("type",u.type),children:"Type"}),a.jsx(El,{copied:p==="type",value:u.type,className:"break-all"})]}),a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:"ui-kv-label ui-kv-label-action w-20 shrink-0",onClick:()=>d&&h("source",d),children:"Source"}),a.jsx(El,{copied:p==="source",value:d,className:"inspector-value-clamp break-words max-w-[70%]",title:d})]}),(()=>{const C=u.metrics||null;if(!C)return null;const v=Object.entries(C).filter(([,_])=>_!=null);if(!v.length)return null;const m=(f==null?void 0:f.kind)==="metric"?f.key:null,y=[...v].sort(([_],[P])=>_.localeCompare(P));let g=y;if(m){const _=y.findIndex(([P])=>P===m);_>0&&(g=[y[_],...y.slice(0,_),...y.slice(_+1)])}const b=g.length>S,M=w||!b?g:g.slice(0,S),N=g.length-S;return a.jsxs("div",{className:"mt-3",children:[a.jsx("div",{className:"ui-subsection-title mb-1",children:"Metrics"}),a.jsxs("div",{className:"space-y-1",children:[M.map(([_,P])=>{const B=m===_;return a.jsxs("div",{className:"ui-kv-row",children:[a.jsx("span",{className:`w-24 shrink-0 ${B?"text-accent font-medium":"ui-kv-label"}`,children:_}),a.jsx("span",{className:`ui-kv-value text-right ${B?"text-accent font-medium":""}`,children:rx(P)})]},_)}),b&&a.jsx("button",{type:"button",className:"text-[11px] text-muted underline underline-offset-2 hover:text-text",onClick:x,"aria-expanded":w,children:w?"Show less":`+${N} more`})]})]})})()]})]})}const Nl=2,ik={color:"var(--json-string)"},ok={color:"var(--json-number)"},lk={color:"var(--json-literal)"},ak={color:"var(--json-fallback)"},uk={color:"var(--json-key)"};function Dd(e,t,n){switch(e.kind){case"null":case"boolean":return a.jsx("span",{style:lk,children:e.text});case"undefined":case"fallback":return a.jsx("span",{style:ak,children:e.text});case"string":return a.jsx("span",{style:ik,children:e.text});case"number":return a.jsx("span",{style:ok,children:e.text});case"array":return e.items.length===0?"[]":a.jsxs(a.Fragment,{children:[`[
`,e.items.map((r,s)=>a.jsxs(Wr.Fragment,{children:[" ".repeat(t+Nl),Dd(r,t+Nl,n),s<e.items.length-1?",":"",`
`]},s))," ".repeat(t),"]"]});case"object":return e.entries.length===0?"{}":a.jsxs(a.Fragment,{children:[`{
`,e.entries.map((r,s)=>a.jsxs(Wr.Fragment,{children:[" ".repeat(t+Nl),a.jsx("span",{className:"ui-json-key",style:uk,onClick:n?i=>{i.stopPropagation(),n(r.path)}:void 0,children:JSON.stringify(r.key)}),": ",Dd(r.value,t+Nl,n),s<e.entries.length-1?",":"",`
`]},JSON.stringify(r.path)))," ".repeat(t),"}"]})}}function ix({node:e,onPathClick:t}){return a.jsx("code",{className:"block whitespace-pre-wrap",children:Dd(e,0,t)})}const ox=Wr.memo(function({compareDiff:t}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-muted",children:[a.jsxs("span",{children:[t.different," ","different"," ",""," ",t.onlyA," ","only A"," ",""," ",t.onlyB," ","only B"]}),a.jsx("span",{className:"text-[10px] uppercase tracking-wide",children:"Deep paths"})]}),t.entries.length===0?a.jsx("div",{className:"text-muted",children:"No differences found."}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2 text-[10px] uppercase tracking-wide text-muted",children:[a.jsx("div",{children:"Path"}),a.jsx("div",{children:"A"}),a.jsx("div",{children:"B"})]}),t.entries.map(n=>a.jsxs("div",{className:"grid grid-cols-[minmax(80px,_1fr)_minmax(0,_1fr)_minmax(0,_1fr)] gap-2",children:[a.jsx("div",{className:"text-[11px] text-muted font-mono break-all",children:n.key}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.aText}),a.jsx("div",{className:"text-[11px] font-mono bg-surface-inset border border-border/60 rounded px-2 py-1 whitespace-pre-wrap break-words max-h-32 overflow-auto",children:n.bText})]},n.key)),t.truncatedCount>0&&a.jsxs("div",{className:"text-muted text-[11px]",children:["+",t.truncatedCount," ","more differences not shown."]})]})]})});ox.displayName="CompareDiffTable";const zd=Wr.memo(function({side:t,compareMetaLoaded:n,hasPilInfo:r,showPilInfo:s,onToggleShowPilInfo:i,copied:o,onCopy:l,copiedPath:u,displayNode:d,compareMetaContent:f,onMetaPathCopy:p}){return a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:["Metadata"," ",t]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[r&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:i,disabled:!n,children:s?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[70px]",onClick:l,disabled:!n,children:o?"Copied":"Copy"})]})]}),a.jsxs("div",{className:"relative",children:[u&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",u]}),a.jsx("pre",{className:"ui-code-block ui-code-block-resizable h-40 overflow-auto whitespace-pre-wrap",children:n&&d?a.jsx(ix,{node:d,onPathClick:p}):f})]})]})});zd.displayName="CompareMetadataPane";function ck({open:e,onToggle:t,compareMetaState:n,compareMetaError:r,compareLabelA:s,compareLabelB:i,compareIncludePilInfo:o,onToggleCompareIncludePilInfo:l,onReload:u,compareDiff:d,compareHasPilInfoA:f,compareHasPilInfoB:p,compareShowPilInfoA:h,compareShowPilInfoB:w,onToggleCompareShowPilInfoA:x,onToggleCompareShowPilInfoB:S,compareMetaCopied:C,onCopyCompareMetadata:v,compareValueCopiedPathA:m,compareValueCopiedPathB:y,compareDisplayNodeA:g,compareDisplayNodeB:b,compareMetaContent:E,onCompareMetaPathCopyA:M,onCompareMetaPathCopyB:N}){const _=n==="loaded";return a.jsx(Ho,{title:"Compare Metadata",open:e,onToggle:t,actions:a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:u,disabled:n==="loading",children:n==="loading"?"Loading":"Reload"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:l,disabled:!_,children:o?"Hide PIL info":"Include PIL info"})]}),children:a.jsxs("div",{className:"space-y-2 text-[11px]",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[11px] text-muted",children:[a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"A"}),a.jsx("div",{className:"text-text break-all",title:s,children:s})]}),a.jsxs("div",{children:[a.jsx("div",{className:"uppercase tracking-wide text-[10px]",children:"B"}),a.jsx("div",{className:"text-text break-all",title:i,children:i})]})]}),n==="loading"&&a.jsx("div",{className:"text-muted",children:"Loading metadata"}),n==="error"&&r&&a.jsx("div",{className:"text-danger break-words",children:r}),_&&d&&a.jsx(ox,{compareDiff:d}),a.jsxs("div",{className:"grid gap-3 pt-2",children:[a.jsx(zd,{side:"A",compareMetaLoaded:_,hasPilInfo:f,showPilInfo:h,onToggleShowPilInfo:x,copied:C==="A",onCopy:()=>v("A"),copiedPath:m,displayNode:g,compareMetaContent:E,onMetaPathCopy:M}),a.jsx(zd,{side:"B",compareMetaLoaded:_,hasPilInfo:p,showPilInfo:w,onToggleShowPilInfo:S,copied:C==="B",onCopy:()=>v("B"),copiedPath:y,displayNode:b,compareMetaContent:E,onMetaPathCopy:N})]})]})})}const lx=Wr.memo(ck);lx.displayName="CompareMetadataSection";function dk({open:e,onToggle:t,metadataLoading:n,metadataActionLabel:r,onMetadataAction:s,metadataActionDisabled:i,hasPilInfo:o,showPilInfo:l,onToggleShowPilInfo:u,metaValueCopiedPath:d,metaHeightClass:f,metaLoaded:p,metaDisplayNode:h,metaContent:w,metaError:x,onMetaPathCopy:S}){const C=a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[p&&o&&a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors",onClick:u,disabled:!p,children:l?"Hide PIL info":"Show PIL info"}),a.jsx("button",{className:"px-2 py-1 bg-transparent text-muted border border-border/60 rounded-md disabled:opacity-60 hover:border-border hover:text-text transition-colors min-w-[78px]",onClick:s,disabled:i||n,children:r})]});return a.jsxs(Ho,{title:"Metadata",open:e,onToggle:t,actions:C,children:[a.jsxs("div",{className:"relative",children:[d&&a.jsxs("div",{className:"ui-json-key-toast",children:["Copied value:"," ",d]}),a.jsx("pre",{className:`ui-code-block ui-code-block-resizable ${f} overflow-auto whitespace-pre-wrap`,children:p&&h?a.jsx(ix,{node:h,onPathClick:S}):w})]}),x&&a.jsx("div",{className:"text-[11px] text-danger mt-1 break-words",children:x})]})}const ax=Wr.memo(dk);ax.displayName="MetadataSection";function fk({open:e,onToggle:t,multi:n,showConflictBanner:r,onApplyConflict:s,onKeepTheirs:i,notes:o,onNotesChange:l,onNotesBlur:u,tags:d,onTagsChange:f,onTagsBlur:p}){return a.jsxs(Ho,{title:"Notes & Tags",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",children:[r&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Conflicting edits detected."}),a.jsx("div",{className:"text-[11px] text-muted mt-0.5",children:"Your changes were not saved because this item was updated elsewhere."}),a.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx("button",{className:"btn btn-sm",onClick:s,children:"Apply my changes again"}),a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:i,children:"Keep theirs"})]})]}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full scrollbar-thin",placeholder:"Add notes",value:o,onChange:h=>l(h.target.value),onBlur:u,"aria-label":n?"Notes for selected items":"Notes"}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:n?"Tags (apply to all, comma-separated)":"Tags (comma-separated)"}),a.jsx("input",{className:"ui-input inspector-input w-full",placeholder:"tag1, tag2",value:d,onChange:h=>f(h.target.value),onBlur:p,"aria-label":n?"Tags for selected items":"Tags"})]})]})}function hk(e){return e===2?null:e>2?`Side-by-side view supports exactly 2 selections (selected ${e}).`:"Select exactly 2 images to open side-by-side view."}function pk({selectedCount:e,compareActive:t,onOpenCompare:n}){const r=hk(e),s=!n||t||r!==null,i=t?"Side-by-side viewer is already open.":r??"Open side by side to enable comparison export controls.";return a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Selection Actions"}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>n==null?void 0:n(),disabled:s,children:"Side by side view"}),a.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",onClick:()=>n==null?void 0:n(),disabled:s,children:"Export comparison"})]}),a.jsx("div",{className:"text-[11px] text-muted",children:i})]})}const ym=2,ux=12,xm=120,hc=!0,$d="Comparison export (v1) requires exactly 2 selected images.",mk=`Comparison export (v2) requires between 2 and ${ux} selected images.`,cx="Comparison export for more than 2 selections is unavailable on this server.";function dx(e,t){return`Comparison export (v2) supports up to ${e} selections (selected ${t}).`}function gk(e){return e.replace(/[\u0000-\u001f\u007f]/g,"").trim()}function vk(e){const n=e.replace(/\r\n?/g,`
`).replace(/\n+$/g,"");return n?n.split(`
`):[]}function yk(e){if(e.length!==0)return e.length===1?[e[0]]:[e[0],e[1]]}function xk(e){return e.map(t=>t.trim()).filter(t=>t.length>0)}function fx(e,t){const{maxLines:n,tooManyLinesMessage:r}=t,s=vk(e);if(s.length>n)return{ok:!1,message:r};const i=s.map(l=>gk(l));return i.some(l=>l.length>xm)?{ok:!1,message:`Each label must be at most ${xm} characters.`}:i.some(l=>l.length>0)?{ok:!0,labels:i}:{ok:!0,labels:void 0}}function wk(e){const{pathA:t,pathB:n,labelsText:r,embedMetadata:s,reverseOrder:i}=e;if(!t||!n)return{ok:!1,message:$d};const o=fx(r,{maxLines:ym,tooManyLinesMessage:`Enter at most ${ym} label lines (line 1 = A, line 2 = B).`});if(!o.ok)return o;const l={v:1,paths:[t,n],embed_metadata:s,reverse_order:i};return o.labels&&(l.labels=yk(o.labels)),{ok:!0,payload:l}}function Sk(e){const{paths:t,labelsText:n,embedMetadata:r,reverseOrder:s}=e,i=xk(t);if(i.length!==t.length||i.length<2||i.length>ux)return{ok:!1,message:mk};const o=fx(n,{maxLines:i.length,tooManyLinesMessage:`Enter at most ${i.length} label lines (one per selected image).`});if(!o.ok)return o;const l={v:2,paths:i,embed_metadata:r,reverse_order:s};return o.labels&&(l.labels=o.labels),{ok:!0,payload:l}}function Ki(e){return String(e).padStart(2,"0")}function bk(e,t=new Date){const n=t.getUTCFullYear(),r=Ki(t.getUTCMonth()+1),s=Ki(t.getUTCDate()),i=Ki(t.getUTCHours()),o=Ki(t.getUTCMinutes()),l=Ki(t.getUTCSeconds());return`comparison${e?"_reverse":""}_${n}${r}${s}_${i}${o}${l}.png`}function Ck({selectedCount:e,compareActive:t,compareExportSupportsV2:n,compareExportMaxPathsV2:r}){return e<2?`Comparison export requires at least 2 selections (selected ${e}).`:e===2?t?null:"Open side-by-side view to enable comparison export.":!n||r===null?cx:e>r?dx(r,e):null}function kk({selectedCount:e,compareActive:t,compareReady:n,compareExportSupportsV2:r,compareExportMaxPathsV2:s,compareExportLabelsText:i,onCompareExportLabelsTextChange:o,compareExportEmbedMetadata:l,onCompareExportEmbedMetadataChange:u,compareExportBusy:d,compareExportMode:f,onComparisonExport:p,compareExportError:h}){const w=Ck({selectedCount:e,compareActive:t,compareExportSupportsV2:r,compareExportMaxPathsV2:s}),S=d||w!==null||e===2&&!n,C=e>2?`Label for image 1
Label for image 2
...`:`Label for A
Label for B`;return a.jsxs("div",{className:"space-y-2 rounded-md border border-border/60 bg-surface-inset/40 p-3",children:[a.jsx("div",{className:"text-[10px] uppercase tracking-wide text-muted",children:"Selection Export"}),a.jsx("textarea",{className:"ui-textarea inspector-input w-full h-20 scrollbar-thin",placeholder:C,value:i,onChange:v=>o(v.target.value),disabled:S,"aria-label":"Selection export labels"}),a.jsxs("label",{className:"inline-flex items-center gap-2 text-[11px] text-muted",children:[a.jsx("input",{type:"checkbox",checked:l,onChange:v=>u(v.target.checked),disabled:S}),a.jsx("span",{children:"Embed metadata"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>p(!1),disabled:S,children:f==="normal"?"Exporting":"Export comparison"}),a.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",onClick:()=>p(!0),disabled:S,children:f==="reverse"?"Exporting":"Export (reverse order)"})]}),w&&a.jsx("div",{className:"text-[11px] text-muted",children:w}),h&&a.jsx("div",{className:"text-danger break-words",children:h})]})}function Ek({open:e,onToggle:t,multi:n,selectedCount:r,totalSize:s,filename:i,compareActive:o,compareReady:l,onOpenCompare:u,compareExportSupportsV2:d,compareExportMaxPathsV2:f,compareExportLabelsText:p,onCompareExportLabelsTextChange:h,compareExportEmbedMetadata:w,onCompareExportEmbedMetadataChange:x,compareExportBusy:S,compareExportMode:C,onComparisonExport:v,compareExportError:m,onFindSimilar:y,canFindSimilar:g,findSimilarDisabledReason:b}){return a.jsxs(Ho,{title:n?"Selection":"Item",open:e,onToggle:t,contentClassName:"px-3 pb-3 space-y-2",actions:y&&a.jsx("button",{type:"button",className:"btn btn-sm",onClick:y,disabled:!g,title:b??"Find similar",children:"Find similar"}),children:[n?a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Selected"}),a.jsxs("div",{className:"inspector-field-value",children:[r," files"]})]}),a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Total size"}),a.jsx("div",{className:"inspector-field-value",children:Od(s)})]})]}),a.jsx(pk,{selectedCount:r,compareActive:o,onOpenCompare:u}),a.jsx(kk,{selectedCount:r,compareActive:o,compareReady:l,compareExportSupportsV2:d,compareExportMaxPathsV2:f,compareExportLabelsText:p,onCompareExportLabelsTextChange:h,compareExportEmbedMetadata:w,onCompareExportEmbedMetadataChange:x,compareExportBusy:S,compareExportMode:C,onComparisonExport:v,compareExportError:m})]}):a.jsxs("div",{className:"inspector-field",children:[a.jsx("div",{className:"inspector-field-label",children:"Filename"}),a.jsx("div",{className:"inspector-field-value break-all",title:i,children:i})]}),b&&a.jsx("div",{className:"text-[11px] text-muted",children:b})]})}function Nk(e,t){const n=jk(e)||"view",r=new Set(t.map(i=>i.id));if(!r.has(n))return n;let s=2;for(;r.has(`${n}-${s}`);)s+=1;return`${n}-${s}`}function jk(e){return e.toLowerCase().trim().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}function pc(e){const t=e.filter(s=>s>0).sort((s,i)=>i-s),n=e.includes(0),r=[...t.map(s=>String(s))];return n&&r.push("None"),r.join(", ")}function Mk(e,t){return e&&t?`${e} to ${t}`:e?`from ${e}`:t?`to ${t}`:""}function Pk(e){if(e==="/"||e==="")return"Root";const t=e.split("/").filter(Boolean);return t.length?t.length<=2?`/${t.join("/")}`:`.../${t.slice(-2).join("/")}`:"Root"}function Rk(e,t,n,r){return!n||r?t:e==="/"||e===""?e||"/":n===e||n.startsWith(`${e}/`)?e:t}function Tk(e,t){return`${wm(e)}${wm(t)}`}function wm(e){const t=Math.abs(e);return t>=1e3?e.toFixed(0):t>=10?e.toFixed(2):e.toFixed(3)}function Ik(e){const t=e.toLowerCase();return t.endsWith(".png")?"image/png":t.endsWith(".webp")?"image/webp":"image/jpeg"}function _k(e,t){const n=e.split("/").pop()??e;return{path:e,name:n,type:Ik(e),w:0,h:0,size:0,hasThumb:!0,hasMeta:!1,star:t??null}}function fo(e,t){const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),r.remove(),URL.revokeObjectURL(n)}function Lk({selectedPaths:e,compareReady:t,comparePathA:n,comparePathB:r,compareExportSupportsV2:s,compareExportMaxPathsV2:i}){const[o,l]=c.useState(""),[u,d]=c.useState(hc),[f,p]=c.useState(null),[h,w]=c.useState(null),x=f!==null;c.useEffect(()=>{if(e.length<2){l(""),d(hc),p(null),w(null);return}e.length===2&&(!t||!n||!r)&&(l(""),d(hc)),p(null),w(null)},[n,r,t,e.length]);const S=c.useCallback(m=>{l(m),w(null)},[]),C=c.useCallback(m=>{d(m)},[]),v=c.useCallback(async m=>{if(x)return;const y=e.length;if(y<2){w($d);return}let g;if(y===2){if(!t||!n||!r){w($d);return}g=wk({pathA:n,pathB:r,labelsText:o,embedMetadata:u,reverseOrder:m})}else{if(!s){w(cx);return}if(i!==null&&y>i){w(dx(i,y));return}g=Sk({paths:e,labelsText:o,embedMetadata:u,reverseOrder:m})}if(!g.ok){w(g.message);return}p(m?"reverse":"normal"),w(null);try{const b=await pe.exportComparison(g.payload);fo(b,bk(m))}catch(b){const E=b instanceof Error?b.message:"Failed to export comparison.";w(E)}finally{p(null)}},[x,u,o,i,s,n,r,t,e]);return{compareExportLabelsText:o,compareExportEmbedMetadata:u,compareExportMode:f,compareExportError:h,compareExportBusy:x,handleCompareExportLabelsTextChange:S,handleCompareExportEmbedMetadataChange:C,runComparisonExport:v}}function Sm(e,t){return e?`${e}::${t??""}`:null}function bm(e,t,n){return!e||!t||!n?null:`${t}::${n}`}function Ia({activeRequestId:e,responseRequestId:t,activeContextKey:n,responseContextKey:r}){return e===t&&n===r}function Ak({compareReady:e,comparePathA:t,comparePathB:n}){const[r,s]=c.useState("idle"),[i,o]=c.useState(null),[l,u]=c.useState(null),[d,f]=c.useState(null),[p,h]=c.useState(!1),[w,x]=c.useState(!1),[S,C]=c.useState(!1),v=bm(e,t,n),m=c.useRef(0),y=c.useRef(v);y.current=v;const g=c.useCallback(async(E,M,N)=>{const _=m.current+1;m.current=_,s("loading"),o(null);try{const[P,B]=await Promise.all([pe.getMetadata(E),pe.getMetadata(M)]);if(!Ia({activeRequestId:m.current,responseRequestId:_,activeContextKey:y.current,responseContextKey:N}))return;u(P.meta),f(B.meta),s("loaded")}catch(P){if(!Ia({activeRequestId:m.current,responseRequestId:_,activeContextKey:y.current,responseContextKey:N}))return;const B=P instanceof Error?P.message:"Failed to load metadata";u(null),f(null),o(B),s("error")}},[]);c.useEffect(()=>{if(m.current+=1,!v||!t||!n){s("idle"),o(null),u(null),f(null),x(!1),C(!1);return}h(!1),x(!1),C(!1),g(t,n,v)},[v,t,n,g]);const b=c.useCallback(()=>{const E=bm(e,t,n);!E||!t||!n||g(t,n,E)},[e,t,n,g]);return{compareMetaState:r,compareMetaError:i,compareMetaA:l,compareMetaB:d,compareIncludePilInfo:p,compareShowPilInfoA:w,compareShowPilInfoB:S,setCompareIncludePilInfo:h,setCompareShowPilInfoA:x,setCompareShowPilInfoB:C,reloadCompareMetadata:b}}function Fk({path:e,sidecarUpdatedAt:t}){const[n,r]=c.useState(null),[s,i]=c.useState(null),[o,l]=c.useState("idle"),[u,d]=c.useState(!1),f=Sm(e,t),p=c.useRef(0),h=c.useRef(f);h.current=f,c.useEffect(()=>{p.current+=1,r(null),i(null),l("idle"),d(!1)},[f]);const w=c.useCallback(async()=>{const x=Sm(e,t);if(!x||!e)return;const S=p.current+1;p.current=S,l("loading"),i(null);try{const C=await pe.getMetadata(e);if(!Ia({activeRequestId:p.current,responseRequestId:S,activeContextKey:h.current,responseContextKey:x}))return;r(C.meta),l("loaded")}catch(C){if(!Ia({activeRequestId:p.current,responseRequestId:S,activeContextKey:h.current,responseContextKey:x}))return;const v=C instanceof Error?C.message:"Failed to load metadata";r(null),i(v),l("error")}},[e,t]);return{metaRaw:n,metaError:s,metaState:o,showPilInfo:u,setMetaError:i,setShowPilInfo:d,fetchMetadata:w}}function Ok({path:e,sidecarUpdatedAt:t,selectedPaths:n,compareReady:r,comparePathA:s,comparePathB:i,compareExportSupportsV2:o,compareExportMaxPathsV2:l}){const u=Fk({path:e,sidecarUpdatedAt:t}),d=Ak({compareReady:r,comparePathA:s,comparePathB:i}),f=Lk({selectedPaths:n,compareReady:r,comparePathA:s,comparePathB:i,compareExportSupportsV2:o,compareExportMaxPathsV2:l});return{metaRaw:u.metaRaw,metaError:u.metaError,metaState:u.metaState,showPilInfo:u.showPilInfo,setMetaError:u.setMetaError,compareMetaState:d.compareMetaState,compareMetaError:d.compareMetaError,compareMetaA:d.compareMetaA,compareMetaB:d.compareMetaB,compareIncludePilInfo:d.compareIncludePilInfo,compareShowPilInfoA:d.compareShowPilInfoA,compareShowPilInfoB:d.compareShowPilInfoB,compareExportLabelsText:f.compareExportLabelsText,compareExportEmbedMetadata:f.compareExportEmbedMetadata,compareExportMode:f.compareExportMode,compareExportError:f.compareExportError,compareExportBusy:f.compareExportBusy,setShowPilInfo:u.setShowPilInfo,setCompareIncludePilInfo:d.setCompareIncludePilInfo,setCompareShowPilInfoA:d.setCompareShowPilInfoA,setCompareShowPilInfoB:d.setCompareShowPilInfoB,fetchMetadata:u.fetchMetadata,reloadCompareMetadata:d.reloadCompareMetadata,handleCompareExportLabelsTextChange:f.handleCompareExportLabelsTextChange,handleCompareExportEmbedMetadataChange:f.handleCompareExportEmbedMetadataChange,runComparisonExport:f.runComparisonExport}}function jl(e){return{notes:(e==null?void 0:e.notes)??"",tags:((e==null?void 0:e.tags)??[]).join(", ")}}function _a(e){return e.split(",").map(t=>t.trim()).filter(Boolean)}function Dk(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0}function zk(e,t){return e!==t}function $k(e,t){return!Dk(_a(e),_a(t))}function Bk({path:e,selectedPaths:t,multi:n,sidecar:r,conflict:s,star:i,queryClient:o,mutateSidecar:l,onStarChanged:u,onLocalTypingChange:d}){const[f,p]=c.useState(""),[h,w]=c.useState(""),x=c.useRef(!1),S=c.useRef(!1),C=c.useRef(!1),v=c.useRef(jl(void 0)),m=c.useCallback(F=>{x.current!==F&&(x.current=F,d==null||d(F))},[d]),y=c.useCallback(F=>{v.current=F,S.current=!1,C.current=!1,p(F.tags),w(F.notes),m(!1)},[m]);c.useEffect(()=>{if(!e){y(jl(void 0));return}y(jl(r))},[e,y,r==null?void 0:r.updated_at,r==null?void 0:r.version]),c.useEffect(()=>()=>{m(!1)},[m]);const g=c.useCallback(F=>{if(n&&t.length){ex(t,F);return}e&&l(F,(r==null?void 0:r.version)??1)},[n,l,e,t,r==null?void 0:r.version]),b=c.useMemo(()=>({tags:!!(s!=null&&s.pending.set_tags),notes:(s==null?void 0:s.pending.set_notes)!==void 0,star:(s==null?void 0:s.pending.set_star)!==void 0}),[s]),E=c.useCallback(F=>{w(F),S.current=!0,m(!0)},[m]),M=c.useCallback(()=>{const F=S.current;S.current=!1,F&&zk(h,v.current.notes)&&(g({notes:h}),v.current={...v.current,notes:h}),m(!1)},[g,h,m]),N=c.useCallback(F=>{p(F),C.current=!0,m(!0)},[m]),_=c.useCallback(()=>{const F=C.current;C.current=!1,F&&$k(f,v.current.tags)&&(g({tags:_a(f)}),v.current={...v.current,tags:f}),m(!1)},[g,m,f]),P=c.useCallback(()=>{if(!s||!e)return;const F={};s.pending.set_tags!==void 0&&(F.tags=_a(f)),s.pending.set_notes!==void 0&&(F.notes=h),s.pending.set_star!==void 0&&(F.star=i??null),l(F,s.current.version??1)},[s,l,h,e,i,f]),B=c.useCallback(()=>{if(!s||!e)return;const F=s.current,Q=jl(F);v.current=Q,S.current=!1,C.current=!1,p(Q.tags),w(Q.notes),m(!1),o.setQueryData(Io(e),F),su(e),u==null||u([e],F.star??null)},[s,m,u,e,o]);return{tags:f,notes:h,conflictFields:b,commitSidecar:g,applyConflict:P,keepTheirs:B,handleNotesChange:E,handleNotesBlur:M,handleTagsChange:N,handleTagsBlur:_}}const Uk=["overview","compare","basics","metadata","notes"],Cm="lenslet.inspector.sections",km="lenslet.inspector.metricsExpanded",Vk={overview:!0,compare:!0,metadata:!0,basics:!0,notes:!0};function $t(e){e.current!==null&&(window.clearTimeout(e.current),e.current=null)}function Wk({path:e,sidecarUpdatedAt:t,compareReady:n,comparePathA:r,comparePathB:s}){const[i,o]=c.useState(Vk),[l,u]=c.useState(!1),[d,f]=c.useState(null),[p,h]=c.useState(!1),[w,x]=c.useState(null),[S,C]=c.useState(null),[v,m]=c.useState(null),[y,g]=c.useState(null),b=c.useRef(null),E=c.useRef(null),M=c.useRef(null),N=c.useRef(null),_=c.useRef(null),P=c.useCallback($=>{o(A=>({...A,[$]:!A[$]}))},[]),B=c.useCallback(()=>P("overview"),[P]),F=c.useCallback(()=>P("compare"),[P]),Q=c.useCallback(()=>P("basics"),[P]),Z=c.useCallback(()=>P("metadata"),[P]),W=c.useCallback(()=>P("notes"),[P]),I=c.useCallback(()=>{u($=>!$)},[]),R=c.useCallback($=>{f($),$t(b),b.current=window.setTimeout(()=>{f(A=>A===$?null:A),b.current=null},1e3)},[]),T=c.useCallback(()=>{h(!0),$t(E),E.current=window.setTimeout(()=>{h(!1),E.current=null},1200)},[]),L=c.useCallback($=>{x($),$t(M),M.current=window.setTimeout(()=>{x(null),M.current=null},900)},[]),O=c.useCallback($=>{C($),$t(N),N.current=window.setTimeout(()=>{C(A=>A===$?null:A),N.current=null},1200)},[]),Y=c.useCallback(($,A)=>{$==="A"?m(A):g(A),$t(_),_.current=window.setTimeout(()=>{m(null),g(null),_.current=null},900)},[]);return c.useEffect(()=>{try{const $=localStorage.getItem(Cm);if(!$)return;const A=JSON.parse($);if(!A||typeof A!="object")return;const V={};for(const K of Uk)typeof A[K]=="boolean"&&(V[K]=A[K]);Object.keys(V).length>0&&o(K=>({...K,...V}))}catch{}},[]),c.useEffect(()=>{try{localStorage.setItem(Cm,JSON.stringify(i))}catch{}},[i]),c.useEffect(()=>{try{const $=localStorage.getItem(km);$==="1"||$==="true"?u(!0):($==="0"||$==="false")&&u(!1)}catch{}},[]),c.useEffect(()=>{try{localStorage.setItem(km,l?"1":"0")}catch{}},[l]),c.useEffect(()=>{h(!1),x(null),$t(E),$t(M)},[e,t]),c.useEffect(()=>{C(null),m(null),g(null),$t(N),$t(_)},[r,s,n]),c.useEffect(()=>()=>{$t(b),$t(E),$t(M),$t(N),$t(_)},[]),{openSections:i,toggleOverviewSection:B,toggleCompareSection:F,toggleBasicsSection:Q,toggleMetadataSection:Z,toggleNotesSection:W,metricsExpanded:l,toggleMetricsExpanded:I,copiedField:d,markInfoCopied:R,metaCopied:p,markMetadataCopied:T,metaValueCopiedPath:w,markMetadataValueCopied:L,compareMetaCopied:S,markCompareMetadataCopied:O,compareValueCopiedPathA:v,compareValueCopiedPathB:y,markCompareMetadataValueCopied:Y}}const Hk=12,Qk=120,Kk=8,Yk=80;function Xk({path:e,selectedPaths:t=[],items:n=[],compareActive:r=!1,compareA:s=null,compareB:i=null,onOpenCompare:o,onResize:l,onStarChanged:u,sortSpec:d,onFindSimilar:f,embeddingsAvailable:p=!1,embeddingsLoading:h=!1,compareExportSupportsV2:w=!1,compareExportMaxPathsV2:x=null,onLocalTypingChange:S}){const C=!!e,{data:v}=QC(e??""),m=KC(e??""),y=dr(),g=t.length>1,b=!!f&&p&&!g,E=f?p?g?"Select a single image to search.":null:h?"Loading embeddings...":"No embeddings detected.":null,N=c.useMemo(()=>{var ye;return((ye=n.find(Ge=>Ge.path===e))==null?void 0:ye.star)??null},[n,e])??(v==null?void 0:v.star)??null,_=DC(g?null:e),P=(s==null?void 0:s.path)??null,B=(i==null?void 0:i.path)??null,F=r&&!!P&&!!B,{openSections:Q,toggleOverviewSection:Z,toggleCompareSection:W,toggleBasicsSection:I,toggleMetadataSection:R,toggleNotesSection:T,metricsExpanded:L,toggleMetricsExpanded:O,copiedField:Y,markInfoCopied:$,metaCopied:A,markMetadataCopied:V,metaValueCopiedPath:K,markMetadataValueCopied:G,compareMetaCopied:re,markCompareMetadataCopied:X,compareValueCopiedPathA:D,compareValueCopiedPathB:he,markCompareMetadataValueCopied:ie}=Wk({path:e,sidecarUpdatedAt:v==null?void 0:v.updated_at,comparePathA:P,comparePathB:B,compareReady:F}),me=F&&r&&Q.compare,ke=!g&&Q.metadata,xe=(s==null?void 0:s.name)??P??"A",qe=(i==null?void 0:i.name)??B??"B",Yt=c.useCallback((ce,ye)=>{m.mutate({patch:ce,baseVersion:ye,idempotencyKey:tu("patch")})},[m]),{tags:dt,notes:In,conflictFields:zt,commitSidecar:Xt,applyConflict:yn,keepTheirs:se,handleNotesChange:oe,handleNotesBlur:Se,handleTagsChange:be,handleTagsBlur:fe}=Bk({path:e,selectedPaths:t,multi:g,sidecar:v,conflict:_,star:N,queryClient:y,mutateSidecar:Yt,onStarChanged:u,onLocalTypingChange:S}),{metaRaw:ue,metaError:$e,metaState:it,showPilInfo:bt,setMetaError:ft,compareMetaState:on,compareMetaError:ln,compareMetaA:qt,compareMetaB:We,compareIncludePilInfo:je,compareShowPilInfoA:Ct,compareShowPilInfoB:_n,compareExportLabelsText:Wn,compareExportEmbedMetadata:Ri,compareExportMode:z,compareExportError:q,compareExportBusy:te,setShowPilInfo:ge,setCompareIncludePilInfo:we,setCompareShowPilInfoA:Ne,setCompareShowPilInfoB:ae,fetchMetadata:Le,reloadCompareMetadata:Te,handleCompareExportLabelsTextChange:rt,handleCompareExportEmbedMetadataChange:Be,runComparisonExport:ht}=Ok({path:e,sidecarUpdatedAt:v==null?void 0:v.updated_at,selectedPaths:t,compareReady:F,comparePathA:P,comparePathB:B,compareExportSupportsV2:w,compareExportMaxPathsV2:x}),Ue=c.useMemo(()=>{const ce=new Set(t);return n.filter(ye=>ce.has(ye.path))},[n,t]),He=c.useMemo(()=>Ue.reduce((ce,ye)=>ce+(ye.size||0),0),[Ue]);c.useEffect(()=>{if(!e)return;const ce=ye=>{if(qf(ye.target))return;const Ge=ye.key;if(!/^[0-5]$/.test(Ge))return;ye.preventDefault();const Qn=Ge==="0"?null:Number(Ge);if(g&&t.length){Xt({star:Qn}),u==null||u(t,Qn);return}Xt({star:Qn}),u==null||u([e],Qn)};return window.addEventListener("keydown",ce),()=>window.removeEventListener("keydown",ce)},[e,g,t,Xt,u]);const et=ls(e?()=>pe.getThumb(e):null,[e]),Ie=e?e.split("/").pop()||e:"",qr=c.useMemo(()=>{var ye;if(Ie.includes("."))return Ie.slice(Ie.lastIndexOf(".")+1).toUpperCase();const ce=n.find(Ge=>Ge.path===e);return(ye=ce==null?void 0:ce.type)!=null&&ye.includes("/")?ce.type.split("/")[1].toUpperCase():""},[Ie,n,e]),xn=c.useMemo(()=>n.find(ce=>ce.path===e),[n,e]),iu=c.useMemo(()=>e?(xn==null?void 0:xn.source)??e:"",[xn,e]),Rs=c.useMemo(()=>{if(!ue)return"";try{return JSON.stringify(ue,null,1)}catch{return""}},[ue]),Ti=c.useMemo(()=>ac(ue),[ue]),fr=c.useMemo(()=>ac(qt),[qt]),Gr=c.useMemo(()=>ac(We),[We]),Ln=c.useMemo(()=>uc(Ti,bt),[Ti,bt]),Qo=c.useMemo(()=>{if(!qt)return"";try{return JSON.stringify(qt,null,1)}catch{return""}},[qt]),Ko=c.useMemo(()=>{if(!We)return"";try{return JSON.stringify(We,null,1)}catch{return""}},[We]),hr=c.useMemo(()=>uc(fr,Ct),[fr,Ct]),Hn=c.useMemo(()=>uc(Gr,_n),[Gr,_n]),Yo=c.useCallback(()=>{var ce;Rs&&((ce=navigator.clipboard)==null||ce.writeText(Rs).then(()=>{V()}).catch(ye=>{const Ge=ye instanceof Error?ye.message:"Copy failed";ft(Ge)}))},[V,Rs,ft]),ou=c.useMemo(()=>!ke||!Ln?null:co(Ln),[ke,Ln]),lu=c.useMemo(()=>!me||!hr?null:co(hr),[me,hr]),au=c.useMemo(()=>!me||!Hn?null:co(Hn),[me,Hn]),Ii=c.useCallback((ce,ye)=>{var Ge;(Ge=navigator.clipboard)==null||Ge.writeText(ye).then(()=>{G(ce)}).catch(()=>{})},[G]),Jr=c.useCallback((ce,ye,Ge)=>{var Qn;(Qn=navigator.clipboard)==null||Qn.writeText(Ge).then(()=>{ie(ce,ye)}).catch(()=>{})},[ie]),uu=c.useCallback(ce=>{if(!Ln)return;const ye=cc(Ln,ce);Ii(ye.pathLabel,ye.copyText)},[Ln,Ii]),cu=c.useCallback(ce=>{if(!hr)return;const ye=cc(hr,ce);Jr("A",ye.pathLabel,ye.copyText)},[hr,Jr]),_i=c.useCallback(ce=>{if(!Hn)return;const ye=cc(Hn,ce);Jr("B",ye.pathLabel,ye.copyText)},[Hn,Jr]),Xo=c.useCallback(ce=>{var Ge;const ye=ce==="A"?Qo:Ko;ye&&((Ge=navigator.clipboard)==null||Ge.writeText(ye).then(()=>{X(ce)}).catch(()=>{}))},[Qo,Ko,X]);let Ts=Ln?"":"PNG metadata not loaded yet.";it==="loading"?Ts="Loading metadata":it==="error"&&$e&&(Ts=$e);let Li="Metadata not loaded yet.";on==="loading"?Li="Loading metadata":on==="error"&&ln&&(Li=ln);const Ai=it==="loading",Zr=it==="loaded"&&!!Rs,du=Zr?"h-48":"h-24";let pr="Load meta";Ai?pr="Loading":Zr&&(pr=A?"Copied":"Copy");const qo=Zr?Yo:Le,fu=dc(ue),Is=dc(qt),hu=dc(We),pu=c.useMemo(()=>me?JC(fr,Gr,{includePilInfo:je,limit:Qk,maxDepth:Kk,maxArray:Yk}):null,[me,fr,Gr,je]),mu=c.useCallback((ce,ye)=>{var Ge;ye&&((Ge=navigator.clipboard)==null||Ge.writeText(ye).then(()=>{$(ce)}).catch(()=>{}))},[$]),gu=c.useCallback(ce=>{if(g&&t.length){u==null||u(t,ce),ex(t,{star:ce});return}e&&(u==null||u([e],ce),tx(e,{star:ce}))},[g,u,e,t]),vu=c.useCallback(()=>{ge(ce=>!ce)},[ge]),yu=c.useCallback(()=>{we(ce=>!ce)},[we]),xu=c.useCallback(()=>{Ne(ce=>!ce)},[Ne]),wu=c.useCallback(()=>{ae(ce=>!ce)},[ae]),Go=c.useCallback(ce=>{ht(ce)},[ht]),Su=!g&&!!_&&(zt.tags||zt.notes),Jo=!g&&!!_&&zt.star,Zo="toolbar-offset sidebar-resize-handle sidebar-resize-handle-right absolute bottom-0";return C?a.jsxs("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:[!g&&a.jsx("div",{className:"p-3 border-b border-border flex justify-center",children:a.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-border w-[220px] h-[160px] bg-panel select-none",children:[et&&a.jsx("img",{src:et,alt:"thumb",className:"block w-full h-full object-contain"}),!!qr&&a.jsx("div",{className:"absolute top-1.5 left-1.5 bg-surface border border-border text-text text-xs px-1.5 py-0.5 rounded-md select-none",children:qr})]})}),a.jsx(Ek,{open:Q.overview,onToggle:Z,multi:g,selectedCount:t.length,totalSize:He,filename:Ie,compareActive:r,compareReady:F,onOpenCompare:o,compareExportSupportsV2:w,compareExportMaxPathsV2:x,compareExportLabelsText:Wn,onCompareExportLabelsTextChange:rt,compareExportEmbedMetadata:Ri,onCompareExportEmbedMetadataChange:Be,compareExportBusy:te,compareExportMode:z,onComparisonExport:Go,compareExportError:q,onFindSimilar:f,canFindSimilar:b,findSimilarDisabledReason:E}),r&&F&&a.jsx(lx,{open:Q.compare,onToggle:W,compareMetaState:on,compareMetaError:ln,compareLabelA:xe,compareLabelB:qe,compareIncludePilInfo:je,onToggleCompareIncludePilInfo:yu,onReload:Te,compareDiff:pu,compareHasPilInfoA:Is,compareHasPilInfoB:hu,compareShowPilInfoA:Ct,compareShowPilInfoB:_n,onToggleCompareShowPilInfoA:xu,onToggleCompareShowPilInfoB:wu,compareMetaCopied:re,onCopyCompareMetadata:Xo,compareValueCopiedPathA:D,compareValueCopiedPathB:he,compareDisplayNodeA:lu,compareDisplayNodeB:au,compareMetaContent:Li,onCompareMetaPathCopyA:cu,onCompareMetaPathCopyB:_i}),a.jsx(sk,{open:Q.basics,onToggle:I,multi:g,star:N,onSelectStar:gu,hasStarConflict:Jo,onApplyConflict:yn,onKeepTheirs:se,currentItem:xn??null,sourceValue:iu,sortSpec:d,copiedField:Y,onCopyInfo:mu,metricsExpanded:L,onToggleMetricsExpanded:O,metricsPreviewLimit:Hk}),!g&&a.jsx(ax,{open:Q.metadata,onToggle:R,metadataLoading:Ai,metadataActionLabel:pr,onMetadataAction:qo,metadataActionDisabled:!e,hasPilInfo:fu,showPilInfo:bt,onToggleShowPilInfo:vu,metaValueCopiedPath:K,metaHeightClass:du,metaLoaded:Zr,metaDisplayNode:ou,metaContent:Ts,metaError:$e,onMetaPathCopy:uu}),a.jsx(fk,{open:Q.notes,onToggle:T,multi:g,showConflictBanner:Su,onApplyConflict:yn,onKeepTheirs:se,notes:In,onNotesChange:oe,onNotesBlur:Se,tags:dt,onTagsChange:be,onTagsBlur:fe}),a.jsx("div",{className:Zo,onPointerDown:l})]}):a.jsx("div",{className:"app-right-panel col-start-3 row-start-2 border-l border-border bg-panel overflow-auto scrollbar-thin relative",children:a.jsx("div",{className:Zo,onPointerDown:l})})}function qk({open:e,embeddings:t,rejected:n=[],selectedPath:r,embeddingsLoading:s=!1,embeddingsError:i,onClose:o,onSearch:l}){const[u,d]=c.useState(""),[f,p]=c.useState("path"),[h,w]=c.useState(""),[x,S]=c.useState(""),[C,v]=c.useState("50"),[m,y]=c.useState(""),[g,b]=c.useState(null),[E,M]=c.useState(!1),N=c.useRef(null),_=c.useRef(null),P=c.useMemo(()=>t.find(I=>I.name===u)??t[0]??null,[t,u]);c.useEffect(()=>{e&&(b(null),t.length>0&&!t.some(I=>I.name===u)&&d(t[0].name),r?(p("path"),w(r)):(p("vector"),w("")))},[e,t,u,r]),c.useEffect(()=>{if(!e)return;const I=f==="vector"?_.current:N.current,R=window.requestAnimationFrame(()=>I==null?void 0:I.focus());return()=>window.cancelAnimationFrame(R)},[e,f]);const B=c.useCallback(async()=>{if(b(null),!t.length){b("No embeddings available for similarity search.");return}if(!P){b("Select an embedding to search.");return}const I=h.trim(),R=x.trim(),T=Number(C);if(!Number.isFinite(T)||T<=0){b("Top K must be a positive number.");return}const L=Math.min(1e3,Math.max(1,Math.floor(T))),O=m.trim()===""?null:Number(m);if(O!=null&&!Number.isFinite(O)){b("Min score must be a valid number.");return}if(f==="path"&&!I){b("Select an image path for the query.");return}if(f==="vector"&&!R){b("Paste a base64 vector for the query.");return}const Y={embedding:P.name,query_path:f==="path"?I:null,query_vector_b64:f==="vector"?R:null,top_k:L,min_score:O};M(!0);try{await l(Y),o()}catch($){$ instanceof tn||$ instanceof Error?b($.message):b("Failed to run similarity search.")}finally{M(!1)}},[t.length,P,h,x,C,m,f,l,o]);c.useEffect(()=>{if(!e)return;const I=R=>{if(R.key==="Escape"){R.preventDefault(),o();return}(R.ctrlKey||R.metaKey)&&R.key==="Enter"&&(R.preventDefault(),B())};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[e,o,B]);const F=c.useCallback(()=>{var I;r&&(p("path"),w(r),(I=N.current)==null||I.focus())},[r]);if(!e)return null;const Q=t.map(I=>({value:I.name,label:I.name})),Z=n.length>0,W=n.slice(0,3);return a.jsx("div",{className:"fixed inset-0 z-[var(--z-overlay)] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",onClick:I=>{I.target===I.currentTarget&&o()},children:a.jsxs("div",{className:"w-full max-w-2xl rounded-lg border border-border bg-panel shadow-[0_20px_50px_rgba(0,0,0,0.55)]",onClick:I=>I.stopPropagation(),role:"dialog","aria-modal":"true","aria-label":"Find similar",children:[a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-border",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Find similar"}),a.jsx("div",{className:"text-xs text-muted",children:"Search with embeddings"})]}),a.jsx("button",{className:"btn btn-sm",onClick:o,"aria-label":"Close",children:"Close"})]}),a.jsxs("div",{className:"px-4 py-4 space-y-4",children:[i&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:i}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Embedding"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Kf,{value:(P==null?void 0:P.name)??"",onChange:d,options:Q,placeholder:s?"Loading embeddings...":"Select embedding",disabled:!t.length,triggerClassName:"min-w-[180px]"}),P&&a.jsxs("span",{className:"text-xs text-muted",children:[P.dimension," dims, ",P.metric,", ",P.dtype]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Query mode"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",className:`btn btn-sm ${f==="path"?"btn-active":""}`,onClick:()=>p("path"),"aria-pressed":f==="path",children:"Selected image"}),a.jsx("button",{type:"button",className:`btn btn-sm ${f==="vector"?"btn-active":""}`,onClick:()=>p("vector"),"aria-pressed":f==="vector",children:"Vector input"})]})]}),f==="path"?a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Image path"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{ref:N,type:"text",className:"input w-full",value:h,onChange:I=>w(I.target.value),placeholder:r?"Selected image path":"Select an image first"}),a.jsx("button",{type:"button",className:"btn btn-sm",onClick:F,disabled:!r,title:r?"Use selected image":"Select an image first",children:"Use selected"})]})]}):a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Vector (base64 float32)"}),a.jsx("textarea",{ref:_,className:"ui-textarea w-full font-mono text-[11px]",rows:5,value:x,onChange:I=>S(I.target.value),placeholder:"Paste base64-encoded float32 vector"}),a.jsx("div",{className:"text-[11px] text-muted",children:"Base64 of little-endian float32. Length must match embedding dimension."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Top K"}),a.jsx("input",{type:"number",min:1,max:1e3,step:1,className:"input ui-number w-full",value:C,onChange:I=>v(I.target.value)})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"ui-label",children:"Min score"}),a.jsx("input",{type:"number",step:.01,className:"input ui-number w-full",value:m,onChange:I=>y(I.target.value),placeholder:"Optional"})]})]}),Z&&a.jsxs("div",{className:"ui-banner text-xs",children:[a.jsx("div",{className:"font-semibold",children:"Skipped columns"}),a.jsxs("div",{className:"mt-1 space-y-1 text-muted",children:[W.map(I=>a.jsxs("div",{children:[I.name,": ",I.reason]},I.name)),n.length>W.length&&a.jsxs("div",{children:["+",n.length-W.length," more"]})]})]}),g&&a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",role:"alert",children:g})]}),a.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-t border-border",children:[a.jsx("div",{className:"text-xs text-muted",children:P?`Metric: ${P.metric}`:"Metric: cosine"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"btn btn-sm btn-ghost",onClick:o,disabled:E,children:"Cancel"}),a.jsx("button",{className:"btn btn-sm btn-active",onClick:B,disabled:E||!t.length,children:E?"Searching...":"Find similar"})]})]})]})})}const Gk=/^[\/@a-zA-Z0-9._\-\/]{1,512}$/,Jk=[".jpg",".jpeg",".png",".webp"];function Pt(e){try{const t=decodeURI(e||""),r=(t.startsWith("/")?t:`/${t}`).replace(/\/{2,}/g,"/"),s=r.length>1?r.replace(/\/$/,""):r;return Gk.test(s)?s:"/"}catch{return"/"}}function Em(){return(window.location.hash||"").replace(/^#/,"")}function hx(e){const t=Pt(e),n=`#${encodeURI(t)}`;window.location.hash!==n&&(window.location.hash=n)}function Ml(e){const t=Pt(e),n=`#${encodeURI(t)}`;if(window.location.hash!==n){const r=`${window.location.pathname}${window.location.search}${n}`;window.history.replaceState(window.history.state,"",r)}}function Zk(e){const n=Pt(e).toLowerCase();return Jk.some(r=>n.endsWith(r))}function px(e,t){const n=e.replace(/\/+$/,""),r=t.replace(/^\/+/,""),s=[n,r].filter(Boolean).join("/");return s.startsWith("/")?s:`/${s}`}function Nm(e){const n=Pt(e).split("/").filter(Boolean);return n.length<=1?"/":"/"+n.slice(0,-1).join("/")}function eh(e){return Pt(e).split("/").filter(Boolean).pop()||""}function eE(e){return e.endsWith("/_trash_")}const tE=new Set([0,1,2,3,4,5]),th=new Set(["<","<=",">",">="]),nE=/^\d{4}-\d{2}-\d{2}$/;function rE(e,t){return!t||!t.and.length?e:e.filter(n=>sE(n,t.and))}function sE(e,t){for(const n of t)if(!iE(e,n))return!1;return!0}function iE(e,t){var n,r,s,i,o,l,u;if("stars"in t){const d=t.stars;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsIn"in t){const d=t.starsIn.values;if(!d||!d.length)return!0;const f=e.star??0;return d.includes(f)}if("starsNotIn"in t){const d=t.starsNotIn.values;if(!d||!d.length)return!0;const f=e.star??0;return!d.includes(f)}if("nameContains"in t){const d=(n=t.nameContains.value)==null?void 0:n.trim();return d?(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("nameNotContains"in t){const d=(r=t.nameNotContains.value)==null?void 0:r.trim();return d?!(e.name??"").toLowerCase().includes(d.toLowerCase()):!0}if("commentsContains"in t){const d=(s=t.commentsContains.value)==null?void 0:s.trim();if(!d)return!0;const f=e.comments??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("commentsNotContains"in t){const d=(i=t.commentsNotContains.value)==null?void 0:i.trim();if(!d)return!0;const f=e.comments??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("urlContains"in t){const d=(o=t.urlContains.value)==null?void 0:o.trim();if(!d)return!0;const f=e.source??e.url??"";return f?f.toLowerCase().includes(d.toLowerCase()):!1}if("urlNotContains"in t){const d=(l=t.urlNotContains.value)==null?void 0:l.trim();if(!d)return!0;const f=e.source??e.url??"";return f?!f.toLowerCase().includes(d.toLowerCase()):!1}if("dateRange"in t){const{from:d,to:f}=t.dateRange;if(!d&&!f)return!0;if(!e.addedAt)return!1;const p=Date.parse(e.addedAt);if(Number.isNaN(p))return!1;const h=Pm(d,!1),w=Pm(f,!0);return!(h!=null&&p<h||w!=null&&p>w)}if("widthCompare"in t){const{op:d,value:f}=t.widthCompare;if(!Number.isFinite(f))return!0;const p=e.w;return!Number.isFinite(p)||p<=0?!1:Rm(p,d,f)}if("heightCompare"in t){const{op:d,value:f}=t.heightCompare;if(!Number.isFinite(f))return!0;const p=e.h;return!Number.isFinite(p)||p<=0?!1:Rm(p,d,f)}if("metricRange"in t){const{key:d,min:f,max:p}=t.metricRange,h=(u=e.metrics)==null?void 0:u[d];return!(h==null||h<f||h>p)}return!0}function Bd(e){if(!e||typeof e!="object")return null;const t=e.and;if(!Array.isArray(t))return null;const n=[];for(const r of t){const s=wE(r);s&&n.push(s)}return{and:n}}function jm(e){var r;const t=e.and.find(s=>"stars"in s),n=e.and.find(s=>"starsIn"in s);return(r=n==null?void 0:n.starsIn)!=null&&r.values?n.starsIn.values:(t==null?void 0:t.stars)??[]}function mc(e,t){return mx(e,t)}function oE(e){var n;const t=e.and.find(r=>"starsIn"in r);return((n=t==null?void 0:t.starsIn)==null?void 0:n.values)??[]}function mx(e,t){const n=ho(t),r=e.and.filter(s=>!("starsIn"in s)&&!("stars"in s));return n.length?{and:[{starsIn:{values:n}},...r]}:{and:r}}function lE(e){var n;const t=e.and.find(r=>"starsNotIn"in r);return((n=t==null?void 0:t.starsNotIn)==null?void 0:n.values)??[]}function gx(e,t){const n=ho(t),r=e.and.filter(s=>!("starsNotIn"in s));return n.length?{and:[{starsNotIn:{values:n}},...r]}:{and:r}}function aE(e){var n;const t=e.and.find(r=>"nameContains"in r);return((n=t==null?void 0:t.nameContains)==null?void 0:n.value)??null}function vx(e,t){const n=hn(t),r=e.and.filter(s=>!("nameContains"in s));return n?{and:[{nameContains:{value:n}},...r]}:{and:r}}function uE(e){var n;const t=e.and.find(r=>"nameNotContains"in r);return((n=t==null?void 0:t.nameNotContains)==null?void 0:n.value)??null}function yx(e,t){const n=hn(t),r=e.and.filter(s=>!("nameNotContains"in s));return n?{and:[{nameNotContains:{value:n}},...r]}:{and:r}}function cE(e){var n;const t=e.and.find(r=>"commentsContains"in r);return((n=t==null?void 0:t.commentsContains)==null?void 0:n.value)??null}function xx(e,t){const n=hn(t),r=e.and.filter(s=>!("commentsContains"in s));return n?{and:[{commentsContains:{value:n}},...r]}:{and:r}}function dE(e){var n;const t=e.and.find(r=>"commentsNotContains"in r);return((n=t==null?void 0:t.commentsNotContains)==null?void 0:n.value)??null}function wx(e,t){const n=hn(t),r=e.and.filter(s=>!("commentsNotContains"in s));return n?{and:[{commentsNotContains:{value:n}},...r]}:{and:r}}function fE(e){var n;const t=e.and.find(r=>"urlContains"in r);return((n=t==null?void 0:t.urlContains)==null?void 0:n.value)??null}function Sx(e,t){const n=hn(t),r=e.and.filter(s=>!("urlContains"in s));return n?{and:[{urlContains:{value:n}},...r]}:{and:r}}function hE(e){var n;const t=e.and.find(r=>"urlNotContains"in r);return((n=t==null?void 0:t.urlNotContains)==null?void 0:n.value)??null}function bx(e,t){const n=hn(t),r=e.and.filter(s=>!("urlNotContains"in s));return n?{and:[{urlNotContains:{value:n}},...r]}:{and:r}}function pE(e){const t=e.and.find(n=>"dateRange"in n);return(t==null?void 0:t.dateRange)??null}function Ud(e,t){const n=La((t==null?void 0:t.from)??null),r=La((t==null?void 0:t.to)??null),s=e.and.filter(i=>!("dateRange"in i));return!n&&!r?{and:s}:{and:[{dateRange:{...n?{from:n}:{},...r?{to:r}:{}}},...s]}}function mE(e){const t=e.and.find(n=>"widthCompare"in n);return(t==null?void 0:t.widthCompare)??null}function Gl(e,t){const n=e.and.filter(r=>!("widthCompare"in r));return!t||!Number.isFinite(t.value)||!th.has(t.op)?{and:n}:{and:[{widthCompare:{op:t.op,value:t.value}},...n]}}function gE(e){const t=e.and.find(n=>"heightCompare"in n);return(t==null?void 0:t.heightCompare)??null}function Jl(e,t){const n=e.and.filter(r=>!("heightCompare"in r));return!t||!Number.isFinite(t.value)||!th.has(t.op)?{and:n}:{and:[{heightCompare:{op:t.op,value:t.value}},...n]}}function vE(e,t){const n=e.and.find(r=>"metricRange"in r&&r.metricRange.key===t);return(n==null?void 0:n.metricRange)??null}function yE(e,t,n){const r=e.and.filter(s=>!("metricRange"in s&&s.metricRange.key===t));return n?{and:[{metricRange:{key:t,min:n.min,max:n.max}},...r]}:{and:r}}function xE(e){const t=Bd(e);return t?t.and.length:0}function wE(e){var t,n,r,s,i,o,l,u;if(!e||typeof e!="object")return null;if("stars"in e){const d=ho(e.stars);return d.length?{starsIn:{values:d}}:null}if("starsIn"in e){const d=ho((t=e.starsIn)==null?void 0:t.values);return d.length?{starsIn:{values:d}}:null}if("starsNotIn"in e){const d=ho((n=e.starsNotIn)==null?void 0:n.values);return d.length?{starsNotIn:{values:d}}:null}if("nameContains"in e){const d=hn((r=e.nameContains)==null?void 0:r.value);return d?{nameContains:{value:d}}:null}if("nameNotContains"in e){const d=hn((s=e.nameNotContains)==null?void 0:s.value);return d?{nameNotContains:{value:d}}:null}if("commentsContains"in e){const d=hn((i=e.commentsContains)==null?void 0:i.value);return d?{commentsContains:{value:d}}:null}if("commentsNotContains"in e){const d=hn((o=e.commentsNotContains)==null?void 0:o.value);return d?{commentsNotContains:{value:d}}:null}if("urlContains"in e){const d=hn((l=e.urlContains)==null?void 0:l.value);return d?{urlContains:{value:d}}:null}if("urlNotContains"in e){const d=hn((u=e.urlNotContains)==null?void 0:u.value);return d?{urlNotContains:{value:d}}:null}if("dateRange"in e){const d=e.dateRange,f=La((d==null?void 0:d.from)??null),p=La((d==null?void 0:d.to)??null);return!f&&!p?null:{dateRange:{...f?{from:f}:{},...p?{to:p}:{}}}}if("widthCompare"in e){const d=e.widthCompare,f=Mm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{widthCompare:f}:null}if("heightCompare"in e){const d=e.heightCompare,f=Mm(d==null?void 0:d.op,d==null?void 0:d.value);return f?{heightCompare:f}:null}if("metricRange"in e){const d=e.metricRange;if(!d||typeof d!="object")return null;const f=typeof d.key=="string"?d.key:"",p=Vd(d.min),h=Vd(d.max);return!f||p==null||h==null||p>h?null:{metricRange:{key:f,min:p,max:h}}}return null}function ho(e){if(!Array.isArray(e))return[];const t=[],n=new Set;for(const r of e){const s=typeof r=="number"?r:typeof r=="string"?Number(r):NaN;!Number.isInteger(s)||!tE.has(s)||n.has(s)||(n.add(s),t.push(s))}return t}function hn(e){if(typeof e!="string")return null;const t=e.trim();return t||null}function La(e){if(typeof e!="string")return null;const t=e.trim();if(!t)return null;const n=Date.parse(t);return Number.isNaN(n)?null:t}function Mm(e,t){if(typeof e!="string"||!th.has(e))return null;const n=Vd(t);return n==null?null:{op:e,value:n}}function Pm(e,t){if(!e)return null;const n=e.trim();if(!n)return null;const r=Date.parse(n);return Number.isNaN(r)?null:t&&nE.test(n)?r+24*60*60*1e3-1:r}function Rm(e,t,n){switch(t){case"<":return e<n;case"<=":return e<=n;case">":return e>n;case">=":return e>=n;default:return!0}}function Vd(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null}const as={leftFolders:"leftW.folders",leftMetrics:"leftW.metrics",leftLegacy:"leftW",right:"rightW"},Tm=200,Im=240,Cx=200;function SE(e){return Number.isFinite(e)&&e>0}function Pl(e){const t=Number(e);return SE(t)?t:null}function kx(e,t,n){return Math.min(Math.max(e,t),n)}function bE(e){return e==="metrics"?as.leftMetrics:as.leftFolders}function CE(e){const t=Pl(e.getItem(as.leftFolders))??Pl(e.getItem(as.leftLegacy)),n=Pl(e.getItem(as.leftMetrics)),r=Pl(e.getItem(as.right));return{leftFoldersW:t,leftMetricsW:n,rightW:r}}function _m(e,t,n){e.setItem(t,String(n))}function kE({clientX:e,appLeft:t,appWidth:n,rightWidth:r}){const s=e-t,i=Math.max(Tm,n-r-Cx);return kx(s,Tm,i)}function EE({clientX:e,appLeft:t,appWidth:n,leftWidth:r}){const s=e-t,i=n-s,o=Math.max(Im,n-r-Cx);return kx(i,Im,o)}function NE(e){return(e.pointerType??"mouse")==="mouse"&&e.button!==0}function jE(e,t){try{e.setPointerCapture(t)}catch{}}function ME(e,t){try{e.releasePointerCapture(t)}catch{}}function PE(e,t){const[n,r]=c.useState(240),[s,i]=c.useState(320),[o,l]=c.useState(240),u=t==="metrics"?s:n,d=c.useRef(u),f=c.useRef(o);c.useEffect(()=>{d.current=u},[u]),c.useEffect(()=>{f.current=o},[o]),c.useEffect(()=>{try{const x=CE(window.localStorage);x.leftFoldersW!==null&&r(x.leftFoldersW),x.leftMetricsW!==null&&i(x.leftMetricsW),x.rightW!==null&&l(x.rightW)}catch{}},[]);const p=(x,S,C)=>{if(NE(x))return;x.preventDefault();const v=x.currentTarget,m=x.pointerId;jE(v,m);const y=E=>{E.pointerId===m&&S(E)};function g(){window.removeEventListener("pointermove",y),window.removeEventListener("pointerup",b),window.removeEventListener("pointercancel",b),ME(v,m)}function b(E){E.pointerId===m&&(g(),C())}window.addEventListener("pointermove",y),window.addEventListener("pointerup",b),window.addEventListener("pointercancel",b)};return{leftW:u,rightW:o,onResizeLeft:x=>{const S=e.current;if(!S)return;const C=S.getBoundingClientRect(),v=bE(t);let m=d.current;p(x,y=>{const g=kE({clientX:y.clientX,appLeft:C.left,appWidth:C.width,rightWidth:f.current});m=g,t==="metrics"?i(g):r(g)},()=>{try{_m(window.localStorage,v,m)}catch{}})},onResizeRight:x=>{const S=e.current;if(!S)return;const C=S.getBoundingClientRect();let v=f.current;p(x,m=>{const y=EE({clientX:m.clientX,appLeft:C.left,appWidth:C.width,leftWidth:d.current});v=y,f.current=y,l(y)},()=>{try{_m(window.localStorage,as.right,v)}catch{}})}}}const Ex=1,Zl=200,RE=5*6e4,TE=6e4,Nx=(e,t)=>t!=null&&t.recursive?["folder",e,"recursive",t.page??Ex,t.pageSize??Zl]:["folder",e];function jx(e){return e[0]!=="folder"||e[2]!=="recursive"||typeof e[1]!="string"||typeof e[3]!="number"||typeof e[4]!="number"?null:e}function IE(e){return jx(e)!==null}function _E(e,t,n=!0){if(!IE(e))return!0;const r=jx(e);if(r==null)return!1;const[,s,,i]=r;return i!==Ex?!1:!!(s===t||n&&s==="/")}function LE(e,t,n=!0){return!Array.isArray(e)||e[0]!=="folder"?!1:!_E(e,t,n)}const AE=15e3;function FE(e,t){return pe.getFolder(e,t)}function Wd(e,t=!1,n){const r=nu(),s={recursive:t,page:n==null?void 0:n.page,pageSize:n==null?void 0:n.pageSize,legacyRecursive:n==null?void 0:n.legacyRecursive},i=!!s.recursive;return Za({queryKey:Nx(e,s),queryFn:()=>FE(e,s),enabled:(n==null?void 0:n.enabled)??!0,staleTime:1e4,gcTime:i?TE:RE,retry:2,retryDelay:o=>Math.min(1e3*Math.pow(2,o),5e3),refetchOnWindowFocus:!1,refetchInterval:r?AE:!1,refetchIntervalInBackground:r})}const Mx="application/x-lenslet-paths",OE='[role="treeitem"].drop-target';function Lm(e){var n;return Array.from(((n=e.dataTransfer)==null?void 0:n.types)||[]).includes(Mx)}function DE(e){document.querySelectorAll(OE).forEach(t=>{t!==e&&t.classList.remove("drop-target")})}function Am(e){DE(e),e.classList.add("drop-target")}function Fm(e){return e.startsWith("/")?e:`/${e}`}function zE({path:e,isLeaf:t}){const n=dr(),r=c.useCallback(l=>{Lm(l)&&(l.preventDefault(),t&&Am(l.currentTarget))},[t]),s=c.useCallback(l=>{!t||!Lm(l)||(l.preventDefault(),Am(l.currentTarget))},[t]),i=c.useCallback(l=>{const u=l.currentTarget,d=document.elementFromPoint(l.clientX,l.clientY);d&&u.contains(d)||u.classList.remove("drop-target")},[]),o=c.useCallback(async l=>{const u=l.dataTransfer;if(!u)return;l.preventDefault(),l.currentTarget.classList.remove("drop-target");const d=u.getData(Mx),p=(d?JSON.parse(d):[]).filter(Boolean);if(!p.length)return;let h=p[0].split("/").slice(0,-1).join("/")||"/";h=Fm(h);const w=Fm(e);try{for(const x of p)await pe.moveFile(x,w);n.invalidateQueries({queryKey:["folder",h]}),n.invalidateQueries({queryKey:["folder",w]}),n.setQueryData(["folder",h],x=>!x||!Array.isArray(x.items)?x:{...x,items:x.items.filter(S=>!p.includes(S.path))})}catch{}},[e,n]);return{onDragOver:r,onDragEnter:s,onDragLeave:i,onDrop:o}}const $E='[role="tree"] [role="treeitem"]';function BE(){return Array.from(document.querySelectorAll($E))}function UE(e,t){var i;const n=BE(),r=n.findIndex(o=>o===e);if(r===-1)return;let s=r;t==="ArrowDown"?s=Math.min(n.length-1,r+1):t==="ArrowUp"?s=Math.max(0,r-1):t==="Home"?s=0:t==="End"&&(s=n.length-1),(i=n[s])==null||i.focus()}function VE({path:e,isLeaf:t,isExpanded:n,setExpanded:r,onOpen:s}){return c.useCallback(i=>{if(i.key==="Enter"){i.preventDefault(),s(e);return}if(i.key==="ArrowRight"){!t&&!n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.add(e),l}));return}if(i.key==="ArrowLeft"){!t&&n&&(i.preventDefault(),r(o=>{const l=new Set(o);return l.delete(e),l}));return}(i.key==="ArrowDown"||i.key==="ArrowUp"||i.key==="Home"||i.key==="End")&&(i.preventDefault(),UE(i.currentTarget,i.key))},[e,t,n,r,s])}const Om=64,WE=120;function HE(e){const t=e.split("/").filter(Boolean),n=["/"];let r="";for(const s of t)r=r?`${r}/${s}`:`/${s}`,n.push(r);return n}function QE({current:e,roots:t,data:n,onOpen:r,onPullRefresh:s,onResize:i,onContextMenu:o,onOpenActions:l,countVersion:u,className:d,showResizeHandle:f=!0}){const[p,h]=c.useState(new Set(["/"])),w=c.useRef(new Map),x=c.useRef(new Map),[S,C]=c.useState(!1),[v,m]=c.useState(0),y=c.useRef(null),g=c.useRef(!1),b=dr(),E=c.useCallback(()=>{m(0),y.current=null,g.current=!1},[]),M=c.useCallback(async R=>{const T=Pt(R||"/"),L=w.current,O=x.current,Y=L.get(T);if(Y!==void 0)return Y;const $=b.getQueryData(Nx(T,{recursive:!0}));if($){const K=$.totalItems??$.items.length;return L.set(T,K),K}const A=O.get(T);if(A)return A;const V=(async()=>{try{const K=await pe.getFolder(T,{recursive:!0}),G=K.totalItems??K.items.length;return L.set(T,G),G}finally{O.delete(T)}})();return O.set(T,V),V},[b]);c.useEffect(()=>{w.current.clear(),x.current.clear()},[u]),c.useEffect(()=>{const R=HE(e);h(T=>{const L=new Set(T);for(const O of R)L.add(O);return L})},[e]);const N=c.useCallback(async()=>{if(!(!s||S)){C(!0);try{await s()}catch(R){console.error("Failed to refresh folders:",R)}finally{C(!1),m(0)}}},[s,S]),_=c.useCallback(R=>{!s||S||R.touches.length===1&&(R.currentTarget.scrollTop>0||(y.current=R.touches[0].clientY,g.current=!1))},[s,S]),P=c.useCallback(R=>{if(!s||S||R.touches.length!==1)return;const T=y.current;if(T==null)return;if(R.currentTarget.scrollTop>0){E();return}const L=R.touches[0].clientY-T;if(L<=0){g.current&&m(0);return}!g.current&&L<8||(g.current=!0,R.preventDefault(),m(Math.min(WE,L*.55)))},[S,s,E]),B=c.useCallback(()=>{if(!s||S){E();return}const R=g.current&&v>=Om;if(y.current=null,g.current=!1,R){N();return}m(0)},[N,S,s,v,E]),F=d??"h-full overflow-auto bg-panel scrollbar-thin",Q=s?`${F} overscroll-y-contain`:F,Z=!!s&&(S||v>0),W=v>=Om,I=S?28:Math.min(44,v);return a.jsxs("div",{className:Q,onTouchStart:s?_:void 0,onTouchMove:s?P:void 0,onTouchEnd:s?B:void 0,onTouchCancel:s?B:void 0,children:[Z&&a.jsx("div",{className:"flex items-end justify-center text-[11px] text-muted select-none transition-[height,opacity] duration-150",style:{height:I,opacity:S||v>8?1:.65},"aria-live":"polite",children:S?"Refreshing":W?"Release to refresh":"Pull to refresh"}),a.jsx("div",{className:"p-1",role:"tree","aria-label":"Folders",children:t.map(R=>a.jsx(Px,{path:R.path,label:R.label,depth:0,current:e,expanded:p,setExpanded:h,onOpen:r,onContextMenu:o,onOpenActions:l,initial:n,getSubtreeCount:M,countVersion:u},R.path))}),f&&a.jsx("div",{className:"toolbar-offset sidebar-resize-handle absolute bottom-0 left-[calc(var(--left)-6px)]",onPointerDown:i})]})}function Px({path:e,label:t,depth:n,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:u,initial:d,getSubtreeCount:f,countVersion:p}){var F;const h=s.has(e),w=r===e,x=e==="/"||h||w,{data:S}=Wd(e,!1,{enabled:x}),C=d&&e===d.path?d:S,m=!!C?C.dirs.length===0:!1,[y,g]=c.useState(C?C.items.length:null),b=VE({path:e,isLeaf:m,isExpanded:h,setExpanded:i,onOpen:o}),{onDragOver:E,onDragEnter:M,onDragLeave:N,onDrop:_}=zE({path:e,isLeaf:m}),P=Q=>{Q.stopPropagation(),!m&&i(Z=>{const W=new Set(Z);return W.has(e)?W.delete(e):W.add(e),W})},B=Q=>{if(Q.stopPropagation(),!u)return;const Z=Q.currentTarget.getBoundingClientRect();u(e,{x:Z.right-4,y:Z.bottom-4})};return c.useEffect(()=>{let Q=!1;if(!C){g(null);return}if(g(C.items.length),!!(h&&(n>0||w)))return f(e).then(W=>{Q||g(W)}).catch(W=>{Q||console.warn(`Failed to compute subtree count for ${e}:`,W)}),()=>{Q=!0}},[C,e,f,p,h,n,w]),a.jsxs("div",{children:[a.jsxs("div",{className:`tree-row flex items-center gap-1.5 py-1 px-2 rounded-md cursor-pointer min-h-[40px] outline-none transition-colors duration-75 ${w?"bg-accent/20 text-accent font-medium":"hover:bg-white/5 text-text"}`,role:"treeitem","aria-level":n+1,"aria-expanded":m?void 0:h,"aria-selected":w,tabIndex:w?0:-1,style:{paddingLeft:8+n*14},onClick:()=>o(e),onContextMenu:Q=>{Q.preventDefault(),Q.stopPropagation(),l==null||l(Q,e)},onKeyDown:b,onDragOver:E,onDragEnter:M,onDragLeave:N,onDrop:_,children:[a.jsx("button",{type:"button",className:"tree-expand-btn touch-manipulation",onClick:P,"aria-label":m?`No subfolders in ${t}`:`${h?"Collapse":"Expand"} ${t}`,"aria-expanded":m?void 0:h,disabled:m,children:m?"":h?"":""}),a.jsx("span",{className:"flex-1 overflow-hidden truncate text-sm",title:t,children:ZC(t,28)}),y!==null&&a.jsx("span",{className:"text-[10px] opacity-50 bg-white/5 border border-white/5 rounded px-1.5 min-w-[24px] text-center",children:y}),u&&a.jsx("button",{type:"button",className:"tree-row-action-btn touch-manipulation","aria-label":`Open actions for ${t}`,"aria-haspopup":"menu",onPointerDown:Q=>Q.stopPropagation(),onClick:B,children:a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("circle",{cx:"12",cy:"5",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"12",r:"1.5"}),a.jsx("circle",{cx:"12",cy:"19",r:"1.5"})]})})]}),h&&((F=C==null?void 0:C.dirs)==null?void 0:F.map(Q=>a.jsx(Px,{path:px(e,Q.name),label:Q.name,depth:n+1,current:r,expanded:s,setExpanded:i,onOpen:o,onContextMenu:l,onOpenActions:u,getSubtreeCount:f,countVersion:p},Q.name)))]})}const Dm=[5,4,3,2,1],zm=["<","<=",">",">="];function KE({filters:e,onChangeFilters:t}){const n=c.useMemo(()=>oE(e),[e]),r=c.useMemo(()=>lE(e),[e]),s=c.useMemo(()=>aE(e)??"",[e]),i=c.useMemo(()=>uE(e)??"",[e]),o=c.useMemo(()=>cE(e)??"",[e]),l=c.useMemo(()=>dE(e)??"",[e]),u=c.useMemo(()=>fE(e)??"",[e]),d=c.useMemo(()=>hE(e)??"",[e]),f=c.useMemo(()=>pE(e)??{},[e]),p=c.useMemo(()=>$m(f.from),[f.from]),h=c.useMemo(()=>$m(f.to),[f.to]),w=c.useMemo(()=>mE(e),[e]),x=c.useMemo(()=>gE(e),[e]),[S,C]=c.useState((w==null?void 0:w.op)??">="),[v,m]=c.useState((x==null?void 0:x.op)??">=");c.useEffect(()=>{w!=null&&w.op&&C(w.op)},[w==null?void 0:w.op]),c.useEffect(()=>{x!=null&&x.op&&m(x.op)},[x==null?void 0:x.op]);const y=(g,b)=>{const E=new Set(n),M=new Set(r);g==="include"?E.has(b)?E.delete(b):(E.add(b),M.delete(b)):M.has(b)?M.delete(b):(M.add(b),E.delete(b));let N=mx(e,Array.from(E));N=gx(N,Array.from(M)),t(N)};return a.jsxs("div",{className:"ui-card",children:[a.jsx("div",{className:"ui-section-title mb-3",children:"Attributes"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Rating"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Include"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[Dm.map(g=>{const b=n.includes(g);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${b?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>y("include",g),"aria-pressed":b,title:`Include ${g} star${g>1?"s":""}`,children:[g,""]},`stars-in-${g}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${n.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>y("include",0),"aria-pressed":n.includes(0),title:"Include unrated",children:"None"})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-label",children:"Exclude"}),a.jsxs("div",{className:"flex flex-wrap gap-1",children:[Dm.map(g=>{const b=r.includes(g);return a.jsxs("button",{className:`h-7 min-w-[32px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${b?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>y("exclude",g),"aria-pressed":b,title:`Exclude ${g} star${g>1?"s":""}`,children:[g,""]},`stars-out-${g}`)}),a.jsx("button",{className:`h-7 min-w-[48px] px-2 rounded-lg border text-[11px] flex items-center justify-center transition-colors ${r.includes(0)?"bg-accent-muted text-star-active border-border":"bg-surface text-text border-border/70 hover:bg-surface-hover"}`,onClick:()=>y("exclude",0),"aria-pressed":r.includes(0),title:"Exclude unrated",children:"None"})]})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Filename"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:s,placeholder:"e.g. draft",onChange:g=>t(vx(e,g.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:i,placeholder:"e.g. v1",onChange:g=>t(yx(e,g.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Comments"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:o,placeholder:"e.g. hero",onChange:g=>t(xx(e,g.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:l,placeholder:"e.g. todo",onChange:g=>t(wx(e,g.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"URL"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Contains"}),a.jsx("input",{className:"ui-input w-full",value:u,placeholder:"e.g. s3://bucket",onChange:g=>t(Sx(e,g.target.value))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Does not contain"}),a.jsx("input",{className:"ui-input w-full",value:d,placeholder:"e.g. http://",onChange:g=>t(bx(e,g.target.value))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Date Added"}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"From"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:p,onChange:g=>t(Ud(e,{from:g.target.value||null,to:f.to??null}))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"To"}),a.jsx("input",{type:"date",className:"ui-input w-full",value:h,onChange:g=>t(Ud(e,{from:f.from??null,to:g.target.value||null}))})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"ui-subsection-title mb-2",children:"Dimensions"}),a.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Width"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:S,onChange:g=>{const b=g.target.value;C(b),w&&t(Gl(e,{op:b,value:w.value}))},children:zm.map(g=>a.jsx("option",{value:g,children:g},`w-${g}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:w?String(w.value):"",min:0,placeholder:"px",onChange:g=>{const b=g.target.value;if(!b){t(Gl(e,null));return}const E=Number(b);Number.isFinite(E)&&t(Gl(e,{op:S,value:E}))}})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Height"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("select",{className:"ui-select ui-select-compact w-16",value:v,onChange:g=>{const b=g.target.value;m(b),x&&t(Jl(e,{op:b,value:x.value}))},children:zm.map(g=>a.jsx("option",{value:g,children:g},`h-${g}`))}),a.jsx("input",{type:"number",className:"ui-input ui-number w-full",value:x?String(x.value):"",min:0,placeholder:"px",onChange:g=>{const b=g.target.value;if(!b){t(Jl(e,null));return}const E=Number(b);Number.isFinite(E)&&t(Jl(e,{op:v,value:E}))}})]})]})]})]})]})]})}function $m(e){return e?e.length>=10?e.slice(0,10):e:""}const YE=[];function Hd(e,t){if(t!=null&&t.length)return XE(e,t);const n=new Map;for(const r of e){const s=r.metrics;if(s)for(const[i,o]of Object.entries(s)){if(o==null||Number.isNaN(o))continue;const l=n.get(i);l?l.push(o):n.set(i,[o])}}return n}function XE(e,t){const n=t.map(s=>({key:s,values:[]}));for(const s of e){const i=s.metrics;if(i)for(const o of n){const l=i[o.key];l==null||Number.isNaN(l)||o.values.push(l)}}const r=new Map;for(const s of n)s.values.length&&r.set(s.key,s.values);return r}function Fs(e,t){return e.get(t)??YE}function gc(e,t,n){if(!e.length)return null;const r=n?n.min:Math.min(...e);let s=n?n.max:Math.max(...e);r===s&&(s=r+1);const i=new Array(t).fill(0),o=t/(s-r);for(const l of e){const u=Math.max(0,Math.min(t-1,Math.floor((l-r)*o)));i[u]+=1}return{bins:i,min:r,max:s,count:e.length}}function Rx(e,t){return e<t?{min:e,max:t}:{min:t,max:e}}function Gt(e){return rx(e)}function vr(e){if(!Number.isFinite(e))return"";const t=e.toString();return t.includes("e")?e.toFixed(6):t}function Bm(e){const t=e.trim();if(!t)return{value:null,valid:!0};const n=Number(t);return Number.isFinite(n)?{value:n,valid:!0}:{value:null,valid:!1}}function Um(e,t,n){return e<t?t:e>n?n:e}function nh(e){return e<0?0:e>1?1:e}function Os(e,t){const n=Math.max(1,Math.abs(e),Math.abs(t));return Math.abs(e-t)<=1e-6*n}function qE(e,t,n){const r=nh((e-t.left)/t.width);return n.min+(n.max-n.min)*r}function GE(e,t,n=4){return e==null?!1:Math.abs(t-e)>=n}function Tx(e,t){return Rx(e??t,t)}function JE(e,t,n,r){return e&&t!=null?{commitRange:Tx(n,t),shouldClear:!1}:{commitRange:null,shouldClear:r!=null}}function ZE({metricKey:e,domain:t,activeRange:n,onChangeRange:r}){const[s,i]=c.useState(null),[o,l]=c.useState(!1),u=c.useRef(null),d=c.useRef(null),f=c.useRef(!1),p=c.useRef(null),[h,w]=c.useState(null),x=s??n;c.useEffect(()=>{w(null)},[e,t==null?void 0:t.min,t==null?void 0:t.max]);const S=y=>{var b;if(!t)return null;const g=(b=p.current)==null?void 0:b.getBoundingClientRect();return g?qE(y,{left:g.left,width:g.width},t):null};return{svgRef:p,hoverValue:h,displayRange:x,onPointerDown:y=>{var b;if(!t)return;y.preventDefault();const g=S(y.clientX);g!=null&&(l(!0),i(null),u.current=g,d.current=y.clientX,f.current=!1,w(g),(b=p.current)==null||b.setPointerCapture(y.pointerId))},onPointerMove:y=>{const g=S(y.clientX);if(g==null){o||w(null);return}w(g),o&&(!f.current&&!GE(d.current,y.clientX)||(f.current=!0,i(Tx(u.current,g))))},onPointerUp:y=>{var E;if(!o)return;l(!1),(E=p.current)==null||E.releasePointerCapture(y.pointerId);const g=S(y.clientX),b=JE(f.current,g,u.current,n);b.commitRange?(w(g),r(b.commitRange)):b.shouldClear&&r(null),u.current=null,d.current=null,f.current=!1,setTimeout(()=>i(null),0)},onPointerLeave:()=>w(null)}}const us=40;function Vm({metricKey:e,populationValues:t,filteredValues:n,selectedValues:r=[],filters:s,onChangeRange:i,showTitle:o=!1}){const l=c.useMemo(()=>gc(t,us),[t]),u=c.useMemo(()=>l?gc(n,us,l):null,[n,l]),d=vE(s,e),f=l?{min:l.min,max:l.max}:null,{svgRef:p,hoverValue:h,displayRange:w,onPointerDown:x,onPointerMove:S,onPointerUp:C,onPointerLeave:v}=ZE({metricKey:e,domain:f,activeRange:d,onChangeRange:F=>i(e,F)}),[m,y]=c.useState(""),[g,b]=c.useState(""),[E,M]=c.useState(null),N=r.length===1?r[0]:null,_=c.useMemo(()=>!l||r.length<2?null:gc(r,us,l),[r,l]);c.useEffect(()=>{if(!d||!f){E!=="min"&&y(d?vr(d.min):""),E!=="max"&&b(d?vr(d.max):"");return}if(E!=="min"){const F=Os(d.min,f.min)?"":vr(d.min);y(F)}if(E!=="max"){const F=Os(d.max,f.max)?"":vr(d.max);b(F)}},[d,f,E]);const P=(F,Q)=>{if(!f)return;const Z=Bm(F),W=Bm(Q);if(!Z.valid||!W.valid){Z.valid||y(d?vr(d.min):""),W.valid||b(d?vr(d.max):"");return}if(Z.value==null&&W.value==null){i(e,null);return}const I=Z.value??f.min,R=W.value??f.max,T=Um(I,f.min,f.max),L=Um(R,f.min,f.max),O=Rx(T,L);if(Os(O.min,f.min)&&Os(O.max,f.max)){i(e,null);return}i(e,O)};if(!l||!f)return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]});const B=r.length;return a.jsxs("div",{className:"ui-card",children:[o&&a.jsx("div",{className:"ui-section-title mb-2",children:e}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mb-2 tabular-nums",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("span",{children:["Population: ",l.count]}),a.jsxs("span",{children:["Filtered: ",(u==null?void 0:u.count)??0]}),B>1&&a.jsxs("span",{className:"text-text",children:["Selected: ",B]})]}),N!=null&&a.jsxs("span",{className:"text-text",children:["Selected: ",Gt(N)]})]}),a.jsxs("svg",{ref:p,viewBox:`0 0 ${us} 100`,preserveAspectRatio:"none",className:"w-full h-28 cursor-crosshair rounded-md bg-surface-inset",onPointerDown:x,onPointerMove:S,onPointerUp:C,onPointerLeave:v,children:[vc(l.bins,"#2e3a4b"),u&&vc(u.bins,"#3a8fff"),_&&vc(_.bins,"#f59e0b",{opacity:.55}),w&&eN(w,f),N!=null&&Wm(N,f,{color:"var(--highlight)",strokeWidth:.7}),h!=null&&Wm(h,f,{color:"rgba(255,255,255,0.75)",strokeWidth:.5,dashed:!0})]}),a.jsxs("div",{className:"flex items-center justify-between text-[11px] text-muted mt-2 tabular-nums",children:[a.jsx("span",{children:Gt(f.min)}),a.jsxs("div",{className:"flex flex-col items-center text-center leading-tight",children:[w?a.jsx("span",{className:"text-text",children:Os(w.min,f.min)?` ${Gt(w.max)}`:Os(w.max,f.max)?` ${Gt(w.min)}`:`${Gt(w.min)}  ${Gt(w.max)}`}):h!=null?a.jsxs("span",{className:"text-text",children:["Cursor: ",Gt(h)]}):a.jsx("span",{children:"Drag to filter"}),w&&h!=null&&a.jsxs("span",{className:"text-[11px] text-muted",children:["Cursor: ",Gt(h)]})]}),a.jsx("span",{children:Gt(f.max)})]}),a.jsxs("div",{className:"grid grid-cols-[1fr_1fr_auto] gap-2 mt-3 items-end",children:[a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Min"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:m,placeholder:vr(f.min),onFocus:()=>M("min"),onBlur:()=>{M(null),P(m,g)},onChange:F=>y(F.target.value),onKeyDown:F=>{F.key==="Enter"&&F.currentTarget.blur()}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"ui-label",children:"Max"}),a.jsx("input",{type:"number",step:"any",className:"ui-input ui-number w-full",value:g,placeholder:vr(f.max),onFocus:()=>M("max"),onBlur:()=>{M(null),P(m,g)},onChange:F=>b(F.target.value),onKeyDown:F=>{F.key==="Enter"&&F.currentTarget.blur()}})]}),a.jsx("button",{className:"btn btn-xs btn-ghost text-muted hover:text-text",onClick:()=>i(e,null),children:"Clear"})]})]})}function vc(e,t,n){const r=Math.max(1,...e),s=(n==null?void 0:n.opacity)??.9;return e.map((i,o)=>{const l=i/r*100;return a.jsx("rect",{x:o+.05,y:100-l,width:.9,height:l,fill:t,opacity:s},`${t}-${o}`)})}function eN(e,t){const n=(e.min-t.min)/(t.max-t.min),r=(e.max-t.min)/(t.max-t.min),s=us*nh(Math.min(n,r)),i=us*Math.abs(r-n);return a.jsx("rect",{x:s,y:0,width:Math.max(.5,i),height:100,fill:"rgba(255,255,255,0.08)",stroke:"rgba(255,255,255,0.4)",strokeWidth:.4})}function Wm(e,t,n){const r=nh((e-t.min)/(t.max-t.min)),s=us*r;return a.jsx("line",{x1:s,y1:0,x2:s,y2:100,stroke:n.color,strokeWidth:n.strokeWidth??.5,strokeDasharray:n.dashed?"1.2 1.2":void 0,opacity:.95,vectorEffect:"non-scaling-stroke"})}const tN=new Map;function nN({items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}){const[u,d]=c.useState(!1),f=s&&n.includes(s)?s:n[0],p=c.useMemo(()=>u?n:f?[f]:[],[u,n,f]),h=c.useMemo(()=>Hd(e,p),[e,p]),w=c.useMemo(()=>Hd(t,p),[t,p]),x=r??tN;return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("label",{className:"ui-label",children:"Metric"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-[11px]",onClick:()=>d(S=>!S),"aria-pressed":u,children:u?"Show one":"Show all"})]}),u?a.jsx("div",{className:"ui-input ui-input-readonly w-full flex items-center text-xs",children:"All metrics"}):a.jsx("select",{className:"ui-select w-full",value:f,onChange:S=>i(S.target.value),children:n.map(S=>a.jsx("option",{value:S,children:S},S))})]}),u?a.jsx("div",{className:"space-y-3",children:n.map(S=>a.jsx(Vm,{metricKey:S,populationValues:Fs(h,S),filteredValues:Fs(w,S),selectedValues:Fs(x,S),filters:o,onChangeRange:l,showTitle:!0},S))}):f?a.jsx(Vm,{metricKey:f,populationValues:Fs(h,f),filteredValues:Fs(w,f),selectedValues:Fs(x,f),filters:o,onChangeRange:l}):a.jsx("div",{className:"text-sm text-muted",children:"No values found for this metric."})]})}const rN=12;function sN({items:e,filteredItems:t,metricKeys:n,selectedItems:r,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l,onChangeFilters:u}){const d=c.useMemo(()=>r!=null&&r.length?Hd(r,n):null,[r,n]),f=d&&r&&r.length?a.jsx(iN,{selectedValuesByKey:d,totalItems:r.length,metricKeys:n}):null,p=a.jsx(KE,{filters:o,onChangeFilters:u});return n.length?a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,a.jsx(nN,{items:e,filteredItems:t,metricKeys:n,selectedValuesByKey:d,selectedMetric:s,onSelectMetric:i,filters:o,onChangeRange:l}),p]}):a.jsxs("div",{className:"h-full flex flex-col gap-3 p-3 overflow-auto scrollbar-thin",children:[f,p,a.jsx("div",{className:"p-4 text-sm text-muted",children:"No metrics found in this dataset."})]})}function iN({selectedValuesByKey:e,totalItems:t,metricKeys:n}){const r=c.useMemo(()=>e.size?{entries:(n.length?n.filter(p=>e.has(p)):Array.from(e.keys()).sort()).map(p=>{const h=e.get(p)??[],w=Math.min(...h),x=Math.max(...h),S=h.reduce((C,v)=>C+v,0)/Math.max(1,h.length);return{key:p,value:h[0],min:w,max:x,avg:S,count:h.length}}),totalItems:t}:null,[e,n,t]);if(!r)return null;const{entries:s,totalItems:i}=r,o=s.slice(0,rN),l=s.length-o.length,u=i>1;return a.jsxs("div",{className:"ui-card",children:[a.jsxs("div",{className:"ui-card-header",children:[a.jsx("div",{className:"ui-section-title",children:"Selected metrics"}),a.jsxs("div",{className:"text-[11px] text-muted",children:[i," item",i===1?"":"s"]})]}),a.jsxs("div",{className:"space-y-1 text-[12px]",children:[o.map(d=>a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-muted w-28 shrink-0 truncate",title:d.key,children:d.key}),a.jsxs("span",{className:"font-mono text-text text-right tabular-nums",children:[u?`${Gt(d.min)}  ${Gt(d.max)}`:Gt(d.value),u&&a.jsxs("span",{className:"text-[11px] text-muted ml-2",children:["avg ",Gt(d.avg),d.count!==i?`  ${d.count}/${i}`:""]})]})]},d.key)),l>0&&a.jsxs("div",{className:"text-[11px] text-muted",children:["+",l," more"]})]})]})}const oN=[{label:"Root",path:"/"}],lN="w-11 h-11 rounded-md border border-border flex items-center justify-center transition-colors",aN="bg-accent-muted text-accent",uN="bg-surface text-text hover:bg-surface-hover";function Rl(e){return`${lN} ${e?aN:uN}`}function cN({leftTool:e,onToolChange:t,compareEnabled:n,compareActive:r,onOpenCompare:s,views:i,activeViewId:o,onActivateView:l,onSaveView:u,current:d,data:f,onOpenFolder:p,onOpenFolderActions:h,onPullRefreshFolders:w,onContextMenu:x,countVersion:S,items:C,filteredItems:v,metricKeys:m,selectedItems:y,selectedMetric:g,onSelectMetric:b,filters:E,onChangeRange:M,onChangeFilters:N,onResize:_}){const P=Rl(e==="folders"),B=Rl(e==="metrics"),F=Rl(r),Q=`${Rl(!1)} cursor-pointer`;return a.jsxs("div",{className:"app-left-panel col-start-1 row-start-2 relative border-r border-border bg-panel overflow-visible",children:[a.jsxs("div",{className:"absolute inset-y-0 left-0 w-12 border-r border-border flex flex-col items-center gap-2 py-3 bg-surface-overlay",children:[a.jsx("button",{className:P,title:"Folders","aria-label":"Folders","aria-pressed":e==="folders",onClick:()=>t("folders"),children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:a.jsx("path",{d:"M3 7.5h6l2-2h10a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2z"})})}),a.jsx("button",{className:B,title:"Metrics / Filters","aria-label":"Metrics and Filters","aria-pressed":e==="metrics",onClick:()=>t("metrics"),children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("path",{d:"M4 19V9"}),a.jsx("path",{d:"M10 19V5"}),a.jsx("path",{d:"M16 19v-7"}),a.jsx("path",{d:"M3 19h18"})]})}),a.jsx("div",{className:"w-6 h-px bg-border/70 my-1"}),a.jsx("button",{className:`${F} ${n?"":"opacity-40 cursor-not-allowed"}`,title:n?"Compare selected images":"Compare (select 2+)","aria-label":"Compare selected images","aria-pressed":r,"aria-disabled":!n,disabled:!n,onClick:()=>{n&&s()},children:a.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[a.jsx("rect",{x:"3",y:"4",width:"8",height:"16",rx:"1"}),a.jsx("rect",{x:"13",y:"4",width:"8",height:"16",rx:"1"})]})}),a.jsx("div",{className:"flex-1"}),a.jsx("a",{className:Q,href:"https://github.com/trojblue/lenslet",title:"Lenslet on GitHub","aria-label":"Lenslet on GitHub",target:"_blank",rel:"noreferrer",children:a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:a.jsx("path",{d:"M12 .5C5.73.5.5 5.74.5 12.02c0 5.1 3.29 9.42 7.86 10.95.58.11.79-.25.79-.56v-2.17c-3.2.7-3.88-1.55-3.88-1.55-.53-1.35-1.29-1.71-1.29-1.71-1.05-.72.08-.71.08-.71 1.16.08 1.78 1.2 1.78 1.2 1.03 1.77 2.71 1.26 3.37.96.1-.75.4-1.26.73-1.55-2.55-.29-5.23-1.29-5.23-5.74 0-1.27.45-2.31 1.19-3.13-.12-.29-.52-1.46.11-3.05 0 0 .97-.31 3.18 1.19.92-.26 1.91-.39 2.89-.39.98 0 1.97.13 2.89.39 2.2-1.5 3.18-1.19 3.18-1.19.63 1.59.23 2.76.11 3.05.74.82 1.19 1.86 1.19 3.13 0 4.46-2.69 5.45-5.25 5.73.41.36.78 1.07.78 2.16v3.2c0 .31.21.67.8.56 4.56-1.53 7.85-5.85 7.85-10.95C23.5 5.74 18.27.5 12 .5z"})})})]}),a.jsx("div",{className:"ml-12 h-full overflow-hidden",children:e==="folders"?a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("div",{className:"px-2 py-2 border-b border-border",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("div",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Smart Folders"}),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:u,title:"Save current view as Smart Folder",children:"+ New"})]}),i.length?a.jsx("div",{className:"flex flex-col gap-1",children:i.map(Z=>{const W=Z.id===o;return a.jsx("button",{className:`text-left px-2 py-2 rounded-md text-sm ${W?"bg-accent-muted text-accent":"hover:bg-hover text-text"}`,onClick:()=>l(Z),children:Z.name},Z.id)})}):a.jsx("div",{className:"text-xs text-muted px-1 py-1.5",children:"No saved Smart Folders yet."})]}),a.jsx(QE,{current:d,roots:oN,data:f,onOpen:p,onPullRefresh:w,onContextMenu:x,onOpenActions:h,countVersion:S,className:"flex-1 min-h-0 overflow-auto scrollbar-thin",showResizeHandle:!1})]}):a.jsx(sN,{items:C,filteredItems:v,metricKeys:m,selectedItems:y,selectedMetric:g,onSelectMetric:b,filters:E,onChangeRange:M,onChangeFilters:N})}),a.jsx("div",{className:"toolbar-offset sidebar-resize-handle sidebar-resize-handle-left absolute bottom-0",onPointerDown:_})]})}function dN({persistenceEnabled:e,indexing:t=null,offViewSummary:n,onRevealOffView:r,canRevealOffView:s=!1,onClearOffView:i,browserZoomPercent:o}){const u=!!(n!=null&&n.names.length)&&n?` (${n.names.join(", ")}${n.extra?` +${n.extra}`:""})`:"",d=s&&r!=null,f=typeof o=="number"?o:null,p=f!==null&&Math.abs(f-100)>=2,h=(t==null?void 0:t.state)==="running",w=(t==null?void 0:t.state)==="error",x=t!=null&&t.scope&&t.scope!=="/"?` (${t.scope})`:"",S=(()=>{if(!h)return null;const v=typeof(t==null?void 0:t.done)=="number"?t.done:null,m=typeof(t==null?void 0:t.total)=="number"?t.total:null;return v===null&&m===null?null:m===null?`${v??0} indexed`:`${Math.min(v??0,m)} / ${m}`})();return!e||h||w||p||!!n?a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-col gap-2",children:[!e&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Not persisted."})," Workspace is read-only; edits stay in memory until restart."]}),h&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Indexing in progress",x,"."]})," ",S?`${S} complete.`:"Preparing searchable index."]}),w&&a.jsxs("div",{className:"ui-banner ui-banner-danger text-xs",children:[a.jsx("span",{className:"font-semibold",children:"Indexing failed."})," ",(t==null?void 0:t.error)||"Open server logs for details."]}),p&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs",children:[a.jsxs("span",{className:"font-semibold",children:["Browser zoom ",Math.round(f),"%."]})," For best results, set it to 100% so UI elements stay in correct proportions."]}),n&&a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex items-center justify-between gap-3",children:[a.jsxs("span",{children:["Updates outside current view: ",n.count," item",n.count===1?"":"s",u]}),a.jsxs("div",{className:"flex items-center gap-2",children:[d&&a.jsx("button",{className:"text-muted hover:text-text transition-colors",onClick:()=>r==null?void 0:r(),"aria-label":"Reveal off-view updates",children:"Reveal"}),a.jsx("button",{className:"text-muted hover:text-text transition-colors text-base leading-none",onClick:i,"aria-label":"Clear off-view updates",children:""})]})]})]})}):null}function fN(e){return e.isOffline?"offline":e.isUnstable?"unstable":e.recentEditActive?"recent":Number.isFinite(e.editingCount)&&e.editingCount>0?"editing":"live"}const hN=6e3,pN=1e4,mN=24*60*6e4,gN=3e4,vN=350,yN=1400,Ix=[-2,-1,1,2],_x=[-2,-1,0,1,2,3];Ix.length;_x.length;function xN(e,t,n){return Math.min(Math.max(e,t),n)}function Lx(e,t,n){const r=new Set,s=[];for(const i of n){const o=t+i;if(o<0||o>=e.length)continue;const l=e[o];!l||r.has(l)||(r.add(l),s.push(l))}return s}function wN(e,t){if(!t)return[];const n=e.indexOf(t);return n<0?[]:Lx(e,n,Ix)}function SN(e,t){if(e.length<2)return[];const n=Math.max(0,e.length-2),r=xN(t,0,n);return Lx(e,r,_x)}function bN({paths:e,defaultDestination:t,destinations:n,loadingDestinations:r,onClose:s,onSubmit:i}){const[o,l]=c.useState(()=>Pt(t||"/")),[u,d]=c.useState(!1);c.useEffect(()=>{l(Pt(t||"/"))},[t,e]);const f=Pt(o||"/"),p=e.length>0&&!u,h=e.slice(0,3).map(C=>eh(C)||C),w=Math.max(0,e.length-h.length),x=n.filter(C=>C!==f).slice(0,8),S=async C=>{if(C.preventDefault(),!!p){d(!0);try{await i(e,f)}finally{d(!1)}}};return a.jsx("div",{className:"toolbar-offset fixed inset-0 z-overlay bg-black/45 backdrop-blur-[1px] flex items-center justify-center p-3",children:a.jsxs("div",{className:"w-full max-w-[560px] rounded-xl border border-border bg-panel shadow-[0_20px_60px_rgba(0,0,0,0.55)]",children:[a.jsxs("div",{className:"px-4 py-3 border-b border-border flex items-center justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-text",children:"Move to folder"}),a.jsxs("div",{className:"text-xs text-muted",children:[e.length," item(s) selected"]})]}),a.jsx("button",{type:"button",className:"btn btn-icon",onClick:s,"aria-label":"Close move dialog",disabled:u,children:""})]}),a.jsxs("form",{className:"px-4 py-3 flex flex-col gap-3",onSubmit:S,children:[a.jsxs("div",{className:"text-xs text-muted",children:[h.join(", "),w>0?` and ${w} more`:""]}),a.jsxs("label",{className:"text-xs text-muted flex flex-col gap-1.5",children:["Destination folder",a.jsx("input",{value:o,onChange:C=>l(C.target.value),className:"input w-full",list:"move-destination-list",placeholder:"/",autoFocus:!0,disabled:u})]}),a.jsx("datalist",{id:"move-destination-list",children:n.map(C=>a.jsx("option",{value:C},C))}),a.jsx("div",{className:"text-[11px] text-muted",children:r?"Loading folder list":`${n.length.toLocaleString()} destination(s) loaded`}),x.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.map(C=>a.jsx("button",{type:"button",className:"btn btn-sm",onClick:()=>l(C),disabled:u,children:C},C))}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2 border-t border-border",children:[a.jsx("button",{type:"button",className:"btn",onClick:s,disabled:u,children:"Cancel"}),a.jsx("button",{type:"submit",className:"btn btn-active",disabled:!p,children:u?"Moving":"Move"})]})]})]})})}function CN(e){return JSON.stringify(e,null,2)}function kN(e){const t=s=>'"'+s.replaceAll('"','""')+'"',n="path,folder,name,star,type,size,width,height,tags,notes",r=e.map(s=>{const i=(s.tags||[]).join(" "),o=s.notes||"";return[s.path,s.folder,s.name,String(s.star??""),s.type??"",s.size??"",s.width??"",s.height??"",i,o].map(l=>t(String(l))).join(",")});return[n,...r].join(`
`)}function EN(e){return e.map(t=>{const n=t.path.split("/").filter(Boolean);n.pop();const r=n.length?`/${n.join("/")}`:"/";return{path:t.path,folder:r,name:t.name,star:t.star??null,type:t.type,size:t.size,width:t.w,height:t.h}})}function NN({x:e,y:t,items:n}){const r=c.useRef(null),[s,i]=c.useState({x:e,y:t}),[o,l]=c.useState(!1),u=c.useCallback((f,p)=>{p.stopPropagation(),f.disabled||f.onClick()},[]),d=c.useCallback(()=>{const f=r.current,p=Vy(),h=f==null?void 0:f.getBoundingClientRect(),w=(h==null?void 0:h.width)??180,x=(h==null?void 0:h.height)??Math.max(40,n.length*36),S=Uy({x:e,y:t,menuWidth:w,menuHeight:x,viewport:p});i(C=>C.x===S.x&&C.y===S.y?C:S),l(!0)},[n.length,e,t]);return c.useLayoutEffect(()=>{d()},[d]),c.useEffect(()=>(window.addEventListener("resize",d),window.addEventListener("scroll",d,!0),()=>{window.removeEventListener("resize",d),window.removeEventListener("scroll",d,!0)}),[d]),a.jsx("div",{ref:r,className:"dropdown-panel fixed",role:"menu",style:{left:s.x,top:s.y,minWidth:180,visibility:o?"visible":"hidden"},onClick:f=>f.stopPropagation(),children:n.map((f,p)=>a.jsxs("button",{className:`dropdown-item w-full ${f.danger?"text-danger hover:text-danger":""}`,role:"menuitem","aria-disabled":f.disabled,disabled:f.disabled,onClick:h=>u(f,h),children:[f.icon&&a.jsx("span",{className:"shrink-0",children:f.icon}),a.jsx("span",{children:f.label})]},p))})}function Hm(e){return e==="csv"?"text/csv;charset=utf-8":"application/json;charset=utf-8"}function Qm(e,t){const n=EN(e);return t==="csv"?kN(n):CN(n)}function Km(){return new Date().toISOString().replace(/[:.]/g,"-")}function jN({ctx:e,current:t,items:n,setCtx:r,onRefetch:s,onOpenMoveDialog:i,onRefreshFolder:o}){const l=eE(t),[u,d]=c.useState(!1),[f,p]=c.useState(null),h=e.kind==="grid"?e.payload.paths:[],w=c.useMemo(()=>new Map(n.map(M=>[M.path,M])),[n]),x=()=>{r(null)},S=async()=>{const M=e.kind==="tree"?e.payload.path:"/";d(!0);try{await o(M)}catch(N){console.error("Failed to refresh folder:",N)}finally{d(!1),x()}},C=M=>async()=>{p(M);const N=e.kind==="tree"?e.payload.path:t;try{const _=await pe.getFolder(N,{recursive:!0,legacyRecursive:!0}),P=Qm(_.items,M),B=Hm(M),F=N==="/"?"root":(N.replace(/^\/+/,"")||"root").replace(/\//g,"_");fo(new Blob([P],{type:B}),`metadata_${F}_${Km()}.${M}`)}catch(_){console.error("Failed to export folder:",_),alert("Failed to export folder. See console for details.")}finally{p(null),x()}},v=M=>async()=>{p(M);try{const N=new Set(h),_=n.filter(F=>N.has(F.path)),P=Qm(_,M),B=Hm(M);fo(new Blob([P],{type:B}),`metadata_selection_${Km()}.${M}`)}finally{p(null),x()}},m=async()=>{var M;if(h.length){x();for(const N of h)try{const _=await pe.getFile(N),P=((M=w.get(N))==null?void 0:M.name)||eh(N)||"image";fo(_,P)}catch(_){console.error(`Failed to download ${N}:`,_)}}},y=async()=>{if(!l){for(const M of h)try{await pe.moveFile(M,"/_trash_")}catch(N){console.error(`Failed to trash ${M}:`,N)}s(),x()}},g=async()=>{if(confirm(`Delete ${h.length} file(s) permanently? This cannot be undone.`)){try{await pe.deleteFiles(h)}catch(M){console.error("Failed to delete files:",M)}s(),x()}},b=async()=>{for(const M of h)try{const _=(await pe.getSidecar(M)).original_position,P=_&&_.split("/").slice(0,-1).join("/")||"/";await pe.moveFile(M,P)}catch(N){console.error(`Failed to recover ${M}:`,N)}s(),x()},E=e.kind==="tree"?[{label:u?"Refreshing":"Refresh",disabled:u,onClick:S},{label:f==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!f||u,onClick:C("csv")},{label:f==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!f||u,onClick:C("json")}]:MN({selectedPaths:h,inTrash:l,exporting:f,onDownloadSelection:m,onMoveSelection:i,onMoveToTrash:y,onPermanentDelete:g,onRecover:b,onExportCsv:v("csv"),onExportJson:v("json")});return a.jsx(NN,{x:e.x,y:e.y,items:E})}function MN({selectedPaths:e,inTrash:t,exporting:n,onDownloadSelection:r,onMoveSelection:s,onMoveToTrash:i,onPermanentDelete:o,onRecover:l,onExportCsv:u,onExportJson:d}){const f=[];return e.length&&f.push({label:e.length>1?`Download (${e.length})`:"Download",onClick:r}),e.length&&f.push({label:"Move to",disabled:t,onClick:()=>{t||s(e)}}),f.push({label:"Move to trash",disabled:t,onClick:i}),t&&(f.push({label:"Permanent delete",danger:!0,onClick:o}),f.push({label:"Recover",onClick:l})),e.length&&(f.push({label:n==="csv"?"Exporting CSV":"Export metadata (CSV)",disabled:!!n,onClick:u}),f.push({label:n==="json"?"Exporting JSON":"Export metadata (JSON)",disabled:!!n,onClick:d})),f}function Tl(e){const t=c.useRef(e);return t.current=e,t}function PN(e,t){return t?e.some(n=>{var s;const r=(s=n.metrics)==null?void 0:s[t];return r!=null&&!Number.isNaN(r)}):!1}function RN(e,t){const n={0:0,1:0,2:0,3:0,4:0,5:0};for(const r of e){const s=t[r.path]??r.star??0,i=String(s);n[i]=(n[i]||0)+1}return n}function TN(e,t=250){const n=new Set;let r=0;for(const s of e){const i=s.metrics;if(i)for(const o of Object.keys(i))n.add(o);if(r+=1,r>=t&&n.size>0)break}return Array.from(n).sort()}function IN(e,t,n,r){return e||t?n:r}function _N(e,t,n,r,s,i){return e?n:t||i==="/"?r:s}function LN(e){if(!e)return null;if(e.queryPath){const t=e.queryPath.split("/").filter(Boolean);return t.length?t[t.length-1]:e.queryPath}return e.queryVector?"Vector query":null}function AN(e,t,n,r){return e?t>0?`${n} of ${r}`:`${r}`:null}const FN=(e,t)=>["search",e,t],ON=2e4,Il="/";function DN(e){return e.trim().replace(/\s+/g," ")}function Ax(e){const t=e.trim();return!t||t===Il?Il:t.startsWith(Il)?t:`${Il}${t}`}function rh(e,t){const n=DN(e);return n?{q:n,path:Ax(t)}:null}function zN(e){return!Array.isArray(e)||e[0]!=="search"||typeof e[1]!="string"||typeof e[2]!="string"?null:rh(e[1],e[2])}function $N(e,t){if(!t)return!1;const n=zN(e);return n?n.path===t.path:!1}function BN(e,t){const n=nu(),r=rh(e,t),s=FN((r==null?void 0:r.q)??"",(r==null?void 0:r.path)??Ax(t));return Za({enabled:r!==null,queryKey:s,queryFn:()=>r?pe.search(r.q,r.path):Promise.resolve({items:[]}),staleTime:3e3,gcTime:6e4,placeholderData:(i,o)=>{if($N(o==null?void 0:o.queryKey,r))return i},retry:1,refetchInterval:n?ON:!1,refetchIntervalInBackground:n})}const UN=()=>["embeddings"];function VN(){return Za({queryKey:UN(),queryFn:pe.getEmbeddings,staleTime:6e4,gcTime:5*6e4,retry:1,refetchOnWindowFocus:!1})}function WN(e,t=250){const[n,r]=Wr.useState(e);return Wr.useEffect(()=>{const s=window.setTimeout(()=>r(e),Math.max(0,t));return()=>window.clearTimeout(s)},[e,t]),n}function Ym(e){return e.addedAt?Date.parse(e.addedAt):0}function Aa(e,t){return e.name.localeCompare(t.name)}function HN(e,t){const n=Ym(e),r=Ym(t);return n===r?Aa(e,t):n-r}function QN(e){return(t,n)=>{var i,o;const r=(i=t.metrics)==null?void 0:i[e],s=(o=n.metrics)==null?void 0:o[e];return r==null&&s==null?Aa(t,n):r==null?1:s==null?-1:r===s?Aa(t,n):r-s}}function Xm(e,t){return rE(e,t)}function KN(e){let t=e>>>0;return()=>{t+=1831565813;let n=Math.imul(t^t>>>15,1|t);return n^=n+Math.imul(n^n>>>7,61|n),((n^n>>>14)>>>0)/4294967296}}function YN(e,t){const n=KN(t||1),r=[...e];for(let s=r.length-1;s>0;s-=1){const i=Math.floor(n()*(s+1));[r[s],r[i]]=[r[i],r[s]]}return r}function XN(e,t,n){if(t.kind==="builtin"&&t.key==="random"){const i=n??Date.now();return YN(e,i)}let r=HN;t.kind==="metric"?r=QN(t.key):t.key==="name"&&(r=Aa);const s=[...e].sort(r);return t.dir==="desc"?s.reverse():s}function Fx(e){if(!e.length)return e;const t=new Set,n=[];for(const r of e)t.has(r.path)||(t.add(r.path),n.push(r));return n}function Ox(e){return{...e,items:Fx(e.items)}}function qN(e,t){const n=e.pageCount??1,r=e.pageSize??t,s=(e.page??1)+1;return n<=1||s>n?null:{startPage:s,endPage:n,pageSize:r}}function GN(e,t){if(e.path!==t.path)return Ox(t);const n=Fx([...e.items,...t.items]);return{...e,generatedAt:t.generatedAt??e.generatedAt,dirs:e.dirs.length?e.dirs:t.dirs,items:n,page:t.page??e.page,pageSize:t.pageSize??e.pageSize,pageCount:t.pageCount??e.pageCount,totalItems:t.totalItems??e.totalItems}}async function JN(e,t){const n=t.shouldContinue??(()=>!0),r=t.progressiveUpdates??!0,s=qN(e,t.defaultPageSize),i=t.skipInitialUpdateIfPaged===!0&&s!==null;let o=Ox(e);if(i||t.onUpdate(o),!s){i&&t.onUpdate(o);return}let l=!1;for(let u=s.startPage;u<=s.endPage;u+=1){let d;try{d=await t.fetchPage(u,s.pageSize)}catch{return}if(!n())return;o=GN(o,d),l=!0,r&&t.onUpdate(o)}!r&&l&&t.onUpdate(o)}function ZN(e,t){return e?t instanceof tn||t instanceof Error?t.message:"Failed to load embeddings.":null}function ej({current:e,query:t,similarityState:n,viewState:r,randomSeed:s,localStarOverrides:i,sessionResetToken:o=0,onFolderHydratedSnapshot:l,getCachedHydratedSnapshot:u}){var $,A;const d=dr(),{data:f,refetch:p,isLoading:h,isError:w}=Wd(e,!0,{page:1,pageSize:Zl}),[x,S]=c.useState(),C=c.useRef(0),v=c.useCallback(()=>p(),[p]),{data:m}=Wd("/",!0,{enabled:!1,page:1,pageSize:Zl});c.useEffect(()=>{d.removeQueries({predicate:({queryKey:V})=>LE(V,e,!0)})},[e,d]),c.useEffect(()=>{C.current+=1;const V=(u==null?void 0:u(e))??null;S(V??void 0)},[e,u,o]),c.useEffect(()=>{if(!f)return;const V=++C.current;let K=!1;const G=((u==null?void 0:u(f.path))??null)!==null;return JN(f,{defaultPageSize:Zl,fetchPage:(X,D)=>pe.getFolder(f.path,{recursive:!0,page:X,pageSize:D}),onUpdate:X=>{S(X),l==null||l(X.path,X)},shouldContinue:()=>!K&&C.current===V,progressiveUpdates:!1,skipInitialUpdateIfPaged:G}),()=>{K=!0}},[u,l,f]);const y=n!==null,g=WN(t,250),b=c.useMemo(()=>y?null:rh(g,e),[y,g,e]),E=b!==null,M=(b==null?void 0:b.q)??"",N=BN((b==null?void 0:b.q)??"",(b==null?void 0:b.path)??e),_=VN(),P=(($=_.data)==null?void 0:$.embeddings)??[],B=((A=_.data)==null?void 0:A.rejected)??[],F=P.length>0,Q=ZN(_.isError,_.error),Z=c.useMemo(()=>{var K;return(E?((K=N.data)==null?void 0:K.items)??[]:(x==null?void 0:x.items)??[]).map(G=>({...G,star:i[G.path]!==void 0?i[G.path]:G.star}))},[E,N.data,x,i]),W=c.useMemo(()=>{var G;const V=new Map;for(const re of Z)V.set(re.path,re);const K=((G=N.data)==null?void 0:G.items)??[];for(const re of K){if(V.has(re.path))continue;const X=i[re.path]!==void 0?i[re.path]:re.star;V.set(re.path,{...re,star:X})}return V},[Z,N.data,i]),I=c.useMemo(()=>n?n.items.map(V=>{const K=W.get(V.path);return K||_k(V.path,i[V.path])}):[],[n,W,i]),R=c.useMemo(()=>{if(n)return Xm(I,r.filters);const V=Xm(Z,r.filters);return XN(V,r.sort,s)},[n,I,Z,r.filters,r.sort,s]),T=n?I.length:Z.length,L=R.length,O=(x==null?void 0:x.totalItems)??(x==null?void 0:x.items.length)??T,Y=e==="/"?O:(m==null?void 0:m.totalItems)??(m==null?void 0:m.items.length)??O;return{data:x,refetch:v,isLoading:h,isError:w,searching:E,normalizedQ:M,similarityActive:y,embeddings:P,embeddingsRejected:B,embeddingsAvailable:F,embeddingsLoading:_.isLoading,embeddingsError:Q,poolItems:Z,similarityItems:I,items:R,totalCount:T,filteredCount:L,scopeTotal:O,rootTotal:Y}}function tj({current:e,itemPaths:t,items:n,selectionPool:r,focusGridCell:s}){const[i,o]=c.useState([]),[l,u]=c.useState(null),[d,f]=c.useState(!1),[p,h]=c.useState(0),[w,x]=c.useState(0),S=c.useRef(!1),C=c.useRef(!1),v=c.useRef(null),m=c.useMemo(()=>new Set(i),[i]),y=c.useMemo(()=>{if(!i.length)return[];const D=new Map(r.map(ie=>[ie.path,ie])),he=new Map(n.map(ie=>[ie.path,ie]));return i.map(ie=>D.get(ie)??he.get(ie)).filter(ie=>!!ie)},[i,r,n]),g=c.useMemo(()=>n.filter(D=>m.has(D.path)),[n,m]),b=c.useMemo(()=>g.map(D=>D.path),[g]),E=Math.max(0,g.length-2),M=Math.min(p,E),N=g[M]??null,_=g[M+1]??null,P=M>0,B=M<g.length-2,F=g.length>=2,Q=l!=null||d,Z=l??i[0]??null,W=Z?t.indexOf(Z):-1,I=W>0,R=W>=0&&W<t.length-1;c.useEffect(()=>{h(D=>D>E?E:D)},[E]);const T=c.useCallback(()=>{x(D=>D+1)},[]),L=c.useCallback(D=>{v.current=D},[]),O=c.useCallback(()=>{u(null),S.current=!1},[]),Y=c.useCallback(D=>{if(D){u(D),o([D]);return}O()},[O]),$=c.useCallback(D=>{l&&(u(null),S.current=!1,Ml(D))},[l]),A=c.useCallback(D=>{u(D),S.current=!0,hx(D)},[]),V=c.useCallback(()=>{u(null),S.current?(S.current=!1,window.history.back()):Ml(e),s(v.current)},[e,s]),K=c.useCallback(()=>{d||!F||(i[0]&&(v.current=i[0]),h(0),f(!0),l&&(u(null),S.current&&(S.current=!1),Ml(e)),C.current||(window.history.pushState({compare:!0},"",window.location.href),C.current=!0))},[d,F,e,i,l]),G=c.useCallback(()=>{f(!1),C.current&&(C.current=!1,window.history.back()),s(v.current??i[0])},[s,i]),re=c.useCallback(D=>{g.length<2||h(he=>{const ie=Math.max(0,g.length-2);return Math.min(ie,Math.max(0,he+D))})},[g.length]),X=c.useCallback(D=>{if(!t.length)return;const he=l??i[0];if(!he)return;const ie=t.indexOf(he);if(ie===-1)return;const me=Math.min(t.length-1,Math.max(0,ie+D)),ke=t[me];!ke||ke===he||(l&&(u(ke),Ml(ke)),o([ke]))},[t,i,l]);return c.useEffect(()=>{d&&(F||G())},[d,F,G]),c.useEffect(()=>{const D=()=>{l&&(S.current=!1,u(null)),d&&(C.current=!1,f(!1))};return window.addEventListener("popstate",D),()=>window.removeEventListener("popstate",D)},[l,d]),{selectedPaths:i,setSelectedPaths:o,viewer:l,compareOpen:d,restoreGridToSelectionToken:w,bumpRestoreGridToSelectionToken:T,selectedItems:y,compareItems:g,comparePaths:b,compareIndexClamped:M,compareA:N,compareB:_,canComparePrev:P,canCompareNext:B,compareEnabled:F,canPrevImage:I,canNextImage:R,overlayActive:Q,rememberFocusedPath:L,openViewer:A,closeViewer:V,openCompare:K,closeCompare:G,handleCompareNavigate:re,handleNavigate:X,resetViewerState:O,clearViewerForSearch:$,syncHashImageSelection:Y}}const nj=2048,rj=6,sj=10;function Dx(e){const t=new Map;for(const n of e)t.set(n.path,n.name);return t}function zx(e,t){return t.get(e)??e.split("/").pop()??e}function qm(e,t){const n=e.filter(r=>!t.has(r.path));return n.length===e.length?e:n}function Gm(e,t,n,r,s){const i=e.filter(l=>l.path!==t);return[{path:t,ts:n,kind:r},...i].slice(0,s)}function ij(e,t){if(!e.length)return null;const n=Dx(t),r=new Set,s=[];for(const o of e)r.has(o.path)||(r.add(o.path),s.push(o.path));const i=s.slice(0,2).map(o=>zx(o,n));return{count:s.length,names:i,extra:Math.max(0,s.length-i.length)}}function oj(e,t,n,r){if(!e.length)return[];const s=Dx(t);return e.map(i=>({path:i.path,label:zx(i.path,s),timeLabel:r(i.ts,n)}))}function lj(e){const[t,n]=c.useState([]),[r,s]=c.useState([]),[i,o]=c.useState(new Map),l=c.useRef(new Map),u=c.useRef(new Set),d=c.useRef(new Set),f=c.useRef(new Set);c.useEffect(()=>()=>{for(const C of l.current.values())window.clearTimeout(C);l.current.clear(),u.current.clear()},[]),c.useEffect(()=>{d.current=new Set(e),n(C=>qm(C,f.current))},[e]);const p=c.useCallback((C,v)=>{if(v!=null){if(u.current.has(v))return;if(u.current.add(v),u.current.size>nj){const E=u.current.values().next().value;E!=null&&u.current.delete(E)}}const m=v!=null?`event:${v}`:`event:${C}:${Date.now()}`;o(E=>{if(E.get(C)===m)return E;const M=new Map(E);return M.set(C,m),M});const y=l.current,g=y.get(C);g!=null&&window.clearTimeout(g);const b=window.setTimeout(()=>{o(E=>{if(E.get(C)!==m)return E;const M=new Map(E);return M.delete(C),M}),y.delete(C)},yN);y.set(C,b)},[]),h=c.useCallback(C=>{f.current=C,n(v=>qm(v,C))},[]),w=c.useCallback((C,v,m)=>{const y=Date.now();d.current.has(C)&&f.current.has(C)||n(b=>Gm(b,C,y,v,rj)),p(C,m)},[p]),x=c.useCallback((C,v,m)=>{const y=Date.now(),g=sx(m)??y;s(b=>Gm(b,C,g,v,sj))},[]),S=c.useCallback(()=>{n([])},[]);return{offViewActivity:t,recentTouches:r,highlightedPaths:i,onVisiblePathsChange:h,markRecentActivity:w,markRecentTouch:x,clearOffViewActivity:S}}function Jm(e){if(typeof e!="number"||!Number.isFinite(e))return;const t=Math.trunc(e);return t<0?0:t}function aj(e){if(!e)return null;const t=e.state;if(t!=="idle"&&t!=="running"&&t!=="ready"&&t!=="error")return null;let n=Jm(e.done);const r=Jm(e.total);return n!==void 0&&r!==void 0&&n>r&&(n=r),{state:t,scope:typeof e.scope=="string"?e.scope:void 0,done:n,total:r,started_at:typeof e.started_at=="string"?e.started_at:void 0,finished_at:typeof e.finished_at=="string"?e.finished_at:void 0,error:typeof e.error=="string"?e.error:void 0}}function uj(e,t){return e===t?!0:!e||!t?!1:e.state===t.state&&e.scope===t.scope&&e.done===t.done&&e.total===t.total&&e.started_at===t.started_at&&e.finished_at===t.finished_at&&e.error===t.error}function cj(e){return(e==null?void 0:e.state)==="idle"||(e==null?void 0:e.state)==="running"}function dj(e,t,n){return(e==null?void 0:e.state)==="running"?t:n}const $x=[1],fj={supportedVersions:[...$x],maxPathsV2:null,supportsV2:!1};function hj(e){if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.trunc(e);return t>0?t:null}function pj(e){if(typeof e!="number"||!Number.isFinite(e))return null;const t=Math.trunc(e);return t>=2?t:null}function mj(e){let t=[...$x];const n=e==null?void 0:e.supported_versions;if(Array.isArray(n)){const i=Array.from(new Set(n.map(o=>hj(o)).filter(o=>o!==null))).sort((o,l)=>o-l);i.length>0&&(t=i)}const r=pj(e==null?void 0:e.max_paths_v2),s=t.includes(2)&&r!==null&&r>2;return{supportedVersions:t,maxPathsV2:r,supportsV2:s}}function gj(e,t){if(e===t)return!0;if(e.supportsV2!==t.supportsV2||e.maxPathsV2!==t.maxPathsV2||e.supportedVersions.length!==t.supportedVersions.length)return!1;for(let n=0;n<e.supportedVersions.length;n+=1)if(e.supportedVersions[n]!==t.supportedVersions[n])return!1;return!0}const vj=1200,Zm=3e3;function yj(e){switch(e){case"live":return"Live";case"reconnecting":return"Reconnecting";case"offline":return"Offline";case"connecting":case"idle":default:return"Connecting"}}function eg(e){if(!(e instanceof tn))return null;const t=e.body;if(!t||typeof t!="object")return null;const n=t.error;return typeof n=="string"?n:null}function tg(e,t){return t-e<mN?nk(e,t):rk(e)}function xj({current:e,currentGalleryId:t,itemPaths:n,items:r,queryClient:s,updateItemCaches:i,setLocalStarOverrides:o}){const l=c.useRef(Ei()),u=c.useRef(null),d=c.useRef(null),f=c.useRef(null),p=c.useRef(!1),h=c.useRef(null),w=c.useRef("idle"),[x,S]=c.useState("idle"),[C,v]=c.useState({}),[m,y]=c.useState(null),[g,b]=c.useState(null),[E,M]=c.useState(!1),[N,_]=c.useState(()=>Date.now()),[P,B]=c.useState(!0),[F,Q]=c.useState(null),[Z,W]=c.useState(fj);c.useEffect(()=>{if(g==null){M(!1);return}M(!0);const se=window.setTimeout(()=>M(!1),hN);return()=>window.clearTimeout(se)},[g]),c.useEffect(()=>{if(m==null)return;_(Date.now());const se=window.setInterval(()=>_(Date.now()),1e4);return()=>window.clearInterval(se)},[m]);const{offViewActivity:I,recentTouches:R,highlightedPaths:T,onVisiblePathsChange:L,markRecentActivity:O,markRecentTouch:Y,clearOffViewActivity:$}=lj(n),A=c.useCallback(se=>{const oe=Date.now(),be=sx(se)??oe,fe=be>oe?oe:be;y(ue=>ue==null?fe:ue>fe?ue:fe),b(oe),_(oe)},[]),V=c.useCallback(se=>{se.length&&v(oe=>{let Se=!1;const be={...oe};for(const fe of se){const ue=oe[fe.gallery_id];ue&&ue.viewing===fe.viewing&&ue.editing===fe.editing||(be[fe.gallery_id]=fe,Se=!0)}return Se?be:oe})},[]),K=c.useCallback(()=>{h.current!=null&&(window.clearTimeout(h.current),h.current=null)},[]),G=c.useCallback(se=>{se&&v(oe=>{if(!(se in oe))return oe;const Se={...oe};return delete Se[se],Se})},[]),re=c.useCallback(se=>{u.current=se.lease_id,d.current=se.gallery_id,V([se])},[V]),X=c.useCallback(async(se,oe=!1)=>{const Se=l.current,be=oe?void 0:u.current??void 0,fe=ue=>pe.joinPresence(se,ue,Se);try{re(await fe(be));return}catch(ue){if(!oe&&eg(ue)==="invalid_lease"){re(await fe(void 0));return}throw ue}},[re]),D=c.useCallback(async(se,oe)=>{if(se===oe){await X(oe);return}const Se=u.current;if(!Se){await X(oe,!0);return}try{const be=await pe.movePresence(se,oe,Se,l.current);d.current=be.to_scope.gallery_id,V([be.from_scope,be.to_scope]);return}catch(be){const fe=eg(be);if(fe==="invalid_lease"){await X(oe,!0);return}if(fe==="scope_mismatch"){await X(oe);return}throw be}},[V,X]),he=c.useCallback(async se=>{const oe=d.current;if(!oe){await X(se,!0);return}if(oe===se){await X(se);return}await D(oe,se)},[X,D]),ie=c.useCallback(async()=>{if(p.current)return;const se=f.current;if(se){f.current=null,p.current=!0;try{await he(se)}catch{}finally{p.current=!1;const oe=f.current;oe&&oe!==d.current&&ie()}}},[he]),me=c.useCallback((se,oe=!1)=>{if(f.current=se,K(),oe||d.current==null){ie();return}h.current=window.setTimeout(()=>{h.current=null,ie()},vN)},[K,ie]),ke=c.useCallback(()=>{d.current=null,u.current=null,f.current=null,K()},[K]),xe=c.useCallback(se=>{const oe=d.current,Se=u.current;!oe||!Se||(mb(oe,Se,l.current),se&&G(oe),ke())},[G,ke]);c.useEffect(()=>{ab();const se=cb(Se=>{if(Se.type==="presence"){const ue=Se.data;if(!(ue!=null&&ue.gallery_id))return;V([ue]);return}const be=Se.data;if(!(be!=null&&be.path))return;const fe=be.path;if(Se.type==="item-updated"){const ue=Se.data,$e={v:1,tags:ue.tags??[],notes:ue.notes??"",star:ue.star??null,version:ue.version??1,updated_at:ue.updated_at??"",updated_by:ue.updated_by??"server"};s.setQueryData(Io(fe),$e),i({path:fe,star:ue.star??null,metrics:ue.metrics,comments:ue.notes??""}),HC(fe,$e),O(fe,"item-updated",Se.id),Y(fe,"item-updated",ue.updated_at),A(ue.updated_at),o(it=>{if(it[fe]===void 0)return it;const bt={...it};return delete bt[fe],bt})}else if(Se.type==="metrics-updated"){const ue=Se.data;i({path:fe,metrics:ue.metrics}),O(fe,"metrics-updated",Se.id),Y(fe,"metrics-updated",ue.updated_at),A(ue.updated_at)}}),oe=db(S);return()=>{se(),oe(),ub()}},[V,O,Y,s,o,i,A]),c.useEffect(()=>{const se=d.current;se!==t&&me(t,se==null)},[t,me]),c.useEffect(()=>{const se=window.setInterval(()=>{const oe=d.current;oe&&X(oe)},gN);return()=>{window.clearInterval(se)}},[X]),c.useEffect(()=>{const se=w.current;if(w.current=x,x==="live"&&se!=="live"){me(t,!0);return}(x==="reconnecting"||x==="offline")&&G(d.current)},[G,x,t,me]),c.useEffect(()=>{const se=()=>xe(!0),oe=()=>xe(!0),Se=()=>{me(t,!0)};return window.addEventListener("pagehide",se),window.addEventListener("beforeunload",oe),window.addEventListener("pageshow",Se),()=>{window.removeEventListener("pagehide",se),window.removeEventListener("beforeunload",oe),window.removeEventListener("pageshow",Se),xe(!1)}},[t,me,xe]),c.useEffect(()=>{let se=!1,oe=null;const Se=()=>{oe!=null&&(window.clearTimeout(oe),oe=null)},be=ue=>{Se(),oe=window.setTimeout(()=>{fe()},ue)},fe=async()=>{var ue;try{const $e=await pe.getHealth();if(se)return;B(((ue=$e==null?void 0:$e.labels)==null?void 0:ue.enabled)??!0);const it=aj($e==null?void 0:$e.indexing);Q(ft=>uj(ft,it)?ft:it);const bt=mj($e==null?void 0:$e.compare_export);W(ft=>gj(ft,bt)?ft:bt),cj(it)&&be(dj(it,vj,Zm))}catch{if(se)return;be(Zm)}};return fe(),()=>{se=!0,Se()}},[]);const qe=C[e],Yt=(qe==null?void 0:qe.editing)??0,dt=m!=null,In=c.useMemo(()=>yj(x),[x]),zt=c.useMemo(()=>!dt||m==null?"No edits yet.":tg(m,N),[dt,m,N]),Xt=c.useMemo(()=>ij(I,r),[I,r]),yn=c.useMemo(()=>oj(R,r,N,tg),[r,N,R]);return{connectionStatus:x,connectionLabel:In,presence:qe,editingCount:Yt,recentEditActive:E,hasEdits:dt,lastEditedLabel:zt,persistenceEnabled:P,indexing:F,compareExportCapability:Z,highlightedPaths:T,onVisiblePathsChange:L,offViewSummary:Xt,recentTouchesDisplay:yn,clearOffViewActivity:$}}const wj=600;function Sj(e){if(!(e instanceof tn))return!1;if(e.status===403||e.status===405)return!0;const t=String(e.message||"").toLowerCase();return t.includes("read-only")||t.includes("no-write")||t.includes("write")}function Yi(e,t){return Sj(e)?"This workspace is read-only. Upload and move actions are disabled.":e instanceof tn||e instanceof Error&&e.message?e.message:t}function yc(e){return Array.from(new Set(e.filter(Boolean)))}function ng(e,t){return t.length?t.length===1?t[0]:`${e} failed for ${t.length} item(s). ${t[0]}`:""}async function bj(){const e=["/"],t=new Set,n=new Set(["/"]);for(;e.length>0&&t.size<wj;){const r=e.shift()??"/",s=Pt(r);if(t.has(s))continue;t.add(s);let i=null;try{i=await pe.getFolder(s)}catch{i=null}if(i)for(const o of i.dirs??[]){const l=Pt(px(s,o.name));n.has(l)||(n.add(l),e.push(l))}}return Array.from(n).sort((r,s)=>r==="/"?-1:s==="/"?1:r.localeCompare(s))}function Cj({appRef:e,uploadInputRef:t,current:n,currentDirCount:r,selectedPaths:s,setSelectedPaths:i,refetch:o,invalidateDerivedCounts:l}){const u=dr(),[d,f]=c.useState(!1),[p,h]=c.useState(null),[w,x]=c.useState(!1),[S,C]=c.useState(null),[v,m]=c.useState(["/"]),[y,g]=c.useState(!1),[b,E]=c.useState(null);c.useEffect(()=>{h(null)},[n]);const M=c.useCallback(I=>{const R=yc(s);return R.includes(I)?R:[I]},[s]),N=c.useCallback((I,R)=>{const T=M(I);i(T),E({x:R.x,y:R.y,kind:"grid",payload:{paths:T}})},[M,i]),_=c.useCallback((I,R)=>{E({x:R.x,y:R.y,kind:"tree",payload:{path:I}})},[]);c.useEffect(()=>{if(!S)return;let I=!1;return g(!0),bj().then(R=>{I||m(R)}).catch(R=>{I||h(Yi(R,"Failed to load destination folders."))}).finally(()=>{I||g(!1)}),()=>{I=!0}},[S]);const P=c.useCallback(async(I,R)=>{const T=yc(I);if(!T.length)return!1;const L=Pt(R||"/");h(null);const O=[],Y=[];for(const A of T)try{await pe.moveFile(A,L)}catch(V){O.push(`${eh(A)||A}: ${Yi(V,"Move failed.")}`),Y.push(A)}try{await u.invalidateQueries({predicate:({queryKey:A})=>Array.isArray(A)&&A[0]==="folder"}),l(),await o()}catch(A){O.push(Yi(A,"Move completed, but refresh failed."))}if(O.length)return h(ng("Move",O)),i(Y),!1;C(null),E(null);const $=new Set(T);return i(A=>A.filter(V=>!$.has(V))),!0},[l,u,o,i]),B=c.useCallback(I=>{const R=yc(I);R.length&&(h(null),C({paths:R}),E(null))},[]),F=c.useCallback(async I=>{if(!I.length)return;if(!(r===0)){h("Uploads are only allowed into folders without subdirectories.");return}f(!0),h(null);const T=[];try{for(const L of I)try{await pe.uploadFile(n,L)}catch(O){T.push(`${L.name}: ${Yi(O,"Upload failed.")}`)}try{await o()}catch(L){T.push(Yi(L,"Upload completed, but refresh failed."))}}finally{f(!1)}if(T.length){h(ng("Upload",T));return}h(null)},[n,r,o]),Q=c.useCallback(()=>{var I;d||(I=t.current)==null||I.click()},[t,d]),Z=c.useCallback(async I=>{const R=Array.from(I.target.files??[]);I.target.value="",R.length&&await F(R)},[F]);c.useEffect(()=>{const I=e.current;if(!I)return;const R=O=>{O.dataTransfer&&Array.from(O.dataTransfer.types).includes("Files")&&(O.preventDefault(),x(!0))},T=O=>{const Y=O.relatedTarget;Y&&I.contains(Y)||x(!1)},L=async O=>{var $;O.preventDefault(),x(!1);const Y=Array.from((($=O.dataTransfer)==null?void 0:$.files)??[]);Y.length&&await F(Y)};return I.addEventListener("dragover",R),I.addEventListener("dragleave",T),I.addEventListener("drop",L),()=>{I.removeEventListener("dragover",R),I.removeEventListener("dragleave",T),I.removeEventListener("drop",L)}},[e,F]),c.useEffect(()=>{const I=()=>E(null),R=T=>{T.key==="Escape"&&E(null)};return window.addEventListener("click",I),window.addEventListener("keydown",R),()=>{window.removeEventListener("click",I),window.removeEventListener("keydown",R)}},[]);const W=c.useCallback(()=>{C(null)},[]);return{uploading:d,actionError:p,isDraggingOver:w,moveDialog:S,moveFolders:v,moveFoldersLoading:y,ctx:b,setCtx:E,closeMoveDialog:W,openUploadPicker:Q,handleUploadInputChange:Z,openGridActions:N,openFolderActions:_,openMoveDialogForPaths:B,moveSelectedToFolder:P}}function Rn(e){const t=e.trim();return!t||t==="/"?"/":t.startsWith("/")?t:`/${t}`}function Bx(e,t){const n=Rn(t),r=e[n];return r||{path:n,hydratedSnapshot:null,hydratedGeneratedAt:null,hydratedItemCount:0,hydratedAtMs:null,topAnchorPath:null}}function Qd(e,t){return t==="/"?!0:e===t||e.startsWith(`${t}/`)}function kj(e){for(const t of e)return t;return null}function Ej(e,t,n,r){const s=Bx(e,t),i={...s,path:Rn(t),hydratedSnapshot:n,hydratedGeneratedAt:n.generatedAt??null,hydratedItemCount:n.totalItems??n.items.length,hydratedAtMs:r};return s.hydratedSnapshot===i.hydratedSnapshot&&s.hydratedGeneratedAt===i.hydratedGeneratedAt&&s.hydratedItemCount===i.hydratedItemCount&&s.hydratedAtMs===i.hydratedAtMs?e:{...e,[i.path]:i}}function rg(e,t,n){const r=Bx(e,t),s=Rn(t),i=n?Rn(n):null;return r.topAnchorPath===i&&r.path===s?e:{...e,[s]:{...r,path:s,topAnchorPath:i}}}function Ux(e,t){const n=Rn(t);if(!e[n])return e;const r={...e};return delete r[n],r}function Nj(e,t){const n=Rn(t);let r=!1;const s={...e};for(const i of Object.keys(s))Qd(i,n)&&(r=!0,delete s[i]);return r?s:e}function jj(e,t){const n=Rn(e),r=Rn(t);return!!(n===r||Qd(n,r)||Qd(r,n))}function Mj(e,t,n){return jj(t,n)?e:Ux(e,n)}function Pj(){const e=c.useRef({}),t=c.useCallback(p=>e.current[Rn(p)]??null,[]),n=c.useCallback(p=>{var h;return((h=e.current[Rn(p)])==null?void 0:h.hydratedSnapshot)??null},[]),r=c.useCallback(p=>{var h;return((h=e.current[Rn(p)])==null?void 0:h.topAnchorPath)??null},[]),s=c.useCallback((p,h)=>{e.current=Ej(e.current,p,h,Date.now())},[]),i=c.useCallback((p,h)=>{e.current=rg(e.current,p,h)},[]),o=c.useCallback((p,h)=>{const w=kj(h);w&&(e.current=rg(e.current,p,w))},[]),l=c.useCallback(p=>{e.current=Ux(e.current,p)},[]),u=c.useCallback(p=>{e.current=Nj(e.current,p)},[]),d=c.useCallback((p,h)=>{e.current=Mj(e.current,p,h)},[]),f=c.useCallback(()=>{e.current={}},[]);return c.useMemo(()=>({getSession:t,getHydratedSnapshot:n,getTopAnchorPath:r,saveHydratedSnapshot:s,saveTopAnchorPath:i,saveTopAnchorFromVisiblePaths:o,invalidatePath:l,invalidateSubtree:u,invalidateForScopeTransition:d,clearAllSessions:f}),[t,n,r,s,i,o,l,u,d,f])}const Rj={stars:{read:e=>{const t=e.stars||[];return t.length?{id:"stars",label:`Rating in: ${pc(t)}`}:null},clear:(e,t)=>t.clearStars()},starsIn:{read:e=>{const t=e.starsIn.values||[];return t.length?{id:"stars-in",label:`Rating in: ${pc(t)}`}:null},clear:(e,t)=>t.clearStars()},starsNotIn:{read:e=>{const t=e.starsNotIn.values||[];return t.length?{id:"stars-not-in",label:`Rating not in: ${pc(t)}`}:null},clear:(e,t)=>t.clearStarsNotIn()},nameContains:{read:e=>{var n;const t=(n=e.nameContains.value)==null?void 0:n.trim();return t?{id:"name-contains",label:`Filename contains: ${t}`}:null},clear:(e,t)=>t.clearNameContains()},nameNotContains:{read:e=>{var n;const t=(n=e.nameNotContains.value)==null?void 0:n.trim();return t?{id:"name-not-contains",label:`Filename not: ${t}`}:null},clear:(e,t)=>t.clearNameNotContains()},commentsContains:{read:e=>{var n;const t=(n=e.commentsContains.value)==null?void 0:n.trim();return t?{id:"comments-contains",label:`Comments contain: ${t}`}:null},clear:(e,t)=>t.clearCommentsContains()},commentsNotContains:{read:e=>{var n;const t=(n=e.commentsNotContains.value)==null?void 0:n.trim();return t?{id:"comments-not-contains",label:`Comments not: ${t}`}:null},clear:(e,t)=>t.clearCommentsNotContains()},urlContains:{read:e=>{var n;const t=(n=e.urlContains.value)==null?void 0:n.trim();return t?{id:"url-contains",label:`URL contains: ${t}`}:null},clear:(e,t)=>t.clearUrlContains()},urlNotContains:{read:e=>{var n;const t=(n=e.urlNotContains.value)==null?void 0:n.trim();return t?{id:"url-not-contains",label:`URL not: ${t}`}:null},clear:(e,t)=>t.clearUrlNotContains()},dateRange:{read:e=>{const{from:t,to:n}=e.dateRange;return!t&&!n?null:{id:"date-range",label:`Date: ${Mk(t,n)}`}},clear:(e,t)=>t.clearDateRange()},widthCompare:{read:e=>({id:"width-compare",label:`Width ${e.widthCompare.op} ${e.widthCompare.value}`}),clear:(e,t)=>t.clearWidthCompare()},heightCompare:{read:e=>({id:"height-compare",label:`Height ${e.heightCompare.op} ${e.heightCompare.value}`}),clear:(e,t)=>t.clearHeightCompare()},metricRange:{read:e=>({id:`metric:${e.metricRange.key}`,label:`${e.metricRange.key}: ${Tk(e.metricRange.min,e.metricRange.max)}`}),clear:(e,t)=>t.clearMetricRange(e.metricRange.key)}};function Tj(e,t){if("stars"in e)return t("stars",e);if("starsIn"in e)return t("starsIn",e);if("starsNotIn"in e)return t("starsNotIn",e);if("nameContains"in e)return t("nameContains",e);if("nameNotContains"in e)return t("nameNotContains",e);if("commentsContains"in e)return t("commentsContains",e);if("commentsNotContains"in e)return t("commentsNotContains",e);if("urlContains"in e)return t("urlContains",e);if("urlNotContains"in e)return t("urlNotContains",e);if("dateRange"in e)return t("dateRange",e);if("widthCompare"in e)return t("widthCompare",e);if("heightCompare"in e)return t("heightCompare",e);if("metricRange"in e)return t("metricRange",e)}function Ij(e,t){const n=[];for(const r of e.and)Tj(r,(s,i)=>{const o=Rj[s],l=o.read(i);l&&n.push({id:l.id,label:l.label,onRemove:()=>o.clear(i,t)})});return n}const tt={sortKey:"sortKey",sortDir:"sortDir",sortSpec:"sortSpec",starFilters:"starFilters",filterAst:"filterAst",selectedMetric:"selectedMetric",viewMode:"viewMode",gridItemSize:"gridItemSize",leftOpen:"leftOpen",rightOpen:"rightOpen"};function sg(e,t){for(const n of e)pe.prefetchFile(n,t),pe.prefetchThumb(n)}function _j(){var xh;const[e,t]=c.useState("/"),[n,r]=c.useState(""),[s,i]=c.useState(!1),[o,l]=c.useState(null),[u,d]=c.useState(null),[f,p]=c.useState(100),[h,w]=c.useState(null),[x,S]=c.useState(()=>({filters:{and:[]},sort:{kind:"builtin",key:"added",dir:"desc"},selectedMetric:void 0})),[C,v]=c.useState(()=>Date.now()),[m,y]=c.useState("adaptive"),[g,b]=c.useState(220),[E,M]=c.useState(!1),[N,_]=c.useState(!0),[P,B]=c.useState(!0),[F,Q]=c.useState(()=>typeof window>"u"?1440:window.innerWidth),Z=Kl(Ql.narrow),[W,I]=c.useState("folders"),[R,T]=c.useState([]),[L,O]=c.useState(null),[Y,$]=c.useState(0),[A,V]=c.useState({}),K=c.useRef(null),G=c.useRef(null),re=c.useRef(null),X=c.useRef(null),D=c.useRef(null),he=c.useRef(null),ie=c.useRef(!1),{leftW:me,rightW:ke,onResizeLeft:xe,onResizeRight:qe}=PE(K,W),{getHydratedSnapshot:Yt,getTopAnchorPath:dt,saveHydratedSnapshot:In,saveTopAnchorPath:zt,invalidateSubtree:Xt}=Pj(),[yn,se]=c.useState(0),[oe,Se]=c.useState(0),be=dr(),fe=$C(),ue=nu(),$e=UC(),[it,bt]=c.useState(!1),{data:ft,refetch:on,searching:ln,normalizedQ:qt,similarityActive:We,embeddings:je,embeddingsRejected:Ct,embeddingsAvailable:_n,embeddingsLoading:Wn,embeddingsError:Ri,poolItems:z,similarityItems:q,items:te,totalCount:ge,filteredCount:we,scopeTotal:Ne,rootTotal:ae}=ej({current:e,query:n,similarityState:o,viewState:x,randomSeed:C,localStarOverrides:A,onFolderHydratedSnapshot:In,getCachedHydratedSnapshot:Yt,sessionResetToken:oe}),Le=c.useMemo(()=>Pt(e||"/"),[e]),Te=c.useMemo(()=>jm(x.filters),[x.filters]),rt=c.useMemo(()=>te.map(j=>j.path),[te]),Be=c.useCallback(j=>{if(!j)return;const U=document.getElementById(`cell-${encodeURIComponent(j)}`);U==null||U.focus()},[]),ht=o?q:z,{selectedPaths:Ue,setSelectedPaths:He,viewer:et,compareOpen:Ie,restoreGridToSelectionToken:qr,bumpRestoreGridToSelectionToken:xn,selectedItems:iu,compareItems:Rs,comparePaths:Ti,compareIndexClamped:fr,compareA:Gr,compareB:Ln,canComparePrev:Qo,canCompareNext:Ko,compareEnabled:hr,canPrevImage:Hn,canNextImage:Yo,overlayActive:ou,rememberFocusedPath:lu,openViewer:au,closeViewer:Ii,openCompare:Jr,closeCompare:uu,handleCompareNavigate:cu,handleNavigate:_i,resetViewerState:Xo,clearViewerForSearch:Ts,syncHashImageSelection:Li}=tj({current:e,itemPaths:rt,items:te,selectionPool:ht,focusGridCell:Be}),Ai=Tl(Li),Zr=Tl(xn);c.useEffect(()=>{const j=ne=>{const de=Pt(ne),_e=Zk(de)?de:null,kt=_e?Nm(de):de,Me=!ie.current;ie.current=!0,Ai.current(_e),t(Pe=>{const pt=Rk(Pe,kt,_e,Me);return Pe===pt?Pe:(Zr.current(),pt)})};j(Em());const U=()=>j(Em());return window.addEventListener("hashchange",U),()=>window.removeEventListener("hashchange",U)},[Zr,Ai]);const du=ht,pr=o?null:x.sort.kind==="metric"?x.sort.key:null,qo=c.useMemo(()=>PN(te,pr),[te,pr]),fu=c.useCallback(j=>{const U=Object.prototype.hasOwnProperty.call(j,"star"),ne=j.metrics!==void 0,de=j.comments!==void 0;if(!U&&!ne&&!de)return;const _e=Me=>{if(Me.path!==j.path)return Me;let Pe=Me;return U&&Me.star!==j.star&&(Pe={...Pe,star:j.star??null}),ne&&(Pe={...Pe,metrics:j.metrics??void 0}),de&&Me.comments!==j.comments&&(Pe={...Pe,comments:j.comments??""}),Pe},kt=Me=>{if(!Me)return Me;let Pe=!1;const pt=Me.items.map(an=>{const _s=_e(an);return _s!==an&&(Pe=!0),_s});return Pe?{...Me,items:pt}:Me};be.setQueriesData({predicate:({queryKey:Me})=>Array.isArray(Me)&&Me[0]==="folder"},kt),be.setQueriesData({predicate:({queryKey:Me})=>Array.isArray(Me)&&Me[0]==="search"},kt)},[be]),{connectionStatus:Is,connectionLabel:hu,presence:pu,editingCount:mu,recentEditActive:gu,hasEdits:vu,lastEditedLabel:yu,persistenceEnabled:xu,indexing:wu,compareExportCapability:Go,highlightedPaths:Su,onVisiblePathsChange:Jo,offViewSummary:Zo,recentTouchesDisplay:ce,clearOffViewActivity:ye}=xj({current:e,currentGalleryId:Le,itemPaths:rt,items:te,queryClient:be,updateItemCaches:fu,setLocalStarOverrides:V}),Ge=c.useCallback(j=>{Jo(j)},[Jo]),Qn=c.useCallback(j=>{j&&zt(e,j)},[e,zt]),Vx=c.useMemo(()=>dt(e),[e,dt]);c.useEffect(()=>{se(j=>j+1)},[e]);const bu=c.useCallback(()=>{$(j=>j+1)},[]),sh=c.useCallback(j=>{const U=Pt(j||"/");return U===""?"/":U},[]),ih=c.useCallback(j=>{const U=ne=>j==="/"?!0:ne===j||ne.startsWith(`${j}/`);be.invalidateQueries({predicate:({queryKey:ne})=>{if(!Array.isArray(ne)||ne[0]!=="folder")return!1;const de=typeof ne[1]=="string"?ne[1]:"";return U(de)}})},[be]),Cu=c.useCallback(async j=>{const U=sh(j);await pe.refreshFolder(U),ih(U),bu(),Xt(U),(e===U||e.startsWith(U==="/"?"/":`${U}/`))&&(Se(ne=>ne+1),await on()),Ed.evictPrefix(U),Ds.evictPrefix(U)},[e,bu,Xt,ih,sh,on]),Wx=c.useCallback(async()=>{try{await Cu(e)}catch(j){console.error("Failed to refresh folder:",j)}},[e,Cu]),Hx=c.useMemo(()=>RN(o?q:z,A),[o,q,z,A]),mr=c.useMemo(()=>TN(o?q:z),[o,q,z]);c.useEffect(()=>{We||mr.length&&S(j=>{const U=j.selectedMetric&&mr.includes(j.selectedMetric)?j.selectedMetric:mr[0];return U===j.selectedMetric?j:{...j,selectedMetric:U}})},[mr,We]),c.useEffect(()=>{We||x.sort.kind==="metric"&&(mr.includes(x.sort.key)||S(j=>({...j,sort:{kind:"builtin",key:"added",dir:j.sort.dir}})))},[mr,x.sort,We]);const el=c.useMemo(()=>xE(x.filters),[x.filters]),ku=We||ln||el>0,Qx=fe.state==="syncing"?"Syncing":fe.state==="error"?fe.message?`Not saved  ${fe.message}`:"Not saved  retry":"All changes saved",Kx=$e!=null&&$e>pN,Yx=Is==="offline"||Is==="connecting"||Is==="idle",Xx=Is==="reconnecting"||ue||fe.state==="error"||Kx,qx=fN({isOffline:Yx,isUnstable:Xx,recentEditActive:gu,editingCount:mu}),Gx=IN(We,ku,we,Ne),Jx=_N(We,ku,ge,Ne,ae,e),oh=c.useMemo(()=>LN(o),[o]),lh=c.useMemo(()=>AN(o!==null,el,we,ge),[o,el,we,ge]),Tt=c.useCallback(j=>{S(U=>({...U,filters:j(U.filters)}))},[]),Zx=c.useCallback(j=>{S(U=>({...U,filters:j}))},[]),Eu=c.useCallback(()=>{Tt(j=>mc(j,[]))},[Tt]),ah=c.useCallback(()=>{S(j=>({...j,filters:{and:[]}}))},[]),Nu=c.useCallback(()=>{l(null);const j=he.current;he.current=null,j&&j.length?(He(j),xn()):He([])},[xn,He]),e0=c.useCallback(()=>{o&&Nu(),r(""),S(j=>({...j,filters:{and:[]}}))},[Nu,o]),t0=c.useCallback(async j=>{!o&&he.current===null&&(he.current=Ue);const U=await pe.searchEmbeddings(j);if(l({embedding:U.embedding,queryPath:j.query_path??null,queryVector:j.query_vector_b64??null,topK:j.top_k??50,minScore:j.min_score??null,items:U.items,createdAt:Date.now()}),U.items.length){const ne=j.query_path&&U.items.some(de=>de.path===j.query_path)?j.query_path:U.items[0].path;He([ne]),xn()}else He([])},[xn,Ue,He,o]),ju=c.useCallback((j,U)=>{Tt(ne=>yE(ne,j,U))},[Tt]),uh=c.useMemo(()=>Ij(x.filters,{clearStars:Eu,clearStarsNotIn:()=>Tt(j=>gx(j,[])),clearNameContains:()=>Tt(j=>vx(j,"")),clearNameNotContains:()=>Tt(j=>yx(j,"")),clearCommentsContains:()=>Tt(j=>xx(j,"")),clearCommentsNotContains:()=>Tt(j=>wx(j,"")),clearUrlContains:()=>Tt(j=>Sx(j,"")),clearUrlNotContains:()=>Tt(j=>bx(j,"")),clearDateRange:()=>Tt(j=>Ud(j,null)),clearWidthCompare:()=>Tt(j=>Gl(j,null)),clearHeightCompare:()=>Tt(j=>Jl(j,null)),clearMetricRange:j=>ju(j,null)}),[x.filters,Eu,ju,Tt]),n0=c.useCallback(j=>{const U=new Set(Te);U.has(j)?U.delete(j):U.add(j),S(ne=>({...ne,filters:mc(ne.filters,Array.from(U))}))},[Te]),r0=c.useCallback(()=>{_(!0),I("metrics")},[]),s0=c.useCallback(j=>{S(U=>({...U,sort:j})),j.kind==="builtin"&&j.key==="random"&&v(Date.now())},[]),ch=c.useCallback(j=>{if(j==="/"||j==="")return"Lenslet | Root";const U=j.split("/").filter(Boolean);if(!U.length)return"Lenslet";const ne=U.slice(-2).join("/");return`Lenslet | ${U.length>2?`.../${ne}`:`/${ne}`}`},[]),i0=c.useMemo(()=>Pk(e),[e]);c.useEffect(()=>{document.title=ch(e)},[e,ch]),c.useEffect(()=>{let j=!0;return pe.getViews().then(U=>{j&&T(U.views||[])}).catch(()=>{j&&T([])}),()=>{j=!1}},[]),c.useEffect(()=>{ln&&(He([]),Ts(e))},[Ts,e,ln,He]),c.useEffect(()=>{const j=K.current,U=X.current;if(!j||!U)return;const ne=()=>{const _e=Math.max(48,Math.round(U.getBoundingClientRect().height));j.style.setProperty("--toolbar-h",`${_e}px`)};ne();const de=window.ResizeObserver;if(de){const _e=new de(ne);return _e.observe(U),()=>_e.disconnect()}return window.addEventListener("resize",ne),()=>window.removeEventListener("resize",ne)},[]),c.useEffect(()=>{try{const j=localStorage.getItem(tt.sortKey),U=localStorage.getItem(tt.sortDir),ne=localStorage.getItem(tt.sortSpec),de=localStorage.getItem(tt.starFilters),_e=localStorage.getItem(tt.filterAst),kt=localStorage.getItem(tt.selectedMetric),Me=localStorage.getItem(tt.viewMode),Pe=localStorage.getItem(tt.gridItemSize),pt=localStorage.getItem(tt.leftOpen),an=localStorage.getItem(tt.rightOpen),wh=(Et=>{if(!Et)return null;const ot=fc(Et);return!ot||typeof ot!="object"?null:ot.kind==="builtin"&&(ot.key==="name"||ot.key==="added"||ot.key==="random")&&(ot.dir==="asc"||ot.dir==="desc")||ot.kind==="metric"&&typeof ot.key=="string"&&ot.key.length>0&&(ot.dir==="asc"||ot.dir==="desc")?ot:null})(ne)??{kind:"builtin",key:j==="name"||j==="added"||j==="random"?j:"added",dir:U==="asc"||U==="desc"?U:"desc"};wh.key==="random"&&v(Date.now());let Pu=(Et=>{if(!Et)return null;const ot=fc(Et);return Bd(ot)})(_e)??{and:[]};if(de){const Et=fc(de);if(Array.isArray(Et)){const ot=Et.filter(x0=>[0,1,2,3,4,5].includes(x0));Pu=mc(Pu,ot)}}if(S(Et=>({...Et,sort:wh,filters:Pu,selectedMetric:kt||Et.selectedMetric})),(Me==="grid"||Me==="adaptive")&&y(Me),Pe){const Et=Number(Pe);!isNaN(Et)&&Et>=80&&Et<=500&&b(Et)}(pt==="0"||pt==="false")&&_(!1),(an==="0"||an==="false")&&B(!1)}catch{}},[]),c.useEffect(()=>{Z&&(_(!1),B(!1))},[Z]),c.useEffect(()=>{if(typeof window>"u")return;const j=[1,1.25,1.5,1.75,2,3,4],U=_e=>j.reduce((kt,Me)=>Math.abs(Me-_e)<Math.abs(kt-_e)?Me:kt,j[0]),ne=()=>{var _s;const _e=window.devicePixelRatio||1,kt=U(_e),Me=((_s=window.visualViewport)==null?void 0:_s.scale)??1,Pe=_e*Me/kt;if(!Number.isFinite(Pe)){w(null);return}const pt=Math.round(Pe*100),an=Math.min(500,Math.max(25,pt));w(an)};ne(),window.addEventListener("resize",ne),window.addEventListener("orientationchange",ne);const de=window.visualViewport;return de&&de.addEventListener("resize",ne),()=>{window.removeEventListener("resize",ne),window.removeEventListener("orientationchange",ne),de&&de.removeEventListener("resize",ne)}},[]),c.useEffect(()=>{try{localStorage.setItem(tt.sortKey,x.sort.kind==="builtin"?x.sort.key:"added"),localStorage.setItem(tt.sortDir,x.sort.dir),localStorage.setItem(tt.sortSpec,JSON.stringify(x.sort));const j=jm(x.filters);localStorage.setItem(tt.starFilters,JSON.stringify(j)),localStorage.setItem(tt.filterAst,JSON.stringify(x.filters)),x.selectedMetric?localStorage.setItem(tt.selectedMetric,x.selectedMetric):localStorage.removeItem(tt.selectedMetric),localStorage.setItem(tt.viewMode,m),localStorage.setItem(tt.gridItemSize,String(g)),localStorage.setItem(tt.leftOpen,N?"1":"0"),localStorage.setItem(tt.rightOpen,P?"1":"0")}catch{}},[x,m,g,N,P]),c.useEffect(()=>{if(typeof window>"u")return;const j=()=>Q(window.innerWidth);return j(),window.addEventListener("resize",j),window.addEventListener("orientationchange",j),()=>{window.removeEventListener("resize",j),window.removeEventListener("orientationchange",j)}},[]);const tl=F<=Vr.mobileMax,dh=Tl(g);c.useEffect(()=>{tl||E&&M(!1)},[tl,E]),c.useEffect(()=>{const j=G.current;if(!j)return;const U=de=>Math.min(500,Math.max(80,de)),ne=de=>{de.ctrlKey&&(et||Ie||(de.preventDefault(),b(_e=>U(_e+(de.deltaY<0?20:-20)))))};return j.addEventListener("wheel",ne,{passive:!1}),()=>j.removeEventListener("wheel",ne)},[et,Ie]),c.useEffect(()=>{if(et||Ie)return;const j=G.current;if(!j)return;const U=Pe=>Math.min(500,Math.max(80,Pe));let ne=null;const de=Pe=>{if(Pe.length<2)return 0;const[pt,an]=[Pe[0],Pe[1]];return Math.hypot(pt.clientX-an.clientX,pt.clientY-an.clientY)},_e=Pe=>{if(Pe.touches.length!==2)return;const pt=de(Pe.touches);pt&&(ne={dist:pt,size:dh.current})},kt=Pe=>{if(!ne||Pe.touches.length!==2)return;const pt=de(Pe.touches);if(!pt)return;Pe.preventDefault();const an=U(ne.size*(pt/ne.dist));b(an)},Me=()=>{ne=null};return j.addEventListener("touchstart",_e,{passive:!0}),j.addEventListener("touchmove",kt,{passive:!1}),j.addEventListener("touchend",Me),j.addEventListener("touchcancel",Me),()=>{j.removeEventListener("touchstart",_e),j.removeEventListener("touchmove",kt),j.removeEventListener("touchend",Me),j.removeEventListener("touchcancel",Me)}},[et,Ie,dh]),c.useEffect(()=>{sg(wN(rt,et),"viewer")},[et,rt]),c.useEffect(()=>{Ie&&sg(SN(Ti,fr),"compare")},[Ie,Ti,fr]);const Mu=c.useCallback(j=>{Xo();const U=Pt(j);t(U),hx(U)},[Xo]),{uploading:o0,actionError:fh,isDraggingOver:l0,moveDialog:hh,moveFolders:a0,moveFoldersLoading:u0,ctx:ph,setCtx:c0,closeMoveDialog:d0,openUploadPicker:f0,handleUploadInputChange:h0,openGridActions:mh,openFolderActions:gh,openMoveDialogForPaths:p0,moveSelectedToFolder:m0}=Cj({appRef:K,uploadInputRef:D,current:e,currentDirCount:((xh=ft==null?void 0:ft.dirs)==null?void 0:xh.length)??0,selectedPaths:Ue,setSelectedPaths:He,refetch:on,invalidateDerivedCounts:bu}),g0=c.useCallback(async()=>{const j=window.prompt("Save Smart Folder as:","New Smart Folder");if(!j)return;const U=Nk(j,R),ne={id:U,name:j,pool:{kind:"folder",path:e},view:JSON.parse(JSON.stringify(x))},de=[...R.filter(_e=>_e.id!==U),ne];T(de),O(U);try{await pe.saveViews({version:1,views:de})}catch(_e){if(_e instanceof tn&&_e.status===403){const kt=new Blob([JSON.stringify({version:1,views:de},null,2)],{type:"application/json"});fo(kt,`lenslet-smart-folder-${U}.json`),alert("No-write mode: exported Smart Folder JSON instead of saving.");return}console.error("Failed to save Smart Folder:",_e)}},[e,x,R]);c.useEffect(()=>{if(!L)return;const j=R.find(de=>de.id===L);if(!j){O(null);return}const U=j.pool.path===e,ne=JSON.stringify(j.view)===JSON.stringify(x);(!U||!ne)&&O(null)},[L,R,e,x]);const vh=Tl({current:e,items:te,selectedPaths:Ue,viewer:et,compareOpen:Ie,mobileSelectMode:E,openFolder:Mu});c.useEffect(()=>{const j=U=>{const ne=vh.current;if(!qf(U.target)){if((U.ctrlKey||U.metaKey)&&U.key.toLowerCase()==="b"){U.preventDefault(),U.altKey?B(de=>!de):_(de=>!de);return}if(!(ne.viewer||ne.compareOpen)){if(U.key==="Backspace"||U.key==="Delete")U.preventDefault(),ne.openFolder(Nm(ne.current));else if((U.ctrlKey||U.metaKey)&&U.key.toLowerCase()==="a")U.preventDefault(),He(ne.items.map(de=>de.path));else if(U.key==="Escape"){if(ne.selectedPaths.length){U.preventDefault(),He([]);return}ne.mobileSelectMode&&(U.preventDefault(),M(!1))}else if(U.key==="/"){U.preventDefault();const de=document.querySelector(".toolbar-right .input");de==null||de.focus()}}}};return window.addEventListener("keydown",j),()=>window.removeEventListener("keydown",j)},[vh,He]);const yh=c.useMemo(()=>$S({viewportWidth:F,leftOpen:N,rightOpen:P,leftWidth:me,rightWidth:ke}),[F,N,P,me,ke]),v0=N?`${yh.leftWidth}px`:"0px",y0=P?`${yh.rightWidth}px`:"0px";return a.jsxs("div",{className:"app-shell grid h-full grid-cols-[var(--left)_1fr_var(--right)]",ref:K,style:{"--left":v0,"--right":y0},children:[a.jsx(VS,{rootRef:X,onSearch:r,viewerActive:!!et,onBack:Ii,zoomPercent:et?f:void 0,onZoomPercentChange:j=>d(j),currentLabel:i0,itemCount:Gx,totalCount:Jx,sortSpec:x.sort,metricKeys:mr,onSortChange:s0,sortDisabled:We,filterCount:el,onOpenFilters:r0,starFilters:Te,onToggleStar:n0,onClearStars:Eu,onClearFilters:ah,starCounts:Hx,viewMode:m,onViewMode:y,gridItemSize:g,onGridItemSize:b,leftOpen:N,rightOpen:P,onToggleLeft:()=>_(j=>!j),onToggleRight:()=>B(j=>!j),onPrevImage:()=>_i(-1),onNextImage:()=>_i(1),canPrevImage:Hn,canNextImage:Yo,searchDisabled:We,searchPlaceholder:We?"Exit similarity to search":void 0,onUploadClick:f0,uploadBusy:o0,uploadDisabled:Ie,multiSelectMode:E,selectedCount:Ue.length,onToggleMultiSelectMode:tl?()=>M(j=>!j):void 0,syncIndicator:{state:qx,presence:pu,syncLabel:Qx,connectionLabel:hu,lastEditedLabel:yu,hasEdits:vu,localTypingActive:it,recentTouches:ce}}),a.jsx("input",{ref:D,type:"file",multiple:!0,accept:"image/*",className:"sr-only",onChange:h0}),N&&a.jsx(cN,{leftTool:W,onToolChange:I,compareEnabled:hr,compareActive:Ie,onOpenCompare:Jr,views:R,activeViewId:L,onActivateView:j=>{var ne;O(j.id);const U=Bd((ne=j.view)==null?void 0:ne.filters)??{and:[]};S({...j.view,filters:U}),Mu(j.pool.path)},onSaveView:g0,current:e,data:ft,onOpenFolder:j=>{O(null),Mu(j)},onOpenFolderActions:gh,onPullRefreshFolders:Wx,onContextMenu:(j,U)=>{j.preventDefault(),gh(U,{x:j.clientX,y:j.clientY})},countVersion:Y,items:du,filteredItems:te,metricKeys:mr,selectedItems:iu,selectedMetric:x.selectedMetric,onSelectMetric:j=>S(U=>({...U,selectedMetric:j})),filters:x.filters,onChangeRange:ju,onChangeFilters:Zx,onResize:xe}),a.jsxs("div",{className:"grid-shell col-start-2 row-start-2 relative overflow-hidden flex flex-col",ref:G,children:[a.jsx("div",{"aria-live":"polite",className:"sr-only",children:Ue.length?`${Ue.length} selected`:""}),a.jsx(dN,{persistenceEnabled:xu,indexing:wu,offViewSummary:Zo,canRevealOffView:ku,onRevealOffView:e0,onClearOffView:ye,browserZoomPercent:h}),fh&&a.jsx("div",{className:"border-b border-border bg-panel px-3 py-2",children:a.jsx("div",{className:"ui-banner ui-banner-danger text-xs",children:fh})}),o&&a.jsx("div",{className:"border-b border-border bg-panel",children:a.jsxs("div",{className:"px-3 py-2 flex flex-wrap items-center gap-2",children:[a.jsxs("div",{className:"ui-banner ui-banner-accent text-xs flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"font-semibold",children:"Similarity mode"}),a.jsxs("span",{className:"text-muted",children:["Embedding: ",o.embedding]}),oh&&a.jsxs("span",{className:"text-muted",children:["Query: ",oh]}),lh&&a.jsxs("span",{className:"text-muted",children:["Results: ",lh]}),a.jsxs("span",{className:"text-muted",children:["Top K: ",o.topK]}),o.minScore!=null&&a.jsxs("span",{className:"text-muted",children:["Min score: ",o.minScore]})]}),a.jsx("button",{className:"btn btn-sm",onClick:Nu,children:"Exit similarity"})]})}),uh.length>0&&a.jsx("div",{className:"sticky top-0 z-10 px-3 py-2 bg-panel border-b border-border",children:a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Filters"}),uh.map(j=>a.jsxs("span",{className:"filter-chip",children:[a.jsx("span",{className:"truncate max-w-[240px]",title:j.label,children:j.label}),a.jsx("button",{className:"filter-chip-remove","aria-label":`Clear filter ${j.label}`,onClick:j.onRemove,children:""})]},j.id)),a.jsx("button",{className:"btn btn-sm btn-ghost text-xs",onClick:ah,children:"Clear all"})]})}),a.jsxs("div",{className:"flex-1 min-h-0 relative",children:[a.jsx(lC,{items:te,selected:Ue,restoreToSelectionToken:qr,restoreToTopAnchorToken:yn,restoreToTopAnchorPath:Vx,multiSelectMode:tl&&E,onSelectionChange:He,onOpenViewer:j=>{lu(j),au(j),He([j])},highlight:ln?qt:"",recentlyUpdated:Su,onVisiblePathsChange:Ge,onTopAnchorPathChange:Qn,suppressSelectionHighlight:ou,viewMode:m,targetCellSize:g,onContextMenuItem:(j,U)=>{j.preventDefault(),mh(U,{x:j.clientX,y:j.clientY})},onOpenItemActions:mh,scrollRef:re,hideScrollbar:qo}),qo&&pr&&a.jsx(cC,{items:te,metricKey:pr,scrollRef:re,sortDir:x.sort.dir})]})]}),P&&a.jsx(Xk,{path:Ue[0]??null,selectedPaths:Ue,items:te,compareActive:Ie,compareA:Gr,compareB:Ln,onOpenCompare:Jr,sortSpec:x.sort,onResize:qe,onStarChanged:(j,U)=>{V(ne=>{const de={...ne};for(const _e of j)de[_e]=U;return de})},onFindSimilar:()=>i(!0),embeddingsAvailable:_n,embeddingsLoading:Wn,compareExportSupportsV2:Go.supportsV2,compareExportMaxPathsV2:Go.maxPathsV2,onLocalTypingChange:bt}),a.jsx(qk,{open:s,embeddings:je,rejected:Ct,selectedPath:Ue[0]??null,embeddingsLoading:Wn,embeddingsError:Ri,onClose:()=>i(!1),onSearch:t0}),et&&a.jsx(kC,{path:et,onClose:Ii,onZoomChange:j=>p(Math.round(j)),requestedZoomPercent:u,onZoomRequestConsumed:()=>d(null),canPrev:Hn,canNext:Yo,onNavigate:_i}),Ie&&a.jsx(TC,{aItem:Gr,bItem:Ln,index:fr,total:Rs.length,canPrev:Qo,canNext:Ko,onNavigate:cu,onClose:uu}),hh&&a.jsx(bN,{paths:hh.paths,defaultDestination:e,destinations:a0,loadingDestinations:u0,onClose:d0,onSubmit:m0}),l0&&a.jsx("div",{className:"toolbar-offset fixed inset-0 left-[var(--left)] right-[var(--right)] bg-accent/10 border-2 border-dashed border-accent text-text flex items-center justify-center text-lg z-overlay pointer-events-none",children:"Drop images to upload"}),ph&&a.jsx(jN,{ctx:ph,current:e,items:te,setCtx:c0,onRefetch:on,onOpenMoveDialog:p0,onRefreshFolder:Cu})]})}const Lj=new vS({defaultOptions:{queries:{staleTime:1e4,gcTime:5*6e4,retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),1e4),refetchOnWindowFocus:!1,refetchOnReconnect:"always"},mutations:{retry:2,retryDelay:e=>Math.min(1e3*Math.pow(2,e),5e3)}}});function Aj(){return a.jsx(yS,{client:Lj,children:a.jsx(_j,{})})}My(document.getElementById("root")).render(a.jsx(Aj,{}));
